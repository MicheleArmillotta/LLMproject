[
  {
    "function_name": "virArpTableFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarptable.c",
    "lines": "166-180",
    "snippet": "void\nvirArpTableFree(virArpTablePtr table)\n{\n    size_t i;\n\n    if (!table)\n        return;\n\n    for (i = 0; i < table->n; i++) {\n        VIR_FREE(table->t[i].ipaddr);\n        VIR_FREE(table->t[i].mac);\n    }\n    VIR_FREE(table->t);\n    VIR_FREE(table);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virarptable.h\"",
      "#include \"viralloc.h\"",
      "# include <linux/rtnetlink.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "table"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "table->t"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "table->t[i].mac"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "table->t[i].ipaddr"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"virnetlink.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n# include <linux/rtnetlink.h>\n#include <config.h>\n\nvoid\nvirArpTableFree(virArpTablePtr table)\n{\n    size_t i;\n\n    if (!table)\n        return;\n\n    for (i = 0; i < table->n; i++) {\n        VIR_FREE(table->t[i].ipaddr);\n        VIR_FREE(table->t[i].mac);\n    }\n    VIR_FREE(table->t);\n    VIR_FREE(table);\n}"
  },
  {
    "function_name": "virArpTableGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarptable.c",
    "lines": "156-162",
    "snippet": "virArpTablePtr\nvirArpTableGet(void)\n{\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"get arp table not implemented on this platform\"));\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virarptable.h\"",
      "#include \"viralloc.h\"",
      "# include <linux/rtnetlink.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "\"%s\"",
            "_(\"get arp table not implemented on this platform\")"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"get arp table not implemented on this platform\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"virnetlink.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n# include <linux/rtnetlink.h>\n#include <config.h>\n\nvirArpTablePtr\nvirArpTableGet(void)\n{\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"get arp table not implemented on this platform\"));\n    return NULL;\n}"
  },
  {
    "function_name": "virArpTableGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarptable.c",
    "lines": "63-152",
    "snippet": "virArpTablePtr\nvirArpTableGet(void)\n{\n    int num = 0;\n    int msglen;\n    g_autofree void *nlData = NULL;\n    virArpTablePtr table = NULL;\n    struct nlmsghdr* nh;\n    struct rtattr * tb[NDA_MAX+1];\n\n    msglen = virNetlinkGetNeighbor(&nlData, 0, 0);\n    if (msglen < 0)\n        return NULL;\n\n    if (VIR_ALLOC(table) < 0)\n        return NULL;\n\n    nh = (struct nlmsghdr*)nlData;\n\n    VIR_WARNINGS_NO_CAST_ALIGN\n    for (; NLMSG_OK(nh, msglen); nh = NLMSG_NEXT(nh, msglen)) {\n        VIR_WARNINGS_RESET\n        struct ndmsg *r = NLMSG_DATA(nh);\n        int len = nh->nlmsg_len;\n        void *addr;\n\n        if ((len -= NLMSG_LENGTH(sizeof(*nh))) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"wrong nlmsg len\"));\n            goto cleanup;\n        }\n\n        if (r->ndm_family && (r->ndm_family != AF_INET))\n            continue;\n\n        /* catch stale and reachalbe arp entry only */\n        if (r->ndm_state &&\n            (!(r->ndm_state == NUD_STALE || r->ndm_state == NUD_REACHABLE)))\n            continue;\n\n        if (nh->nlmsg_type == NLMSG_DONE)\n            return table;\n\n        VIR_WARNINGS_NO_CAST_ALIGN\n        parse_rtattr(tb, NDA_MAX, NDA_RTA(r),\n                     nh->nlmsg_len - NLMSG_LENGTH(sizeof(*r)));\n        VIR_WARNINGS_RESET\n\n        if (tb[NDA_DST] == NULL || tb[NDA_LLADDR] == NULL)\n            continue;\n\n        if (tb[NDA_DST]) {\n            g_autofree char *ipstr = NULL;\n            virSocketAddr virAddr;\n            if (VIR_REALLOC_N(table->t, num + 1) < 0)\n                goto cleanup;\n\n            table->n = num + 1;\n\n            addr = RTA_DATA(tb[NDA_DST]);\n            bzero(&virAddr, sizeof(virAddr));\n            virAddr.len = sizeof(virAddr.data.inet4);\n            virAddr.data.inet4.sin_family = AF_INET;\n            virAddr.data.inet4.sin_addr = *(struct in_addr *)addr;\n            ipstr = virSocketAddrFormat(&virAddr);\n\n            table->t[num].ipaddr = g_strdup(ipstr);\n        }\n\n        if (tb[NDA_LLADDR]) {\n            virMacAddr macaddr;\n            char ifmac[VIR_MAC_STRING_BUFLEN];\n\n            addr = RTA_DATA(tb[NDA_LLADDR]);\n            memcpy(macaddr.addr, addr, VIR_MAC_BUFLEN);\n\n            virMacAddrFormat(&macaddr, ifmac);\n\n            table->t[num].mac = g_strdup(ifmac);\n\n            num++;\n        }\n    }\n\n    return table;\n\n cleanup:\n    virArpTableFree(table);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virarptable.h\"",
      "#include \"viralloc.h\"",
      "# include <linux/rtnetlink.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virArpTableFree",
          "args": [
            "table"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "virArpTableFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarptable.c",
          "lines": "166-180",
          "snippet": "void\nvirArpTableFree(virArpTablePtr table)\n{\n    size_t i;\n\n    if (!table)\n        return;\n\n    for (i = 0; i < table->n; i++) {\n        VIR_FREE(table->t[i].ipaddr);\n        VIR_FREE(table->t[i].mac);\n    }\n    VIR_FREE(table->t);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "# include <linux/rtnetlink.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"virnetlink.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n# include <linux/rtnetlink.h>\n#include <config.h>\n\nvoid\nvirArpTableFree(virArpTablePtr table)\n{\n    size_t i;\n\n    if (!table)\n        return;\n\n    for (i = 0; i < table->n; i++) {\n        VIR_FREE(table->t[i].ipaddr);\n        VIR_FREE(table->t[i].mac);\n    }\n    VIR_FREE(table->t);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "ifmac"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&macaddr",
            "ifmac"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "macaddr.addr",
            "addr",
            "VIR_MAC_BUFLEN"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[NDA_LLADDR]"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketAddrFormat",
          "args": [
            "&virAddr"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "441-445",
          "snippet": "char *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nchar *\nvirSocketAddrFormat(const virSocketAddr *addr)\n{\n    return virSocketAddrFormatFull(addr, false, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "&virAddr",
            "sizeof(virAddr)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[NDA_DST]"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "table->t",
            "num + 1"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"wrong nlmsg len\")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_LENGTH",
          "args": [
            "sizeof(*nh)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_DATA",
          "args": [
            "nh"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_NEXT",
          "args": [
            "nh",
            "msglen"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_OK",
          "args": [
            "nh",
            "msglen"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "table"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkGetNeighbor",
          "args": [
            "&nlData",
            "0",
            "0"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkGetNeighbor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1295-1302",
          "snippet": "int\nvirNetlinkGetNeighbor(void **nlData G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkGetNeighbor(void **nlData G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"virnetlink.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n# include <linux/rtnetlink.h>\n#include <config.h>\n\nvirArpTablePtr\nvirArpTableGet(void)\n{\n    int num = 0;\n    int msglen;\n    g_autofree void *nlData = NULL;\n    virArpTablePtr table = NULL;\n    struct nlmsghdr* nh;\n    struct rtattr * tb[NDA_MAX+1];\n\n    msglen = virNetlinkGetNeighbor(&nlData, 0, 0);\n    if (msglen < 0)\n        return NULL;\n\n    if (VIR_ALLOC(table) < 0)\n        return NULL;\n\n    nh = (struct nlmsghdr*)nlData;\n\n    VIR_WARNINGS_NO_CAST_ALIGN\n    for (; NLMSG_OK(nh, msglen); nh = NLMSG_NEXT(nh, msglen)) {\n        VIR_WARNINGS_RESET\n        struct ndmsg *r = NLMSG_DATA(nh);\n        int len = nh->nlmsg_len;\n        void *addr;\n\n        if ((len -= NLMSG_LENGTH(sizeof(*nh))) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"wrong nlmsg len\"));\n            goto cleanup;\n        }\n\n        if (r->ndm_family && (r->ndm_family != AF_INET))\n            continue;\n\n        /* catch stale and reachalbe arp entry only */\n        if (r->ndm_state &&\n            (!(r->ndm_state == NUD_STALE || r->ndm_state == NUD_REACHABLE)))\n            continue;\n\n        if (nh->nlmsg_type == NLMSG_DONE)\n            return table;\n\n        VIR_WARNINGS_NO_CAST_ALIGN\n        parse_rtattr(tb, NDA_MAX, NDA_RTA(r),\n                     nh->nlmsg_len - NLMSG_LENGTH(sizeof(*r)));\n        VIR_WARNINGS_RESET\n\n        if (tb[NDA_DST] == NULL || tb[NDA_LLADDR] == NULL)\n            continue;\n\n        if (tb[NDA_DST]) {\n            g_autofree char *ipstr = NULL;\n            virSocketAddr virAddr;\n            if (VIR_REALLOC_N(table->t, num + 1) < 0)\n                goto cleanup;\n\n            table->n = num + 1;\n\n            addr = RTA_DATA(tb[NDA_DST]);\n            bzero(&virAddr, sizeof(virAddr));\n            virAddr.len = sizeof(virAddr.data.inet4);\n            virAddr.data.inet4.sin_family = AF_INET;\n            virAddr.data.inet4.sin_addr = *(struct in_addr *)addr;\n            ipstr = virSocketAddrFormat(&virAddr);\n\n            table->t[num].ipaddr = g_strdup(ipstr);\n        }\n\n        if (tb[NDA_LLADDR]) {\n            virMacAddr macaddr;\n            char ifmac[VIR_MAC_STRING_BUFLEN];\n\n            addr = RTA_DATA(tb[NDA_LLADDR]);\n            memcpy(macaddr.addr, addr, VIR_MAC_BUFLEN);\n\n            virMacAddrFormat(&macaddr, ifmac);\n\n            table->t[num].mac = g_strdup(ifmac);\n\n            num++;\n        }\n    }\n\n    return table;\n\n cleanup:\n    virArpTableFree(table);\n    return NULL;\n}"
  },
  {
    "function_name": "parse_rtattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarptable.c",
    "lines": "45-60",
    "snippet": "static int\nparse_rtattr(struct rtattr *tb[], int max, struct rtattr *rta, int len)\n{\n    memset(tb, 0, sizeof(struct rtattr *) * (max + 1));\n    VIR_WARNINGS_NO_CAST_ALIGN\n    for (; RTA_OK(rta, len); rta = RTA_NEXT(rta, len)) {\n        VIR_WARNINGS_RESET\n        if ((rta->rta_type <= max) && (!tb[rta->rta_type]))\n            tb[rta->rta_type] = rta;\n    }\n\n    if (len)\n        VIR_WARN(\"malformed netlink message: Deficit %d, rta_len=%d\",\n                 len, rta->rta_len);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virsocketaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virarptable.h\"",
      "#include \"viralloc.h\"",
      "# include <linux/rtnetlink.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"malformed netlink message: Deficit %d, rta_len=%d\"",
            "len",
            "rta->rta_len"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_NEXT",
          "args": [
            "rta",
            "len"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_OK",
          "args": [
            "rta",
            "len"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "tb",
            "0",
            "sizeof(struct rtattr *) * (max + 1)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"virnetlink.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n# include <linux/rtnetlink.h>\n#include <config.h>\n\nstatic int\nparse_rtattr(struct rtattr *tb[], int max, struct rtattr *rta, int len)\n{\n    memset(tb, 0, sizeof(struct rtattr *) * (max + 1));\n    VIR_WARNINGS_NO_CAST_ALIGN\n    for (; RTA_OK(rta, len); rta = RTA_NEXT(rta, len)) {\n        VIR_WARNINGS_RESET\n        if ((rta->rta_type <= max) && (!tb[rta->rta_type]))\n            tb[rta->rta_type] = rta;\n    }\n\n    if (len)\n        VIR_WARN(\"malformed netlink message: Deficit %d, rta_len=%d\",\n                 len, rta->rta_len);\n    return 0;\n}"
  }
]