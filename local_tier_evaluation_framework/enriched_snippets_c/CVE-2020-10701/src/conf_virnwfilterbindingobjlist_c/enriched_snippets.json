[
  {
    "function_name": "virNWFilterBindingObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "454-496",
    "snippet": "int\nvirNWFilterBindingObjListExport(virNWFilterBindingObjListPtr bindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingPtr **bindinglist,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    virNWFilterBindingObjPtr *bindingobjs = NULL;\n    size_t nbindings = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virNWFilterBindingObjListCollect(bindings, conn, &bindingobjs,\n                                         &nbindings, filter) < 0)\n        return -1;\n\n    if (bindinglist) {\n        if (VIR_ALLOC_N(*bindinglist, nbindings + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nbindings; i++) {\n            virNWFilterBindingObjPtr binding = bindingobjs[i];\n            virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n\n            virObjectLock(binding);\n            (*bindinglist)[i] = virGetNWFilterBinding(conn, def->portdevname,\n                                                      def->filter);\n            virObjectUnlock(binding);\n\n            if (!(*bindinglist)[i])\n                goto cleanup;\n        }\n    }\n\n    ret = nbindings;\n\n cleanup:\n    virObjectListFreeCount(bindingobjs, nbindings);\n    if (ret < 0) {\n        virObjectListFreeCount(*bindinglist, nbindings);\n        *bindinglist = NULL;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFreeCount",
          "args": [
            "*bindinglist",
            "nbindings"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFreeCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "625-638",
          "snippet": "void\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "binding"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilterBinding",
          "args": [
            "conn",
            "def->portdevname",
            "def->filter"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "binding"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "binding"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*bindinglist",
            "nbindings + 1"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListCollect",
          "args": [
            "bindings",
            "conn",
            "&bindingobjs",
            "&nbindings",
            "filter"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListCollect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "426-451",
          "snippet": "static int\nvirNWFilterBindingObjListCollect(virNWFilterBindingObjListPtr domlist,\n                                 virConnectPtr conn,\n                                 virNWFilterBindingObjPtr **bindings,\n                                 size_t *nbindings,\n                                 virNWFilterBindingObjListACLFilter filter)\n{\n    struct virNWFilterBindingListData data = { NULL, 0 };\n\n    virObjectRWLockRead(domlist);\n    sa_assert(domlist->objs);\n    if (VIR_ALLOC_N(data.bindings, virHashSize(domlist->objs)) < 0) {\n        virObjectRWUnlock(domlist);\n        return -1;\n    }\n\n    virHashForEach(domlist->objs, virNWFilterBindingObjListCollectIterator, &data);\n    virObjectRWUnlock(domlist);\n\n    virNWFilterBindingObjListFilter(&data.bindings, &data.nbindings, conn, filter);\n\n    *nbindings = data.nbindings;\n    *bindings = data.bindings;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListCollect(virNWFilterBindingObjListPtr domlist,\n                                 virConnectPtr conn,\n                                 virNWFilterBindingObjPtr **bindings,\n                                 size_t *nbindings,\n                                 virNWFilterBindingObjListACLFilter filter)\n{\n    struct virNWFilterBindingListData data = { NULL, 0 };\n\n    virObjectRWLockRead(domlist);\n    sa_assert(domlist->objs);\n    if (VIR_ALLOC_N(data.bindings, virHashSize(domlist->objs)) < 0) {\n        virObjectRWUnlock(domlist);\n        return -1;\n    }\n\n    virHashForEach(domlist->objs, virNWFilterBindingObjListCollectIterator, &data);\n    virObjectRWUnlock(domlist);\n\n    virNWFilterBindingObjListFilter(&data.bindings, &data.nbindings, conn, filter);\n\n    *nbindings = data.nbindings;\n    *bindings = data.bindings;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingObjListExport(virNWFilterBindingObjListPtr bindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingPtr **bindinglist,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    virNWFilterBindingObjPtr *bindingobjs = NULL;\n    size_t nbindings = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virNWFilterBindingObjListCollect(bindings, conn, &bindingobjs,\n                                         &nbindings, filter) < 0)\n        return -1;\n\n    if (bindinglist) {\n        if (VIR_ALLOC_N(*bindinglist, nbindings + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nbindings; i++) {\n            virNWFilterBindingObjPtr binding = bindingobjs[i];\n            virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n\n            virObjectLock(binding);\n            (*bindinglist)[i] = virGetNWFilterBinding(conn, def->portdevname,\n                                                      def->filter);\n            virObjectUnlock(binding);\n\n            if (!(*bindinglist)[i])\n                goto cleanup;\n        }\n    }\n\n    ret = nbindings;\n\n cleanup:\n    virObjectListFreeCount(bindingobjs, nbindings);\n    if (ret < 0) {\n        virObjectListFreeCount(*bindinglist, nbindings);\n        *bindinglist = NULL;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListCollect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "426-451",
    "snippet": "static int\nvirNWFilterBindingObjListCollect(virNWFilterBindingObjListPtr domlist,\n                                 virConnectPtr conn,\n                                 virNWFilterBindingObjPtr **bindings,\n                                 size_t *nbindings,\n                                 virNWFilterBindingObjListACLFilter filter)\n{\n    struct virNWFilterBindingListData data = { NULL, 0 };\n\n    virObjectRWLockRead(domlist);\n    sa_assert(domlist->objs);\n    if (VIR_ALLOC_N(data.bindings, virHashSize(domlist->objs)) < 0) {\n        virObjectRWUnlock(domlist);\n        return -1;\n    }\n\n    virHashForEach(domlist->objs, virNWFilterBindingObjListCollectIterator, &data);\n    virObjectRWUnlock(domlist);\n\n    virNWFilterBindingObjListFilter(&data.bindings, &data.nbindings, conn, filter);\n\n    *nbindings = data.nbindings;\n    *bindings = data.bindings;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListFilter",
          "args": [
            "&data.bindings",
            "&data.nbindings",
            "conn",
            "filter"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "392-423",
          "snippet": "static void\nvirNWFilterBindingObjListFilter(virNWFilterBindingObjPtr **list,\n                                size_t *nbindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    size_t i = 0;\n\n    while (i < *nbindings) {\n        virNWFilterBindingObjPtr binding = (*list)[i];\n        virNWFilterBindingDefPtr def;\n\n        virObjectLock(binding);\n\n        def = virNWFilterBindingObjGetDef(binding);\n        /* do not list the object if:\n         * 1) it's being removed.\n         * 2) connection does not have ACL to see it\n         * 3) it doesn't match the filter\n         */\n        if (virNWFilterBindingObjGetRemoving(binding) ||\n            (filter && !filter(conn, def))) {\n            virObjectUnlock(binding);\n            virObjectUnref(binding);\n            VIR_DELETE_ELEMENT(*list, i, *nbindings);\n            continue;\n        }\n\n        virObjectUnlock(binding);\n        i++;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirNWFilterBindingObjListFilter(virNWFilterBindingObjPtr **list,\n                                size_t *nbindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    size_t i = 0;\n\n    while (i < *nbindings) {\n        virNWFilterBindingObjPtr binding = (*list)[i];\n        virNWFilterBindingDefPtr def;\n\n        virObjectLock(binding);\n\n        def = virNWFilterBindingObjGetDef(binding);\n        /* do not list the object if:\n         * 1) it's being removed.\n         * 2) connection does not have ACL to see it\n         * 3) it doesn't match the filter\n         */\n        if (virNWFilterBindingObjGetRemoving(binding) ||\n            (filter && !filter(conn, def))) {\n            virObjectUnlock(binding);\n            virObjectUnref(binding);\n            VIR_DELETE_ELEMENT(*list, i, *nbindings);\n            continue;\n        }\n\n        virObjectUnlock(binding);\n        i++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "domlist"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "domlist->objs",
            "virNWFilterBindingObjListCollectIterator",
            "&data"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.bindings",
            "virHashSize(domlist->objs)"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "domlist->objs"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sa_assert",
          "args": [
            "domlist->objs"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "domlist"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListCollect(virNWFilterBindingObjListPtr domlist,\n                                 virConnectPtr conn,\n                                 virNWFilterBindingObjPtr **bindings,\n                                 size_t *nbindings,\n                                 virNWFilterBindingObjListACLFilter filter)\n{\n    struct virNWFilterBindingListData data = { NULL, 0 };\n\n    virObjectRWLockRead(domlist);\n    sa_assert(domlist->objs);\n    if (VIR_ALLOC_N(data.bindings, virHashSize(domlist->objs)) < 0) {\n        virObjectRWUnlock(domlist);\n        return -1;\n    }\n\n    virHashForEach(domlist->objs, virNWFilterBindingObjListCollectIterator, &data);\n    virObjectRWUnlock(domlist);\n\n    virNWFilterBindingObjListFilter(&data.bindings, &data.nbindings, conn, filter);\n\n    *nbindings = data.nbindings;\n    *bindings = data.bindings;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "392-423",
    "snippet": "static void\nvirNWFilterBindingObjListFilter(virNWFilterBindingObjPtr **list,\n                                size_t *nbindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    size_t i = 0;\n\n    while (i < *nbindings) {\n        virNWFilterBindingObjPtr binding = (*list)[i];\n        virNWFilterBindingDefPtr def;\n\n        virObjectLock(binding);\n\n        def = virNWFilterBindingObjGetDef(binding);\n        /* do not list the object if:\n         * 1) it's being removed.\n         * 2) connection does not have ACL to see it\n         * 3) it doesn't match the filter\n         */\n        if (virNWFilterBindingObjGetRemoving(binding) ||\n            (filter && !filter(conn, def))) {\n            virObjectUnlock(binding);\n            virObjectUnref(binding);\n            VIR_DELETE_ELEMENT(*list, i, *nbindings);\n            continue;\n        }\n\n        virObjectUnlock(binding);\n        i++;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "binding"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "*list",
            "i",
            "*nbindings"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "binding"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "filter",
          "args": [
            "conn",
            "def"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "make_nonnull_nwfilter_binding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/remote/remote_daemon_dispatch.c",
          "lines": "7368-7373",
          "snippet": "static void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}",
          "includes": [
            "#include \"lxc_daemon_dispatch_stubs.h\"",
            "#include \"qemu_daemon_dispatch_stubs.h\"",
            "#include \"remote_daemon_dispatch_stubs.h\"",
            "#include \"access/viraccessapicheck.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virpolkit.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virprobe.h\"",
            "#include \"network_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"object_event.h\"",
            "#include \"virstring.h\"",
            "#include \"lxc_protocol.h\"",
            "#include \"qemu_protocol.h\"",
            "#include \"remote_protocol.h\"",
            "#include \"virprocess.h\"",
            "#include \"virdbus.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virnetserverservice.h\"",
            "#include \"vircommand.h\"",
            "#include \"viruuid.h\"",
            "#include \"remote_daemon_stream.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"remote_daemon.h\"",
            "#include \"remote_daemon_dispatch.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"lxc_daemon_dispatch_stubs.h\"\n#include \"qemu_daemon_dispatch_stubs.h\"\n#include \"remote_daemon_dispatch_stubs.h\"\n#include \"access/viraccessapicheck.h\"\n#include \"configmake.h\"\n#include \"virthreadjob.h\"\n#include \"virpolkit.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virprobe.h\"\n#include \"network_conf.h\"\n#include \"domain_conf.h\"\n#include \"object_event.h\"\n#include \"virstring.h\"\n#include \"lxc_protocol.h\"\n#include \"qemu_protocol.h\"\n#include \"remote_protocol.h\"\n#include \"virprocess.h\"\n#include \"virdbus.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virnetserver.h\"\n#include \"virnetserverservice.h\"\n#include \"vircommand.h\"\n#include \"viruuid.h\"\n#include \"remote_daemon_stream.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"libvirt_internal.h\"\n#include \"remote_daemon.h\"\n#include \"remote_daemon_dispatch.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void make_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src);\n\nstatic void\nmake_nonnull_nwfilter_binding(remote_nonnull_nwfilter_binding *binding_dst, virNWFilterBindingPtr binding_src)\n{\n    binding_dst->portdev = g_strdup(binding_src->portdev);\n    binding_dst->filtername = g_strdup(binding_src->filtername);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetRemoving",
          "args": [
            "binding"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetRemoving",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "99-103",
          "snippet": "bool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nbool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "binding"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "binding"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirNWFilterBindingObjListFilter(virNWFilterBindingObjPtr **list,\n                                size_t *nbindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    size_t i = 0;\n\n    while (i < *nbindings) {\n        virNWFilterBindingObjPtr binding = (*list)[i];\n        virNWFilterBindingDefPtr def;\n\n        virObjectLock(binding);\n\n        def = virNWFilterBindingObjGetDef(binding);\n        /* do not list the object if:\n         * 1) it's being removed.\n         * 2) connection does not have ACL to see it\n         * 3) it doesn't match the filter\n         */\n        if (virNWFilterBindingObjGetRemoving(binding) ||\n            (filter && !filter(conn, def))) {\n            virObjectUnlock(binding);\n            virObjectUnref(binding);\n            VIR_DELETE_ELEMENT(*list, i, *nbindings);\n            continue;\n        }\n\n        virObjectUnlock(binding);\n        i++;\n    }\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListCollectIterator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "380-389",
    "snippet": "static int\nvirNWFilterBindingObjListCollectIterator(void *payload,\n                                         const void *name G_GNUC_UNUSED,\n                                         void *opaque)\n{\n    struct virNWFilterBindingListData *data = opaque;\n\n    data->bindings[data->nbindings++] = virObjectRef(payload);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "payload"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListCollectIterator(void *payload,\n                                         const void *name G_GNUC_UNUSED,\n                                         void *opaque)\n{\n    struct virNWFilterBindingListData *data = opaque;\n\n    data->bindings[data->nbindings++] = virObjectRef(payload);\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "359-371",
    "snippet": "int\nvirNWFilterBindingObjListForEach(virNWFilterBindingObjListPtr bindings,\n                                 virNWFilterBindingObjListIterator callback,\n                                 void *opaque)\n{\n    struct virNWFilterBindingListIterData data = {\n        callback, opaque, 0,\n    };\n    virObjectRWLockRead(bindings);\n    virHashForEach(bindings->objs, virNWFilterBindingObjListHelper, &data);\n    virObjectRWUnlock(bindings);\n    return data.ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "bindings"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "bindings->objs",
            "virNWFilterBindingObjListHelper",
            "&data"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "bindings"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingObjListForEach(virNWFilterBindingObjListPtr bindings,\n                                 virNWFilterBindingObjListIterator callback,\n                                 void *opaque)\n{\n    struct virNWFilterBindingListIterData data = {\n        callback, opaque, 0,\n    };\n    virObjectRWLockRead(bindings);\n    virHashForEach(bindings->objs, virNWFilterBindingObjListHelper, &data);\n    virObjectRWUnlock(bindings);\n    return data.ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "346-356",
    "snippet": "static int\nvirNWFilterBindingObjListHelper(void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                void *opaque)\n{\n    struct virNWFilterBindingListIterData *data = opaque;\n\n    if (data->callback(payload, data->opaque) < 0)\n        data->ret = -1;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data->callback",
          "args": [
            "payload",
            "data->opaque"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListHelper(void *payload,\n                                const void *name G_GNUC_UNUSED,\n                                void *opaque)\n{\n    struct virNWFilterBindingListIterData *data = opaque;\n\n    if (data->callback(payload, data->opaque) < 0)\n        data->ret = -1;\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListLoadAllConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "299-336",
    "snippet": "int\nvirNWFilterBindingObjListLoadAllConfigs(virNWFilterBindingObjListPtr bindings,\n                                        const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(bindings);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterBindingObjPtr binding;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        binding = virNWFilterBindingObjListLoadStatus(bindings,\n                                                      configDir,\n                                                      entry->d_name);\n        if (binding)\n            virNWFilterBindingObjEndAPI(&binding);\n        else\n            VIR_ERROR(_(\"Failed to load config for binding '%s'\"), entry->d_name);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(bindings);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "bindings"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Failed to load config for binding '%s'\")",
            "entry->d_name"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to load config for binding '%s'\""
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&binding"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListLoadStatus",
          "args": [
            "bindings",
            "configDir",
            "entry->d_name"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListLoadStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "263-296",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListLoadStatus(virNWFilterBindingObjListPtr bindings,\n                                    const char *statusDir,\n                                    const char *name)\n{\n    char *statusFile = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingDefPtr def;\n\n    if ((statusFile = virNWFilterBindingObjConfigFile(statusDir, name)) == NULL)\n        goto error;\n\n    if (!(obj = virNWFilterBindingObjParseFile(statusFile)))\n        goto error;\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virHashLookup(bindings->objs, def->portdevname) != NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected binding %s already exists\"),\n                       def->portdevname);\n        goto error;\n    }\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, obj) < 0)\n        goto error;\n\n    VIR_FREE(statusFile);\n    return obj;\n\n error:\n    virNWFilterBindingObjEndAPI(&obj);\n    VIR_FREE(statusFile);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListLoadStatus(virNWFilterBindingObjListPtr bindings,\n                                    const char *statusDir,\n                                    const char *name)\n{\n    char *statusFile = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingDefPtr def;\n\n    if ((statusFile = virNWFilterBindingObjConfigFile(statusDir, name)) == NULL)\n        goto error;\n\n    if (!(obj = virNWFilterBindingObjParseFile(statusFile)))\n        goto error;\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virHashLookup(bindings->objs, def->portdevname) != NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected binding %s already exists\"),\n                       def->portdevname);\n        goto error;\n    }\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, obj) < 0)\n        goto error;\n\n    VIR_FREE(statusFile);\n    return obj;\n\n error:\n    virNWFilterBindingObjEndAPI(&obj);\n    VIR_FREE(statusFile);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Loading config file '%s.xml'\"",
            "entry->d_name"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringStripSuffix",
          "args": [
            "entry->d_name",
            "\".xml\""
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1123-1139",
          "snippet": "bool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringStripSuffix(char *str,\n                     const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    if (STRNEQ(str + len - suffixlen, suffix))\n        return false;\n\n    str[len - suffixlen] = '\\0';\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&entry",
            "configDir"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "bindings"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "configDir"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Scanning for configs in %s\"",
            "configDir"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingObjListLoadAllConfigs(virNWFilterBindingObjListPtr bindings,\n                                        const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(bindings);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterBindingObjPtr binding;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        binding = virNWFilterBindingObjListLoadStatus(bindings,\n                                                      configDir,\n                                                      entry->d_name);\n        if (binding)\n            virNWFilterBindingObjEndAPI(&binding);\n        else\n            VIR_ERROR(_(\"Failed to load config for binding '%s'\"), entry->d_name);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(bindings);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListLoadStatus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "263-296",
    "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListLoadStatus(virNWFilterBindingObjListPtr bindings,\n                                    const char *statusDir,\n                                    const char *name)\n{\n    char *statusFile = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingDefPtr def;\n\n    if ((statusFile = virNWFilterBindingObjConfigFile(statusDir, name)) == NULL)\n        goto error;\n\n    if (!(obj = virNWFilterBindingObjParseFile(statusFile)))\n        goto error;\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virHashLookup(bindings->objs, def->portdevname) != NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected binding %s already exists\"),\n                       def->portdevname);\n        goto error;\n    }\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, obj) < 0)\n        goto error;\n\n    VIR_FREE(statusFile);\n    return obj;\n\n error:\n    virNWFilterBindingObjEndAPI(&obj);\n    VIR_FREE(statusFile);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "statusFile"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "statusFile"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListAddObjLocked",
          "args": [
            "bindings",
            "obj"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListAddObjLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "146-156",
          "snippet": "static int\nvirNWFilterBindingObjListAddObjLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    if (virHashAddEntry(bindings->objs, def->portdevname, binding) < 0)\n        return -1;\n    virObjectRef(binding);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListAddObjLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    if (virHashAddEntry(bindings->objs, def->portdevname, binding) < 0)\n        return -1;\n    virObjectRef(binding);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected binding %s already exists\")",
            "def->portdevname"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected binding %s already exists\""
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "bindings->objs",
            "def->portdevname"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "obj"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjParseFile",
          "args": [
            "statusFile"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjParseFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "277-281",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjParseFile(const char *filename)\n{\n    return virNWFilterBindingObjParse(NULL, filename);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjParseFile(const char *filename)\n{\n    return virNWFilterBindingObjParse(NULL, filename);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjConfigFile",
          "args": [
            "statusDir",
            "name"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "137-145",
          "snippet": "char *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirNWFilterBindingObjConfigFile(const char *dir,\n                                const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListLoadStatus(virNWFilterBindingObjListPtr bindings,\n                                    const char *statusDir,\n                                    const char *name)\n{\n    char *statusFile = NULL;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingDefPtr def;\n\n    if ((statusFile = virNWFilterBindingObjConfigFile(statusDir, name)) == NULL)\n        goto error;\n\n    if (!(obj = virNWFilterBindingObjParseFile(statusFile)))\n        goto error;\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virHashLookup(bindings->objs, def->portdevname) != NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected binding %s already exists\"),\n                       def->portdevname);\n        goto error;\n    }\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, obj) < 0)\n        goto error;\n\n    VIR_FREE(statusFile);\n    return obj;\n\n error:\n    virNWFilterBindingObjEndAPI(&obj);\n    VIR_FREE(statusFile);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "248-260",
    "snippet": "void\nvirNWFilterBindingObjListRemove(virNWFilterBindingObjListPtr bindings,\n                                virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingObjSetRemoving(binding, true);\n    virObjectRef(binding);\n    virObjectUnlock(binding);\n    virObjectRWLockWrite(bindings);\n    virObjectLock(binding);\n    virNWFilterBindingObjListRemoveLocked(bindings, binding);\n    virObjectUnref(binding);\n    virObjectRWUnlock(bindings);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "bindings"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "binding"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListRemoveLocked",
          "args": [
            "bindings",
            "binding"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListRemoveLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "226-232",
          "snippet": "static void\nvirNWFilterBindingObjListRemoveLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    virHashRemoveEntry(bindings->objs, def->portdevname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirNWFilterBindingObjListRemoveLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    virHashRemoveEntry(bindings->objs, def->portdevname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "binding"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "bindings"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "binding"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "binding"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjSetRemoving",
          "args": [
            "binding",
            "true"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjSetRemoving",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "106-111",
          "snippet": "void\nvirNWFilterBindingObjSetRemoving(virNWFilterBindingObjPtr obj,\n                                 bool removing)\n{\n    obj->removing = removing;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjSetRemoving(virNWFilterBindingObjPtr obj,\n                                 bool removing)\n{\n    obj->removing = removing;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingObjListRemove(virNWFilterBindingObjListPtr bindings,\n                                virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingObjSetRemoving(binding, true);\n    virObjectRef(binding);\n    virObjectUnlock(binding);\n    virObjectRWLockWrite(bindings);\n    virObjectLock(binding);\n    virNWFilterBindingObjListRemoveLocked(bindings, binding);\n    virObjectUnref(binding);\n    virObjectRWUnlock(bindings);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListRemoveLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "226-232",
    "snippet": "static void\nvirNWFilterBindingObjListRemoveLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    virHashRemoveEntry(bindings->objs, def->portdevname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "bindings->objs",
            "def->portdevname"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "binding"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirNWFilterBindingObjListRemoveLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    virHashRemoveEntry(bindings->objs, def->portdevname);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "207-217",
    "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjListAdd(virNWFilterBindingObjListPtr bindings,\n                             virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr ret;\n\n    virObjectRWLockWrite(bindings);\n    ret = virNWFilterBindingObjListAddLocked(bindings, def);\n    virObjectRWUnlock(bindings);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "bindings"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListAddLocked",
          "args": [
            "bindings",
            "def"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListAddLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "166-204",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListAddLocked(virNWFilterBindingObjListPtr bindings,\n                                   virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr binding;\n    bool stealDef = false;\n\n    /* See if a binding with matching portdev already exists */\n    binding = virNWFilterBindingObjListFindByPortDevLocked(bindings, def->portdevname);\n    if (binding) {\n        if (virNWFilterBindingObjGetRemoving(binding)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' is already being removed\"),\n                           def->portdevname);\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' already exists\"),\n                           def->portdevname);\n        }\n        goto error;\n    }\n\n    if (!(binding = virNWFilterBindingObjNew()))\n        goto error;\n\n    virNWFilterBindingObjSetDef(binding, def);\n    stealDef = true;\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, binding) < 0)\n        goto error;\n\n    return binding;\n\n error:\n    if (stealDef)\n        virNWFilterBindingObjStealDef(binding);\n    virNWFilterBindingObjEndAPI(&binding);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListAddLocked(virNWFilterBindingObjListPtr bindings,\n                                   virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr binding;\n    bool stealDef = false;\n\n    /* See if a binding with matching portdev already exists */\n    binding = virNWFilterBindingObjListFindByPortDevLocked(bindings, def->portdevname);\n    if (binding) {\n        if (virNWFilterBindingObjGetRemoving(binding)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' is already being removed\"),\n                           def->portdevname);\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' already exists\"),\n                           def->portdevname);\n        }\n        goto error;\n    }\n\n    if (!(binding = virNWFilterBindingObjNew()))\n        goto error;\n\n    virNWFilterBindingObjSetDef(binding, def);\n    stealDef = true;\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, binding) < 0)\n        goto error;\n\n    return binding;\n\n error:\n    if (stealDef)\n        virNWFilterBindingObjStealDef(binding);\n    virNWFilterBindingObjEndAPI(&binding);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "bindings"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjListAdd(virNWFilterBindingObjListPtr bindings,\n                             virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr ret;\n\n    virObjectRWLockWrite(bindings);\n    ret = virNWFilterBindingObjListAddLocked(bindings, def);\n    virObjectRWUnlock(bindings);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListAddLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "166-204",
    "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListAddLocked(virNWFilterBindingObjListPtr bindings,\n                                   virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr binding;\n    bool stealDef = false;\n\n    /* See if a binding with matching portdev already exists */\n    binding = virNWFilterBindingObjListFindByPortDevLocked(bindings, def->portdevname);\n    if (binding) {\n        if (virNWFilterBindingObjGetRemoving(binding)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' is already being removed\"),\n                           def->portdevname);\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' already exists\"),\n                           def->portdevname);\n        }\n        goto error;\n    }\n\n    if (!(binding = virNWFilterBindingObjNew()))\n        goto error;\n\n    virNWFilterBindingObjSetDef(binding, def);\n    stealDef = true;\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, binding) < 0)\n        goto error;\n\n    return binding;\n\n error:\n    if (stealDef)\n        virNWFilterBindingObjStealDef(binding);\n    virNWFilterBindingObjEndAPI(&binding);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&binding"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjStealDef",
          "args": [
            "binding"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjStealDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "92-96",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjStealDef(virNWFilterBindingObjPtr obj)\n{\n    return g_steal_pointer(&obj->def);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjStealDef(virNWFilterBindingObjPtr obj)\n{\n    return g_steal_pointer(&obj->def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListAddObjLocked",
          "args": [
            "bindings",
            "binding"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListAddObjLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "146-156",
          "snippet": "static int\nvirNWFilterBindingObjListAddObjLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    if (virHashAddEntry(bindings->objs, def->portdevname, binding) < 0)\n        return -1;\n    virObjectRef(binding);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListAddObjLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    if (virHashAddEntry(bindings->objs, def->portdevname, binding) < 0)\n        return -1;\n    virObjectRef(binding);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjSetDef",
          "args": [
            "binding",
            "def"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjSetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "83-89",
          "snippet": "void\nvirNWFilterBindingObjSetDef(virNWFilterBindingObjPtr obj,\n                            virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingDefFree(obj->def);\n    obj->def = def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjSetDef(virNWFilterBindingObjPtr obj,\n                            virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingDefFree(obj->def);\n    obj->def = def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjNew",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "57-64",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjNew(void)\n{\n    if (virNWFilterBindingObjInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virNWFilterBindingObjClass);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNWFilterBindingObjClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virNWFilterBindingObjClass;\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjNew(void)\n{\n    if (virNWFilterBindingObjInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virNWFilterBindingObjClass);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"binding '%s' already exists\")",
            "def->portdevname"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"binding '%s' already exists\""
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"binding '%s' is already being removed\")",
            "def->portdevname"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetRemoving",
          "args": [
            "binding"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetRemoving",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "99-103",
          "snippet": "bool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nbool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListFindByPortDevLocked",
          "args": [
            "bindings",
            "def->portdevname"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListFindByPortDevLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "87-99",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDevLocked(virNWFilterBindingObjListPtr bindings,\n                                             const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    obj = virHashLookup(bindings->objs, name);\n    if (obj) {\n        virObjectRef(obj);\n        virObjectLock(obj);\n    }\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDevLocked(virNWFilterBindingObjListPtr bindings,\n                                             const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    obj = virHashLookup(bindings->objs, name);\n    if (obj) {\n        virObjectRef(obj);\n        virObjectLock(obj);\n    }\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListAddLocked(virNWFilterBindingObjListPtr bindings,\n                                   virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr binding;\n    bool stealDef = false;\n\n    /* See if a binding with matching portdev already exists */\n    binding = virNWFilterBindingObjListFindByPortDevLocked(bindings, def->portdevname);\n    if (binding) {\n        if (virNWFilterBindingObjGetRemoving(binding)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' is already being removed\"),\n                           def->portdevname);\n        } else {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"binding '%s' already exists\"),\n                           def->portdevname);\n        }\n        goto error;\n    }\n\n    if (!(binding = virNWFilterBindingObjNew()))\n        goto error;\n\n    virNWFilterBindingObjSetDef(binding, def);\n    stealDef = true;\n\n    if (virNWFilterBindingObjListAddObjLocked(bindings, binding) < 0)\n        goto error;\n\n    return binding;\n\n error:\n    if (stealDef)\n        virNWFilterBindingObjStealDef(binding);\n    virNWFilterBindingObjEndAPI(&binding);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListAddObjLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "146-156",
    "snippet": "static int\nvirNWFilterBindingObjListAddObjLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    if (virHashAddEntry(bindings->objs, def->portdevname, binding) < 0)\n        return -1;\n    virObjectRef(binding);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "binding"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "bindings->objs",
            "def->portdevname",
            "binding"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "binding"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterBindingObjListAddObjLocked(virNWFilterBindingObjListPtr bindings,\n                                      virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n    if (virHashAddEntry(bindings->objs, def->portdevname, binding) < 0)\n        return -1;\n    virObjectRef(binding);\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListFindByPortDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "110-127",
    "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetRemoving",
          "args": [
            "obj"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetRemoving",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "99-103",
          "snippet": "bool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nbool\nvirNWFilterBindingObjGetRemoving(virNWFilterBindingObjPtr obj)\n{\n    return obj->removing;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "bindings"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListFindByPortDevLocked",
          "args": [
            "bindings",
            "name"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListFindByPortDevLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "87-99",
          "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDevLocked(virNWFilterBindingObjListPtr bindings,\n                                             const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    obj = virHashLookup(bindings->objs, name);\n    if (obj) {\n        virObjectRef(obj);\n        virObjectLock(obj);\n    }\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDevLocked(virNWFilterBindingObjListPtr bindings,\n                                             const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    obj = virHashLookup(bindings->objs, name);\n    if (obj) {\n        virObjectRef(obj);\n        virObjectLock(obj);\n    }\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "bindings"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListFindByPortDevLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "87-99",
    "snippet": "static virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDevLocked(virNWFilterBindingObjListPtr bindings,\n                                             const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    obj = virHashLookup(bindings->objs, name);\n    if (obj) {\n        virObjectRef(obj);\n        virObjectLock(obj);\n    }\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "bindings->objs",
            "name"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nstatic virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDevLocked(virNWFilterBindingObjListPtr bindings,\n                                             const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    obj = virHashLookup(bindings->objs, name);\n    if (obj) {\n        virObjectRef(obj);\n        virObjectLock(obj);\n    }\n    return obj;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "78-84",
    "snippet": "static void\nvirNWFilterBindingObjListDispose(void *obj)\n{\n    virNWFilterBindingObjListPtr bindings = obj;\n\n    virHashFree(bindings->objs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterBindingObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "bindings->objs"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nstatic void\nvirNWFilterBindingObjListDispose(void *obj)\n{\n    virNWFilterBindingObjListPtr bindings = obj;\n\n    virHashFree(bindings->objs);\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "58-75",
    "snippet": "virNWFilterBindingObjListPtr\nvirNWFilterBindingObjListNew(void)\n{\n    virNWFilterBindingObjListPtr bindings;\n\n    if (virNWFilterBindingObjListInitialize() < 0)\n        return NULL;\n\n    if (!(bindings = virObjectRWLockableNew(virNWFilterBindingObjListClass)))\n        return NULL;\n\n    if (!(bindings->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(bindings);\n        return NULL;\n    }\n\n    return bindings;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNWFilterBindingObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "bindings"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "virObjectFreeHashData"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virNWFilterBindingObjListClass"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListInitialize",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virNWFilterBindingObjListClass;\n\nvirNWFilterBindingObjListPtr\nvirNWFilterBindingObjListNew(void)\n{\n    virNWFilterBindingObjListPtr bindings;\n\n    if (virNWFilterBindingObjListInitialize() < 0)\n        return NULL;\n\n    if (!(bindings = virObjectRWLockableNew(virNWFilterBindingObjListClass)))\n        return NULL;\n\n    if (!(bindings->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(bindings);\n        return NULL;\n    }\n\n    return bindings;\n}"
  },
  {
    "function_name": "virNWFilterBindingObjListOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
    "lines": "47-53",
    "snippet": "static int virNWFilterBindingObjListOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNWFilterBindingObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnwfilterbindingobjlist.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNWFilterBindingObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virNWFilterBindingObjListOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNWFilterBindingObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]