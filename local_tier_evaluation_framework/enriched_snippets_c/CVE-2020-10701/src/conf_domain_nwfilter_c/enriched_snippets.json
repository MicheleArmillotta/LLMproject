[
  {
    "function_name": "virDomainConfVMNWFilterTeardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
    "lines": "159-178",
    "snippet": "void\nvirDomainConfVMNWFilterTeardown(virDomainObjPtr vm)\n{\n    size_t i;\n    virConnectPtr conn = NULL;\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n\n        if (!net->filter)\n            continue;\n\n        if (!conn && !(conn = virGetConnectNWFilter()))\n            return;\n\n        virDomainConfNWFilterTeardownImpl(conn, net);\n    }\n\n    virObjectUnref(conn);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainConfNWFilterTeardownImpl",
          "args": [
            "conn",
            "net"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfNWFilterTeardownImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
          "lines": "124-140",
          "snippet": "static void\nvirDomainConfNWFilterTeardownImpl(virConnectPtr conn,\n                                  virDomainNetDefPtr net)\n{\n    virNWFilterBindingPtr binding;\n\n    if (!net->ifname)\n        return;\n\n    binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n    if (!binding)\n        return;\n\n    virNWFilterBindingDelete(binding);\n\n    virObjectUnref(binding);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainConfNWFilterTeardownImpl(virConnectPtr conn,\n                                  virDomainNetDefPtr net)\n{\n    virNWFilterBindingPtr binding;\n\n    if (!net->ifname)\n        return;\n\n    binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n    if (!binding)\n        return;\n\n    virNWFilterBindingDelete(binding);\n\n    virObjectUnref(binding);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetConnectNWFilter",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNWFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "174-177",
          "snippet": "virConnectPtr virGetConnectNWFilter(void)\n{\n    return virGetConnectGeneric(&connectNWFilter, \"nwfilter\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNWFilter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNWFilter;\n\nvirConnectPtr virGetConnectNWFilter(void)\n{\n    return virGetConnectGeneric(&connectNWFilter, \"nwfilter\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainConfVMNWFilterTeardown(virDomainObjPtr vm)\n{\n    size_t i;\n    virConnectPtr conn = NULL;\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n\n        if (!net->filter)\n            continue;\n\n        if (!conn && !(conn = virGetConnectNWFilter()))\n            return;\n\n        virDomainConfNWFilterTeardownImpl(conn, net);\n    }\n\n    virObjectUnref(conn);\n}"
  },
  {
    "function_name": "virDomainConfNWFilterTeardown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
    "lines": "143-157",
    "snippet": "void\nvirDomainConfNWFilterTeardown(virDomainNetDefPtr net)\n{\n    virConnectPtr conn;\n\n    if (!net->filter)\n        return;\n\n    if (!(conn = virGetConnectNWFilter()))\n        return;\n\n    virDomainConfNWFilterTeardownImpl(conn, net);\n\n    virObjectUnref(conn);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainConfNWFilterTeardownImpl",
          "args": [
            "conn",
            "net"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfNWFilterTeardownImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
          "lines": "124-140",
          "snippet": "static void\nvirDomainConfNWFilterTeardownImpl(virConnectPtr conn,\n                                  virDomainNetDefPtr net)\n{\n    virNWFilterBindingPtr binding;\n\n    if (!net->ifname)\n        return;\n\n    binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n    if (!binding)\n        return;\n\n    virNWFilterBindingDelete(binding);\n\n    virObjectUnref(binding);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainConfNWFilterTeardownImpl(virConnectPtr conn,\n                                  virDomainNetDefPtr net)\n{\n    virNWFilterBindingPtr binding;\n\n    if (!net->ifname)\n        return;\n\n    binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n    if (!binding)\n        return;\n\n    virNWFilterBindingDelete(binding);\n\n    virObjectUnref(binding);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetConnectNWFilter",
          "args": [],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNWFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "174-177",
          "snippet": "virConnectPtr virGetConnectNWFilter(void)\n{\n    return virGetConnectGeneric(&connectNWFilter, \"nwfilter\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNWFilter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNWFilter;\n\nvirConnectPtr virGetConnectNWFilter(void)\n{\n    return virGetConnectGeneric(&connectNWFilter, \"nwfilter\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainConfNWFilterTeardown(virDomainNetDefPtr net)\n{\n    virConnectPtr conn;\n\n    if (!net->filter)\n        return;\n\n    if (!(conn = virGetConnectNWFilter()))\n        return;\n\n    virDomainConfNWFilterTeardownImpl(conn, net);\n\n    virObjectUnref(conn);\n}"
  },
  {
    "function_name": "virDomainConfNWFilterTeardownImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
    "lines": "124-140",
    "snippet": "static void\nvirDomainConfNWFilterTeardownImpl(virConnectPtr conn,\n                                  virDomainNetDefPtr net)\n{\n    virNWFilterBindingPtr binding;\n\n    if (!net->ifname)\n        return;\n\n    binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n    if (!binding)\n        return;\n\n    virNWFilterBindingDelete(binding);\n\n    virObjectUnref(binding);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "binding"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDelete",
          "args": [
            "binding"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
          "lines": "736-762",
          "snippet": "int\nvirNWFilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n    conn = binding->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingDelete) {\n        int ret;\n        ret = conn->nwfilterDriver->nwfilterBindingDelete(binding);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(binding->conn);\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"binding=%p\", binding);\n\n    virResetLastError();\n\n    virCheckNWFilterBindingReturn(binding, -1);\n    conn = binding->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingDelete) {\n        int ret;\n        ret = conn->nwfilterDriver->nwfilterBindingDelete(binding);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(binding->conn);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingLookupByPortDev",
          "args": [
            "conn",
            "net->ifname"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingLookupByPortDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
          "lines": "581-604",
          "snippet": "virNWFilterBindingPtr\nvirNWFilterBindingLookupByPortDev(virConnectPtr conn, const char *portdev)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(portdev));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingLookupByPortDev) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingLookupByPortDev(conn, portdev);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterBindingPtr\nvirNWFilterBindingLookupByPortDev(virConnectPtr conn, const char *portdev)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(portdev));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingLookupByPortDev) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingLookupByPortDev(conn, portdev);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainConfNWFilterTeardownImpl(virConnectPtr conn,\n                                  virDomainNetDefPtr net)\n{\n    virNWFilterBindingPtr binding;\n\n    if (!net->ifname)\n        return;\n\n    binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n    if (!binding)\n        return;\n\n    virNWFilterBindingDelete(binding);\n\n    virObjectUnref(binding);\n}"
  },
  {
    "function_name": "virDomainConfNWFilterInstantiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
    "lines": "78-121",
    "snippet": "int\nvirDomainConfNWFilterInstantiate(const char *vmname,\n                                 const unsigned char *vmuuid,\n                                 virDomainNetDefPtr net,\n                                 bool ignoreExists)\n{\n    virConnectPtr conn = virGetConnectNWFilter();\n    virNWFilterBindingDefPtr def = NULL;\n    virNWFilterBindingPtr binding = NULL;\n    char *xml = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"vmname=%s portdev=%s filter=%s ignoreExists=%d\",\n              vmname, NULLSTR(net->ifname), NULLSTR(net->filter), ignoreExists);\n\n    if (!conn)\n        goto cleanup;\n\n    if (ignoreExists) {\n        binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n        if (binding) {\n            ret = 0;\n            goto cleanup;\n        }\n    }\n\n    if (!(def = virNWFilterBindingDefForNet(vmname, vmuuid, net)))\n        goto cleanup;\n\n    if (!(xml = virNWFilterBindingDefFormat(def)))\n        goto cleanup;\n\n    if (!(binding = virNWFilterBindingCreateXML(conn, xml, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(xml);\n    virNWFilterBindingDefFree(def);\n    virObjectUnref(binding);\n    virObjectUnref(conn);\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "def"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingCreateXML",
          "args": [
            "conn",
            "xml",
            "0"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
          "lines": "695-719",
          "snippet": "virNWFilterBindingPtr\nvirNWFilterBindingCreateXML(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingCreateXML) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingCreateXML(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterBindingPtr\nvirNWFilterBindingCreateXML(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingCreateXML) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingCreateXML(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFormat",
          "args": [
            "def"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "223-234",
          "snippet": "char *\nvirNWFilterBindingDefFormat(const virNWFilterBindingDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virNWFilterBindingDefFormatBuf(&buf, def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirNWFilterBindingDefFormat(const virNWFilterBindingDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virNWFilterBindingDefFormatBuf(&buf, def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefForNet",
          "args": [
            "vmname",
            "vmuuid",
            "net"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefForNet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
          "lines": "40-75",
          "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefForNet(const char *vmname,\n                            const unsigned char *vmuuid,\n                            virDomainNetDefPtr net)\n{\n    virNWFilterBindingDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->ownername = g_strdup(vmname);\n\n    memcpy(ret->owneruuid, vmuuid, sizeof(ret->owneruuid));\n\n    ret->portdevname = g_strdup(net->ifname);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        ret->linkdevname = g_strdup(net->data.direct.linkdev);\n\n    ret->mac = net->mac;\n\n    ret->filter = g_strdup(net->filter);\n\n    if (!(ret->filterparams = virNWFilterHashTableCreate(0)))\n        goto error;\n\n    if (net->filterparams &&\n        virNWFilterHashTablePutAll(net->filterparams, ret->filterparams) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefForNet(const char *vmname,\n                            const unsigned char *vmuuid,\n                            virDomainNetDefPtr net)\n{\n    virNWFilterBindingDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->ownername = g_strdup(vmname);\n\n    memcpy(ret->owneruuid, vmuuid, sizeof(ret->owneruuid));\n\n    ret->portdevname = g_strdup(net->ifname);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        ret->linkdevname = g_strdup(net->data.direct.linkdev);\n\n    ret->mac = net->mac;\n\n    ret->filter = g_strdup(net->filter);\n\n    if (!(ret->filterparams = virNWFilterHashTableCreate(0)))\n        goto error;\n\n    if (net->filterparams &&\n        virNWFilterHashTablePutAll(net->filterparams, ret->filterparams) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingLookupByPortDev",
          "args": [
            "conn",
            "net->ifname"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingLookupByPortDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-nwfilter.c",
          "lines": "581-604",
          "snippet": "virNWFilterBindingPtr\nvirNWFilterBindingLookupByPortDev(virConnectPtr conn, const char *portdev)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(portdev));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingLookupByPortDev) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingLookupByPortDev(conn, portdev);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNWFilterBindingPtr\nvirNWFilterBindingLookupByPortDev(virConnectPtr conn, const char *portdev)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(portdev));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (conn->nwfilterDriver && conn->nwfilterDriver->nwfilterBindingLookupByPortDev) {\n        virNWFilterBindingPtr ret;\n        ret = conn->nwfilterDriver->nwfilterBindingLookupByPortDev(conn, portdev);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"vmname=%s portdev=%s filter=%s ignoreExists=%d\"",
            "vmname",
            "NULLSTR(net->ifname)",
            "NULLSTR(net->filter)",
            "ignoreExists"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "net->filter"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "net->ifname"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetConnectNWFilter",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNWFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "174-177",
          "snippet": "virConnectPtr virGetConnectNWFilter(void)\n{\n    return virGetConnectGeneric(&connectNWFilter, \"nwfilter\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNWFilter;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNWFilter;\n\nvirConnectPtr virGetConnectNWFilter(void)\n{\n    return virGetConnectGeneric(&connectNWFilter, \"nwfilter\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainConfNWFilterInstantiate(const char *vmname,\n                                 const unsigned char *vmuuid,\n                                 virDomainNetDefPtr net,\n                                 bool ignoreExists)\n{\n    virConnectPtr conn = virGetConnectNWFilter();\n    virNWFilterBindingDefPtr def = NULL;\n    virNWFilterBindingPtr binding = NULL;\n    char *xml = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"vmname=%s portdev=%s filter=%s ignoreExists=%d\",\n              vmname, NULLSTR(net->ifname), NULLSTR(net->filter), ignoreExists);\n\n    if (!conn)\n        goto cleanup;\n\n    if (ignoreExists) {\n        binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n        if (binding) {\n            ret = 0;\n            goto cleanup;\n        }\n    }\n\n    if (!(def = virNWFilterBindingDefForNet(vmname, vmuuid, net)))\n        goto cleanup;\n\n    if (!(xml = virNWFilterBindingDefFormat(def)))\n        goto cleanup;\n\n    if (!(binding = virNWFilterBindingCreateXML(conn, xml, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(xml);\n    virNWFilterBindingDefFree(def);\n    virObjectUnref(binding);\n    virObjectUnref(conn);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterBindingDefForNet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
    "lines": "40-75",
    "snippet": "static virNWFilterBindingDefPtr\nvirNWFilterBindingDefForNet(const char *vmname,\n                            const unsigned char *vmuuid,\n                            virDomainNetDefPtr net)\n{\n    virNWFilterBindingDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->ownername = g_strdup(vmname);\n\n    memcpy(ret->owneruuid, vmuuid, sizeof(ret->owneruuid));\n\n    ret->portdevname = g_strdup(net->ifname);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        ret->linkdevname = g_strdup(net->data.direct.linkdev);\n\n    ret->mac = net->mac;\n\n    ret->filter = g_strdup(net->filter);\n\n    if (!(ret->filterparams = virNWFilterHashTableCreate(0)))\n        goto error;\n\n    if (net->filterparams &&\n        virNWFilterHashTablePutAll(net->filterparams, ret->filterparams) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnwfilterbindingdef.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "ret"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTablePutAll",
          "args": [
            "net->filterparams",
            "ret->filterparams"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTablePutAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "664-678",
          "snippet": "int\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTableCreate",
          "args": [
            "0"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTableCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "628-632",
          "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "net->filter"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ret->owneruuid",
            "vmuuid",
            "sizeof(ret->owneruuid)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterBindingDefPtr\nvirNWFilterBindingDefForNet(const char *vmname,\n                            const unsigned char *vmuuid,\n                            virDomainNetDefPtr net)\n{\n    virNWFilterBindingDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    ret->ownername = g_strdup(vmname);\n\n    memcpy(ret->owneruuid, vmuuid, sizeof(ret->owneruuid));\n\n    ret->portdevname = g_strdup(net->ifname);\n\n    if (net->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        ret->linkdevname = g_strdup(net->data.direct.linkdev);\n\n    ret->mac = net->mac;\n\n    ret->filter = g_strdup(net->filter);\n\n    if (!(ret->filterparams = virNWFilterHashTableCreate(0)))\n        goto error;\n\n    if (net->filterparams &&\n        virNWFilterHashTablePutAll(net->filterparams, ret->filterparams) < 0)\n        goto error;\n\n    return ret;\n\n error:\n    virNWFilterBindingDefFree(ret);\n    return NULL;\n}"
  }
]