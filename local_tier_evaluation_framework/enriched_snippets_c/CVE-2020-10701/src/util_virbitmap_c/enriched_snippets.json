[
  {
    "function_name": "virBitmapShrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1302-1329",
    "snippet": "void\nvirBitmapShrink(virBitmapPtr map,\n                size_t b)\n{\n    size_t toremove;\n    size_t nl = 0;\n    size_t nb = 0;\n\n    if (!map)\n        return;\n\n    if (map->nbits >= b)\n        map->nbits = b;\n\n    nl = map->nbits / VIR_BITMAP_BITS_PER_UNIT;\n    nb = map->nbits % VIR_BITMAP_BITS_PER_UNIT;\n    map->map[nl] &= ((1UL << nb) - 1);\n\n    toremove = map->map_alloc - (nl + 1);\n\n    if (toremove == 0)\n        return;\n\n    VIR_SHRINK_N(map->map, map->map_alloc, toremove);\n\n    /* length needs to be fixed as well */\n    map->map_len = map->map_alloc;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_SHRINK_N",
          "args": [
            "map->map",
            "map->map_alloc",
            "toremove"
          ],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid\nvirBitmapShrink(virBitmapPtr map,\n                size_t b)\n{\n    size_t toremove;\n    size_t nl = 0;\n    size_t nb = 0;\n\n    if (!map)\n        return;\n\n    if (map->nbits >= b)\n        map->nbits = b;\n\n    nl = map->nbits / VIR_BITMAP_BITS_PER_UNIT;\n    nb = map->nbits % VIR_BITMAP_BITS_PER_UNIT;\n    map->map[nl] &= ((1UL << nb) - 1);\n\n    toremove = map->map_alloc - (nl + 1);\n\n    if (toremove == 0)\n        return;\n\n    VIR_SHRINK_N(map->map, map->map_alloc, toremove);\n\n    /* length needs to be fixed as well */\n    map->map_len = map->map_alloc;\n}"
  },
  {
    "function_name": "virBitmapSubtract",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1279-1291",
    "snippet": "void\nvirBitmapSubtract(virBitmapPtr a,\n                  virBitmapPtr b)\n{\n    size_t i;\n    size_t max = a->map_len;\n\n    if (max > b->map_len)\n        max = b->map_len;\n\n    for (i = 0; i < max; i++)\n        a->map[i] &= ~b->map[i];\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapSubtract(virBitmapPtr a,\n                  virBitmapPtr b)\n{\n    size_t i;\n    size_t max = a->map_len;\n\n    if (max > b->map_len)\n        max = b->map_len;\n\n    for (i = 0; i < max; i++)\n        a->map[i] &= ~b->map[i];\n}"
  },
  {
    "function_name": "virBitmapUnion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1254-1269",
    "snippet": "int\nvirBitmapUnion(virBitmapPtr a,\n               const virBitmap *b)\n{\n    size_t i;\n\n    if (a->nbits < b->nbits &&\n        virBitmapExpand(a, b->nbits - 1) < 0) {\n        return -1;\n    }\n\n    for (i = 0; i < b->map_len; i++)\n        a->map[i] |= b->map[i];\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapExpand",
          "args": [
            "a",
            "b->nbits - 1"
          ],
          "line": 1261
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "192-209",
          "snippet": "static int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nstatic int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapUnion(virBitmapPtr a,\n               const virBitmap *b)\n{\n    size_t i;\n\n    if (a->nbits < b->nbits &&\n        virBitmapExpand(a, b->nbits - 1) < 0) {\n        return -1;\n    }\n\n    for (i = 0; i < b->map_len; i++)\n        a->map[i] |= b->map[i];\n\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapIntersect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1230-1242",
    "snippet": "void\nvirBitmapIntersect(virBitmapPtr a,\n                   virBitmapPtr b)\n{\n    size_t i;\n    size_t max = a->map_len;\n\n    if (max > b->map_len)\n        max = b->map_len;\n\n    for (i = 0; i < max; i++)\n        a->map[i] &= b->map[i];\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapIntersect(virBitmapPtr a,\n                   virBitmapPtr b)\n{\n    size_t i;\n    size_t max = a->map_len;\n\n    if (max > b->map_len)\n        max = b->map_len;\n\n    for (i = 0; i < max; i++)\n        a->map[i] &= b->map[i];\n}"
  },
  {
    "function_name": "virBitmapOverlaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1202-1220",
    "snippet": "bool\nvirBitmapOverlaps(virBitmapPtr b1,\n                  virBitmapPtr b2)\n{\n    size_t i;\n\n    if (b1->nbits > b2->nbits) {\n        virBitmapPtr tmp = b1;\n        b1 = b2;\n        b2 = tmp;\n    }\n\n    for (i = 0; i < b1->map_len; i++) {\n        if (b1->map[i] & b2->map[i])\n            return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapOverlaps(virBitmapPtr b1,\n                  virBitmapPtr b2)\n{\n    size_t i;\n\n    if (b1->nbits > b2->nbits) {\n        virBitmapPtr tmp = b1;\n        b1 = b2;\n        b2 = tmp;\n    }\n\n    for (i = 0; i < b1->map_len; i++) {\n        if (b1->map[i] & b2->map[i])\n            return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virBitmapDataFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1181-1191",
    "snippet": "char *\nvirBitmapDataFormat(const void *data,\n                    int len)\n{\n    g_autoptr(virBitmap) map = NULL;\n\n    if (!(map = virBitmapNewData(data, len)))\n        return NULL;\n\n    return virBitmapFormat(map);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFormat",
          "args": [
            "map"
          ],
          "line": 1190
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "404-442",
          "snippet": "char *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNewData",
          "args": [
            "data",
            "len"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "735-759",
          "snippet": "virBitmapPtr\nvirBitmapNewData(const void *data,\n                 int len)\n{\n    virBitmapPtr bitmap;\n    size_t i, j;\n    unsigned long *p;\n    const unsigned char *bytes = data;\n\n    bitmap = virBitmapNew(len * CHAR_BIT);\n    if (!bitmap)\n        return NULL;\n\n    /* le64toh is not available, so we do the conversion by hand */\n    p = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*p)) {\n            j = 0;\n            p++;\n        }\n        *p |= (unsigned long) bytes[i] << (j * CHAR_BIT);\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewData(const void *data,\n                 int len)\n{\n    virBitmapPtr bitmap;\n    size_t i, j;\n    unsigned long *p;\n    const unsigned char *bytes = data;\n\n    bitmap = virBitmapNew(len * CHAR_BIT);\n    if (!bitmap)\n        return NULL;\n\n    /* le64toh is not available, so we do the conversion by hand */\n    p = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*p)) {\n            j = 0;\n            p++;\n        }\n        *p |= (unsigned long) bytes[i] << (j * CHAR_BIT);\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapDataFormat(const void *data,\n                    int len)\n{\n    g_autoptr(virBitmap) map = NULL;\n\n    if (!(map = virBitmapNewData(data, len)))\n        return NULL;\n\n    return virBitmapFormat(map);\n}"
  },
  {
    "function_name": "virBitmapNewString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1144-1168",
    "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_UNIT_OFFSET",
          "args": [
            "i * 4"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT_OFFSET",
          "args": [
            "i * 4"
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_xdigit_value",
          "args": [
            "string[len - i - 1]"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "len * 4"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid hexadecimal string '%s'\")",
            "string"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid hexadecimal string '%s'\""
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "string",
            "\"0123456789abcdefABCDEF\""
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "string"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
  },
  {
    "function_name": "virBitmapCountBits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1122-1132",
    "snippet": "size_t\nvirBitmapCountBits(virBitmapPtr bitmap)\n{\n    size_t i;\n    size_t ret = 0;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        ret += __builtin_popcountl(bitmap->map[i]);\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__builtin_popcountl",
          "args": [
            "bitmap->map[i]"
          ],
          "line": 1129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nsize_t\nvirBitmapCountBits(virBitmapPtr bitmap)\n{\n    size_t i;\n    size_t ret = 0;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        ret += __builtin_popcountl(bitmap->map[i]);\n\n    return ret;\n}"
  },
  {
    "function_name": "virBitmapNextClearBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1078-1113",
    "snippet": "ssize_t\nvirBitmapNextClearBit(virBitmapPtr bitmap,\n                      ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = ~bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = ~bitmap->map[nl];\n\n    if (nl == bitmap->map_len - 1) {\n        /* Ensure tail bits are ignored.  */\n        int tail = bitmap->nbits % VIR_BITMAP_BITS_PER_UNIT;\n\n        if (tail)\n            bits &= -1UL >> (VIR_BITMAP_BITS_PER_UNIT - tail);\n    }\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__builtin_ffsl",
          "args": [
            "bits"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapNextClearBit(virBitmapPtr bitmap,\n                      ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = ~bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = ~bitmap->map[nl];\n\n    if (nl == bitmap->map_len - 1) {\n        /* Ensure tail bits are ignored.  */\n        int tail = bitmap->nbits % VIR_BITMAP_BITS_PER_UNIT;\n\n        if (tail)\n            bits &= -1UL >> (VIR_BITMAP_BITS_PER_UNIT - tail);\n    }\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}"
  },
  {
    "function_name": "virBitmapLastSetBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "1025-1064",
    "snippet": "ssize_t\nvirBitmapLastSetBit(virBitmapPtr bitmap)\n{\n    ssize_t i;\n    int unusedBits;\n    ssize_t sz;\n    unsigned long bits;\n\n    /* If bitmap is empty then there is no set bit */\n    if (bitmap->map_len == 0)\n        return -1;\n\n    unusedBits = bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT - bitmap->nbits;\n\n    sz = bitmap->map_len - 1;\n    if (unusedBits > 0) {\n        bits = bitmap->map[sz] & (VIR_BITMAP_BIT(VIR_BITMAP_BITS_PER_UNIT - unusedBits) - 1);\n        if (bits != 0)\n            goto found;\n\n        sz--;\n    }\n\n    for (; sz >= 0; sz--) {\n        bits = bitmap->map[sz];\n        if (bits != 0)\n            goto found;\n    }\n\n    /* Only reached if no set bit was found */\n    return -1;\n\n found:\n    for (i = VIR_BITMAP_BITS_PER_UNIT - 1; i >= 0; i--) {\n        if (bits & 1UL << i)\n            return i + sz * VIR_BITMAP_BITS_PER_UNIT;\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT",
          "args": [
            "VIR_BITMAP_BITS_PER_UNIT - unusedBits"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapLastSetBit(virBitmapPtr bitmap)\n{\n    ssize_t i;\n    int unusedBits;\n    ssize_t sz;\n    unsigned long bits;\n\n    /* If bitmap is empty then there is no set bit */\n    if (bitmap->map_len == 0)\n        return -1;\n\n    unusedBits = bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT - bitmap->nbits;\n\n    sz = bitmap->map_len - 1;\n    if (unusedBits > 0) {\n        bits = bitmap->map[sz] & (VIR_BITMAP_BIT(VIR_BITMAP_BITS_PER_UNIT - unusedBits) - 1);\n        if (bits != 0)\n            goto found;\n\n        sz--;\n    }\n\n    for (; sz >= 0; sz--) {\n        bits = bitmap->map[sz];\n        if (bits != 0)\n            goto found;\n    }\n\n    /* Only reached if no set bit was found */\n    return -1;\n\n found:\n    for (i = VIR_BITMAP_BITS_PER_UNIT - 1; i >= 0; i--) {\n        if (bits & 1UL << i)\n            return i + sz * VIR_BITMAP_BITS_PER_UNIT;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virBitmapNextSetBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "986-1014",
    "snippet": "ssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__builtin_ffsl",
          "args": [
            "bits"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}"
  },
  {
    "function_name": "virBitmapIsAllClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "962-972",
    "snippet": "bool\nvirBitmapIsAllClear(virBitmapPtr bitmap)\n{\n    size_t i;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        if (bitmap->map[i] != 0)\n            return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsAllClear(virBitmapPtr bitmap)\n{\n    size_t i;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        if (bitmap->map[i] != 0)\n            return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virBitmapIsAllSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "929-953",
    "snippet": "bool\nvirBitmapIsAllSet(virBitmapPtr bitmap)\n{\n    size_t i;\n    int unusedBits;\n    size_t sz;\n\n    unusedBits = bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT - bitmap->nbits;\n\n    sz = bitmap->map_len;\n    if (unusedBits > 0)\n        sz--;\n\n    for (i = 0; i < sz; i++)\n        if (bitmap->map[i] != -1)\n            return false;\n\n    if (unusedBits > 0) {\n        if ((bitmap->map[sz] & ((1UL << (VIR_BITMAP_BITS_PER_UNIT - unusedBits)) - 1))\n            != ((1UL << (VIR_BITMAP_BITS_PER_UNIT - unusedBits)) - 1))\n            return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nbool\nvirBitmapIsAllSet(virBitmapPtr bitmap)\n{\n    size_t i;\n    int unusedBits;\n    size_t sz;\n\n    unusedBits = bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT - bitmap->nbits;\n\n    sz = bitmap->map_len;\n    if (unusedBits > 0)\n        sz--;\n\n    for (i = 0; i < sz; i++)\n        if (bitmap->map[i] != -1)\n            return false;\n\n    if (unusedBits > 0) {\n        if ((bitmap->map[sz] & ((1UL << (VIR_BITMAP_BITS_PER_UNIT - unusedBits)) - 1))\n            != ((1UL << (VIR_BITMAP_BITS_PER_UNIT - unusedBits)) - 1))\n            return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virBitmapClearAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "915-920",
    "snippet": "void\nvirBitmapClearAll(virBitmapPtr bitmap)\n{\n    memset(bitmap->map, 0,\n           bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT));\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bitmap->map",
            "0",
            "bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT)"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid\nvirBitmapClearAll(virBitmapPtr bitmap)\n{\n    memset(bitmap->map, 0,\n           bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT));\n}"
  },
  {
    "function_name": "virBitmapSetAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "895-906",
    "snippet": "void virBitmapSetAll(virBitmapPtr bitmap)\n{\n    int tail = bitmap->nbits % VIR_BITMAP_BITS_PER_UNIT;\n\n    memset(bitmap->map, 0xff,\n           bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT));\n\n    /* Ensure tail bits are clear.  */\n    if (tail)\n        bitmap->map[bitmap->map_len - 1] &=\n            -1UL >> (VIR_BITMAP_BITS_PER_UNIT - tail);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bitmap->map",
            "0xff",
            "bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT)"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid virBitmapSetAll(virBitmapPtr bitmap)\n{\n    int tail = bitmap->nbits % VIR_BITMAP_BITS_PER_UNIT;\n\n    memset(bitmap->map, 0xff,\n           bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT));\n\n    /* Ensure tail bits are clear.  */\n    if (tail)\n        bitmap->map[bitmap->map_len - 1] &=\n            -1UL >> (VIR_BITMAP_BITS_PER_UNIT - tail);\n}"
  },
  {
    "function_name": "virBitmapSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "882-886",
    "snippet": "size_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nsize_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}"
  },
  {
    "function_name": "virBitmapEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "841-873",
    "snippet": "bool\nvirBitmapEqual(virBitmapPtr b1,\n               virBitmapPtr b2)\n{\n    virBitmapPtr tmp;\n    size_t i;\n\n    if (!b1 && !b2)\n        return true;\n\n    if (!b1 || !b2)\n        return false;\n\n    if (b1->nbits > b2->nbits) {\n        tmp = b1;\n        b1 = b2;\n        b2 = tmp;\n    }\n\n    /* Now b1 is the smaller one, if not equal */\n\n    for (i = 0; i < b1->map_len; i++) {\n        if (b1->map[i] != b2->map[i])\n            return false;\n    }\n\n    for (; i < b2->map_len; i++) {\n        if (b2->map[i])\n            return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapEqual(virBitmapPtr b1,\n               virBitmapPtr b2)\n{\n    virBitmapPtr tmp;\n    size_t i;\n\n    if (!b1 && !b2)\n        return true;\n\n    if (!b1 || !b2)\n        return false;\n\n    if (b1->nbits > b2->nbits) {\n        tmp = b1;\n        b1 = b2;\n        b2 = tmp;\n    }\n\n    /* Now b1 is the smaller one, if not equal */\n\n    for (i = 0; i < b1->map_len; i++) {\n        if (b1->map[i] != b2->map[i])\n            return false;\n    }\n\n    for (; i < b2->map_len; i++) {\n        if (b2->map[i])\n            return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virBitmapToDataBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "805-828",
    "snippet": "void\nvirBitmapToDataBuf(virBitmapPtr bitmap,\n                   unsigned char *bytes,\n                   size_t len)\n{\n    size_t nbytes = bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT);\n    unsigned long *l;\n    size_t i, j;\n\n    memset(bytes, 0, len);\n\n    /* If bitmap and buffer differ in size, only fill to the smaller length */\n    len = MIN(len, nbytes);\n\n    /* htole64 is not available, so we do the conversion by hand */\n    l = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*l)) {\n            j = 0;\n            l++;\n        }\n        bytes[i] = *l >> (j * CHAR_BIT);\n    }\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "len",
            "nbytes"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "bytes",
            "0",
            "len"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid\nvirBitmapToDataBuf(virBitmapPtr bitmap,\n                   unsigned char *bytes,\n                   size_t len)\n{\n    size_t nbytes = bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT);\n    unsigned long *l;\n    size_t i, j;\n\n    memset(bytes, 0, len);\n\n    /* If bitmap and buffer differ in size, only fill to the smaller length */\n    len = MIN(len, nbytes);\n\n    /* htole64 is not available, so we do the conversion by hand */\n    l = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*l)) {\n            j = 0;\n            l++;\n        }\n        bytes[i] = *l >> (j * CHAR_BIT);\n    }\n}"
  },
  {
    "function_name": "virBitmapToData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "773-793",
    "snippet": "int\nvirBitmapToData(virBitmapPtr bitmap,\n                unsigned char **data,\n                int *dataLen)\n{\n    ssize_t len;\n\n    if ((len = virBitmapLastSetBit(bitmap)) < 0)\n        len = 1;\n    else\n        len = (len + CHAR_BIT) / CHAR_BIT;\n\n    if (VIR_ALLOC_N(*data, len) < 0)\n        return -1;\n\n    *dataLen = len;\n\n    virBitmapToDataBuf(bitmap, *data, *dataLen);\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapToDataBuf",
          "args": [
            "bitmap",
            "*data",
            "*dataLen"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapToDataBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "805-828",
          "snippet": "void\nvirBitmapToDataBuf(virBitmapPtr bitmap,\n                   unsigned char *bytes,\n                   size_t len)\n{\n    size_t nbytes = bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT);\n    unsigned long *l;\n    size_t i, j;\n\n    memset(bytes, 0, len);\n\n    /* If bitmap and buffer differ in size, only fill to the smaller length */\n    len = MIN(len, nbytes);\n\n    /* htole64 is not available, so we do the conversion by hand */\n    l = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*l)) {\n            j = 0;\n            l++;\n        }\n        bytes[i] = *l >> (j * CHAR_BIT);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid\nvirBitmapToDataBuf(virBitmapPtr bitmap,\n                   unsigned char *bytes,\n                   size_t len)\n{\n    size_t nbytes = bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT);\n    unsigned long *l;\n    size_t i, j;\n\n    memset(bytes, 0, len);\n\n    /* If bitmap and buffer differ in size, only fill to the smaller length */\n    len = MIN(len, nbytes);\n\n    /* htole64 is not available, so we do the conversion by hand */\n    l = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*l)) {\n            j = 0;\n            l++;\n        }\n        bytes[i] = *l >> (j * CHAR_BIT);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*data",
            "len"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapLastSetBit",
          "args": [
            "bitmap"
          ],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapLastSetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1025-1064",
          "snippet": "ssize_t\nvirBitmapLastSetBit(virBitmapPtr bitmap)\n{\n    ssize_t i;\n    int unusedBits;\n    ssize_t sz;\n    unsigned long bits;\n\n    /* If bitmap is empty then there is no set bit */\n    if (bitmap->map_len == 0)\n        return -1;\n\n    unusedBits = bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT - bitmap->nbits;\n\n    sz = bitmap->map_len - 1;\n    if (unusedBits > 0) {\n        bits = bitmap->map[sz] & (VIR_BITMAP_BIT(VIR_BITMAP_BITS_PER_UNIT - unusedBits) - 1);\n        if (bits != 0)\n            goto found;\n\n        sz--;\n    }\n\n    for (; sz >= 0; sz--) {\n        bits = bitmap->map[sz];\n        if (bits != 0)\n            goto found;\n    }\n\n    /* Only reached if no set bit was found */\n    return -1;\n\n found:\n    for (i = VIR_BITMAP_BITS_PER_UNIT - 1; i >= 0; i--) {\n        if (bits & 1UL << i)\n            return i + sz * VIR_BITMAP_BITS_PER_UNIT;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapLastSetBit(virBitmapPtr bitmap)\n{\n    ssize_t i;\n    int unusedBits;\n    ssize_t sz;\n    unsigned long bits;\n\n    /* If bitmap is empty then there is no set bit */\n    if (bitmap->map_len == 0)\n        return -1;\n\n    unusedBits = bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT - bitmap->nbits;\n\n    sz = bitmap->map_len - 1;\n    if (unusedBits > 0) {\n        bits = bitmap->map[sz] & (VIR_BITMAP_BIT(VIR_BITMAP_BITS_PER_UNIT - unusedBits) - 1);\n        if (bits != 0)\n            goto found;\n\n        sz--;\n    }\n\n    for (; sz >= 0; sz--) {\n        bits = bitmap->map[sz];\n        if (bits != 0)\n            goto found;\n    }\n\n    /* Only reached if no set bit was found */\n    return -1;\n\n found:\n    for (i = VIR_BITMAP_BITS_PER_UNIT - 1; i >= 0; i--) {\n        if (bits & 1UL << i)\n            return i + sz * VIR_BITMAP_BITS_PER_UNIT;\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapToData(virBitmapPtr bitmap,\n                unsigned char **data,\n                int *dataLen)\n{\n    ssize_t len;\n\n    if ((len = virBitmapLastSetBit(bitmap)) < 0)\n        len = 1;\n    else\n        len = (len + CHAR_BIT) / CHAR_BIT;\n\n    if (VIR_ALLOC_N(*data, len) < 0)\n        return -1;\n\n    *dataLen = len;\n\n    virBitmapToDataBuf(bitmap, *data, *dataLen);\n\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapNewData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "735-759",
    "snippet": "virBitmapPtr\nvirBitmapNewData(const void *data,\n                 int len)\n{\n    virBitmapPtr bitmap;\n    size_t i, j;\n    unsigned long *p;\n    const unsigned char *bytes = data;\n\n    bitmap = virBitmapNew(len * CHAR_BIT);\n    if (!bitmap)\n        return NULL;\n\n    /* le64toh is not available, so we do the conversion by hand */\n    p = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*p)) {\n            j = 0;\n            p++;\n        }\n        *p |= (unsigned long) bytes[i] << (j * CHAR_BIT);\n    }\n\n    return bitmap;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "len * CHAR_BIT"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewData(const void *data,\n                 int len)\n{\n    virBitmapPtr bitmap;\n    size_t i, j;\n    unsigned long *p;\n    const unsigned char *bytes = data;\n\n    bitmap = virBitmapNew(len * CHAR_BIT);\n    if (!bitmap)\n        return NULL;\n\n    /* le64toh is not available, so we do the conversion by hand */\n    p = bitmap->map;\n    for (i = j = 0; i < len; i++, j++) {\n        if (j == sizeof(*p)) {\n            j = 0;\n            p++;\n        }\n        *p |= (unsigned long) bytes[i] << (j * CHAR_BIT);\n    }\n\n    return bitmap;\n}"
  },
  {
    "function_name": "virBitmapNewCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "707-721",
    "snippet": "virBitmapPtr\nvirBitmapNewCopy(virBitmapPtr src)\n{\n    virBitmapPtr dst;\n\n    if ((dst = virBitmapNew(src->nbits)) == NULL)\n        return NULL;\n\n    if (virBitmapCopy(dst, src) != 0) {\n        virBitmapFree(dst);\n        return NULL;\n    }\n\n    return dst;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "dst"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapCopy",
          "args": [
            "dst",
            "src"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "146-158",
          "snippet": "int\nvirBitmapCopy(virBitmapPtr dst,\n              virBitmapPtr src)\n{\n    if (dst->nbits != src->nbits) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    memcpy(dst->map, src->map, src->map_len * sizeof(src->map[0]));\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapCopy(virBitmapPtr dst,\n              virBitmapPtr src)\n{\n    if (dst->nbits != src->nbits) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    memcpy(dst->map, src->map, src->map_len * sizeof(src->map[0]));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "src->nbits"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewCopy(virBitmapPtr src)\n{\n    virBitmapPtr dst;\n\n    if ((dst = virBitmapNew(src->nbits)) == NULL)\n        return NULL;\n\n    if (virBitmapCopy(dst, src) != 0) {\n        virBitmapFree(dst);\n        return NULL;\n    }\n\n    return dst;\n}"
  },
  {
    "function_name": "virBitmapParseUnlimited",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "605-695",
    "snippet": "virBitmapPtr\nvirBitmapParseUnlimited(const char *str)\n{\n    virBitmapPtr bitmap = virBitmapNewEmpty();\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0) {\n            if (neg) {\n                if (virBitmapClearBitExpand(bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBitExpand(bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBitExpand(bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return bitmap;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), NULLSTR(str));\n    virBitmapFree(bitmap);\n    return NULL;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "bitmap"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Failed to parse bitmap '%s'\")",
            "NULLSTR(str)"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "str"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse bitmap '%s'\""
          ],
          "line": 692
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&cur"
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSetBitExpand",
          "args": [
            "bitmap",
            "i"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "cur",
            "&tmp",
            "10",
            "&last"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapClearBitExpand",
          "args": [
            "bitmap",
            "start"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapClearBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "265-277",
          "snippet": "int\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isdigit",
          "args": [
            "*cur"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNewEmpty",
          "args": [],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "115-119",
          "snippet": "virBitmapPtr\nvirBitmapNewEmpty(void)\n{\n    return g_new0(virBitmap, 1);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewEmpty(void)\n{\n    return g_new0(virBitmap, 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapParseUnlimited(const char *str)\n{\n    virBitmapPtr bitmap = virBitmapNewEmpty();\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0) {\n            if (neg) {\n                if (virBitmapClearBitExpand(bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBitExpand(bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBitExpand(bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return bitmap;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), NULLSTR(str));\n    virBitmapFree(bitmap);\n    return NULL;\n}"
  },
  {
    "function_name": "virBitmapParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "581-587",
    "snippet": "int\nvirBitmapParse(const char *str,\n               virBitmapPtr *bitmap,\n               size_t bitmapSize)\n{\n    return virBitmapParseSeparator(str, '\\0', bitmap, bitmapSize);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapParseSeparator",
          "args": [
            "str",
            "'\\0'",
            "bitmap",
            "bitmapSize"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapParseSeparator",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "467-563",
          "snippet": "int\nvirBitmapParseSeparator(const char *str,\n                        char terminator,\n                        virBitmapPtr *bitmap,\n                        size_t bitmapSize)\n{\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!(*bitmap = virBitmapNew(bitmapSize)))\n        return -1;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0 && *cur != terminator) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0 || *cur == terminator) {\n            if (neg) {\n                if (virBitmapClearBit(*bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBit(*bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBit(*bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0 || *cur == terminator) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), str);\n    virBitmapFree(*bitmap);\n    *bitmap = NULL;\n    return -1;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapParseSeparator(const char *str,\n                        char terminator,\n                        virBitmapPtr *bitmap,\n                        size_t bitmapSize)\n{\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!(*bitmap = virBitmapNew(bitmapSize)))\n        return -1;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0 && *cur != terminator) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0 || *cur == terminator) {\n            if (neg) {\n                if (virBitmapClearBit(*bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBit(*bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBit(*bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0 || *cur == terminator) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), str);\n    virBitmapFree(*bitmap);\n    *bitmap = NULL;\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapParse(const char *str,\n               virBitmapPtr *bitmap,\n               size_t bitmapSize)\n{\n    return virBitmapParseSeparator(str, '\\0', bitmap, bitmapSize);\n}"
  },
  {
    "function_name": "virBitmapParseSeparator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "467-563",
    "snippet": "int\nvirBitmapParseSeparator(const char *str,\n                        char terminator,\n                        virBitmapPtr *bitmap,\n                        size_t bitmapSize)\n{\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!(*bitmap = virBitmapNew(bitmapSize)))\n        return -1;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0 && *cur != terminator) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0 || *cur == terminator) {\n            if (neg) {\n                if (virBitmapClearBit(*bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBit(*bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBit(*bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0 || *cur == terminator) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), str);\n    virBitmapFree(*bitmap);\n    *bitmap = NULL;\n    return -1;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "*bitmap"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Failed to parse bitmap '%s'\")",
            "str"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse bitmap '%s'\""
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&cur"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "*bitmap",
            "i"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "cur",
            "&tmp",
            "10",
            "&last"
          ],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapClearBit",
          "args": [
            "*bitmap",
            "start"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapClearBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "265-277",
          "snippet": "int\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isdigit",
          "args": [
            "*cur"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "bitmapSize"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapParseSeparator(const char *str,\n                        char terminator,\n                        virBitmapPtr *bitmap,\n                        size_t bitmapSize)\n{\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!(*bitmap = virBitmapNew(bitmapSize)))\n        return -1;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0 && *cur != terminator) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0 || *cur == terminator) {\n            if (neg) {\n                if (virBitmapClearBit(*bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBit(*bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBit(*bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0 || *cur == terminator) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return 0;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), str);\n    virBitmapFree(*bitmap);\n    *bitmap = NULL;\n    return -1;\n}"
  },
  {
    "function_name": "virBitmapFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "404-442",
    "snippet": "char *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"%d-%d\"",
            "start",
            "prev"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\",\""
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNextSetBit",
          "args": [
            "bitmap",
            "prev"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNextSetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "986-1014",
          "snippet": "ssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"\""
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virBitmapToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "343-387",
    "snippet": "char *\nvirBitmapToString(virBitmapPtr bitmap,\n                  bool prefix,\n                  bool trim)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t sz;\n    size_t len;\n    size_t diff;\n    char *ret = NULL;\n\n    if (prefix)\n        virBufferAddLit(&buf, \"0x\");\n\n    sz = bitmap->map_len;\n\n    while (sz--) {\n        virBufferAsprintf(&buf, \"%0*lx\",\n                          VIR_BITMAP_BITS_PER_UNIT / 4,\n                          bitmap->map[sz]);\n    }\n\n    ret = virBufferContentAndReset(&buf);\n    if (!ret)\n        return NULL;\n\n    if (!trim)\n        return ret;\n\n    if (bitmap->nbits != bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT) {\n        char *tmp = ret;\n\n        if (prefix)\n            tmp += 2;\n\n        len = strlen(tmp);\n        sz = VIR_DIV_UP(bitmap->nbits, 4);\n        diff = len - sz;\n\n        if (diff)\n            memmove(tmp, tmp + diff, sz + 1);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "tmp",
            "tmp + diff",
            "sz + 1"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIV_UP",
          "args": [
            "bitmap->nbits",
            "4"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tmp"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"%0*lx\"",
            "VIR_BITMAP_BITS_PER_UNIT / 4",
            "bitmap->map[sz]"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"0x\""
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nchar *\nvirBitmapToString(virBitmapPtr bitmap,\n                  bool prefix,\n                  bool trim)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t sz;\n    size_t len;\n    size_t diff;\n    char *ret = NULL;\n\n    if (prefix)\n        virBufferAddLit(&buf, \"0x\");\n\n    sz = bitmap->map_len;\n\n    while (sz--) {\n        virBufferAsprintf(&buf, \"%0*lx\",\n                          VIR_BITMAP_BITS_PER_UNIT / 4,\n                          bitmap->map[sz]);\n    }\n\n    ret = virBufferContentAndReset(&buf);\n    if (!ret)\n        return NULL;\n\n    if (!trim)\n        return ret;\n\n    if (bitmap->nbits != bitmap->map_len * VIR_BITMAP_BITS_PER_UNIT) {\n        char *tmp = ret;\n\n        if (prefix)\n            tmp += 2;\n\n        len = strlen(tmp);\n        sz = VIR_DIV_UP(bitmap->nbits, 4);\n        diff = len - sz;\n\n        if (diff)\n            memmove(tmp, tmp + diff, sz + 1);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virBitmapGetBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "320-330",
    "snippet": "int\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapIsSet",
          "args": [
            "bitmap",
            "b"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "281-285",
          "snippet": "static bool\nvirBitmapIsSet(virBitmapPtr bitmap, size_t b)\n{\n    return !!(bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] & VIR_BITMAP_BIT(b));\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirBitmapIsSet(virBitmapPtr bitmap, size_t b)\n{\n    return !!(bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] & VIR_BITMAP_BIT(b));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapGetBit(virBitmapPtr bitmap,\n                size_t b,\n                bool *result)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    *result = virBitmapIsSet(bitmap, b);\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapIsBitSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "298-306",
    "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapIsSet",
          "args": [
            "bitmap",
            "b"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "281-285",
          "snippet": "static bool\nvirBitmapIsSet(virBitmapPtr bitmap, size_t b)\n{\n    return !!(bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] & VIR_BITMAP_BIT(b));\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirBitmapIsSet(virBitmapPtr bitmap, size_t b)\n{\n    return !!(bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] & VIR_BITMAP_BIT(b));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
  },
  {
    "function_name": "virBitmapIsSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "281-285",
    "snippet": "static bool\nvirBitmapIsSet(virBitmapPtr bitmap, size_t b)\n{\n    return !!(bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] & VIR_BITMAP_BIT(b));\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT",
          "args": [
            "b"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BITMAP_UNIT_OFFSET",
          "args": [
            "b"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nvirBitmapIsSet(virBitmapPtr bitmap, size_t b)\n{\n    return !!(bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] & VIR_BITMAP_BIT(b));\n}"
  },
  {
    "function_name": "virBitmapClearBitExpand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "265-277",
    "snippet": "int\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT",
          "args": [
            "b"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BITMAP_UNIT_OFFSET",
          "args": [
            "b"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapExpand",
          "args": [
            "bitmap",
            "b"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "192-209",
          "snippet": "static int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nstatic int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapClearBitExpand(virBitmapPtr bitmap,\n                        size_t b)\n{\n    if (bitmap->nbits <= b) {\n        if (virBitmapExpand(bitmap, b) < 0)\n            return -1;\n    } else {\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapClearBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "243-252",
    "snippet": "int\nvirBitmapClearBit(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT",
          "args": [
            "b"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BITMAP_UNIT_OFFSET",
          "args": [
            "b"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapClearBit(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] &= ~VIR_BITMAP_BIT(b);\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapSetBitExpand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "222-231",
    "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT",
          "args": [
            "b"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BITMAP_UNIT_OFFSET",
          "args": [
            "b"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapExpand",
          "args": [
            "bitmap",
            "b"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "192-209",
          "snippet": "static int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nstatic int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapExpand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "192-209",
    "snippet": "static int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "map->map",
            "map->map_alloc",
            "map->map_len",
            "new_len - map->map_len"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIV_UP",
          "args": [
            "b + 1",
            "VIR_BITMAP_BITS_PER_UNIT"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nstatic int\nvirBitmapExpand(virBitmapPtr map,\n                size_t b)\n{\n    size_t new_len = VIR_DIV_UP(b + 1, VIR_BITMAP_BITS_PER_UNIT);\n\n    /* resize the memory if necessary */\n    if (map->map_len < new_len) {\n        if (VIR_RESIZE_N(map->map, map->map_alloc, map->map_len,\n                         new_len - map->map_len) < 0)\n            return -1;\n    }\n\n    map->nbits = b + 1;\n    map->map_len = new_len;\n\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapSetBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "170-179",
    "snippet": "int\nvirBitmapSetBit(virBitmapPtr bitmap,\n                size_t b)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_BITMAP_BIT",
          "args": [
            "b"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_BITMAP_UNIT_OFFSET",
          "args": [
            "b"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBit(virBitmapPtr bitmap,\n                size_t b)\n{\n    if (bitmap->nbits <= b)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "146-158",
    "snippet": "int\nvirBitmapCopy(virBitmapPtr dst,\n              virBitmapPtr src)\n{\n    if (dst->nbits != src->nbits) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    memcpy(dst->map, src->map, src->map_len * sizeof(src->map[0]));\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst->map",
            "src->map",
            "src->map_len * sizeof(src->map[0])"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapCopy(virBitmapPtr dst,\n              virBitmapPtr src)\n{\n    if (dst->nbits != src->nbits) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    memcpy(dst->map, src->map, src->map_len * sizeof(src->map[0]));\n\n    return 0;\n}"
  },
  {
    "function_name": "virBitmapFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "128-135",
    "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bitmap"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bitmap->map"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
  },
  {
    "function_name": "virBitmapNewEmpty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "115-119",
    "snippet": "virBitmapPtr\nvirBitmapNewEmpty(void)\n{\n    return g_new0(virBitmap, 1);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virBitmap",
            "1"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewEmpty(void)\n{\n    return g_new0(virBitmap, 1);\n}"
  },
  {
    "function_name": "virBitmapNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "96-105",
    "snippet": "virBitmapPtr\nvirBitmapNew(size_t size)\n{\n    virBitmapPtr ret;\n\n    if (!(ret = virBitmapNewQuiet(size)))\n        virReportOOMError();\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNewQuiet",
          "args": [
            "size"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "61-84",
          "snippet": "virBitmapPtr\nvirBitmapNewQuiet(size_t size)\n{\n    virBitmapPtr bitmap;\n    size_t sz;\n\n    if (SIZE_MAX - VIR_BITMAP_BITS_PER_UNIT < size || size == 0)\n        return NULL;\n\n    sz = VIR_DIV_UP(size, VIR_BITMAP_BITS_PER_UNIT);\n\n    if (VIR_ALLOC_QUIET(bitmap) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N_QUIET(bitmap->map, sz) < 0) {\n        VIR_FREE(bitmap);\n        return NULL;\n    }\n\n    bitmap->nbits = size;\n    bitmap->map_len = sz;\n    bitmap->map_alloc = sz;\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvirBitmapPtr\nvirBitmapNewQuiet(size_t size)\n{\n    virBitmapPtr bitmap;\n    size_t sz;\n\n    if (SIZE_MAX - VIR_BITMAP_BITS_PER_UNIT < size || size == 0)\n        return NULL;\n\n    sz = VIR_DIV_UP(size, VIR_BITMAP_BITS_PER_UNIT);\n\n    if (VIR_ALLOC_QUIET(bitmap) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N_QUIET(bitmap->map, sz) < 0) {\n        VIR_FREE(bitmap);\n        return NULL;\n    }\n\n    bitmap->nbits = size;\n    bitmap->map_len = sz;\n    bitmap->map_alloc = sz;\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNew(size_t size)\n{\n    virBitmapPtr ret;\n\n    if (!(ret = virBitmapNewQuiet(size)))\n        virReportOOMError();\n\n    return ret;\n}"
  },
  {
    "function_name": "virBitmapNewQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
    "lines": "61-84",
    "snippet": "virBitmapPtr\nvirBitmapNewQuiet(size_t size)\n{\n    virBitmapPtr bitmap;\n    size_t sz;\n\n    if (SIZE_MAX - VIR_BITMAP_BITS_PER_UNIT < size || size == 0)\n        return NULL;\n\n    sz = VIR_DIV_UP(size, VIR_BITMAP_BITS_PER_UNIT);\n\n    if (VIR_ALLOC_QUIET(bitmap) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N_QUIET(bitmap->map, sz) < 0) {\n        VIR_FREE(bitmap);\n        return NULL;\n    }\n\n    bitmap->nbits = size;\n    bitmap->map_len = sz;\n    bitmap->map_alloc = sz;\n    return bitmap;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"virstring.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbitmap.h\"",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "bitmap"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N_QUIET",
          "args": [
            "bitmap->map",
            "sz"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_QUIET",
          "args": [
            "bitmap"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIV_UP",
          "args": [
            "size",
            "VIR_BITMAP_BITS_PER_UNIT"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvirBitmapPtr\nvirBitmapNewQuiet(size_t size)\n{\n    virBitmapPtr bitmap;\n    size_t sz;\n\n    if (SIZE_MAX - VIR_BITMAP_BITS_PER_UNIT < size || size == 0)\n        return NULL;\n\n    sz = VIR_DIV_UP(size, VIR_BITMAP_BITS_PER_UNIT);\n\n    if (VIR_ALLOC_QUIET(bitmap) < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N_QUIET(bitmap->map, sz) < 0) {\n        VIR_FREE(bitmap);\n        return NULL;\n    }\n\n    bitmap->nbits = size;\n    bitmap->map_len = sz;\n    bitmap->map_alloc = sz;\n    return bitmap;\n}"
  }
]