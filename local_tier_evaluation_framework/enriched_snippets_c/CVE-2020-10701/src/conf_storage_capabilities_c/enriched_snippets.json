[
  {
    "function_name": "virStoragePoolCapsFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
    "lines": "117-135",
    "snippet": "char *\nvirStoragePoolCapsFormat(const virStoragePoolCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n\n    virBufferAddLit(&buf, \"<storagepoolCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    for (i = 0; i < VIR_STORAGE_POOL_LAST; i++) {\n        if (virStoragePoolCapsFormatPool(&buf, i, caps) < 0) {\n            virBufferFreeAndReset(&buf);\n            return NULL;\n        }\n    }\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</storagepoolCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"capabilities.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</storagepoolCapabilities>\\n\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolCapsFormatPool",
          "args": [
            "&buf",
            "i",
            "caps"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolCapsFormatPool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
          "lines": "93-114",
          "snippet": "static int\nvirStoragePoolCapsFormatPool(virBufferPtr buf,\n                             int poolType,\n                             const virStoragePoolCaps *caps)\n{\n    bool isLoaded = virStoragePoolCapsIsLoaded(caps->driverCaps, poolType);\n\n    virBufferAsprintf(buf, \"<pool type='%s' supported='%s'>\\n\",\n                      virStoragePoolTypeToString(poolType),\n                      isLoaded ? \"yes\" : \"no\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (virStoragePoolOptionsFormatPool(buf, poolType) < 0)\n        return -1;\n\n    if (virStoragePoolOptionsFormatVolume(buf, poolType) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"capabilities.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirStoragePoolCapsFormatPool(virBufferPtr buf,\n                             int poolType,\n                             const virStoragePoolCaps *caps)\n{\n    bool isLoaded = virStoragePoolCapsIsLoaded(caps->driverCaps, poolType);\n\n    virBufferAsprintf(buf, \"<pool type='%s' supported='%s'>\\n\",\n                      virStoragePoolTypeToString(poolType),\n                      isLoaded ? \"yes\" : \"no\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (virStoragePoolOptionsFormatPool(buf, poolType) < 0)\n        return -1;\n\n    if (virStoragePoolOptionsFormatVolume(buf, poolType) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<storagepoolCapabilities>\\n\""
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nchar *\nvirStoragePoolCapsFormat(const virStoragePoolCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    size_t i;\n\n    virBufferAddLit(&buf, \"<storagepoolCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n    for (i = 0; i < VIR_STORAGE_POOL_LAST; i++) {\n        if (virStoragePoolCapsFormatPool(&buf, i, caps) < 0) {\n            virBufferFreeAndReset(&buf);\n            return NULL;\n        }\n    }\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</storagepoolCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virStoragePoolCapsFormatPool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
    "lines": "93-114",
    "snippet": "static int\nvirStoragePoolCapsFormatPool(virBufferPtr buf,\n                             int poolType,\n                             const virStoragePoolCaps *caps)\n{\n    bool isLoaded = virStoragePoolCapsIsLoaded(caps->driverCaps, poolType);\n\n    virBufferAsprintf(buf, \"<pool type='%s' supported='%s'>\\n\",\n                      virStoragePoolTypeToString(poolType),\n                      isLoaded ? \"yes\" : \"no\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (virStoragePoolOptionsFormatPool(buf, poolType) < 0)\n        return -1;\n\n    if (virStoragePoolOptionsFormatVolume(buf, poolType) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"capabilities.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</pool>\\n\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsFormatVolume",
          "args": [
            "buf",
            "poolType"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsFormatVolume",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "407-440",
          "snippet": "int\nvirStoragePoolOptionsFormatVolume(virBufferPtr buf,\n                                  int type)\n{\n    size_t i;\n    virStorageVolOptionsPtr volOptions;\n\n    if (!(volOptions = virStorageVolOptionsForPoolType(type)))\n        return -1;\n\n    if (!volOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<volOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                      (volOptions->formatToString)(volOptions->defaultFormat));\n\n    virBufferAddLit(buf, \"<enum name='targetFormatType'>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < volOptions->lastFormat; i++)\n        virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                          (volOptions->formatToString)(i));\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</enum>\\n\");\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</volOptions>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolOptionsFormatVolume(virBufferPtr buf,\n                                  int type)\n{\n    size_t i;\n    virStorageVolOptionsPtr volOptions;\n\n    if (!(volOptions = virStorageVolOptionsForPoolType(type)))\n        return -1;\n\n    if (!volOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<volOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                      (volOptions->formatToString)(volOptions->defaultFormat));\n\n    virBufferAddLit(buf, \"<enum name='targetFormatType'>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < volOptions->lastFormat; i++)\n        virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                          (volOptions->formatToString)(i));\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</enum>\\n\");\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</volOptions>\\n\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsFormatPool",
          "args": [
            "buf",
            "poolType"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsFormatPool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "369-404",
          "snippet": "int\nvirStoragePoolOptionsFormatPool(virBufferPtr buf,\n                                int type)\n{\n    virStoragePoolOptionsPtr poolOptions;\n\n    if (!(poolOptions = virStoragePoolOptionsForPoolType(type)))\n        return -1;\n\n    if (!poolOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<poolOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (poolOptions->formatToString) {\n        size_t i;\n\n        virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                          (poolOptions->formatToString)(poolOptions->defaultFormat));\n\n        virBufferAddLit(buf, \"<enum name='sourceFormatType'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        for (i = 0; i < poolOptions->lastFormat; i++)\n            virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                              (poolOptions->formatToString)(i));\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</enum>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</poolOptions>\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolOptionsFormatPool(virBufferPtr buf,\n                                int type)\n{\n    virStoragePoolOptionsPtr poolOptions;\n\n    if (!(poolOptions = virStoragePoolOptionsForPoolType(type)))\n        return -1;\n\n    if (!poolOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<poolOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (poolOptions->formatToString) {\n        size_t i;\n\n        virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                          (poolOptions->formatToString)(poolOptions->defaultFormat));\n\n        virBufferAddLit(buf, \"<enum name='sourceFormatType'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        for (i = 0; i < poolOptions->lastFormat; i++)\n            virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                              (poolOptions->formatToString)(i));\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</enum>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</poolOptions>\\n\");\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<pool type='%s' supported='%s'>\\n\"",
            "virStoragePoolTypeToString(poolType)",
            "isLoaded ? \"yes\" : \"no\""
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeToString",
          "args": [
            "poolType"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolCapsIsLoaded",
          "args": [
            "caps->driverCaps",
            "poolType"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolCapsIsLoaded",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
          "lines": "75-90",
          "snippet": "static bool\nvirStoragePoolCapsIsLoaded(virCapsPtr driverCaps,\n                           int poolType)\n{\n    size_t i;\n\n    if (!driverCaps)\n        return false;\n\n    for (i = 0; i < driverCaps->npools; i++) {\n        if (driverCaps->pools[i]->type == poolType)\n            return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_capabilities.h\"",
            "#include \"capabilities.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic bool\nvirStoragePoolCapsIsLoaded(virCapsPtr driverCaps,\n                           int poolType)\n{\n    size_t i;\n\n    if (!driverCaps)\n        return false;\n\n    for (i = 0; i < driverCaps->npools; i++) {\n        if (driverCaps->pools[i]->type == poolType)\n            return true;\n    }\n\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirStoragePoolCapsFormatPool(virBufferPtr buf,\n                             int poolType,\n                             const virStoragePoolCaps *caps)\n{\n    bool isLoaded = virStoragePoolCapsIsLoaded(caps->driverCaps, poolType);\n\n    virBufferAsprintf(buf, \"<pool type='%s' supported='%s'>\\n\",\n                      virStoragePoolTypeToString(poolType),\n                      isLoaded ? \"yes\" : \"no\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (virStoragePoolOptionsFormatPool(buf, poolType) < 0)\n        return -1;\n\n    if (virStoragePoolOptionsFormatVolume(buf, poolType) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolCapsIsLoaded",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
    "lines": "75-90",
    "snippet": "static bool\nvirStoragePoolCapsIsLoaded(virCapsPtr driverCaps,\n                           int poolType)\n{\n    size_t i;\n\n    if (!driverCaps)\n        return false;\n\n    for (i = 0; i < driverCaps->npools; i++) {\n        if (driverCaps->pools[i]->type == poolType)\n            return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"capabilities.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic bool\nvirStoragePoolCapsIsLoaded(virCapsPtr driverCaps,\n                           int poolType)\n{\n    size_t i;\n\n    if (!driverCaps)\n        return false;\n\n    for (i = 0; i < driverCaps->npools; i++) {\n        if (driverCaps->pools[i]->type == poolType)\n            return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virStoragePoolCapsNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
    "lines": "58-72",
    "snippet": "virStoragePoolCapsPtr\nvirStoragePoolCapsNew(virCapsPtr driverCaps)\n{\n    virStoragePoolCapsPtr caps = NULL;\n\n    if (virStoragePoolCapsInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectLockableNew(virStoragePoolCapsClass)))\n        return NULL;\n\n    caps->driverCaps = virObjectRef(driverCaps);\n\n    return caps;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"capabilities.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virStoragePoolCapsClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "driverCaps"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virStoragePoolCapsClass"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolCapsInitialize",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic virClassPtr virStoragePoolCapsClass;\n\nvirStoragePoolCapsPtr\nvirStoragePoolCapsNew(virCapsPtr driverCaps)\n{\n    virStoragePoolCapsPtr caps = NULL;\n\n    if (virStoragePoolCapsInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectLockableNew(virStoragePoolCapsClass)))\n        return NULL;\n\n    caps->driverCaps = virObjectRef(driverCaps);\n\n    return caps;\n}"
  },
  {
    "function_name": "virStoragePoolCapsOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
    "lines": "47-53",
    "snippet": "static int\nvirStoragePoolCapsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStoragePoolCaps, virClassForObjectLockable()))\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"capabilities.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virStoragePoolCaps",
            "virClassForObjectLockable()"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirStoragePoolCapsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virStoragePoolCaps, virClassForObjectLockable()))\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolCapsDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_capabilities.c",
    "lines": "37-44",
    "snippet": "static void\nvirStoragePoolCapsDispose(void *obj)\n{\n    virStoragePoolCapsPtr caps = obj;\n    VIR_DEBUG(\"obj=%p\", caps);\n\n    virObjectUnref(caps->driverCaps);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_capabilities.h\"",
      "#include \"capabilities.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps->driverCaps"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "caps"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"storage_conf.h\"\n#include \"storage_capabilities.h\"\n#include \"capabilities.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic void\nvirStoragePoolCapsDispose(void *obj)\n{\n    virStoragePoolCapsPtr caps = obj;\n    VIR_DEBUG(\"obj=%p\", caps);\n\n    virObjectUnref(caps->driverCaps);\n}"
  }
]