[
  {
    "function_name": "virAccessDriverPolkitCheckStorageVol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "423-445",
    "snippet": "static int\nvirAccessDriverPolkitCheckStorageVol(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virStorageVolDefPtr vol,\n                                     virAccessPermStorageVol perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        \"vol_name\", vol->name,\n        \"vol_key\", vol->key,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-vol\",\n                                      virAccessPermStorageVolTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"storage-vol\"",
            "virAccessPermStorageVolTypeToString(perm)",
            "attrs"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermStorageVolTypeToString",
          "args": [
            "perm"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "pool->uuid",
            "uuidstr"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStorageVol(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virStorageVolDefPtr vol,\n                                     virAccessPermStorageVol perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        \"vol_name\", vol->name,\n        \"vol_key\", vol->key,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-vol\",\n                                      virAccessPermStorageVolTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckStoragePool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "402-421",
    "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"storage-pool\"",
            "virAccessPermStoragePoolTypeToString(perm)",
            "attrs"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermStoragePoolTypeToString",
          "args": [
            "perm"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "pool->uuid",
            "uuidstr"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckSecret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "324-400",
    "snippet": "static int\nvirAccessDriverPolkitCheckSecret(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virSecretDefPtr secret,\n                                 virAccessPermSecret perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virUUIDFormat(secret->uuid, uuidstr);\n\n    switch (secret->usage_type) {\n    default:\n    case VIR_SECRET_USAGE_TYPE_NONE: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_VOLUME: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            \"secret_usage_volume\", secret->usage_id,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_CEPH: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            \"secret_usage_ceph\", secret->usage_id,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_ISCSI: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            \"secret_usage_target\", secret->usage_id,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_TLS: {\n        const char *attrs[] = {\n                    \"connect_driver\", driverName,\n                    \"secret_uuid\", uuidstr,\n                    \"secret_usage_name\", secret->usage_id,\n                    NULL,\n                };\n\n        return virAccessDriverPolkitCheck(manager,\n                                         \"secret\",\n                                         virAccessPermSecretTypeToString(perm),\n                                         attrs);\n    }   break;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"secret\"",
            "virAccessPermSecretTypeToString(perm)",
            "attrs"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermSecretTypeToString",
          "args": [
            "perm"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessPermSecretTypeToString",
          "args": [
            "perm"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessPermSecretTypeToString",
          "args": [
            "perm"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessPermSecretTypeToString",
          "args": [
            "perm"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessPermSecretTypeToString",
          "args": [
            "perm"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "secret->uuid",
            "uuidstr"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckSecret(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virSecretDefPtr secret,\n                                 virAccessPermSecret perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virUUIDFormat(secret->uuid, uuidstr);\n\n    switch (secret->usage_type) {\n    default:\n    case VIR_SECRET_USAGE_TYPE_NONE: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_VOLUME: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            \"secret_usage_volume\", secret->usage_id,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_CEPH: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            \"secret_usage_ceph\", secret->usage_id,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_ISCSI: {\n        const char *attrs[] = {\n            \"connect_driver\", driverName,\n            \"secret_uuid\", uuidstr,\n            \"secret_usage_target\", secret->usage_id,\n            NULL,\n        };\n\n        return virAccessDriverPolkitCheck(manager,\n                                          \"secret\",\n                                          virAccessPermSecretTypeToString(perm),\n                                          attrs);\n    }   break;\n    case VIR_SECRET_USAGE_TYPE_TLS: {\n        const char *attrs[] = {\n                    \"connect_driver\", driverName,\n                    \"secret_uuid\", uuidstr,\n                    \"secret_usage_name\", secret->usage_id,\n                    NULL,\n                };\n\n        return virAccessDriverPolkitCheck(manager,\n                                         \"secret\",\n                                         virAccessPermSecretTypeToString(perm),\n                                         attrs);\n    }   break;\n    }\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckNWFilterBinding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "304-322",
    "snippet": "static int\nvirAccessDriverPolkitCheckNWFilterBinding(virAccessManagerPtr manager,\n                                          const char *driverName,\n                                          virNWFilterBindingDefPtr binding,\n                                          virAccessPermNWFilterBinding perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"nwfilter_binding_portdev\", binding->portdevname,\n        \"nwfilter_binding_linkdev\", binding->linkdevname,\n        \"nwfilter_binding_filter\", binding->filter,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"nwfilter_binding\",\n                                      virAccessPermNWFilterBindingTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"nwfilter_binding\"",
            "virAccessPermNWFilterBindingTypeToString(perm)",
            "attrs"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermNWFilterBindingTypeToString",
          "args": [
            "perm"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckNWFilterBinding(virAccessManagerPtr manager,\n                                          const char *driverName,\n                                          virNWFilterBindingDefPtr binding,\n                                          virAccessPermNWFilterBinding perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"nwfilter_binding_portdev\", binding->portdevname,\n        \"nwfilter_binding_linkdev\", binding->linkdevname,\n        \"nwfilter_binding_filter\", binding->filter,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"nwfilter_binding\",\n                                      virAccessPermNWFilterBindingTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckNWFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "283-302",
    "snippet": "static int\nvirAccessDriverPolkitCheckNWFilter(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virNWFilterDefPtr nwfilter,\n                                   virAccessPermNWFilter perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"nwfilter_name\", nwfilter->name,\n        \"nwfilter_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(nwfilter->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"nwfilter\",\n                                      virAccessPermNWFilterTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"nwfilter\"",
            "virAccessPermNWFilterTypeToString(perm)",
            "attrs"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermNWFilterTypeToString",
          "args": [
            "perm"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "nwfilter->uuid",
            "uuidstr"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckNWFilter(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virNWFilterDefPtr nwfilter,\n                                   virAccessPermNWFilter perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"nwfilter_name\", nwfilter->name,\n        \"nwfilter_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(nwfilter->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"nwfilter\",\n                                      virAccessPermNWFilterTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckNodeDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "265-281",
    "snippet": "static int\nvirAccessDriverPolkitCheckNodeDevice(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNodeDeviceDefPtr nodedev,\n                                     virAccessPermNodeDevice perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"node_device_name\", nodedev->name,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"node-device\",\n                                      virAccessPermNodeDeviceTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"node-device\"",
            "virAccessPermNodeDeviceTypeToString(perm)",
            "attrs"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermNodeDeviceTypeToString",
          "args": [
            "perm"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckNodeDevice(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNodeDeviceDefPtr nodedev,\n                                     virAccessPermNodeDevice perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"node_device_name\", nodedev->name,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"node-device\",\n                                      virAccessPermNodeDeviceTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckNetworkPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "240-263",
    "snippet": "static int\nvirAccessDriverPolkitCheckNetworkPort(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virNetworkDefPtr network,\n                                      virNetworkPortDefPtr port,\n                                      virAccessPermNetworkPort perm)\n{\n    char uuidstr1[VIR_UUID_STRING_BUFLEN];\n    char uuidstr2[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"network_name\", network->name,\n        \"network_uuid\", uuidstr1,\n        \"port_uuid\", uuidstr2,\n        NULL,\n    };\n    virUUIDFormat(network->uuid, uuidstr1);\n    virUUIDFormat(port->uuid, uuidstr2);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"network-port\",\n                                      virAccessPermNetworkPortTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"network-port\"",
            "virAccessPermNetworkPortTypeToString(perm)",
            "attrs"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermNetworkPortTypeToString",
          "args": [
            "perm"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "port->uuid",
            "uuidstr2"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckNetworkPort(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virNetworkDefPtr network,\n                                      virNetworkPortDefPtr port,\n                                      virAccessPermNetworkPort perm)\n{\n    char uuidstr1[VIR_UUID_STRING_BUFLEN];\n    char uuidstr2[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"network_name\", network->name,\n        \"network_uuid\", uuidstr1,\n        \"port_uuid\", uuidstr2,\n        NULL,\n    };\n    virUUIDFormat(network->uuid, uuidstr1);\n    virUUIDFormat(port->uuid, uuidstr2);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"network-port\",\n                                      virAccessPermNetworkPortTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckNetwork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "219-238",
    "snippet": "static int\nvirAccessDriverPolkitCheckNetwork(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virNetworkDefPtr network,\n                                  virAccessPermNetwork perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"network_name\", network->name,\n        \"network_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(network->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"network\",\n                                      virAccessPermNetworkTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"network\"",
            "virAccessPermNetworkTypeToString(perm)",
            "attrs"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermNetworkTypeToString",
          "args": [
            "perm"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "network->uuid",
            "uuidstr"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckNetwork(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virNetworkDefPtr network,\n                                  virAccessPermNetwork perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"network_name\", network->name,\n        \"network_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(network->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"network\",\n                                      virAccessPermNetworkTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckInterface",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "200-217",
    "snippet": "static int\nvirAccessDriverPolkitCheckInterface(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virInterfaceDefPtr iface,\n                                    virAccessPermInterface perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"interface_name\", iface->name,\n        \"interface_macaddr\", iface->mac,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"interface\",\n                                      virAccessPermInterfaceTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"interface\"",
            "virAccessPermInterfaceTypeToString(perm)",
            "attrs"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermInterfaceTypeToString",
          "args": [
            "perm"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckInterface(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virInterfaceDefPtr iface,\n                                    virAccessPermInterface perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"interface_name\", iface->name,\n        \"interface_macaddr\", iface->mac,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"interface\",\n                                      virAccessPermInterfaceTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "179-198",
    "snippet": "static int\nvirAccessDriverPolkitCheckDomain(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virDomainDefPtr domain,\n                                 virAccessPermDomain perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"domain_name\", domain->name,\n        \"domain_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(domain->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"domain\",\n                                      virAccessPermDomainTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"domain\"",
            "virAccessPermDomainTypeToString(perm)",
            "attrs"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermDomainTypeToString",
          "args": [
            "perm"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "domain->uuid",
            "uuidstr"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckDomain(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virDomainDefPtr domain,\n                                 virAccessPermDomain perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"domain_name\", domain->name,\n        \"domain_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(domain->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"domain\",\n                                      virAccessPermDomainTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheckConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "163-177",
    "snippet": "static int\nvirAccessDriverPolkitCheckConnect(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virAccessPermConnect perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"connect\",\n                                      virAccessPermConnectTypeToString(perm),\n                                      attrs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessDriverPolkitCheck",
          "args": [
            "manager",
            "\"connect\"",
            "virAccessPermConnectTypeToString(perm)",
            "attrs"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "402-421",
          "snippet": "static int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckStoragePool(virAccessManagerPtr manager,\n                                      const char *driverName,\n                                      virStoragePoolDefPtr pool,\n                                      virAccessPermStoragePool perm)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        \"pool_name\", pool->name,\n        \"pool_uuid\", uuidstr,\n        NULL,\n    };\n    virUUIDFormat(pool->uuid, uuidstr);\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"storage-pool\",\n                                      virAccessPermStoragePoolTypeToString(perm),\n                                      attrs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessPermConnectTypeToString",
          "args": [
            "perm"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheckConnect(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virAccessPermConnect perm)\n{\n    const char *attrs[] = {\n        \"connect_driver\", driverName,\n        NULL,\n    };\n\n    return virAccessDriverPolkitCheck(manager,\n                                      \"connect\",\n                                      virAccessPermConnectTypeToString(perm),\n                                      attrs);\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "120-160",
    "snippet": "static int\nvirAccessDriverPolkitCheck(virAccessManagerPtr manager G_GNUC_UNUSED,\n                           const char *typename,\n                           const char *permname,\n                           const char **attrs)\n{\n    g_autofree char *actionid = NULL;\n    pid_t pid;\n    uid_t uid;\n    unsigned long long startTime;\n    int rv;\n\n    if (!(actionid = virAccessDriverPolkitFormatAction(typename, permname)))\n        return -1;\n\n    if (virAccessDriverPolkitGetCaller(actionid,\n                                       &pid,\n                                       &startTime,\n                                       &uid) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Check action '%s' for process '%lld' time %lld uid %d\",\n              actionid, (long long)pid, startTime, uid);\n\n    rv = virPolkitCheckAuth(actionid,\n                            pid,\n                            startTime,\n                            uid,\n                            attrs,\n                            false);\n\n    if (rv == 0) {\n        return 1; /* Allowed */\n    } else {\n        if (rv == -2) {\n            return 0; /* Denied */\n        } else {\n            return -1; /* Error */\n        }\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPolkitCheckAuth",
          "args": [
            "actionid",
            "pid",
            "startTime",
            "uid",
            "attrs",
            "false"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "virPolkitCheckAuth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpolkit.c",
          "lines": "214-225",
          "snippet": "int virPolkitCheckAuth(const char *actionid G_GNUC_UNUSED,\n                       pid_t pid G_GNUC_UNUSED,\n                       unsigned long long startTime G_GNUC_UNUSED,\n                       uid_t uid G_GNUC_UNUSED,\n                       const char **details G_GNUC_UNUSED,\n                       bool allowInteraction G_GNUC_UNUSED)\n{\n    VIR_ERROR(_(\"Polkit auth attempted, even though polkit is not available\"));\n    virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                   _(\"authentication failed\"));\n    return -1;\n}",
          "includes": [
            "# include <poll.h>",
            "#include \"virutil.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"viralloc.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virpolkit.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <poll.h>\n#include \"virutil.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"viralloc.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virpolkit.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virPolkitCheckAuth(const char *actionid G_GNUC_UNUSED,\n                       pid_t pid G_GNUC_UNUSED,\n                       unsigned long long startTime G_GNUC_UNUSED,\n                       uid_t uid G_GNUC_UNUSED,\n                       const char **details G_GNUC_UNUSED,\n                       bool allowInteraction G_GNUC_UNUSED)\n{\n    VIR_ERROR(_(\"Polkit auth attempted, even though polkit is not available\"));\n    virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                   _(\"authentication failed\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Check action '%s' for process '%lld' time %lld uid %d\"",
            "actionid",
            "(long long)pid",
            "startTime",
            "uid"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessDriverPolkitGetCaller",
          "args": [
            "actionid",
            "&pid",
            "&startTime",
            "&uid"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitGetCaller",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "73-117",
          "snippet": "static int\nvirAccessDriverPolkitGetCaller(const char *actionid,\n                               pid_t *pid,\n                               unsigned long long *startTime,\n                               uid_t *uid)\n{\n    g_autoptr(virIdentity) identity = virIdentityGetCurrent();\n    int rc;\n\n    if (!identity) {\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"Policy kit denied action %s from <anonymous>\"),\n                       actionid);\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessID(identity, pid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process ID available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessTime(identity, startTime)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process start time available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetUNIXUserID(identity, uid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No UNIX caller UID available\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitGetCaller(const char *actionid,\n                               pid_t *pid,\n                               unsigned long long *startTime,\n                               uid_t *uid)\n{\n    g_autoptr(virIdentity) identity = virIdentityGetCurrent();\n    int rc;\n\n    if (!identity) {\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"Policy kit denied action %s from <anonymous>\"),\n                       actionid);\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessID(identity, pid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process ID available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessTime(identity, startTime)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process start time available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetUNIXUserID(identity, uid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No UNIX caller UID available\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessDriverPolkitFormatAction",
          "args": [
            "typename",
            "permname"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessDriverPolkitFormatAction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
          "lines": "55-70",
          "snippet": "static char *\nvirAccessDriverPolkitFormatAction(const char *typename,\n                                  const char *permname)\n{\n    char *actionid = NULL;\n    size_t i;\n\n    actionid = g_strdup_printf(\"%s.%s.%s\", VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX,\n                               typename, permname);\n\n    for (i = 0; actionid[i]; i++)\n        if (actionid[i] == '_')\n            actionid[i] = '-';\n\n    return actionid;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virpolkit.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"viraccessdriverpolkit.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX \"org.libvirt.api\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\n#define VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX \"org.libvirt.api\"\n\nstatic char *\nvirAccessDriverPolkitFormatAction(const char *typename,\n                                  const char *permname)\n{\n    char *actionid = NULL;\n    size_t i;\n\n    actionid = g_strdup_printf(\"%s.%s.%s\", VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX,\n                               typename, permname);\n\n    for (i = 0; actionid[i]; i++)\n        if (actionid[i] == '_')\n            actionid[i] = '-';\n\n    return actionid;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitCheck(virAccessManagerPtr manager G_GNUC_UNUSED,\n                           const char *typename,\n                           const char *permname,\n                           const char **attrs)\n{\n    g_autofree char *actionid = NULL;\n    pid_t pid;\n    uid_t uid;\n    unsigned long long startTime;\n    int rv;\n\n    if (!(actionid = virAccessDriverPolkitFormatAction(typename, permname)))\n        return -1;\n\n    if (virAccessDriverPolkitGetCaller(actionid,\n                                       &pid,\n                                       &startTime,\n                                       &uid) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Check action '%s' for process '%lld' time %lld uid %d\",\n              actionid, (long long)pid, startTime, uid);\n\n    rv = virPolkitCheckAuth(actionid,\n                            pid,\n                            startTime,\n                            uid,\n                            attrs,\n                            false);\n\n    if (rv == 0) {\n        return 1; /* Allowed */\n    } else {\n        if (rv == -2) {\n            return 0; /* Denied */\n        } else {\n            return -1; /* Error */\n        }\n    }\n}"
  },
  {
    "function_name": "virAccessDriverPolkitGetCaller",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "73-117",
    "snippet": "static int\nvirAccessDriverPolkitGetCaller(const char *actionid,\n                               pid_t *pid,\n                               unsigned long long *startTime,\n                               uid_t *uid)\n{\n    g_autoptr(virIdentity) identity = virIdentityGetCurrent();\n    int rc;\n\n    if (!identity) {\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"Policy kit denied action %s from <anonymous>\"),\n                       actionid);\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessID(identity, pid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process ID available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessTime(identity, startTime)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process start time available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetUNIXUserID(identity, uid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No UNIX caller UID available\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No UNIX caller UID available\")"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No UNIX caller UID available\""
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityGetUNIXUserID",
          "args": [
            "identity",
            "uid"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetUNIXUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "249-266",
          "snippet": "int virIdentityGetUNIXUserID(virIdentityPtr ident,\n                             uid_t *uid)\n{\n    unsigned long long val;\n    int rc;\n\n    *uid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *uid = (uid_t)val;\n\n    return 1;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUNIXUserID(virIdentityPtr ident,\n                             uid_t *uid)\n{\n    unsigned long long val;\n    int rc;\n\n    *uid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *uid = (uid_t)val;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No process start time available\")"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityGetProcessTime",
          "args": [
            "identity",
            "startTime"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetProcessTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "332-340",
          "snippet": "int virIdentityGetProcessTime(virIdentityPtr ident,\n                              unsigned long long *timestamp)\n{\n    *timestamp = 0;\n    return virTypedParamsGetULLong(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetProcessTime(virIdentityPtr ident,\n                              unsigned long long *timestamp)\n{\n    *timestamp = 0;\n    return virTypedParamsGetULLong(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_PROCESS_TIME,\n                                   timestamp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No process ID available\")"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityGetProcessID",
          "args": [
            "identity",
            "pid"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetProcessID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "309-326",
          "snippet": "int virIdentityGetProcessID(virIdentityPtr ident,\n                            pid_t *pid)\n{\n    long long val;\n    int rc;\n\n    *pid = 0;\n    rc = virTypedParamsGetLLong(ident->params,\n                                ident->nparams,\n                                VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                &val);\n    if (rc <= 0)\n        return rc;\n\n    *pid = (pid_t)val;\n\n    return 1;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetProcessID(virIdentityPtr ident,\n                            pid_t *pid)\n{\n    long long val;\n    int rc;\n\n    *pid = 0;\n    rc = virTypedParamsGetLLong(ident->params,\n                                ident->nparams,\n                                VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                &val);\n    if (rc <= 0)\n        return rc;\n\n    *pid = (pid_t)val;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessError",
          "args": [
            "VIR_ERR_ACCESS_DENIED",
            "_(\"Policy kit denied action %s from <anonymous>\")",
            "actionid"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityGetCurrent",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetCurrent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "100-111",
          "snippet": "virIdentityPtr virIdentityGetCurrent(void)\n{\n    virIdentityPtr ident;\n\n    if (virIdentityInitialize() < 0)\n        return NULL;\n\n    ident = virThreadLocalGet(&virIdentityCurrent);\n    if (ident)\n        g_object_ref(ident);\n    return ident;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virThreadLocal virIdentityCurrent;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic virThreadLocal virIdentityCurrent;\n\nvirIdentityPtr virIdentityGetCurrent(void)\n{\n    virIdentityPtr ident;\n\n    if (virIdentityInitialize() < 0)\n        return NULL;\n\n    ident = virThreadLocalGet(&virIdentityCurrent);\n    if (ident)\n        g_object_ref(ident);\n    return ident;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverPolkitGetCaller(const char *actionid,\n                               pid_t *pid,\n                               unsigned long long *startTime,\n                               uid_t *uid)\n{\n    g_autoptr(virIdentity) identity = virIdentityGetCurrent();\n    int rc;\n\n    if (!identity) {\n        virAccessError(VIR_ERR_ACCESS_DENIED,\n                       _(\"Policy kit denied action %s from <anonymous>\"),\n                       actionid);\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessID(identity, pid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process ID available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetProcessTime(identity, startTime)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No process start time available\"));\n        return -1;\n    }\n\n    if ((rc = virIdentityGetUNIXUserID(identity, uid)) < 0)\n        return -1;\n\n    if (rc == 0) {\n        virAccessError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No UNIX caller UID available\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virAccessDriverPolkitFormatAction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "55-70",
    "snippet": "static char *\nvirAccessDriverPolkitFormatAction(const char *typename,\n                                  const char *permname)\n{\n    char *actionid = NULL;\n    size_t i;\n\n    actionid = g_strdup_printf(\"%s.%s.%s\", VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX,\n                               typename, permname);\n\n    for (i = 0; actionid[i]; i++)\n        if (actionid[i] == '_')\n            actionid[i] = '-';\n\n    return actionid;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX \"org.libvirt.api\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.%s.%s\"",
            "VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX",
            "typename",
            "permname"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\n#define VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX \"org.libvirt.api\"\n\nstatic char *\nvirAccessDriverPolkitFormatAction(const char *typename,\n                                  const char *permname)\n{\n    char *actionid = NULL;\n    size_t i;\n\n    actionid = g_strdup_printf(\"%s.%s.%s\", VIR_ACCESS_DRIVER_POLKIT_ACTION_PREFIX,\n                               typename, permname);\n\n    for (i = 0; actionid[i]; i++)\n        if (actionid[i] == '_')\n            actionid[i] = '-';\n\n    return actionid;\n}"
  },
  {
    "function_name": "virAccessDriverPolkitCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverpolkit.c",
    "lines": "50-52",
    "snippet": "static void virAccessDriverPolkitCleanup(virAccessManagerPtr manager G_GNUC_UNUSED)\n{\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virpolkit.h\"",
      "#include \"virerror.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverpolkit.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virpolkit.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverpolkit.h\"\n#include <config.h>\n\nstatic void virAccessDriverPolkitCleanup(virAccessManagerPtr manager G_GNUC_UNUSED)\n{\n}"
  }
]