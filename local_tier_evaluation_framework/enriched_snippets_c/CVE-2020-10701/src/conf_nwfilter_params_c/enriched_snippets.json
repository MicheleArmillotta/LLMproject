[
  {
    "function_name": "virNWFilterVarAccessIsAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "1013-1040",
    "snippet": "bool\nvirNWFilterVarAccessIsAvailable(const virNWFilterVarAccess *varAccess,\n                                const virHashTable *hash)\n{\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n    const char *res;\n    unsigned int idx;\n    virNWFilterVarValuePtr varValue;\n\n    varValue = virHashLookup(hash, varName);\n    if (!varValue)\n        return false;\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        idx = virNWFilterVarAccessGetIndex(varAccess);\n        res = virNWFilterVarValueGetNthValue(varValue, idx);\n        if (res == NULL)\n            return false;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetNthValue",
          "args": [
            "varValue",
            "idx"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "142-164",
          "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetIndex",
          "args": [
            "varAccess"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "994-998",
          "snippet": "unsigned int\nvirNWFilterVarAccessGetIndex(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.idx;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nunsigned int\nvirNWFilterVarAccessGetIndex(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetType",
          "args": [
            "varAccess"
          ],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "982-986",
          "snippet": "virNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nvirNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "hash",
            "varName"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetVarName",
          "args": [
            "varAccess"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetVarName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "976-980",
          "snippet": "const char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nconst char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nbool\nvirNWFilterVarAccessIsAvailable(const virNWFilterVarAccess *varAccess,\n                                const virHashTable *hash)\n{\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n    const char *res;\n    unsigned int idx;\n    virNWFilterVarValuePtr varValue;\n\n    varValue = virHashLookup(hash, varName);\n    if (!varValue)\n        return false;\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        idx = virNWFilterVarAccessGetIndex(varAccess);\n        res = virNWFilterVarValueGetNthValue(varValue, idx);\n        if (res == NULL)\n            return false;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessGetIntIterId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "1007-1011",
    "snippet": "static unsigned int\nvirNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.intIterId;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nstatic unsigned int\nvirNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.intIterId;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessSetIntIterId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "1000-1005",
    "snippet": "static void\nvirNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr vap,\n                                 unsigned int intIterId)\n{\n    vap->u.index.intIterId = intIterId;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nstatic void\nvirNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr vap,\n                                 unsigned int intIterId)\n{\n    vap->u.index.intIterId = intIterId;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessGetIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "994-998",
    "snippet": "unsigned int\nvirNWFilterVarAccessGetIndex(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.idx;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nunsigned int\nvirNWFilterVarAccessGetIndex(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.idx;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessGetIterId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "988-992",
    "snippet": "unsigned int\nvirNWFilterVarAccessGetIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.iterId;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nunsigned int\nvirNWFilterVarAccessGetIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.iterId;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessGetType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "982-986",
    "snippet": "virNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nvirNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessGetVarName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "976-980",
    "snippet": "const char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nconst char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessPrint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "959-974",
    "snippet": "void\nvirNWFilterVarAccessPrint(virNWFilterVarAccessPtr vap, virBufferPtr buf)\n{\n    virBufferAdd(buf, vap->varName, -1);\n    switch (vap->accessType) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        virBufferAsprintf(buf, \"[%u]\", vap->u.index.idx);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        if (vap->u.iterId != 0)\n            virBufferAsprintf(buf, \"[@%u]\", vap->u.iterId);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        break;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"[@%u]\"",
            "vap->u.iterId"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "buf",
            "vap->varName",
            "-1"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nvoid\nvirNWFilterVarAccessPrint(virNWFilterVarAccessPtr vap, virBufferPtr buf)\n{\n    virBufferAdd(buf, vap->varName, -1);\n    switch (vap->accessType) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        virBufferAsprintf(buf, \"[%u]\", vap->u.index.idx);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        if (vap->u.iterId != 0)\n            virBufferAsprintf(buf, \"[@%u]\", vap->u.iterId);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        break;\n    }\n}"
  },
  {
    "function_name": "virNWFilterVarAccessParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "870-957",
    "snippet": "virNWFilterVarAccessPtr\nvirNWFilterVarAccessParse(const char *varAccess)\n{\n    size_t idx, varNameLen;\n    virNWFilterVarAccessPtr dest;\n    const char *input = varAccess;\n\n    if (VIR_ALLOC(dest) < 0)\n        return NULL;\n\n    idx = strspn(input, VALID_VARNAME);\n\n    if (input[idx] == '\\0') {\n        /* in the form 'IP', which is equivalent to IP[@0] */\n        dest->varName = g_strndup(input, idx);\n        dest->accessType = VIR_NWFILTER_VAR_ACCESS_ITERATOR;\n        dest->u.iterId = 0;\n        return dest;\n    }\n\n    if (input[idx] == '[') {\n        char *end_ptr;\n        unsigned int result;\n        bool parseError = false;\n\n        varNameLen = idx;\n\n        dest->varName = g_strndup(input, varNameLen);\n\n        input += idx + 1;\n        virSkipSpaces(&input);\n\n        if (*input == '@') {\n            /* in the form 'IP[@<number>] -> iterator */\n            dest->accessType = VIR_NWFILTER_VAR_ACCESS_ITERATOR;\n            input++;\n        } else {\n            /* in the form 'IP[<number>] -> element */\n            dest->accessType = VIR_NWFILTER_VAR_ACCESS_ELEMENT;\n        }\n\n        if (virStrToLong_ui(input, &end_ptr, 10, &result) < 0)\n            parseError = true;\n        if (!parseError) {\n            input = end_ptr;\n            virSkipSpaces(&input);\n            if (*input != ']')\n                parseError = true;\n        }\n        if (parseError) {\n            if (dest->accessType == VIR_NWFILTER_VAR_ACCESS_ELEMENT)\n                virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                               _(\"Malformatted array index\"));\n            else\n                virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                               _(\"Malformatted iterator id\"));\n            goto err_exit;\n        }\n\n        switch (dest->accessType) {\n        case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n            dest->u.index.idx = result;\n            dest->u.index.intIterId = ~0;\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n            if (result > VIR_NWFILTER_MAX_ITERID) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"Iterator ID exceeds maximum ID \"\n                                 \"of %u\"), VIR_NWFILTER_MAX_ITERID);\n                goto err_exit;\n            }\n            dest->u.iterId = result;\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_LAST:\n            goto err_exit;\n        }\n\n        return dest;\n    } else {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Malformatted variable\"));\n    }\n\n err_exit:\n    virNWFilterVarAccessFree(dest);\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarAccessFree",
          "args": [
            "dest"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "832-840",
          "snippet": "void\nvirNWFilterVarAccessFree(virNWFilterVarAccessPtr varAccess)\n{\n    if (!varAccess)\n        return;\n\n    VIR_FREE(varAccess->varName);\n    VIR_FREE(varAccess);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nvoid\nvirNWFilterVarAccessFree(virNWFilterVarAccessPtr varAccess)\n{\n    if (!varAccess)\n        return;\n\n    VIR_FREE(varAccess->varName);\n    VIR_FREE(varAccess);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Malformatted variable\")"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Malformatted variable\""
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Iterator ID exceeds maximum ID \"\n                                 \"of %u\")",
            "VIR_NWFILTER_MAX_ITERID"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Malformatted iterator id\")"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Malformatted array index\")"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "&input"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "input",
            "&end_ptr",
            "10",
            "&result"
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "input",
            "varNameLen"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "input",
            "idx"
          ],
          "line": 884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "input",
            "VALID_VARNAME"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "dest"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nvirNWFilterVarAccessPtr\nvirNWFilterVarAccessParse(const char *varAccess)\n{\n    size_t idx, varNameLen;\n    virNWFilterVarAccessPtr dest;\n    const char *input = varAccess;\n\n    if (VIR_ALLOC(dest) < 0)\n        return NULL;\n\n    idx = strspn(input, VALID_VARNAME);\n\n    if (input[idx] == '\\0') {\n        /* in the form 'IP', which is equivalent to IP[@0] */\n        dest->varName = g_strndup(input, idx);\n        dest->accessType = VIR_NWFILTER_VAR_ACCESS_ITERATOR;\n        dest->u.iterId = 0;\n        return dest;\n    }\n\n    if (input[idx] == '[') {\n        char *end_ptr;\n        unsigned int result;\n        bool parseError = false;\n\n        varNameLen = idx;\n\n        dest->varName = g_strndup(input, varNameLen);\n\n        input += idx + 1;\n        virSkipSpaces(&input);\n\n        if (*input == '@') {\n            /* in the form 'IP[@<number>] -> iterator */\n            dest->accessType = VIR_NWFILTER_VAR_ACCESS_ITERATOR;\n            input++;\n        } else {\n            /* in the form 'IP[<number>] -> element */\n            dest->accessType = VIR_NWFILTER_VAR_ACCESS_ELEMENT;\n        }\n\n        if (virStrToLong_ui(input, &end_ptr, 10, &result) < 0)\n            parseError = true;\n        if (!parseError) {\n            input = end_ptr;\n            virSkipSpaces(&input);\n            if (*input != ']')\n                parseError = true;\n        }\n        if (parseError) {\n            if (dest->accessType == VIR_NWFILTER_VAR_ACCESS_ELEMENT)\n                virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                               _(\"Malformatted array index\"));\n            else\n                virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                               _(\"Malformatted iterator id\"));\n            goto err_exit;\n        }\n\n        switch (dest->accessType) {\n        case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n            dest->u.index.idx = result;\n            dest->u.index.intIterId = ~0;\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n            if (result > VIR_NWFILTER_MAX_ITERID) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"Iterator ID exceeds maximum ID \"\n                                 \"of %u\"), VIR_NWFILTER_MAX_ITERID);\n                goto err_exit;\n            }\n            dest->u.iterId = result;\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_LAST:\n            goto err_exit;\n        }\n\n        return dest;\n    } else {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Malformatted variable\"));\n    }\n\n err_exit:\n    virNWFilterVarAccessFree(dest);\n\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "842-864",
    "snippet": "bool\nvirNWFilterVarAccessEqual(const virNWFilterVarAccess *a,\n                          const virNWFilterVarAccess *b)\n{\n    if (a->accessType != b->accessType)\n        return false;\n\n    if (STRNEQ(a->varName, b->varName))\n        return false;\n\n    switch (a->accessType) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        return (a->u.index.idx == b->u.index.idx &&\n                a->u.index.intIterId == b->u.index.intIterId);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        return a->u.iterId == b->u.iterId;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        break;\n    }\n    return false;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "a->varName",
            "b->varName"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nbool\nvirNWFilterVarAccessEqual(const virNWFilterVarAccess *a,\n                          const virNWFilterVarAccess *b)\n{\n    if (a->accessType != b->accessType)\n        return false;\n\n    if (STRNEQ(a->varName, b->varName))\n        return false;\n\n    switch (a->accessType) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        return (a->u.index.idx == b->u.index.idx &&\n                a->u.index.intIterId == b->u.index.intIterId);\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        return a->u.iterId == b->u.iterId;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        break;\n    }\n    return false;\n}"
  },
  {
    "function_name": "virNWFilterVarAccessFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "832-840",
    "snippet": "void\nvirNWFilterVarAccessFree(virNWFilterVarAccessPtr varAccess)\n{\n    if (!varAccess)\n        return;\n\n    VIR_FREE(varAccess->varName);\n    VIR_FREE(varAccess);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "varAccess"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "varAccess->varName"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nvoid\nvirNWFilterVarAccessFree(virNWFilterVarAccessPtr varAccess)\n{\n    if (!varAccess)\n        return;\n\n    VIR_FREE(varAccess->varName);\n    VIR_FREE(varAccess);\n}"
  },
  {
    "function_name": "virNWFilterFormatParamAttributes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "783-830",
    "snippet": "int\nvirNWFilterFormatParamAttributes(virBufferPtr buf,\n                                 virHashTablePtr table,\n                                 const char *filterref)\n{\n    virHashKeyValuePairPtr items;\n    size_t i, j;\n    int card, numKeys;\n\n    numKeys = virHashSize(table);\n\n    if (numKeys < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing filter parameter table\"));\n        return -1;\n    }\n\n    items = virHashGetItems(table,\n                            virNWFilterFormatParameterNameSorter);\n    if (!items)\n        return -1;\n\n    virBufferAsprintf(buf, \"<filterref filter='%s'\", filterref);\n    if (numKeys) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < numKeys; i++) {\n            const virNWFilterVarValue *value = items[i].value;\n\n            card = virNWFilterVarValueGetCardinality(value);\n\n            for (j = 0; j < card; j++)\n                virBufferAsprintf(buf,\n                                  \"<parameter name='%s' value='%s'/>\\n\",\n                                  (const char *)items[i].key,\n                                  virNWFilterVarValueGetNthValue(value, j));\n\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</filterref>\\n\");\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    VIR_FREE(items);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "items"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</filterref>\\n\""
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<parameter name='%s' value='%s'/>\\n\"",
            "(const char *)items[i].key",
            "virNWFilterVarValueGetNthValue(value, j)"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetNthValue",
          "args": [
            "value",
            "j"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "142-164",
          "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetCardinality",
          "args": [
            "value"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetCardinality",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "166-180",
          "snippet": "unsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nunsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashGetItems",
          "args": [
            "table",
            "virNWFilterFormatParameterNameSorter"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "virHashGetItems",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "783-805",
          "snippet": "virHashKeyValuePairPtr virHashGetItems(virHashTablePtr table,\n                                       virHashKeyComparator compar)\n{\n    ssize_t numElems = virHashSize(table);\n    struct getKeysIter iter = {\n        .arrayIdx = 0,\n        .sortArray = NULL,\n    };\n\n    if (numElems < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(iter.sortArray, numElems + 1))\n        return NULL;\n\n    virHashForEach(table, virHashGetKeysIterator, &iter);\n\n    if (compar)\n        qsort(&iter.sortArray[0], numElems, sizeof(iter.sortArray[0]),\n              (qsort_comp)compar);\n\n    return iter.sortArray;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashKeyValuePairPtr virHashGetItems(virHashTablePtr table,\n                                       virHashKeyComparator compar)\n{\n    ssize_t numElems = virHashSize(table);\n    struct getKeysIter iter = {\n        .arrayIdx = 0,\n        .sortArray = NULL,\n    };\n\n    if (numElems < 0)\n        return NULL;\n\n    if (VIR_ALLOC_N(iter.sortArray, numElems + 1))\n        return NULL;\n\n    virHashForEach(table, virHashGetKeysIterator, &iter);\n\n    if (compar)\n        qsort(&iter.sortArray[0], numElems, sizeof(iter.sortArray[0]),\n              (qsort_comp)compar);\n\n    return iter.sortArray;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing filter parameter table\")"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing filter parameter table\""
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "table"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nint\nvirNWFilterFormatParamAttributes(virBufferPtr buf,\n                                 virHashTablePtr table,\n                                 const char *filterref)\n{\n    virHashKeyValuePairPtr items;\n    size_t i, j;\n    int card, numKeys;\n\n    numKeys = virHashSize(table);\n\n    if (numKeys < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing filter parameter table\"));\n        return -1;\n    }\n\n    items = virHashGetItems(table,\n                            virNWFilterFormatParameterNameSorter);\n    if (!items)\n        return -1;\n\n    virBufferAsprintf(buf, \"<filterref filter='%s'\", filterref);\n    if (numKeys) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        for (i = 0; i < numKeys; i++) {\n            const virNWFilterVarValue *value = items[i].value;\n\n            card = virNWFilterVarValueGetCardinality(value);\n\n            for (j = 0; j < card; j++)\n                virBufferAsprintf(buf,\n                                  \"<parameter name='%s' value='%s'/>\\n\",\n                                  (const char *)items[i].key,\n                                  virNWFilterVarValueGetNthValue(value, j));\n\n        }\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</filterref>\\n\");\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    VIR_FREE(items);\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterFormatParameterNameSorter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "776-781",
    "snippet": "static int\nvirNWFilterFormatParameterNameSorter(const virHashKeyValuePair *a,\n                                     const virHashKeyValuePair *b)\n{\n    return strcmp(a->key, b->key);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a->key",
            "b->key"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterFormatParameterNameSorter(const virHashKeyValuePair *a,\n                                     const virHashKeyValuePair *b)\n{\n    return strcmp(a->key, b->key);\n}"
  },
  {
    "function_name": "virNWFilterParseParamAttributes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "717-773",
    "snippet": "virHashTablePtr\nvirNWFilterParseParamAttributes(xmlNodePtr cur)\n{\n    char *nam, *val;\n    virNWFilterVarValuePtr value;\n\n    virHashTablePtr table = virNWFilterHashTableCreate(0);\n    if (!table)\n        return NULL;\n\n    cur = cur->children;\n\n    while (cur != NULL) {\n        if (cur->type == XML_ELEMENT_NODE) {\n            if (virXMLNodeNameEqual(cur, \"parameter\")) {\n                nam = virXMLPropString(cur, \"name\");\n                val = virXMLPropString(cur, \"value\");\n                value = NULL;\n                if (nam != NULL && val != NULL) {\n                    if (!isValidVarName(nam))\n                        goto skip_entry;\n                    if (!isValidVarValue(val))\n                        goto skip_entry;\n                    value = virHashLookup(table, nam);\n                    if (value) {\n                        /* add value to existing value -> list */\n                        if (virNWFilterVarValueAddValue(value, val) < 0) {\n                            value = NULL;\n                            goto err_exit;\n                        }\n                        val = NULL;\n                    } else {\n                        value = virNWFilterParseVarValue(val);\n                        if (!value)\n                            goto skip_entry;\n                        if (virHashUpdateEntry(table, nam, value) < 0)\n                            goto err_exit;\n                    }\n                    value = NULL;\n                }\n skip_entry:\n                virNWFilterVarValueFree(value);\n                VIR_FREE(nam);\n                VIR_FREE(val);\n            }\n        }\n        cur = cur->next;\n    }\n    return table;\n\n err_exit:\n    VIR_FREE(nam);\n    VIR_FREE(val);\n    virNWFilterVarValueFree(value);\n    virHashFree(table);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "table"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueFree",
          "args": [
            "value"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "43-64",
          "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nam"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nam"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashUpdateEntry",
          "args": [
            "table",
            "nam",
            "value"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "virHashUpdateEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "422-427",
          "snippet": "int\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterParseVarValue",
          "args": [
            "val"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterParseVarValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "711-715",
          "snippet": "static virNWFilterVarValuePtr\nvirNWFilterParseVarValue(const char *val)\n{\n    return virNWFilterVarValueCreateSimpleCopyValue(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterVarValuePtr\nvirNWFilterParseVarValue(const char *val)\n{\n    return virNWFilterVarValueCreateSimpleCopyValue(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueAddValue",
          "args": [
            "value",
            "val"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueAddValueCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "251-261",
          "snippet": "int\nvirNWFilterVarValueAddValueCopy(virNWFilterVarValuePtr val, const char *value)\n{\n    char *valdup;\n    valdup = g_strdup(value);\n    if (virNWFilterVarValueAddValue(val, valdup) < 0) {\n        VIR_FREE(valdup);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nint\nvirNWFilterVarValueAddValueCopy(virNWFilterVarValuePtr val, const char *value)\n{\n    char *valdup;\n    valdup = g_strdup(value);\n    if (virNWFilterVarValueAddValue(val, valdup) < 0) {\n        VIR_FREE(valdup);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "table",
            "nam"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isValidVarValue",
          "args": [
            "val"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "isValidVarValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "705-709",
          "snippet": "static bool\nisValidVarValue(const char *value)\n{\n    return (value[strspn(value, VALID_VARVALUE)] == 0) && (strlen(value) != 0);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nstatic bool\nisValidVarValue(const char *value)\n{\n    return (value[strspn(value, VALID_VARVALUE)] == 0) && (strlen(value) != 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isValidVarName",
          "args": [
            "nam"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "isValidVarName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "698-702",
          "snippet": "static bool\nisValidVarName(const char *var)\n{\n    return var[strspn(var, VALID_VARNAME)] == 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nisValidVarName(const char *var)\n{\n    return var[strspn(var, VALID_VARNAME)] == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "cur",
            "\"value\""
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "cur",
            "\"parameter\""
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterHashTableCreate",
          "args": [
            "0"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterHashTableCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "628-632",
          "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirHashTablePtr\nvirNWFilterParseParamAttributes(xmlNodePtr cur)\n{\n    char *nam, *val;\n    virNWFilterVarValuePtr value;\n\n    virHashTablePtr table = virNWFilterHashTableCreate(0);\n    if (!table)\n        return NULL;\n\n    cur = cur->children;\n\n    while (cur != NULL) {\n        if (cur->type == XML_ELEMENT_NODE) {\n            if (virXMLNodeNameEqual(cur, \"parameter\")) {\n                nam = virXMLPropString(cur, \"name\");\n                val = virXMLPropString(cur, \"value\");\n                value = NULL;\n                if (nam != NULL && val != NULL) {\n                    if (!isValidVarName(nam))\n                        goto skip_entry;\n                    if (!isValidVarValue(val))\n                        goto skip_entry;\n                    value = virHashLookup(table, nam);\n                    if (value) {\n                        /* add value to existing value -> list */\n                        if (virNWFilterVarValueAddValue(value, val) < 0) {\n                            value = NULL;\n                            goto err_exit;\n                        }\n                        val = NULL;\n                    } else {\n                        value = virNWFilterParseVarValue(val);\n                        if (!value)\n                            goto skip_entry;\n                        if (virHashUpdateEntry(table, nam, value) < 0)\n                            goto err_exit;\n                    }\n                    value = NULL;\n                }\n skip_entry:\n                virNWFilterVarValueFree(value);\n                VIR_FREE(nam);\n                VIR_FREE(val);\n            }\n        }\n        cur = cur->next;\n    }\n    return table;\n\n err_exit:\n    VIR_FREE(nam);\n    VIR_FREE(val);\n    virNWFilterVarValueFree(value);\n    virHashFree(table);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterParseVarValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "711-715",
    "snippet": "static virNWFilterVarValuePtr\nvirNWFilterParseVarValue(const char *val)\n{\n    return virNWFilterVarValueCreateSimpleCopyValue(val);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueCreateSimpleCopyValue",
          "args": [
            "val"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueCreateSimpleCopyValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "121-132",
          "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterVarValuePtr\nvirNWFilterParseVarValue(const char *val)\n{\n    return virNWFilterVarValueCreateSimpleCopyValue(val);\n}"
  },
  {
    "function_name": "isValidVarValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "705-709",
    "snippet": "static bool\nisValidVarValue(const char *value)\n{\n    return (value[strspn(value, VALID_VARVALUE)] == 0) && (strlen(value) != 0);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "value",
            "VALID_VARVALUE"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nstatic bool\nisValidVarValue(const char *value)\n{\n    return (value[strspn(value, VALID_VARVALUE)] == 0) && (strlen(value) != 0);\n}"
  },
  {
    "function_name": "isValidVarName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "698-702",
    "snippet": "static bool\nisValidVarName(const char *var)\n{\n    return var[strspn(var, VALID_VARNAME)] == 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "var",
            "VALID_VARNAME"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nisValidVarName(const char *var)\n{\n    return var[strspn(var, VALID_VARNAME)] == 0;\n}"
  },
  {
    "function_name": "virNWFilterHashTableEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "691-696",
    "snippet": "bool\nvirNWFilterHashTableEqual(virHashTablePtr a,\n                          virHashTablePtr b)\n{\n    return virHashEqual(a, b, virNWFilterVarValueCompare);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashEqual",
          "args": [
            "a",
            "b",
            "virNWFilterVarValueCompare"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "virHashEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "831-851",
          "snippet": "bool virHashEqual(const virHashTable *table1,\n                  const virHashTable *table2,\n                  virHashValueComparator compar)\n{\n    struct virHashEqualData data = {\n        .equal = true,\n        .table2 = table2,\n        .compar = compar,\n    };\n\n    if (table1 == table2)\n        return true;\n\n    if (!table1 || !table2 ||\n        virHashSize(table1) != virHashSize(table2))\n        return false;\n\n    virHashSearch(table1, virHashEqualSearcher, &data, NULL);\n\n    return data.equal;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nbool virHashEqual(const virHashTable *table1,\n                  const virHashTable *table2,\n                  virHashValueComparator compar)\n{\n    struct virHashEqualData data = {\n        .equal = true,\n        .table2 = table2,\n        .compar = compar,\n    };\n\n    if (table1 == table2)\n        return true;\n\n    if (!table1 || !table2 ||\n        virHashSize(table1) != virHashSize(table2))\n        return false;\n\n    virHashSearch(table1, virHashEqualSearcher, &data, NULL);\n\n    return data.equal;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirNWFilterHashTableEqual(virHashTablePtr a,\n                          virHashTablePtr b)\n{\n    return virHashEqual(a, b, virNWFilterVarValueCompare);\n}"
  },
  {
    "function_name": "virNWFilterVarValueCompare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "684-689",
    "snippet": "static int\nvirNWFilterVarValueCompare(const void *a, const void *b)\n{\n    return virNWFilterVarValueEqual((const virNWFilterVarValue *) a,\n                                    (const virNWFilterVarValue *) b) ? 0 : 1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueEqual",
          "args": [
            "(const virNWFilterVarValue *) a",
            "(const virNWFilterVarValue *) b"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "182-212",
          "snippet": "bool\nvirNWFilterVarValueEqual(const virNWFilterVarValue *a,\n                         const virNWFilterVarValue *b)\n{\n    unsigned int card;\n    size_t i, j;\n    const char *s;\n\n    if (!a || !b)\n        return false;\n\n    card = virNWFilterVarValueGetCardinality(a);\n    if (card != virNWFilterVarValueGetCardinality(b))\n        return false;\n\n    /* brute force O(n^2) comparison */\n    for (i = 0; i < card; i++) {\n        bool eq = false;\n\n        s = virNWFilterVarValueGetNthValue(a, i);\n        for (j = 0; j < card; j++) {\n            if (STREQ_NULLABLE(s, virNWFilterVarValueGetNthValue(b, j))) {\n                 eq = true;\n                 break;\n            }\n        }\n        if (!eq)\n            return false;\n    }\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirNWFilterVarValueEqual(const virNWFilterVarValue *a,\n                         const virNWFilterVarValue *b)\n{\n    unsigned int card;\n    size_t i, j;\n    const char *s;\n\n    if (!a || !b)\n        return false;\n\n    card = virNWFilterVarValueGetCardinality(a);\n    if (card != virNWFilterVarValueGetCardinality(b))\n        return false;\n\n    /* brute force O(n^2) comparison */\n    for (i = 0; i < card; i++) {\n        bool eq = false;\n\n        s = virNWFilterVarValueGetNthValue(a, i);\n        for (j = 0; j < card; j++) {\n            if (STREQ_NULLABLE(s, virNWFilterVarValueGetNthValue(b, j))) {\n                 eq = true;\n                 break;\n            }\n        }\n        if (!eq)\n            return false;\n    }\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarValueCompare(const void *a, const void *b)\n{\n    return virNWFilterVarValueEqual((const virNWFilterVarValue *) a,\n                                    (const virNWFilterVarValue *) b) ? 0 : 1;\n}"
  },
  {
    "function_name": "virNWFilterHashTablePutAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "664-678",
    "snippet": "int\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "src",
            "addToTable",
            "&atts"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterHashTablePutAll(virHashTablePtr src,\n                           virHashTablePtr dest)\n{\n    struct addToTableStruct atts = {\n        .target = dest,\n        .errOccurred = 0,\n    };\n\n    virHashForEach(src, addToTable, &atts);\n    if (atts.errOccurred)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "addToTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "640-661",
    "snippet": "static int\naddToTable(void *payload, const void *name, void *data)\n{\n    struct addToTableStruct *atts = (struct addToTableStruct *)data;\n    virNWFilterVarValuePtr val;\n\n    if (atts->errOccurred)\n        return 0;\n\n    val = virNWFilterVarValueCopy((virNWFilterVarValuePtr)payload);\n    if (!val) {\n        atts->errOccurred = 1;\n        return 0;\n    }\n\n    if (virHashUpdateEntry(atts->target, (const char *)name, val) < 0) {\n        atts->errOccurred = 1;\n        virNWFilterVarValueFree(val);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueFree",
          "args": [
            "val"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "43-64",
          "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashUpdateEntry",
          "args": [
            "atts->target",
            "(const char *)name",
            "val"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "virHashUpdateEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "422-427",
          "snippet": "int\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashUpdateEntry(virHashTablePtr table, const void *name,\n                   void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueCopy",
          "args": [
            "(virNWFilterVarValuePtr)payload"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "66-99",
          "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCopy(const virNWFilterVarValue *val)\n{\n    virNWFilterVarValuePtr res;\n    size_t i;\n    char *str;\n\n    if (VIR_ALLOC(res) < 0)\n        return NULL;\n    res->valType = val->valType;\n\n    switch (res->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        res->u.simple.value = g_strdup(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (VIR_ALLOC_N(res->u.array.values, val->u.array.nValues) < 0)\n            goto err_exit;\n        res->u.array.nValues = val->u.array.nValues;\n        for (i = 0; i < val->u.array.nValues; i++) {\n            str = g_strdup(val->u.array.values[i]);\n            res->u.array.values[i] = str;\n        }\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n\n err_exit:\n    virNWFilterVarValueFree(res);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCopy(const virNWFilterVarValue *val)\n{\n    virNWFilterVarValuePtr res;\n    size_t i;\n    char *str;\n\n    if (VIR_ALLOC(res) < 0)\n        return NULL;\n    res->valType = val->valType;\n\n    switch (res->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        res->u.simple.value = g_strdup(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (VIR_ALLOC_N(res->u.array.values, val->u.array.nValues) < 0)\n            goto err_exit;\n        res->u.array.nValues = val->u.array.nValues;\n        for (i = 0; i < val->u.array.nValues; i++) {\n            str = g_strdup(val->u.array.values[i]);\n            res->u.array.values[i] = str;\n        }\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n\n err_exit:\n    virNWFilterVarValueFree(res);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\naddToTable(void *payload, const void *name, void *data)\n{\n    struct addToTableStruct *atts = (struct addToTableStruct *)data;\n    virNWFilterVarValuePtr val;\n\n    if (atts->errOccurred)\n        return 0;\n\n    val = virNWFilterVarValueCopy((virNWFilterVarValuePtr)payload);\n    if (!val) {\n        atts->errOccurred = 1;\n        return 0;\n    }\n\n    if (virHashUpdateEntry(atts->target, (const char *)name, val) < 0) {\n        atts->errOccurred = 1;\n        virNWFilterVarValueFree(val);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterHashTableCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "628-632",
    "snippet": "virHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "n",
            "hashDataFree"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirHashTablePtr\nvirNWFilterHashTableCreate(int n)\n{\n    return virHashCreate(n, hashDataFree);\n}"
  },
  {
    "function_name": "hashDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "621-625",
    "snippet": "static void\nhashDataFree(void *payload)\n{\n    virNWFilterVarValueFree(payload);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueFree",
          "args": [
            "payload"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "43-64",
          "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nhashDataFree(void *payload)\n{\n    virNWFilterVarValueFree(payload);\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterGetVarValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "550-619",
    "snippet": "const char *\nvirNWFilterVarCombIterGetVarValue(virNWFilterVarCombIterPtr ci,\n                                  const virNWFilterVarAccess *vap)\n{\n    size_t i;\n    unsigned int iterId;\n    bool found = false;\n    const char *res = NULL;\n    virNWFilterVarValuePtr value;\n    int iterIndex = -1;\n    const char *varName = virNWFilterVarAccessGetVarName(vap);\n\n    switch (virNWFilterVarAccessGetType(vap)) {\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        iterId = virNWFilterVarAccessGetIterId(vap);\n        iterIndex = virNWFilterVarCombIterGetIndexByIterId(ci, iterId);\n        if (iterIndex < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not get iterator index for \"\n                             \"iterator ID %u\"), iterId);\n            return NULL;\n        }\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        iterId = virNWFilterVarAccessGetIntIterId(vap);\n        iterIndex = virNWFilterVarCombIterGetIndexByIterId(ci, iterId);\n        if (iterIndex < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not get iterator index for \"\n                             \"(internal) iterator ID %u\"), iterId);\n            return NULL;\n        }\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return NULL;\n    }\n\n    for (i = 0; i < ci->iter[iterIndex].nVarNames; i++) {\n        if (STREQ(ci->iter[iterIndex].varNames[i], varName)) {\n            found = true;\n            break;\n        }\n    }\n\n    if (!found) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find variable '%s' in iterator\"),\n                       varName);\n        return NULL;\n    }\n\n    value = virHashLookup(ci->hashTable, varName);\n    if (!value) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find value for variable '%s'\"),\n                       varName);\n        return NULL;\n    }\n\n    res = virNWFilterVarValueGetNthValue(value, ci->iter[iterIndex].curValue);\n    if (!res) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get nth (%u) value of \"\n                         \"variable '%s'\"),\n                       ci->iter[iterIndex].curValue, varName);\n        return NULL;\n    }\n\n    return res;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);",
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get nth (%u) value of \"\n                         \"variable '%s'\")",
            "ci->iter[iterIndex].curValue",
            "varName"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not get nth (%u) value of \"\n                         \"variable '%s'\""
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetNthValue",
          "args": [
            "value",
            "ci->iter[iterIndex].curValue"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "142-164",
          "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find value for variable '%s'\")",
            "varName"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "ci->hashTable",
            "varName"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find variable '%s' in iterator\")",
            "varName"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "ci->iter[iterIndex].varNames[i]",
            "varName"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get iterator index for \"\n                             \"(internal) iterator ID %u\")",
            "iterId"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarCombIterGetIndexByIterId",
          "args": [
            "ci",
            "iterId"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarCombIterGetIndexByIterId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "322-333",
          "snippet": "static int\nvirNWFilterVarCombIterGetIndexByIterId(virNWFilterVarCombIterPtr ci,\n                                       unsigned int iterId)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++)\n        if (ci->iter[i].iterId == iterId)\n            return i;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarCombIterGetIndexByIterId(virNWFilterVarCombIterPtr ci,\n                                       unsigned int iterId)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++)\n        if (ci->iter[i].iterId == iterId)\n            return i;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetIntIterId",
          "args": [
            "vap"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetIntIterId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "1007-1011",
          "snippet": "static unsigned int\nvirNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.intIterId;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nstatic unsigned int\nvirNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.intIterId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not get iterator index for \"\n                             \"iterator ID %u\")",
            "iterId"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetIterId",
          "args": [
            "vap"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetIterId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "988-992",
          "snippet": "unsigned int\nvirNWFilterVarAccessGetIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.iterId;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nunsigned int\nvirNWFilterVarAccessGetIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.iterId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetType",
          "args": [
            "vap"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "982-986",
          "snippet": "virNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nvirNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetVarName",
          "args": [
            "vap"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetVarName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "976-980",
          "snippet": "const char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nconst char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nconst char *\nvirNWFilterVarCombIterGetVarValue(virNWFilterVarCombIterPtr ci,\n                                  const virNWFilterVarAccess *vap)\n{\n    size_t i;\n    unsigned int iterId;\n    bool found = false;\n    const char *res = NULL;\n    virNWFilterVarValuePtr value;\n    int iterIndex = -1;\n    const char *varName = virNWFilterVarAccessGetVarName(vap);\n\n    switch (virNWFilterVarAccessGetType(vap)) {\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        iterId = virNWFilterVarAccessGetIterId(vap);\n        iterIndex = virNWFilterVarCombIterGetIndexByIterId(ci, iterId);\n        if (iterIndex < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not get iterator index for \"\n                             \"iterator ID %u\"), iterId);\n            return NULL;\n        }\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        iterId = virNWFilterVarAccessGetIntIterId(vap);\n        iterIndex = virNWFilterVarCombIterGetIndexByIterId(ci, iterId);\n        if (iterIndex < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not get iterator index for \"\n                             \"(internal) iterator ID %u\"), iterId);\n            return NULL;\n        }\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return NULL;\n    }\n\n    for (i = 0; i < ci->iter[iterIndex].nVarNames; i++) {\n        if (STREQ(ci->iter[iterIndex].varNames[i], varName)) {\n            found = true;\n            break;\n        }\n    }\n\n    if (!found) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find variable '%s' in iterator\"),\n                       varName);\n        return NULL;\n    }\n\n    value = virHashLookup(ci->hashTable, varName);\n    if (!value) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find value for variable '%s'\"),\n                       varName);\n        return NULL;\n    }\n\n    res = virNWFilterVarValueGetNthValue(value, ci->iter[iterIndex].curValue);\n    if (!res) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get nth (%u) value of \"\n                         \"variable '%s'\"),\n                       ci->iter[iterIndex].curValue, varName);\n        return NULL;\n    }\n\n    return res;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterNext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "526-548",
    "snippet": "virNWFilterVarCombIterPtr\nvirNWFilterVarCombIterNext(virNWFilterVarCombIterPtr ci)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++) {\n next:\n        ci->iter[i].curValue++;\n        if (ci->iter[i].curValue <= ci->iter[i].maxValue) {\n            if (!virNWFilterVarCombIterEntryAreUniqueEntries(\n                                              &ci->iter[i], ci->hashTable))\n                goto next;\n            break;\n        } else {\n            ci->iter[i].curValue = ci->iter[i].minValue;\n        }\n    }\n\n    if (ci->nIter == i)\n        return NULL;\n\n    return ci;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarCombIterEntryAreUniqueEntries",
          "args": [
            "&ci->iter[i]",
            "ci->hashTable"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarCombIterEntryAreUniqueEntries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "410-453",
          "snippet": "static bool\nvirNWFilterVarCombIterEntryAreUniqueEntries(virNWFilterVarCombIterEntryPtr cie,\n                                            virHashTablePtr hash)\n{\n    size_t i, j;\n    virNWFilterVarValuePtr varValue, tmp;\n    const char *value;\n\n    varValue = virHashLookup(hash, cie->varNames[0]);\n    if (!varValue) {\n        /* caller's error */\n        VIR_ERROR(_(\"hash lookup resulted in NULL pointer\"));\n        return true;\n    }\n\n    value = virNWFilterVarValueGetNthValue(varValue, cie->curValue);\n    if (!value) {\n        VIR_ERROR(_(\"Lookup of value at index %u resulted in a NULL \"\n                  \"pointer\"), cie->curValue);\n        return true;\n    }\n\n    for (i = 0; i < cie->curValue; i++) {\n        if (STREQ(value, virNWFilterVarValueGetNthValue(varValue, i))) {\n            bool isSame = true;\n            for (j = 1; j < cie->nVarNames; j++) {\n                tmp = virHashLookup(hash, cie->varNames[j]);\n                if (!tmp) {\n                    /* should never occur to step on a NULL here */\n                    return true;\n                }\n                if (STRNEQ(virNWFilterVarValueGetNthValue(tmp, cie->curValue),\n                           virNWFilterVarValueGetNthValue(tmp, i))) {\n                    isSame = false;\n                    break;\n                }\n            }\n            if (isSame)\n                return false;\n        }\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nstatic bool\nvirNWFilterVarCombIterEntryAreUniqueEntries(virNWFilterVarCombIterEntryPtr cie,\n                                            virHashTablePtr hash)\n{\n    size_t i, j;\n    virNWFilterVarValuePtr varValue, tmp;\n    const char *value;\n\n    varValue = virHashLookup(hash, cie->varNames[0]);\n    if (!varValue) {\n        /* caller's error */\n        VIR_ERROR(_(\"hash lookup resulted in NULL pointer\"));\n        return true;\n    }\n\n    value = virNWFilterVarValueGetNthValue(varValue, cie->curValue);\n    if (!value) {\n        VIR_ERROR(_(\"Lookup of value at index %u resulted in a NULL \"\n                  \"pointer\"), cie->curValue);\n        return true;\n    }\n\n    for (i = 0; i < cie->curValue; i++) {\n        if (STREQ(value, virNWFilterVarValueGetNthValue(varValue, i))) {\n            bool isSame = true;\n            for (j = 1; j < cie->nVarNames; j++) {\n                tmp = virHashLookup(hash, cie->varNames[j]);\n                if (!tmp) {\n                    /* should never occur to step on a NULL here */\n                    return true;\n                }\n                if (STRNEQ(virNWFilterVarValueGetNthValue(tmp, cie->curValue),\n                           virNWFilterVarValueGetNthValue(tmp, i))) {\n                    isSame = false;\n                    break;\n                }\n            }\n            if (isSame)\n                return false;\n        }\n    }\n\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirNWFilterVarCombIterPtr\nvirNWFilterVarCombIterNext(virNWFilterVarCombIterPtr ci)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++) {\n next:\n        ci->iter[i].curValue++;\n        if (ci->iter[i].curValue <= ci->iter[i].maxValue) {\n            if (!virNWFilterVarCombIterEntryAreUniqueEntries(\n                                              &ci->iter[i], ci->hashTable))\n                goto next;\n            break;\n        } else {\n            ci->iter[i].curValue = ci->iter[i].minValue;\n        }\n    }\n\n    if (ci->nIter == i)\n        return NULL;\n\n    return ci;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "469-524",
    "snippet": "virNWFilterVarCombIterPtr\nvirNWFilterVarCombIterCreate(virHashTablePtr hash,\n                             virNWFilterVarAccessPtr *varAccess,\n                             size_t nVarAccess)\n{\n    virNWFilterVarCombIterPtr res;\n    size_t i;\n    unsigned int iterId;\n    int iterIndex = -1;\n    unsigned int nextIntIterId = VIR_NWFILTER_MAX_ITERID + 1;\n\n    if (VIR_ALLOC_VAR(res, virNWFilterVarCombIterEntry, 1 + nVarAccess) < 0)\n        return NULL;\n\n    res->hashTable = hash;\n\n    /* create the default iterator to support @0 */\n    iterId = 0;\n\n    res->nIter = 1;\n    virNWFilterVarCombIterEntryInit(&res->iter[0], iterId);\n\n    for (i = 0; i < nVarAccess; i++) {\n        switch (virNWFilterVarAccessGetType(varAccess[i])) {\n        case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n            iterId = virNWFilterVarAccessGetIterId(varAccess[i]);\n            iterIndex = virNWFilterVarCombIterGetIndexByIterId(res, iterId);\n            if (iterIndex < 0) {\n                iterIndex = res->nIter;\n                virNWFilterVarCombIterEntryInit(&res->iter[iterIndex], iterId);\n                res->nIter++;\n            }\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n            iterIndex = res->nIter;\n            virNWFilterVarAccessSetIntIterId(varAccess[i], nextIntIterId);\n            virNWFilterVarCombIterEntryInit(&res->iter[iterIndex],\n                                            nextIntIterId);\n            nextIntIterId++;\n            res->nIter++;\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_LAST:\n            goto err_exit;\n        }\n\n        if (virNWFilterVarCombIterAddVariable(&res->iter[iterIndex],\n                                              hash, varAccess[i]) < 0)\n            goto err_exit;\n    }\n\n    return res;\n\n err_exit:\n    virNWFilterVarCombIterFree(res);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarCombIterFree",
          "args": [
            "res"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarCombIterFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "308-320",
          "snippet": "void\nvirNWFilterVarCombIterFree(virNWFilterVarCombIterPtr ci)\n{\n    size_t i;\n\n    if (!ci)\n        return;\n\n    for (i = 0; i < ci->nIter; i++)\n        VIR_FREE(ci->iter[i].varNames);\n\n    VIR_FREE(ci);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNWFilterVarCombIterFree(virNWFilterVarCombIterPtr ci)\n{\n    size_t i;\n\n    if (!ci)\n        return;\n\n    for (i = 0; i < ci->nIter; i++)\n        VIR_FREE(ci->iter[i].varNames);\n\n    VIR_FREE(ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarCombIterAddVariable",
          "args": [
            "&res->iter[iterIndex]",
            "hash",
            "varAccess[i]"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarCombIterAddVariable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "343-393",
          "snippet": "static int\nvirNWFilterVarCombIterAddVariable(virNWFilterVarCombIterEntryPtr cie,\n                                  virHashTablePtr hash,\n                                  const virNWFilterVarAccess *varAccess)\n{\n    virNWFilterVarValuePtr varValue;\n    unsigned int maxValue = 0, minValue = 0;\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n\n    varValue = virHashLookup(hash, varName);\n    if (varValue == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find value for variable '%s'\"),\n                       varName);\n        return -1;\n    }\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        maxValue = virNWFilterVarAccessGetIndex(varAccess);\n        minValue = maxValue;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        maxValue = virNWFilterVarValueGetCardinality(varValue) - 1;\n        minValue = 0;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return -1;\n    }\n\n    if (cie->nVarNames == 0) {\n        cie->maxValue = maxValue;\n        cie->minValue = minValue;\n        cie->curValue = minValue;\n    } else {\n        if (cie->maxValue != maxValue) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cardinality of list items must be \"\n                             \"the same for processing them in \"\n                             \"parallel\"));\n            return -1;\n        }\n    }\n\n    if (VIR_EXPAND_N(cie->varNames, cie->nVarNames, 1) < 0)\n        return -1;\n\n    cie->varNames[cie->nVarNames - 1] = varName;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);",
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nstatic int\nvirNWFilterVarCombIterAddVariable(virNWFilterVarCombIterEntryPtr cie,\n                                  virHashTablePtr hash,\n                                  const virNWFilterVarAccess *varAccess)\n{\n    virNWFilterVarValuePtr varValue;\n    unsigned int maxValue = 0, minValue = 0;\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n\n    varValue = virHashLookup(hash, varName);\n    if (varValue == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find value for variable '%s'\"),\n                       varName);\n        return -1;\n    }\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        maxValue = virNWFilterVarAccessGetIndex(varAccess);\n        minValue = maxValue;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        maxValue = virNWFilterVarValueGetCardinality(varValue) - 1;\n        minValue = 0;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return -1;\n    }\n\n    if (cie->nVarNames == 0) {\n        cie->maxValue = maxValue;\n        cie->minValue = minValue;\n        cie->curValue = minValue;\n    } else {\n        if (cie->maxValue != maxValue) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cardinality of list items must be \"\n                             \"the same for processing them in \"\n                             \"parallel\"));\n            return -1;\n        }\n    }\n\n    if (VIR_EXPAND_N(cie->varNames, cie->nVarNames, 1) < 0)\n        return -1;\n\n    cie->varNames[cie->nVarNames - 1] = varName;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarCombIterEntryInit",
          "args": [
            "&res->iter[iterIndex]",
            "nextIntIterId"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarCombIterEntryInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "335-341",
          "snippet": "static void\nvirNWFilterVarCombIterEntryInit(virNWFilterVarCombIterEntryPtr cie,\n                                unsigned int iterId)\n{\n    memset(cie, 0, sizeof(*cie));\n    cie->iterId = iterId;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirNWFilterVarCombIterEntryInit(virNWFilterVarCombIterEntryPtr cie,\n                                unsigned int iterId)\n{\n    memset(cie, 0, sizeof(*cie));\n    cie->iterId = iterId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessSetIntIterId",
          "args": [
            "varAccess[i]",
            "nextIntIterId"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessSetIntIterId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "1000-1005",
          "snippet": "static void\nvirNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr vap,\n                                 unsigned int intIterId)\n{\n    vap->u.index.intIterId = intIterId;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nstatic void\nvirNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr vap,\n                                 unsigned int intIterId)\n{\n    vap->u.index.intIterId = intIterId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarCombIterGetIndexByIterId",
          "args": [
            "res",
            "iterId"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarCombIterGetIndexByIterId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "322-333",
          "snippet": "static int\nvirNWFilterVarCombIterGetIndexByIterId(virNWFilterVarCombIterPtr ci,\n                                       unsigned int iterId)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++)\n        if (ci->iter[i].iterId == iterId)\n            return i;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarCombIterGetIndexByIterId(virNWFilterVarCombIterPtr ci,\n                                       unsigned int iterId)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++)\n        if (ci->iter[i].iterId == iterId)\n            return i;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetIterId",
          "args": [
            "varAccess[i]"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetIterId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "988-992",
          "snippet": "unsigned int\nvirNWFilterVarAccessGetIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.iterId;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nunsigned int\nvirNWFilterVarAccessGetIterId(const virNWFilterVarAccess *vap)\n{\n    return vap->u.iterId;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetType",
          "args": [
            "varAccess[i]"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "982-986",
          "snippet": "virNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nvirNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_VAR",
          "args": [
            "res",
            "virNWFilterVarCombIterEntry",
            "1 + nVarAccess"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterVarAccessSetIntIterId(virNWFilterVarAccessPtr,\n                                             unsigned int);\n\nvirNWFilterVarCombIterPtr\nvirNWFilterVarCombIterCreate(virHashTablePtr hash,\n                             virNWFilterVarAccessPtr *varAccess,\n                             size_t nVarAccess)\n{\n    virNWFilterVarCombIterPtr res;\n    size_t i;\n    unsigned int iterId;\n    int iterIndex = -1;\n    unsigned int nextIntIterId = VIR_NWFILTER_MAX_ITERID + 1;\n\n    if (VIR_ALLOC_VAR(res, virNWFilterVarCombIterEntry, 1 + nVarAccess) < 0)\n        return NULL;\n\n    res->hashTable = hash;\n\n    /* create the default iterator to support @0 */\n    iterId = 0;\n\n    res->nIter = 1;\n    virNWFilterVarCombIterEntryInit(&res->iter[0], iterId);\n\n    for (i = 0; i < nVarAccess; i++) {\n        switch (virNWFilterVarAccessGetType(varAccess[i])) {\n        case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n            iterId = virNWFilterVarAccessGetIterId(varAccess[i]);\n            iterIndex = virNWFilterVarCombIterGetIndexByIterId(res, iterId);\n            if (iterIndex < 0) {\n                iterIndex = res->nIter;\n                virNWFilterVarCombIterEntryInit(&res->iter[iterIndex], iterId);\n                res->nIter++;\n            }\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n            iterIndex = res->nIter;\n            virNWFilterVarAccessSetIntIterId(varAccess[i], nextIntIterId);\n            virNWFilterVarCombIterEntryInit(&res->iter[iterIndex],\n                                            nextIntIterId);\n            nextIntIterId++;\n            res->nIter++;\n            break;\n        case VIR_NWFILTER_VAR_ACCESS_LAST:\n            goto err_exit;\n        }\n\n        if (virNWFilterVarCombIterAddVariable(&res->iter[iterIndex],\n                                              hash, varAccess[i]) < 0)\n            goto err_exit;\n    }\n\n    return res;\n\n err_exit:\n    virNWFilterVarCombIterFree(res);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterEntryAreUniqueEntries",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "410-453",
    "snippet": "static bool\nvirNWFilterVarCombIterEntryAreUniqueEntries(virNWFilterVarCombIterEntryPtr cie,\n                                            virHashTablePtr hash)\n{\n    size_t i, j;\n    virNWFilterVarValuePtr varValue, tmp;\n    const char *value;\n\n    varValue = virHashLookup(hash, cie->varNames[0]);\n    if (!varValue) {\n        /* caller's error */\n        VIR_ERROR(_(\"hash lookup resulted in NULL pointer\"));\n        return true;\n    }\n\n    value = virNWFilterVarValueGetNthValue(varValue, cie->curValue);\n    if (!value) {\n        VIR_ERROR(_(\"Lookup of value at index %u resulted in a NULL \"\n                  \"pointer\"), cie->curValue);\n        return true;\n    }\n\n    for (i = 0; i < cie->curValue; i++) {\n        if (STREQ(value, virNWFilterVarValueGetNthValue(varValue, i))) {\n            bool isSame = true;\n            for (j = 1; j < cie->nVarNames; j++) {\n                tmp = virHashLookup(hash, cie->varNames[j]);\n                if (!tmp) {\n                    /* should never occur to step on a NULL here */\n                    return true;\n                }\n                if (STRNEQ(virNWFilterVarValueGetNthValue(tmp, cie->curValue),\n                           virNWFilterVarValueGetNthValue(tmp, i))) {\n                    isSame = false;\n                    break;\n                }\n            }\n            if (isSame)\n                return false;\n        }\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "virNWFilterVarValueGetNthValue(tmp, cie->curValue)",
            "virNWFilterVarValueGetNthValue(tmp, i)"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetNthValue",
          "args": [
            "tmp",
            "i"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "142-164",
          "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "hash",
            "cie->varNames[j]"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "virNWFilterVarValueGetNthValue(varValue, i)"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Lookup of value at index %u resulted in a NULL \"\n                  \"pointer\")",
            "cie->curValue"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Lookup of value at index %u resulted in a NULL \"\n                  \"pointer\""
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"hash lookup resulted in NULL pointer\")"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nstatic bool\nvirNWFilterVarCombIterEntryAreUniqueEntries(virNWFilterVarCombIterEntryPtr cie,\n                                            virHashTablePtr hash)\n{\n    size_t i, j;\n    virNWFilterVarValuePtr varValue, tmp;\n    const char *value;\n\n    varValue = virHashLookup(hash, cie->varNames[0]);\n    if (!varValue) {\n        /* caller's error */\n        VIR_ERROR(_(\"hash lookup resulted in NULL pointer\"));\n        return true;\n    }\n\n    value = virNWFilterVarValueGetNthValue(varValue, cie->curValue);\n    if (!value) {\n        VIR_ERROR(_(\"Lookup of value at index %u resulted in a NULL \"\n                  \"pointer\"), cie->curValue);\n        return true;\n    }\n\n    for (i = 0; i < cie->curValue; i++) {\n        if (STREQ(value, virNWFilterVarValueGetNthValue(varValue, i))) {\n            bool isSame = true;\n            for (j = 1; j < cie->nVarNames; j++) {\n                tmp = virHashLookup(hash, cie->varNames[j]);\n                if (!tmp) {\n                    /* should never occur to step on a NULL here */\n                    return true;\n                }\n                if (STRNEQ(virNWFilterVarValueGetNthValue(tmp, cie->curValue),\n                           virNWFilterVarValueGetNthValue(tmp, i))) {\n                    isSame = false;\n                    break;\n                }\n            }\n            if (isSame)\n                return false;\n        }\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterAddVariable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "343-393",
    "snippet": "static int\nvirNWFilterVarCombIterAddVariable(virNWFilterVarCombIterEntryPtr cie,\n                                  virHashTablePtr hash,\n                                  const virNWFilterVarAccess *varAccess)\n{\n    virNWFilterVarValuePtr varValue;\n    unsigned int maxValue = 0, minValue = 0;\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n\n    varValue = virHashLookup(hash, varName);\n    if (varValue == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find value for variable '%s'\"),\n                       varName);\n        return -1;\n    }\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        maxValue = virNWFilterVarAccessGetIndex(varAccess);\n        minValue = maxValue;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        maxValue = virNWFilterVarValueGetCardinality(varValue) - 1;\n        minValue = 0;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return -1;\n    }\n\n    if (cie->nVarNames == 0) {\n        cie->maxValue = maxValue;\n        cie->minValue = minValue;\n        cie->curValue = minValue;\n    } else {\n        if (cie->maxValue != maxValue) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cardinality of list items must be \"\n                             \"the same for processing them in \"\n                             \"parallel\"));\n            return -1;\n        }\n    }\n\n    if (VIR_EXPAND_N(cie->varNames, cie->nVarNames, 1) < 0)\n        return -1;\n\n    cie->varNames[cie->nVarNames - 1] = varName;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);",
      "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "cie->varNames",
            "cie->nVarNames",
            "1"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cardinality of list items must be \"\n                             \"the same for processing them in \"\n                             \"parallel\")"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cardinality of list items must be \"\n                             \"the same for processing them in \"\n                             \"parallel\""
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetCardinality",
          "args": [
            "varValue"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetCardinality",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "166-180",
          "snippet": "unsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nunsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetIndex",
          "args": [
            "varAccess"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "994-998",
          "snippet": "unsigned int\nvirNWFilterVarAccessGetIndex(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.idx;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nunsigned int\nvirNWFilterVarAccessGetIndex(const virNWFilterVarAccess *vap)\n{\n    return vap->u.index.idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetType",
          "args": [
            "varAccess"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "982-986",
          "snippet": "virNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nvirNWFilterVarAccessType\nvirNWFilterVarAccessGetType(const virNWFilterVarAccess *vap)\n{\n    return vap->accessType;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find value for variable '%s'\")",
            "varName"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "hash",
            "varName"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarAccessGetVarName",
          "args": [
            "varAccess"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarAccessGetVarName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "976-980",
          "snippet": "const char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nconst char *\nvirNWFilterVarAccessGetVarName(const virNWFilterVarAccess *vap)\n{\n    return vap->varName;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\nstatic unsigned int virNWFilterVarAccessGetIntIterId(const virNWFilterVarAccess *);\n\nstatic int\nvirNWFilterVarCombIterAddVariable(virNWFilterVarCombIterEntryPtr cie,\n                                  virHashTablePtr hash,\n                                  const virNWFilterVarAccess *varAccess)\n{\n    virNWFilterVarValuePtr varValue;\n    unsigned int maxValue = 0, minValue = 0;\n    const char *varName = virNWFilterVarAccessGetVarName(varAccess);\n\n    varValue = virHashLookup(hash, varName);\n    if (varValue == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not find value for variable '%s'\"),\n                       varName);\n        return -1;\n    }\n\n    switch (virNWFilterVarAccessGetType(varAccess)) {\n    case VIR_NWFILTER_VAR_ACCESS_ELEMENT:\n        maxValue = virNWFilterVarAccessGetIndex(varAccess);\n        minValue = maxValue;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_ITERATOR:\n        maxValue = virNWFilterVarValueGetCardinality(varValue) - 1;\n        minValue = 0;\n        break;\n    case VIR_NWFILTER_VAR_ACCESS_LAST:\n        return -1;\n    }\n\n    if (cie->nVarNames == 0) {\n        cie->maxValue = maxValue;\n        cie->minValue = minValue;\n        cie->curValue = minValue;\n    } else {\n        if (cie->maxValue != maxValue) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cardinality of list items must be \"\n                             \"the same for processing them in \"\n                             \"parallel\"));\n            return -1;\n        }\n    }\n\n    if (VIR_EXPAND_N(cie->varNames, cie->nVarNames, 1) < 0)\n        return -1;\n\n    cie->varNames[cie->nVarNames - 1] = varName;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterEntryInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "335-341",
    "snippet": "static void\nvirNWFilterVarCombIterEntryInit(virNWFilterVarCombIterEntryPtr cie,\n                                unsigned int iterId)\n{\n    memset(cie, 0, sizeof(*cie));\n    cie->iterId = iterId;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cie",
            "0",
            "sizeof(*cie)"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirNWFilterVarCombIterEntryInit(virNWFilterVarCombIterEntryPtr cie,\n                                unsigned int iterId)\n{\n    memset(cie, 0, sizeof(*cie));\n    cie->iterId = iterId;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterGetIndexByIterId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "322-333",
    "snippet": "static int\nvirNWFilterVarCombIterGetIndexByIterId(virNWFilterVarCombIterPtr ci,\n                                       unsigned int iterId)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++)\n        if (ci->iter[i].iterId == iterId)\n            return i;\n\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarCombIterGetIndexByIterId(virNWFilterVarCombIterPtr ci,\n                                       unsigned int iterId)\n{\n    size_t i;\n\n    for (i = 0; i < ci->nIter; i++)\n        if (ci->iter[i].iterId == iterId)\n            return i;\n\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterVarCombIterFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "308-320",
    "snippet": "void\nvirNWFilterVarCombIterFree(virNWFilterVarCombIterPtr ci)\n{\n    size_t i;\n\n    if (!ci)\n        return;\n\n    for (i = 0; i < ci->nIter; i++)\n        VIR_FREE(ci->iter[i].varNames);\n\n    VIR_FREE(ci);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ci"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ci->iter[i].varNames"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNWFilterVarCombIterFree(virNWFilterVarCombIterPtr ci)\n{\n    size_t i;\n\n    if (!ci)\n        return;\n\n    for (i = 0; i < ci->nIter; i++)\n        VIR_FREE(ci->iter[i].varNames);\n\n    VIR_FREE(ci);\n}"
  },
  {
    "function_name": "virNWFilterVarValueDelValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "286-306",
    "snippet": "int\nvirNWFilterVarValueDelValue(virNWFilterVarValuePtr val, const char *value)\n{\n    size_t i;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return -1;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            if (STREQ(value, val->u.array.values[i]))\n                return virNWFilterVarValueDelNthValue(val, i);\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueDelNthValue",
          "args": [
            "val",
            "i"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueDelNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "264-284",
          "snippet": "static int\nvirNWFilterVarValueDelNthValue(virNWFilterVarValuePtr val, unsigned int pos)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return -1;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (pos < val->u.array.nValues) {\n            VIR_FREE(val->u.array.values[pos]);\n            VIR_DELETE_ELEMENT(val->u.array.values, pos, val->u.array.nValues);\n            return 0;\n        }\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarValueDelNthValue(virNWFilterVarValuePtr val, unsigned int pos)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return -1;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (pos < val->u.array.nValues) {\n            VIR_FREE(val->u.array.values[pos]);\n            VIR_DELETE_ELEMENT(val->u.array.values, pos, val->u.array.nValues);\n            return 0;\n        }\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "val->u.array.values[i]"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nint\nvirNWFilterVarValueDelValue(virNWFilterVarValuePtr val, const char *value)\n{\n    size_t i;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return -1;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            if (STREQ(value, val->u.array.values[i]))\n                return virNWFilterVarValueDelNthValue(val, i);\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterVarValueDelNthValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "264-284",
    "snippet": "static int\nvirNWFilterVarValueDelNthValue(virNWFilterVarValuePtr val, unsigned int pos)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return -1;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (pos < val->u.array.nValues) {\n            VIR_FREE(val->u.array.values[pos]);\n            VIR_DELETE_ELEMENT(val->u.array.values, pos, val->u.array.nValues);\n            return 0;\n        }\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "val->u.array.values",
            "pos",
            "val->u.array.nValues"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val->u.array.values[pos]"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterVarValueDelNthValue(virNWFilterVarValuePtr val, unsigned int pos)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return -1;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (pos < val->u.array.nValues) {\n            VIR_FREE(val->u.array.values[pos]);\n            VIR_DELETE_ELEMENT(val->u.array.values, pos, val->u.array.nValues);\n            return 0;\n        }\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virNWFilterVarValueAddValueCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "251-261",
    "snippet": "int\nvirNWFilterVarValueAddValueCopy(virNWFilterVarValuePtr val, const char *value)\n{\n    char *valdup;\n    valdup = g_strdup(value);\n    if (virNWFilterVarValueAddValue(val, valdup) < 0) {\n        VIR_FREE(valdup);\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "valdup"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueAddValue",
          "args": [
            "val",
            "valdup"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueAddValueCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "251-261",
          "snippet": "int\nvirNWFilterVarValueAddValueCopy(virNWFilterVarValuePtr val, const char *value)\n{\n    char *valdup;\n    valdup = g_strdup(value);\n    if (virNWFilterVarValueAddValue(val, valdup) < 0) {\n        VIR_FREE(valdup);\n        return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nint\nvirNWFilterVarValueAddValueCopy(virNWFilterVarValuePtr val, const char *value)\n{\n    char *valdup;\n    valdup = g_strdup(value);\n    if (virNWFilterVarValueAddValue(val, valdup) < 0) {\n        VIR_FREE(valdup);\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterVarValueAddValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "214-248",
    "snippet": "int\nvirNWFilterVarValueAddValue(virNWFilterVarValuePtr val, char *value)\n{\n    char *tmp;\n    int rc = -1;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        /* switch to array */\n        tmp = val->u.simple.value;\n        if (VIR_ALLOC_N(val->u.array.values, 2) < 0) {\n            val->u.simple.value = tmp;\n            return -1;\n        }\n        val->valType = NWFILTER_VALUE_TYPE_ARRAY;\n        val->u.array.nValues = 2;\n        val->u.array.values[0] = tmp;\n        val->u.array.values[1] = value;\n        rc  = 0;\n        break;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (VIR_EXPAND_N(val->u.array.values,\n                         val->u.array.nValues, 1) < 0)\n            return -1;\n        val->u.array.values[val->u.array.nValues - 1] = value;\n        rc = 0;\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "val->u.array.values",
            "val->u.array.nValues",
            "1"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "val->u.array.values",
            "2"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nint\nvirNWFilterVarValueAddValue(virNWFilterVarValuePtr val, char *value)\n{\n    char *tmp;\n    int rc = -1;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        /* switch to array */\n        tmp = val->u.simple.value;\n        if (VIR_ALLOC_N(val->u.array.values, 2) < 0) {\n            val->u.simple.value = tmp;\n            return -1;\n        }\n        val->valType = NWFILTER_VALUE_TYPE_ARRAY;\n        val->u.array.nValues = 2;\n        val->u.array.values[0] = tmp;\n        val->u.array.values[1] = value;\n        rc  = 0;\n        break;\n\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (VIR_EXPAND_N(val->u.array.values,\n                         val->u.array.nValues, 1) < 0)\n            return -1;\n        val->u.array.values[val->u.array.nValues - 1] = value;\n        rc = 0;\n        break;\n\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virNWFilterVarValueEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "182-212",
    "snippet": "bool\nvirNWFilterVarValueEqual(const virNWFilterVarValue *a,\n                         const virNWFilterVarValue *b)\n{\n    unsigned int card;\n    size_t i, j;\n    const char *s;\n\n    if (!a || !b)\n        return false;\n\n    card = virNWFilterVarValueGetCardinality(a);\n    if (card != virNWFilterVarValueGetCardinality(b))\n        return false;\n\n    /* brute force O(n^2) comparison */\n    for (i = 0; i < card; i++) {\n        bool eq = false;\n\n        s = virNWFilterVarValueGetNthValue(a, i);\n        for (j = 0; j < card; j++) {\n            if (STREQ_NULLABLE(s, virNWFilterVarValueGetNthValue(b, j))) {\n                 eq = true;\n                 break;\n            }\n        }\n        if (!eq)\n            return false;\n    }\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "s",
            "virNWFilterVarValueGetNthValue(b, j)"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetNthValue",
          "args": [
            "b",
            "j"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetNthValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "142-164",
          "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueGetCardinality",
          "args": [
            "b"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueGetCardinality",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "166-180",
          "snippet": "unsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nunsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirNWFilterVarValueEqual(const virNWFilterVarValue *a,\n                         const virNWFilterVarValue *b)\n{\n    unsigned int card;\n    size_t i, j;\n    const char *s;\n\n    if (!a || !b)\n        return false;\n\n    card = virNWFilterVarValueGetCardinality(a);\n    if (card != virNWFilterVarValueGetCardinality(b))\n        return false;\n\n    /* brute force O(n^2) comparison */\n    for (i = 0; i < card; i++) {\n        bool eq = false;\n\n        s = virNWFilterVarValueGetNthValue(a, i);\n        for (j = 0; j < card; j++) {\n            if (STREQ_NULLABLE(s, virNWFilterVarValueGetNthValue(b, j))) {\n                 eq = true;\n                 break;\n            }\n        }\n        if (!eq)\n            return false;\n    }\n    return true;\n}"
  },
  {
    "function_name": "virNWFilterVarValueGetCardinality",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "166-180",
    "snippet": "unsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nunsigned int\nvirNWFilterVarValueGetCardinality(const virNWFilterVarValue *val)\n{\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        return 1;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        return val->u.array.nValues;\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        return 0;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virNWFilterVarValueGetNthValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "142-164",
    "snippet": "const char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetNthValue(const virNWFilterVarValue* val, unsigned int idx)\n{\n    const char *res = NULL;\n\n    if (!val)\n        return NULL;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        if (idx == 0)\n            res = val->u.simple.value;\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (idx < val->u.array.nValues)\n            res = val->u.array.values[idx];\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n}"
  },
  {
    "function_name": "virNWFilterVarValueGetSimple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "134-140",
    "snippet": "const char *\nvirNWFilterVarValueGetSimple(const virNWFilterVarValue *val)\n{\n    if (val->valType == NWFILTER_VALUE_TYPE_SIMPLE)\n        return val->u.simple.value;\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nconst char *\nvirNWFilterVarValueGetSimple(const virNWFilterVarValue *val)\n{\n    if (val->valType == NWFILTER_VALUE_TYPE_SIMPLE)\n        return val->u.simple.value;\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterVarValueCreateSimpleCopyValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "121-132",
    "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterVarValueCreateSimple",
          "args": [
            "val"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueCreateSimpleCopyValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "121-132",
          "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimpleCopyValue(const char *value)\n{\n    char *val;\n    virNWFilterVarValuePtr ret;\n\n    val = g_strdup(value);\n    ret = virNWFilterVarValueCreateSimple(val);\n    if (!ret)\n        VIR_FREE(val);\n    return ret;\n}"
  },
  {
    "function_name": "virNWFilterVarValueCreateSimple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "101-119",
    "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimple(char *value)\n{\n    virNWFilterVarValuePtr val;\n\n    if (!isValidVarValue(value)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Variable value contains invalid character\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->valType = NWFILTER_VALUE_TYPE_SIMPLE;\n    val->u.simple.value = value;\n\n    return val;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "val"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Variable value contains invalid character\")"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Variable value contains invalid character\""
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isValidVarValue",
          "args": [
            "value"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "isValidVarValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "705-709",
          "snippet": "static bool\nisValidVarValue(const char *value)\n{\n    return (value[strspn(value, VALID_VARVALUE)] == 0) && (strlen(value) != 0);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nstatic bool\nisValidVarValue(const char *value)\n{\n    return (value[strspn(value, VALID_VARVALUE)] == 0) && (strlen(value) != 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCreateSimple(char *value)\n{\n    virNWFilterVarValuePtr val;\n\n    if (!isValidVarValue(value)) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Variable value contains invalid character\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(val) < 0)\n        return NULL;\n\n    val->valType = NWFILTER_VALUE_TYPE_SIMPLE;\n    val->u.simple.value = value;\n\n    return val;\n}"
  },
  {
    "function_name": "virNWFilterVarValueCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "66-99",
    "snippet": "virNWFilterVarValuePtr\nvirNWFilterVarValueCopy(const virNWFilterVarValue *val)\n{\n    virNWFilterVarValuePtr res;\n    size_t i;\n    char *str;\n\n    if (VIR_ALLOC(res) < 0)\n        return NULL;\n    res->valType = val->valType;\n\n    switch (res->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        res->u.simple.value = g_strdup(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (VIR_ALLOC_N(res->u.array.values, val->u.array.nValues) < 0)\n            goto err_exit;\n        res->u.array.nValues = val->u.array.nValues;\n        for (i = 0; i < val->u.array.nValues; i++) {\n            str = g_strdup(val->u.array.values[i]);\n            res->u.array.values[i] = str;\n        }\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n\n err_exit:\n    virNWFilterVarValueFree(res);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterVarValueFree",
          "args": [
            "res"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterVarValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
          "lines": "43-64",
          "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool isValidVarValue(const char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "val->u.array.values[i]"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "res->u.array.values",
            "val->u.array.nValues"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "res"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvirNWFilterVarValuePtr\nvirNWFilterVarValueCopy(const virNWFilterVarValue *val)\n{\n    virNWFilterVarValuePtr res;\n    size_t i;\n    char *str;\n\n    if (VIR_ALLOC(res) < 0)\n        return NULL;\n    res->valType = val->valType;\n\n    switch (res->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        res->u.simple.value = g_strdup(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        if (VIR_ALLOC_N(res->u.array.values, val->u.array.nValues) < 0)\n            goto err_exit;\n        res->u.array.nValues = val->u.array.nValues;\n        for (i = 0; i < val->u.array.nValues; i++) {\n            str = g_strdup(val->u.array.values[i]);\n            res->u.array.values[i] = str;\n        }\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n\n    return res;\n\n err_exit:\n    virNWFilterVarValueFree(res);\n    return NULL;\n}"
  },
  {
    "function_name": "virNWFilterVarValueFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_params.c",
    "lines": "43-64",
    "snippet": "void\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"domain_conf.h\"",
      "#include \"nwfilter_params.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool isValidVarValue(const char *value);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val->u.array.values"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val->u.array.values[i]"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val->u.simple.value"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool isValidVarValue(const char *value);\n\nvoid\nvirNWFilterVarValueFree(virNWFilterVarValuePtr val)\n{\n    size_t i;\n\n    if (!val)\n        return;\n\n    switch (val->valType) {\n    case NWFILTER_VALUE_TYPE_SIMPLE:\n        VIR_FREE(val->u.simple.value);\n        break;\n    case NWFILTER_VALUE_TYPE_ARRAY:\n        for (i = 0; i < val->u.array.nValues; i++)\n            VIR_FREE(val->u.array.values[i]);\n        VIR_FREE(val->u.array.values);\n        break;\n    case NWFILTER_VALUE_TYPE_LAST:\n        break;\n    }\n    VIR_FREE(val);\n}"
  }
]