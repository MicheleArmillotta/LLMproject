[
  {
    "function_name": "virStoragePoolSourceListFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1744-1777",
    "snippet": "char *\nvirStoragePoolSourceListFormat(virStoragePoolSourceListPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *type;\n    size_t i;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return NULL;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        goto cleanup;\n    }\n\n    virBufferAddLit(&buf, \"<sources>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    for (i = 0; i < def->nsources; i++)\n        virStoragePoolSourceFormat(&buf, options, &def->sources[i]);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</sources>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 1775
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1772
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</sources>\\n\""
          ],
          "line": 1770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceFormat",
          "args": [
            "&buf",
            "options",
            "&def->sources[i]"
          ],
          "line": 1767
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1050-1133",
          "snippet": "static int\nvirStoragePoolSourceFormat(virBufferPtr buf,\n                           virStoragePoolOptionsPtr options,\n                           virStoragePoolSourcePtr src)\n{\n    size_t i, j;\n\n    virBufferAddLit(buf, \"<source>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_HOST) && src->nhost) {\n        for (i = 0; i < src->nhost; i++) {\n            virBufferEscapeString(buf, \"<host name='%s'\",\n                                  src->hosts[i].name);\n            if (src->hosts[i].port)\n                virBufferAsprintf(buf, \" port='%d'\", src->hosts[i].port);\n            virBufferAddLit(buf, \"/>\\n\");\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_DEVICE) &&\n        src->ndevice) {\n        for (i = 0; i < src->ndevice; i++) {\n            virBufferEscapeString(buf, \"<device path='%s'\",\n                                  src->devices[i].path);\n            if (src->devices[i].part_separator !=\n                VIR_TRISTATE_SWITCH_ABSENT) {\n                virBufferAsprintf(buf, \" part_separator='%s'\",\n                                  virTristateBoolTypeToString(src->devices[i].part_separator));\n            }\n            if (src->devices[i].nfreeExtent) {\n                virBufferAddLit(buf, \">\\n\");\n                virBufferAdjustIndent(buf, 2);\n                for (j = 0; j < src->devices[i].nfreeExtent; j++) {\n                    virBufferAsprintf(buf, \"<freeExtent start='%llu' end='%llu'/>\\n\",\n                                      src->devices[i].freeExtents[j].start,\n                                      src->devices[i].freeExtents[j].end);\n                }\n                virBufferAdjustIndent(buf, -2);\n                virBufferAddLit(buf, \"</device>\\n\");\n            } else {\n                virBufferAddLit(buf, \"/>\\n\");\n            }\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR)\n        virBufferEscapeString(buf, \"<dir path='%s'/>\\n\", src->dir);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST ||\n         src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST))\n        virStorageAdapterFormat(buf, &src->adapter);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\", src->name);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN)\n        virStorageSourceInitiatorFormatXML(&src->initiator, buf);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(src->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown pool format number %d\"),\n                           src->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (src->auth)\n        virStorageAuthDefFormat(buf, src->auth);\n\n    if (src->protocolVer)\n        virBufferAsprintf(buf, \"<protocol ver='%u'/>\\n\", src->protocolVer);\n\n    virBufferEscapeString(buf, \"<vendor name='%s'/>\\n\", src->vendor);\n    virBufferEscapeString(buf, \"<product name='%s'/>\\n\", src->product);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</source>\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolSourceFormat(virBufferPtr buf,\n                           virStoragePoolOptionsPtr options,\n                           virStoragePoolSourcePtr src)\n{\n    size_t i, j;\n\n    virBufferAddLit(buf, \"<source>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_HOST) && src->nhost) {\n        for (i = 0; i < src->nhost; i++) {\n            virBufferEscapeString(buf, \"<host name='%s'\",\n                                  src->hosts[i].name);\n            if (src->hosts[i].port)\n                virBufferAsprintf(buf, \" port='%d'\", src->hosts[i].port);\n            virBufferAddLit(buf, \"/>\\n\");\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_DEVICE) &&\n        src->ndevice) {\n        for (i = 0; i < src->ndevice; i++) {\n            virBufferEscapeString(buf, \"<device path='%s'\",\n                                  src->devices[i].path);\n            if (src->devices[i].part_separator !=\n                VIR_TRISTATE_SWITCH_ABSENT) {\n                virBufferAsprintf(buf, \" part_separator='%s'\",\n                                  virTristateBoolTypeToString(src->devices[i].part_separator));\n            }\n            if (src->devices[i].nfreeExtent) {\n                virBufferAddLit(buf, \">\\n\");\n                virBufferAdjustIndent(buf, 2);\n                for (j = 0; j < src->devices[i].nfreeExtent; j++) {\n                    virBufferAsprintf(buf, \"<freeExtent start='%llu' end='%llu'/>\\n\",\n                                      src->devices[i].freeExtents[j].start,\n                                      src->devices[i].freeExtents[j].end);\n                }\n                virBufferAdjustIndent(buf, -2);\n                virBufferAddLit(buf, \"</device>\\n\");\n            } else {\n                virBufferAddLit(buf, \"/>\\n\");\n            }\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR)\n        virBufferEscapeString(buf, \"<dir path='%s'/>\\n\", src->dir);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST ||\n         src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST))\n        virStorageAdapterFormat(buf, &src->adapter);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\", src->name);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN)\n        virStorageSourceInitiatorFormatXML(&src->initiator, buf);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(src->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown pool format number %d\"),\n                           src->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (src->auth)\n        virStorageAuthDefFormat(buf, src->auth);\n\n    if (src->protocolVer)\n        virBufferAsprintf(buf, \"<protocol ver='%u'/>\\n\", src->protocolVer);\n\n    virBufferEscapeString(buf, \"<vendor name='%s'/>\\n\", src->vendor);\n    virBufferEscapeString(buf, \"<product name='%s'/>\\n\", src->product);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</source>\\n\");\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<sources>\\n\""
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unexpected pool type\")"
          ],
          "line": 1758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected pool type\""
          ],
          "line": 1759
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeToString",
          "args": [
            "def->type"
          ],
          "line": 1756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsForPoolType",
          "args": [
            "def->type"
          ],
          "line": 1752
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "324-331",
          "snippet": "static virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStoragePoolSourceListFormat(virStoragePoolSourceListPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *type;\n    size_t i;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return NULL;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        goto cleanup;\n    }\n\n    virBufferAddLit(&buf, \"<sources>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    for (i = 0; i < def->nsources; i++)\n        virStoragePoolSourceFormat(&buf, options, &def->sources[i]);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</sources>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolSourceListNewSource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1729-1741",
    "snippet": "virStoragePoolSourcePtr\nvirStoragePoolSourceListNewSource(virStoragePoolSourceListPtr list)\n{\n    virStoragePoolSourcePtr source;\n\n    if (VIR_REALLOC_N(list->sources, list->nsources + 1) < 0)\n        return NULL;\n\n    source = &list->sources[list->nsources++];\n    memset(source, 0, sizeof(*source));\n\n    return source;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "source",
            "0",
            "sizeof(*source)"
          ],
          "line": 1738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "list->sources",
            "list->nsources + 1"
          ],
          "line": 1734
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolSourcePtr\nvirStoragePoolSourceListNewSource(virStoragePoolSourceListPtr list)\n{\n    virStoragePoolSourcePtr source;\n\n    if (VIR_REALLOC_N(list->sources, list->nsources + 1) < 0)\n        return NULL;\n\n    source = &list->sources[list->nsources++];\n    memset(source, 0, sizeof(*source));\n\n    return source;\n}"
  },
  {
    "function_name": "virStoragePoolSaveConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1713-1726",
    "snippet": "int\nvirStoragePoolSaveConfig(const char *configFile,\n                         virStoragePoolDefPtr def)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virStoragePoolDefFormat(def))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate XML\"));\n        return -1;\n    }\n\n    return virStoragePoolSaveXML(configFile, def, xml);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolSaveXML",
          "args": [
            "configFile",
            "def",
            "xml"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSaveXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1673-1684",
          "snippet": "static int\nvirStoragePoolSaveXML(const char *path,\n                      virStoragePoolDefPtr def,\n                      const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n    return virXMLSaveFile(path,\n                          virXMLPickShellSafeComment(def->name, uuidstr),\n                          \"pool-edit\", xml);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolSaveXML(const char *path,\n                      virStoragePoolDefPtr def,\n                      const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n    return virXMLSaveFile(path,\n                          virXMLPickShellSafeComment(def->name, uuidstr),\n                          \"pool-edit\", xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"failed to generate XML\")"
          ],
          "line": 1720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to generate XML\""
          ],
          "line": 1721
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefFormat",
          "args": [
            "def"
          ],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1225-1238",
          "snippet": "char *\nvirStoragePoolDefFormat(virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStoragePoolDefFormat(virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolSaveConfig(const char *configFile,\n                         virStoragePoolDefPtr def)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virStoragePoolDefFormat(def))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate XML\"));\n        return -1;\n    }\n\n    return virStoragePoolSaveXML(configFile, def, xml);\n}"
  },
  {
    "function_name": "virStoragePoolSaveState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1687-1710",
    "snippet": "int\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolSaveXML",
          "args": [
            "stateFile",
            "def",
            "xml"
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSaveXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1673-1684",
          "snippet": "static int\nvirStoragePoolSaveXML(const char *path,\n                      virStoragePoolDefPtr def,\n                      const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n    return virXMLSaveFile(path,\n                          virXMLPickShellSafeComment(def->name, uuidstr),\n                          \"pool-edit\", xml);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolSaveXML(const char *path,\n                      virStoragePoolDefPtr def,\n                      const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n    return virXMLSaveFile(path,\n                          virXMLPickShellSafeComment(def->name, uuidstr),\n                          \"pool-edit\", xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1703
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</poolstate>\\n\""
          ],
          "line": 1701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefFormatBuf",
          "args": [
            "&buf",
            "def"
          ],
          "line": 1697
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1136-1222",
          "snippet": "static int\nvirStoragePoolDefFormatBuf(virBufferPtr buf,\n                           virStoragePoolDefPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    const char *type;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return -1;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<pool type='%s'\", type);\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    virBufferAsprintf(buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->capacity);\n    virBufferAsprintf(buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->allocation);\n    virBufferAsprintf(buf, \"<available unit='bytes'>%llu</available>\\n\",\n                      def->available);\n\n    if (virStoragePoolSourceFormat(buf, options, &def->source) < 0)\n        return -1;\n\n    /* RBD, Sheepdog, Gluster and Iscsi-direct devices are not local block devs nor\n     * files, so they don't have a target */\n    if (def->type != VIR_STORAGE_POOL_RBD &&\n        def->type != VIR_STORAGE_POOL_SHEEPDOG &&\n        def->type != VIR_STORAGE_POOL_GLUSTER &&\n        def->type != VIR_STORAGE_POOL_ISCSI_DIRECT) {\n        virBufferAddLit(buf, \"<target>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->target.path);\n\n        if (def->target.perms.mode != (mode_t) -1 ||\n            def->target.perms.uid != (uid_t) -1 ||\n            def->target.perms.gid != (gid_t) -1 ||\n            def->target.perms.label) {\n            virBufferAddLit(buf, \"<permissions>\\n\");\n            virBufferAdjustIndent(buf, 2);\n            if (def->target.perms.mode != (mode_t) -1)\n                virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                                  def->target.perms.mode);\n            if (def->target.perms.uid != (uid_t) -1)\n                virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                                  (int) def->target.perms.uid);\n            if (def->target.perms.gid != (gid_t) -1)\n                virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                                  (int) def->target.perms.gid);\n            virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                                  def->target.perms.label);\n\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</permissions>\\n\");\n        }\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</target>\\n\");\n    }\n\n    virStoragePoolDefRefreshFormat(buf, def->refresh);\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefFormatBuf(virBufferPtr buf,\n                           virStoragePoolDefPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    const char *type;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return -1;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<pool type='%s'\", type);\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    virBufferAsprintf(buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->capacity);\n    virBufferAsprintf(buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->allocation);\n    virBufferAsprintf(buf, \"<available unit='bytes'>%llu</available>\\n\",\n                      def->available);\n\n    if (virStoragePoolSourceFormat(buf, options, &def->source) < 0)\n        return -1;\n\n    /* RBD, Sheepdog, Gluster and Iscsi-direct devices are not local block devs nor\n     * files, so they don't have a target */\n    if (def->type != VIR_STORAGE_POOL_RBD &&\n        def->type != VIR_STORAGE_POOL_SHEEPDOG &&\n        def->type != VIR_STORAGE_POOL_GLUSTER &&\n        def->type != VIR_STORAGE_POOL_ISCSI_DIRECT) {\n        virBufferAddLit(buf, \"<target>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->target.path);\n\n        if (def->target.perms.mode != (mode_t) -1 ||\n            def->target.perms.uid != (uid_t) -1 ||\n            def->target.perms.gid != (gid_t) -1 ||\n            def->target.perms.label) {\n            virBufferAddLit(buf, \"<permissions>\\n\");\n            virBufferAdjustIndent(buf, 2);\n            if (def->target.perms.mode != (mode_t) -1)\n                virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                                  def->target.perms.mode);\n            if (def->target.perms.uid != (uid_t) -1)\n                virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                                  (int) def->target.perms.uid);\n            if (def->target.perms.gid != (gid_t) -1)\n                virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                                  (int) def->target.perms.gid);\n            virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                                  def->target.perms.label);\n\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</permissions>\\n\");\n        }\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</target>\\n\");\n    }\n\n    virStoragePoolDefRefreshFormat(buf, def->refresh);\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<poolstate>\\n\""
          ],
          "line": 1694
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolSaveState(const char *stateFile,\n                        virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    g_autofree char *xml = NULL;\n\n    virBufferAddLit(&buf, \"<poolstate>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        return -1;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</poolstate>\\n\");\n\n    if (!(xml = virBufferContentAndReset(&buf)))\n        return -1;\n\n    if (virStoragePoolSaveXML(stateFile, def, xml))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolSaveXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1673-1684",
    "snippet": "static int\nvirStoragePoolSaveXML(const char *path,\n                      virStoragePoolDefPtr def,\n                      const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n    return virXMLSaveFile(path,\n                          virXMLPickShellSafeComment(def->name, uuidstr),\n                          \"pool-edit\", xml);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLSaveFile",
          "args": [
            "path",
            "virXMLPickShellSafeComment(def->name, uuidstr)",
            "\"pool-edit\"",
            "xml"
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLSaveFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "941-950",
          "snippet": "int\nvirXMLSaveFile(const char *path,\n               const char *warnName,\n               const char *warnCommand,\n               const char *xml)\n{\n    struct virXMLRewriteFileData data = { warnName, warnCommand, xml };\n\n    return virFileRewrite(path, S_IRUSR | S_IWUSR, virXMLRewriteFile, &data);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLSaveFile(const char *path,\n               const char *warnName,\n               const char *warnCommand,\n               const char *xml)\n{\n    struct virXMLRewriteFileData data = { warnName, warnCommand, xml };\n\n    return virFileRewrite(path, S_IRUSR | S_IWUSR, virXMLRewriteFile, &data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLPickShellSafeComment",
          "args": [
            "def->name",
            "uuidstr"
          ],
          "line": 1682
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPickShellSafeComment",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "863-872",
          "snippet": "const char *virXMLPickShellSafeComment(const char *str1, const char *str2)\n{\n    if (str1 && !strpbrk(str1, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str1, \"--\"))\n        return str1;\n    if (str2 && !strpbrk(str2, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str2, \"--\"))\n        return str2;\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nconst char *virXMLPickShellSafeComment(const char *str1, const char *str2)\n{\n    if (str1 && !strpbrk(str1, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str1, \"--\"))\n        return str1;\n    if (str2 && !strpbrk(str2, \"\\r\\t\\n !\\\"#$&'()*;<>?[\\\\]^`{|}~\") &&\n        !strstr(str2, \"--\"))\n        return str2;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 1680
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolSaveXML(const char *path,\n                      virStoragePoolDefPtr def,\n                      const char *xml)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n    return virXMLSaveFile(path,\n                          virXMLPickShellSafeComment(def->name, uuidstr),\n                          \"pool-edit\", xml);\n}"
  },
  {
    "function_name": "virStorageVolDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1594-1670",
    "snippet": "char *\nvirStorageVolDefFormat(virStoragePoolDefPtr pool,\n                       virStorageVolDefPtr def)\n{\n    virStorageVolOptionsPtr options;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    virBufferAsprintf(&buf, \"<volume type='%s'>\\n\",\n                      virStorageVolTypeToString(def->type));\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<name>%s</name>\\n\", def->name);\n    virBufferEscapeString(&buf, \"<key>%s</key>\\n\", def->key);\n    virBufferAddLit(&buf, \"<source>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (def->source.nextent) {\n        size_t i;\n        const char *thispath = NULL;\n        for (i = 0; i < def->source.nextent; i++) {\n            if (thispath == NULL ||\n                STRNEQ(thispath, def->source.extents[i].path)) {\n                if (thispath != NULL)\n                    virBufferAddLit(&buf, \"</device>\\n\");\n\n                virBufferEscapeString(&buf, \"<device path='%s'>\\n\",\n                                      def->source.extents[i].path);\n            }\n\n            virBufferAdjustIndent(&buf, 2);\n            virBufferAsprintf(&buf, \"<extent start='%llu' end='%llu'/>\\n\",\n                              def->source.extents[i].start,\n                              def->source.extents[i].end);\n            virBufferAdjustIndent(&buf, -2);\n            thispath = def->source.extents[i].path;\n        }\n        if (thispath != NULL)\n            virBufferAddLit(&buf, \"</device>\\n\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</source>\\n\");\n\n    virBufferAsprintf(&buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->target.capacity);\n    virBufferAsprintf(&buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->target.allocation);\n    /* NB: Display only - since virStorageVolInfo is limited to just\n     * 'capacity' and 'allocation' on output. Since we don't read this\n     * in, be sure it was filled in before printing */\n    if (def->target.physical)\n        virBufferAsprintf(&buf, \"<physical unit='bytes'>%llu</physical>\\n\",\n                          def->target.physical);\n\n    if (virStorageVolTargetDefFormat(options, &buf,\n                                     &def->target, \"target\") < 0)\n        goto cleanup;\n\n    if (virStorageSourceHasBacking(&def->target) &&\n        virStorageVolTargetDefFormat(options, &buf,\n                                     def->target.backingStore,\n                                     \"backingStore\") < 0)\n        goto cleanup;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</volume>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1665
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</volume>\\n\""
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 1662
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolTargetDefFormat",
          "args": [
            "options",
            "&buf",
            "def->target.backingStore",
            "\"backingStore\""
          ],
          "line": 1657
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolTargetDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1502-1591",
          "snippet": "static int\nvirStorageVolTargetDefFormat(virStorageVolOptionsPtr options,\n                             virBufferPtr buf,\n                             virStorageSourcePtr def,\n                             const char *type)\n{\n    virBufferAsprintf(buf, \"<%s>\\n\", type);\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->path);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(def->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown volume format number %d\"),\n                           def->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (def->perms &&\n        (def->perms->mode != (mode_t) -1 ||\n         def->perms->uid != (uid_t) -1 ||\n         def->perms->gid != (gid_t) -1 ||\n         def->perms->label)) {\n        virBufferAddLit(buf, \"<permissions>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        if (def->perms->mode != (mode_t) -1)\n            virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                              def->perms->mode);\n        if (def->perms->uid != (uid_t) -1)\n            virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                              (int) def->perms->uid);\n        if (def->perms->gid != (gid_t) -1)\n            virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                              (int) def->perms->gid);\n\n        virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                              def->perms->label);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</permissions>\\n\");\n    }\n\n    if (def->timestamps) {\n        virBufferAddLit(buf, \"<timestamps>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virStorageVolTimestampFormat(buf, \"atime\", &def->timestamps->atime);\n        virStorageVolTimestampFormat(buf, \"mtime\", &def->timestamps->mtime);\n        virStorageVolTimestampFormat(buf, \"ctime\", &def->timestamps->ctime);\n        virStorageVolTimestampFormat(buf, \"btime\", &def->timestamps->btime);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</timestamps>\\n\");\n    }\n\n    if (def->encryption &&\n        virStorageEncryptionFormat(buf, def->encryption) < 0)\n            return -1;\n\n    virBufferEscapeString(buf, \"<compat>%s</compat>\\n\", def->compat);\n\n    if (def->features) {\n        size_t i;\n        bool empty = virBitmapIsAllClear(def->features);\n\n        if (empty) {\n            virBufferAddLit(buf, \"<features/>\\n\");\n        } else {\n            virBufferAddLit(buf, \"<features>\\n\");\n            virBufferAdjustIndent(buf, 2);\n        }\n\n        for (i = 0; i < VIR_STORAGE_FILE_FEATURE_LAST; i++) {\n            if (virBitmapIsBitSet(def->features, i))\n                virBufferAsprintf(buf, \"<%s/>\\n\",\n                                  virStorageFileFeatureTypeToString(i));\n        }\n        if (!empty) {\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</features>\\n\");\n        }\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAsprintf(buf, \"</%s>\\n\", type);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageVolTargetDefFormat(virStorageVolOptionsPtr options,\n                             virBufferPtr buf,\n                             virStorageSourcePtr def,\n                             const char *type)\n{\n    virBufferAsprintf(buf, \"<%s>\\n\", type);\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->path);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(def->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown volume format number %d\"),\n                           def->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (def->perms &&\n        (def->perms->mode != (mode_t) -1 ||\n         def->perms->uid != (uid_t) -1 ||\n         def->perms->gid != (gid_t) -1 ||\n         def->perms->label)) {\n        virBufferAddLit(buf, \"<permissions>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        if (def->perms->mode != (mode_t) -1)\n            virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                              def->perms->mode);\n        if (def->perms->uid != (uid_t) -1)\n            virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                              (int) def->perms->uid);\n        if (def->perms->gid != (gid_t) -1)\n            virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                              (int) def->perms->gid);\n\n        virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                              def->perms->label);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</permissions>\\n\");\n    }\n\n    if (def->timestamps) {\n        virBufferAddLit(buf, \"<timestamps>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virStorageVolTimestampFormat(buf, \"atime\", &def->timestamps->atime);\n        virStorageVolTimestampFormat(buf, \"mtime\", &def->timestamps->mtime);\n        virStorageVolTimestampFormat(buf, \"ctime\", &def->timestamps->ctime);\n        virStorageVolTimestampFormat(buf, \"btime\", &def->timestamps->btime);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</timestamps>\\n\");\n    }\n\n    if (def->encryption &&\n        virStorageEncryptionFormat(buf, def->encryption) < 0)\n            return -1;\n\n    virBufferEscapeString(buf, \"<compat>%s</compat>\\n\", def->compat);\n\n    if (def->features) {\n        size_t i;\n        bool empty = virBitmapIsAllClear(def->features);\n\n        if (empty) {\n            virBufferAddLit(buf, \"<features/>\\n\");\n        } else {\n            virBufferAddLit(buf, \"<features>\\n\");\n            virBufferAdjustIndent(buf, 2);\n        }\n\n        for (i = 0; i < VIR_STORAGE_FILE_FEATURE_LAST; i++) {\n            if (virBitmapIsBitSet(def->features, i))\n                virBufferAsprintf(buf, \"<%s/>\\n\",\n                                  virStorageFileFeatureTypeToString(i));\n        }\n        if (!empty) {\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</features>\\n\");\n        }\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAsprintf(buf, \"</%s>\\n\", type);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceHasBacking",
          "args": [
            "&def->target"
          ],
          "line": 1656
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceHasBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1593-1598",
          "snippet": "bool\nvirStorageSourceHasBacking(const virStorageSource *src)\n{\n    return virStorageSourceIsBacking(src) && src->backingStore &&\n           src->backingStore->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceHasBacking(const virStorageSource *src)\n{\n    return virStorageSourceIsBacking(src) && src->backingStore &&\n           src->backingStore->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"<physical unit='bytes'>%llu</physical>\\n\"",
            "def->target.physical"
          ],
          "line": 1649
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</source>\\n\""
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</device>\\n\""
          ],
          "line": 1635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "&buf",
            "\"<device path='%s'>\\n\"",
            "def->source.extents[i].path"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</device>\\n\""
          ],
          "line": 1621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "thispath",
            "def->source.extents[i].path"
          ],
          "line": 1619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<source>\\n\""
          ],
          "line": 1611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolTypeToString",
          "args": [
            "def->type"
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolOptionsForPoolType",
          "args": [
            "pool->type"
          ],
          "line": 1601
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "359-366",
          "snippet": "static virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStorageVolDefFormat(virStoragePoolDefPtr pool,\n                       virStorageVolDefPtr def)\n{\n    virStorageVolOptionsPtr options;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    virBufferAsprintf(&buf, \"<volume type='%s'>\\n\",\n                      virStorageVolTypeToString(def->type));\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<name>%s</name>\\n\", def->name);\n    virBufferEscapeString(&buf, \"<key>%s</key>\\n\", def->key);\n    virBufferAddLit(&buf, \"<source>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (def->source.nextent) {\n        size_t i;\n        const char *thispath = NULL;\n        for (i = 0; i < def->source.nextent; i++) {\n            if (thispath == NULL ||\n                STRNEQ(thispath, def->source.extents[i].path)) {\n                if (thispath != NULL)\n                    virBufferAddLit(&buf, \"</device>\\n\");\n\n                virBufferEscapeString(&buf, \"<device path='%s'>\\n\",\n                                      def->source.extents[i].path);\n            }\n\n            virBufferAdjustIndent(&buf, 2);\n            virBufferAsprintf(&buf, \"<extent start='%llu' end='%llu'/>\\n\",\n                              def->source.extents[i].start,\n                              def->source.extents[i].end);\n            virBufferAdjustIndent(&buf, -2);\n            thispath = def->source.extents[i].path;\n        }\n        if (thispath != NULL)\n            virBufferAddLit(&buf, \"</device>\\n\");\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</source>\\n\");\n\n    virBufferAsprintf(&buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->target.capacity);\n    virBufferAsprintf(&buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->target.allocation);\n    /* NB: Display only - since virStorageVolInfo is limited to just\n     * 'capacity' and 'allocation' on output. Since we don't read this\n     * in, be sure it was filled in before printing */\n    if (def->target.physical)\n        virBufferAsprintf(&buf, \"<physical unit='bytes'>%llu</physical>\\n\",\n                          def->target.physical);\n\n    if (virStorageVolTargetDefFormat(options, &buf,\n                                     &def->target, \"target\") < 0)\n        goto cleanup;\n\n    if (virStorageSourceHasBacking(&def->target) &&\n        virStorageVolTargetDefFormat(options, &buf,\n                                     def->target.backingStore,\n                                     \"backingStore\") < 0)\n        goto cleanup;\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</volume>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n cleanup:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolTargetDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1502-1591",
    "snippet": "static int\nvirStorageVolTargetDefFormat(virStorageVolOptionsPtr options,\n                             virBufferPtr buf,\n                             virStorageSourcePtr def,\n                             const char *type)\n{\n    virBufferAsprintf(buf, \"<%s>\\n\", type);\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->path);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(def->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown volume format number %d\"),\n                           def->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (def->perms &&\n        (def->perms->mode != (mode_t) -1 ||\n         def->perms->uid != (uid_t) -1 ||\n         def->perms->gid != (gid_t) -1 ||\n         def->perms->label)) {\n        virBufferAddLit(buf, \"<permissions>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        if (def->perms->mode != (mode_t) -1)\n            virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                              def->perms->mode);\n        if (def->perms->uid != (uid_t) -1)\n            virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                              (int) def->perms->uid);\n        if (def->perms->gid != (gid_t) -1)\n            virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                              (int) def->perms->gid);\n\n        virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                              def->perms->label);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</permissions>\\n\");\n    }\n\n    if (def->timestamps) {\n        virBufferAddLit(buf, \"<timestamps>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virStorageVolTimestampFormat(buf, \"atime\", &def->timestamps->atime);\n        virStorageVolTimestampFormat(buf, \"mtime\", &def->timestamps->mtime);\n        virStorageVolTimestampFormat(buf, \"ctime\", &def->timestamps->ctime);\n        virStorageVolTimestampFormat(buf, \"btime\", &def->timestamps->btime);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</timestamps>\\n\");\n    }\n\n    if (def->encryption &&\n        virStorageEncryptionFormat(buf, def->encryption) < 0)\n            return -1;\n\n    virBufferEscapeString(buf, \"<compat>%s</compat>\\n\", def->compat);\n\n    if (def->features) {\n        size_t i;\n        bool empty = virBitmapIsAllClear(def->features);\n\n        if (empty) {\n            virBufferAddLit(buf, \"<features/>\\n\");\n        } else {\n            virBufferAddLit(buf, \"<features>\\n\");\n            virBufferAdjustIndent(buf, 2);\n        }\n\n        for (i = 0; i < VIR_STORAGE_FILE_FEATURE_LAST; i++) {\n            if (virBitmapIsBitSet(def->features, i))\n                virBufferAsprintf(buf, \"<%s/>\\n\",\n                                  virStorageFileFeatureTypeToString(i));\n        }\n        if (!empty) {\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</features>\\n\");\n        }\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAsprintf(buf, \"</%s>\\n\", type);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"</%s>\\n\"",
            "type"
          ],
          "line": 1589
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1588
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</features>\\n\""
          ],
          "line": 1584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageFileFeatureTypeToString",
          "args": [
            "i"
          ],
          "line": 1580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "def->features",
            "i"
          ],
          "line": 1578
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<features>\\n\""
          ],
          "line": 1573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<features/>\\n\""
          ],
          "line": 1571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapIsAllClear",
          "args": [
            "def->features"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsAllClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "962-972",
          "snippet": "bool\nvirBitmapIsAllClear(virBitmapPtr bitmap)\n{\n    size_t i;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        if (bitmap->map[i] != 0)\n            return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsAllClear(virBitmapPtr bitmap)\n{\n    size_t i;\n\n    for (i = 0; i < bitmap->map_len; i++)\n        if (bitmap->map[i] != 0)\n            return false;\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<compat>%s</compat>\\n\"",
            "def->compat"
          ],
          "line": 1564
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionFormat",
          "args": [
            "buf",
            "def->encryption"
          ],
          "line": 1561
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "361-389",
          "snippet": "int\nvirStorageEncryptionFormat(virBufferPtr buf,\n                           virStorageEncryptionPtr enc)\n{\n    const char *format;\n    size_t i;\n\n    if (!(format = virStorageEncryptionFormatTypeToString(enc->format))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"unexpected encryption format\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<encryption format='%s'>\\n\", format);\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < enc->nsecrets; i++) {\n        if (virStorageEncryptionSecretFormat(buf, enc->secrets[i]) < 0)\n            return -1;\n    }\n\n    if (enc->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS &&\n        enc->encinfo.cipher_name)\n        virStorageEncryptionInfoDefFormat(buf, &enc->encinfo);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</encryption>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirStorageEncryptionFormat(virBufferPtr buf,\n                           virStorageEncryptionPtr enc)\n{\n    const char *format;\n    size_t i;\n\n    if (!(format = virStorageEncryptionFormatTypeToString(enc->format))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"unexpected encryption format\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<encryption format='%s'>\\n\", format);\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < enc->nsecrets; i++) {\n        if (virStorageEncryptionSecretFormat(buf, enc->secrets[i]) < 0)\n            return -1;\n    }\n\n    if (enc->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS &&\n        enc->encinfo.cipher_name)\n        virStorageEncryptionInfoDefFormat(buf, &enc->encinfo);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</encryption>\\n\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</timestamps>\\n\""
          ],
          "line": 1557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolTimestampFormat",
          "args": [
            "buf",
            "\"btime\"",
            "&def->timestamps->btime"
          ],
          "line": 1555
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolTimestampFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1488-1499",
          "snippet": "static void\nvirStorageVolTimestampFormat(virBufferPtr buf, const char *name,\n                             struct timespec *ts)\n{\n    if (ts->tv_nsec < 0)\n        return;\n    virBufferAsprintf(buf, \"<%s>%llu\", name,\n                      (unsigned long long) ts->tv_sec);\n    if (ts->tv_nsec)\n       virBufferAsprintf(buf, \".%09ld\", ts->tv_nsec);\n    virBufferAsprintf(buf, \"</%s>\\n\", name);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirStorageVolTimestampFormat(virBufferPtr buf, const char *name,\n                             struct timespec *ts)\n{\n    if (ts->tv_nsec < 0)\n        return;\n    virBufferAsprintf(buf, \"<%s>%llu\", name,\n                      (unsigned long long) ts->tv_sec);\n    if (ts->tv_nsec)\n       virBufferAsprintf(buf, \".%09ld\", ts->tv_nsec);\n    virBufferAsprintf(buf, \"</%s>\\n\", name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<timestamps>\\n\""
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</permissions>\\n\""
          ],
          "line": 1546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<permissions>\\n\""
          ],
          "line": 1529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unknown volume format number %d\")",
            "def->format"
          ],
          "line": 1516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown volume format number %d\""
          ],
          "line": 1517
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "def->format"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageVolTargetDefFormat(virStorageVolOptionsPtr options,\n                             virBufferPtr buf,\n                             virStorageSourcePtr def,\n                             const char *type)\n{\n    virBufferAsprintf(buf, \"<%s>\\n\", type);\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->path);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(def->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown volume format number %d\"),\n                           def->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (def->perms &&\n        (def->perms->mode != (mode_t) -1 ||\n         def->perms->uid != (uid_t) -1 ||\n         def->perms->gid != (gid_t) -1 ||\n         def->perms->label)) {\n        virBufferAddLit(buf, \"<permissions>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        if (def->perms->mode != (mode_t) -1)\n            virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                              def->perms->mode);\n        if (def->perms->uid != (uid_t) -1)\n            virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                              (int) def->perms->uid);\n        if (def->perms->gid != (gid_t) -1)\n            virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                              (int) def->perms->gid);\n\n        virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                              def->perms->label);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</permissions>\\n\");\n    }\n\n    if (def->timestamps) {\n        virBufferAddLit(buf, \"<timestamps>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virStorageVolTimestampFormat(buf, \"atime\", &def->timestamps->atime);\n        virStorageVolTimestampFormat(buf, \"mtime\", &def->timestamps->mtime);\n        virStorageVolTimestampFormat(buf, \"ctime\", &def->timestamps->ctime);\n        virStorageVolTimestampFormat(buf, \"btime\", &def->timestamps->btime);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</timestamps>\\n\");\n    }\n\n    if (def->encryption &&\n        virStorageEncryptionFormat(buf, def->encryption) < 0)\n            return -1;\n\n    virBufferEscapeString(buf, \"<compat>%s</compat>\\n\", def->compat);\n\n    if (def->features) {\n        size_t i;\n        bool empty = virBitmapIsAllClear(def->features);\n\n        if (empty) {\n            virBufferAddLit(buf, \"<features/>\\n\");\n        } else {\n            virBufferAddLit(buf, \"<features>\\n\");\n            virBufferAdjustIndent(buf, 2);\n        }\n\n        for (i = 0; i < VIR_STORAGE_FILE_FEATURE_LAST; i++) {\n            if (virBitmapIsBitSet(def->features, i))\n                virBufferAsprintf(buf, \"<%s/>\\n\",\n                                  virStorageFileFeatureTypeToString(i));\n        }\n        if (!empty) {\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</features>\\n\");\n        }\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAsprintf(buf, \"</%s>\\n\", type);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageVolTimestampFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1488-1499",
    "snippet": "static void\nvirStorageVolTimestampFormat(virBufferPtr buf, const char *name,\n                             struct timespec *ts)\n{\n    if (ts->tv_nsec < 0)\n        return;\n    virBufferAsprintf(buf, \"<%s>%llu\", name,\n                      (unsigned long long) ts->tv_sec);\n    if (ts->tv_nsec)\n       virBufferAsprintf(buf, \".%09ld\", ts->tv_nsec);\n    virBufferAsprintf(buf, \"</%s>\\n\", name);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"</%s>\\n\"",
            "name"
          ],
          "line": 1498
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirStorageVolTimestampFormat(virBufferPtr buf, const char *name,\n                             struct timespec *ts)\n{\n    if (ts->tv_nsec < 0)\n        return;\n    virBufferAsprintf(buf, \"<%s>%llu\", name,\n                      (unsigned long long) ts->tv_sec);\n    if (ts->tv_nsec)\n       virBufferAsprintf(buf, \".%09ld\", ts->tv_nsec);\n    virBufferAsprintf(buf, \"</%s>\\n\", name);\n}"
  },
  {
    "function_name": "virStorageVolDefParseFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1479-1485",
    "snippet": "virStorageVolDefPtr\nvirStorageVolDefParseFile(virStoragePoolDefPtr pool,\n                          const char *filename,\n                          unsigned int flags)\n{\n    return virStorageVolDefParse(pool, NULL, filename, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolDefParse",
          "args": [
            "pool",
            "NULL",
            "filename",
            "flags"
          ],
          "line": 1484
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1452-1467",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefParse(virStoragePoolDefPtr pool,\n                      const char *xmlStr,\n                      const char *filename,\n                      unsigned int flags)\n{\n    virStorageVolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_volume_definition)\")))) {\n        ret = virStorageVolDefParseNode(pool, xml, xmlDocGetRootElement(xml), flags);\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefParse(virStoragePoolDefPtr pool,\n                      const char *xmlStr,\n                      const char *filename,\n                      unsigned int flags)\n{\n    virStorageVolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_volume_definition)\")))) {\n        ret = virStorageVolDefParseNode(pool, xml, xmlDocGetRootElement(xml), flags);\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefParseFile(virStoragePoolDefPtr pool,\n                          const char *filename,\n                          unsigned int flags)\n{\n    return virStorageVolDefParse(pool, NULL, filename, flags);\n}"
  },
  {
    "function_name": "virStorageVolDefParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1470-1476",
    "snippet": "virStorageVolDefPtr\nvirStorageVolDefParseString(virStoragePoolDefPtr pool,\n                            const char *xmlStr,\n                            unsigned int flags)\n{\n    return virStorageVolDefParse(pool, xmlStr, NULL, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolDefParse",
          "args": [
            "pool",
            "xmlStr",
            "NULL",
            "flags"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1452-1467",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefParse(virStoragePoolDefPtr pool,\n                      const char *xmlStr,\n                      const char *filename,\n                      unsigned int flags)\n{\n    virStorageVolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_volume_definition)\")))) {\n        ret = virStorageVolDefParseNode(pool, xml, xmlDocGetRootElement(xml), flags);\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefParse(virStoragePoolDefPtr pool,\n                      const char *xmlStr,\n                      const char *filename,\n                      unsigned int flags)\n{\n    virStorageVolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_volume_definition)\")))) {\n        ret = virStorageVolDefParseNode(pool, xml, xmlDocGetRootElement(xml), flags);\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefParseString(virStoragePoolDefPtr pool,\n                            const char *xmlStr,\n                            unsigned int flags)\n{\n    return virStorageVolDefParse(pool, xmlStr, NULL, flags);\n}"
  },
  {
    "function_name": "virStorageVolDefParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1452-1467",
    "snippet": "static virStorageVolDefPtr\nvirStorageVolDefParse(virStoragePoolDefPtr pool,\n                      const char *xmlStr,\n                      const char *filename,\n                      unsigned int flags)\n{\n    virStorageVolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_volume_definition)\")))) {\n        ret = virStorageVolDefParseNode(pool, xml, xmlDocGetRootElement(xml), flags);\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 1463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolDefParseNode",
          "args": [
            "pool",
            "xml",
            "xmlDocGetRootElement(xml)",
            "flags"
          ],
          "line": 1462
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1428-1449",
          "snippet": "virStorageVolDefPtr\nvirStorageVolDefParseNode(virStoragePoolDefPtr pool,\n                          xmlDocPtr xml,\n                          xmlNodePtr root,\n                          unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"volume\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <volume>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStorageVolDefParseXML(pool, ctxt, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefParseNode(virStoragePoolDefPtr pool,\n                          xmlDocPtr xml,\n                          xmlNodePtr root,\n                          unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"volume\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <volume>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStorageVolDefParseXML(pool, ctxt, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParse",
          "args": [
            "filename",
            "xmlStr",
            "_(\"(storage_volume_definition)\")"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"(storage_volume_definition)\""
          ],
          "line": 1461
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefParse(virStoragePoolDefPtr pool,\n                      const char *xmlStr,\n                      const char *filename,\n                      unsigned int flags)\n{\n    virStorageVolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_volume_definition)\")))) {\n        ret = virStorageVolDefParseNode(pool, xml, xmlDocGetRootElement(xml), flags);\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virStorageVolDefParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1428-1449",
    "snippet": "virStorageVolDefPtr\nvirStorageVolDefParseNode(virStoragePoolDefPtr pool,\n                          xmlDocPtr xml,\n                          xmlNodePtr root,\n                          unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"volume\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <volume>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStorageVolDefParseXML(pool, ctxt, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageVolDefParseXML",
          "args": [
            "pool",
            "ctxt",
            "flags"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolDefParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1260-1425",
          "snippet": "static virStorageVolDefPtr\nvirStorageVolDefParseXML(virStoragePoolDefPtr pool,\n                         xmlXPathContextPtr ctxt,\n                         unsigned int flags)\n{\n    virStorageVolOptionsPtr options;\n    xmlNodePtr node;\n    size_t i;\n    int n;\n    g_autoptr(virStorageVolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *allocation = NULL;\n    g_autofree char *capacity = NULL;\n    g_autofree char *unit = NULL;\n    g_autofree char *backingStore = NULL;\n    g_autofree xmlNodePtr *nodes = NULL;\n\n    virCheckFlags(VIR_VOL_XML_PARSE_NO_CAPACITY |\n                  VIR_VOL_XML_PARSE_OPT_CAPACITY, NULL);\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->target.type = VIR_STORAGE_TYPE_FILE;\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing volume name element\"));\n        return NULL;\n    }\n\n    /* Normally generated by pool refresh, but useful for unit tests */\n    def->key = virXPathString(\"string(./key)\", ctxt);\n\n    /* Technically overridden by pool refresh, but useful for unit tests */\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type) {\n        if ((def->type = virStorageVolTypeFromString(type)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume type '%s'\"), type);\n            return NULL;\n        }\n    }\n\n    if ((backingStore = virXPathString(\"string(./backingStore/path)\", ctxt))) {\n        if (!(def->target.backingStore = virStorageSourceNew()))\n            return NULL;\n\n        def->target.backingStore->type = VIR_STORAGE_TYPE_FILE;\n\n        def->target.backingStore->path = backingStore;\n        backingStore = NULL;\n\n        if (options->formatFromString) {\n            g_autofree char *format = NULL;\n\n            format = virXPathString(\"string(./backingStore/format/@type)\", ctxt);\n            if (format == NULL)\n                def->target.backingStore->format = options->defaultFormat;\n            else\n                def->target.backingStore->format = (options->formatFromString)(format);\n\n            if (def->target.backingStore->format < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"unknown volume format type %s\"), format);\n                return NULL;\n            }\n        }\n\n        if (VIR_ALLOC(def->target.backingStore->perms) < 0)\n            return NULL;\n        if (virStorageDefParsePerms(ctxt, def->target.backingStore->perms,\n                                    \"./backingStore/permissions\") < 0)\n            return NULL;\n    }\n\n    capacity = virXPathString(\"string(./capacity)\", ctxt);\n    unit = virXPathString(\"string(./capacity/@unit)\", ctxt);\n    if (capacity) {\n        if (virStorageSize(unit, capacity, &def->target.capacity) < 0)\n            return NULL;\n    } else if (!(flags & VIR_VOL_XML_PARSE_NO_CAPACITY) &&\n               !((flags & VIR_VOL_XML_PARSE_OPT_CAPACITY) &&\n                 virStorageSourceHasBacking(&def->target))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"missing capacity element\"));\n        return NULL;\n    }\n    VIR_FREE(unit);\n\n    allocation = virXPathString(\"string(./allocation)\", ctxt);\n    if (allocation) {\n        unit = virXPathString(\"string(./allocation/@unit)\", ctxt);\n        if (virStorageSize(unit, allocation, &def->target.allocation) < 0)\n            return NULL;\n        def->target.has_allocation = true;\n    } else {\n        def->target.allocation = def->target.capacity;\n    }\n\n    def->target.path = virXPathString(\"string(./target/path)\", ctxt);\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./target/format/@type)\", ctxt);\n        if (format == NULL)\n            def->target.format = options->defaultFormat;\n        else\n            def->target.format = (options->formatFromString)(format);\n\n        if (def->target.format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume format type %s\"), format);\n            return NULL;\n        }\n    }\n\n    if (VIR_ALLOC(def->target.perms) < 0)\n        return NULL;\n    if (virStorageDefParsePerms(ctxt, def->target.perms,\n                                \"./target/permissions\") < 0)\n        return NULL;\n\n    node = virXPathNode(\"./target/encryption\", ctxt);\n    if (node != NULL) {\n        def->target.encryption = virStorageEncryptionParseNode(node, ctxt);\n        if (def->target.encryption == NULL)\n            return NULL;\n    }\n\n    def->target.compat = virXPathString(\"string(./target/compat)\", ctxt);\n    if (virStorageFileCheckCompat(def->target.compat) < 0)\n        return NULL;\n\n    if (virXPathNode(\"./target/nocow\", ctxt))\n        def->target.nocow = true;\n\n    if (virXPathNode(\"./target/features\", ctxt)) {\n        if ((n = virXPathNodeSet(\"./target/features/*\", ctxt, &nodes)) < 0)\n            return NULL;\n\n        if (!def->target.compat)\n            def->target.compat = g_strdup(\"1.1\");\n\n        if (!(def->target.features = virBitmapNew(VIR_STORAGE_FILE_FEATURE_LAST)))\n            return NULL;\n\n        for (i = 0; i < n; i++) {\n            int f = virStorageFileFeatureTypeFromString((const char*)nodes[i]->name);\n\n            if (f < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, _(\"unsupported feature %s\"),\n                               (const char*)nodes[i]->name);\n                return NULL;\n            }\n            ignore_value(virBitmapSetBit(def->target.features, f));\n        }\n        VIR_FREE(nodes);\n    }\n\n    return g_steal_pointer(&def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefParseXML(virStoragePoolDefPtr pool,\n                         xmlXPathContextPtr ctxt,\n                         unsigned int flags)\n{\n    virStorageVolOptionsPtr options;\n    xmlNodePtr node;\n    size_t i;\n    int n;\n    g_autoptr(virStorageVolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *allocation = NULL;\n    g_autofree char *capacity = NULL;\n    g_autofree char *unit = NULL;\n    g_autofree char *backingStore = NULL;\n    g_autofree xmlNodePtr *nodes = NULL;\n\n    virCheckFlags(VIR_VOL_XML_PARSE_NO_CAPACITY |\n                  VIR_VOL_XML_PARSE_OPT_CAPACITY, NULL);\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->target.type = VIR_STORAGE_TYPE_FILE;\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing volume name element\"));\n        return NULL;\n    }\n\n    /* Normally generated by pool refresh, but useful for unit tests */\n    def->key = virXPathString(\"string(./key)\", ctxt);\n\n    /* Technically overridden by pool refresh, but useful for unit tests */\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type) {\n        if ((def->type = virStorageVolTypeFromString(type)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume type '%s'\"), type);\n            return NULL;\n        }\n    }\n\n    if ((backingStore = virXPathString(\"string(./backingStore/path)\", ctxt))) {\n        if (!(def->target.backingStore = virStorageSourceNew()))\n            return NULL;\n\n        def->target.backingStore->type = VIR_STORAGE_TYPE_FILE;\n\n        def->target.backingStore->path = backingStore;\n        backingStore = NULL;\n\n        if (options->formatFromString) {\n            g_autofree char *format = NULL;\n\n            format = virXPathString(\"string(./backingStore/format/@type)\", ctxt);\n            if (format == NULL)\n                def->target.backingStore->format = options->defaultFormat;\n            else\n                def->target.backingStore->format = (options->formatFromString)(format);\n\n            if (def->target.backingStore->format < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"unknown volume format type %s\"), format);\n                return NULL;\n            }\n        }\n\n        if (VIR_ALLOC(def->target.backingStore->perms) < 0)\n            return NULL;\n        if (virStorageDefParsePerms(ctxt, def->target.backingStore->perms,\n                                    \"./backingStore/permissions\") < 0)\n            return NULL;\n    }\n\n    capacity = virXPathString(\"string(./capacity)\", ctxt);\n    unit = virXPathString(\"string(./capacity/@unit)\", ctxt);\n    if (capacity) {\n        if (virStorageSize(unit, capacity, &def->target.capacity) < 0)\n            return NULL;\n    } else if (!(flags & VIR_VOL_XML_PARSE_NO_CAPACITY) &&\n               !((flags & VIR_VOL_XML_PARSE_OPT_CAPACITY) &&\n                 virStorageSourceHasBacking(&def->target))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"missing capacity element\"));\n        return NULL;\n    }\n    VIR_FREE(unit);\n\n    allocation = virXPathString(\"string(./allocation)\", ctxt);\n    if (allocation) {\n        unit = virXPathString(\"string(./allocation/@unit)\", ctxt);\n        if (virStorageSize(unit, allocation, &def->target.allocation) < 0)\n            return NULL;\n        def->target.has_allocation = true;\n    } else {\n        def->target.allocation = def->target.capacity;\n    }\n\n    def->target.path = virXPathString(\"string(./target/path)\", ctxt);\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./target/format/@type)\", ctxt);\n        if (format == NULL)\n            def->target.format = options->defaultFormat;\n        else\n            def->target.format = (options->formatFromString)(format);\n\n        if (def->target.format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume format type %s\"), format);\n            return NULL;\n        }\n    }\n\n    if (VIR_ALLOC(def->target.perms) < 0)\n        return NULL;\n    if (virStorageDefParsePerms(ctxt, def->target.perms,\n                                \"./target/permissions\") < 0)\n        return NULL;\n\n    node = virXPathNode(\"./target/encryption\", ctxt);\n    if (node != NULL) {\n        def->target.encryption = virStorageEncryptionParseNode(node, ctxt);\n        if (def->target.encryption == NULL)\n            return NULL;\n    }\n\n    def->target.compat = virXPathString(\"string(./target/compat)\", ctxt);\n    if (virStorageFileCheckCompat(def->target.compat) < 0)\n        return NULL;\n\n    if (virXPathNode(\"./target/nocow\", ctxt))\n        def->target.nocow = true;\n\n    if (virXPathNode(\"./target/features\", ctxt)) {\n        if ((n = virXPathNodeSet(\"./target/features/*\", ctxt, &nodes)) < 0)\n            return NULL;\n\n        if (!def->target.compat)\n            def->target.compat = g_strdup(\"1.1\");\n\n        if (!(def->target.features = virBitmapNew(VIR_STORAGE_FILE_FEATURE_LAST)))\n            return NULL;\n\n        for (i = 0; i < n; i++) {\n            int f = virStorageFileFeatureTypeFromString((const char*)nodes[i]->name);\n\n            if (f < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, _(\"unsupported feature %s\"),\n                               (const char*)nodes[i]->name);\n                return NULL;\n            }\n            ignore_value(virBitmapSetBit(def->target.features, f));\n        }\n        VIR_FREE(nodes);\n    }\n\n    return g_steal_pointer(&def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLXPathContextNew",
          "args": [
            "xml"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLXPathContextNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "48-59",
          "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"unexpected root element <%s>, \"\n                         \"expecting <volume>\")",
            "root->name"
          ],
          "line": 1437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected root element <%s>, \"\n                         \"expecting <volume>\""
          ],
          "line": 1438
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "root",
            "\"volume\""
          ],
          "line": 1436
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStorageVolDefPtr\nvirStorageVolDefParseNode(virStoragePoolDefPtr pool,\n                          xmlDocPtr xml,\n                          xmlNodePtr root,\n                          unsigned int flags)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"volume\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <volume>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStorageVolDefParseXML(pool, ctxt, flags);\n}"
  },
  {
    "function_name": "virStorageVolDefParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1260-1425",
    "snippet": "static virStorageVolDefPtr\nvirStorageVolDefParseXML(virStoragePoolDefPtr pool,\n                         xmlXPathContextPtr ctxt,\n                         unsigned int flags)\n{\n    virStorageVolOptionsPtr options;\n    xmlNodePtr node;\n    size_t i;\n    int n;\n    g_autoptr(virStorageVolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *allocation = NULL;\n    g_autofree char *capacity = NULL;\n    g_autofree char *unit = NULL;\n    g_autofree char *backingStore = NULL;\n    g_autofree xmlNodePtr *nodes = NULL;\n\n    virCheckFlags(VIR_VOL_XML_PARSE_NO_CAPACITY |\n                  VIR_VOL_XML_PARSE_OPT_CAPACITY, NULL);\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->target.type = VIR_STORAGE_TYPE_FILE;\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing volume name element\"));\n        return NULL;\n    }\n\n    /* Normally generated by pool refresh, but useful for unit tests */\n    def->key = virXPathString(\"string(./key)\", ctxt);\n\n    /* Technically overridden by pool refresh, but useful for unit tests */\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type) {\n        if ((def->type = virStorageVolTypeFromString(type)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume type '%s'\"), type);\n            return NULL;\n        }\n    }\n\n    if ((backingStore = virXPathString(\"string(./backingStore/path)\", ctxt))) {\n        if (!(def->target.backingStore = virStorageSourceNew()))\n            return NULL;\n\n        def->target.backingStore->type = VIR_STORAGE_TYPE_FILE;\n\n        def->target.backingStore->path = backingStore;\n        backingStore = NULL;\n\n        if (options->formatFromString) {\n            g_autofree char *format = NULL;\n\n            format = virXPathString(\"string(./backingStore/format/@type)\", ctxt);\n            if (format == NULL)\n                def->target.backingStore->format = options->defaultFormat;\n            else\n                def->target.backingStore->format = (options->formatFromString)(format);\n\n            if (def->target.backingStore->format < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"unknown volume format type %s\"), format);\n                return NULL;\n            }\n        }\n\n        if (VIR_ALLOC(def->target.backingStore->perms) < 0)\n            return NULL;\n        if (virStorageDefParsePerms(ctxt, def->target.backingStore->perms,\n                                    \"./backingStore/permissions\") < 0)\n            return NULL;\n    }\n\n    capacity = virXPathString(\"string(./capacity)\", ctxt);\n    unit = virXPathString(\"string(./capacity/@unit)\", ctxt);\n    if (capacity) {\n        if (virStorageSize(unit, capacity, &def->target.capacity) < 0)\n            return NULL;\n    } else if (!(flags & VIR_VOL_XML_PARSE_NO_CAPACITY) &&\n               !((flags & VIR_VOL_XML_PARSE_OPT_CAPACITY) &&\n                 virStorageSourceHasBacking(&def->target))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"missing capacity element\"));\n        return NULL;\n    }\n    VIR_FREE(unit);\n\n    allocation = virXPathString(\"string(./allocation)\", ctxt);\n    if (allocation) {\n        unit = virXPathString(\"string(./allocation/@unit)\", ctxt);\n        if (virStorageSize(unit, allocation, &def->target.allocation) < 0)\n            return NULL;\n        def->target.has_allocation = true;\n    } else {\n        def->target.allocation = def->target.capacity;\n    }\n\n    def->target.path = virXPathString(\"string(./target/path)\", ctxt);\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./target/format/@type)\", ctxt);\n        if (format == NULL)\n            def->target.format = options->defaultFormat;\n        else\n            def->target.format = (options->formatFromString)(format);\n\n        if (def->target.format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume format type %s\"), format);\n            return NULL;\n        }\n    }\n\n    if (VIR_ALLOC(def->target.perms) < 0)\n        return NULL;\n    if (virStorageDefParsePerms(ctxt, def->target.perms,\n                                \"./target/permissions\") < 0)\n        return NULL;\n\n    node = virXPathNode(\"./target/encryption\", ctxt);\n    if (node != NULL) {\n        def->target.encryption = virStorageEncryptionParseNode(node, ctxt);\n        if (def->target.encryption == NULL)\n            return NULL;\n    }\n\n    def->target.compat = virXPathString(\"string(./target/compat)\", ctxt);\n    if (virStorageFileCheckCompat(def->target.compat) < 0)\n        return NULL;\n\n    if (virXPathNode(\"./target/nocow\", ctxt))\n        def->target.nocow = true;\n\n    if (virXPathNode(\"./target/features\", ctxt)) {\n        if ((n = virXPathNodeSet(\"./target/features/*\", ctxt, &nodes)) < 0)\n            return NULL;\n\n        if (!def->target.compat)\n            def->target.compat = g_strdup(\"1.1\");\n\n        if (!(def->target.features = virBitmapNew(VIR_STORAGE_FILE_FEATURE_LAST)))\n            return NULL;\n\n        for (i = 0; i < n; i++) {\n            int f = virStorageFileFeatureTypeFromString((const char*)nodes[i]->name);\n\n            if (f < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, _(\"unsupported feature %s\"),\n                               (const char*)nodes[i]->name);\n                return NULL;\n            }\n            ignore_value(virBitmapSetBit(def->target.features, f));\n        }\n        VIR_FREE(nodes);\n    }\n\n    return g_steal_pointer(&def);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&def"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodes"
          ],
          "line": 1421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(def->target.features, f)"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "def->target.features",
            "f"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unsupported feature %s\")",
            "(const char*)nodes[i]->name"
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unsupported feature %s\""
          ],
          "line": 1415
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileFeatureTypeFromString",
          "args": [
            "(const char*)nodes[i]->name"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "VIR_STORAGE_FILE_FEATURE_LAST"
          ],
          "line": 1408
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"1.1\""
          ],
          "line": 1406
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./target/features/*\"",
            "ctxt",
            "&nodes"
          ],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./target/features\"",
            "ctxt"
          ],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileCheckCompat",
          "args": [
            "def->target.compat"
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageFileCheckCompat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "4504-4522",
          "snippet": "int\nvirStorageFileCheckCompat(const char *compat)\n{\n    unsigned int result;\n    VIR_AUTOSTRINGLIST version = NULL;\n\n    if (!compat)\n        return 0;\n\n    version = virStringSplit(compat, \".\", 2);\n    if (!version || !version[1] ||\n        virStrToLong_ui(version[0], NULL, 10, &result) < 0 ||\n        virStrToLong_ui(version[1], NULL, 10, &result) < 0) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"forbidden characters in 'compat' attribute\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nint\nvirStorageFileCheckCompat(const char *compat)\n{\n    unsigned int result;\n    VIR_AUTOSTRINGLIST version = NULL;\n\n    if (!compat)\n        return 0;\n\n    version = virStringSplit(compat, \".\", 2);\n    if (!version || !version[1] ||\n        virStrToLong_ui(version[0], NULL, 10, &result) < 0 ||\n        virStrToLong_ui(version[1], NULL, 10, &result) < 0) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"forbidden characters in 'compat' attribute\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./target/compat)\"",
            "ctxt"
          ],
          "line": 1394
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageEncryptionParseNode",
          "args": [
            "node",
            "ctxt"
          ],
          "line": 1389
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageEncryptionParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstorageencryption.c",
          "lines": "243-319",
          "snippet": "virStorageEncryptionPtr\nvirStorageEncryptionParseNode(xmlNodePtr node,\n                              xmlXPathContextPtr ctxt)\n{\n    xmlNodePtr saveNode = ctxt->node;\n    xmlNodePtr *nodes = NULL;\n    virStorageEncryptionPtr encdef = NULL;\n    virStorageEncryptionPtr ret = NULL;\n    char *format_str = NULL;\n    int n;\n    size_t i;\n\n    ctxt->node = node;\n\n    if (VIR_ALLOC(encdef) < 0)\n        goto cleanup;\n\n    if (!(format_str = virXPathString(\"string(./@format)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption format\"));\n        goto cleanup;\n    }\n\n    if ((encdef->format =\n         virStorageEncryptionFormatTypeFromString(format_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption format type %s\"),\n                       format_str);\n        goto cleanup;\n    }\n\n    if ((n = virXPathNodeSet(\"./secret\", ctxt, &nodes)) < 0)\n        goto cleanup;\n\n    if (n > 0) {\n        if (VIR_ALLOC_N(encdef->secrets, n) < 0)\n            goto cleanup;\n        encdef->nsecrets = n;\n\n        for (i = 0; i < n; i++) {\n            if (!(encdef->secrets[i] =\n                  virStorageEncryptionSecretParse(ctxt, nodes[i])))\n                goto cleanup;\n        }\n    }\n\n    if (encdef->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        xmlNodePtr tmpnode;\n\n        if ((tmpnode = virXPathNode(\"./cipher[1]\", ctxt))) {\n            if (virStorageEncryptionInfoParseCipher(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n\n        if ((tmpnode = virXPathNode(\"./ivgen[1]\", ctxt))) {\n            /* If no cipher node, then fail */\n            if (!encdef->encinfo.cipher_name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"ivgen element found, but cipher is missing\"));\n                goto cleanup;\n            }\n\n            if (virStorageEncryptionInfoParseIvgen(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = g_steal_pointer(&encdef);\n\n cleanup:\n    VIR_FREE(format_str);\n    VIR_FREE(nodes);\n    virStorageEncryptionFree(encdef);\n    ctxt->node = saveNode;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virerror.h\"",
            "#include \"virxml.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virerror.h\"\n#include \"virxml.h\"\n#include \"virstorageencryption.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirStorageEncryptionPtr\nvirStorageEncryptionParseNode(xmlNodePtr node,\n                              xmlXPathContextPtr ctxt)\n{\n    xmlNodePtr saveNode = ctxt->node;\n    xmlNodePtr *nodes = NULL;\n    virStorageEncryptionPtr encdef = NULL;\n    virStorageEncryptionPtr ret = NULL;\n    char *format_str = NULL;\n    int n;\n    size_t i;\n\n    ctxt->node = node;\n\n    if (VIR_ALLOC(encdef) < 0)\n        goto cleanup;\n\n    if (!(format_str = virXPathString(\"string(./@format)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"unknown volume encryption format\"));\n        goto cleanup;\n    }\n\n    if ((encdef->format =\n         virStorageEncryptionFormatTypeFromString(format_str)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown volume encryption format type %s\"),\n                       format_str);\n        goto cleanup;\n    }\n\n    if ((n = virXPathNodeSet(\"./secret\", ctxt, &nodes)) < 0)\n        goto cleanup;\n\n    if (n > 0) {\n        if (VIR_ALLOC_N(encdef->secrets, n) < 0)\n            goto cleanup;\n        encdef->nsecrets = n;\n\n        for (i = 0; i < n; i++) {\n            if (!(encdef->secrets[i] =\n                  virStorageEncryptionSecretParse(ctxt, nodes[i])))\n                goto cleanup;\n        }\n    }\n\n    if (encdef->format == VIR_STORAGE_ENCRYPTION_FORMAT_LUKS) {\n        xmlNodePtr tmpnode;\n\n        if ((tmpnode = virXPathNode(\"./cipher[1]\", ctxt))) {\n            if (virStorageEncryptionInfoParseCipher(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n\n        if ((tmpnode = virXPathNode(\"./ivgen[1]\", ctxt))) {\n            /* If no cipher node, then fail */\n            if (!encdef->encinfo.cipher_name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"ivgen element found, but cipher is missing\"));\n                goto cleanup;\n            }\n\n            if (virStorageEncryptionInfoParseIvgen(tmpnode, &encdef->encinfo) < 0)\n                goto cleanup;\n        }\n    }\n\n    ret = g_steal_pointer(&encdef);\n\n cleanup:\n    VIR_FREE(format_str);\n    VIR_FREE(nodes);\n    virStorageEncryptionFree(encdef);\n    ctxt->node = saveNode;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageDefParsePerms",
          "args": [
            "ctxt",
            "def->target.perms",
            "\"./target/permissions\""
          ],
          "line": 1383
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageDefParsePerms",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "723-796",
          "snippet": "static int\nvirStorageDefParsePerms(xmlXPathContextPtr ctxt,\n                        virStoragePermsPtr perms,\n                        const char *permxpath)\n{\n    long long val;\n    int ret = -1;\n    xmlNodePtr relnode;\n    xmlNodePtr node;\n    g_autofree char *mode = NULL;\n\n    node = virXPathNode(permxpath, ctxt);\n    if (node == NULL) {\n        /* Set default values if there is not <permissions> element */\n        perms->mode = (mode_t) -1;\n        perms->uid = (uid_t) -1;\n        perms->gid = (gid_t) -1;\n        perms->label = NULL;\n        return 0;\n    }\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((mode = virXPathString(\"string(./mode)\", ctxt))) {\n        int tmp;\n\n        if (virStrToLong_i(mode, NULL, 8, &tmp) < 0 || (tmp & ~0777)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed octal mode\"));\n            goto error;\n        }\n        perms->mode = tmp;\n    } else {\n        perms->mode = (mode_t) -1;\n    }\n\n    if (virXPathNode(\"./owner\", ctxt) == NULL) {\n        perms->uid = (uid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./owner)\", ctxt, &val) < 0 ||\n            ((uid_t)val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed owner element\"));\n            goto error;\n        }\n\n        perms->uid = val;\n    }\n\n    if (virXPathNode(\"./group\", ctxt) == NULL) {\n        perms->gid = (gid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./group)\", ctxt, &val) < 0 ||\n            ((gid_t) val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed group element\"));\n            goto error;\n        }\n        perms->gid = val;\n    }\n\n    /* NB, we're ignoring missing labels here - they'll simply inherit */\n    perms->label = virXPathString(\"string(./label)\", ctxt);\n\n    ret = 0;\n error:\n    ctxt->node = relnode;\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageDefParsePerms(xmlXPathContextPtr ctxt,\n                        virStoragePermsPtr perms,\n                        const char *permxpath)\n{\n    long long val;\n    int ret = -1;\n    xmlNodePtr relnode;\n    xmlNodePtr node;\n    g_autofree char *mode = NULL;\n\n    node = virXPathNode(permxpath, ctxt);\n    if (node == NULL) {\n        /* Set default values if there is not <permissions> element */\n        perms->mode = (mode_t) -1;\n        perms->uid = (uid_t) -1;\n        perms->gid = (gid_t) -1;\n        perms->label = NULL;\n        return 0;\n    }\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((mode = virXPathString(\"string(./mode)\", ctxt))) {\n        int tmp;\n\n        if (virStrToLong_i(mode, NULL, 8, &tmp) < 0 || (tmp & ~0777)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed octal mode\"));\n            goto error;\n        }\n        perms->mode = tmp;\n    } else {\n        perms->mode = (mode_t) -1;\n    }\n\n    if (virXPathNode(\"./owner\", ctxt) == NULL) {\n        perms->uid = (uid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./owner)\", ctxt, &val) < 0 ||\n            ((uid_t)val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed owner element\"));\n            goto error;\n        }\n\n        perms->uid = val;\n    }\n\n    if (virXPathNode(\"./group\", ctxt) == NULL) {\n        perms->gid = (gid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./group)\", ctxt, &val) < 0 ||\n            ((gid_t) val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed group element\"));\n            goto error;\n        }\n        perms->gid = val;\n    }\n\n    /* NB, we're ignoring missing labels here - they'll simply inherit */\n    perms->label = virXPathString(\"string(./label)\", ctxt);\n\n    ret = 0;\n error:\n    ctxt->node = relnode;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def->target.perms"
          ],
          "line": 1381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown volume format type %s\")",
            "format"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "format"
          ],
          "line": 1372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSize",
          "args": [
            "unit",
            "allocation",
            "&def->target.allocation"
          ],
          "line": 1357
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1241-1257",
          "snippet": "static int\nvirStorageSize(const char *unit,\n               const char *val,\n               unsigned long long *ret)\n{\n    if (virStrToLong_ullp(val, NULL, 10, ret) < 0) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"malformed capacity element\"));\n        return -1;\n    }\n    /* off_t is signed, so you cannot create a file larger than 2**63\n     * bytes in the first place.  */\n    if (virScaleInteger(ret, unit, 1, LLONG_MAX) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageSize(const char *unit,\n               const char *val,\n               unsigned long long *ret)\n{\n    if (virStrToLong_ullp(val, NULL, 10, ret) < 0) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"malformed capacity element\"));\n        return -1;\n    }\n    /* off_t is signed, so you cannot create a file larger than 2**63\n     * bytes in the first place.  */\n    if (virScaleInteger(ret, unit, 1, LLONG_MAX) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "unit"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing capacity element\")"
          ],
          "line": 1349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceHasBacking",
          "args": [
            "&def->target"
          ],
          "line": 1348
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceHasBacking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1593-1598",
          "snippet": "bool\nvirStorageSourceHasBacking(const virStorageSource *src)\n{\n    return virStorageSourceIsBacking(src) && src->backingStore &&\n           src->backingStore->type != VIR_STORAGE_TYPE_NONE;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceHasBacking(const virStorageSource *src)\n{\n    return virStorageSourceIsBacking(src) && src->backingStore &&\n           src->backingStore->type != VIR_STORAGE_TYPE_NONE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def->target.backingStore->perms"
          ],
          "line": 1334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown volume format type %s\")",
            "format"
          ],
          "line": 1328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "format"
          ],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceNew",
          "args": [],
          "line": 1310
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2744-2751",
          "snippet": "virStorageSourcePtr\nvirStorageSourceNew(void)\n{\n    if (virStorageSourceInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virStorageSourceClass);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virStorageSourceClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nstatic virClassPtr virStorageSourceClass;\n\nvirStorageSourcePtr\nvirStorageSourceNew(void)\n{\n    if (virStorageSourceInitialize() < 0)\n        return NULL;\n\n    return virObjectNew(virStorageSourceClass);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown volume type '%s'\")",
            "type"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolTypeFromString",
          "args": [
            "type"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing volume name element\")"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolOptionsForPoolType",
          "args": [
            "pool->type"
          ],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "359-366",
          "snippet": "static virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_VOL_XML_PARSE_NO_CAPACITY |\n                  VIR_VOL_XML_PARSE_OPT_CAPACITY",
            "NULL"
          ],
          "line": 1277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolDefPtr\nvirStorageVolDefParseXML(virStoragePoolDefPtr pool,\n                         xmlXPathContextPtr ctxt,\n                         unsigned int flags)\n{\n    virStorageVolOptionsPtr options;\n    xmlNodePtr node;\n    size_t i;\n    int n;\n    g_autoptr(virStorageVolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *allocation = NULL;\n    g_autofree char *capacity = NULL;\n    g_autofree char *unit = NULL;\n    g_autofree char *backingStore = NULL;\n    g_autofree xmlNodePtr *nodes = NULL;\n\n    virCheckFlags(VIR_VOL_XML_PARSE_NO_CAPACITY |\n                  VIR_VOL_XML_PARSE_OPT_CAPACITY, NULL);\n\n    options = virStorageVolOptionsForPoolType(pool->type);\n    if (options == NULL)\n        return NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    def->target.type = VIR_STORAGE_TYPE_FILE;\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing volume name element\"));\n        return NULL;\n    }\n\n    /* Normally generated by pool refresh, but useful for unit tests */\n    def->key = virXPathString(\"string(./key)\", ctxt);\n\n    /* Technically overridden by pool refresh, but useful for unit tests */\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type) {\n        if ((def->type = virStorageVolTypeFromString(type)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume type '%s'\"), type);\n            return NULL;\n        }\n    }\n\n    if ((backingStore = virXPathString(\"string(./backingStore/path)\", ctxt))) {\n        if (!(def->target.backingStore = virStorageSourceNew()))\n            return NULL;\n\n        def->target.backingStore->type = VIR_STORAGE_TYPE_FILE;\n\n        def->target.backingStore->path = backingStore;\n        backingStore = NULL;\n\n        if (options->formatFromString) {\n            g_autofree char *format = NULL;\n\n            format = virXPathString(\"string(./backingStore/format/@type)\", ctxt);\n            if (format == NULL)\n                def->target.backingStore->format = options->defaultFormat;\n            else\n                def->target.backingStore->format = (options->formatFromString)(format);\n\n            if (def->target.backingStore->format < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"unknown volume format type %s\"), format);\n                return NULL;\n            }\n        }\n\n        if (VIR_ALLOC(def->target.backingStore->perms) < 0)\n            return NULL;\n        if (virStorageDefParsePerms(ctxt, def->target.backingStore->perms,\n                                    \"./backingStore/permissions\") < 0)\n            return NULL;\n    }\n\n    capacity = virXPathString(\"string(./capacity)\", ctxt);\n    unit = virXPathString(\"string(./capacity/@unit)\", ctxt);\n    if (capacity) {\n        if (virStorageSize(unit, capacity, &def->target.capacity) < 0)\n            return NULL;\n    } else if (!(flags & VIR_VOL_XML_PARSE_NO_CAPACITY) &&\n               !((flags & VIR_VOL_XML_PARSE_OPT_CAPACITY) &&\n                 virStorageSourceHasBacking(&def->target))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\", _(\"missing capacity element\"));\n        return NULL;\n    }\n    VIR_FREE(unit);\n\n    allocation = virXPathString(\"string(./allocation)\", ctxt);\n    if (allocation) {\n        unit = virXPathString(\"string(./allocation/@unit)\", ctxt);\n        if (virStorageSize(unit, allocation, &def->target.allocation) < 0)\n            return NULL;\n        def->target.has_allocation = true;\n    } else {\n        def->target.allocation = def->target.capacity;\n    }\n\n    def->target.path = virXPathString(\"string(./target/path)\", ctxt);\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./target/format/@type)\", ctxt);\n        if (format == NULL)\n            def->target.format = options->defaultFormat;\n        else\n            def->target.format = (options->formatFromString)(format);\n\n        if (def->target.format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown volume format type %s\"), format);\n            return NULL;\n        }\n    }\n\n    if (VIR_ALLOC(def->target.perms) < 0)\n        return NULL;\n    if (virStorageDefParsePerms(ctxt, def->target.perms,\n                                \"./target/permissions\") < 0)\n        return NULL;\n\n    node = virXPathNode(\"./target/encryption\", ctxt);\n    if (node != NULL) {\n        def->target.encryption = virStorageEncryptionParseNode(node, ctxt);\n        if (def->target.encryption == NULL)\n            return NULL;\n    }\n\n    def->target.compat = virXPathString(\"string(./target/compat)\", ctxt);\n    if (virStorageFileCheckCompat(def->target.compat) < 0)\n        return NULL;\n\n    if (virXPathNode(\"./target/nocow\", ctxt))\n        def->target.nocow = true;\n\n    if (virXPathNode(\"./target/features\", ctxt)) {\n        if ((n = virXPathNodeSet(\"./target/features/*\", ctxt, &nodes)) < 0)\n            return NULL;\n\n        if (!def->target.compat)\n            def->target.compat = g_strdup(\"1.1\");\n\n        if (!(def->target.features = virBitmapNew(VIR_STORAGE_FILE_FEATURE_LAST)))\n            return NULL;\n\n        for (i = 0; i < n; i++) {\n            int f = virStorageFileFeatureTypeFromString((const char*)nodes[i]->name);\n\n            if (f < 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, _(\"unsupported feature %s\"),\n                               (const char*)nodes[i]->name);\n                return NULL;\n            }\n            ignore_value(virBitmapSetBit(def->target.features, f));\n        }\n        VIR_FREE(nodes);\n    }\n\n    return g_steal_pointer(&def);\n}"
  },
  {
    "function_name": "virStorageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1241-1257",
    "snippet": "static int\nvirStorageSize(const char *unit,\n               const char *val,\n               unsigned long long *ret)\n{\n    if (virStrToLong_ullp(val, NULL, 10, ret) < 0) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"malformed capacity element\"));\n        return -1;\n    }\n    /* off_t is signed, so you cannot create a file larger than 2**63\n     * bytes in the first place.  */\n    if (virScaleInteger(ret, unit, 1, LLONG_MAX) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virScaleInteger",
          "args": [
            "ret",
            "unit",
            "1",
            "LLONG_MAX"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "virScaleInteger",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "175-235",
          "snippet": "int\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"malformed capacity element\")"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"malformed capacity element\""
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "val",
            "NULL",
            "10",
            "ret"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageSize(const char *unit,\n               const char *val,\n               unsigned long long *ret)\n{\n    if (virStrToLong_ullp(val, NULL, 10, ret) < 0) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"malformed capacity element\"));\n        return -1;\n    }\n    /* off_t is signed, so you cannot create a file larger than 2**63\n     * bytes in the first place.  */\n    if (virScaleInteger(ret, unit, 1, LLONG_MAX) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolDefFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1225-1238",
    "snippet": "char *\nvirStoragePoolDefFormat(virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 1236
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefFormatBuf",
          "args": [
            "&buf",
            "def"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1136-1222",
          "snippet": "static int\nvirStoragePoolDefFormatBuf(virBufferPtr buf,\n                           virStoragePoolDefPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    const char *type;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return -1;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<pool type='%s'\", type);\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    virBufferAsprintf(buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->capacity);\n    virBufferAsprintf(buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->allocation);\n    virBufferAsprintf(buf, \"<available unit='bytes'>%llu</available>\\n\",\n                      def->available);\n\n    if (virStoragePoolSourceFormat(buf, options, &def->source) < 0)\n        return -1;\n\n    /* RBD, Sheepdog, Gluster and Iscsi-direct devices are not local block devs nor\n     * files, so they don't have a target */\n    if (def->type != VIR_STORAGE_POOL_RBD &&\n        def->type != VIR_STORAGE_POOL_SHEEPDOG &&\n        def->type != VIR_STORAGE_POOL_GLUSTER &&\n        def->type != VIR_STORAGE_POOL_ISCSI_DIRECT) {\n        virBufferAddLit(buf, \"<target>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->target.path);\n\n        if (def->target.perms.mode != (mode_t) -1 ||\n            def->target.perms.uid != (uid_t) -1 ||\n            def->target.perms.gid != (gid_t) -1 ||\n            def->target.perms.label) {\n            virBufferAddLit(buf, \"<permissions>\\n\");\n            virBufferAdjustIndent(buf, 2);\n            if (def->target.perms.mode != (mode_t) -1)\n                virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                                  def->target.perms.mode);\n            if (def->target.perms.uid != (uid_t) -1)\n                virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                                  (int) def->target.perms.uid);\n            if (def->target.perms.gid != (gid_t) -1)\n                virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                                  (int) def->target.perms.gid);\n            virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                                  def->target.perms.label);\n\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</permissions>\\n\");\n        }\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</target>\\n\");\n    }\n\n    virStoragePoolDefRefreshFormat(buf, def->refresh);\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefFormatBuf(virBufferPtr buf,\n                           virStoragePoolDefPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    const char *type;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return -1;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<pool type='%s'\", type);\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    virBufferAsprintf(buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->capacity);\n    virBufferAsprintf(buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->allocation);\n    virBufferAsprintf(buf, \"<available unit='bytes'>%llu</available>\\n\",\n                      def->available);\n\n    if (virStoragePoolSourceFormat(buf, options, &def->source) < 0)\n        return -1;\n\n    /* RBD, Sheepdog, Gluster and Iscsi-direct devices are not local block devs nor\n     * files, so they don't have a target */\n    if (def->type != VIR_STORAGE_POOL_RBD &&\n        def->type != VIR_STORAGE_POOL_SHEEPDOG &&\n        def->type != VIR_STORAGE_POOL_GLUSTER &&\n        def->type != VIR_STORAGE_POOL_ISCSI_DIRECT) {\n        virBufferAddLit(buf, \"<target>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->target.path);\n\n        if (def->target.perms.mode != (mode_t) -1 ||\n            def->target.perms.uid != (uid_t) -1 ||\n            def->target.perms.gid != (gid_t) -1 ||\n            def->target.perms.label) {\n            virBufferAddLit(buf, \"<permissions>\\n\");\n            virBufferAdjustIndent(buf, 2);\n            if (def->target.perms.mode != (mode_t) -1)\n                virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                                  def->target.perms.mode);\n            if (def->target.perms.uid != (uid_t) -1)\n                virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                                  (int) def->target.perms.uid);\n            if (def->target.perms.gid != (gid_t) -1)\n                virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                                  (int) def->target.perms.gid);\n            virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                                  def->target.perms.label);\n\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</permissions>\\n\");\n        }\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</target>\\n\");\n    }\n\n    virStoragePoolDefRefreshFormat(buf, def->refresh);\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirStoragePoolDefFormat(virStoragePoolDefPtr def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virStoragePoolDefFormatBuf(&buf, def) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
  },
  {
    "function_name": "virStoragePoolDefFormatBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1136-1222",
    "snippet": "static int\nvirStoragePoolDefFormatBuf(virBufferPtr buf,\n                           virStoragePoolDefPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    const char *type;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return -1;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<pool type='%s'\", type);\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    virBufferAsprintf(buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->capacity);\n    virBufferAsprintf(buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->allocation);\n    virBufferAsprintf(buf, \"<available unit='bytes'>%llu</available>\\n\",\n                      def->available);\n\n    if (virStoragePoolSourceFormat(buf, options, &def->source) < 0)\n        return -1;\n\n    /* RBD, Sheepdog, Gluster and Iscsi-direct devices are not local block devs nor\n     * files, so they don't have a target */\n    if (def->type != VIR_STORAGE_POOL_RBD &&\n        def->type != VIR_STORAGE_POOL_SHEEPDOG &&\n        def->type != VIR_STORAGE_POOL_GLUSTER &&\n        def->type != VIR_STORAGE_POOL_ISCSI_DIRECT) {\n        virBufferAddLit(buf, \"<target>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->target.path);\n\n        if (def->target.perms.mode != (mode_t) -1 ||\n            def->target.perms.uid != (uid_t) -1 ||\n            def->target.perms.gid != (gid_t) -1 ||\n            def->target.perms.label) {\n            virBufferAddLit(buf, \"<permissions>\\n\");\n            virBufferAdjustIndent(buf, 2);\n            if (def->target.perms.mode != (mode_t) -1)\n                virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                                  def->target.perms.mode);\n            if (def->target.perms.uid != (uid_t) -1)\n                virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                                  (int) def->target.perms.uid);\n            if (def->target.perms.gid != (gid_t) -1)\n                virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                                  (int) def->target.perms.gid);\n            virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                                  def->target.perms.label);\n\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</permissions>\\n\");\n        }\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</target>\\n\");\n    }\n\n    virStoragePoolDefRefreshFormat(buf, def->refresh);\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</pool>\\n\""
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1218
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "buf",
            "def->namespaceData"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefRefreshFormat",
          "args": [
            "buf",
            "def->refresh"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefRefreshFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "828-841",
          "snippet": "static void\nvirStoragePoolDefRefreshFormat(virBufferPtr buf,\n                               virStoragePoolDefRefreshPtr refresh)\n{\n    if (!refresh)\n        return;\n\n    virBufferAddLit(buf, \"<refresh>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferAsprintf(buf, \"<volume allocation='%s'/>\\n\",\n                      virStorageVolDefRefreshAllocationTypeToString(refresh->volume.allocation));\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</refresh>\\n\");\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolDefRefreshFormat(virBufferPtr buf,\n                               virStoragePoolDefRefreshPtr refresh)\n{\n    if (!refresh)\n        return;\n\n    virBufferAddLit(buf, \"<refresh>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferAsprintf(buf, \"<volume allocation='%s'/>\\n\",\n                      virStorageVolDefRefreshAllocationTypeToString(refresh->volume.allocation));\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</refresh>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</target>\\n\""
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</permissions>\\n\""
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<label>%s</label>\\n\"",
            "def->target.perms.label"
          ],
          "line": 1200
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<group>%d</group>\\n\"",
            "(int) def->target.perms.gid"
          ],
          "line": 1198
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<permissions>\\n\""
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<target>\\n\""
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceFormat",
          "args": [
            "buf",
            "options",
            "&def->source"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1050-1133",
          "snippet": "static int\nvirStoragePoolSourceFormat(virBufferPtr buf,\n                           virStoragePoolOptionsPtr options,\n                           virStoragePoolSourcePtr src)\n{\n    size_t i, j;\n\n    virBufferAddLit(buf, \"<source>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_HOST) && src->nhost) {\n        for (i = 0; i < src->nhost; i++) {\n            virBufferEscapeString(buf, \"<host name='%s'\",\n                                  src->hosts[i].name);\n            if (src->hosts[i].port)\n                virBufferAsprintf(buf, \" port='%d'\", src->hosts[i].port);\n            virBufferAddLit(buf, \"/>\\n\");\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_DEVICE) &&\n        src->ndevice) {\n        for (i = 0; i < src->ndevice; i++) {\n            virBufferEscapeString(buf, \"<device path='%s'\",\n                                  src->devices[i].path);\n            if (src->devices[i].part_separator !=\n                VIR_TRISTATE_SWITCH_ABSENT) {\n                virBufferAsprintf(buf, \" part_separator='%s'\",\n                                  virTristateBoolTypeToString(src->devices[i].part_separator));\n            }\n            if (src->devices[i].nfreeExtent) {\n                virBufferAddLit(buf, \">\\n\");\n                virBufferAdjustIndent(buf, 2);\n                for (j = 0; j < src->devices[i].nfreeExtent; j++) {\n                    virBufferAsprintf(buf, \"<freeExtent start='%llu' end='%llu'/>\\n\",\n                                      src->devices[i].freeExtents[j].start,\n                                      src->devices[i].freeExtents[j].end);\n                }\n                virBufferAdjustIndent(buf, -2);\n                virBufferAddLit(buf, \"</device>\\n\");\n            } else {\n                virBufferAddLit(buf, \"/>\\n\");\n            }\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR)\n        virBufferEscapeString(buf, \"<dir path='%s'/>\\n\", src->dir);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST ||\n         src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST))\n        virStorageAdapterFormat(buf, &src->adapter);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\", src->name);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN)\n        virStorageSourceInitiatorFormatXML(&src->initiator, buf);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(src->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown pool format number %d\"),\n                           src->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (src->auth)\n        virStorageAuthDefFormat(buf, src->auth);\n\n    if (src->protocolVer)\n        virBufferAsprintf(buf, \"<protocol ver='%u'/>\\n\", src->protocolVer);\n\n    virBufferEscapeString(buf, \"<vendor name='%s'/>\\n\", src->vendor);\n    virBufferEscapeString(buf, \"<product name='%s'/>\\n\", src->product);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</source>\\n\");\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolSourceFormat(virBufferPtr buf,\n                           virStoragePoolOptionsPtr options,\n                           virStoragePoolSourcePtr src)\n{\n    size_t i, j;\n\n    virBufferAddLit(buf, \"<source>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_HOST) && src->nhost) {\n        for (i = 0; i < src->nhost; i++) {\n            virBufferEscapeString(buf, \"<host name='%s'\",\n                                  src->hosts[i].name);\n            if (src->hosts[i].port)\n                virBufferAsprintf(buf, \" port='%d'\", src->hosts[i].port);\n            virBufferAddLit(buf, \"/>\\n\");\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_DEVICE) &&\n        src->ndevice) {\n        for (i = 0; i < src->ndevice; i++) {\n            virBufferEscapeString(buf, \"<device path='%s'\",\n                                  src->devices[i].path);\n            if (src->devices[i].part_separator !=\n                VIR_TRISTATE_SWITCH_ABSENT) {\n                virBufferAsprintf(buf, \" part_separator='%s'\",\n                                  virTristateBoolTypeToString(src->devices[i].part_separator));\n            }\n            if (src->devices[i].nfreeExtent) {\n                virBufferAddLit(buf, \">\\n\");\n                virBufferAdjustIndent(buf, 2);\n                for (j = 0; j < src->devices[i].nfreeExtent; j++) {\n                    virBufferAsprintf(buf, \"<freeExtent start='%llu' end='%llu'/>\\n\",\n                                      src->devices[i].freeExtents[j].start,\n                                      src->devices[i].freeExtents[j].end);\n                }\n                virBufferAdjustIndent(buf, -2);\n                virBufferAddLit(buf, \"</device>\\n\");\n            } else {\n                virBufferAddLit(buf, \"/>\\n\");\n            }\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR)\n        virBufferEscapeString(buf, \"<dir path='%s'/>\\n\", src->dir);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST ||\n         src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST))\n        virStorageAdapterFormat(buf, &src->adapter);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\", src->name);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN)\n        virStorageSourceInitiatorFormatXML(&src->initiator, buf);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(src->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown pool format number %d\"),\n                           src->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (src->auth)\n        virStorageAuthDefFormat(buf, src->auth);\n\n    if (src->protocolVer)\n        virBufferAsprintf(buf, \"<protocol ver='%u'/>\\n\", src->protocolVer);\n\n    virBufferEscapeString(buf, \"<vendor name='%s'/>\\n\", src->vendor);\n    virBufferEscapeString(buf, \"<product name='%s'/>\\n\", src->product);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</source>\\n\");\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuid"
          ],
          "line": 1161
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 1157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLNamespaceFormatNS",
          "args": [
            "buf",
            "&def->ns"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNamespaceFormatNS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1412-1417",
          "snippet": "void\nvirXMLNamespaceFormatNS(virBufferPtr buf,\n                        virXMLNamespace const *ns)\n{\n    virBufferAsprintf(buf, \" xmlns:%s='%s'\", ns->prefix, ns->uri);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLNamespaceFormatNS(virBufferPtr buf,\n                        virXMLNamespace const *ns)\n{\n    virBufferAsprintf(buf, \" xmlns:%s='%s'\", ns->prefix, ns->uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unexpected pool type\")"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected pool type\""
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeToString",
          "args": [
            "def->type"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsForPoolType",
          "args": [
            "def->type"
          ],
          "line": 1144
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "324-331",
          "snippet": "static virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefFormatBuf(virBufferPtr buf,\n                           virStoragePoolDefPtr def)\n{\n    virStoragePoolOptionsPtr options;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    const char *type;\n\n    options = virStoragePoolOptionsForPoolType(def->type);\n    if (options == NULL)\n        return -1;\n\n    type = virStoragePoolTypeToString(def->type);\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"unexpected pool type\"));\n        return -1;\n    }\n    virBufferAsprintf(buf, \"<pool type='%s'\", type);\n    if (def->namespaceData && def->ns.format)\n        virXMLNamespaceFormatNS(buf, &def->ns);\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<name>%s</name>\\n\", def->name);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    virBufferAsprintf(buf, \"<capacity unit='bytes'>%llu</capacity>\\n\",\n                      def->capacity);\n    virBufferAsprintf(buf, \"<allocation unit='bytes'>%llu</allocation>\\n\",\n                      def->allocation);\n    virBufferAsprintf(buf, \"<available unit='bytes'>%llu</available>\\n\",\n                      def->available);\n\n    if (virStoragePoolSourceFormat(buf, options, &def->source) < 0)\n        return -1;\n\n    /* RBD, Sheepdog, Gluster and Iscsi-direct devices are not local block devs nor\n     * files, so they don't have a target */\n    if (def->type != VIR_STORAGE_POOL_RBD &&\n        def->type != VIR_STORAGE_POOL_SHEEPDOG &&\n        def->type != VIR_STORAGE_POOL_GLUSTER &&\n        def->type != VIR_STORAGE_POOL_ISCSI_DIRECT) {\n        virBufferAddLit(buf, \"<target>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virBufferEscapeString(buf, \"<path>%s</path>\\n\", def->target.path);\n\n        if (def->target.perms.mode != (mode_t) -1 ||\n            def->target.perms.uid != (uid_t) -1 ||\n            def->target.perms.gid != (gid_t) -1 ||\n            def->target.perms.label) {\n            virBufferAddLit(buf, \"<permissions>\\n\");\n            virBufferAdjustIndent(buf, 2);\n            if (def->target.perms.mode != (mode_t) -1)\n                virBufferAsprintf(buf, \"<mode>0%o</mode>\\n\",\n                                  def->target.perms.mode);\n            if (def->target.perms.uid != (uid_t) -1)\n                virBufferAsprintf(buf, \"<owner>%d</owner>\\n\",\n                                  (int) def->target.perms.uid);\n            if (def->target.perms.gid != (gid_t) -1)\n                virBufferAsprintf(buf, \"<group>%d</group>\\n\",\n                                  (int) def->target.perms.gid);\n            virBufferEscapeString(buf, \"<label>%s</label>\\n\",\n                                  def->target.perms.label);\n\n            virBufferAdjustIndent(buf, -2);\n            virBufferAddLit(buf, \"</permissions>\\n\");\n        }\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</target>\\n\");\n    }\n\n    virStoragePoolDefRefreshFormat(buf, def->refresh);\n\n    if (def->namespaceData && def->ns.format) {\n        if ((def->ns.format)(buf, def->namespaceData) < 0)\n            return -1;\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</pool>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolSourceFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1050-1133",
    "snippet": "static int\nvirStoragePoolSourceFormat(virBufferPtr buf,\n                           virStoragePoolOptionsPtr options,\n                           virStoragePoolSourcePtr src)\n{\n    size_t i, j;\n\n    virBufferAddLit(buf, \"<source>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_HOST) && src->nhost) {\n        for (i = 0; i < src->nhost; i++) {\n            virBufferEscapeString(buf, \"<host name='%s'\",\n                                  src->hosts[i].name);\n            if (src->hosts[i].port)\n                virBufferAsprintf(buf, \" port='%d'\", src->hosts[i].port);\n            virBufferAddLit(buf, \"/>\\n\");\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_DEVICE) &&\n        src->ndevice) {\n        for (i = 0; i < src->ndevice; i++) {\n            virBufferEscapeString(buf, \"<device path='%s'\",\n                                  src->devices[i].path);\n            if (src->devices[i].part_separator !=\n                VIR_TRISTATE_SWITCH_ABSENT) {\n                virBufferAsprintf(buf, \" part_separator='%s'\",\n                                  virTristateBoolTypeToString(src->devices[i].part_separator));\n            }\n            if (src->devices[i].nfreeExtent) {\n                virBufferAddLit(buf, \">\\n\");\n                virBufferAdjustIndent(buf, 2);\n                for (j = 0; j < src->devices[i].nfreeExtent; j++) {\n                    virBufferAsprintf(buf, \"<freeExtent start='%llu' end='%llu'/>\\n\",\n                                      src->devices[i].freeExtents[j].start,\n                                      src->devices[i].freeExtents[j].end);\n                }\n                virBufferAdjustIndent(buf, -2);\n                virBufferAddLit(buf, \"</device>\\n\");\n            } else {\n                virBufferAddLit(buf, \"/>\\n\");\n            }\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR)\n        virBufferEscapeString(buf, \"<dir path='%s'/>\\n\", src->dir);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST ||\n         src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST))\n        virStorageAdapterFormat(buf, &src->adapter);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\", src->name);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN)\n        virStorageSourceInitiatorFormatXML(&src->initiator, buf);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(src->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown pool format number %d\"),\n                           src->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (src->auth)\n        virStorageAuthDefFormat(buf, src->auth);\n\n    if (src->protocolVer)\n        virBufferAsprintf(buf, \"<protocol ver='%u'/>\\n\", src->protocolVer);\n\n    virBufferEscapeString(buf, \"<vendor name='%s'/>\\n\", src->vendor);\n    virBufferEscapeString(buf, \"<product name='%s'/>\\n\", src->product);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</source>\\n\");\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</source>\\n\""
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<product name='%s'/>\\n\"",
            "src->product"
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<protocol ver='%u'/>\\n\"",
            "src->protocolVer"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAuthDefFormat",
          "args": [
            "buf",
            "src->auth"
          ],
          "line": 1122
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAuthDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1862-1879",
          "snippet": "void\nvirStorageAuthDefFormat(virBufferPtr buf,\n                        virStorageAuthDefPtr authdef)\n{\n    if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n        virBufferEscapeString(buf, \"<auth username='%s'>\\n\", authdef->username);\n    } else {\n        virBufferAsprintf(buf, \"<auth type='%s' \",\n                          virStorageAuthTypeToString(authdef->authType));\n        virBufferEscapeString(buf, \"username='%s'>\\n\", authdef->username);\n    }\n\n    virBufferAdjustIndent(buf, 2);\n    virSecretLookupFormatSecret(buf, authdef->secrettype,\n                                &authdef->seclookupdef);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</auth>\\n\");\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvoid\nvirStorageAuthDefFormat(virBufferPtr buf,\n                        virStorageAuthDefPtr authdef)\n{\n    if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n        virBufferEscapeString(buf, \"<auth username='%s'>\\n\", authdef->username);\n    } else {\n        virBufferAsprintf(buf, \"<auth type='%s' \",\n                          virStorageAuthTypeToString(authdef->authType));\n        virBufferEscapeString(buf, \"username='%s'>\\n\", authdef->username);\n    }\n\n    virBufferAdjustIndent(buf, 2);\n    virSecretLookupFormatSecret(buf, authdef->secrettype,\n                                &authdef->seclookupdef);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</auth>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unknown pool format number %d\")",
            "src->format"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown pool format number %d\""
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "src->format"
          ],
          "line": 1111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceInitiatorFormatXML",
          "args": [
            "&src->initiator",
            "buf"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceInitiatorFormatXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "4681-4693",
          "snippet": "void\nvirStorageSourceInitiatorFormatXML(virStorageSourceInitiatorDefPtr initiator,\n                                   virBufferPtr buf)\n{\n    if (!initiator->iqn)\n        return;\n\n    virBufferAddLit(buf, \"<initiator>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<iqn name='%s'/>\\n\", initiator->iqn);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</initiator>\\n\");\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvoid\nvirStorageSourceInitiatorFormatXML(virStorageSourceInitiatorDefPtr initiator,\n                                   virBufferPtr buf)\n{\n    if (!initiator->iqn)\n        return;\n\n    virBufferAddLit(buf, \"<initiator>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferEscapeString(buf, \"<iqn name='%s'/>\\n\", initiator->iqn);\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</initiator>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterFormat",
          "args": [
            "buf",
            "&src->adapter"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "339-351",
          "snippet": "void\nvirStorageAdapterFormat(virBufferPtr buf,\n                        virStorageAdapterPtr adapter)\n{\n    virBufferAsprintf(buf, \"<adapter type='%s'\",\n                      virStorageAdapterTypeToString(adapter->type));\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterFormatFCHost(buf, &adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        virStorageAdapterFormatSCSIHost(buf, &adapter->data.scsi_host);\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nvoid\nvirStorageAdapterFormat(virBufferPtr buf,\n                        virStorageAdapterPtr adapter)\n{\n    virBufferAsprintf(buf, \"<adapter type='%s'\",\n                      virStorageAdapterTypeToString(adapter->type));\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterFormatFCHost(buf, &adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        virStorageAdapterFormatSCSIHost(buf, &adapter->data.scsi_host);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</device>\\n\""
          ],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 1081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTristateBoolTypeToString",
          "args": [
            "src->devices[i].part_separator"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 1066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<source>\\n\""
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolSourceFormat(virBufferPtr buf,\n                           virStoragePoolOptionsPtr options,\n                           virStoragePoolSourcePtr src)\n{\n    size_t i, j;\n\n    virBufferAddLit(buf, \"<source>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_HOST) && src->nhost) {\n        for (i = 0; i < src->nhost; i++) {\n            virBufferEscapeString(buf, \"<host name='%s'\",\n                                  src->hosts[i].name);\n            if (src->hosts[i].port)\n                virBufferAsprintf(buf, \" port='%d'\", src->hosts[i].port);\n            virBufferAddLit(buf, \"/>\\n\");\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_DEVICE) &&\n        src->ndevice) {\n        for (i = 0; i < src->ndevice; i++) {\n            virBufferEscapeString(buf, \"<device path='%s'\",\n                                  src->devices[i].path);\n            if (src->devices[i].part_separator !=\n                VIR_TRISTATE_SWITCH_ABSENT) {\n                virBufferAsprintf(buf, \" part_separator='%s'\",\n                                  virTristateBoolTypeToString(src->devices[i].part_separator));\n            }\n            if (src->devices[i].nfreeExtent) {\n                virBufferAddLit(buf, \">\\n\");\n                virBufferAdjustIndent(buf, 2);\n                for (j = 0; j < src->devices[i].nfreeExtent; j++) {\n                    virBufferAsprintf(buf, \"<freeExtent start='%llu' end='%llu'/>\\n\",\n                                      src->devices[i].freeExtents[j].start,\n                                      src->devices[i].freeExtents[j].end);\n                }\n                virBufferAdjustIndent(buf, -2);\n                virBufferAddLit(buf, \"</device>\\n\");\n            } else {\n                virBufferAddLit(buf, \"/>\\n\");\n            }\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR)\n        virBufferEscapeString(buf, \"<dir path='%s'/>\\n\", src->dir);\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST ||\n         src->adapter.type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST))\n        virStorageAdapterFormat(buf, &src->adapter);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        virBufferEscapeString(buf, \"<name>%s</name>\\n\", src->name);\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN)\n        virStorageSourceInitiatorFormatXML(&src->initiator, buf);\n\n    if (options->formatToString) {\n        const char *format = (options->formatToString)(src->format);\n        if (!format) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"unknown pool format number %d\"),\n                           src->format);\n            return -1;\n        }\n        virBufferAsprintf(buf, \"<format type='%s'/>\\n\", format);\n    }\n\n    if (src->auth)\n        virStorageAuthDefFormat(buf, src->auth);\n\n    if (src->protocolVer)\n        virBufferAsprintf(buf, \"<protocol ver='%u'/>\\n\", src->protocolVer);\n\n    virBufferEscapeString(buf, \"<vendor name='%s'/>\\n\", src->vendor);\n    virBufferEscapeString(buf, \"<product name='%s'/>\\n\", src->product);\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</source>\\n\");\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolDefParseFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1043-1047",
    "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseFile(const char *filename)\n{\n    return virStoragePoolDefParse(NULL, filename);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolDefParse",
          "args": [
            "NULL",
            "filename"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1020-1033",
          "snippet": "static virStoragePoolDefPtr\nvirStoragePoolDefParse(const char *xmlStr,\n                       const char *filename)\n{\n    virStoragePoolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_pool_definition)\")))) {\n        ret = virStoragePoolDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolDefPtr\nvirStoragePoolDefParse(const char *xmlStr,\n                       const char *filename)\n{\n    virStoragePoolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_pool_definition)\")))) {\n        ret = virStoragePoolDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseFile(const char *filename)\n{\n    return virStoragePoolDefParse(NULL, filename);\n}"
  },
  {
    "function_name": "virStoragePoolDefParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1036-1040",
    "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseString(const char *xmlStr)\n{\n    return virStoragePoolDefParse(xmlStr, NULL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolDefParse",
          "args": [
            "xmlStr",
            "NULL"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "1020-1033",
          "snippet": "static virStoragePoolDefPtr\nvirStoragePoolDefParse(const char *xmlStr,\n                       const char *filename)\n{\n    virStoragePoolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_pool_definition)\")))) {\n        ret = virStoragePoolDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolDefPtr\nvirStoragePoolDefParse(const char *xmlStr,\n                       const char *filename)\n{\n    virStoragePoolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_pool_definition)\")))) {\n        ret = virStoragePoolDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseString(const char *xmlStr)\n{\n    return virStoragePoolDefParse(xmlStr, NULL);\n}"
  },
  {
    "function_name": "virStoragePoolDefParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "1020-1033",
    "snippet": "static virStoragePoolDefPtr\nvirStoragePoolDefParse(const char *xmlStr,\n                       const char *filename)\n{\n    virStoragePoolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_pool_definition)\")))) {\n        ret = virStoragePoolDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "xml"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseNode",
          "args": [
            "xml",
            "xmlDocGetRootElement(xml)"
          ],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "998-1017",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseNode(xmlDocPtr xml,\n                           xmlNodePtr root)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"pool\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <pool>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStoragePoolDefParseXML(ctxt);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseNode(xmlDocPtr xml,\n                           xmlNodePtr root)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"pool\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <pool>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStoragePoolDefParseXML(ctxt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xmlDocGetRootElement",
          "args": [
            "xml"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParse",
          "args": [
            "filename",
            "xmlStr",
            "_(\"(storage_pool_definition)\")"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"(storage_pool_definition)\""
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolDefPtr\nvirStoragePoolDefParse(const char *xmlStr,\n                       const char *filename)\n{\n    virStoragePoolDefPtr ret = NULL;\n    xmlDocPtr xml;\n\n    if ((xml = virXMLParse(filename, xmlStr, _(\"(storage_pool_definition)\")))) {\n        ret = virStoragePoolDefParseNode(xml, xmlDocGetRootElement(xml));\n        xmlFreeDoc(xml);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolDefParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "998-1017",
    "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseNode(xmlDocPtr xml,\n                           xmlNodePtr root)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"pool\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <pool>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStoragePoolDefParseXML(ctxt);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolDefParseXML",
          "args": [
            "ctxt"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "844-995",
          "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virStoragePoolOptionsPtr options;\n    xmlNodePtr source_node;\n    g_autoptr(virStoragePoolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *uuid = NULL;\n    g_autofree char *target_path = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"storage pool missing type attribute\"));\n        return NULL;\n    }\n\n    if ((def->type = virStoragePoolTypeFromString(type)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    if ((options = virStoragePoolOptionsForPoolType(def->type)) == NULL)\n        return NULL;\n\n    source_node = virXPathNode(\"./source\", ctxt);\n    if (source_node) {\n        if (virStoragePoolDefParseSource(ctxt, &def->source, def->type,\n                                         source_node) < 0)\n            return NULL;\n    } else {\n        if (options->formatFromString)\n            def->source.format = options->defaultFormat;\n    }\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL &&\n        options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        def->name = g_strdup(def->source.name);\n\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing pool source name element\"));\n        return NULL;\n    }\n\n    if (strchr(def->name, '/')) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"name %s cannot contain '/'\"), def->name);\n        return NULL;\n    }\n\n    uuid = virXPathString(\"string(./uuid)\", ctxt);\n    if (uuid == NULL) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"unable to generate uuid\"));\n            return NULL;\n        }\n    } else {\n        if (virUUIDParse(uuid, def->uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed uuid element\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_HOST) {\n        if (!def->source.nhost) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source host name\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR) {\n        if (!def->source.dir) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source path\"));\n            return NULL;\n        }\n    }\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME) {\n        if (def->source.name == NULL) {\n            /* source name defaults to pool name */\n            def->source.name = g_strdup(def->name);\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (virStorageAdapterValidate(&def->source.adapter)) < 0)\n            return NULL;\n\n    /* If DEVICE is the only source type, then its required */\n    if (options->flags == VIR_STORAGE_POOL_SOURCE_DEVICE) {\n        if (!def->source.ndevice) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device name\"));\n            return NULL;\n        }\n    }\n\n    /* When we are working with a virtual disk we can skip the target\n     * path and permissions */\n    if (!(options->flags & VIR_STORAGE_POOL_SOURCE_NETWORK)) {\n        if (def->type == VIR_STORAGE_POOL_LOGICAL) {\n            target_path = g_strdup_printf(\"/dev/%s\", def->source.name);\n        } else if (def->type == VIR_STORAGE_POOL_ZFS) {\n            target_path = g_strdup_printf(\"/dev/zvol/%s\", def->source.name);\n        } else {\n            target_path = virXPathString(\"string(./target/path)\", ctxt);\n            if (!target_path) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool target path\"));\n                return NULL;\n            }\n        }\n        def->target.path = virFileSanitizePath(target_path);\n        if (!def->target.path)\n            return NULL;\n\n        if (virStorageDefParsePerms(ctxt, &def->target.perms,\n                                    \"./target/permissions\") < 0)\n            return NULL;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI_DIRECT &&\n        !def->source.initiator.iqn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"missing initiator IQN\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefRefreshParse(ctxt, def) < 0)\n        return NULL;\n\n    /* Make a copy of all the callback pointers here for easier use,\n     * especially during the virStoragePoolSourceClear method */\n    def->ns = options->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            return NULL;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&def);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virStoragePoolOptionsPtr options;\n    xmlNodePtr source_node;\n    g_autoptr(virStoragePoolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *uuid = NULL;\n    g_autofree char *target_path = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"storage pool missing type attribute\"));\n        return NULL;\n    }\n\n    if ((def->type = virStoragePoolTypeFromString(type)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    if ((options = virStoragePoolOptionsForPoolType(def->type)) == NULL)\n        return NULL;\n\n    source_node = virXPathNode(\"./source\", ctxt);\n    if (source_node) {\n        if (virStoragePoolDefParseSource(ctxt, &def->source, def->type,\n                                         source_node) < 0)\n            return NULL;\n    } else {\n        if (options->formatFromString)\n            def->source.format = options->defaultFormat;\n    }\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL &&\n        options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        def->name = g_strdup(def->source.name);\n\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing pool source name element\"));\n        return NULL;\n    }\n\n    if (strchr(def->name, '/')) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"name %s cannot contain '/'\"), def->name);\n        return NULL;\n    }\n\n    uuid = virXPathString(\"string(./uuid)\", ctxt);\n    if (uuid == NULL) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"unable to generate uuid\"));\n            return NULL;\n        }\n    } else {\n        if (virUUIDParse(uuid, def->uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed uuid element\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_HOST) {\n        if (!def->source.nhost) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source host name\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR) {\n        if (!def->source.dir) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source path\"));\n            return NULL;\n        }\n    }\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME) {\n        if (def->source.name == NULL) {\n            /* source name defaults to pool name */\n            def->source.name = g_strdup(def->name);\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (virStorageAdapterValidate(&def->source.adapter)) < 0)\n            return NULL;\n\n    /* If DEVICE is the only source type, then its required */\n    if (options->flags == VIR_STORAGE_POOL_SOURCE_DEVICE) {\n        if (!def->source.ndevice) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device name\"));\n            return NULL;\n        }\n    }\n\n    /* When we are working with a virtual disk we can skip the target\n     * path and permissions */\n    if (!(options->flags & VIR_STORAGE_POOL_SOURCE_NETWORK)) {\n        if (def->type == VIR_STORAGE_POOL_LOGICAL) {\n            target_path = g_strdup_printf(\"/dev/%s\", def->source.name);\n        } else if (def->type == VIR_STORAGE_POOL_ZFS) {\n            target_path = g_strdup_printf(\"/dev/zvol/%s\", def->source.name);\n        } else {\n            target_path = virXPathString(\"string(./target/path)\", ctxt);\n            if (!target_path) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool target path\"));\n                return NULL;\n            }\n        }\n        def->target.path = virFileSanitizePath(target_path);\n        if (!def->target.path)\n            return NULL;\n\n        if (virStorageDefParsePerms(ctxt, &def->target.perms,\n                                    \"./target/permissions\") < 0)\n            return NULL;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI_DIRECT &&\n        !def->source.initiator.iqn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"missing initiator IQN\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefRefreshParse(ctxt, def) < 0)\n        return NULL;\n\n    /* Make a copy of all the callback pointers here for easier use,\n     * especially during the virStoragePoolSourceClear method */\n    def->ns = options->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            return NULL;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLXPathContextNew",
          "args": [
            "xml"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLXPathContextNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "48-59",
          "snippet": "xmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlXPathContextPtr\nvirXMLXPathContextNew(xmlDocPtr xml)\n{\n    xmlXPathContextPtr ctxt;\n\n    if (!(ctxt = xmlXPathNewContext(xml))) {\n        virReportOOMError();\n        return NULL;\n    }\n\n    return ctxt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"unexpected root element <%s>, \"\n                         \"expecting <pool>\")",
            "root->name"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected root element <%s>, \"\n                         \"expecting <pool>\""
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "root",
            "\"pool\""
          ],
          "line": 1004
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseNode(xmlDocPtr xml,\n                           xmlNodePtr root)\n{\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n\n    if (!virXMLNodeNameEqual(root, \"pool\")) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"unexpected root element <%s>, \"\n                         \"expecting <pool>\"),\n                       root->name);\n        return NULL;\n    }\n\n    if (!(ctxt = virXMLXPathContextNew(xml)))\n        return NULL;\n\n    ctxt->node = root;\n    return virStoragePoolDefParseXML(ctxt);\n}"
  },
  {
    "function_name": "virStoragePoolDefParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "844-995",
    "snippet": "virStoragePoolDefPtr\nvirStoragePoolDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virStoragePoolOptionsPtr options;\n    xmlNodePtr source_node;\n    g_autoptr(virStoragePoolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *uuid = NULL;\n    g_autofree char *target_path = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"storage pool missing type attribute\"));\n        return NULL;\n    }\n\n    if ((def->type = virStoragePoolTypeFromString(type)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    if ((options = virStoragePoolOptionsForPoolType(def->type)) == NULL)\n        return NULL;\n\n    source_node = virXPathNode(\"./source\", ctxt);\n    if (source_node) {\n        if (virStoragePoolDefParseSource(ctxt, &def->source, def->type,\n                                         source_node) < 0)\n            return NULL;\n    } else {\n        if (options->formatFromString)\n            def->source.format = options->defaultFormat;\n    }\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL &&\n        options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        def->name = g_strdup(def->source.name);\n\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing pool source name element\"));\n        return NULL;\n    }\n\n    if (strchr(def->name, '/')) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"name %s cannot contain '/'\"), def->name);\n        return NULL;\n    }\n\n    uuid = virXPathString(\"string(./uuid)\", ctxt);\n    if (uuid == NULL) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"unable to generate uuid\"));\n            return NULL;\n        }\n    } else {\n        if (virUUIDParse(uuid, def->uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed uuid element\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_HOST) {\n        if (!def->source.nhost) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source host name\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR) {\n        if (!def->source.dir) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source path\"));\n            return NULL;\n        }\n    }\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME) {\n        if (def->source.name == NULL) {\n            /* source name defaults to pool name */\n            def->source.name = g_strdup(def->name);\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (virStorageAdapterValidate(&def->source.adapter)) < 0)\n            return NULL;\n\n    /* If DEVICE is the only source type, then its required */\n    if (options->flags == VIR_STORAGE_POOL_SOURCE_DEVICE) {\n        if (!def->source.ndevice) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device name\"));\n            return NULL;\n        }\n    }\n\n    /* When we are working with a virtual disk we can skip the target\n     * path and permissions */\n    if (!(options->flags & VIR_STORAGE_POOL_SOURCE_NETWORK)) {\n        if (def->type == VIR_STORAGE_POOL_LOGICAL) {\n            target_path = g_strdup_printf(\"/dev/%s\", def->source.name);\n        } else if (def->type == VIR_STORAGE_POOL_ZFS) {\n            target_path = g_strdup_printf(\"/dev/zvol/%s\", def->source.name);\n        } else {\n            target_path = virXPathString(\"string(./target/path)\", ctxt);\n            if (!target_path) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool target path\"));\n                return NULL;\n            }\n        }\n        def->target.path = virFileSanitizePath(target_path);\n        if (!def->target.path)\n            return NULL;\n\n        if (virStorageDefParsePerms(ctxt, &def->target.perms,\n                                    \"./target/permissions\") < 0)\n            return NULL;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI_DIRECT &&\n        !def->source.initiator.iqn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"missing initiator IQN\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefRefreshParse(ctxt, def) < 0)\n        return NULL;\n\n    /* Make a copy of all the callback pointers here for easier use,\n     * especially during the virStoragePoolSourceClear method */\n    def->ns = options->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            return NULL;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&def);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&def"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "ctxt",
            "&def->namespaceData"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLNamespaceRegister",
          "args": [
            "ctxt",
            "&def->ns"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNamespaceRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1420-1434",
          "snippet": "int\nvirXMLNamespaceRegister(xmlXPathContextPtr ctxt,\n                        virXMLNamespace const *ns)\n{\n    if (xmlXPathRegisterNs(ctxt,\n                           BAD_CAST ns->prefix,\n                           BAD_CAST ns->uri) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to register xml namespace '%s'\"),\n                       ns->uri);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLNamespaceRegister(xmlXPathContextPtr ctxt,\n                        virXMLNamespace const *ns)\n{\n    if (xmlXPathRegisterNs(ctxt,\n                           BAD_CAST ns->prefix,\n                           BAD_CAST ns->uri) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to register xml namespace '%s'\"),\n                       ns->uri);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefRefreshParse",
          "args": [
            "ctxt",
            "def"
          ],
          "line": 981
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefRefreshParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "799-825",
          "snippet": "static int\nvirStoragePoolDefRefreshParse(xmlXPathContextPtr ctxt,\n                              virStoragePoolDefPtr def)\n{\n    g_autofree virStoragePoolDefRefreshPtr refresh = NULL;\n    g_autofree char *allocation = NULL;\n    int tmp;\n\n    allocation = virXPathString(\"string(./refresh/volume/@allocation)\", ctxt);\n\n    if (!allocation)\n        return 0;\n\n    if ((tmp = virStorageVolDefRefreshAllocationTypeFromString(allocation)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool volume refresh allocation type %s\"),\n                       allocation);\n        return -1;\n    }\n\n    if (VIR_ALLOC(refresh) < 0)\n        return -1;\n\n    refresh->volume.allocation = tmp;\n    def->refresh = g_steal_pointer(&refresh);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefRefreshParse(xmlXPathContextPtr ctxt,\n                              virStoragePoolDefPtr def)\n{\n    g_autofree virStoragePoolDefRefreshPtr refresh = NULL;\n    g_autofree char *allocation = NULL;\n    int tmp;\n\n    allocation = virXPathString(\"string(./refresh/volume/@allocation)\", ctxt);\n\n    if (!allocation)\n        return 0;\n\n    if ((tmp = virStorageVolDefRefreshAllocationTypeFromString(allocation)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool volume refresh allocation type %s\"),\n                       allocation);\n        return -1;\n    }\n\n    if (VIR_ALLOC(refresh) < 0)\n        return -1;\n\n    refresh->volume.allocation = tmp;\n    def->refresh = g_steal_pointer(&refresh);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"missing initiator IQN\")"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing initiator IQN\""
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageDefParsePerms",
          "args": [
            "ctxt",
            "&def->target.perms",
            "\"./target/permissions\""
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageDefParsePerms",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "723-796",
          "snippet": "static int\nvirStorageDefParsePerms(xmlXPathContextPtr ctxt,\n                        virStoragePermsPtr perms,\n                        const char *permxpath)\n{\n    long long val;\n    int ret = -1;\n    xmlNodePtr relnode;\n    xmlNodePtr node;\n    g_autofree char *mode = NULL;\n\n    node = virXPathNode(permxpath, ctxt);\n    if (node == NULL) {\n        /* Set default values if there is not <permissions> element */\n        perms->mode = (mode_t) -1;\n        perms->uid = (uid_t) -1;\n        perms->gid = (gid_t) -1;\n        perms->label = NULL;\n        return 0;\n    }\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((mode = virXPathString(\"string(./mode)\", ctxt))) {\n        int tmp;\n\n        if (virStrToLong_i(mode, NULL, 8, &tmp) < 0 || (tmp & ~0777)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed octal mode\"));\n            goto error;\n        }\n        perms->mode = tmp;\n    } else {\n        perms->mode = (mode_t) -1;\n    }\n\n    if (virXPathNode(\"./owner\", ctxt) == NULL) {\n        perms->uid = (uid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./owner)\", ctxt, &val) < 0 ||\n            ((uid_t)val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed owner element\"));\n            goto error;\n        }\n\n        perms->uid = val;\n    }\n\n    if (virXPathNode(\"./group\", ctxt) == NULL) {\n        perms->gid = (gid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./group)\", ctxt, &val) < 0 ||\n            ((gid_t) val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed group element\"));\n            goto error;\n        }\n        perms->gid = val;\n    }\n\n    /* NB, we're ignoring missing labels here - they'll simply inherit */\n    perms->label = virXPathString(\"string(./label)\", ctxt);\n\n    ret = 0;\n error:\n    ctxt->node = relnode;\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageDefParsePerms(xmlXPathContextPtr ctxt,\n                        virStoragePermsPtr perms,\n                        const char *permxpath)\n{\n    long long val;\n    int ret = -1;\n    xmlNodePtr relnode;\n    xmlNodePtr node;\n    g_autofree char *mode = NULL;\n\n    node = virXPathNode(permxpath, ctxt);\n    if (node == NULL) {\n        /* Set default values if there is not <permissions> element */\n        perms->mode = (mode_t) -1;\n        perms->uid = (uid_t) -1;\n        perms->gid = (gid_t) -1;\n        perms->label = NULL;\n        return 0;\n    }\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((mode = virXPathString(\"string(./mode)\", ctxt))) {\n        int tmp;\n\n        if (virStrToLong_i(mode, NULL, 8, &tmp) < 0 || (tmp & ~0777)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed octal mode\"));\n            goto error;\n        }\n        perms->mode = tmp;\n    } else {\n        perms->mode = (mode_t) -1;\n    }\n\n    if (virXPathNode(\"./owner\", ctxt) == NULL) {\n        perms->uid = (uid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./owner)\", ctxt, &val) < 0 ||\n            ((uid_t)val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed owner element\"));\n            goto error;\n        }\n\n        perms->uid = val;\n    }\n\n    if (virXPathNode(\"./group\", ctxt) == NULL) {\n        perms->gid = (gid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./group)\", ctxt, &val) < 0 ||\n            ((gid_t) val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed group element\"));\n            goto error;\n        }\n        perms->gid = val;\n    }\n\n    /* NB, we're ignoring missing labels here - they'll simply inherit */\n    perms->label = virXPathString(\"string(./label)\", ctxt);\n\n    ret = 0;\n error:\n    ctxt->node = relnode;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileSanitizePath",
          "args": [
            "target_path"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "virFileSanitizePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3242-3290",
          "snippet": "char *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool target path\")"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./target/path)\"",
            "ctxt"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/zvol/%s\"",
            "def->source.name"
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool source device name\")"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageAdapterValidate",
          "args": [
            "&def->source.adapter"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "280-296",
          "snippet": "int\nvirStorageAdapterValidate(virStorageAdapterPtr adapter)\n{\n    if (!adapter->type) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing storage pool source adapter\"));\n        return -1;\n    }\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        return virStorageAdapterValidateFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        return virStorageAdapterValidateSCSIHost(&adapter->data.scsi_host);\n\n    return 0;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nint\nvirStorageAdapterValidate(virStorageAdapterPtr adapter)\n{\n    if (!adapter->type) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing storage pool source adapter\"));\n        return -1;\n    }\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        return virStorageAdapterValidateFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        return virStorageAdapterValidateSCSIHost(&adapter->data.scsi_host);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool source path\")"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool source host name\")"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"malformed uuid element\")"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuid",
            "def->uuid"
          ],
          "line": 908
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unable to generate uuid\")"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDGenerate",
          "args": [
            "def->uuid"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDGenerate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "50-79",
          "snippet": "int\nvirUUIDGenerate(unsigned char *uuid)\n{\n    if (uuid == NULL)\n        return -1;\n\n    if (virRandomBytes(uuid, VIR_UUID_BUFLEN) < 0)\n        return -1;\n\n    /*\n     * Make UUID RFC 4122 compliant. Following form will be used:\n     *\n     * xxxxxxxx-xxxx-Axxx-Bxxx-xxxxxxxxxxxx\n     *\n     * where\n     * A is version defined in 4.1.3 of RFC\n     *  Msb0  Msb1  Msb2  Msb3   Version  Description\n     *   0     1     0     0        4     The randomly or pseudo-\n     *                                    randomly generated version\n     *                                    specified in this document.\n     *\n     * B is variant defined in 4.1.1 of RFC\n     *  Msb0  Msb1  Msb2  Description\n     *   1     0     x    The variant specified in this document.\n     */\n    uuid[6] = (uuid[6] & 0x0F) | (4 << 4);\n    uuid[8] = (uuid[8] & 0x3F) | (2 << 6);\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDGenerate(unsigned char *uuid)\n{\n    if (uuid == NULL)\n        return -1;\n\n    if (virRandomBytes(uuid, VIR_UUID_BUFLEN) < 0)\n        return -1;\n\n    /*\n     * Make UUID RFC 4122 compliant. Following form will be used:\n     *\n     * xxxxxxxx-xxxx-Axxx-Bxxx-xxxxxxxxxxxx\n     *\n     * where\n     * A is version defined in 4.1.3 of RFC\n     *  Msb0  Msb1  Msb2  Msb3   Version  Description\n     *   0     1     0     0        4     The randomly or pseudo-\n     *                                    randomly generated version\n     *                                    specified in this document.\n     *\n     * B is variant defined in 4.1.1 of RFC\n     *  Msb0  Msb1  Msb2  Description\n     *   1     0     x    The variant specified in this document.\n     */\n    uuid[6] = (uuid[6] & 0x0F) | (4 << 4);\n    uuid[8] = (uuid[8] & 0x3F) | (2 << 6);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"name %s cannot contain '/'\")",
            "def->name"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "def->name",
            "'/'"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing pool source name element\")"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseSource",
          "args": [
            "ctxt",
            "&def->source",
            "def->type",
            "source_node"
          ],
          "line": 875
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "523-689",
          "snippet": "static int\nvirStoragePoolDefParseSource(xmlXPathContextPtr ctxt,\n                             virStoragePoolSourcePtr source,\n                             int pool_type,\n                             xmlNodePtr node)\n{\n    int ret = -1;\n    xmlNodePtr relnode, authnode;\n    xmlNodePtr adapternode;\n    int nsource;\n    size_t i;\n    virStoragePoolOptionsPtr options;\n    int n;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *port = NULL;\n    g_autofree char *ver = NULL;\n    g_autofree xmlNodePtr *nodeset = NULL;\n    g_autofree char *sourcedir = NULL;\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((options = virStoragePoolOptionsForPoolType(pool_type)) == NULL)\n        goto cleanup;\n\n    source->name = virXPathString(\"string(./name)\", ctxt);\n    if (pool_type == VIR_STORAGE_POOL_RBD && source->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"element 'name' is mandatory for RBD pool\"));\n        goto cleanup;\n    }\n\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./format/@type)\", ctxt);\n        if (format == NULL)\n            source->format = options->defaultFormat;\n        else\n            source->format = options->formatFromString(format);\n\n        if (source->format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown pool format type %s\"), format);\n            goto cleanup;\n        }\n    }\n\n    if ((n = virXPathNodeSet(\"./host\", ctxt, &nodeset)) < 0)\n        goto cleanup;\n\n    if (n) {\n        if (VIR_ALLOC_N(source->hosts, n) < 0)\n            goto cleanup;\n        source->nhost = n;\n\n        for (i = 0; i < source->nhost; i++) {\n            source->hosts[i].name = virXMLPropString(nodeset[i], \"name\");\n            if (!source->hosts[i].name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool host name\"));\n                goto cleanup;\n            }\n\n            port = virXMLPropString(nodeset[i], \"port\");\n            if (port) {\n                if (virStrToLong_i(port, NULL, 10, &source->hosts[i].port) < 0) {\n                    virReportError(VIR_ERR_XML_ERROR,\n                                   _(\"Invalid port number: %s\"),\n                                   port);\n                    goto cleanup;\n                }\n            }\n            VIR_FREE(port);\n        }\n    }\n\n    VIR_FREE(nodeset);\n\n    virStorageSourceInitiatorParseXML(ctxt, &source->initiator);\n\n    nsource = virXPathNodeSet(\"./device\", ctxt, &nodeset);\n    if (nsource < 0)\n        goto cleanup;\n\n    for (i = 0; i < nsource; i++) {\n        g_autofree char *partsep = NULL;\n        virStoragePoolSourceDevice dev = { .path = NULL };\n        dev.path = virXMLPropString(nodeset[i], \"path\");\n\n        if (dev.path == NULL) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device path\"));\n            goto cleanup;\n        }\n\n        partsep = virXMLPropString(nodeset[i], \"part_separator\");\n        if (partsep) {\n            dev.part_separator = virTristateBoolTypeFromString(partsep);\n            if (dev.part_separator <= 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"invalid part_separator setting '%s'\"),\n                               partsep);\n                virStoragePoolSourceDeviceClear(&dev);\n                goto cleanup;\n            }\n        }\n\n        if (VIR_APPEND_ELEMENT(source->devices, source->ndevice, dev) < 0) {\n            virStoragePoolSourceDeviceClear(&dev);\n            goto cleanup;\n        }\n\n    }\n\n    sourcedir = virXPathString(\"string(./dir/@path)\", ctxt);\n    if (sourcedir)\n        source->dir = virFileSanitizePath(sourcedir);\n    /* In gluster, a missing dir defaults to \"/\" */\n    if (!source->dir && pool_type == VIR_STORAGE_POOL_GLUSTER)\n        source->dir = g_strdup(\"/\");\n\n    if ((adapternode = virXPathNode(\"./adapter\", ctxt))) {\n        if (virStorageAdapterParseXML(&source->adapter, adapternode, ctxt) < 0)\n            goto cleanup;\n    }\n\n    if ((authnode = virXPathNode(\"./auth\", ctxt))) {\n        if (!(authdef = virStorageAuthDefParse(authnode, ctxt)))\n            goto cleanup;\n\n        if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"storage pool missing auth type\"));\n            goto cleanup;\n        }\n\n        source->auth = g_steal_pointer(&authdef);\n    }\n\n    /* Option protocol version string (NFSvN) */\n    if ((ver = virXPathString(\"string(./protocol/@ver)\", ctxt))) {\n        if ((source->format != VIR_STORAGE_POOL_NETFS_NFS) &&\n            (source->format != VIR_STORAGE_POOL_NETFS_AUTO)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\"),\n                           virStoragePoolFormatFileSystemNetTypeToString(source->format));\n            goto cleanup;\n        }\n        if (virStrToLong_uip(ver, NULL, 0, &source->protocolVer) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"storage pool protocol ver '%s' is malformed\"),\n                           ver);\n            goto cleanup;\n        }\n    }\n\n    source->vendor = virXPathString(\"string(./vendor/@name)\", ctxt);\n    source->product = virXPathString(\"string(./product/@name)\", ctxt);\n\n    ret = 0;\n cleanup:\n    ctxt->node = relnode;\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefParseSource(xmlXPathContextPtr ctxt,\n                             virStoragePoolSourcePtr source,\n                             int pool_type,\n                             xmlNodePtr node)\n{\n    int ret = -1;\n    xmlNodePtr relnode, authnode;\n    xmlNodePtr adapternode;\n    int nsource;\n    size_t i;\n    virStoragePoolOptionsPtr options;\n    int n;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *port = NULL;\n    g_autofree char *ver = NULL;\n    g_autofree xmlNodePtr *nodeset = NULL;\n    g_autofree char *sourcedir = NULL;\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((options = virStoragePoolOptionsForPoolType(pool_type)) == NULL)\n        goto cleanup;\n\n    source->name = virXPathString(\"string(./name)\", ctxt);\n    if (pool_type == VIR_STORAGE_POOL_RBD && source->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"element 'name' is mandatory for RBD pool\"));\n        goto cleanup;\n    }\n\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./format/@type)\", ctxt);\n        if (format == NULL)\n            source->format = options->defaultFormat;\n        else\n            source->format = options->formatFromString(format);\n\n        if (source->format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown pool format type %s\"), format);\n            goto cleanup;\n        }\n    }\n\n    if ((n = virXPathNodeSet(\"./host\", ctxt, &nodeset)) < 0)\n        goto cleanup;\n\n    if (n) {\n        if (VIR_ALLOC_N(source->hosts, n) < 0)\n            goto cleanup;\n        source->nhost = n;\n\n        for (i = 0; i < source->nhost; i++) {\n            source->hosts[i].name = virXMLPropString(nodeset[i], \"name\");\n            if (!source->hosts[i].name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool host name\"));\n                goto cleanup;\n            }\n\n            port = virXMLPropString(nodeset[i], \"port\");\n            if (port) {\n                if (virStrToLong_i(port, NULL, 10, &source->hosts[i].port) < 0) {\n                    virReportError(VIR_ERR_XML_ERROR,\n                                   _(\"Invalid port number: %s\"),\n                                   port);\n                    goto cleanup;\n                }\n            }\n            VIR_FREE(port);\n        }\n    }\n\n    VIR_FREE(nodeset);\n\n    virStorageSourceInitiatorParseXML(ctxt, &source->initiator);\n\n    nsource = virXPathNodeSet(\"./device\", ctxt, &nodeset);\n    if (nsource < 0)\n        goto cleanup;\n\n    for (i = 0; i < nsource; i++) {\n        g_autofree char *partsep = NULL;\n        virStoragePoolSourceDevice dev = { .path = NULL };\n        dev.path = virXMLPropString(nodeset[i], \"path\");\n\n        if (dev.path == NULL) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device path\"));\n            goto cleanup;\n        }\n\n        partsep = virXMLPropString(nodeset[i], \"part_separator\");\n        if (partsep) {\n            dev.part_separator = virTristateBoolTypeFromString(partsep);\n            if (dev.part_separator <= 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"invalid part_separator setting '%s'\"),\n                               partsep);\n                virStoragePoolSourceDeviceClear(&dev);\n                goto cleanup;\n            }\n        }\n\n        if (VIR_APPEND_ELEMENT(source->devices, source->ndevice, dev) < 0) {\n            virStoragePoolSourceDeviceClear(&dev);\n            goto cleanup;\n        }\n\n    }\n\n    sourcedir = virXPathString(\"string(./dir/@path)\", ctxt);\n    if (sourcedir)\n        source->dir = virFileSanitizePath(sourcedir);\n    /* In gluster, a missing dir defaults to \"/\" */\n    if (!source->dir && pool_type == VIR_STORAGE_POOL_GLUSTER)\n        source->dir = g_strdup(\"/\");\n\n    if ((adapternode = virXPathNode(\"./adapter\", ctxt))) {\n        if (virStorageAdapterParseXML(&source->adapter, adapternode, ctxt) < 0)\n            goto cleanup;\n    }\n\n    if ((authnode = virXPathNode(\"./auth\", ctxt))) {\n        if (!(authdef = virStorageAuthDefParse(authnode, ctxt)))\n            goto cleanup;\n\n        if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"storage pool missing auth type\"));\n            goto cleanup;\n        }\n\n        source->auth = g_steal_pointer(&authdef);\n    }\n\n    /* Option protocol version string (NFSvN) */\n    if ((ver = virXPathString(\"string(./protocol/@ver)\", ctxt))) {\n        if ((source->format != VIR_STORAGE_POOL_NETFS_NFS) &&\n            (source->format != VIR_STORAGE_POOL_NETFS_AUTO)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\"),\n                           virStoragePoolFormatFileSystemNetTypeToString(source->format));\n            goto cleanup;\n        }\n        if (virStrToLong_uip(ver, NULL, 0, &source->protocolVer) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"storage pool protocol ver '%s' is malformed\"),\n                           ver);\n            goto cleanup;\n        }\n    }\n\n    source->vendor = virXPathString(\"string(./vendor/@name)\", ctxt);\n    source->product = virXPathString(\"string(./product/@name)\", ctxt);\n\n    ret = 0;\n cleanup:\n    ctxt->node = relnode;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./source\"",
            "ctxt"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsForPoolType",
          "args": [
            "def->type"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "324-331",
          "snippet": "static virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown storage pool type %s\")",
            "type"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeFromString",
          "args": [
            "type"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"storage pool missing type attribute\")"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolDefPtr\nvirStoragePoolDefParseXML(xmlXPathContextPtr ctxt)\n{\n    virStoragePoolOptionsPtr options;\n    xmlNodePtr source_node;\n    g_autoptr(virStoragePoolDef) def = NULL;\n    g_autofree char *type = NULL;\n    g_autofree char *uuid = NULL;\n    g_autofree char *target_path = NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    type = virXPathString(\"string(./@type)\", ctxt);\n    if (type == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"storage pool missing type attribute\"));\n        return NULL;\n    }\n\n    if ((def->type = virStoragePoolTypeFromString(type)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool type %s\"), type);\n        return NULL;\n    }\n\n    if ((options = virStoragePoolOptionsForPoolType(def->type)) == NULL)\n        return NULL;\n\n    source_node = virXPathNode(\"./source\", ctxt);\n    if (source_node) {\n        if (virStoragePoolDefParseSource(ctxt, &def->source, def->type,\n                                         source_node) < 0)\n            return NULL;\n    } else {\n        if (options->formatFromString)\n            def->source.format = options->defaultFormat;\n    }\n\n    def->name = virXPathString(\"string(./name)\", ctxt);\n    if (def->name == NULL &&\n        options->flags & VIR_STORAGE_POOL_SOURCE_NAME)\n        def->name = g_strdup(def->source.name);\n\n    if (def->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing pool source name element\"));\n        return NULL;\n    }\n\n    if (strchr(def->name, '/')) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"name %s cannot contain '/'\"), def->name);\n        return NULL;\n    }\n\n    uuid = virXPathString(\"string(./uuid)\", ctxt);\n    if (uuid == NULL) {\n        if (virUUIDGenerate(def->uuid) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"unable to generate uuid\"));\n            return NULL;\n        }\n    } else {\n        if (virUUIDParse(uuid, def->uuid) < 0) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed uuid element\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_HOST) {\n        if (!def->source.nhost) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source host name\"));\n            return NULL;\n        }\n    }\n\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_DIR) {\n        if (!def->source.dir) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source path\"));\n            return NULL;\n        }\n    }\n    if (options->flags & VIR_STORAGE_POOL_SOURCE_NAME) {\n        if (def->source.name == NULL) {\n            /* source name defaults to pool name */\n            def->source.name = g_strdup(def->name);\n        }\n    }\n\n    if ((options->flags & VIR_STORAGE_POOL_SOURCE_ADAPTER) &&\n        (virStorageAdapterValidate(&def->source.adapter)) < 0)\n            return NULL;\n\n    /* If DEVICE is the only source type, then its required */\n    if (options->flags == VIR_STORAGE_POOL_SOURCE_DEVICE) {\n        if (!def->source.ndevice) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device name\"));\n            return NULL;\n        }\n    }\n\n    /* When we are working with a virtual disk we can skip the target\n     * path and permissions */\n    if (!(options->flags & VIR_STORAGE_POOL_SOURCE_NETWORK)) {\n        if (def->type == VIR_STORAGE_POOL_LOGICAL) {\n            target_path = g_strdup_printf(\"/dev/%s\", def->source.name);\n        } else if (def->type == VIR_STORAGE_POOL_ZFS) {\n            target_path = g_strdup_printf(\"/dev/zvol/%s\", def->source.name);\n        } else {\n            target_path = virXPathString(\"string(./target/path)\", ctxt);\n            if (!target_path) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool target path\"));\n                return NULL;\n            }\n        }\n        def->target.path = virFileSanitizePath(target_path);\n        if (!def->target.path)\n            return NULL;\n\n        if (virStorageDefParsePerms(ctxt, &def->target.perms,\n                                    \"./target/permissions\") < 0)\n            return NULL;\n    }\n\n    if (def->type == VIR_STORAGE_POOL_ISCSI_DIRECT &&\n        !def->source.initiator.iqn) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"missing initiator IQN\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefRefreshParse(ctxt, def) < 0)\n        return NULL;\n\n    /* Make a copy of all the callback pointers here for easier use,\n     * especially during the virStoragePoolSourceClear method */\n    def->ns = options->ns;\n    if (def->ns.parse) {\n        if (virXMLNamespaceRegister(ctxt, &def->ns) < 0)\n            return NULL;\n        if ((def->ns.parse)(ctxt, &def->namespaceData) < 0)\n            return NULL;\n    }\n\n    return g_steal_pointer(&def);\n}"
  },
  {
    "function_name": "virStoragePoolDefRefreshFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "828-841",
    "snippet": "static void\nvirStoragePoolDefRefreshFormat(virBufferPtr buf,\n                               virStoragePoolDefRefreshPtr refresh)\n{\n    if (!refresh)\n        return;\n\n    virBufferAddLit(buf, \"<refresh>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferAsprintf(buf, \"<volume allocation='%s'/>\\n\",\n                      virStorageVolDefRefreshAllocationTypeToString(refresh->volume.allocation));\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</refresh>\\n\");\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</refresh>\\n\""
          ],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<volume allocation='%s'/>\\n\"",
            "virStorageVolDefRefreshAllocationTypeToString(refresh->volume.allocation)"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefRefreshAllocationTypeToString",
          "args": [
            "refresh->volume.allocation"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<refresh>\\n\""
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nvirStoragePoolDefRefreshFormat(virBufferPtr buf,\n                               virStoragePoolDefRefreshPtr refresh)\n{\n    if (!refresh)\n        return;\n\n    virBufferAddLit(buf, \"<refresh>\\n\");\n    virBufferAdjustIndent(buf, 2);\n    virBufferAsprintf(buf, \"<volume allocation='%s'/>\\n\",\n                      virStorageVolDefRefreshAllocationTypeToString(refresh->volume.allocation));\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</refresh>\\n\");\n}"
  },
  {
    "function_name": "virStoragePoolDefRefreshParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "799-825",
    "snippet": "static int\nvirStoragePoolDefRefreshParse(xmlXPathContextPtr ctxt,\n                              virStoragePoolDefPtr def)\n{\n    g_autofree virStoragePoolDefRefreshPtr refresh = NULL;\n    g_autofree char *allocation = NULL;\n    int tmp;\n\n    allocation = virXPathString(\"string(./refresh/volume/@allocation)\", ctxt);\n\n    if (!allocation)\n        return 0;\n\n    if ((tmp = virStorageVolDefRefreshAllocationTypeFromString(allocation)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool volume refresh allocation type %s\"),\n                       allocation);\n        return -1;\n    }\n\n    if (VIR_ALLOC(refresh) < 0)\n        return -1;\n\n    refresh->volume.allocation = tmp;\n    def->refresh = g_steal_pointer(&refresh);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&refresh"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "refresh"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown storage pool volume refresh allocation type %s\")",
            "allocation"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown storage pool volume refresh allocation type %s\""
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageVolDefRefreshAllocationTypeFromString",
          "args": [
            "allocation"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./refresh/volume/@allocation)\"",
            "ctxt"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefRefreshParse(xmlXPathContextPtr ctxt,\n                              virStoragePoolDefPtr def)\n{\n    g_autofree virStoragePoolDefRefreshPtr refresh = NULL;\n    g_autofree char *allocation = NULL;\n    int tmp;\n\n    allocation = virXPathString(\"string(./refresh/volume/@allocation)\", ctxt);\n\n    if (!allocation)\n        return 0;\n\n    if ((tmp = virStorageVolDefRefreshAllocationTypeFromString(allocation)) < 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"unknown storage pool volume refresh allocation type %s\"),\n                       allocation);\n        return -1;\n    }\n\n    if (VIR_ALLOC(refresh) < 0)\n        return -1;\n\n    refresh->volume.allocation = tmp;\n    def->refresh = g_steal_pointer(&refresh);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageDefParsePerms",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "723-796",
    "snippet": "static int\nvirStorageDefParsePerms(xmlXPathContextPtr ctxt,\n                        virStoragePermsPtr perms,\n                        const char *permxpath)\n{\n    long long val;\n    int ret = -1;\n    xmlNodePtr relnode;\n    xmlNodePtr node;\n    g_autofree char *mode = NULL;\n\n    node = virXPathNode(permxpath, ctxt);\n    if (node == NULL) {\n        /* Set default values if there is not <permissions> element */\n        perms->mode = (mode_t) -1;\n        perms->uid = (uid_t) -1;\n        perms->gid = (gid_t) -1;\n        perms->label = NULL;\n        return 0;\n    }\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((mode = virXPathString(\"string(./mode)\", ctxt))) {\n        int tmp;\n\n        if (virStrToLong_i(mode, NULL, 8, &tmp) < 0 || (tmp & ~0777)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed octal mode\"));\n            goto error;\n        }\n        perms->mode = tmp;\n    } else {\n        perms->mode = (mode_t) -1;\n    }\n\n    if (virXPathNode(\"./owner\", ctxt) == NULL) {\n        perms->uid = (uid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./owner)\", ctxt, &val) < 0 ||\n            ((uid_t)val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed owner element\"));\n            goto error;\n        }\n\n        perms->uid = val;\n    }\n\n    if (virXPathNode(\"./group\", ctxt) == NULL) {\n        perms->gid = (gid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./group)\", ctxt, &val) < 0 ||\n            ((gid_t) val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed group element\"));\n            goto error;\n        }\n        perms->gid = val;\n    }\n\n    /* NB, we're ignoring missing labels here - they'll simply inherit */\n    perms->label = virXPathString(\"string(./label)\", ctxt);\n\n    ret = 0;\n error:\n    ctxt->node = relnode;\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./label)\"",
            "ctxt"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"malformed group element\")"
          ],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"malformed group element\""
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathLongLong",
          "args": [
            "\"number(./group)\"",
            "ctxt",
            "&val"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathLongLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "444-476",
          "snippet": "int\nvirXPathLongLong(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLongLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ll((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathLongLong(const char *xpath,\n                 xmlXPathContextPtr ctxt,\n                 long long *value)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret = 0;\n\n    if ((ctxt == NULL) || (xpath == NULL) || (value == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathLongLong()\"));\n        return -1;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj != NULL) && (obj->type == XPATH_STRING) &&\n        (obj->stringval != NULL) && (obj->stringval[0] != 0)) {\n        if (virStrToLong_ll((char *) obj->stringval, NULL, 10, value) < 0)\n            ret = -2;\n    } else if ((obj != NULL) && (obj->type == XPATH_NUMBER) &&\n               (!(isnan(obj->floatval)))) {\n        *value = (long long) obj->floatval;\n        if (*value != obj->floatval)\n            ret = -2;\n    } else {\n        ret = -1;\n    }\n\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./group\"",
            "ctxt"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"malformed owner element\")"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"malformed octal mode\")"
          ],
          "line": 751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "mode",
            "NULL",
            "8",
            "&tmp"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageDefParsePerms(xmlXPathContextPtr ctxt,\n                        virStoragePermsPtr perms,\n                        const char *permxpath)\n{\n    long long val;\n    int ret = -1;\n    xmlNodePtr relnode;\n    xmlNodePtr node;\n    g_autofree char *mode = NULL;\n\n    node = virXPathNode(permxpath, ctxt);\n    if (node == NULL) {\n        /* Set default values if there is not <permissions> element */\n        perms->mode = (mode_t) -1;\n        perms->uid = (uid_t) -1;\n        perms->gid = (gid_t) -1;\n        perms->label = NULL;\n        return 0;\n    }\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((mode = virXPathString(\"string(./mode)\", ctxt))) {\n        int tmp;\n\n        if (virStrToLong_i(mode, NULL, 8, &tmp) < 0 || (tmp & ~0777)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed octal mode\"));\n            goto error;\n        }\n        perms->mode = tmp;\n    } else {\n        perms->mode = (mode_t) -1;\n    }\n\n    if (virXPathNode(\"./owner\", ctxt) == NULL) {\n        perms->uid = (uid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./owner)\", ctxt, &val) < 0 ||\n            ((uid_t)val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed owner element\"));\n            goto error;\n        }\n\n        perms->uid = val;\n    }\n\n    if (virXPathNode(\"./group\", ctxt) == NULL) {\n        perms->gid = (gid_t) -1;\n    } else {\n        /* We previously could output -1, so continue to parse it */\n        if (virXPathLongLong(\"number(./group)\", ctxt, &val) < 0 ||\n            ((gid_t) val != val &&\n             val != -1)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"malformed group element\"));\n            goto error;\n        }\n        perms->gid = val;\n    }\n\n    /* NB, we're ignoring missing labels here - they'll simply inherit */\n    perms->label = virXPathString(\"string(./label)\", ctxt);\n\n    ret = 0;\n error:\n    ctxt->node = relnode;\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolDefParseSourceString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "692-720",
    "snippet": "virStoragePoolSourcePtr\nvirStoragePoolDefParseSourceString(const char *srcSpec,\n                                   int pool_type)\n{\n    g_autoptr(xmlDoc) doc = NULL;\n    xmlNodePtr node = NULL;\n    g_autoptr(xmlXPathContext) xpath_ctxt = NULL;\n    g_autoptr(virStoragePoolSource) def = NULL;\n\n    if (!(doc = virXMLParseStringCtxt(srcSpec,\n                                      _(\"(storage_source_specification)\"),\n                                      &xpath_ctxt)))\n        return NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    if (!(node = virXPathNode(\"/source\", xpath_ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"root element was not source\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefParseSource(xpath_ctxt, def, pool_type,\n                                     node) < 0)\n        return NULL;\n\n    return g_steal_pointer(&def);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&def"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolDefParseSource",
          "args": [
            "xpath_ctxt",
            "def",
            "pool_type",
            "node"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolDefParseSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "523-689",
          "snippet": "static int\nvirStoragePoolDefParseSource(xmlXPathContextPtr ctxt,\n                             virStoragePoolSourcePtr source,\n                             int pool_type,\n                             xmlNodePtr node)\n{\n    int ret = -1;\n    xmlNodePtr relnode, authnode;\n    xmlNodePtr adapternode;\n    int nsource;\n    size_t i;\n    virStoragePoolOptionsPtr options;\n    int n;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *port = NULL;\n    g_autofree char *ver = NULL;\n    g_autofree xmlNodePtr *nodeset = NULL;\n    g_autofree char *sourcedir = NULL;\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((options = virStoragePoolOptionsForPoolType(pool_type)) == NULL)\n        goto cleanup;\n\n    source->name = virXPathString(\"string(./name)\", ctxt);\n    if (pool_type == VIR_STORAGE_POOL_RBD && source->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"element 'name' is mandatory for RBD pool\"));\n        goto cleanup;\n    }\n\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./format/@type)\", ctxt);\n        if (format == NULL)\n            source->format = options->defaultFormat;\n        else\n            source->format = options->formatFromString(format);\n\n        if (source->format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown pool format type %s\"), format);\n            goto cleanup;\n        }\n    }\n\n    if ((n = virXPathNodeSet(\"./host\", ctxt, &nodeset)) < 0)\n        goto cleanup;\n\n    if (n) {\n        if (VIR_ALLOC_N(source->hosts, n) < 0)\n            goto cleanup;\n        source->nhost = n;\n\n        for (i = 0; i < source->nhost; i++) {\n            source->hosts[i].name = virXMLPropString(nodeset[i], \"name\");\n            if (!source->hosts[i].name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool host name\"));\n                goto cleanup;\n            }\n\n            port = virXMLPropString(nodeset[i], \"port\");\n            if (port) {\n                if (virStrToLong_i(port, NULL, 10, &source->hosts[i].port) < 0) {\n                    virReportError(VIR_ERR_XML_ERROR,\n                                   _(\"Invalid port number: %s\"),\n                                   port);\n                    goto cleanup;\n                }\n            }\n            VIR_FREE(port);\n        }\n    }\n\n    VIR_FREE(nodeset);\n\n    virStorageSourceInitiatorParseXML(ctxt, &source->initiator);\n\n    nsource = virXPathNodeSet(\"./device\", ctxt, &nodeset);\n    if (nsource < 0)\n        goto cleanup;\n\n    for (i = 0; i < nsource; i++) {\n        g_autofree char *partsep = NULL;\n        virStoragePoolSourceDevice dev = { .path = NULL };\n        dev.path = virXMLPropString(nodeset[i], \"path\");\n\n        if (dev.path == NULL) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device path\"));\n            goto cleanup;\n        }\n\n        partsep = virXMLPropString(nodeset[i], \"part_separator\");\n        if (partsep) {\n            dev.part_separator = virTristateBoolTypeFromString(partsep);\n            if (dev.part_separator <= 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"invalid part_separator setting '%s'\"),\n                               partsep);\n                virStoragePoolSourceDeviceClear(&dev);\n                goto cleanup;\n            }\n        }\n\n        if (VIR_APPEND_ELEMENT(source->devices, source->ndevice, dev) < 0) {\n            virStoragePoolSourceDeviceClear(&dev);\n            goto cleanup;\n        }\n\n    }\n\n    sourcedir = virXPathString(\"string(./dir/@path)\", ctxt);\n    if (sourcedir)\n        source->dir = virFileSanitizePath(sourcedir);\n    /* In gluster, a missing dir defaults to \"/\" */\n    if (!source->dir && pool_type == VIR_STORAGE_POOL_GLUSTER)\n        source->dir = g_strdup(\"/\");\n\n    if ((adapternode = virXPathNode(\"./adapter\", ctxt))) {\n        if (virStorageAdapterParseXML(&source->adapter, adapternode, ctxt) < 0)\n            goto cleanup;\n    }\n\n    if ((authnode = virXPathNode(\"./auth\", ctxt))) {\n        if (!(authdef = virStorageAuthDefParse(authnode, ctxt)))\n            goto cleanup;\n\n        if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"storage pool missing auth type\"));\n            goto cleanup;\n        }\n\n        source->auth = g_steal_pointer(&authdef);\n    }\n\n    /* Option protocol version string (NFSvN) */\n    if ((ver = virXPathString(\"string(./protocol/@ver)\", ctxt))) {\n        if ((source->format != VIR_STORAGE_POOL_NETFS_NFS) &&\n            (source->format != VIR_STORAGE_POOL_NETFS_AUTO)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\"),\n                           virStoragePoolFormatFileSystemNetTypeToString(source->format));\n            goto cleanup;\n        }\n        if (virStrToLong_uip(ver, NULL, 0, &source->protocolVer) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"storage pool protocol ver '%s' is malformed\"),\n                           ver);\n            goto cleanup;\n        }\n    }\n\n    source->vendor = virXPathString(\"string(./vendor/@name)\", ctxt);\n    source->product = virXPathString(\"string(./product/@name)\", ctxt);\n\n    ret = 0;\n cleanup:\n    ctxt->node = relnode;\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefParseSource(xmlXPathContextPtr ctxt,\n                             virStoragePoolSourcePtr source,\n                             int pool_type,\n                             xmlNodePtr node)\n{\n    int ret = -1;\n    xmlNodePtr relnode, authnode;\n    xmlNodePtr adapternode;\n    int nsource;\n    size_t i;\n    virStoragePoolOptionsPtr options;\n    int n;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *port = NULL;\n    g_autofree char *ver = NULL;\n    g_autofree xmlNodePtr *nodeset = NULL;\n    g_autofree char *sourcedir = NULL;\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((options = virStoragePoolOptionsForPoolType(pool_type)) == NULL)\n        goto cleanup;\n\n    source->name = virXPathString(\"string(./name)\", ctxt);\n    if (pool_type == VIR_STORAGE_POOL_RBD && source->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"element 'name' is mandatory for RBD pool\"));\n        goto cleanup;\n    }\n\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./format/@type)\", ctxt);\n        if (format == NULL)\n            source->format = options->defaultFormat;\n        else\n            source->format = options->formatFromString(format);\n\n        if (source->format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown pool format type %s\"), format);\n            goto cleanup;\n        }\n    }\n\n    if ((n = virXPathNodeSet(\"./host\", ctxt, &nodeset)) < 0)\n        goto cleanup;\n\n    if (n) {\n        if (VIR_ALLOC_N(source->hosts, n) < 0)\n            goto cleanup;\n        source->nhost = n;\n\n        for (i = 0; i < source->nhost; i++) {\n            source->hosts[i].name = virXMLPropString(nodeset[i], \"name\");\n            if (!source->hosts[i].name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool host name\"));\n                goto cleanup;\n            }\n\n            port = virXMLPropString(nodeset[i], \"port\");\n            if (port) {\n                if (virStrToLong_i(port, NULL, 10, &source->hosts[i].port) < 0) {\n                    virReportError(VIR_ERR_XML_ERROR,\n                                   _(\"Invalid port number: %s\"),\n                                   port);\n                    goto cleanup;\n                }\n            }\n            VIR_FREE(port);\n        }\n    }\n\n    VIR_FREE(nodeset);\n\n    virStorageSourceInitiatorParseXML(ctxt, &source->initiator);\n\n    nsource = virXPathNodeSet(\"./device\", ctxt, &nodeset);\n    if (nsource < 0)\n        goto cleanup;\n\n    for (i = 0; i < nsource; i++) {\n        g_autofree char *partsep = NULL;\n        virStoragePoolSourceDevice dev = { .path = NULL };\n        dev.path = virXMLPropString(nodeset[i], \"path\");\n\n        if (dev.path == NULL) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device path\"));\n            goto cleanup;\n        }\n\n        partsep = virXMLPropString(nodeset[i], \"part_separator\");\n        if (partsep) {\n            dev.part_separator = virTristateBoolTypeFromString(partsep);\n            if (dev.part_separator <= 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"invalid part_separator setting '%s'\"),\n                               partsep);\n                virStoragePoolSourceDeviceClear(&dev);\n                goto cleanup;\n            }\n        }\n\n        if (VIR_APPEND_ELEMENT(source->devices, source->ndevice, dev) < 0) {\n            virStoragePoolSourceDeviceClear(&dev);\n            goto cleanup;\n        }\n\n    }\n\n    sourcedir = virXPathString(\"string(./dir/@path)\", ctxt);\n    if (sourcedir)\n        source->dir = virFileSanitizePath(sourcedir);\n    /* In gluster, a missing dir defaults to \"/\" */\n    if (!source->dir && pool_type == VIR_STORAGE_POOL_GLUSTER)\n        source->dir = g_strdup(\"/\");\n\n    if ((adapternode = virXPathNode(\"./adapter\", ctxt))) {\n        if (virStorageAdapterParseXML(&source->adapter, adapternode, ctxt) < 0)\n            goto cleanup;\n    }\n\n    if ((authnode = virXPathNode(\"./auth\", ctxt))) {\n        if (!(authdef = virStorageAuthDefParse(authnode, ctxt)))\n            goto cleanup;\n\n        if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"storage pool missing auth type\"));\n            goto cleanup;\n        }\n\n        source->auth = g_steal_pointer(&authdef);\n    }\n\n    /* Option protocol version string (NFSvN) */\n    if ((ver = virXPathString(\"string(./protocol/@ver)\", ctxt))) {\n        if ((source->format != VIR_STORAGE_POOL_NETFS_NFS) &&\n            (source->format != VIR_STORAGE_POOL_NETFS_AUTO)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\"),\n                           virStoragePoolFormatFileSystemNetTypeToString(source->format));\n            goto cleanup;\n        }\n        if (virStrToLong_uip(ver, NULL, 0, &source->protocolVer) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"storage pool protocol ver '%s' is malformed\"),\n                           ver);\n            goto cleanup;\n        }\n    }\n\n    source->vendor = virXPathString(\"string(./vendor/@name)\", ctxt);\n    source->product = virXPathString(\"string(./product/@name)\", ctxt);\n\n    ret = 0;\n cleanup:\n    ctxt->node = relnode;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"root element was not source\")"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"root element was not source\""
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"/source\"",
            "xpath_ctxt"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "def"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLParseStringCtxt",
          "args": [
            "srcSpec",
            "_(\"(storage_source_specification)\")",
            "&xpath_ctxt"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirStoragePoolSourcePtr\nvirStoragePoolDefParseSourceString(const char *srcSpec,\n                                   int pool_type)\n{\n    g_autoptr(xmlDoc) doc = NULL;\n    xmlNodePtr node = NULL;\n    g_autoptr(xmlXPathContext) xpath_ctxt = NULL;\n    g_autoptr(virStoragePoolSource) def = NULL;\n\n    if (!(doc = virXMLParseStringCtxt(srcSpec,\n                                      _(\"(storage_source_specification)\"),\n                                      &xpath_ctxt)))\n        return NULL;\n\n    if (VIR_ALLOC(def) < 0)\n        return NULL;\n\n    if (!(node = virXPathNode(\"/source\", xpath_ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"root element was not source\"));\n        return NULL;\n    }\n\n    if (virStoragePoolDefParseSource(xpath_ctxt, def, pool_type,\n                                     node) < 0)\n        return NULL;\n\n    return g_steal_pointer(&def);\n}"
  },
  {
    "function_name": "virStoragePoolDefParseSource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "523-689",
    "snippet": "static int\nvirStoragePoolDefParseSource(xmlXPathContextPtr ctxt,\n                             virStoragePoolSourcePtr source,\n                             int pool_type,\n                             xmlNodePtr node)\n{\n    int ret = -1;\n    xmlNodePtr relnode, authnode;\n    xmlNodePtr adapternode;\n    int nsource;\n    size_t i;\n    virStoragePoolOptionsPtr options;\n    int n;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *port = NULL;\n    g_autofree char *ver = NULL;\n    g_autofree xmlNodePtr *nodeset = NULL;\n    g_autofree char *sourcedir = NULL;\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((options = virStoragePoolOptionsForPoolType(pool_type)) == NULL)\n        goto cleanup;\n\n    source->name = virXPathString(\"string(./name)\", ctxt);\n    if (pool_type == VIR_STORAGE_POOL_RBD && source->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"element 'name' is mandatory for RBD pool\"));\n        goto cleanup;\n    }\n\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./format/@type)\", ctxt);\n        if (format == NULL)\n            source->format = options->defaultFormat;\n        else\n            source->format = options->formatFromString(format);\n\n        if (source->format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown pool format type %s\"), format);\n            goto cleanup;\n        }\n    }\n\n    if ((n = virXPathNodeSet(\"./host\", ctxt, &nodeset)) < 0)\n        goto cleanup;\n\n    if (n) {\n        if (VIR_ALLOC_N(source->hosts, n) < 0)\n            goto cleanup;\n        source->nhost = n;\n\n        for (i = 0; i < source->nhost; i++) {\n            source->hosts[i].name = virXMLPropString(nodeset[i], \"name\");\n            if (!source->hosts[i].name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool host name\"));\n                goto cleanup;\n            }\n\n            port = virXMLPropString(nodeset[i], \"port\");\n            if (port) {\n                if (virStrToLong_i(port, NULL, 10, &source->hosts[i].port) < 0) {\n                    virReportError(VIR_ERR_XML_ERROR,\n                                   _(\"Invalid port number: %s\"),\n                                   port);\n                    goto cleanup;\n                }\n            }\n            VIR_FREE(port);\n        }\n    }\n\n    VIR_FREE(nodeset);\n\n    virStorageSourceInitiatorParseXML(ctxt, &source->initiator);\n\n    nsource = virXPathNodeSet(\"./device\", ctxt, &nodeset);\n    if (nsource < 0)\n        goto cleanup;\n\n    for (i = 0; i < nsource; i++) {\n        g_autofree char *partsep = NULL;\n        virStoragePoolSourceDevice dev = { .path = NULL };\n        dev.path = virXMLPropString(nodeset[i], \"path\");\n\n        if (dev.path == NULL) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device path\"));\n            goto cleanup;\n        }\n\n        partsep = virXMLPropString(nodeset[i], \"part_separator\");\n        if (partsep) {\n            dev.part_separator = virTristateBoolTypeFromString(partsep);\n            if (dev.part_separator <= 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"invalid part_separator setting '%s'\"),\n                               partsep);\n                virStoragePoolSourceDeviceClear(&dev);\n                goto cleanup;\n            }\n        }\n\n        if (VIR_APPEND_ELEMENT(source->devices, source->ndevice, dev) < 0) {\n            virStoragePoolSourceDeviceClear(&dev);\n            goto cleanup;\n        }\n\n    }\n\n    sourcedir = virXPathString(\"string(./dir/@path)\", ctxt);\n    if (sourcedir)\n        source->dir = virFileSanitizePath(sourcedir);\n    /* In gluster, a missing dir defaults to \"/\" */\n    if (!source->dir && pool_type == VIR_STORAGE_POOL_GLUSTER)\n        source->dir = g_strdup(\"/\");\n\n    if ((adapternode = virXPathNode(\"./adapter\", ctxt))) {\n        if (virStorageAdapterParseXML(&source->adapter, adapternode, ctxt) < 0)\n            goto cleanup;\n    }\n\n    if ((authnode = virXPathNode(\"./auth\", ctxt))) {\n        if (!(authdef = virStorageAuthDefParse(authnode, ctxt)))\n            goto cleanup;\n\n        if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"storage pool missing auth type\"));\n            goto cleanup;\n        }\n\n        source->auth = g_steal_pointer(&authdef);\n    }\n\n    /* Option protocol version string (NFSvN) */\n    if ((ver = virXPathString(\"string(./protocol/@ver)\", ctxt))) {\n        if ((source->format != VIR_STORAGE_POOL_NETFS_NFS) &&\n            (source->format != VIR_STORAGE_POOL_NETFS_AUTO)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\"),\n                           virStoragePoolFormatFileSystemNetTypeToString(source->format));\n            goto cleanup;\n        }\n        if (virStrToLong_uip(ver, NULL, 0, &source->protocolVer) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"storage pool protocol ver '%s' is malformed\"),\n                           ver);\n            goto cleanup;\n        }\n    }\n\n    source->vendor = virXPathString(\"string(./vendor/@name)\", ctxt);\n    source->product = virXPathString(\"string(./product/@name)\", ctxt);\n\n    ret = 0;\n cleanup:\n    ctxt->node = relnode;\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXPathString",
          "args": [
            "\"string(./product/@name)\"",
            "ctxt"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "72-96",
          "snippet": "char *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXPathString(const char *xpath,\n               xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    char *ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathString()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_STRING) ||\n        (obj->stringval == NULL) || (obj->stringval[0] == 0)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n    ret = g_strdup((char *)obj->stringval);\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"storage pool protocol ver '%s' is malformed\")",
            "ver"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"storage pool protocol ver '%s' is malformed\""
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "ver",
            "NULL",
            "0",
            "&source->protocolVer"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\")",
            "virStoragePoolFormatFileSystemNetTypeToString(source->format)"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolFormatFileSystemNetTypeToString",
          "args": [
            "source->format"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&authdef"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"storage pool missing auth type\")"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageAuthDefParse",
          "args": [
            "authnode",
            "ctxt"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAuthDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1801-1859",
          "snippet": "virStorageAuthDefPtr\nvirStorageAuthDefParse(xmlNodePtr node,\n                       xmlXPathContextPtr ctxt)\n{\n    xmlNodePtr saveNode = ctxt->node;\n    virStorageAuthDefPtr ret = NULL;\n    xmlNodePtr secretnode = NULL;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *authtype = NULL;\n\n    ctxt->node = node;\n\n    if (VIR_ALLOC(authdef) < 0)\n        goto cleanup;\n\n    if (!(authdef->username = virXPathString(\"string(./@username)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing username for auth\"));\n        goto cleanup;\n    }\n\n    authdef->authType = VIR_STORAGE_AUTH_TYPE_NONE;\n    authtype = virXPathString(\"string(./@type)\", ctxt);\n    if (authtype) {\n        /* Used by the storage pool instead of the secret type field\n         * to define whether chap or ceph being used\n         */\n        if ((authdef->authType = virStorageAuthTypeFromString(authtype)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown auth type '%s'\"), authtype);\n            goto cleanup;\n        }\n    }\n\n    if (!(secretnode = virXPathNode(\"./secret \", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Missing <secret> element in auth\"));\n        goto cleanup;\n    }\n\n    /* Used by the domain disk xml parsing in order to ensure the\n     * <secret type='%s' value matches the expected secret type for\n     * the style of disk (iscsi is chap, nbd is ceph). For some reason\n     * the virSecretUsageType{From|To}String() cannot be linked here\n     * and because only the domain parsing code cares - just keep\n     * it as a string.\n     */\n    authdef->secrettype = virXMLPropString(secretnode, \"type\");\n\n    if (virSecretLookupParseSecret(secretnode, &authdef->seclookupdef) < 0)\n        goto cleanup;\n\n    ret = g_steal_pointer(&authdef);\n\n cleanup:\n    ctxt->node = saveNode;\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvirStorageAuthDefPtr\nvirStorageAuthDefParse(xmlNodePtr node,\n                       xmlXPathContextPtr ctxt)\n{\n    xmlNodePtr saveNode = ctxt->node;\n    virStorageAuthDefPtr ret = NULL;\n    xmlNodePtr secretnode = NULL;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *authtype = NULL;\n\n    ctxt->node = node;\n\n    if (VIR_ALLOC(authdef) < 0)\n        goto cleanup;\n\n    if (!(authdef->username = virXPathString(\"string(./@username)\", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing username for auth\"));\n        goto cleanup;\n    }\n\n    authdef->authType = VIR_STORAGE_AUTH_TYPE_NONE;\n    authtype = virXPathString(\"string(./@type)\", ctxt);\n    if (authtype) {\n        /* Used by the storage pool instead of the secret type field\n         * to define whether chap or ceph being used\n         */\n        if ((authdef->authType = virStorageAuthTypeFromString(authtype)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown auth type '%s'\"), authtype);\n            goto cleanup;\n        }\n    }\n\n    if (!(secretnode = virXPathNode(\"./secret \", ctxt))) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Missing <secret> element in auth\"));\n        goto cleanup;\n    }\n\n    /* Used by the domain disk xml parsing in order to ensure the\n     * <secret type='%s' value matches the expected secret type for\n     * the style of disk (iscsi is chap, nbd is ceph). For some reason\n     * the virSecretUsageType{From|To}String() cannot be linked here\n     * and because only the domain parsing code cares - just keep\n     * it as a string.\n     */\n    authdef->secrettype = virXMLPropString(secretnode, \"type\");\n\n    if (virSecretLookupParseSecret(secretnode, &authdef->seclookupdef) < 0)\n        goto cleanup;\n\n    ret = g_steal_pointer(&authdef);\n\n cleanup:\n    ctxt->node = saveNode;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./auth\"",
            "ctxt"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterParseXML",
          "args": [
            "&source->adapter",
            "adapternode",
            "ctxt"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "175-214",
          "snippet": "int\nvirStorageAdapterParseXML(virStorageAdapterPtr adapter,\n                          xmlNodePtr node,\n                          xmlXPathContextPtr ctxt)\n{\n    int ret = -1;\n    xmlNodePtr relnode = ctxt->node;\n    char *adapter_type = NULL;\n\n    ctxt->node = node;\n\n    if ((adapter_type = virXMLPropString(node, \"type\"))) {\n        if ((adapter->type =\n             virStorageAdapterTypeFromString(adapter_type)) <= 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown pool adapter type '%s'\"),\n                           adapter_type);\n            goto cleanup;\n        }\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) &&\n            (virStorageAdapterParseXMLFCHost(node, &adapter->data.fchost)) < 0)\n                goto cleanup;\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) &&\n            (virStorageAdapterParseXMLSCSIHost(node, ctxt,\n                                               &adapter->data.scsi_host)) < 0)\n                goto cleanup;\n    } else {\n        if (virStorageAdapterParseXMLLegacy(node, ctxt, adapter) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    ctxt->node = relnode;\n    VIR_FREE(adapter_type);\n    return ret;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nint\nvirStorageAdapterParseXML(virStorageAdapterPtr adapter,\n                          xmlNodePtr node,\n                          xmlXPathContextPtr ctxt)\n{\n    int ret = -1;\n    xmlNodePtr relnode = ctxt->node;\n    char *adapter_type = NULL;\n\n    ctxt->node = node;\n\n    if ((adapter_type = virXMLPropString(node, \"type\"))) {\n        if ((adapter->type =\n             virStorageAdapterTypeFromString(adapter_type)) <= 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown pool adapter type '%s'\"),\n                           adapter_type);\n            goto cleanup;\n        }\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) &&\n            (virStorageAdapterParseXMLFCHost(node, &adapter->data.fchost)) < 0)\n                goto cleanup;\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) &&\n            (virStorageAdapterParseXMLSCSIHost(node, ctxt,\n                                               &adapter->data.scsi_host)) < 0)\n                goto cleanup;\n    } else {\n        if (virStorageAdapterParseXMLLegacy(node, ctxt, adapter) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    ctxt->node = relnode;\n    VIR_FREE(adapter_type);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"/\""
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileSanitizePath",
          "args": [
            "sourcedir"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "virFileSanitizePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3242-3290",
          "snippet": "char *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceDeviceClear",
          "args": [
            "&dev"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceDeviceClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "463-468",
          "snippet": "void\nvirStoragePoolSourceDeviceClear(virStoragePoolSourceDevicePtr dev)\n{\n    VIR_FREE(dev->freeExtents);\n    VIR_FREE(dev->path);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceDeviceClear(virStoragePoolSourceDevicePtr dev)\n{\n    VIR_FREE(dev->freeExtents);\n    VIR_FREE(dev->path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "source->devices",
            "source->ndevice",
            "dev"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"invalid part_separator setting '%s'\")",
            "partsep"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTristateBoolTypeFromString",
          "args": [
            "partsep"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "nodeset[i]",
            "\"part_separator\""
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool source device path\")"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNodeSet",
          "args": [
            "\"./device\"",
            "ctxt",
            "&nodeset"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNodeSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "647-694",
          "snippet": "int\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathNodeSet(const char *xpath,\n                xmlXPathContextPtr ctxt,\n                xmlNodePtr **list)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    int ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNodeSet()\"));\n        return -1;\n    }\n\n    if (list != NULL)\n        *list = NULL;\n\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if (obj == NULL)\n        return 0;\n\n    if (obj->type != XPATH_NODESET) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Incorrect xpath '%s'\"), xpath);\n        xmlXPathFreeObject(obj);\n        return -1;\n    }\n\n    if ((obj->nodesetval == NULL)  || (obj->nodesetval->nodeNr < 0)) {\n        xmlXPathFreeObject(obj);\n        return 0;\n    }\n\n    ret = obj->nodesetval->nodeNr;\n    if (list != NULL && ret) {\n        if (VIR_ALLOC_N(*list, ret) < 0) {\n            ret = -1;\n        } else {\n            memcpy(*list, obj->nodesetval->nodeTab,\n                   ret * sizeof(xmlNodePtr));\n        }\n    }\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceInitiatorParseXML",
          "args": [
            "ctxt",
            "&source->initiator"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceInitiatorParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "4674-4679",
          "snippet": "void\nvirStorageSourceInitiatorParseXML(xmlXPathContextPtr ctxt,\n                                  virStorageSourceInitiatorDefPtr initiator)\n{\n    initiator->iqn = virXPathString(\"string(./initiator/iqn/@name)\", ctxt);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvoid\nvirStorageSourceInitiatorParseXML(xmlXPathContextPtr ctxt,\n                                  virStorageSourceInitiatorDefPtr initiator)\n{\n    initiator->iqn = virXPathString(\"string(./initiator/iqn/@name)\", ctxt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nodeset"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "port"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"Invalid port number: %s\")",
            "port"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "port",
            "NULL",
            "10",
            "&source->hosts[i].port"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool host name\")"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "source->hosts",
            "n"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown pool format type %s\")",
            "format"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "options->formatFromString",
          "args": [
            "format"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"element 'name' is mandatory for RBD pool\")"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsForPoolType",
          "args": [
            "pool_type"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "324-331",
          "snippet": "static virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStoragePoolDefParseSource(xmlXPathContextPtr ctxt,\n                             virStoragePoolSourcePtr source,\n                             int pool_type,\n                             xmlNodePtr node)\n{\n    int ret = -1;\n    xmlNodePtr relnode, authnode;\n    xmlNodePtr adapternode;\n    int nsource;\n    size_t i;\n    virStoragePoolOptionsPtr options;\n    int n;\n    g_autoptr(virStorageAuthDef) authdef = NULL;\n    g_autofree char *port = NULL;\n    g_autofree char *ver = NULL;\n    g_autofree xmlNodePtr *nodeset = NULL;\n    g_autofree char *sourcedir = NULL;\n\n    relnode = ctxt->node;\n    ctxt->node = node;\n\n    if ((options = virStoragePoolOptionsForPoolType(pool_type)) == NULL)\n        goto cleanup;\n\n    source->name = virXPathString(\"string(./name)\", ctxt);\n    if (pool_type == VIR_STORAGE_POOL_RBD && source->name == NULL) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"element 'name' is mandatory for RBD pool\"));\n        goto cleanup;\n    }\n\n    if (options->formatFromString) {\n        g_autofree char *format = NULL;\n\n        format = virXPathString(\"string(./format/@type)\", ctxt);\n        if (format == NULL)\n            source->format = options->defaultFormat;\n        else\n            source->format = options->formatFromString(format);\n\n        if (source->format < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown pool format type %s\"), format);\n            goto cleanup;\n        }\n    }\n\n    if ((n = virXPathNodeSet(\"./host\", ctxt, &nodeset)) < 0)\n        goto cleanup;\n\n    if (n) {\n        if (VIR_ALLOC_N(source->hosts, n) < 0)\n            goto cleanup;\n        source->nhost = n;\n\n        for (i = 0; i < source->nhost; i++) {\n            source->hosts[i].name = virXMLPropString(nodeset[i], \"name\");\n            if (!source->hosts[i].name) {\n                virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                               _(\"missing storage pool host name\"));\n                goto cleanup;\n            }\n\n            port = virXMLPropString(nodeset[i], \"port\");\n            if (port) {\n                if (virStrToLong_i(port, NULL, 10, &source->hosts[i].port) < 0) {\n                    virReportError(VIR_ERR_XML_ERROR,\n                                   _(\"Invalid port number: %s\"),\n                                   port);\n                    goto cleanup;\n                }\n            }\n            VIR_FREE(port);\n        }\n    }\n\n    VIR_FREE(nodeset);\n\n    virStorageSourceInitiatorParseXML(ctxt, &source->initiator);\n\n    nsource = virXPathNodeSet(\"./device\", ctxt, &nodeset);\n    if (nsource < 0)\n        goto cleanup;\n\n    for (i = 0; i < nsource; i++) {\n        g_autofree char *partsep = NULL;\n        virStoragePoolSourceDevice dev = { .path = NULL };\n        dev.path = virXMLPropString(nodeset[i], \"path\");\n\n        if (dev.path == NULL) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"missing storage pool source device path\"));\n            goto cleanup;\n        }\n\n        partsep = virXMLPropString(nodeset[i], \"part_separator\");\n        if (partsep) {\n            dev.part_separator = virTristateBoolTypeFromString(partsep);\n            if (dev.part_separator <= 0) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"invalid part_separator setting '%s'\"),\n                               partsep);\n                virStoragePoolSourceDeviceClear(&dev);\n                goto cleanup;\n            }\n        }\n\n        if (VIR_APPEND_ELEMENT(source->devices, source->ndevice, dev) < 0) {\n            virStoragePoolSourceDeviceClear(&dev);\n            goto cleanup;\n        }\n\n    }\n\n    sourcedir = virXPathString(\"string(./dir/@path)\", ctxt);\n    if (sourcedir)\n        source->dir = virFileSanitizePath(sourcedir);\n    /* In gluster, a missing dir defaults to \"/\" */\n    if (!source->dir && pool_type == VIR_STORAGE_POOL_GLUSTER)\n        source->dir = g_strdup(\"/\");\n\n    if ((adapternode = virXPathNode(\"./adapter\", ctxt))) {\n        if (virStorageAdapterParseXML(&source->adapter, adapternode, ctxt) < 0)\n            goto cleanup;\n    }\n\n    if ((authnode = virXPathNode(\"./auth\", ctxt))) {\n        if (!(authdef = virStorageAuthDefParse(authnode, ctxt)))\n            goto cleanup;\n\n        if (authdef->authType == VIR_STORAGE_AUTH_TYPE_NONE) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"storage pool missing auth type\"));\n            goto cleanup;\n        }\n\n        source->auth = g_steal_pointer(&authdef);\n    }\n\n    /* Option protocol version string (NFSvN) */\n    if ((ver = virXPathString(\"string(./protocol/@ver)\", ctxt))) {\n        if ((source->format != VIR_STORAGE_POOL_NETFS_NFS) &&\n            (source->format != VIR_STORAGE_POOL_NETFS_AUTO)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"storage pool protocol ver unsupported for \"\n                             \"pool type '%s'\"),\n                           virStoragePoolFormatFileSystemNetTypeToString(source->format));\n            goto cleanup;\n        }\n        if (virStrToLong_uip(ver, NULL, 0, &source->protocolVer) < 0) {\n            virReportError(VIR_ERR_XML_ERROR,\n                           _(\"storage pool protocol ver '%s' is malformed\"),\n                           ver);\n            goto cleanup;\n        }\n    }\n\n    source->vendor = virXPathString(\"string(./vendor/@name)\", ctxt);\n    source->product = virXPathString(\"string(./product/@name)\", ctxt);\n\n    ret = 0;\n cleanup:\n    ctxt->node = relnode;\n\n    return ret;\n}"
  },
  {
    "function_name": "virStoragePoolDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "504-520",
    "snippet": "void\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "def->namespaceData"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->refresh"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->target.perms.label"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->target.path"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceClear",
          "args": [
            "&def->source"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "471-493",
          "snippet": "void\nvirStoragePoolSourceClear(virStoragePoolSourcePtr source)\n{\n    size_t i;\n\n    if (!source)\n        return;\n\n    for (i = 0; i < source->nhost; i++)\n        VIR_FREE(source->hosts[i].name);\n    VIR_FREE(source->hosts);\n\n    for (i = 0; i < source->ndevice; i++)\n        virStoragePoolSourceDeviceClear(&source->devices[i]);\n    VIR_FREE(source->devices);\n    VIR_FREE(source->dir);\n    VIR_FREE(source->name);\n    virStorageAdapterClear(&source->adapter);\n    virStorageSourceInitiatorClear(&source->initiator);\n    virStorageAuthDefFree(source->auth);\n    VIR_FREE(source->vendor);\n    VIR_FREE(source->product);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceClear(virStoragePoolSourcePtr source)\n{\n    size_t i;\n\n    if (!source)\n        return;\n\n    for (i = 0; i < source->nhost; i++)\n        VIR_FREE(source->hosts[i].name);\n    VIR_FREE(source->hosts);\n\n    for (i = 0; i < source->ndevice; i++)\n        virStoragePoolSourceDeviceClear(&source->devices[i]);\n    VIR_FREE(source->devices);\n    VIR_FREE(source->dir);\n    VIR_FREE(source->name);\n    virStorageAdapterClear(&source->adapter);\n    virStorageSourceInitiatorClear(&source->initiator);\n    virStorageAuthDefFree(source->auth);\n    VIR_FREE(source->vendor);\n    VIR_FREE(source->product);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->name"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolDefFree(virStoragePoolDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    virStoragePoolSourceClear(&def->source);\n\n    VIR_FREE(def->target.path);\n    VIR_FREE(def->target.perms.label);\n    VIR_FREE(def->refresh);\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virStoragePoolSourceFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "496-501",
    "snippet": "void\nvirStoragePoolSourceFree(virStoragePoolSourcePtr source)\n{\n    virStoragePoolSourceClear(source);\n    VIR_FREE(source);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceClear",
          "args": [
            "source"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "471-493",
          "snippet": "void\nvirStoragePoolSourceClear(virStoragePoolSourcePtr source)\n{\n    size_t i;\n\n    if (!source)\n        return;\n\n    for (i = 0; i < source->nhost; i++)\n        VIR_FREE(source->hosts[i].name);\n    VIR_FREE(source->hosts);\n\n    for (i = 0; i < source->ndevice; i++)\n        virStoragePoolSourceDeviceClear(&source->devices[i]);\n    VIR_FREE(source->devices);\n    VIR_FREE(source->dir);\n    VIR_FREE(source->name);\n    virStorageAdapterClear(&source->adapter);\n    virStorageSourceInitiatorClear(&source->initiator);\n    virStorageAuthDefFree(source->auth);\n    VIR_FREE(source->vendor);\n    VIR_FREE(source->product);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceClear(virStoragePoolSourcePtr source)\n{\n    size_t i;\n\n    if (!source)\n        return;\n\n    for (i = 0; i < source->nhost; i++)\n        VIR_FREE(source->hosts[i].name);\n    VIR_FREE(source->hosts);\n\n    for (i = 0; i < source->ndevice; i++)\n        virStoragePoolSourceDeviceClear(&source->devices[i]);\n    VIR_FREE(source->devices);\n    VIR_FREE(source->dir);\n    VIR_FREE(source->name);\n    virStorageAdapterClear(&source->adapter);\n    virStorageSourceInitiatorClear(&source->initiator);\n    virStorageAuthDefFree(source->auth);\n    VIR_FREE(source->vendor);\n    VIR_FREE(source->product);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceFree(virStoragePoolSourcePtr source)\n{\n    virStoragePoolSourceClear(source);\n    VIR_FREE(source);\n}"
  },
  {
    "function_name": "virStoragePoolSourceClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "471-493",
    "snippet": "void\nvirStoragePoolSourceClear(virStoragePoolSourcePtr source)\n{\n    size_t i;\n\n    if (!source)\n        return;\n\n    for (i = 0; i < source->nhost; i++)\n        VIR_FREE(source->hosts[i].name);\n    VIR_FREE(source->hosts);\n\n    for (i = 0; i < source->ndevice; i++)\n        virStoragePoolSourceDeviceClear(&source->devices[i]);\n    VIR_FREE(source->devices);\n    VIR_FREE(source->dir);\n    VIR_FREE(source->name);\n    virStorageAdapterClear(&source->adapter);\n    virStorageSourceInitiatorClear(&source->initiator);\n    virStorageAuthDefFree(source->auth);\n    VIR_FREE(source->vendor);\n    VIR_FREE(source->product);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->product"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->vendor"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageAuthDefFree",
          "args": [
            "source->auth"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAuthDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "1769-1779",
          "snippet": "void\nvirStorageAuthDefFree(virStorageAuthDefPtr authdef)\n{\n    if (!authdef)\n        return;\n\n    VIR_FREE(authdef->username);\n    VIR_FREE(authdef->secrettype);\n    virSecretLookupDefClear(&authdef->seclookupdef);\n    VIR_FREE(authdef);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvoid\nvirStorageAuthDefFree(virStorageAuthDefPtr authdef)\n{\n    if (!authdef)\n        return;\n\n    VIR_FREE(authdef->username);\n    VIR_FREE(authdef->secrettype);\n    virSecretLookupDefClear(&authdef->seclookupdef);\n    VIR_FREE(authdef);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceInitiatorClear",
          "args": [
            "&source->initiator"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceInitiatorClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "4703-4707",
          "snippet": "void\nvirStorageSourceInitiatorClear(virStorageSourceInitiatorDefPtr initiator)\n{\n    VIR_FREE(initiator->iqn);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvoid\nvirStorageSourceInitiatorClear(virStorageSourceInitiatorDefPtr initiator)\n{\n    VIR_FREE(initiator->iqn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterClear",
          "args": [
            "&source->adapter"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "52-60",
          "snippet": "void\nvirStorageAdapterClear(virStorageAdapterPtr adapter)\n{\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterClearFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        VIR_FREE(adapter->data.scsi_host.name);\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nvoid\nvirStorageAdapterClear(virStorageAdapterPtr adapter)\n{\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterClearFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        VIR_FREE(adapter->data.scsi_host.name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->name"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->dir"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->devices"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolSourceDeviceClear",
          "args": [
            "&source->devices[i]"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolSourceDeviceClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "463-468",
          "snippet": "void\nvirStoragePoolSourceDeviceClear(virStoragePoolSourceDevicePtr dev)\n{\n    VIR_FREE(dev->freeExtents);\n    VIR_FREE(dev->path);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceDeviceClear(virStoragePoolSourceDevicePtr dev)\n{\n    VIR_FREE(dev->freeExtents);\n    VIR_FREE(dev->path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->hosts"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "source->hosts[i].name"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceClear(virStoragePoolSourcePtr source)\n{\n    size_t i;\n\n    if (!source)\n        return;\n\n    for (i = 0; i < source->nhost; i++)\n        VIR_FREE(source->hosts[i].name);\n    VIR_FREE(source->hosts);\n\n    for (i = 0; i < source->ndevice; i++)\n        virStoragePoolSourceDeviceClear(&source->devices[i]);\n    VIR_FREE(source->devices);\n    VIR_FREE(source->dir);\n    VIR_FREE(source->name);\n    virStorageAdapterClear(&source->adapter);\n    virStorageSourceInitiatorClear(&source->initiator);\n    virStorageAuthDefFree(source->auth);\n    VIR_FREE(source->vendor);\n    VIR_FREE(source->product);\n}"
  },
  {
    "function_name": "virStoragePoolSourceDeviceClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "463-468",
    "snippet": "void\nvirStoragePoolSourceDeviceClear(virStoragePoolSourceDevicePtr dev)\n{\n    VIR_FREE(dev->freeExtents);\n    VIR_FREE(dev->path);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->path"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev->freeExtents"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStoragePoolSourceDeviceClear(virStoragePoolSourceDevicePtr dev)\n{\n    VIR_FREE(dev->freeExtents);\n    VIR_FREE(dev->path);\n}"
  },
  {
    "function_name": "virStorageVolDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "443-460",
    "snippet": "void\nvirStorageVolDefFree(virStorageVolDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->key);\n\n    for (i = 0; i < def->source.nextent; i++)\n        VIR_FREE(def->source.extents[i].path);\n    VIR_FREE(def->source.extents);\n\n    virStorageSourceClear(&def->target);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceClear",
          "args": [
            "&def->target"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2672-2719",
          "snippet": "void\nvirStorageSourceClear(virStorageSourcePtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->path);\n    VIR_FREE(def->volume);\n    VIR_FREE(def->snapshot);\n    VIR_FREE(def->configFile);\n    virStorageSourceNetCookiesClear(def);\n    virStorageSourcePoolDefFree(def->srcpool);\n    virBitmapFree(def->features);\n    VIR_FREE(def->compat);\n    virStorageEncryptionFree(def->encryption);\n    virStoragePRDefFree(def->pr);\n    virStorageSourceNVMeDefFree(def->nvme);\n    virStorageSourceSeclabelsClear(def);\n    virStoragePermsFree(def->perms);\n    VIR_FREE(def->timestamps);\n    VIR_FREE(def->externalDataStoreRaw);\n\n    virStorageSourceSliceFree(def->sliceStorage);\n\n    virObjectUnref(def->externalDataStore);\n    def->externalDataStore = NULL;\n\n    virStorageNetHostDefFree(def->nhosts, def->hosts);\n    virStorageAuthDefFree(def->auth);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def->nodestorage);\n    VIR_FREE(def->nodeformat);\n\n    virStorageSourceBackingStoreClear(def);\n\n    VIR_FREE(def->tlsAlias);\n    VIR_FREE(def->tlsCertdir);\n\n    VIR_FREE(def->ssh_user);\n\n    virStorageSourceInitiatorClear(&def->initiator);\n\n    /* clear everything except the class header as the object APIs\n     * will break otherwise */\n    memset((char *) def + sizeof(def->parent), 0,\n           sizeof(*def) - sizeof(def->parent));\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nvoid\nvirStorageSourceClear(virStorageSourcePtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->path);\n    VIR_FREE(def->volume);\n    VIR_FREE(def->snapshot);\n    VIR_FREE(def->configFile);\n    virStorageSourceNetCookiesClear(def);\n    virStorageSourcePoolDefFree(def->srcpool);\n    virBitmapFree(def->features);\n    VIR_FREE(def->compat);\n    virStorageEncryptionFree(def->encryption);\n    virStoragePRDefFree(def->pr);\n    virStorageSourceNVMeDefFree(def->nvme);\n    virStorageSourceSeclabelsClear(def);\n    virStoragePermsFree(def->perms);\n    VIR_FREE(def->timestamps);\n    VIR_FREE(def->externalDataStoreRaw);\n\n    virStorageSourceSliceFree(def->sliceStorage);\n\n    virObjectUnref(def->externalDataStore);\n    def->externalDataStore = NULL;\n\n    virStorageNetHostDefFree(def->nhosts, def->hosts);\n    virStorageAuthDefFree(def->auth);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def->nodestorage);\n    VIR_FREE(def->nodeformat);\n\n    virStorageSourceBackingStoreClear(def);\n\n    VIR_FREE(def->tlsAlias);\n    VIR_FREE(def->tlsCertdir);\n\n    VIR_FREE(def->ssh_user);\n\n    virStorageSourceInitiatorClear(&def->initiator);\n\n    /* clear everything except the class header as the object APIs\n     * will break otherwise */\n    memset((char *) def + sizeof(def->parent), 0,\n           sizeof(*def) - sizeof(def->parent));\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->source.extents"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->source.extents[i].path"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->key"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->name"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirStorageVolDefFree(virStorageVolDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->key);\n\n    for (i = 0; i < def->source.nextent; i++)\n        VIR_FREE(def->source.extents[i].path);\n    VIR_FREE(def->source.extents);\n\n    virStorageSourceClear(&def->target);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virStoragePoolOptionsFormatVolume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "407-440",
    "snippet": "int\nvirStoragePoolOptionsFormatVolume(virBufferPtr buf,\n                                  int type)\n{\n    size_t i;\n    virStorageVolOptionsPtr volOptions;\n\n    if (!(volOptions = virStorageVolOptionsForPoolType(type)))\n        return -1;\n\n    if (!volOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<volOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                      (volOptions->formatToString)(volOptions->defaultFormat));\n\n    virBufferAddLit(buf, \"<enum name='targetFormatType'>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < volOptions->lastFormat; i++)\n        virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                          (volOptions->formatToString)(i));\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</enum>\\n\");\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</volOptions>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</volOptions>\\n\""
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</enum>\\n\""
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<value>%s</value>\\n\"",
            "(volOptions->formatToString)(i)"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "i"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<enum name='targetFormatType'>\\n\""
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "volOptions->defaultFormat"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<volOptions>\\n\""
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageVolOptionsForPoolType",
          "args": [
            "type"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageVolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "359-366",
          "snippet": "static virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolOptionsFormatVolume(virBufferPtr buf,\n                                  int type)\n{\n    size_t i;\n    virStorageVolOptionsPtr volOptions;\n\n    if (!(volOptions = virStorageVolOptionsForPoolType(type)))\n        return -1;\n\n    if (!volOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<volOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                      (volOptions->formatToString)(volOptions->defaultFormat));\n\n    virBufferAddLit(buf, \"<enum name='targetFormatType'>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < volOptions->lastFormat; i++)\n        virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                          (volOptions->formatToString)(i));\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</enum>\\n\");\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</volOptions>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolOptionsFormatPool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "369-404",
    "snippet": "int\nvirStoragePoolOptionsFormatPool(virBufferPtr buf,\n                                int type)\n{\n    virStoragePoolOptionsPtr poolOptions;\n\n    if (!(poolOptions = virStoragePoolOptionsForPoolType(type)))\n        return -1;\n\n    if (!poolOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<poolOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (poolOptions->formatToString) {\n        size_t i;\n\n        virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                          (poolOptions->formatToString)(poolOptions->defaultFormat));\n\n        virBufferAddLit(buf, \"<enum name='sourceFormatType'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        for (i = 0; i < poolOptions->lastFormat; i++)\n            virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                              (poolOptions->formatToString)(i));\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</enum>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</poolOptions>\\n\");\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</poolOptions>\\n\""
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</enum>\\n\""
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<value>%s</value>\\n\"",
            "(poolOptions->formatToString)(i)"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "i"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<enum name='sourceFormatType'>\\n\""
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "poolOptions->defaultFormat"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<poolOptions>\\n\""
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolOptionsForPoolType",
          "args": [
            "type"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolOptionsForPoolType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "324-331",
          "snippet": "static virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolOptionsFormatPool(virBufferPtr buf,\n                                int type)\n{\n    virStoragePoolOptionsPtr poolOptions;\n\n    if (!(poolOptions = virStoragePoolOptionsForPoolType(type)))\n        return -1;\n\n    if (!poolOptions->formatToString)\n        return 0;\n\n    virBufferAddLit(buf, \"<poolOptions>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (poolOptions->formatToString) {\n        size_t i;\n\n        virBufferAsprintf(buf, \"<defaultFormat type='%s'/>\\n\",\n                          (poolOptions->formatToString)(poolOptions->defaultFormat));\n\n        virBufferAddLit(buf, \"<enum name='sourceFormatType'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        for (i = 0; i < poolOptions->lastFormat; i++)\n            virBufferAsprintf(buf, \"<value>%s</value>\\n\",\n                              (poolOptions->formatToString)(i));\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</enum>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</poolOptions>\\n\");\n    return 0;\n}"
  },
  {
    "function_name": "virStorageVolOptionsForPoolType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "359-366",
    "snippet": "static virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolTypeInfoLookup",
          "args": [
            "type"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolTypeInfoLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "310-321",
          "snippet": "static virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};\n\nstatic virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStorageVolOptionsPtr\nvirStorageVolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->volOptions;\n}"
  },
  {
    "function_name": "virStoragePoolOptionsPoolTypeSetXMLNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "344-356",
    "snippet": "int\nvirStoragePoolOptionsPoolTypeSetXMLNamespace(int type,\n                                             virXMLNamespacePtr ns)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n\n    if (!backend)\n        return -1;\n\n    backend->poolOptions.ns = *ns;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolTypeInfoLookup",
          "args": [
            "type"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolTypeInfoLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "310-321",
          "snippet": "static virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};\n\nstatic virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirStoragePoolOptionsPoolTypeSetXMLNamespace(int type,\n                                             virXMLNamespacePtr ns)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n\n    if (!backend)\n        return -1;\n\n    backend->poolOptions.ns = *ns;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStoragePoolOptionsForPoolType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "324-331",
    "snippet": "static virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStoragePoolTypeInfoLookup",
          "args": [
            "type"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "virStoragePoolTypeInfoLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
          "lines": "310-321",
          "snippet": "static virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virvhba.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virscsihost.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"storage_adapter_conf.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};\n\nstatic virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolOptionsPtr\nvirStoragePoolOptionsForPoolType(int type)\n{\n    virStoragePoolTypeInfoPtr backend = virStoragePoolTypeInfoLookup(type);\n    if (backend == NULL)\n        return NULL;\n    return &backend->poolOptions;\n}"
  },
  {
    "function_name": "virStoragePoolTypeInfoLookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "310-321",
    "snippet": "static virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"missing backend for pool type %d\")",
            "type"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing backend for pool type %d\""
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "poolTypeInfo"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virStoragePoolTypeInfo poolTypeInfo[] = {\n    {.poolType = VIR_STORAGE_POOL_LOGICAL,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_LOGICAL_LVM2,\n         .lastFormat = VIR_STORAGE_POOL_LOGICAL_LAST,\n         .formatFromString = virStoragePoolFormatLogicalTypeFromString,\n         .formatToString = virStoragePoolFormatLogicalTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_DIR,\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_FS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_FS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_FS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_NETFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n         .defaultFormat = VIR_STORAGE_POOL_NETFS_AUTO,\n         .lastFormat = VIR_STORAGE_POOL_NETFS_LAST,\n         .formatFromString = virStoragePoolFormatFileSystemNetTypeFromString,\n         .formatToString = virStoragePoolFormatFileSystemNetTypeToString,\n      },\n      .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatFromString = virStorageVolumeFormatFromString,\n         .formatToString = virStorageFileFormatTypeToString,\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_ISCSI_DIRECT,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_INITIATOR_IQN),\n      },\n    },\n    {.poolType = VIR_STORAGE_POOL_SCSI,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_ADAPTER),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_RBD,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n      },\n      .volOptions = {\n          .defaultFormat = VIR_STORAGE_FILE_RAW,\n          .formatFromString = virStorageVolumeFormatFromString,\n          .formatToString = virStorageFileFormatTypeToString,\n      }\n    },\n    {.poolType = VIR_STORAGE_POOL_SHEEPDOG,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_GLUSTER,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_HOST |\n                   VIR_STORAGE_POOL_SOURCE_NETWORK |\n                   VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DIR),\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_FILE_RAW,\n         .lastFormat = VIR_STORAGE_FILE_LAST,\n         .formatToString = virStorageFileFormatTypeToString,\n         .formatFromString = virStorageVolumeFormatFromString,\n     }\n    },\n    {.poolType = VIR_STORAGE_POOL_MPATH,\n    },\n    {.poolType = VIR_STORAGE_POOL_DISK,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_DEVICE),\n         .defaultFormat = VIR_STORAGE_POOL_DISK_UNKNOWN,\n         .lastFormat = VIR_STORAGE_POOL_DISK_LAST,\n         .formatFromString = virStoragePoolFormatDiskTypeFromString,\n         .formatToString = virStoragePoolFormatDiskTypeToString,\n     },\n     .volOptions = {\n         .defaultFormat = VIR_STORAGE_VOL_DISK_NONE,\n         .lastFormat = VIR_STORAGE_VOL_DISK_LAST,\n         .formatFromString = virStorageVolFormatDiskTypeFromString,\n         .formatToString = virStorageVolFormatDiskTypeToString,\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_ZFS,\n     .poolOptions = {\n         .flags = (VIR_STORAGE_POOL_SOURCE_NAME |\n                   VIR_STORAGE_POOL_SOURCE_DEVICE),\n     },\n    },\n    {.poolType = VIR_STORAGE_POOL_VSTORAGE,\n     .poolOptions = {\n        .flags = VIR_STORAGE_POOL_SOURCE_NAME,\n     },\n     .volOptions = {\n        .defaultFormat = VIR_STORAGE_FILE_RAW,\n        .lastFormat = VIR_STORAGE_FILE_LAST,\n        .formatFromString = virStorageVolumeFormatFromString,\n        .formatToString = virStorageFileFormatTypeToString,\n     },\n    },\n};\n\nstatic virStoragePoolTypeInfoPtr\nvirStoragePoolTypeInfoLookup(int type)\n{\n    size_t i;\n    for (i = 0; i < G_N_ELEMENTS(poolTypeInfo); i++)\n        if (poolTypeInfo[i].poolType == type)\n            return &poolTypeInfo[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d\"), type);\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageVolumeFormatFromString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_conf.c",
    "lines": "160-167",
    "snippet": "static int\nvirStorageVolumeFormatFromString(const char *format)\n{\n    int ret = virStorageFileFormatTypeFromString(format);\n    if (ret == VIR_STORAGE_FILE_NONE)\n        return -1;\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virvhba.h\"",
      "#include \"virlog.h\"",
      "#include \"virstring.h\"",
      "#include \"virscsihost.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"virxml.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"storage_conf.h\"",
      "#include \"storage_adapter_conf.h\"",
      "#include \"node_device_conf.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeFromString",
          "args": [
            "format"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virvhba.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virscsihost.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"storage_adapter_conf.h\"\n#include \"node_device_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirStorageVolumeFormatFromString(const char *format)\n{\n    int ret = virStorageFileFormatTypeFromString(format);\n    if (ret == VIR_STORAGE_FILE_NONE)\n        return -1;\n    return ret;\n}"
  }
]