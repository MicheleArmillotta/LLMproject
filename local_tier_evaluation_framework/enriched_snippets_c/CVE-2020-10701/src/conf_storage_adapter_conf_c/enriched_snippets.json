[
  {
    "function_name": "virStorageAdapterFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "339-351",
    "snippet": "void\nvirStorageAdapterFormat(virBufferPtr buf,\n                        virStorageAdapterPtr adapter)\n{\n    virBufferAsprintf(buf, \"<adapter type='%s'\",\n                      virStorageAdapterTypeToString(adapter->type));\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterFormatFCHost(buf, &adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        virStorageAdapterFormatSCSIHost(buf, &adapter->data.scsi_host);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageAdapterFormatSCSIHost",
          "args": [
            "buf",
            "&adapter->data.scsi_host"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterFormatSCSIHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "317-336",
          "snippet": "static void\nvirStorageAdapterFormatSCSIHost(virBufferPtr buf,\n                                virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (scsi_host->name) {\n        virBufferAsprintf(buf, \" name='%s'/>\\n\", scsi_host->name);\n    } else {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<parentaddr unique_id='%d'>\\n\",\n                          scsi_host->unique_id);\n        virBufferAdjustIndent(buf, 2);\n        virPCIDeviceAddressFormat(buf, scsi_host->parentaddr,\n                                  false);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parentaddr>\\n\");\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</adapter>\\n\");\n    }\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic void\nvirStorageAdapterFormatSCSIHost(virBufferPtr buf,\n                                virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (scsi_host->name) {\n        virBufferAsprintf(buf, \" name='%s'/>\\n\", scsi_host->name);\n    } else {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<parentaddr unique_id='%d'>\\n\",\n                          scsi_host->unique_id);\n        virBufferAdjustIndent(buf, 2);\n        virPCIDeviceAddressFormat(buf, scsi_host->parentaddr,\n                                  false);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parentaddr>\\n\");\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</adapter>\\n\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterFormatFCHost",
          "args": [
            "buf",
            "&adapter->data.fchost"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterFormatFCHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "299-314",
          "snippet": "static void\nvirStorageAdapterFormatFCHost(virBufferPtr buf,\n                              virStorageAdapterFCHostPtr fchost)\n{\n    virBufferEscapeString(buf, \" parent='%s'\", fchost->parent);\n    virBufferEscapeString(buf, \" parent_wwnn='%s'\", fchost->parent_wwnn);\n    virBufferEscapeString(buf, \" parent_wwpn='%s'\", fchost->parent_wwpn);\n    virBufferEscapeString(buf, \" parent_fabric_wwn='%s'\",\n                          fchost->parent_fabric_wwn);\n    if (fchost->managed != VIR_TRISTATE_BOOL_ABSENT)\n        virBufferAsprintf(buf, \" managed='%s'\",\n                          virTristateBoolTypeToString(fchost->managed));\n\n    virBufferAsprintf(buf, \" wwnn='%s' wwpn='%s'/>\\n\",\n                      fchost->wwnn, fchost->wwpn);\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic void\nvirStorageAdapterFormatFCHost(virBufferPtr buf,\n                              virStorageAdapterFCHostPtr fchost)\n{\n    virBufferEscapeString(buf, \" parent='%s'\", fchost->parent);\n    virBufferEscapeString(buf, \" parent_wwnn='%s'\", fchost->parent_wwnn);\n    virBufferEscapeString(buf, \" parent_wwpn='%s'\", fchost->parent_wwpn);\n    virBufferEscapeString(buf, \" parent_fabric_wwn='%s'\",\n                          fchost->parent_fabric_wwn);\n    if (fchost->managed != VIR_TRISTATE_BOOL_ABSENT)\n        virBufferAsprintf(buf, \" managed='%s'\",\n                          virTristateBoolTypeToString(fchost->managed));\n\n    virBufferAsprintf(buf, \" wwnn='%s' wwpn='%s'/>\\n\",\n                      fchost->wwnn, fchost->wwpn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<adapter type='%s'\"",
            "virStorageAdapterTypeToString(adapter->type)"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterTypeToString",
          "args": [
            "adapter->type"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nvoid\nvirStorageAdapterFormat(virBufferPtr buf,\n                        virStorageAdapterPtr adapter)\n{\n    virBufferAsprintf(buf, \"<adapter type='%s'\",\n                      virStorageAdapterTypeToString(adapter->type));\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterFormatFCHost(buf, &adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        virStorageAdapterFormatSCSIHost(buf, &adapter->data.scsi_host);\n}"
  },
  {
    "function_name": "virStorageAdapterFormatSCSIHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "317-336",
    "snippet": "static void\nvirStorageAdapterFormatSCSIHost(virBufferPtr buf,\n                                virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (scsi_host->name) {\n        virBufferAsprintf(buf, \" name='%s'/>\\n\", scsi_host->name);\n    } else {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<parentaddr unique_id='%d'>\\n\",\n                          scsi_host->unique_id);\n        virBufferAdjustIndent(buf, 2);\n        virPCIDeviceAddressFormat(buf, scsi_host->parentaddr,\n                                  false);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parentaddr>\\n\");\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</adapter>\\n\");\n    }\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</adapter>\\n\""
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</parentaddr>\\n\""
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressFormat",
          "args": [
            "buf",
            "scsi_host->parentaddr",
            "false"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "293-305",
          "snippet": "void\nvirPCIDeviceAddressFormat(virBufferPtr buf,\n                          virPCIDeviceAddress addr,\n                          bool includeTypeInAddr)\n{\n    virBufferAsprintf(buf, \"<address %sdomain='0x%04x' bus='0x%02x' \"\n                      \"slot='0x%02x' function='0x%d'/>\\n\",\n                      includeTypeInAddr ? \"type='pci' \" : \"\",\n                      addr.domain,\n                      addr.bus,\n                      addr.slot,\n                      addr.function);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirPCIDeviceAddressFormat(virBufferPtr buf,\n                          virPCIDeviceAddress addr,\n                          bool includeTypeInAddr)\n{\n    virBufferAsprintf(buf, \"<address %sdomain='0x%04x' bus='0x%02x' \"\n                      \"slot='0x%02x' function='0x%d'/>\\n\",\n                      includeTypeInAddr ? \"type='pci' \" : \"\",\n                      addr.domain,\n                      addr.bus,\n                      addr.slot,\n                      addr.function);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<parentaddr unique_id='%d'>\\n\"",
            "scsi_host->unique_id"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic void\nvirStorageAdapterFormatSCSIHost(virBufferPtr buf,\n                                virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (scsi_host->name) {\n        virBufferAsprintf(buf, \" name='%s'/>\\n\", scsi_host->name);\n    } else {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<parentaddr unique_id='%d'>\\n\",\n                          scsi_host->unique_id);\n        virBufferAdjustIndent(buf, 2);\n        virPCIDeviceAddressFormat(buf, scsi_host->parentaddr,\n                                  false);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</parentaddr>\\n\");\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</adapter>\\n\");\n    }\n}"
  },
  {
    "function_name": "virStorageAdapterFormatFCHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "299-314",
    "snippet": "static void\nvirStorageAdapterFormatFCHost(virBufferPtr buf,\n                              virStorageAdapterFCHostPtr fchost)\n{\n    virBufferEscapeString(buf, \" parent='%s'\", fchost->parent);\n    virBufferEscapeString(buf, \" parent_wwnn='%s'\", fchost->parent_wwnn);\n    virBufferEscapeString(buf, \" parent_wwpn='%s'\", fchost->parent_wwpn);\n    virBufferEscapeString(buf, \" parent_fabric_wwn='%s'\",\n                          fchost->parent_fabric_wwn);\n    if (fchost->managed != VIR_TRISTATE_BOOL_ABSENT)\n        virBufferAsprintf(buf, \" managed='%s'\",\n                          virTristateBoolTypeToString(fchost->managed));\n\n    virBufferAsprintf(buf, \" wwnn='%s' wwpn='%s'/>\\n\",\n                      fchost->wwnn, fchost->wwpn);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\" wwnn='%s' wwpn='%s'/>\\n\"",
            "fchost->wwnn",
            "fchost->wwpn"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTristateBoolTypeToString",
          "args": [
            "fchost->managed"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\" parent_fabric_wwn='%s'\"",
            "fchost->parent_fabric_wwn"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic void\nvirStorageAdapterFormatFCHost(virBufferPtr buf,\n                              virStorageAdapterFCHostPtr fchost)\n{\n    virBufferEscapeString(buf, \" parent='%s'\", fchost->parent);\n    virBufferEscapeString(buf, \" parent_wwnn='%s'\", fchost->parent_wwnn);\n    virBufferEscapeString(buf, \" parent_wwpn='%s'\", fchost->parent_wwpn);\n    virBufferEscapeString(buf, \" parent_fabric_wwn='%s'\",\n                          fchost->parent_fabric_wwn);\n    if (fchost->managed != VIR_TRISTATE_BOOL_ABSENT)\n        virBufferAsprintf(buf, \" managed='%s'\",\n                          virTristateBoolTypeToString(fchost->managed));\n\n    virBufferAsprintf(buf, \" wwnn='%s' wwpn='%s'/>\\n\",\n                      fchost->wwnn, fchost->wwpn);\n}"
  },
  {
    "function_name": "virStorageAdapterValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "280-296",
    "snippet": "int\nvirStorageAdapterValidate(virStorageAdapterPtr adapter)\n{\n    if (!adapter->type) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing storage pool source adapter\"));\n        return -1;\n    }\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        return virStorageAdapterValidateFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        return virStorageAdapterValidateSCSIHost(&adapter->data.scsi_host);\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStorageAdapterValidateSCSIHost",
          "args": [
            "&adapter->data.scsi_host"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterValidateSCSIHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "259-277",
          "snippet": "static int\nvirStorageAdapterValidateSCSIHost(virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (!scsi_host->name && !scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Either 'name' or 'parent' must be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    if (scsi_host->name && scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Both 'name' and 'parent' cannot be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterValidateSCSIHost(virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (!scsi_host->name && !scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Either 'name' or 'parent' must be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    if (scsi_host->name && scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Both 'name' and 'parent' cannot be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterValidateFCHost",
          "args": [
            "&adapter->data.fchost"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterValidateFCHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "217-256",
          "snippet": "static int\nvirStorageAdapterValidateFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    if (!fchost->wwnn || !fchost->wwpn) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"'wwnn' and 'wwpn' must be specified for adapter \"\n                         \"type 'fchost'\"));\n        return -1;\n    }\n\n    if (!virValidateWWN(fchost->wwnn) || !virValidateWWN(fchost->wwpn))\n        return -1;\n\n    if ((fchost->parent_wwnn && !fchost->parent_wwpn)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwnn='%s', the \"\n                         \"parent_wwpn must also be provided\"),\n                       fchost->parent_wwnn);\n        return -1;\n    }\n\n    if (!fchost->parent_wwnn && fchost->parent_wwpn) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwpn='%s', the \"\n                         \"parent_wwnn must also be provided\"),\n                       fchost->parent_wwpn);\n        return -1;\n    }\n\n    if (fchost->parent_wwnn && !virValidateWWN(fchost->parent_wwnn))\n        return -1;\n\n    if (fchost->parent_wwpn && !virValidateWWN(fchost->parent_wwpn))\n        return -1;\n\n    if (fchost->parent_fabric_wwn && !virValidateWWN(fchost->parent_fabric_wwn))\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterValidateFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    if (!fchost->wwnn || !fchost->wwpn) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"'wwnn' and 'wwpn' must be specified for adapter \"\n                         \"type 'fchost'\"));\n        return -1;\n    }\n\n    if (!virValidateWWN(fchost->wwnn) || !virValidateWWN(fchost->wwpn))\n        return -1;\n\n    if ((fchost->parent_wwnn && !fchost->parent_wwpn)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwnn='%s', the \"\n                         \"parent_wwpn must also be provided\"),\n                       fchost->parent_wwnn);\n        return -1;\n    }\n\n    if (!fchost->parent_wwnn && fchost->parent_wwpn) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwpn='%s', the \"\n                         \"parent_wwnn must also be provided\"),\n                       fchost->parent_wwpn);\n        return -1;\n    }\n\n    if (fchost->parent_wwnn && !virValidateWWN(fchost->parent_wwnn))\n        return -1;\n\n    if (fchost->parent_wwpn && !virValidateWWN(fchost->parent_wwpn))\n        return -1;\n\n    if (fchost->parent_fabric_wwn && !virValidateWWN(fchost->parent_fabric_wwn))\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"missing storage pool source adapter\")"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing storage pool source adapter\""
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nint\nvirStorageAdapterValidate(virStorageAdapterPtr adapter)\n{\n    if (!adapter->type) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"missing storage pool source adapter\"));\n        return -1;\n    }\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        return virStorageAdapterValidateFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        return virStorageAdapterValidateSCSIHost(&adapter->data.scsi_host);\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageAdapterValidateSCSIHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "259-277",
    "snippet": "static int\nvirStorageAdapterValidateSCSIHost(virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (!scsi_host->name && !scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Either 'name' or 'parent' must be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    if (scsi_host->name && scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Both 'name' and 'parent' cannot be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"Both 'name' and 'parent' cannot be specified \"\n                         \"for the 'scsi_host' adapter\")"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Both 'name' and 'parent' cannot be specified \"\n                         \"for the 'scsi_host' adapter\""
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"Either 'name' or 'parent' must be specified \"\n                         \"for the 'scsi_host' adapter\")"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterValidateSCSIHost(virStorageAdapterSCSIHostPtr scsi_host)\n{\n    if (!scsi_host->name && !scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Either 'name' or 'parent' must be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    if (scsi_host->name && scsi_host->has_parent) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Both 'name' and 'parent' cannot be specified \"\n                         \"for the 'scsi_host' adapter\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageAdapterValidateFCHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "217-256",
    "snippet": "static int\nvirStorageAdapterValidateFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    if (!fchost->wwnn || !fchost->wwpn) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"'wwnn' and 'wwpn' must be specified for adapter \"\n                         \"type 'fchost'\"));\n        return -1;\n    }\n\n    if (!virValidateWWN(fchost->wwnn) || !virValidateWWN(fchost->wwpn))\n        return -1;\n\n    if ((fchost->parent_wwnn && !fchost->parent_wwpn)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwnn='%s', the \"\n                         \"parent_wwpn must also be provided\"),\n                       fchost->parent_wwnn);\n        return -1;\n    }\n\n    if (!fchost->parent_wwnn && fchost->parent_wwpn) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwpn='%s', the \"\n                         \"parent_wwnn must also be provided\"),\n                       fchost->parent_wwpn);\n        return -1;\n    }\n\n    if (fchost->parent_wwnn && !virValidateWWN(fchost->parent_wwnn))\n        return -1;\n\n    if (fchost->parent_wwpn && !virValidateWWN(fchost->parent_wwpn))\n        return -1;\n\n    if (fchost->parent_fabric_wwn && !virValidateWWN(fchost->parent_fabric_wwn))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virValidateWWN",
          "args": [
            "fchost->parent_fabric_wwn"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virValidateWWN",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1363-1384",
          "snippet": "bool\nvirValidateWWN(const char *wwn)\n{\n    size_t i;\n    const char *p = wwn;\n\n    if (STRPREFIX(wwn, \"0x\"))\n        p += 2;\n\n    for (i = 0; p[i]; i++) {\n        if (!g_ascii_isxdigit(p[i]))\n            break;\n    }\n\n    if (i != 16 || p[i]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Malformed wwn: %s\"), wwn);\n        return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirValidateWWN(const char *wwn)\n{\n    size_t i;\n    const char *p = wwn;\n\n    if (STRPREFIX(wwn, \"0x\"))\n        p += 2;\n\n    for (i = 0; p[i]; i++) {\n        if (!g_ascii_isxdigit(p[i]))\n            break;\n    }\n\n    if (i != 16 || p[i]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Malformed wwn: %s\"), wwn);\n        return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"when providing parent_wwpn='%s', the \"\n                         \"parent_wwnn must also be provided\")",
            "fchost->parent_wwpn"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"when providing parent_wwpn='%s', the \"\n                         \"parent_wwnn must also be provided\""
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "_(\"when providing parent_wwnn='%s', the \"\n                         \"parent_wwpn must also be provided\")",
            "fchost->parent_wwnn"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"'wwnn' and 'wwpn' must be specified for adapter \"\n                         \"type 'fchost'\")"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterValidateFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    if (!fchost->wwnn || !fchost->wwpn) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"'wwnn' and 'wwpn' must be specified for adapter \"\n                         \"type 'fchost'\"));\n        return -1;\n    }\n\n    if (!virValidateWWN(fchost->wwnn) || !virValidateWWN(fchost->wwpn))\n        return -1;\n\n    if ((fchost->parent_wwnn && !fchost->parent_wwpn)) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwnn='%s', the \"\n                         \"parent_wwpn must also be provided\"),\n                       fchost->parent_wwnn);\n        return -1;\n    }\n\n    if (!fchost->parent_wwnn && fchost->parent_wwpn) {\n        virReportError(VIR_ERR_XML_ERROR,\n                       _(\"when providing parent_wwpn='%s', the \"\n                         \"parent_wwnn must also be provided\"),\n                       fchost->parent_wwpn);\n        return -1;\n    }\n\n    if (fchost->parent_wwnn && !virValidateWWN(fchost->parent_wwnn))\n        return -1;\n\n    if (fchost->parent_wwpn && !virValidateWWN(fchost->parent_wwpn))\n        return -1;\n\n    if (fchost->parent_fabric_wwn && !virValidateWWN(fchost->parent_fabric_wwn))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageAdapterParseXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "175-214",
    "snippet": "int\nvirStorageAdapterParseXML(virStorageAdapterPtr adapter,\n                          xmlNodePtr node,\n                          xmlXPathContextPtr ctxt)\n{\n    int ret = -1;\n    xmlNodePtr relnode = ctxt->node;\n    char *adapter_type = NULL;\n\n    ctxt->node = node;\n\n    if ((adapter_type = virXMLPropString(node, \"type\"))) {\n        if ((adapter->type =\n             virStorageAdapterTypeFromString(adapter_type)) <= 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown pool adapter type '%s'\"),\n                           adapter_type);\n            goto cleanup;\n        }\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) &&\n            (virStorageAdapterParseXMLFCHost(node, &adapter->data.fchost)) < 0)\n                goto cleanup;\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) &&\n            (virStorageAdapterParseXMLSCSIHost(node, ctxt,\n                                               &adapter->data.scsi_host)) < 0)\n                goto cleanup;\n    } else {\n        if (virStorageAdapterParseXMLLegacy(node, ctxt, adapter) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    ctxt->node = relnode;\n    VIR_FREE(adapter_type);\n    return ret;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "adapter_type"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageAdapterParseXMLLegacy",
          "args": [
            "node",
            "ctxt",
            "adapter"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterParseXMLLegacy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "135-172",
          "snippet": "static int\nvirStorageAdapterParseXMLLegacy(xmlNodePtr node,\n                                xmlXPathContextPtr ctxt,\n                                virStorageAdapterPtr adapter)\n{\n    char *wwnn = virXMLPropString(node, \"wwnn\");\n    char *wwpn = virXMLPropString(node, \"wwpn\");\n    char *parent = virXMLPropString(node, \"parent\");\n\n    /* \"type\" was not specified in the XML, so we must verify that\n     * \"wwnn\", \"wwpn\", \"parent\", or \"parentaddr\" are also not in the\n     * XML. If any are found, then we cannot just use \"name\" alone\".\n     */\n    if (wwnn || wwpn || parent) {\n        VIR_FREE(wwnn);\n        VIR_FREE(wwpn);\n        VIR_FREE(parent);\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'wwnn', 'wwpn', and 'parent' attributes \"\n                         \"requires use of the adapter 'type'\"));\n        return -1;\n    }\n\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'parentaddr' element requires use \"\n                         \"of the adapter 'type'\"));\n        return -1;\n    }\n\n    /* To keep back-compat, 'type' is not required to specify\n     * for scsi_host adapter.\n     */\n    if ((adapter->data.scsi_host.name = virXMLPropString(node, \"name\")))\n        adapter->type = VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST;\n\n    return 0;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterParseXMLLegacy(xmlNodePtr node,\n                                xmlXPathContextPtr ctxt,\n                                virStorageAdapterPtr adapter)\n{\n    char *wwnn = virXMLPropString(node, \"wwnn\");\n    char *wwpn = virXMLPropString(node, \"wwpn\");\n    char *parent = virXMLPropString(node, \"parent\");\n\n    /* \"type\" was not specified in the XML, so we must verify that\n     * \"wwnn\", \"wwpn\", \"parent\", or \"parentaddr\" are also not in the\n     * XML. If any are found, then we cannot just use \"name\" alone\".\n     */\n    if (wwnn || wwpn || parent) {\n        VIR_FREE(wwnn);\n        VIR_FREE(wwpn);\n        VIR_FREE(parent);\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'wwnn', 'wwpn', and 'parent' attributes \"\n                         \"requires use of the adapter 'type'\"));\n        return -1;\n    }\n\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'parentaddr' element requires use \"\n                         \"of the adapter 'type'\"));\n        return -1;\n    }\n\n    /* To keep back-compat, 'type' is not required to specify\n     * for scsi_host adapter.\n     */\n    if ((adapter->data.scsi_host.name = virXMLPropString(node, \"name\")))\n        adapter->type = VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterParseXMLSCSIHost",
          "args": [
            "node",
            "ctxt",
            "&adapter->data.scsi_host"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterParseXMLSCSIHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "91-120",
          "snippet": "static int\nvirStorageAdapterParseXMLSCSIHost(xmlNodePtr node,\n                                  xmlXPathContextPtr ctxt,\n                                  virStorageAdapterSCSIHostPtr scsi_host)\n{\n    scsi_host->name = virXMLPropString(node, \"name\");\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        xmlNodePtr addrnode = virXPathNode(\"./parentaddr/address\", ctxt);\n\n        if (!addrnode) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing scsi_host PCI address element\"));\n            return -1;\n        }\n        scsi_host->has_parent = true;\n        if (virPCIDeviceAddressParseXML(addrnode, &scsi_host->parentaddr) < 0)\n            return -1;\n        if ((virXPathInt(\"string(./parentaddr/@unique_id)\",\n                         ctxt,\n                         &scsi_host->unique_id) < 0) ||\n            (scsi_host->unique_id < 0)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing or invalid scsi adapter \"\n                             \"'unique_id' value\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterParseXMLSCSIHost(xmlNodePtr node,\n                                  xmlXPathContextPtr ctxt,\n                                  virStorageAdapterSCSIHostPtr scsi_host)\n{\n    scsi_host->name = virXMLPropString(node, \"name\");\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        xmlNodePtr addrnode = virXPathNode(\"./parentaddr/address\", ctxt);\n\n        if (!addrnode) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing scsi_host PCI address element\"));\n            return -1;\n        }\n        scsi_host->has_parent = true;\n        if (virPCIDeviceAddressParseXML(addrnode, &scsi_host->parentaddr) < 0)\n            return -1;\n        if ((virXPathInt(\"string(./parentaddr/@unique_id)\",\n                         ctxt,\n                         &scsi_host->unique_id) < 0) ||\n            (scsi_host->unique_id < 0)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing or invalid scsi adapter \"\n                             \"'unique_id' value\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterParseXMLFCHost",
          "args": [
            "node",
            "&adapter->data.fchost"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterParseXMLFCHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "63-88",
          "snippet": "static int\nvirStorageAdapterParseXMLFCHost(xmlNodePtr node,\n                                virStorageAdapterFCHostPtr fchost)\n{\n    char *managed = NULL;\n\n    fchost->parent = virXMLPropString(node, \"parent\");\n    if ((managed = virXMLPropString(node, \"managed\"))) {\n        if ((fchost->managed = virTristateBoolTypeFromString(managed)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown fc_host managed setting '%s'\"),\n                           managed);\n            VIR_FREE(managed);\n            return -1;\n        }\n    }\n\n    fchost->parent_wwnn = virXMLPropString(node, \"parent_wwnn\");\n    fchost->parent_wwpn = virXMLPropString(node, \"parent_wwpn\");\n    fchost->parent_fabric_wwn = virXMLPropString(node, \"parent_fabric_wwn\");\n    fchost->wwpn = virXMLPropString(node, \"wwpn\");\n    fchost->wwnn = virXMLPropString(node, \"wwnn\");\n\n    VIR_FREE(managed);\n    return 0;\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterParseXMLFCHost(xmlNodePtr node,\n                                virStorageAdapterFCHostPtr fchost)\n{\n    char *managed = NULL;\n\n    fchost->parent = virXMLPropString(node, \"parent\");\n    if ((managed = virXMLPropString(node, \"managed\"))) {\n        if ((fchost->managed = virTristateBoolTypeFromString(managed)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown fc_host managed setting '%s'\"),\n                           managed);\n            VIR_FREE(managed);\n            return -1;\n        }\n    }\n\n    fchost->parent_wwnn = virXMLPropString(node, \"parent_wwnn\");\n    fchost->parent_wwpn = virXMLPropString(node, \"parent_wwpn\");\n    fchost->parent_fabric_wwn = virXMLPropString(node, \"parent_fabric_wwn\");\n    fchost->wwpn = virXMLPropString(node, \"wwpn\");\n    fchost->wwnn = virXMLPropString(node, \"wwnn\");\n\n    VIR_FREE(managed);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unknown pool adapter type '%s'\")",
            "adapter_type"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown pool adapter type '%s'\""
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageAdapterTypeFromString",
          "args": [
            "adapter_type"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"type\""
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nint\nvirStorageAdapterParseXML(virStorageAdapterPtr adapter,\n                          xmlNodePtr node,\n                          xmlXPathContextPtr ctxt)\n{\n    int ret = -1;\n    xmlNodePtr relnode = ctxt->node;\n    char *adapter_type = NULL;\n\n    ctxt->node = node;\n\n    if ((adapter_type = virXMLPropString(node, \"type\"))) {\n        if ((adapter->type =\n             virStorageAdapterTypeFromString(adapter_type)) <= 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown pool adapter type '%s'\"),\n                           adapter_type);\n            goto cleanup;\n        }\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST) &&\n            (virStorageAdapterParseXMLFCHost(node, &adapter->data.fchost)) < 0)\n                goto cleanup;\n\n        if ((adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST) &&\n            (virStorageAdapterParseXMLSCSIHost(node, ctxt,\n                                               &adapter->data.scsi_host)) < 0)\n                goto cleanup;\n    } else {\n        if (virStorageAdapterParseXMLLegacy(node, ctxt, adapter) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    ctxt->node = relnode;\n    VIR_FREE(adapter_type);\n    return ret;\n}"
  },
  {
    "function_name": "virStorageAdapterParseXMLLegacy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "135-172",
    "snippet": "static int\nvirStorageAdapterParseXMLLegacy(xmlNodePtr node,\n                                xmlXPathContextPtr ctxt,\n                                virStorageAdapterPtr adapter)\n{\n    char *wwnn = virXMLPropString(node, \"wwnn\");\n    char *wwpn = virXMLPropString(node, \"wwpn\");\n    char *parent = virXMLPropString(node, \"parent\");\n\n    /* \"type\" was not specified in the XML, so we must verify that\n     * \"wwnn\", \"wwpn\", \"parent\", or \"parentaddr\" are also not in the\n     * XML. If any are found, then we cannot just use \"name\" alone\".\n     */\n    if (wwnn || wwpn || parent) {\n        VIR_FREE(wwnn);\n        VIR_FREE(wwpn);\n        VIR_FREE(parent);\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'wwnn', 'wwpn', and 'parent' attributes \"\n                         \"requires use of the adapter 'type'\"));\n        return -1;\n    }\n\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'parentaddr' element requires use \"\n                         \"of the adapter 'type'\"));\n        return -1;\n    }\n\n    /* To keep back-compat, 'type' is not required to specify\n     * for scsi_host adapter.\n     */\n    if ((adapter->data.scsi_host.name = virXMLPropString(node, \"name\")))\n        adapter->type = VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST;\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"name\""
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"Use of 'parentaddr' element requires use \"\n                         \"of the adapter 'type'\")"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Use of 'parentaddr' element requires use \"\n                         \"of the adapter 'type'\""
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./parentaddr\"",
            "ctxt"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"Use of 'wwnn', 'wwpn', and 'parent' attributes \"\n                         \"requires use of the adapter 'type'\")"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "parent"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "wwpn"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "wwnn"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterParseXMLLegacy(xmlNodePtr node,\n                                xmlXPathContextPtr ctxt,\n                                virStorageAdapterPtr adapter)\n{\n    char *wwnn = virXMLPropString(node, \"wwnn\");\n    char *wwpn = virXMLPropString(node, \"wwpn\");\n    char *parent = virXMLPropString(node, \"parent\");\n\n    /* \"type\" was not specified in the XML, so we must verify that\n     * \"wwnn\", \"wwpn\", \"parent\", or \"parentaddr\" are also not in the\n     * XML. If any are found, then we cannot just use \"name\" alone\".\n     */\n    if (wwnn || wwpn || parent) {\n        VIR_FREE(wwnn);\n        VIR_FREE(wwpn);\n        VIR_FREE(parent);\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'wwnn', 'wwpn', and 'parent' attributes \"\n                         \"requires use of the adapter 'type'\"));\n        return -1;\n    }\n\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"Use of 'parentaddr' element requires use \"\n                         \"of the adapter 'type'\"));\n        return -1;\n    }\n\n    /* To keep back-compat, 'type' is not required to specify\n     * for scsi_host adapter.\n     */\n    if ((adapter->data.scsi_host.name = virXMLPropString(node, \"name\")))\n        adapter->type = VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST;\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageAdapterParseXMLSCSIHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "91-120",
    "snippet": "static int\nvirStorageAdapterParseXMLSCSIHost(xmlNodePtr node,\n                                  xmlXPathContextPtr ctxt,\n                                  virStorageAdapterSCSIHostPtr scsi_host)\n{\n    scsi_host->name = virXMLPropString(node, \"name\");\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        xmlNodePtr addrnode = virXPathNode(\"./parentaddr/address\", ctxt);\n\n        if (!addrnode) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing scsi_host PCI address element\"));\n            return -1;\n        }\n        scsi_host->has_parent = true;\n        if (virPCIDeviceAddressParseXML(addrnode, &scsi_host->parentaddr) < 0)\n            return -1;\n        if ((virXPathInt(\"string(./parentaddr/@unique_id)\",\n                         ctxt,\n                         &scsi_host->unique_id) < 0) ||\n            (scsi_host->unique_id < 0)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing or invalid scsi adapter \"\n                             \"'unique_id' value\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"Missing or invalid scsi adapter \"\n                             \"'unique_id' value\")"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Missing or invalid scsi adapter \"\n                             \"'unique_id' value\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathInt",
          "args": [
            "\"string(./parentaddr/@unique_id)\"",
            "ctxt",
            "&scsi_host->unique_id"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "223-238",
          "snippet": "int\nvirXPathInt(const char *xpath,\n            xmlXPathContextPtr ctxt,\n            int *value)\n{\n    long tmp;\n    int ret;\n\n    ret = virXPathLongBase(xpath, ctxt, 10, &tmp);\n    if (ret < 0)\n        return ret;\n    if ((int) tmp != tmp)\n        return -2;\n    *value = tmp;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXPathInt(const char *xpath,\n            xmlXPathContextPtr ctxt,\n            int *value)\n{\n    long tmp;\n    int ret;\n\n    ret = virXPathLongBase(xpath, ctxt, 10, &tmp);\n    if (ret < 0)\n        return ret;\n    if ((int) tmp != tmp)\n        return -2;\n    *value = tmp;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressParseXML",
          "args": [
            "addrnode",
            "&scsi_host->parentaddr"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressParseXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/device_conf.c",
          "lines": "214-291",
          "snippet": "int\nvirPCIDeviceAddressParseXML(xmlNodePtr node,\n                            virPCIDeviceAddressPtr addr)\n{\n    char *domain, *slot, *bus, *function, *multi;\n    xmlNodePtr cur;\n    xmlNodePtr zpci = NULL;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    domain   = virXMLPropString(node, \"domain\");\n    bus      = virXMLPropString(node, \"bus\");\n    slot     = virXMLPropString(node, \"slot\");\n    function = virXMLPropString(node, \"function\");\n    multi    = virXMLPropString(node, \"multifunction\");\n\n    if (domain &&\n        virStrToLong_uip(domain, NULL, 0, &addr->domain) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'domain' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 0, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (slot &&\n        virStrToLong_uip(slot, NULL, 0, &addr->slot) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'slot' attribute\"));\n        goto cleanup;\n    }\n\n    if (function &&\n        virStrToLong_uip(function, NULL, 0, &addr->function) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'function' attribute\"));\n        goto cleanup;\n    }\n\n    if (multi &&\n        ((addr->multi = virTristateSwitchTypeFromString(multi)) <= 0)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unknown value '%s' for <address> 'multifunction' attribute\"),\n                       multi);\n        goto cleanup;\n\n    }\n    if (!virPCIDeviceAddressIsEmpty(addr) && !virPCIDeviceAddressIsValid(addr, true))\n        goto cleanup;\n\n    cur = node->children;\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE &&\n            virXMLNodeNameEqual(cur, \"zpci\")) {\n            zpci = cur;\n        }\n        cur = cur->next;\n    }\n\n    if (zpci && virZPCIDeviceAddressParseXML(zpci, addr) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(domain);\n    VIR_FREE(bus);\n    VIR_FREE(slot);\n    VIR_FREE(function);\n    VIR_FREE(multi);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"domain_addr.h\"",
            "#include \"device_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"domain_addr.h\"\n#include \"device_conf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirPCIDeviceAddressParseXML(xmlNodePtr node,\n                            virPCIDeviceAddressPtr addr)\n{\n    char *domain, *slot, *bus, *function, *multi;\n    xmlNodePtr cur;\n    xmlNodePtr zpci = NULL;\n    int ret = -1;\n\n    memset(addr, 0, sizeof(*addr));\n\n    domain   = virXMLPropString(node, \"domain\");\n    bus      = virXMLPropString(node, \"bus\");\n    slot     = virXMLPropString(node, \"slot\");\n    function = virXMLPropString(node, \"function\");\n    multi    = virXMLPropString(node, \"multifunction\");\n\n    if (domain &&\n        virStrToLong_uip(domain, NULL, 0, &addr->domain) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'domain' attribute\"));\n        goto cleanup;\n    }\n\n    if (bus &&\n        virStrToLong_uip(bus, NULL, 0, &addr->bus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'bus' attribute\"));\n        goto cleanup;\n    }\n\n    if (slot &&\n        virStrToLong_uip(slot, NULL, 0, &addr->slot) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'slot' attribute\"));\n        goto cleanup;\n    }\n\n    if (function &&\n        virStrToLong_uip(function, NULL, 0, &addr->function) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot parse <address> 'function' attribute\"));\n        goto cleanup;\n    }\n\n    if (multi &&\n        ((addr->multi = virTristateSwitchTypeFromString(multi)) <= 0)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unknown value '%s' for <address> 'multifunction' attribute\"),\n                       multi);\n        goto cleanup;\n\n    }\n    if (!virPCIDeviceAddressIsEmpty(addr) && !virPCIDeviceAddressIsValid(addr, true))\n        goto cleanup;\n\n    cur = node->children;\n    while (cur) {\n        if (cur->type == XML_ELEMENT_NODE &&\n            virXMLNodeNameEqual(cur, \"zpci\")) {\n            zpci = cur;\n        }\n        cur = cur->next;\n    }\n\n    if (zpci && virZPCIDeviceAddressParseXML(zpci, addr) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(domain);\n    VIR_FREE(bus);\n    VIR_FREE(slot);\n    VIR_FREE(function);\n    VIR_FREE(multi);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"Missing scsi_host PCI address element\")"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./parentaddr/address\"",
            "ctxt"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"name\""
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterParseXMLSCSIHost(xmlNodePtr node,\n                                  xmlXPathContextPtr ctxt,\n                                  virStorageAdapterSCSIHostPtr scsi_host)\n{\n    scsi_host->name = virXMLPropString(node, \"name\");\n    if (virXPathNode(\"./parentaddr\", ctxt)) {\n        xmlNodePtr addrnode = virXPathNode(\"./parentaddr/address\", ctxt);\n\n        if (!addrnode) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing scsi_host PCI address element\"));\n            return -1;\n        }\n        scsi_host->has_parent = true;\n        if (virPCIDeviceAddressParseXML(addrnode, &scsi_host->parentaddr) < 0)\n            return -1;\n        if ((virXPathInt(\"string(./parentaddr/@unique_id)\",\n                         ctxt,\n                         &scsi_host->unique_id) < 0) ||\n            (scsi_host->unique_id < 0)) {\n            virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                           _(\"Missing or invalid scsi adapter \"\n                             \"'unique_id' value\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageAdapterParseXMLFCHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "63-88",
    "snippet": "static int\nvirStorageAdapterParseXMLFCHost(xmlNodePtr node,\n                                virStorageAdapterFCHostPtr fchost)\n{\n    char *managed = NULL;\n\n    fchost->parent = virXMLPropString(node, \"parent\");\n    if ((managed = virXMLPropString(node, \"managed\"))) {\n        if ((fchost->managed = virTristateBoolTypeFromString(managed)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown fc_host managed setting '%s'\"),\n                           managed);\n            VIR_FREE(managed);\n            return -1;\n        }\n    }\n\n    fchost->parent_wwnn = virXMLPropString(node, \"parent_wwnn\");\n    fchost->parent_wwpn = virXMLPropString(node, \"parent_wwpn\");\n    fchost->parent_fabric_wwn = virXMLPropString(node, \"parent_fabric_wwn\");\n    fchost->wwpn = virXMLPropString(node, \"wwpn\");\n    fchost->wwnn = virXMLPropString(node, \"wwnn\");\n\n    VIR_FREE(managed);\n    return 0;\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "managed"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLPropString",
          "args": [
            "node",
            "\"wwnn\""
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLPropString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "515-520",
          "snippet": "char *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirXMLPropString(xmlNodePtr node,\n                 const char *name)\n{\n    return (char *)xmlGetProp(node, BAD_CAST name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "managed"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"unknown fc_host managed setting '%s'\")",
            "managed"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown fc_host managed setting '%s'\""
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTristateBoolTypeFromString",
          "args": [
            "managed"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic int\nvirStorageAdapterParseXMLFCHost(xmlNodePtr node,\n                                virStorageAdapterFCHostPtr fchost)\n{\n    char *managed = NULL;\n\n    fchost->parent = virXMLPropString(node, \"parent\");\n    if ((managed = virXMLPropString(node, \"managed\"))) {\n        if ((fchost->managed = virTristateBoolTypeFromString(managed)) < 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown fc_host managed setting '%s'\"),\n                           managed);\n            VIR_FREE(managed);\n            return -1;\n        }\n    }\n\n    fchost->parent_wwnn = virXMLPropString(node, \"parent_wwnn\");\n    fchost->parent_wwpn = virXMLPropString(node, \"parent_wwpn\");\n    fchost->parent_fabric_wwn = virXMLPropString(node, \"parent_fabric_wwn\");\n    fchost->wwpn = virXMLPropString(node, \"wwpn\");\n    fchost->wwnn = virXMLPropString(node, \"wwnn\");\n\n    VIR_FREE(managed);\n    return 0;\n}"
  },
  {
    "function_name": "virStorageAdapterClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "52-60",
    "snippet": "void\nvirStorageAdapterClear(virStorageAdapterPtr adapter)\n{\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterClearFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        VIR_FREE(adapter->data.scsi_host.name);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "adapter->data.scsi_host.name"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageAdapterClearFCHost",
          "args": [
            "&adapter->data.fchost"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageAdapterClearFCHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
          "lines": "40-49",
          "snippet": "static void\nvirStorageAdapterClearFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    VIR_FREE(fchost->wwnn);\n    VIR_FREE(fchost->wwpn);\n    VIR_FREE(fchost->parent);\n    VIR_FREE(fchost->parent_wwnn);\n    VIR_FREE(fchost->parent_wwpn);\n    VIR_FREE(fchost->parent_fabric_wwn);\n}",
          "includes": [
            "#include \"virxml.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic void\nvirStorageAdapterClearFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    VIR_FREE(fchost->wwnn);\n    VIR_FREE(fchost->wwpn);\n    VIR_FREE(fchost->parent);\n    VIR_FREE(fchost->parent_wwnn);\n    VIR_FREE(fchost->parent_wwpn);\n    VIR_FREE(fchost->parent_fabric_wwn);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nvoid\nvirStorageAdapterClear(virStorageAdapterPtr adapter)\n{\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_FC_HOST)\n        virStorageAdapterClearFCHost(&adapter->data.fchost);\n\n    if (adapter->type == VIR_STORAGE_ADAPTER_TYPE_SCSI_HOST)\n        VIR_FREE(adapter->data.scsi_host.name);\n}"
  },
  {
    "function_name": "virStorageAdapterClearFCHost",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/storage_adapter_conf.c",
    "lines": "40-49",
    "snippet": "static void\nvirStorageAdapterClearFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    VIR_FREE(fchost->wwnn);\n    VIR_FREE(fchost->wwpn);\n    VIR_FREE(fchost->parent);\n    VIR_FREE(fchost->parent_wwnn);\n    VIR_FREE(fchost->parent_wwpn);\n    VIR_FREE(fchost->parent_fabric_wwn);\n}",
    "includes": [
      "#include \"virxml.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"storage_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fchost->parent_fabric_wwn"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fchost->parent_wwpn"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fchost->parent_wwnn"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fchost->parent"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fchost->wwpn"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fchost->wwnn"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virxml.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include <config.h>\n\nstatic void\nvirStorageAdapterClearFCHost(virStorageAdapterFCHostPtr fchost)\n{\n    VIR_FREE(fchost->wwnn);\n    VIR_FREE(fchost->wwpn);\n    VIR_FREE(fchost->parent);\n    VIR_FREE(fchost->parent_wwnn);\n    VIR_FREE(fchost->parent_wwpn);\n    VIR_FREE(fchost->parent_fabric_wwn);\n}"
  }
]