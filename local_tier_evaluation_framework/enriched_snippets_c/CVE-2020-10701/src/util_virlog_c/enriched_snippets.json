[
  {
    "function_name": "virLogSetFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1790-1811",
    "snippet": "int\nvirLogSetFilters(const char *src)\n{\n    int ret = -1;\n    int nfilters = 0;\n    virLogFilterPtr *filters = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && (nfilters = virLogParseFilters(src, &filters)) < 0)\n        goto cleanup;\n\n    if (virLogDefineFilters(filters, nfilters) < 0)\n        goto cleanup;\n\n    filters = NULL;\n    ret = 0;\n cleanup:\n    virLogFilterListFree(filters, nfilters);\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogFilterListFree",
          "args": [
            "filters",
            "nfilters"
          ],
          "line": 1809
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFilterListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "354-365",
          "snippet": "void\nvirLogFilterListFree(virLogFilterPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogFilterFree(list[i]);\n    VIR_FREE(list);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogFilterListFree(virLogFilterPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogFilterFree(list[i]);\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogDefineFilters",
          "args": [
            "filters",
            "nfilters"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "virLogDefineFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1437-1450",
          "snippet": "int\nvirLogDefineFilters(virLogFilterPtr *filters, size_t nfilters)\n{\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetFilters();\n    virLogFilters = filters;\n    virLogNbFilters = nfilters;\n    virLogUnlock();\n\n    return 0;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virLogFilterPtr *virLogFilters;",
            "static size_t virLogNbFilters;",
            "static void virLogResetFilters(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic void virLogResetFilters(void);\n\nint\nvirLogDefineFilters(virLogFilterPtr *filters, size_t nfilters)\n{\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetFilters();\n    virLogFilters = filters;\n    virLogNbFilters = nfilters;\n    virLogUnlock();\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogParseFilters",
          "args": [
            "src",
            "&filters"
          ],
          "line": 1800
        },
        "resolved": true,
        "details": {
          "function_name": "virLogParseFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1700-1735",
          "snippet": "int\nvirLogParseFilters(const char *src, virLogFilterPtr **filters)\n{\n    int ret = -1;\n    size_t nfilters = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogFilterPtr filter = NULL;\n    virLogFilterPtr *list = NULL;\n\n    VIR_DEBUG(\"filters=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(filter = virLogParseFilter(strings[i])))\n            goto cleanup;\n\n        if (VIR_APPEND_ELEMENT(list, nfilters, filter)) {\n            virLogFilterFree(filter);\n            goto cleanup;\n        }\n    }\n\n    ret = nfilters;\n    *filters = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogParseFilters(const char *src, virLogFilterPtr **filters)\n{\n    int ret = -1;\n    size_t nfilters = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogFilterPtr filter = NULL;\n    virLogFilterPtr *list = NULL;\n\n    VIR_DEBUG(\"filters=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(filter = virLogParseFilter(strings[i])))\n            goto cleanup;\n\n        if (VIR_APPEND_ELEMENT(list, nfilters, filter)) {\n            virLogFilterFree(filter);\n            goto cleanup;\n        }\n    }\n\n    ret = nfilters;\n    *filters = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogSetFilters(const char *src)\n{\n    int ret = -1;\n    int nfilters = 0;\n    virLogFilterPtr *filters = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && (nfilters = virLogParseFilters(src, &filters)) < 0)\n        goto cleanup;\n\n    if (virLogDefineFilters(filters, nfilters) < 0)\n        goto cleanup;\n\n    filters = NULL;\n    ret = 0;\n cleanup:\n    virLogFilterListFree(filters, nfilters);\n    return ret;\n}"
  },
  {
    "function_name": "virLogSetOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1747-1779",
    "snippet": "int\nvirLogSetOutputs(const char *src)\n{\n    int ret = -1;\n    int noutputs = 0;\n    const char *outputstr = virLogDefaultOutput;\n    virLogOutputPtr *outputs = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && *src)\n        outputstr = src;\n\n    /* This can only happen during daemon init when the default output is not\n     * determined yet. It's safe to do, since it's the only place setting the\n     * default output.\n     */\n    if (!outputstr)\n        return 0;\n\n    if ((noutputs = virLogParseOutputs(outputstr, &outputs)) < 0)\n        goto cleanup;\n\n    if (virLogDefineOutputs(outputs, noutputs) < 0)\n        goto cleanup;\n\n    outputs = NULL;\n    ret = 0;\n cleanup:\n    virLogOutputListFree(outputs, noutputs);\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *virLogDefaultOutput;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogOutputListFree",
          "args": [
            "outputs",
            "noutputs"
          ],
          "line": 1777
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "403-414",
          "snippet": "void\nvirLogOutputListFree(virLogOutputPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogOutputFree(list[i]);\n    VIR_FREE(list);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogOutputListFree(virLogOutputPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogOutputFree(list[i]);\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogDefineOutputs",
          "args": [
            "outputs",
            "noutputs"
          ],
          "line": 1771
        },
        "resolved": true,
        "details": {
          "function_name": "virLogDefineOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1389-1423",
          "snippet": "int\nvirLogDefineOutputs(virLogOutputPtr *outputs, size_t noutputs)\n{\n#if HAVE_SYSLOG_H\n    int id;\n    char *tmp = NULL;\n#endif /* HAVE_SYSLOG_H */\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetOutputs();\n\n#if HAVE_SYSLOG_H\n    /* syslog needs to be special-cased, since it keeps the fd in private */\n    if ((id = virLogFindOutput(outputs, noutputs, VIR_LOG_TO_SYSLOG,\n                               current_ident)) != -1) {\n        /* nothing can go wrong now (except for malloc) and since we're also\n         * holding the lock so it's safe to call openlog and change the message\n         * tag\n         */\n        tmp = g_strdup(outputs[id]->name);\n        VIR_FREE(current_ident);\n        current_ident = tmp;\n        openlog(current_ident, 0, 0);\n    }\n#endif /* HAVE_SYSLOG_H */\n\n    virLogOutputs = outputs;\n    virLogNbOutputs = noutputs;\n\n    virLogUnlock();\n    return 0;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virLogOutputPtr *virLogOutputs;",
            "static size_t virLogNbOutputs;",
            "static void virLogResetOutputs(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogResetOutputs(void);\n\nint\nvirLogDefineOutputs(virLogOutputPtr *outputs, size_t noutputs)\n{\n#if HAVE_SYSLOG_H\n    int id;\n    char *tmp = NULL;\n#endif /* HAVE_SYSLOG_H */\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetOutputs();\n\n#if HAVE_SYSLOG_H\n    /* syslog needs to be special-cased, since it keeps the fd in private */\n    if ((id = virLogFindOutput(outputs, noutputs, VIR_LOG_TO_SYSLOG,\n                               current_ident)) != -1) {\n        /* nothing can go wrong now (except for malloc) and since we're also\n         * holding the lock so it's safe to call openlog and change the message\n         * tag\n         */\n        tmp = g_strdup(outputs[id]->name);\n        VIR_FREE(current_ident);\n        current_ident = tmp;\n        openlog(current_ident, 0, 0);\n    }\n#endif /* HAVE_SYSLOG_H */\n\n    virLogOutputs = outputs;\n    virLogNbOutputs = noutputs;\n\n    virLogUnlock();\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogParseOutputs",
          "args": [
            "outputstr",
            "&outputs"
          ],
          "line": 1768
        },
        "resolved": true,
        "details": {
          "function_name": "virLogParseOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1638-1685",
          "snippet": "int\nvirLogParseOutputs(const char *src, virLogOutputPtr **outputs)\n{\n    int ret = -1;\n    int at = -1;\n    size_t noutputs = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogOutputPtr output = NULL;\n    virLogOutputPtr *list = NULL;\n\n    VIR_DEBUG(\"outputs=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(output = virLogParseOutput(strings[i])))\n            goto cleanup;\n\n        /* let's check if a duplicate output does not already exist in which\n         * case we need to replace it with its last occurrence, however, rather\n         * than first deleting the duplicate and then adding the new one, the\n         * new output object is added first so in case of an error we don't\n         * lose the old entry\n         */\n        at = virLogFindOutput(list, noutputs, output->dest, output->name);\n        if (VIR_APPEND_ELEMENT(list, noutputs, output) < 0) {\n            virLogOutputFree(output);\n            goto cleanup;\n        }\n        if (at >= 0) {\n            virLogOutputFree(list[at]);\n            VIR_DELETE_ELEMENT(list, at, noutputs);\n        }\n    }\n\n    ret = noutputs;\n    *outputs = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogParseOutputs(const char *src, virLogOutputPtr **outputs)\n{\n    int ret = -1;\n    int at = -1;\n    size_t noutputs = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogOutputPtr output = NULL;\n    virLogOutputPtr *list = NULL;\n\n    VIR_DEBUG(\"outputs=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(output = virLogParseOutput(strings[i])))\n            goto cleanup;\n\n        /* let's check if a duplicate output does not already exist in which\n         * case we need to replace it with its last occurrence, however, rather\n         * than first deleting the duplicate and then adding the new one, the\n         * new output object is added first so in case of an error we don't\n         * lose the old entry\n         */\n        at = virLogFindOutput(list, noutputs, output->dest, output->name);\n        if (VIR_APPEND_ELEMENT(list, noutputs, output) < 0) {\n            virLogOutputFree(output);\n            goto cleanup;\n        }\n        if (at >= 0) {\n            virLogOutputFree(list[at]);\n            VIR_DELETE_ELEMENT(list, at, noutputs);\n        }\n    }\n\n    ret = noutputs;\n    *outputs = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\n\nint\nvirLogSetOutputs(const char *src)\n{\n    int ret = -1;\n    int noutputs = 0;\n    const char *outputstr = virLogDefaultOutput;\n    virLogOutputPtr *outputs = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && *src)\n        outputstr = src;\n\n    /* This can only happen during daemon init when the default output is not\n     * determined yet. It's safe to do, since it's the only place setting the\n     * default output.\n     */\n    if (!outputstr)\n        return 0;\n\n    if ((noutputs = virLogParseOutputs(outputstr, &outputs)) < 0)\n        goto cleanup;\n\n    if (virLogDefineOutputs(outputs, noutputs) < 0)\n        goto cleanup;\n\n    outputs = NULL;\n    ret = 0;\n cleanup:\n    virLogOutputListFree(outputs, noutputs);\n    return ret;\n}"
  },
  {
    "function_name": "virLogParseFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1700-1735",
    "snippet": "int\nvirLogParseFilters(const char *src, virLogFilterPtr **filters)\n{\n    int ret = -1;\n    size_t nfilters = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogFilterPtr filter = NULL;\n    virLogFilterPtr *list = NULL;\n\n    VIR_DEBUG(\"filters=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(filter = virLogParseFilter(strings[i])))\n            goto cleanup;\n\n        if (VIR_APPEND_ELEMENT(list, nfilters, filter)) {\n            virLogFilterFree(filter);\n            goto cleanup;\n        }\n    }\n\n    ret = nfilters;\n    *filters = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "strings"
          ],
          "line": 1733
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogFilterFree",
          "args": [
            "filter"
          ],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFilterFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "336-344",
          "snippet": "void\nvirLogFilterFree(virLogFilterPtr filter)\n{\n    if (!filter)\n        return;\n\n    VIR_FREE(filter->match);\n    VIR_FREE(filter);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogFilterFree(virLogFilterPtr filter)\n{\n    if (!filter)\n        return;\n\n    VIR_FREE(filter->match);\n    VIR_FREE(filter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "list",
            "nfilters",
            "filter"
          ],
          "line": 1723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogParseFilter",
          "args": [
            "strings[i]"
          ],
          "line": 1720
        },
        "resolved": true,
        "details": {
          "function_name": "virLogParseFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1577-1625",
          "snippet": "virLogFilterPtr\nvirLogParseFilter(const char *src)\n{\n    virLogFilterPtr ret = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    char **tokens = NULL;\n    char *match = NULL;\n\n    VIR_DEBUG(\"filter=%s\", src);\n\n    /* split our format prio:match_str to tokens and parse them individually */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for filter '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for filter '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    match = tokens[1];\n    if (match[0] == '+') {\n        /* '+' used to indicate printing a stack trace,\n         * but we dropped that feature, so just chomp\n         * that leading '+' */\n        match++;\n    }\n\n    /* match string cannot comprise just from a single '+' */\n    if (!*match) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid match string '%s'\"), tokens[1]);\n\n        goto cleanup;\n    }\n\n    if (!(ret = virLogFilterNew(match, prio)))\n        goto cleanup;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirLogFilterPtr\nvirLogParseFilter(const char *src)\n{\n    virLogFilterPtr ret = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    char **tokens = NULL;\n    char *match = NULL;\n\n    VIR_DEBUG(\"filter=%s\", src);\n\n    /* split our format prio:match_str to tokens and parse them individually */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for filter '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for filter '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    match = tokens[1];\n    if (match[0] == '+') {\n        /* '+' used to indicate printing a stack trace,\n         * but we dropped that feature, so just chomp\n         * that leading '+' */\n        match++;\n    }\n\n    /* match string cannot comprise just from a single '+' */\n    if (!*match) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid match string '%s'\"), tokens[1]);\n\n        goto cleanup;\n    }\n\n    if (!(ret = virLogFilterNew(match, prio)))\n        goto cleanup;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "strings[i]",
            "\"\""
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "src",
            "\" \"",
            "0",
            "&count"
          ],
          "line": 1712
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"filters=%s\"",
            "src"
          ],
          "line": 1710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogParseFilters(const char *src, virLogFilterPtr **filters)\n{\n    int ret = -1;\n    size_t nfilters = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogFilterPtr filter = NULL;\n    virLogFilterPtr *list = NULL;\n\n    VIR_DEBUG(\"filters=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(filter = virLogParseFilter(strings[i])))\n            goto cleanup;\n\n        if (VIR_APPEND_ELEMENT(list, nfilters, filter)) {\n            virLogFilterFree(filter);\n            goto cleanup;\n        }\n    }\n\n    ret = nfilters;\n    *filters = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}"
  },
  {
    "function_name": "virLogParseOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1638-1685",
    "snippet": "int\nvirLogParseOutputs(const char *src, virLogOutputPtr **outputs)\n{\n    int ret = -1;\n    int at = -1;\n    size_t noutputs = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogOutputPtr output = NULL;\n    virLogOutputPtr *list = NULL;\n\n    VIR_DEBUG(\"outputs=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(output = virLogParseOutput(strings[i])))\n            goto cleanup;\n\n        /* let's check if a duplicate output does not already exist in which\n         * case we need to replace it with its last occurrence, however, rather\n         * than first deleting the duplicate and then adding the new one, the\n         * new output object is added first so in case of an error we don't\n         * lose the old entry\n         */\n        at = virLogFindOutput(list, noutputs, output->dest, output->name);\n        if (VIR_APPEND_ELEMENT(list, noutputs, output) < 0) {\n            virLogOutputFree(output);\n            goto cleanup;\n        }\n        if (at >= 0) {\n            virLogOutputFree(list[at]);\n            VIR_DELETE_ELEMENT(list, at, noutputs);\n        }\n    }\n\n    ret = noutputs;\n    *outputs = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "strings"
          ],
          "line": 1683
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "list",
            "at",
            "noutputs"
          ],
          "line": 1675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputFree",
          "args": [
            "list[at]"
          ],
          "line": 1674
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "382-393",
          "snippet": "void\nvirLogOutputFree(virLogOutputPtr output)\n{\n    if (!output)\n        return;\n\n    if (output->c)\n        output->c(output->data);\n    VIR_FREE(output->name);\n    VIR_FREE(output);\n\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvoid\nvirLogOutputFree(virLogOutputPtr output)\n{\n    if (!output)\n        return;\n\n    if (output->c)\n        output->c(output->data);\n    VIR_FREE(output->name);\n    VIR_FREE(output);\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "list",
            "noutputs",
            "output"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogFindOutput",
          "args": [
            "list",
            "noutputs",
            "output->dest",
            "output->name"
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFindOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1363-1377",
          "snippet": "int\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogParseOutput",
          "args": [
            "strings[i]"
          ],
          "line": 1659
        },
        "resolved": true,
        "details": {
          "function_name": "virLogParseOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1477-1550",
          "snippet": "virLogOutputPtr\nvirLogParseOutput(const char *src)\n{\n    virLogOutputPtr ret = NULL;\n    char **tokens = NULL;\n    char *abspath = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    int dest;\n\n    VIR_DEBUG(\"output=%s\", src);\n\n    /* split our format prio:destination:additional_data to tokens and parse\n     * them individually\n     */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count < 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for output '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for output '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    if ((dest = virLogDestinationTypeFromString(tokens[1])) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid destination '%s' for output '%s'\"),\n                       tokens[1], src);\n        goto cleanup;\n    }\n\n    if (((dest == VIR_LOG_TO_STDERR ||\n          dest == VIR_LOG_TO_JOURNALD) && count != 2) ||\n        ((dest == VIR_LOG_TO_FILE ||\n          dest == VIR_LOG_TO_SYSLOG) && count != 3)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Output '%s' does not meet the format requirements \"\n                         \"for destination type '%s'\"), src, tokens[1]);\n        goto cleanup;\n    }\n\n    switch ((virLogDestination) dest) {\n    case VIR_LOG_TO_STDERR:\n        ret = virLogNewOutputToStderr(prio);\n        break;\n    case VIR_LOG_TO_SYSLOG:\n#if HAVE_SYSLOG_H\n        ret = virLogNewOutputToSyslog(prio, tokens[2]);\n#endif\n        break;\n    case VIR_LOG_TO_FILE:\n        if (virFileAbsPath(tokens[2], &abspath) < 0)\n            goto cleanup;\n        ret = virLogNewOutputToFile(prio, abspath);\n        VIR_FREE(abspath);\n        break;\n    case VIR_LOG_TO_JOURNALD:\n#if USE_JOURNALD\n        ret = virLogNewOutputToJournald(prio);\n#endif\n        break;\n    case VIR_LOG_TO_OUTPUT_LAST:\n        break;\n    }\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirLogOutputPtr\nvirLogParseOutput(const char *src)\n{\n    virLogOutputPtr ret = NULL;\n    char **tokens = NULL;\n    char *abspath = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    int dest;\n\n    VIR_DEBUG(\"output=%s\", src);\n\n    /* split our format prio:destination:additional_data to tokens and parse\n     * them individually\n     */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count < 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for output '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for output '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    if ((dest = virLogDestinationTypeFromString(tokens[1])) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid destination '%s' for output '%s'\"),\n                       tokens[1], src);\n        goto cleanup;\n    }\n\n    if (((dest == VIR_LOG_TO_STDERR ||\n          dest == VIR_LOG_TO_JOURNALD) && count != 2) ||\n        ((dest == VIR_LOG_TO_FILE ||\n          dest == VIR_LOG_TO_SYSLOG) && count != 3)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Output '%s' does not meet the format requirements \"\n                         \"for destination type '%s'\"), src, tokens[1]);\n        goto cleanup;\n    }\n\n    switch ((virLogDestination) dest) {\n    case VIR_LOG_TO_STDERR:\n        ret = virLogNewOutputToStderr(prio);\n        break;\n    case VIR_LOG_TO_SYSLOG:\n#if HAVE_SYSLOG_H\n        ret = virLogNewOutputToSyslog(prio, tokens[2]);\n#endif\n        break;\n    case VIR_LOG_TO_FILE:\n        if (virFileAbsPath(tokens[2], &abspath) < 0)\n            goto cleanup;\n        ret = virLogNewOutputToFile(prio, abspath);\n        VIR_FREE(abspath);\n        break;\n    case VIR_LOG_TO_JOURNALD:\n#if USE_JOURNALD\n        ret = virLogNewOutputToJournald(prio);\n#endif\n        break;\n    case VIR_LOG_TO_OUTPUT_LAST:\n        break;\n    }\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "strings[i]",
            "\"\""
          ],
          "line": 1656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "src",
            "\" \"",
            "0",
            "&count"
          ],
          "line": 1651
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"outputs=%s\"",
            "src"
          ],
          "line": 1649
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogParseOutputs(const char *src, virLogOutputPtr **outputs)\n{\n    int ret = -1;\n    int at = -1;\n    size_t noutputs = 0;\n    size_t i, count;\n    char **strings = NULL;\n    virLogOutputPtr output = NULL;\n    virLogOutputPtr *list = NULL;\n\n    VIR_DEBUG(\"outputs=%s\", src);\n\n    if (!(strings = virStringSplitCount(src, \" \", 0, &count)))\n        goto cleanup;\n\n    for (i = 0; i < count; i++) {\n        /* virStringSplit may return empty strings */\n        if (STREQ(strings[i], \"\"))\n            continue;\n\n        if (!(output = virLogParseOutput(strings[i])))\n            goto cleanup;\n\n        /* let's check if a duplicate output does not already exist in which\n         * case we need to replace it with its last occurrence, however, rather\n         * than first deleting the duplicate and then adding the new one, the\n         * new output object is added first so in case of an error we don't\n         * lose the old entry\n         */\n        at = virLogFindOutput(list, noutputs, output->dest, output->name);\n        if (VIR_APPEND_ELEMENT(list, noutputs, output) < 0) {\n            virLogOutputFree(output);\n            goto cleanup;\n        }\n        if (at >= 0) {\n            virLogOutputFree(list[at]);\n            VIR_DELETE_ELEMENT(list, at, noutputs);\n        }\n    }\n\n    ret = noutputs;\n    *outputs = list;\n    list = NULL;\n cleanup:\n    virStringListFree(strings);\n    return ret;\n}"
  },
  {
    "function_name": "virLogParseFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1577-1625",
    "snippet": "virLogFilterPtr\nvirLogParseFilter(const char *src)\n{\n    virLogFilterPtr ret = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    char **tokens = NULL;\n    char *match = NULL;\n\n    VIR_DEBUG(\"filter=%s\", src);\n\n    /* split our format prio:match_str to tokens and parse them individually */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for filter '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for filter '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    match = tokens[1];\n    if (match[0] == '+') {\n        /* '+' used to indicate printing a stack trace,\n         * but we dropped that feature, so just chomp\n         * that leading '+' */\n        match++;\n    }\n\n    /* match string cannot comprise just from a single '+' */\n    if (!*match) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid match string '%s'\"), tokens[1]);\n\n        goto cleanup;\n    }\n\n    if (!(ret = virLogFilterNew(match, prio)))\n        goto cleanup;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "tokens"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogFilterNew",
          "args": [
            "match",
            "prio"
          ],
          "line": 1619
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFilterNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1312-1345",
          "snippet": "virLogFilterPtr\nvirLogFilterNew(const char *match,\n                virLogPriority priority)\n{\n    virLogFilterPtr ret = NULL;\n    char *mdup = NULL;\n    size_t mlen = strlen(match);\n\n    if (priority < VIR_LOG_DEBUG || priority > VIR_LOG_ERROR) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Invalid log priority %d\"),\n                       priority);\n        return NULL;\n    }\n\n    /* We must treat 'foo' as equiv to '*foo*' for g_pattern_match\n     * todo substring matches, so add 2 extra bytes\n     */\n    if (VIR_ALLOC_N_QUIET(mdup, mlen + 3) < 0)\n        return NULL;\n\n    mdup[0] = '*';\n    memcpy(mdup + 1, match, mlen);\n    mdup[mlen + 1] = '*';\n\n    if (VIR_ALLOC_QUIET(ret) < 0) {\n        VIR_FREE(mdup);\n        return NULL;\n    }\n\n    ret->match = mdup;\n    ret->priority = priority;\n\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirLogFilterPtr\nvirLogFilterNew(const char *match,\n                virLogPriority priority)\n{\n    virLogFilterPtr ret = NULL;\n    char *mdup = NULL;\n    size_t mlen = strlen(match);\n\n    if (priority < VIR_LOG_DEBUG || priority > VIR_LOG_ERROR) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Invalid log priority %d\"),\n                       priority);\n        return NULL;\n    }\n\n    /* We must treat 'foo' as equiv to '*foo*' for g_pattern_match\n     * todo substring matches, so add 2 extra bytes\n     */\n    if (VIR_ALLOC_N_QUIET(mdup, mlen + 3) < 0)\n        return NULL;\n\n    mdup[0] = '*';\n    memcpy(mdup + 1, match, mlen);\n    mdup[mlen + 1] = '*';\n\n    if (VIR_ALLOC_QUIET(ret) < 0) {\n        VIR_FREE(mdup);\n        return NULL;\n    }\n\n    ret->match = mdup;\n    ret->priority = priority;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid match string '%s'\")",
            "tokens[1]"
          ],
          "line": 1613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid match string '%s'\""
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid priority '%s' for filter '%s'\")",
            "tokens[0]",
            "src"
          ],
          "line": 1597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "tokens[0]",
            "NULL",
            "10",
            "&prio"
          ],
          "line": 1595
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Malformed format for filter '%s'\")",
            "src"
          ],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "src",
            "\":\"",
            "0",
            "&count"
          ],
          "line": 1589
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"filter=%s\"",
            "src"
          ],
          "line": 1586
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirLogFilterPtr\nvirLogParseFilter(const char *src)\n{\n    virLogFilterPtr ret = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    char **tokens = NULL;\n    char *match = NULL;\n\n    VIR_DEBUG(\"filter=%s\", src);\n\n    /* split our format prio:match_str to tokens and parse them individually */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count != 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for filter '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for filter '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    match = tokens[1];\n    if (match[0] == '+') {\n        /* '+' used to indicate printing a stack trace,\n         * but we dropped that feature, so just chomp\n         * that leading '+' */\n        match++;\n    }\n\n    /* match string cannot comprise just from a single '+' */\n    if (!*match) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid match string '%s'\"), tokens[1]);\n\n        goto cleanup;\n    }\n\n    if (!(ret = virLogFilterNew(match, prio)))\n        goto cleanup;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}"
  },
  {
    "function_name": "virLogParseOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1477-1550",
    "snippet": "virLogOutputPtr\nvirLogParseOutput(const char *src)\n{\n    virLogOutputPtr ret = NULL;\n    char **tokens = NULL;\n    char *abspath = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    int dest;\n\n    VIR_DEBUG(\"output=%s\", src);\n\n    /* split our format prio:destination:additional_data to tokens and parse\n     * them individually\n     */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count < 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for output '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for output '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    if ((dest = virLogDestinationTypeFromString(tokens[1])) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid destination '%s' for output '%s'\"),\n                       tokens[1], src);\n        goto cleanup;\n    }\n\n    if (((dest == VIR_LOG_TO_STDERR ||\n          dest == VIR_LOG_TO_JOURNALD) && count != 2) ||\n        ((dest == VIR_LOG_TO_FILE ||\n          dest == VIR_LOG_TO_SYSLOG) && count != 3)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Output '%s' does not meet the format requirements \"\n                         \"for destination type '%s'\"), src, tokens[1]);\n        goto cleanup;\n    }\n\n    switch ((virLogDestination) dest) {\n    case VIR_LOG_TO_STDERR:\n        ret = virLogNewOutputToStderr(prio);\n        break;\n    case VIR_LOG_TO_SYSLOG:\n#if HAVE_SYSLOG_H\n        ret = virLogNewOutputToSyslog(prio, tokens[2]);\n#endif\n        break;\n    case VIR_LOG_TO_FILE:\n        if (virFileAbsPath(tokens[2], &abspath) < 0)\n            goto cleanup;\n        ret = virLogNewOutputToFile(prio, abspath);\n        VIR_FREE(abspath);\n        break;\n    case VIR_LOG_TO_JOURNALD:\n#if USE_JOURNALD\n        ret = virLogNewOutputToJournald(prio);\n#endif\n        break;\n    case VIR_LOG_TO_OUTPUT_LAST:\n        break;\n    }\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "tokens"
          ],
          "line": 1548
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogNewOutputToJournald",
          "args": [
            "prio"
          ],
          "line": 1540
        },
        "resolved": true,
        "details": {
          "function_name": "virLogNewOutputToJournald",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1006-1028",
          "snippet": "static virLogOutputPtr\nvirLogNewOutputToJournald(int priority)\n{\n    int journalfd;\n    virLogOutputPtr ret = NULL;\n\n    if ((journalfd = socket(AF_UNIX, SOCK_DGRAM, 0)) < 0)\n        return NULL;\n\n    if (virSetInherit(journalfd, false) < 0) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToJournald, virLogCloseFd,\n                                (void *)(intptr_t) journalfd, priority,\n                                VIR_LOG_TO_JOURNALD, NULL))) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr\nvirLogNewOutputToJournald(int priority)\n{\n    int journalfd;\n    virLogOutputPtr ret = NULL;\n\n    if ((journalfd = socket(AF_UNIX, SOCK_DGRAM, 0)) < 0)\n        return NULL;\n\n    if (virSetInherit(journalfd, false) < 0) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToJournald, virLogCloseFd,\n                                (void *)(intptr_t) journalfd, priority,\n                                VIR_LOG_TO_JOURNALD, NULL))) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "abspath"
          ],
          "line": 1536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogNewOutputToFile",
          "args": [
            "prio",
            "abspath"
          ],
          "line": 1535
        },
        "resolved": true,
        "details": {
          "function_name": "virLogNewOutputToFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "690-710",
          "snippet": "static virLogOutputPtr\nvirLogNewOutputToFile(virLogPriority priority,\n                      const char *file)\n{\n    int fd;\n    virLogOutputPtr ret = NULL;\n\n    fd = open(file, O_CREAT | O_APPEND | O_WRONLY, S_IRUSR | S_IWUSR);\n    if (fd < 0) {\n        virReportSystemError(errno, _(\"failed to open %s\"), file);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToFd, virLogCloseFd,\n                                (void *)(intptr_t)fd,\n                                priority, VIR_LOG_TO_FILE, file))) {\n        VIR_LOG_CLOSE(fd);\n        return NULL;\n    }\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr\nvirLogNewOutputToFile(virLogPriority priority,\n                      const char *file)\n{\n    int fd;\n    virLogOutputPtr ret = NULL;\n\n    fd = open(file, O_CREAT | O_APPEND | O_WRONLY, S_IRUSR | S_IWUSR);\n    if (fd < 0) {\n        virReportSystemError(errno, _(\"failed to open %s\"), file);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToFd, virLogCloseFd,\n                                (void *)(intptr_t)fd,\n                                priority, VIR_LOG_TO_FILE, file))) {\n        VIR_LOG_CLOSE(fd);\n        return NULL;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "tokens[2]",
            "&abspath"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogNewOutputToSyslog",
          "args": [
            "prio",
            "tokens[2]"
          ],
          "line": 1529
        },
        "resolved": true,
        "details": {
          "function_name": "virLogNewOutputToSyslog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "775-816",
          "snippet": "static virLogOutputPtr\nvirLogNewOutputToSyslog(virLogPriority priority,\n                        const char *ident)\n{\n    virLogOutputPtr ret = NULL;\n    int at = -1;\n\n    /* There are a couple of issues with syslog:\n     * 1) If we re-opened the connection by calling openlog now, it would change\n     * the message tag immediately which is not what we want, since we might be\n     * in the middle of parsing of a new set of outputs where anything still can\n     * go wrong and we would introduce an inconsistent state to the log. We're\n     * also not holding a lock on the logger if we tried to change the tag\n     * while other workers are actively logging.\n     *\n     * 2) Syslog keeps the open file descriptor private, so we can't just dup()\n     * it like we would do with files if an output already existed.\n     *\n     * If a syslog connection already exists changing the message tag has to be\n     * therefore special-cased and postponed until the very last moment.\n     */\n    if ((at = virLogFindOutput(virLogOutputs, virLogNbOutputs,\n                               VIR_LOG_TO_SYSLOG, NULL)) < 0) {\n        /*\n         * rather than copying @ident, syslog uses caller's reference instead\n         */\n        VIR_FREE(current_ident);\n        current_ident = g_strdup(ident);\n\n        openlog(current_ident, 0, 0);\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToSyslog, virLogCloseSyslog,\n                                NULL, priority, VIR_LOG_TO_SYSLOG, ident))) {\n        if (at < 0) {\n            closelog();\n            VIR_FREE(current_ident);\n        }\n        return NULL;\n    }\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virLogOutputPtr *virLogOutputs;",
            "static size_t virLogNbOutputs;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\n\nstatic virLogOutputPtr\nvirLogNewOutputToSyslog(virLogPriority priority,\n                        const char *ident)\n{\n    virLogOutputPtr ret = NULL;\n    int at = -1;\n\n    /* There are a couple of issues with syslog:\n     * 1) If we re-opened the connection by calling openlog now, it would change\n     * the message tag immediately which is not what we want, since we might be\n     * in the middle of parsing of a new set of outputs where anything still can\n     * go wrong and we would introduce an inconsistent state to the log. We're\n     * also not holding a lock on the logger if we tried to change the tag\n     * while other workers are actively logging.\n     *\n     * 2) Syslog keeps the open file descriptor private, so we can't just dup()\n     * it like we would do with files if an output already existed.\n     *\n     * If a syslog connection already exists changing the message tag has to be\n     * therefore special-cased and postponed until the very last moment.\n     */\n    if ((at = virLogFindOutput(virLogOutputs, virLogNbOutputs,\n                               VIR_LOG_TO_SYSLOG, NULL)) < 0) {\n        /*\n         * rather than copying @ident, syslog uses caller's reference instead\n         */\n        VIR_FREE(current_ident);\n        current_ident = g_strdup(ident);\n\n        openlog(current_ident, 0, 0);\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToSyslog, virLogCloseSyslog,\n                                NULL, priority, VIR_LOG_TO_SYSLOG, ident))) {\n        if (at < 0) {\n            closelog();\n            VIR_FREE(current_ident);\n        }\n        return NULL;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogNewOutputToStderr",
          "args": [
            "prio"
          ],
          "line": 1525
        },
        "resolved": true,
        "details": {
          "function_name": "virLogNewOutputToStderr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "682-687",
          "snippet": "static virLogOutputPtr\nvirLogNewOutputToStderr(virLogPriority priority)\n{\n    return virLogOutputNew(virLogOutputToFd, NULL, (void *)STDERR_FILENO,\n                           priority, VIR_LOG_TO_STDERR, NULL);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr\nvirLogNewOutputToStderr(virLogPriority priority)\n{\n    return virLogOutputNew(virLogOutputToFd, NULL, (void *)STDERR_FILENO,\n                           priority, VIR_LOG_TO_STDERR, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Output '%s' does not meet the format requirements \"\n                         \"for destination type '%s'\")",
            "src",
            "tokens[1]"
          ],
          "line": 1517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Output '%s' does not meet the format requirements \"\n                         \"for destination type '%s'\""
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid destination '%s' for output '%s'\")",
            "tokens[1]",
            "src"
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogDestinationTypeFromString",
          "args": [
            "tokens[1]"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid priority '%s' for output '%s'\")",
            "tokens[0]",
            "src"
          ],
          "line": 1500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "tokens[0]",
            "NULL",
            "10",
            "&prio"
          ],
          "line": 1498
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Malformed format for output '%s'\")",
            "src"
          ],
          "line": 1493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "src",
            "\":\"",
            "0",
            "&count"
          ],
          "line": 1492
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"output=%s\"",
            "src"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirLogOutputPtr\nvirLogParseOutput(const char *src)\n{\n    virLogOutputPtr ret = NULL;\n    char **tokens = NULL;\n    char *abspath = NULL;\n    size_t count = 0;\n    virLogPriority prio;\n    int dest;\n\n    VIR_DEBUG(\"output=%s\", src);\n\n    /* split our format prio:destination:additional_data to tokens and parse\n     * them individually\n     */\n    if (!(tokens = virStringSplitCount(src, \":\", 0, &count)) || count < 2) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Malformed format for output '%s'\"), src);\n        goto cleanup;\n    }\n\n    if (virStrToLong_uip(tokens[0], NULL, 10, &prio) < 0 ||\n        (prio < VIR_LOG_DEBUG) || (prio > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid priority '%s' for output '%s'\"),\n                       tokens[0], src);\n        goto cleanup;\n    }\n\n    if ((dest = virLogDestinationTypeFromString(tokens[1])) < 0) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid destination '%s' for output '%s'\"),\n                       tokens[1], src);\n        goto cleanup;\n    }\n\n    if (((dest == VIR_LOG_TO_STDERR ||\n          dest == VIR_LOG_TO_JOURNALD) && count != 2) ||\n        ((dest == VIR_LOG_TO_FILE ||\n          dest == VIR_LOG_TO_SYSLOG) && count != 3)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Output '%s' does not meet the format requirements \"\n                         \"for destination type '%s'\"), src, tokens[1]);\n        goto cleanup;\n    }\n\n    switch ((virLogDestination) dest) {\n    case VIR_LOG_TO_STDERR:\n        ret = virLogNewOutputToStderr(prio);\n        break;\n    case VIR_LOG_TO_SYSLOG:\n#if HAVE_SYSLOG_H\n        ret = virLogNewOutputToSyslog(prio, tokens[2]);\n#endif\n        break;\n    case VIR_LOG_TO_FILE:\n        if (virFileAbsPath(tokens[2], &abspath) < 0)\n            goto cleanup;\n        ret = virLogNewOutputToFile(prio, abspath);\n        VIR_FREE(abspath);\n        break;\n    case VIR_LOG_TO_JOURNALD:\n#if USE_JOURNALD\n        ret = virLogNewOutputToJournald(prio);\n#endif\n        break;\n    case VIR_LOG_TO_OUTPUT_LAST:\n        break;\n    }\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}"
  },
  {
    "function_name": "virLogDefineFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1437-1450",
    "snippet": "int\nvirLogDefineFilters(virLogFilterPtr *filters, size_t nfilters)\n{\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetFilters();\n    virLogFilters = filters;\n    virLogNbFilters = nfilters;\n    virLogUnlock();\n\n    return 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogFilterPtr *virLogFilters;",
      "static size_t virLogNbFilters;",
      "static void virLogResetFilters(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 1447
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogResetFilters",
          "args": [],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "virLogResetFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "326-333",
          "snippet": "static void\nvirLogResetFilters(void)\n{\n    virLogFilterListFree(virLogFilters, virLogNbFilters);\n    virLogFilters = NULL;\n    virLogNbFilters = 0;\n    virLogFiltersSerial++;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int virLogFiltersSerial = 1;",
            "static virLogFilterPtr *virLogFilters;",
            "static size_t virLogNbFilters;",
            "static void virLogResetFilters(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic void virLogResetFilters(void);\n\nstatic void\nvirLogResetFilters(void)\n{\n    virLogFilterListFree(virLogFilters, virLogNbFilters);\n    virLogFilters = NULL;\n    virLogNbFilters = 0;\n    virLogFiltersSerial++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic void virLogResetFilters(void);\n\nint\nvirLogDefineFilters(virLogFilterPtr *filters, size_t nfilters)\n{\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetFilters();\n    virLogFilters = filters;\n    virLogNbFilters = nfilters;\n    virLogUnlock();\n\n    return 0;\n}"
  },
  {
    "function_name": "virLogDefineOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1389-1423",
    "snippet": "int\nvirLogDefineOutputs(virLogOutputPtr *outputs, size_t noutputs)\n{\n#if HAVE_SYSLOG_H\n    int id;\n    char *tmp = NULL;\n#endif /* HAVE_SYSLOG_H */\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetOutputs();\n\n#if HAVE_SYSLOG_H\n    /* syslog needs to be special-cased, since it keeps the fd in private */\n    if ((id = virLogFindOutput(outputs, noutputs, VIR_LOG_TO_SYSLOG,\n                               current_ident)) != -1) {\n        /* nothing can go wrong now (except for malloc) and since we're also\n         * holding the lock so it's safe to call openlog and change the message\n         * tag\n         */\n        tmp = g_strdup(outputs[id]->name);\n        VIR_FREE(current_ident);\n        current_ident = tmp;\n        openlog(current_ident, 0, 0);\n    }\n#endif /* HAVE_SYSLOG_H */\n\n    virLogOutputs = outputs;\n    virLogNbOutputs = noutputs;\n\n    virLogUnlock();\n    return 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogOutputPtr *virLogOutputs;",
      "static size_t virLogNbOutputs;",
      "static void virLogResetOutputs(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 1421
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openlog",
          "args": [
            "current_ident",
            "0",
            "0"
          ],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "current_ident"
          ],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "outputs[id]->name"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogFindOutput",
          "args": [
            "outputs",
            "noutputs",
            "VIR_LOG_TO_SYSLOG",
            "current_ident"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFindOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1363-1377",
          "snippet": "int\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogResetOutputs",
          "args": [],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "virLogResetOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "373-379",
          "snippet": "static void\nvirLogResetOutputs(void)\n{\n    virLogOutputListFree(virLogOutputs, virLogNbOutputs);\n    virLogOutputs = NULL;\n    virLogNbOutputs = 0;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virLogOutputPtr *virLogOutputs;",
            "static size_t virLogNbOutputs;",
            "static void virLogResetOutputs(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogResetOutputs(void);\n\nstatic void\nvirLogResetOutputs(void)\n{\n    virLogOutputListFree(virLogOutputs, virLogNbOutputs);\n    virLogOutputs = NULL;\n    virLogNbOutputs = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 1400
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 1397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogResetOutputs(void);\n\nint\nvirLogDefineOutputs(virLogOutputPtr *outputs, size_t noutputs)\n{\n#if HAVE_SYSLOG_H\n    int id;\n    char *tmp = NULL;\n#endif /* HAVE_SYSLOG_H */\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetOutputs();\n\n#if HAVE_SYSLOG_H\n    /* syslog needs to be special-cased, since it keeps the fd in private */\n    if ((id = virLogFindOutput(outputs, noutputs, VIR_LOG_TO_SYSLOG,\n                               current_ident)) != -1) {\n        /* nothing can go wrong now (except for malloc) and since we're also\n         * holding the lock so it's safe to call openlog and change the message\n         * tag\n         */\n        tmp = g_strdup(outputs[id]->name);\n        VIR_FREE(current_ident);\n        current_ident = tmp;\n        openlog(current_ident, 0, 0);\n    }\n#endif /* HAVE_SYSLOG_H */\n\n    virLogOutputs = outputs;\n    virLogNbOutputs = noutputs;\n\n    virLogUnlock();\n    return 0;\n}"
  },
  {
    "function_name": "virLogFindOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1363-1377",
    "snippet": "int\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "outputs[i]->name",
            "name"
          ],
          "line": 1372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virLogFilterNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1312-1345",
    "snippet": "virLogFilterPtr\nvirLogFilterNew(const char *match,\n                virLogPriority priority)\n{\n    virLogFilterPtr ret = NULL;\n    char *mdup = NULL;\n    size_t mlen = strlen(match);\n\n    if (priority < VIR_LOG_DEBUG || priority > VIR_LOG_ERROR) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Invalid log priority %d\"),\n                       priority);\n        return NULL;\n    }\n\n    /* We must treat 'foo' as equiv to '*foo*' for g_pattern_match\n     * todo substring matches, so add 2 extra bytes\n     */\n    if (VIR_ALLOC_N_QUIET(mdup, mlen + 3) < 0)\n        return NULL;\n\n    mdup[0] = '*';\n    memcpy(mdup + 1, match, mlen);\n    mdup[mlen + 1] = '*';\n\n    if (VIR_ALLOC_QUIET(ret) < 0) {\n        VIR_FREE(mdup);\n        return NULL;\n    }\n\n    ret->match = mdup;\n    ret->priority = priority;\n\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mdup"
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_QUIET",
          "args": [
            "ret"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "mdup + 1",
            "match",
            "mlen"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N_QUIET",
          "args": [
            "mdup",
            "mlen + 3"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Invalid log priority %d\")",
            "priority"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid log priority %d\""
          ],
          "line": 1321
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "match"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirLogFilterPtr\nvirLogFilterNew(const char *match,\n                virLogPriority priority)\n{\n    virLogFilterPtr ret = NULL;\n    char *mdup = NULL;\n    size_t mlen = strlen(match);\n\n    if (priority < VIR_LOG_DEBUG || priority > VIR_LOG_ERROR) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Invalid log priority %d\"),\n                       priority);\n        return NULL;\n    }\n\n    /* We must treat 'foo' as equiv to '*foo*' for g_pattern_match\n     * todo substring matches, so add 2 extra bytes\n     */\n    if (VIR_ALLOC_N_QUIET(mdup, mlen + 3) < 0)\n        return NULL;\n\n    mdup[0] = '*';\n    memcpy(mdup + 1, match, mlen);\n    mdup[mlen + 1] = '*';\n\n    if (VIR_ALLOC_QUIET(ret) < 0) {\n        VIR_FREE(mdup);\n        return NULL;\n    }\n\n    ret->match = mdup;\n    ret->priority = priority;\n\n    return ret;\n}"
  },
  {
    "function_name": "virLogOutputNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1259-1294",
    "snippet": "virLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ndup"
          ],
          "line": 1281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 1277
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Missing auxiliary data in output definition\")"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvirLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}"
  },
  {
    "function_name": "virLogProbablyLogMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1233-1240",
    "snippet": "bool virLogProbablyLogMessage(const char *str)\n{\n    if (!virLogRegex)\n        return false;\n    if (g_regex_match(virLogRegex, str, 0, NULL))\n        return true;\n    return false;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static GRegex *virLogRegex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_regex_match",
          "args": [
            "virLogRegex",
            "str",
            "0",
            "NULL"
          ],
          "line": 1237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic GRegex *virLogRegex;\n\nbool virLogProbablyLogMessage(const char *str)\n{\n    if (!virLogRegex)\n        return false;\n    if (g_regex_match(virLogRegex, str, 0, NULL))\n        return true;\n    return false;\n}"
  },
  {
    "function_name": "virLogSetFromEnv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1208-1225",
    "snippet": "void\nvirLogSetFromEnv(void)\n{\n    const char *debugEnv;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    debugEnv = getenv(\"LIBVIRT_DEBUG\");\n    if (debugEnv && *debugEnv)\n        virLogSetDefaultPriority(virLogParseDefaultPriority(debugEnv));\n    debugEnv = getenv(\"LIBVIRT_LOG_FILTERS\");\n    if (debugEnv && *debugEnv)\n        virLogSetFilters(debugEnv);\n    debugEnv = getenv(\"LIBVIRT_LOG_OUTPUTS\");\n    if (debugEnv && *debugEnv)\n        virLogSetOutputs(debugEnv);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogSetOutputs",
          "args": [
            "debugEnv"
          ],
          "line": 1224
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1747-1779",
          "snippet": "int\nvirLogSetOutputs(const char *src)\n{\n    int ret = -1;\n    int noutputs = 0;\n    const char *outputstr = virLogDefaultOutput;\n    virLogOutputPtr *outputs = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && *src)\n        outputstr = src;\n\n    /* This can only happen during daemon init when the default output is not\n     * determined yet. It's safe to do, since it's the only place setting the\n     * default output.\n     */\n    if (!outputstr)\n        return 0;\n\n    if ((noutputs = virLogParseOutputs(outputstr, &outputs)) < 0)\n        goto cleanup;\n\n    if (virLogDefineOutputs(outputs, noutputs) < 0)\n        goto cleanup;\n\n    outputs = NULL;\n    ret = 0;\n cleanup:\n    virLogOutputListFree(outputs, noutputs);\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *virLogDefaultOutput;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\n\nint\nvirLogSetOutputs(const char *src)\n{\n    int ret = -1;\n    int noutputs = 0;\n    const char *outputstr = virLogDefaultOutput;\n    virLogOutputPtr *outputs = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && *src)\n        outputstr = src;\n\n    /* This can only happen during daemon init when the default output is not\n     * determined yet. It's safe to do, since it's the only place setting the\n     * default output.\n     */\n    if (!outputstr)\n        return 0;\n\n    if ((noutputs = virLogParseOutputs(outputstr, &outputs)) < 0)\n        goto cleanup;\n\n    if (virLogDefineOutputs(outputs, noutputs) < 0)\n        goto cleanup;\n\n    outputs = NULL;\n    ret = 0;\n cleanup:\n    virLogOutputListFree(outputs, noutputs);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"LIBVIRT_LOG_OUTPUTS\""
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogSetFilters",
          "args": [
            "debugEnv"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1790-1811",
          "snippet": "int\nvirLogSetFilters(const char *src)\n{\n    int ret = -1;\n    int nfilters = 0;\n    virLogFilterPtr *filters = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && (nfilters = virLogParseFilters(src, &filters)) < 0)\n        goto cleanup;\n\n    if (virLogDefineFilters(filters, nfilters) < 0)\n        goto cleanup;\n\n    filters = NULL;\n    ret = 0;\n cleanup:\n    virLogFilterListFree(filters, nfilters);\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogSetFilters(const char *src)\n{\n    int ret = -1;\n    int nfilters = 0;\n    virLogFilterPtr *filters = NULL;\n\n    if (virLogInitialize() < 0)\n        return -1;\n\n    if (src && (nfilters = virLogParseFilters(src, &filters)) < 0)\n        goto cleanup;\n\n    if (virLogDefineFilters(filters, nfilters) < 0)\n        goto cleanup;\n\n    filters = NULL;\n    ret = 0;\n cleanup:\n    virLogFilterListFree(filters, nfilters);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"LIBVIRT_LOG_FILTERS\""
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogSetDefaultPriority",
          "args": [
            "virLogParseDefaultPriority(debugEnv)"
          ],
          "line": 1218
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetDefaultPriority",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "304-318",
          "snippet": "int\nvirLogSetDefaultPriority(virLogPriority priority)\n{\n    if ((priority < VIR_LOG_DEBUG) || (priority > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Failed to set logging priority, argument '%u' is \"\n                         \"invalid\"), priority);\n        return -1;\n    }\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogDefaultPriority = priority;\n    return 0;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nint\nvirLogSetDefaultPriority(virLogPriority priority)\n{\n    if ((priority < VIR_LOG_DEBUG) || (priority > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Failed to set logging priority, argument '%u' is \"\n                         \"invalid\"), priority);\n        return -1;\n    }\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogDefaultPriority = priority;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogParseDefaultPriority",
          "args": [
            "debugEnv"
          ],
          "line": 1218
        },
        "resolved": true,
        "details": {
          "function_name": "virLogParseDefaultPriority",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1187-1199",
          "snippet": "int\nvirLogParseDefaultPriority(const char *priority)\n{\n    if (STREQ(priority, \"1\") || STREQ(priority, \"debug\"))\n        return VIR_LOG_DEBUG;\n    else if (STREQ(priority, \"2\") || STREQ(priority, \"info\"))\n        return VIR_LOG_INFO;\n    else if (STREQ(priority, \"3\") || STREQ(priority, \"warning\"))\n        return VIR_LOG_WARN;\n    else if (STREQ(priority, \"4\") || STREQ(priority, \"error\"))\n        return VIR_LOG_ERROR;\n    return -1;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogParseDefaultPriority(const char *priority)\n{\n    if (STREQ(priority, \"1\") || STREQ(priority, \"debug\"))\n        return VIR_LOG_DEBUG;\n    else if (STREQ(priority, \"2\") || STREQ(priority, \"info\"))\n        return VIR_LOG_INFO;\n    else if (STREQ(priority, \"3\") || STREQ(priority, \"warning\"))\n        return VIR_LOG_WARN;\n    else if (STREQ(priority, \"4\") || STREQ(priority, \"error\"))\n        return VIR_LOG_ERROR;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"LIBVIRT_DEBUG\""
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogSetFromEnv(void)\n{\n    const char *debugEnv;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    debugEnv = getenv(\"LIBVIRT_DEBUG\");\n    if (debugEnv && *debugEnv)\n        virLogSetDefaultPriority(virLogParseDefaultPriority(debugEnv));\n    debugEnv = getenv(\"LIBVIRT_LOG_FILTERS\");\n    if (debugEnv && *debugEnv)\n        virLogSetFilters(debugEnv);\n    debugEnv = getenv(\"LIBVIRT_LOG_OUTPUTS\");\n    if (debugEnv && *debugEnv)\n        virLogSetOutputs(debugEnv);\n}"
  },
  {
    "function_name": "virLogParseDefaultPriority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1187-1199",
    "snippet": "int\nvirLogParseDefaultPriority(const char *priority)\n{\n    if (STREQ(priority, \"1\") || STREQ(priority, \"debug\"))\n        return VIR_LOG_DEBUG;\n    else if (STREQ(priority, \"2\") || STREQ(priority, \"info\"))\n        return VIR_LOG_INFO;\n    else if (STREQ(priority, \"3\") || STREQ(priority, \"warning\"))\n        return VIR_LOG_WARN;\n    else if (STREQ(priority, \"4\") || STREQ(priority, \"error\"))\n        return VIR_LOG_ERROR;\n    return -1;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"error\""
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"4\""
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"warning\""
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"3\""
          ],
          "line": 1194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"info\""
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"2\""
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"debug\""
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "priority",
            "\"1\""
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogParseDefaultPriority(const char *priority)\n{\n    if (STREQ(priority, \"1\") || STREQ(priority, \"debug\"))\n        return VIR_LOG_DEBUG;\n    else if (STREQ(priority, \"2\") || STREQ(priority, \"info\"))\n        return VIR_LOG_INFO;\n    else if (STREQ(priority, \"3\") || STREQ(priority, \"warning\"))\n        return VIR_LOG_WARN;\n    else if (STREQ(priority, \"4\") || STREQ(priority, \"error\"))\n        return VIR_LOG_ERROR;\n    return -1;\n}"
  },
  {
    "function_name": "virLogGetNbOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1163-1167",
    "snippet": "int\nvirLogGetNbOutputs(void)\n{\n    return virLogNbOutputs;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static size_t virLogNbOutputs;"
    ],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic size_t virLogNbOutputs;\n\nint\nvirLogGetNbOutputs(void)\n{\n    return virLogNbOutputs;\n}"
  },
  {
    "function_name": "virLogGetNbFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1151-1155",
    "snippet": "int\nvirLogGetNbFilters(void)\n{\n    return virLogNbFilters;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static size_t virLogNbFilters;"
    ],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic size_t virLogNbFilters;\n\nint\nvirLogGetNbFilters(void)\n{\n    return virLogNbFilters;\n}"
  },
  {
    "function_name": "virLogGetOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1104-1143",
    "snippet": "char *\nvirLogGetOutputs(void)\n{\n    size_t i;\n    virBuffer outputbuf = VIR_BUFFER_INITIALIZER;\n\n    virLogLock();\n    for (i = 0; i < virLogNbOutputs; i++) {\n        virLogDestination dest = virLogOutputs[i]->dest;\n        if (i)\n            virBufferAddChar(&outputbuf, ' ');\n        switch (dest) {\n            case VIR_LOG_TO_SYSLOG:\n            case VIR_LOG_TO_FILE:\n                virBufferAsprintf(&outputbuf, \"%d:%s:%s\",\n                                  virLogOutputs[i]->priority,\n                                  virLogDestinationTypeToString(dest),\n                                  virLogOutputs[i]->name);\n                break;\n            case VIR_LOG_TO_STDERR:\n            case VIR_LOG_TO_JOURNALD:\n                virBufferAsprintf(&outputbuf, \"%d:%s\",\n                                  virLogOutputs[i]->priority,\n                                  virLogDestinationTypeToString(dest));\n                break;\n            case VIR_LOG_TO_OUTPUT_LAST:\n            default:\n                virReportEnumRangeError(virLogDestination, dest);\n                goto error;\n        }\n    }\n\n    virLogUnlock();\n    return virBufferContentAndReset(&outputbuf);\n\n error:\n    virLogUnlock();\n    virBufferFreeAndReset(&outputbuf);\n    return NULL;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogOutputPtr *virLogOutputs;",
      "static size_t virLogNbOutputs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&outputbuf"
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&outputbuf"
          ],
          "line": 1137
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virLogDestination",
            "dest"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&outputbuf",
            "\"%d:%s\"",
            "virLogOutputs[i]->priority",
            "virLogDestinationTypeToString(dest)"
          ],
          "line": 1125
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogDestinationTypeToString",
          "args": [
            "dest"
          ],
          "line": 1127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogDestinationTypeToString",
          "args": [
            "dest"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddChar",
          "args": [
            "&outputbuf",
            "' '"
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAddChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "206-210",
          "snippet": "void\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 1110
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\n\nchar *\nvirLogGetOutputs(void)\n{\n    size_t i;\n    virBuffer outputbuf = VIR_BUFFER_INITIALIZER;\n\n    virLogLock();\n    for (i = 0; i < virLogNbOutputs; i++) {\n        virLogDestination dest = virLogOutputs[i]->dest;\n        if (i)\n            virBufferAddChar(&outputbuf, ' ');\n        switch (dest) {\n            case VIR_LOG_TO_SYSLOG:\n            case VIR_LOG_TO_FILE:\n                virBufferAsprintf(&outputbuf, \"%d:%s:%s\",\n                                  virLogOutputs[i]->priority,\n                                  virLogDestinationTypeToString(dest),\n                                  virLogOutputs[i]->name);\n                break;\n            case VIR_LOG_TO_STDERR:\n            case VIR_LOG_TO_JOURNALD:\n                virBufferAsprintf(&outputbuf, \"%d:%s\",\n                                  virLogOutputs[i]->priority,\n                                  virLogDestinationTypeToString(dest));\n                break;\n            case VIR_LOG_TO_OUTPUT_LAST:\n            default:\n                virReportEnumRangeError(virLogDestination, dest);\n                goto error;\n        }\n    }\n\n    virLogUnlock();\n    return virBufferContentAndReset(&outputbuf);\n\n error:\n    virLogUnlock();\n    virBufferFreeAndReset(&outputbuf);\n    return NULL;\n}"
  },
  {
    "function_name": "virLogGetFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1077-1094",
    "snippet": "char *\nvirLogGetFilters(void)\n{\n    size_t i;\n    virBuffer filterbuf = VIR_BUFFER_INITIALIZER;\n\n    virLogLock();\n    for (i = 0; i < virLogNbFilters; i++) {\n        const char *sep = \":\";\n        virBufferAsprintf(&filterbuf, \"%d%s%s \",\n                          virLogFilters[i]->priority,\n                          sep,\n                          virLogFilters[i]->match);\n    }\n    virLogUnlock();\n\n    return virBufferContentAndReset(&filterbuf);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogFilterPtr *virLogFilters;",
      "static size_t virLogNbFilters;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&filterbuf"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 1091
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&filterbuf",
            "\"%d%s%s \"",
            "virLogFilters[i]->priority",
            "sep",
            "virLogFilters[i]->match"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 1083
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\n\nchar *\nvirLogGetFilters(void)\n{\n    size_t i;\n    virBuffer filterbuf = VIR_BUFFER_INITIALIZER;\n\n    virLogLock();\n    for (i = 0; i < virLogNbFilters; i++) {\n        const char *sep = \":\";\n        virBufferAsprintf(&filterbuf, \"%d%s%s \",\n                          virLogFilters[i]->priority,\n                          sep,\n                          virLogFilters[i]->match);\n    }\n    virLogUnlock();\n\n    return virBufferContentAndReset(&filterbuf);\n}"
  },
  {
    "function_name": "virLogGetDefaultPriority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1063-1067",
    "snippet": "virLogPriority\nvirLogGetDefaultPriority(void)\n{\n    return virLogDefaultPriority;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
    ],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nvirLogPriority\nvirLogGetDefaultPriority(void)\n{\n    return virLogDefaultPriority;\n}"
  },
  {
    "function_name": "virLogPriorityFromSyslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1051-1054",
    "snippet": "int virLogPriorityFromSyslog(int priority G_GNUC_UNUSED)\n{\n    return VIR_LOG_ERROR;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint virLogPriorityFromSyslog(int priority G_GNUC_UNUSED)\n{\n    return VIR_LOG_ERROR;\n}"
  },
  {
    "function_name": "virLogPriorityFromSyslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1031-1048",
    "snippet": "int virLogPriorityFromSyslog(int priority)\n{\n    switch (priority) {\n    case LOG_EMERG:\n    case LOG_ALERT:\n    case LOG_CRIT:\n    case LOG_ERR:\n        return VIR_LOG_ERROR;\n    case LOG_WARNING:\n    case LOG_NOTICE:\n        return VIR_LOG_WARN;\n    case LOG_INFO:\n        return VIR_LOG_INFO;\n    case LOG_DEBUG:\n        return VIR_LOG_DEBUG;\n    }\n    return VIR_LOG_ERROR;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint virLogPriorityFromSyslog(int priority)\n{\n    switch (priority) {\n    case LOG_EMERG:\n    case LOG_ALERT:\n    case LOG_CRIT:\n    case LOG_ERR:\n        return VIR_LOG_ERROR;\n    case LOG_WARNING:\n    case LOG_NOTICE:\n        return VIR_LOG_WARN;\n    case LOG_INFO:\n        return VIR_LOG_INFO;\n    case LOG_DEBUG:\n        return VIR_LOG_DEBUG;\n    }\n    return VIR_LOG_ERROR;\n}"
  },
  {
    "function_name": "virLogNewOutputToJournald",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "1006-1028",
    "snippet": "static virLogOutputPtr\nvirLogNewOutputToJournald(int priority)\n{\n    int journalfd;\n    virLogOutputPtr ret = NULL;\n\n    if ((journalfd = socket(AF_UNIX, SOCK_DGRAM, 0)) < 0)\n        return NULL;\n\n    if (virSetInherit(journalfd, false) < 0) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToJournald, virLogCloseFd,\n                                (void *)(intptr_t) journalfd, priority,\n                                VIR_LOG_TO_JOURNALD, NULL))) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_LOG_CLOSE",
          "args": [
            "journalfd"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputNew",
          "args": [
            "virLogOutputToJournald",
            "virLogCloseFd",
            "(void *)(intptr_t) journalfd",
            "priority",
            "VIR_LOG_TO_JOURNALD",
            "NULL"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1259-1294",
          "snippet": "virLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvirLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_LOG_CLOSE",
          "args": [
            "journalfd"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSetInherit",
          "args": [
            "journalfd",
            "false"
          ],
          "line": 1015
        },
        "resolved": true,
        "details": {
          "function_name": "virSetInherit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "104-111",
          "snippet": "int virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "AF_UNIX",
            "SOCK_DGRAM",
            "0"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "vir_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "351-367",
          "snippet": "int\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr\nvirLogNewOutputToJournald(int priority)\n{\n    int journalfd;\n    virLogOutputPtr ret = NULL;\n\n    if ((journalfd = socket(AF_UNIX, SOCK_DGRAM, 0)) < 0)\n        return NULL;\n\n    if (virSetInherit(journalfd, false) < 0) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToJournald, virLogCloseFd,\n                                (void *)(intptr_t) journalfd, priority,\n                                VIR_LOG_TO_JOURNALD, NULL))) {\n        VIR_LOG_CLOSE(journalfd);\n        return NULL;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virLogOutputToJournald",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "893-1003",
    "snippet": "static void\nvirLogOutputToJournald(virLogSourcePtr source,\n                       virLogPriority priority,\n                       const char *filename,\n                       int linenr,\n                       const char *funcname,\n                       const char *timestamp G_GNUC_UNUSED,\n                       virLogMetadataPtr metadata,\n                       const char *rawstr,\n                       const char *str G_GNUC_UNUSED,\n                       void *data)\n{\n    int buffd = -1;\n    int journalfd = (intptr_t) data;\n    struct msghdr mh;\n    struct sockaddr_un sa;\n    union {\n        struct cmsghdr cmsghdr;\n        uint8_t buf[CMSG_SPACE(sizeof(int))];\n    } control;\n    struct cmsghdr *cmsg;\n    /* We use /dev/shm instead of /tmp here, since we want this to\n     * be a tmpfs, and one that is available from early boot on\n     * and where unprivileged users can create files. */\n    char path[] = \"/dev/shm/journal.XXXXXX\";\n    size_t nmetadata = 0;\n\n#  define NUM_FIELDS_CORE 6\n#  define NUM_FIELDS_META 5\n#  define NUM_FIELDS (NUM_FIELDS_CORE + NUM_FIELDS_META)\n    struct iovec iov[NUM_FIELDS * 5];\n    char iov_bufs[NUM_FIELDS][JOURNAL_BUF_SIZE];\n    struct journalState state;\n\n    state.iov = iov;\n    state.iov_end = iov + G_N_ELEMENTS(iov);\n    state.bufs = iov_bufs;\n    state.bufs_end = iov_bufs + G_N_ELEMENTS(iov_bufs);\n\n    journalAddString(&state, \"MESSAGE\", rawstr);\n    journalAddInt(&state, \"PRIORITY\",\n                  virLogPrioritySyslog(priority));\n    journalAddInt(&state, \"SYSLOG_FACILITY\", LOG_DAEMON);\n    journalAddString(&state, \"LIBVIRT_SOURCE\", source->name);\n    if (filename)\n        journalAddString(&state, \"CODE_FILE\", filename);\n    journalAddInt(&state, \"CODE_LINE\", linenr);\n    if (funcname)\n        journalAddString(&state, \"CODE_FUNC\", funcname);\n    if (metadata != NULL) {\n        while (metadata->key != NULL &&\n               nmetadata < NUM_FIELDS_META) {\n            if (metadata->s != NULL)\n                journalAddString(&state, metadata->key, metadata->s);\n            else\n                journalAddInt(&state, metadata->key, metadata->iv);\n            metadata++;\n            nmetadata++;\n        }\n    }\n\n    memset(&sa, 0, sizeof(sa));\n    sa.sun_family = AF_UNIX;\n    if (virStrcpyStatic(sa.sun_path, \"/run/systemd/journal/socket\") < 0)\n        return;\n\n    memset(&mh, 0, sizeof(mh));\n    mh.msg_name = &sa;\n    mh.msg_namelen = offsetof(struct sockaddr_un, sun_path) + strlen(sa.sun_path);\n    mh.msg_iov = iov;\n    mh.msg_iovlen = state.iov - iov;\n\n    if (sendmsg(journalfd, &mh, MSG_NOSIGNAL) >= 0)\n        return;\n\n    if (errno != EMSGSIZE && errno != ENOBUFS)\n        return;\n\n    /* Message was too large, so dump to temporary file\n     * and pass an FD to the journal\n     */\n\n    if ((buffd = g_mkstemp_full(path, O_RDWR | O_CLOEXEC, S_IRUSR | S_IWUSR)) < 0)\n        return;\n\n    if (unlink(path) < 0)\n        goto cleanup;\n\n    if (writev(buffd, iov, state.iov - iov) < 0)\n        goto cleanup;\n\n    mh.msg_iov = NULL;\n    mh.msg_iovlen = 0;\n\n    memset(&control, 0, sizeof(control));\n    mh.msg_control = &control;\n    mh.msg_controllen = sizeof(control);\n\n    cmsg = CMSG_FIRSTHDR(&mh);\n    cmsg->cmsg_level = SOL_SOCKET;\n    cmsg->cmsg_type = SCM_RIGHTS;\n    cmsg->cmsg_len = CMSG_LEN(sizeof(int));\n    memcpy(CMSG_DATA(cmsg), &buffd, sizeof(int));\n\n    mh.msg_controllen = cmsg->cmsg_len;\n\n    ignore_value(sendmsg(journalfd, &mh, MSG_NOSIGNAL));\n\n cleanup:\n    VIR_LOG_CLOSE(buffd);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_LOG_CLOSE",
          "args": [
            "buffd"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "sendmsg(journalfd, &mh, MSG_NOSIGNAL)"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendmsg",
          "args": [
            "journalfd",
            "&mh",
            "MSG_NOSIGNAL"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "CMSG_DATA(cmsg)",
            "&buffd",
            "sizeof(int)"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_DATA",
          "args": [
            "cmsg"
          ],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_LEN",
          "args": [
            "sizeof(int)"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_FIRSTHDR",
          "args": [
            "&mh"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&control",
            "0",
            "sizeof(control)"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writev",
          "args": [
            "buffd",
            "iov",
            "state.iov - iov"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_mkstemp_full",
          "args": [
            "path",
            "O_RDWR | O_CLOEXEC",
            "S_IRUSR | S_IWUSR"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendmsg",
          "args": [
            "journalfd",
            "&mh",
            "MSG_NOSIGNAL"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "sa.sun_path"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&mh",
            "0",
            "sizeof(mh)"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "sa.sun_path",
            "\"/run/systemd/journal/socket\""
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&sa",
            "0",
            "sizeof(sa)"
          ],
          "line": 954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "journalAddInt",
          "args": [
            "&state",
            "metadata->key",
            "metadata->iv"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "journalAddInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "873-891",
          "snippet": "static void\njournalAddInt(struct journalState *state, const char *field, int value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    char *num;\n\n    if (state->iov_end - state->iov < 4 || state->bufs == state->bufs_end)\n        return; /* Silently drop */\n\n    num = virFormatIntDecimal(state->bufs[0], sizeof(state->bufs[0]), value);\n\n    IOVEC_SET_STRING(state->iov[0], field);\n    IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n    IOVEC_SET_STRING(state->iov[2], num);\n    IOVEC_SET(state->iov[3], (void *)&newline, sizeof(newline));\n    state->bufs++;\n    state->iov += 4;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\njournalAddInt(struct journalState *state, const char *field, int value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    char *num;\n\n    if (state->iov_end - state->iov < 4 || state->bufs == state->bufs_end)\n        return; /* Silently drop */\n\n    num = virFormatIntDecimal(state->bufs[0], sizeof(state->bufs[0]), value);\n\n    IOVEC_SET_STRING(state->iov[0], field);\n    IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n    IOVEC_SET_STRING(state->iov[2], num);\n    IOVEC_SET(state->iov[3], (void *)&newline, sizeof(newline));\n    state->bufs++;\n    state->iov += 4;\n}"
        }
      },
      {
        "call_info": {
          "callee": "journalAddString",
          "args": [
            "&state",
            "metadata->key",
            "metadata->s"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "journalAddString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "838-871",
          "snippet": "static void\njournalAddString(struct journalState *state, const char *field,\n                 const char *value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    if (strchr(value, '\\n') != NULL) {\n        uint64_t nstr;\n\n        /* If 'str' contains a newline, then we must\n         * encode the string length, since we can't\n         * rely on the newline for the field separator\n         */\n        if (state->iov_end - state->iov < 5 || state->bufs == state->bufs_end)\n            return; /* Silently drop */\n        nstr = htole64(strlen(value));\n        memcpy(state->bufs[0], &nstr, sizeof(nstr));\n\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], &newline, sizeof(newline));\n        IOVEC_SET(state->iov[2], state->bufs[0], sizeof(nstr));\n        state->bufs++;\n        state->iov += 3;\n    } else {\n        if (state->iov_end - state->iov < 4)\n            return; /* Silently drop */\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n        state->iov += 2;\n    }\n    IOVEC_SET_STRING(state->iov[0], value);\n    IOVEC_SET(state->iov[1], (void *)&newline, sizeof(newline));\n    state->iov += 2;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\njournalAddString(struct journalState *state, const char *field,\n                 const char *value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    if (strchr(value, '\\n') != NULL) {\n        uint64_t nstr;\n\n        /* If 'str' contains a newline, then we must\n         * encode the string length, since we can't\n         * rely on the newline for the field separator\n         */\n        if (state->iov_end - state->iov < 5 || state->bufs == state->bufs_end)\n            return; /* Silently drop */\n        nstr = htole64(strlen(value));\n        memcpy(state->bufs[0], &nstr, sizeof(nstr));\n\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], &newline, sizeof(newline));\n        IOVEC_SET(state->iov[2], state->bufs[0], sizeof(nstr));\n        state->bufs++;\n        state->iov += 3;\n    } else {\n        if (state->iov_end - state->iov < 4)\n            return; /* Silently drop */\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n        state->iov += 2;\n    }\n    IOVEC_SET_STRING(state->iov[0], value);\n    IOVEC_SET(state->iov[1], (void *)&newline, sizeof(newline));\n    state->iov += 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogPrioritySyslog",
          "args": [
            "priority"
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "virLogPrioritySyslog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "729-744",
          "snippet": "static int\nvirLogPrioritySyslog(virLogPriority priority)\n{\n    switch (priority) {\n    case VIR_LOG_DEBUG:\n        return LOG_DEBUG;\n    case VIR_LOG_INFO:\n        return LOG_INFO;\n    case VIR_LOG_WARN:\n        return LOG_WARNING;\n    case VIR_LOG_ERROR:\n        return LOG_ERR;\n    default:\n        return LOG_ERR;\n    }\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirLogPrioritySyslog(virLogPriority priority)\n{\n    switch (priority) {\n    case VIR_LOG_DEBUG:\n        return LOG_DEBUG;\n    case VIR_LOG_INFO:\n        return LOG_INFO;\n    case VIR_LOG_WARN:\n        return LOG_WARNING;\n    case VIR_LOG_ERROR:\n        return LOG_ERR;\n    default:\n        return LOG_ERR;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "iov_bufs"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "iov"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CMSG_SPACE",
          "args": [
            "sizeof(int)"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nstatic void\nvirLogOutputToJournald(virLogSourcePtr source,\n                       virLogPriority priority,\n                       const char *filename,\n                       int linenr,\n                       const char *funcname,\n                       const char *timestamp G_GNUC_UNUSED,\n                       virLogMetadataPtr metadata,\n                       const char *rawstr,\n                       const char *str G_GNUC_UNUSED,\n                       void *data)\n{\n    int buffd = -1;\n    int journalfd = (intptr_t) data;\n    struct msghdr mh;\n    struct sockaddr_un sa;\n    union {\n        struct cmsghdr cmsghdr;\n        uint8_t buf[CMSG_SPACE(sizeof(int))];\n    } control;\n    struct cmsghdr *cmsg;\n    /* We use /dev/shm instead of /tmp here, since we want this to\n     * be a tmpfs, and one that is available from early boot on\n     * and where unprivileged users can create files. */\n    char path[] = \"/dev/shm/journal.XXXXXX\";\n    size_t nmetadata = 0;\n\n#  define NUM_FIELDS_CORE 6\n#  define NUM_FIELDS_META 5\n#  define NUM_FIELDS (NUM_FIELDS_CORE + NUM_FIELDS_META)\n    struct iovec iov[NUM_FIELDS * 5];\n    char iov_bufs[NUM_FIELDS][JOURNAL_BUF_SIZE];\n    struct journalState state;\n\n    state.iov = iov;\n    state.iov_end = iov + G_N_ELEMENTS(iov);\n    state.bufs = iov_bufs;\n    state.bufs_end = iov_bufs + G_N_ELEMENTS(iov_bufs);\n\n    journalAddString(&state, \"MESSAGE\", rawstr);\n    journalAddInt(&state, \"PRIORITY\",\n                  virLogPrioritySyslog(priority));\n    journalAddInt(&state, \"SYSLOG_FACILITY\", LOG_DAEMON);\n    journalAddString(&state, \"LIBVIRT_SOURCE\", source->name);\n    if (filename)\n        journalAddString(&state, \"CODE_FILE\", filename);\n    journalAddInt(&state, \"CODE_LINE\", linenr);\n    if (funcname)\n        journalAddString(&state, \"CODE_FUNC\", funcname);\n    if (metadata != NULL) {\n        while (metadata->key != NULL &&\n               nmetadata < NUM_FIELDS_META) {\n            if (metadata->s != NULL)\n                journalAddString(&state, metadata->key, metadata->s);\n            else\n                journalAddInt(&state, metadata->key, metadata->iv);\n            metadata++;\n            nmetadata++;\n        }\n    }\n\n    memset(&sa, 0, sizeof(sa));\n    sa.sun_family = AF_UNIX;\n    if (virStrcpyStatic(sa.sun_path, \"/run/systemd/journal/socket\") < 0)\n        return;\n\n    memset(&mh, 0, sizeof(mh));\n    mh.msg_name = &sa;\n    mh.msg_namelen = offsetof(struct sockaddr_un, sun_path) + strlen(sa.sun_path);\n    mh.msg_iov = iov;\n    mh.msg_iovlen = state.iov - iov;\n\n    if (sendmsg(journalfd, &mh, MSG_NOSIGNAL) >= 0)\n        return;\n\n    if (errno != EMSGSIZE && errno != ENOBUFS)\n        return;\n\n    /* Message was too large, so dump to temporary file\n     * and pass an FD to the journal\n     */\n\n    if ((buffd = g_mkstemp_full(path, O_RDWR | O_CLOEXEC, S_IRUSR | S_IWUSR)) < 0)\n        return;\n\n    if (unlink(path) < 0)\n        goto cleanup;\n\n    if (writev(buffd, iov, state.iov - iov) < 0)\n        goto cleanup;\n\n    mh.msg_iov = NULL;\n    mh.msg_iovlen = 0;\n\n    memset(&control, 0, sizeof(control));\n    mh.msg_control = &control;\n    mh.msg_controllen = sizeof(control);\n\n    cmsg = CMSG_FIRSTHDR(&mh);\n    cmsg->cmsg_level = SOL_SOCKET;\n    cmsg->cmsg_type = SCM_RIGHTS;\n    cmsg->cmsg_len = CMSG_LEN(sizeof(int));\n    memcpy(CMSG_DATA(cmsg), &buffd, sizeof(int));\n\n    mh.msg_controllen = cmsg->cmsg_len;\n\n    ignore_value(sendmsg(journalfd, &mh, MSG_NOSIGNAL));\n\n cleanup:\n    VIR_LOG_CLOSE(buffd);\n}"
  },
  {
    "function_name": "journalAddInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "873-891",
    "snippet": "static void\njournalAddInt(struct journalState *state, const char *field, int value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    char *num;\n\n    if (state->iov_end - state->iov < 4 || state->bufs == state->bufs_end)\n        return; /* Silently drop */\n\n    num = virFormatIntDecimal(state->bufs[0], sizeof(state->bufs[0]), value);\n\n    IOVEC_SET_STRING(state->iov[0], field);\n    IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n    IOVEC_SET_STRING(state->iov[2], num);\n    IOVEC_SET(state->iov[3], (void *)&newline, sizeof(newline));\n    state->bufs++;\n    state->iov += 4;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOVEC_SET",
          "args": [
            "state->iov[3]",
            "(void *)&newline",
            "sizeof(newline)"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET_STRING",
          "args": [
            "state->iov[2]",
            "num"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET",
          "args": [
            "state->iov[1]",
            "(void *)&equals",
            "sizeof(equals)"
          ],
          "line": 886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET_STRING",
          "args": [
            "state->iov[0]",
            "field"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFormatIntDecimal",
          "args": [
            "state->bufs[0]",
            "sizeof(state->bufs[0])",
            "value"
          ],
          "line": 883
        },
        "resolved": true,
        "details": {
          "function_name": "virFormatIntDecimal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "292-310",
          "snippet": "char *\nvirFormatIntDecimal(char *buf, size_t buflen, int val)\n{\n    char *p = buf + buflen - 1;\n    *p = '\\0';\n    if (val >= 0) {\n        do {\n            *--p = '0' + (val % 10);\n            val /= 10;\n        } while (val != 0);\n    } else {\n        do {\n            *--p = '0' - (val % 10);\n            val /= 10;\n        } while (val != 0);\n        *--p = '-';\n    }\n    return p;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirFormatIntDecimal(char *buf, size_t buflen, int val)\n{\n    char *p = buf + buflen - 1;\n    *p = '\\0';\n    if (val >= 0) {\n        do {\n            *--p = '0' + (val % 10);\n            val /= 10;\n        } while (val != 0);\n    } else {\n        do {\n            *--p = '0' - (val % 10);\n            val /= 10;\n        } while (val != 0);\n        *--p = '-';\n    }\n    return p;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\njournalAddInt(struct journalState *state, const char *field, int value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    char *num;\n\n    if (state->iov_end - state->iov < 4 || state->bufs == state->bufs_end)\n        return; /* Silently drop */\n\n    num = virFormatIntDecimal(state->bufs[0], sizeof(state->bufs[0]), value);\n\n    IOVEC_SET_STRING(state->iov[0], field);\n    IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n    IOVEC_SET_STRING(state->iov[2], num);\n    IOVEC_SET(state->iov[3], (void *)&newline, sizeof(newline));\n    state->bufs++;\n    state->iov += 4;\n}"
  },
  {
    "function_name": "journalAddString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "838-871",
    "snippet": "static void\njournalAddString(struct journalState *state, const char *field,\n                 const char *value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    if (strchr(value, '\\n') != NULL) {\n        uint64_t nstr;\n\n        /* If 'str' contains a newline, then we must\n         * encode the string length, since we can't\n         * rely on the newline for the field separator\n         */\n        if (state->iov_end - state->iov < 5 || state->bufs == state->bufs_end)\n            return; /* Silently drop */\n        nstr = htole64(strlen(value));\n        memcpy(state->bufs[0], &nstr, sizeof(nstr));\n\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], &newline, sizeof(newline));\n        IOVEC_SET(state->iov[2], state->bufs[0], sizeof(nstr));\n        state->bufs++;\n        state->iov += 3;\n    } else {\n        if (state->iov_end - state->iov < 4)\n            return; /* Silently drop */\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n        state->iov += 2;\n    }\n    IOVEC_SET_STRING(state->iov[0], value);\n    IOVEC_SET(state->iov[1], (void *)&newline, sizeof(newline));\n    state->iov += 2;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOVEC_SET",
          "args": [
            "state->iov[1]",
            "(void *)&newline",
            "sizeof(newline)"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET_STRING",
          "args": [
            "state->iov[0]",
            "value"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET",
          "args": [
            "state->iov[1]",
            "(void *)&equals",
            "sizeof(equals)"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET_STRING",
          "args": [
            "state->iov[0]",
            "field"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET",
          "args": [
            "state->iov[2]",
            "state->bufs[0]",
            "sizeof(nstr)"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET",
          "args": [
            "state->iov[1]",
            "&newline",
            "sizeof(newline)"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOVEC_SET_STRING",
          "args": [
            "state->iov[0]",
            "field"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "state->bufs[0]",
            "&nstr",
            "sizeof(nstr)"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htole64",
          "args": [
            "strlen(value)"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "value",
            "'\\n'"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\njournalAddString(struct journalState *state, const char *field,\n                 const char *value)\n{\n    static const char newline = '\\n', equals = '=';\n\n    if (strchr(value, '\\n') != NULL) {\n        uint64_t nstr;\n\n        /* If 'str' contains a newline, then we must\n         * encode the string length, since we can't\n         * rely on the newline for the field separator\n         */\n        if (state->iov_end - state->iov < 5 || state->bufs == state->bufs_end)\n            return; /* Silently drop */\n        nstr = htole64(strlen(value));\n        memcpy(state->bufs[0], &nstr, sizeof(nstr));\n\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], &newline, sizeof(newline));\n        IOVEC_SET(state->iov[2], state->bufs[0], sizeof(nstr));\n        state->bufs++;\n        state->iov += 3;\n    } else {\n        if (state->iov_end - state->iov < 4)\n            return; /* Silently drop */\n        IOVEC_SET_STRING(state->iov[0], field);\n        IOVEC_SET(state->iov[1], (void *)&equals, sizeof(equals));\n        state->iov += 2;\n    }\n    IOVEC_SET_STRING(state->iov[0], value);\n    IOVEC_SET(state->iov[1], (void *)&newline, sizeof(newline));\n    state->iov += 2;\n}"
  },
  {
    "function_name": "virLogNewOutputToSyslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "775-816",
    "snippet": "static virLogOutputPtr\nvirLogNewOutputToSyslog(virLogPriority priority,\n                        const char *ident)\n{\n    virLogOutputPtr ret = NULL;\n    int at = -1;\n\n    /* There are a couple of issues with syslog:\n     * 1) If we re-opened the connection by calling openlog now, it would change\n     * the message tag immediately which is not what we want, since we might be\n     * in the middle of parsing of a new set of outputs where anything still can\n     * go wrong and we would introduce an inconsistent state to the log. We're\n     * also not holding a lock on the logger if we tried to change the tag\n     * while other workers are actively logging.\n     *\n     * 2) Syslog keeps the open file descriptor private, so we can't just dup()\n     * it like we would do with files if an output already existed.\n     *\n     * If a syslog connection already exists changing the message tag has to be\n     * therefore special-cased and postponed until the very last moment.\n     */\n    if ((at = virLogFindOutput(virLogOutputs, virLogNbOutputs,\n                               VIR_LOG_TO_SYSLOG, NULL)) < 0) {\n        /*\n         * rather than copying @ident, syslog uses caller's reference instead\n         */\n        VIR_FREE(current_ident);\n        current_ident = g_strdup(ident);\n\n        openlog(current_ident, 0, 0);\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToSyslog, virLogCloseSyslog,\n                                NULL, priority, VIR_LOG_TO_SYSLOG, ident))) {\n        if (at < 0) {\n            closelog();\n            VIR_FREE(current_ident);\n        }\n        return NULL;\n    }\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogOutputPtr *virLogOutputs;",
      "static size_t virLogNbOutputs;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "current_ident"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closelog",
          "args": [],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputNew",
          "args": [
            "virLogOutputToSyslog",
            "virLogCloseSyslog",
            "NULL",
            "priority",
            "VIR_LOG_TO_SYSLOG",
            "ident"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1259-1294",
          "snippet": "virLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvirLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openlog",
          "args": [
            "current_ident",
            "0",
            "0"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "ident"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "current_ident"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogFindOutput",
          "args": [
            "virLogOutputs",
            "virLogNbOutputs",
            "VIR_LOG_TO_SYSLOG",
            "NULL"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFindOutput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1363-1377",
          "snippet": "int\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirLogFindOutput(virLogOutputPtr *outputs, size_t noutputs,\n                 virLogDestination dest, const void *opaque)\n{\n    size_t i;\n    const char *name = opaque;\n\n    for (i = 0; i < noutputs; i++) {\n        if (dest == outputs[i]->dest &&\n            (STREQ_NULLABLE(outputs[i]->name, name)))\n                return i;\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\n\nstatic virLogOutputPtr\nvirLogNewOutputToSyslog(virLogPriority priority,\n                        const char *ident)\n{\n    virLogOutputPtr ret = NULL;\n    int at = -1;\n\n    /* There are a couple of issues with syslog:\n     * 1) If we re-opened the connection by calling openlog now, it would change\n     * the message tag immediately which is not what we want, since we might be\n     * in the middle of parsing of a new set of outputs where anything still can\n     * go wrong and we would introduce an inconsistent state to the log. We're\n     * also not holding a lock on the logger if we tried to change the tag\n     * while other workers are actively logging.\n     *\n     * 2) Syslog keeps the open file descriptor private, so we can't just dup()\n     * it like we would do with files if an output already existed.\n     *\n     * If a syslog connection already exists changing the message tag has to be\n     * therefore special-cased and postponed until the very last moment.\n     */\n    if ((at = virLogFindOutput(virLogOutputs, virLogNbOutputs,\n                               VIR_LOG_TO_SYSLOG, NULL)) < 0) {\n        /*\n         * rather than copying @ident, syslog uses caller's reference instead\n         */\n        VIR_FREE(current_ident);\n        current_ident = g_strdup(ident);\n\n        openlog(current_ident, 0, 0);\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToSyslog, virLogCloseSyslog,\n                                NULL, priority, VIR_LOG_TO_SYSLOG, ident))) {\n        if (at < 0) {\n            closelog();\n            VIR_FREE(current_ident);\n        }\n        return NULL;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virLogCloseSyslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "767-772",
    "snippet": "static void\nvirLogCloseSyslog(void *data G_GNUC_UNUSED)\n{\n    closelog();\n    VIR_FREE(current_ident);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "current_ident"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closelog",
          "args": [],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nstatic void\nvirLogCloseSyslog(void *data G_GNUC_UNUSED)\n{\n    closelog();\n    VIR_FREE(current_ident);\n}"
  },
  {
    "function_name": "virLogOutputToSyslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "749-762",
    "snippet": "static void\nvirLogOutputToSyslog(virLogSourcePtr source G_GNUC_UNUSED,\n                     virLogPriority priority,\n                     const char *filename G_GNUC_UNUSED,\n                     int linenr G_GNUC_UNUSED,\n                     const char *funcname G_GNUC_UNUSED,\n                     const char *timestamp G_GNUC_UNUSED,\n                     virLogMetadataPtr metadata G_GNUC_UNUSED,\n                     const char *rawstr G_GNUC_UNUSED,\n                     const char *str,\n                     void *data G_GNUC_UNUSED)\n{\n    syslog(virLogPrioritySyslog(priority), \"%s\", str);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "syslog",
          "args": [
            "virLogPrioritySyslog(priority)",
            "\"%s\"",
            "str"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogPrioritySyslog",
          "args": [
            "priority"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "virLogPrioritySyslog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "729-744",
          "snippet": "static int\nvirLogPrioritySyslog(virLogPriority priority)\n{\n    switch (priority) {\n    case VIR_LOG_DEBUG:\n        return LOG_DEBUG;\n    case VIR_LOG_INFO:\n        return LOG_INFO;\n    case VIR_LOG_WARN:\n        return LOG_WARNING;\n    case VIR_LOG_ERROR:\n        return LOG_ERR;\n    default:\n        return LOG_ERR;\n    }\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirLogPrioritySyslog(virLogPriority priority)\n{\n    switch (priority) {\n    case VIR_LOG_DEBUG:\n        return LOG_DEBUG;\n    case VIR_LOG_INFO:\n        return LOG_INFO;\n    case VIR_LOG_WARN:\n        return LOG_WARNING;\n    case VIR_LOG_ERROR:\n        return LOG_ERR;\n    default:\n        return LOG_ERR;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nstatic void\nvirLogOutputToSyslog(virLogSourcePtr source G_GNUC_UNUSED,\n                     virLogPriority priority,\n                     const char *filename G_GNUC_UNUSED,\n                     int linenr G_GNUC_UNUSED,\n                     const char *funcname G_GNUC_UNUSED,\n                     const char *timestamp G_GNUC_UNUSED,\n                     virLogMetadataPtr metadata G_GNUC_UNUSED,\n                     const char *rawstr G_GNUC_UNUSED,\n                     const char *str,\n                     void *data G_GNUC_UNUSED)\n{\n    syslog(virLogPrioritySyslog(priority), \"%s\", str);\n}"
  },
  {
    "function_name": "virLogPrioritySyslog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "729-744",
    "snippet": "static int\nvirLogPrioritySyslog(virLogPriority priority)\n{\n    switch (priority) {\n    case VIR_LOG_DEBUG:\n        return LOG_DEBUG;\n    case VIR_LOG_INFO:\n        return LOG_INFO;\n    case VIR_LOG_WARN:\n        return LOG_WARNING;\n    case VIR_LOG_ERROR:\n        return LOG_ERR;\n    default:\n        return LOG_ERR;\n    }\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirLogPrioritySyslog(virLogPriority priority)\n{\n    switch (priority) {\n    case VIR_LOG_DEBUG:\n        return LOG_DEBUG;\n    case VIR_LOG_INFO:\n        return LOG_INFO;\n    case VIR_LOG_WARN:\n        return LOG_WARNING;\n    case VIR_LOG_ERROR:\n        return LOG_ERR;\n    default:\n        return LOG_ERR;\n    }\n}"
  },
  {
    "function_name": "virLogNewOutputToFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "690-710",
    "snippet": "static virLogOutputPtr\nvirLogNewOutputToFile(virLogPriority priority,\n                      const char *file)\n{\n    int fd;\n    virLogOutputPtr ret = NULL;\n\n    fd = open(file, O_CREAT | O_APPEND | O_WRONLY, S_IRUSR | S_IWUSR);\n    if (fd < 0) {\n        virReportSystemError(errno, _(\"failed to open %s\"), file);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToFd, virLogCloseFd,\n                                (void *)(intptr_t)fd,\n                                priority, VIR_LOG_TO_FILE, file))) {\n        VIR_LOG_CLOSE(fd);\n        return NULL;\n    }\n    return ret;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_LOG_CLOSE",
          "args": [
            "fd"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputNew",
          "args": [
            "virLogOutputToFd",
            "virLogCloseFd",
            "(void *)(intptr_t)fd",
            "priority",
            "VIR_LOG_TO_FILE",
            "file"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1259-1294",
          "snippet": "virLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvirLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"failed to open %s\")",
            "file"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to open %s\""
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file",
            "O_CREAT | O_APPEND | O_WRONLY",
            "S_IRUSR | S_IWUSR"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr\nvirLogNewOutputToFile(virLogPriority priority,\n                      const char *file)\n{\n    int fd;\n    virLogOutputPtr ret = NULL;\n\n    fd = open(file, O_CREAT | O_APPEND | O_WRONLY, S_IRUSR | S_IWUSR);\n    if (fd < 0) {\n        virReportSystemError(errno, _(\"failed to open %s\"), file);\n        return NULL;\n    }\n\n    if (!(ret = virLogOutputNew(virLogOutputToFd, virLogCloseFd,\n                                (void *)(intptr_t)fd,\n                                priority, VIR_LOG_TO_FILE, file))) {\n        VIR_LOG_CLOSE(fd);\n        return NULL;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virLogNewOutputToStderr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "682-687",
    "snippet": "static virLogOutputPtr\nvirLogNewOutputToStderr(virLogPriority priority)\n{\n    return virLogOutputNew(virLogOutputToFd, NULL, (void *)STDERR_FILENO,\n                           priority, VIR_LOG_TO_STDERR, NULL);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogOutputNew",
          "args": [
            "virLogOutputToFd",
            "NULL",
            "(void *)STDERR_FILENO",
            "priority",
            "VIR_LOG_TO_STDERR",
            "NULL"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1259-1294",
          "snippet": "virLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvirLogOutputPtr\nvirLogOutputNew(virLogOutputFunc f,\n                virLogCloseFunc c,\n                void *data,\n                virLogPriority priority,\n                virLogDestination dest,\n                const char *name)\n{\n    virLogOutputPtr ret = NULL;\n    char *ndup = NULL;\n\n    if (dest == VIR_LOG_TO_SYSLOG || dest == VIR_LOG_TO_FILE) {\n        if (!name) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Missing auxiliary data in output definition\"));\n            return NULL;\n        }\n\n        ndup = g_strdup(name);\n    }\n\n    if (VIR_ALLOC(ret) < 0) {\n        VIR_FREE(ndup);\n        return NULL;\n    }\n\n    ret->logInitMessage = true;\n    ret->f = f;\n    ret->c = c;\n    ret->data = data;\n    ret->priority = priority;\n    ret->dest = dest;\n    ret->name = ndup;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr\nvirLogNewOutputToStderr(virLogPriority priority)\n{\n    return virLogOutputNew(virLogOutputToFd, NULL, (void *)STDERR_FILENO,\n                           priority, VIR_LOG_TO_STDERR, NULL);\n}"
  },
  {
    "function_name": "virLogCloseFd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "673-679",
    "snippet": "static void\nvirLogCloseFd(void *data)\n{\n    int fd = (intptr_t) data;\n\n    VIR_LOG_CLOSE(fd);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_LOG_CLOSE",
          "args": [
            "fd"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nstatic void\nvirLogCloseFd(void *data)\n{\n    int fd = (intptr_t) data;\n\n    VIR_LOG_CLOSE(fd);\n}"
  },
  {
    "function_name": "virLogOutputToFd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "649-670",
    "snippet": "static void\nvirLogOutputToFd(virLogSourcePtr source G_GNUC_UNUSED,\n                 virLogPriority priority G_GNUC_UNUSED,\n                 const char *filename G_GNUC_UNUSED,\n                 int linenr G_GNUC_UNUSED,\n                 const char *funcname G_GNUC_UNUSED,\n                 const char *timestamp,\n                 virLogMetadataPtr metadata G_GNUC_UNUSED,\n                 const char *rawstr G_GNUC_UNUSED,\n                 const char *str,\n                 void *data)\n{\n    int fd = (intptr_t) data;\n    char *msg;\n\n    if (fd < 0)\n        return;\n\n    msg = g_strdup_printf(\"%s: %s\", timestamp, str);\n    ignore_value(safewrite(fd, msg, strlen(msg)));\n    VIR_FREE(msg);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "msg"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "safewrite(fd, msg, strlen(msg))"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "msg",
            "strlen(msg)"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "msg"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s: %s\"",
            "timestamp",
            "str"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nstatic void\nvirLogOutputToFd(virLogSourcePtr source G_GNUC_UNUSED,\n                 virLogPriority priority G_GNUC_UNUSED,\n                 const char *filename G_GNUC_UNUSED,\n                 int linenr G_GNUC_UNUSED,\n                 const char *funcname G_GNUC_UNUSED,\n                 const char *timestamp,\n                 virLogMetadataPtr metadata G_GNUC_UNUSED,\n                 const char *rawstr G_GNUC_UNUSED,\n                 const char *str,\n                 void *data)\n{\n    int fd = (intptr_t) data;\n    char *msg;\n\n    if (fd < 0)\n        return;\n\n    msg = g_strdup_printf(\"%s: %s\", timestamp, str);\n    ignore_value(safewrite(fd, msg, strlen(msg)));\n    VIR_FREE(msg);\n}"
  },
  {
    "function_name": "virLogVMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "534-646",
    "snippet": "void\nvirLogVMessage(virLogSourcePtr source,\n               virLogPriority priority,\n               const char *filename,\n               int linenr,\n               const char *funcname,\n               virLogMetadataPtr metadata,\n               const char *fmt,\n               va_list vargs)\n{\n    static bool logInitMessageStderr = true;\n    char *str = NULL;\n    char *msg = NULL;\n    char timestamp[VIR_TIME_STRING_BUFLEN];\n    size_t i;\n    int saved_errno = errno;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    if (fmt == NULL)\n        return;\n\n    /*\n     * 3 intentionally non-thread safe variable reads.\n     * Since writes to the variable are serialized on\n     * virLogLock, worst case result is a log message\n     * is accidentally dropped or emitted, if another\n     * thread is updating log filter list concurrently\n     * with a log message emission.\n     */\n    if (source->serial < virLogFiltersSerial)\n        virLogSourceUpdate(source);\n    if (priority < source->priority)\n        goto cleanup;\n\n    /*\n     * serialize the error message, add level and timestamp\n     */\n    str = g_strdup_vprintf(fmt, vargs);\n\n    virLogFormatString(&msg, linenr, funcname, priority, str);\n\n    if (virTimeStringNowRaw(timestamp) < 0)\n        timestamp[0] = '\\0';\n\n    virLogLock();\n\n    /*\n     * Push the message to the outputs defined, if none exist then\n     * use stderr.\n     */\n    for (i = 0; i < virLogNbOutputs; i++) {\n        if (priority >= virLogOutputs[i]->priority) {\n            if (virLogOutputs[i]->logInitMessage) {\n                const char *rawinitmsg;\n                char *hoststr = NULL;\n                char *initmsg = NULL;\n                virLogVersionString(&rawinitmsg, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, rawinitmsg, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(initmsg);\n\n                virLogHostnameString(&hoststr, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, hoststr, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(hoststr);\n                VIR_FREE(initmsg);\n                virLogOutputs[i]->logInitMessage = false;\n            }\n            virLogOutputs[i]->f(source, priority,\n                                filename, linenr, funcname,\n                                timestamp, metadata,\n                                str, msg, virLogOutputs[i]->data);\n        }\n    }\n    if (virLogNbOutputs == 0) {\n        if (logInitMessageStderr) {\n            const char *rawinitmsg;\n            char *hoststr = NULL;\n            char *initmsg = NULL;\n            virLogVersionString(&rawinitmsg, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, rawinitmsg, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(initmsg);\n\n            virLogHostnameString(&hoststr, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, hoststr, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(hoststr);\n            VIR_FREE(initmsg);\n            logInitMessageStderr = false;\n        }\n        virLogOutputToFd(source, priority,\n                         filename, linenr, funcname,\n                         timestamp, metadata,\n                         str, msg, (void *) STDERR_FILENO);\n    }\n    virLogUnlock();\n\n cleanup:\n    VIR_FREE(str);\n    VIR_FREE(msg);\n    errno = saved_errno;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int virLogFiltersSerial = 1;",
      "static virLogOutputPtr *virLogOutputs;",
      "static size_t virLogNbOutputs;",
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "msg"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogOutputToFd",
          "args": [
            "source",
            "priority",
            "filename",
            "linenr",
            "funcname",
            "timestamp",
            "metadata",
            "str",
            "msg",
            "(void *) STDERR_FILENO"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputToFd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "649-670",
          "snippet": "static void\nvirLogOutputToFd(virLogSourcePtr source G_GNUC_UNUSED,\n                 virLogPriority priority G_GNUC_UNUSED,\n                 const char *filename G_GNUC_UNUSED,\n                 int linenr G_GNUC_UNUSED,\n                 const char *funcname G_GNUC_UNUSED,\n                 const char *timestamp,\n                 virLogMetadataPtr metadata G_GNUC_UNUSED,\n                 const char *rawstr G_GNUC_UNUSED,\n                 const char *str,\n                 void *data)\n{\n    int fd = (intptr_t) data;\n    char *msg;\n\n    if (fd < 0)\n        return;\n\n    msg = g_strdup_printf(\"%s: %s\", timestamp, str);\n    ignore_value(safewrite(fd, msg, strlen(msg)));\n    VIR_FREE(msg);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nstatic void\nvirLogOutputToFd(virLogSourcePtr source G_GNUC_UNUSED,\n                 virLogPriority priority G_GNUC_UNUSED,\n                 const char *filename G_GNUC_UNUSED,\n                 int linenr G_GNUC_UNUSED,\n                 const char *funcname G_GNUC_UNUSED,\n                 const char *timestamp,\n                 virLogMetadataPtr metadata G_GNUC_UNUSED,\n                 const char *rawstr G_GNUC_UNUSED,\n                 const char *str,\n                 void *data)\n{\n    int fd = (intptr_t) data;\n    char *msg;\n\n    if (fd < 0)\n        return;\n\n    msg = g_strdup_printf(\"%s: %s\", timestamp, str);\n    ignore_value(safewrite(fd, msg, strlen(msg)));\n    VIR_FREE(msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "initmsg"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hoststr"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogHostnameString",
          "args": [
            "&hoststr",
            "&initmsg"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "virLogHostnameString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "454-464",
          "snippet": "static void\nvirLogHostnameString(char **rawmsg,\n                     char **msg)\n{\n    char *hoststr;\n\n    hoststr = g_strdup_printf(\"hostname: %s\", g_get_host_name());\n\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, hoststr);\n    *rawmsg = hoststr;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogHostnameString(char **rawmsg,\n                     char **msg)\n{\n    char *hoststr;\n\n    hoststr = g_strdup_printf(\"hostname: %s\", g_get_host_name());\n\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, hoststr);\n    *rawmsg = hoststr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "initmsg"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogVersionString",
          "args": [
            "&rawinitmsg",
            "&initmsg"
          ],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virLogVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "443-449",
          "snippet": "static void\nvirLogVersionString(const char **rawmsg,\n                    char **msg)\n{\n    *rawmsg = VIR_LOG_VERSION_STRING;\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, VIR_LOG_VERSION_STRING);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogVersionString(const char **rawmsg,\n                    char **msg)\n{\n    *rawmsg = VIR_LOG_VERSION_STRING;\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, VIR_LOG_VERSION_STRING);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogOutputs[i]->f",
          "args": [
            "source",
            "priority",
            "filename",
            "linenr",
            "funcname",
            "timestamp",
            "metadata",
            "str",
            "msg",
            "virLogOutputs[i]->data"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "initmsg"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "hoststr"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputs[i]->f",
          "args": [
            "&virLogSelf",
            "VIR_LOG_INFO",
            "__FILE__",
            "__LINE__",
            "__func__",
            "timestamp",
            "NULL",
            "hoststr",
            "initmsg",
            "virLogOutputs[i]->data"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "initmsg"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputs[i]->f",
          "args": [
            "&virLogSelf",
            "VIR_LOG_INFO",
            "__FILE__",
            "__LINE__",
            "__func__",
            "timestamp",
            "NULL",
            "rawinitmsg",
            "initmsg",
            "virLogOutputs[i]->data"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeStringNowRaw",
          "args": [
            "timestamp"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeStringNowRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "162-170",
          "snippet": "int virTimeStringNowRaw(char *buf)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    return virTimeStringThenRaw(now, buf);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeStringNowRaw(char *buf)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    return virTimeStringThenRaw(now, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogFormatString",
          "args": [
            "&msg",
            "linenr",
            "funcname",
            "priority",
            "str"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFormatString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "417-440",
          "snippet": "static void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "fmt",
            "vargs"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogSourceUpdate",
          "args": [
            "source"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSourceUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "467-486",
          "snippet": "static void\nvirLogSourceUpdate(virLogSourcePtr source)\n{\n    virLogLock();\n    if (source->serial < virLogFiltersSerial) {\n        unsigned int priority = virLogDefaultPriority;\n        size_t i;\n\n        for (i = 0; i < virLogNbFilters; i++) {\n            if (g_pattern_match_simple(virLogFilters[i]->match, source->name)) {\n                priority = virLogFilters[i]->priority;\n                break;\n            }\n        }\n\n        source->priority = priority;\n        source->serial = virLogFiltersSerial;\n    }\n    virLogUnlock();\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int virLogFiltersSerial = 1;",
            "static virLogFilterPtr *virLogFilters;",
            "static size_t virLogNbFilters;",
            "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic void\nvirLogSourceUpdate(virLogSourcePtr source)\n{\n    virLogLock();\n    if (source->serial < virLogFiltersSerial) {\n        unsigned int priority = virLogDefaultPriority;\n        size_t i;\n\n        for (i = 0; i < virLogNbFilters; i++) {\n            if (g_pattern_match_simple(virLogFilters[i]->match, source->name)) {\n                priority = virLogFilters[i]->priority;\n                break;\n            }\n        }\n\n        source->priority = priority;\n        source->serial = virLogFiltersSerial;\n    }\n    virLogUnlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvoid\nvirLogVMessage(virLogSourcePtr source,\n               virLogPriority priority,\n               const char *filename,\n               int linenr,\n               const char *funcname,\n               virLogMetadataPtr metadata,\n               const char *fmt,\n               va_list vargs)\n{\n    static bool logInitMessageStderr = true;\n    char *str = NULL;\n    char *msg = NULL;\n    char timestamp[VIR_TIME_STRING_BUFLEN];\n    size_t i;\n    int saved_errno = errno;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    if (fmt == NULL)\n        return;\n\n    /*\n     * 3 intentionally non-thread safe variable reads.\n     * Since writes to the variable are serialized on\n     * virLogLock, worst case result is a log message\n     * is accidentally dropped or emitted, if another\n     * thread is updating log filter list concurrently\n     * with a log message emission.\n     */\n    if (source->serial < virLogFiltersSerial)\n        virLogSourceUpdate(source);\n    if (priority < source->priority)\n        goto cleanup;\n\n    /*\n     * serialize the error message, add level and timestamp\n     */\n    str = g_strdup_vprintf(fmt, vargs);\n\n    virLogFormatString(&msg, linenr, funcname, priority, str);\n\n    if (virTimeStringNowRaw(timestamp) < 0)\n        timestamp[0] = '\\0';\n\n    virLogLock();\n\n    /*\n     * Push the message to the outputs defined, if none exist then\n     * use stderr.\n     */\n    for (i = 0; i < virLogNbOutputs; i++) {\n        if (priority >= virLogOutputs[i]->priority) {\n            if (virLogOutputs[i]->logInitMessage) {\n                const char *rawinitmsg;\n                char *hoststr = NULL;\n                char *initmsg = NULL;\n                virLogVersionString(&rawinitmsg, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, rawinitmsg, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(initmsg);\n\n                virLogHostnameString(&hoststr, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, hoststr, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(hoststr);\n                VIR_FREE(initmsg);\n                virLogOutputs[i]->logInitMessage = false;\n            }\n            virLogOutputs[i]->f(source, priority,\n                                filename, linenr, funcname,\n                                timestamp, metadata,\n                                str, msg, virLogOutputs[i]->data);\n        }\n    }\n    if (virLogNbOutputs == 0) {\n        if (logInitMessageStderr) {\n            const char *rawinitmsg;\n            char *hoststr = NULL;\n            char *initmsg = NULL;\n            virLogVersionString(&rawinitmsg, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, rawinitmsg, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(initmsg);\n\n            virLogHostnameString(&hoststr, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, hoststr, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(hoststr);\n            VIR_FREE(initmsg);\n            logInitMessageStderr = false;\n        }\n        virLogOutputToFd(source, priority,\n                         filename, linenr, funcname,\n                         timestamp, metadata,\n                         str, msg, (void *) STDERR_FILENO);\n    }\n    virLogUnlock();\n\n cleanup:\n    VIR_FREE(str);\n    VIR_FREE(msg);\n    errno = saved_errno;\n}"
  },
  {
    "function_name": "virLogMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "502-517",
    "snippet": "void\nvirLogMessage(virLogSourcePtr source,\n              virLogPriority priority,\n              const char *filename,\n              int linenr,\n              const char *funcname,\n              virLogMetadataPtr metadata,\n              const char *fmt, ...)\n{\n    va_list ap;\n    va_start(ap, fmt);\n    virLogVMessage(source, priority,\n                   filename, linenr, funcname,\n                   metadata, fmt, ap);\n    va_end(ap);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogVMessage",
          "args": [
            "source",
            "priority",
            "filename",
            "linenr",
            "funcname",
            "metadata",
            "fmt",
            "ap"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "virLogVMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "534-646",
          "snippet": "void\nvirLogVMessage(virLogSourcePtr source,\n               virLogPriority priority,\n               const char *filename,\n               int linenr,\n               const char *funcname,\n               virLogMetadataPtr metadata,\n               const char *fmt,\n               va_list vargs)\n{\n    static bool logInitMessageStderr = true;\n    char *str = NULL;\n    char *msg = NULL;\n    char timestamp[VIR_TIME_STRING_BUFLEN];\n    size_t i;\n    int saved_errno = errno;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    if (fmt == NULL)\n        return;\n\n    /*\n     * 3 intentionally non-thread safe variable reads.\n     * Since writes to the variable are serialized on\n     * virLogLock, worst case result is a log message\n     * is accidentally dropped or emitted, if another\n     * thread is updating log filter list concurrently\n     * with a log message emission.\n     */\n    if (source->serial < virLogFiltersSerial)\n        virLogSourceUpdate(source);\n    if (priority < source->priority)\n        goto cleanup;\n\n    /*\n     * serialize the error message, add level and timestamp\n     */\n    str = g_strdup_vprintf(fmt, vargs);\n\n    virLogFormatString(&msg, linenr, funcname, priority, str);\n\n    if (virTimeStringNowRaw(timestamp) < 0)\n        timestamp[0] = '\\0';\n\n    virLogLock();\n\n    /*\n     * Push the message to the outputs defined, if none exist then\n     * use stderr.\n     */\n    for (i = 0; i < virLogNbOutputs; i++) {\n        if (priority >= virLogOutputs[i]->priority) {\n            if (virLogOutputs[i]->logInitMessage) {\n                const char *rawinitmsg;\n                char *hoststr = NULL;\n                char *initmsg = NULL;\n                virLogVersionString(&rawinitmsg, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, rawinitmsg, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(initmsg);\n\n                virLogHostnameString(&hoststr, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, hoststr, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(hoststr);\n                VIR_FREE(initmsg);\n                virLogOutputs[i]->logInitMessage = false;\n            }\n            virLogOutputs[i]->f(source, priority,\n                                filename, linenr, funcname,\n                                timestamp, metadata,\n                                str, msg, virLogOutputs[i]->data);\n        }\n    }\n    if (virLogNbOutputs == 0) {\n        if (logInitMessageStderr) {\n            const char *rawinitmsg;\n            char *hoststr = NULL;\n            char *initmsg = NULL;\n            virLogVersionString(&rawinitmsg, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, rawinitmsg, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(initmsg);\n\n            virLogHostnameString(&hoststr, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, hoststr, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(hoststr);\n            VIR_FREE(initmsg);\n            logInitMessageStderr = false;\n        }\n        virLogOutputToFd(source, priority,\n                         filename, linenr, funcname,\n                         timestamp, metadata,\n                         str, msg, (void *) STDERR_FILENO);\n    }\n    virLogUnlock();\n\n cleanup:\n    VIR_FREE(str);\n    VIR_FREE(msg);\n    errno = saved_errno;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int virLogFiltersSerial = 1;",
            "static virLogOutputPtr *virLogOutputs;",
            "static size_t virLogNbOutputs;",
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvoid\nvirLogVMessage(virLogSourcePtr source,\n               virLogPriority priority,\n               const char *filename,\n               int linenr,\n               const char *funcname,\n               virLogMetadataPtr metadata,\n               const char *fmt,\n               va_list vargs)\n{\n    static bool logInitMessageStderr = true;\n    char *str = NULL;\n    char *msg = NULL;\n    char timestamp[VIR_TIME_STRING_BUFLEN];\n    size_t i;\n    int saved_errno = errno;\n\n    if (virLogInitialize() < 0)\n        return;\n\n    if (fmt == NULL)\n        return;\n\n    /*\n     * 3 intentionally non-thread safe variable reads.\n     * Since writes to the variable are serialized on\n     * virLogLock, worst case result is a log message\n     * is accidentally dropped or emitted, if another\n     * thread is updating log filter list concurrently\n     * with a log message emission.\n     */\n    if (source->serial < virLogFiltersSerial)\n        virLogSourceUpdate(source);\n    if (priority < source->priority)\n        goto cleanup;\n\n    /*\n     * serialize the error message, add level and timestamp\n     */\n    str = g_strdup_vprintf(fmt, vargs);\n\n    virLogFormatString(&msg, linenr, funcname, priority, str);\n\n    if (virTimeStringNowRaw(timestamp) < 0)\n        timestamp[0] = '\\0';\n\n    virLogLock();\n\n    /*\n     * Push the message to the outputs defined, if none exist then\n     * use stderr.\n     */\n    for (i = 0; i < virLogNbOutputs; i++) {\n        if (priority >= virLogOutputs[i]->priority) {\n            if (virLogOutputs[i]->logInitMessage) {\n                const char *rawinitmsg;\n                char *hoststr = NULL;\n                char *initmsg = NULL;\n                virLogVersionString(&rawinitmsg, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, rawinitmsg, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(initmsg);\n\n                virLogHostnameString(&hoststr, &initmsg);\n                virLogOutputs[i]->f(&virLogSelf, VIR_LOG_INFO,\n                                    __FILE__, __LINE__, __func__,\n                                    timestamp, NULL, hoststr, initmsg,\n                                    virLogOutputs[i]->data);\n                VIR_FREE(hoststr);\n                VIR_FREE(initmsg);\n                virLogOutputs[i]->logInitMessage = false;\n            }\n            virLogOutputs[i]->f(source, priority,\n                                filename, linenr, funcname,\n                                timestamp, metadata,\n                                str, msg, virLogOutputs[i]->data);\n        }\n    }\n    if (virLogNbOutputs == 0) {\n        if (logInitMessageStderr) {\n            const char *rawinitmsg;\n            char *hoststr = NULL;\n            char *initmsg = NULL;\n            virLogVersionString(&rawinitmsg, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, rawinitmsg, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(initmsg);\n\n            virLogHostnameString(&hoststr, &initmsg);\n            virLogOutputToFd(&virLogSelf, VIR_LOG_INFO,\n                             __FILE__, __LINE__, __func__,\n                             timestamp, NULL, hoststr, initmsg,\n                             (void *) STDERR_FILENO);\n            VIR_FREE(hoststr);\n            VIR_FREE(initmsg);\n            logInitMessageStderr = false;\n        }\n        virLogOutputToFd(source, priority,\n                         filename, linenr, funcname,\n                         timestamp, metadata,\n                         str, msg, (void *) STDERR_FILENO);\n    }\n    virLogUnlock();\n\n cleanup:\n    VIR_FREE(str);\n    VIR_FREE(msg);\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogMessage(virLogSourcePtr source,\n              virLogPriority priority,\n              const char *filename,\n              int linenr,\n              const char *funcname,\n              virLogMetadataPtr metadata,\n              const char *fmt, ...)\n{\n    va_list ap;\n    va_start(ap, fmt);\n    virLogVMessage(source, priority,\n                   filename, linenr, funcname,\n                   metadata, fmt, ap);\n    va_end(ap);\n}"
  },
  {
    "function_name": "virLogSourceUpdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "467-486",
    "snippet": "static void\nvirLogSourceUpdate(virLogSourcePtr source)\n{\n    virLogLock();\n    if (source->serial < virLogFiltersSerial) {\n        unsigned int priority = virLogDefaultPriority;\n        size_t i;\n\n        for (i = 0; i < virLogNbFilters; i++) {\n            if (g_pattern_match_simple(virLogFilters[i]->match, source->name)) {\n                priority = virLogFilters[i]->priority;\n                break;\n            }\n        }\n\n        source->priority = priority;\n        source->serial = virLogFiltersSerial;\n    }\n    virLogUnlock();\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int virLogFiltersSerial = 1;",
      "static virLogFilterPtr *virLogFilters;",
      "static size_t virLogNbFilters;",
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_pattern_match_simple",
          "args": [
            "virLogFilters[i]->match",
            "source->name"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic void\nvirLogSourceUpdate(virLogSourcePtr source)\n{\n    virLogLock();\n    if (source->serial < virLogFiltersSerial) {\n        unsigned int priority = virLogDefaultPriority;\n        size_t i;\n\n        for (i = 0; i < virLogNbFilters; i++) {\n            if (g_pattern_match_simple(virLogFilters[i]->match, source->name)) {\n                priority = virLogFilters[i]->priority;\n                break;\n            }\n        }\n\n        source->priority = priority;\n        source->serial = virLogFiltersSerial;\n    }\n    virLogUnlock();\n}"
  },
  {
    "function_name": "virLogHostnameString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "454-464",
    "snippet": "static void\nvirLogHostnameString(char **rawmsg,\n                     char **msg)\n{\n    char *hoststr;\n\n    hoststr = g_strdup_printf(\"hostname: %s\", g_get_host_name());\n\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, hoststr);\n    *rawmsg = hoststr;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogFormatString",
          "args": [
            "msg",
            "0",
            "NULL",
            "VIR_LOG_INFO",
            "hoststr"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFormatString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "417-440",
          "snippet": "static void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"hostname: %s\"",
            "g_get_host_name()"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_host_name",
          "args": [],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogHostnameString(char **rawmsg,\n                     char **msg)\n{\n    char *hoststr;\n\n    hoststr = g_strdup_printf(\"hostname: %s\", g_get_host_name());\n\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, hoststr);\n    *rawmsg = hoststr;\n}"
  },
  {
    "function_name": "virLogVersionString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "443-449",
    "snippet": "static void\nvirLogVersionString(const char **rawmsg,\n                    char **msg)\n{\n    *rawmsg = VIR_LOG_VERSION_STRING;\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, VIR_LOG_VERSION_STRING);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogFormatString",
          "args": [
            "msg",
            "0",
            "NULL",
            "VIR_LOG_INFO",
            "VIR_LOG_VERSION_STRING"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFormatString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "417-440",
          "snippet": "static void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogVersionString(const char **rawmsg,\n                    char **msg)\n{\n    *rawmsg = VIR_LOG_VERSION_STRING;\n    virLogFormatString(msg, 0, NULL, VIR_LOG_INFO, VIR_LOG_VERSION_STRING);\n}"
  },
  {
    "function_name": "virLogFormatString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "417-440",
    "snippet": "static void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%llu: %s : %s\\n\"",
            "virThreadSelfID()",
            "virLogPriorityString(priority)",
            "str"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogPriorityString",
          "args": [
            "priority"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "virLogPriorityString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "230-244",
          "snippet": "static const char *\nvirLogPriorityString(virLogPriority lvl)\n{\n    switch (lvl) {\n    case VIR_LOG_DEBUG:\n        return \"debug\";\n    case VIR_LOG_INFO:\n        return \"info\";\n    case VIR_LOG_WARN:\n        return \"warning\";\n    case VIR_LOG_ERROR:\n        return \"error\";\n    }\n    return \"unknown\";\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic const char *\nvirLogPriorityString(virLogPriority lvl)\n{\n    switch (lvl) {\n    case VIR_LOG_DEBUG:\n        return \"debug\";\n    case VIR_LOG_INFO:\n        return \"info\";\n    case VIR_LOG_WARN:\n        return \"warning\";\n    case VIR_LOG_ERROR:\n        return \"error\";\n    }\n    return \"unknown\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "virThreadSelfID",
          "args": [],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadSelfID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "298-311",
          "snippet": "unsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nunsigned long long virThreadSelfID(void)\n{\n#if defined(HAVE_SYS_SYSCALL_H) && defined(SYS_gettid) && defined(__linux__)\n    pid_t tid = syscall(SYS_gettid);\n    return tid;\n#else\n    union {\n        unsigned long long l;\n        pthread_t t;\n    } u;\n    u.t = pthread_self();\n    return u.l;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLogFormatString(char **msg,\n                   int linenr,\n                   const char *funcname,\n                   virLogPriority priority,\n                   const char *str)\n{\n    /*\n     * Be careful when changing the following log message formatting, we rely\n     * on it when stripping libvirt debug messages from qemu log files. So when\n     * changing this, you might also need to change the code there.\n     * virLogFormatString() function name is mentioned there so it's sufficient\n     * to just grep for it to find the right place.\n     */\n    if ((funcname != NULL)) {\n        *msg = g_strdup_printf(\"%llu: %s : %s:%d : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               funcname, linenr, str);\n    } else {\n        *msg = g_strdup_printf(\"%llu: %s : %s\\n\",\n                               virThreadSelfID(), virLogPriorityString(priority),\n                               str);\n    }\n}"
  },
  {
    "function_name": "virLogOutputListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "403-414",
    "snippet": "void\nvirLogOutputListFree(virLogOutputPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogOutputFree(list[i]);\n    VIR_FREE(list);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogOutputFree",
          "args": [
            "list[i]"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "382-393",
          "snippet": "void\nvirLogOutputFree(virLogOutputPtr output)\n{\n    if (!output)\n        return;\n\n    if (output->c)\n        output->c(output->data);\n    VIR_FREE(output->name);\n    VIR_FREE(output);\n\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvoid\nvirLogOutputFree(virLogOutputPtr output)\n{\n    if (!output)\n        return;\n\n    if (output->c)\n        output->c(output->data);\n    VIR_FREE(output->name);\n    VIR_FREE(output);\n\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogOutputListFree(virLogOutputPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogOutputFree(list[i]);\n    VIR_FREE(list);\n}"
  },
  {
    "function_name": "virLogOutputFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "382-393",
    "snippet": "void\nvirLogOutputFree(virLogOutputPtr output)\n{\n    if (!output)\n        return;\n\n    if (output->c)\n        output->c(output->data);\n    VIR_FREE(output->name);\n    VIR_FREE(output);\n\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "output"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "output->name"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output->c",
          "args": [
            "output->data"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic void virLogOutputToFd(virLogSourcePtr src,\n                             virLogPriority priority,\n                             const char *filename,\n                             int linenr,\n                             const char *funcname,\n                             const char *timestamp,\n                             virLogMetadataPtr metadata,\n                             const char *rawstr,\n                             const char *str,\n                             void *data);\n\nvoid\nvirLogOutputFree(virLogOutputPtr output)\n{\n    if (!output)\n        return;\n\n    if (output->c)\n        output->c(output->data);\n    VIR_FREE(output->name);\n    VIR_FREE(output);\n\n}"
  },
  {
    "function_name": "virLogResetOutputs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "373-379",
    "snippet": "static void\nvirLogResetOutputs(void)\n{\n    virLogOutputListFree(virLogOutputs, virLogNbOutputs);\n    virLogOutputs = NULL;\n    virLogNbOutputs = 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogOutputPtr *virLogOutputs;",
      "static size_t virLogNbOutputs;",
      "static void virLogResetOutputs(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogOutputListFree",
          "args": [
            "virLogOutputs",
            "virLogNbOutputs"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "virLogOutputListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "403-414",
          "snippet": "void\nvirLogOutputListFree(virLogOutputPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogOutputFree(list[i]);\n    VIR_FREE(list);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogOutputListFree(virLogOutputPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogOutputFree(list[i]);\n    VIR_FREE(list);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogResetOutputs(void);\n\nstatic void\nvirLogResetOutputs(void)\n{\n    virLogOutputListFree(virLogOutputs, virLogNbOutputs);\n    virLogOutputs = NULL;\n    virLogNbOutputs = 0;\n}"
  },
  {
    "function_name": "virLogFilterListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "354-365",
    "snippet": "void\nvirLogFilterListFree(virLogFilterPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogFilterFree(list[i]);\n    VIR_FREE(list);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogFilterFree",
          "args": [
            "list[i]"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFilterFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "336-344",
          "snippet": "void\nvirLogFilterFree(virLogFilterPtr filter)\n{\n    if (!filter)\n        return;\n\n    VIR_FREE(filter->match);\n    VIR_FREE(filter);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogFilterFree(virLogFilterPtr filter)\n{\n    if (!filter)\n        return;\n\n    VIR_FREE(filter->match);\n    VIR_FREE(filter);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogFilterListFree(virLogFilterPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogFilterFree(list[i]);\n    VIR_FREE(list);\n}"
  },
  {
    "function_name": "virLogFilterFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "336-344",
    "snippet": "void\nvirLogFilterFree(virLogFilterPtr filter)\n{\n    if (!filter)\n        return;\n\n    VIR_FREE(filter->match);\n    VIR_FREE(filter);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter->match"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogFilterFree(virLogFilterPtr filter)\n{\n    if (!filter)\n        return;\n\n    VIR_FREE(filter->match);\n    VIR_FREE(filter);\n}"
  },
  {
    "function_name": "virLogResetFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "326-333",
    "snippet": "static void\nvirLogResetFilters(void)\n{\n    virLogFilterListFree(virLogFilters, virLogNbFilters);\n    virLogFilters = NULL;\n    virLogNbFilters = 0;\n    virLogFiltersSerial++;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int virLogFiltersSerial = 1;",
      "static virLogFilterPtr *virLogFilters;",
      "static size_t virLogNbFilters;",
      "static void virLogResetFilters(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogFilterListFree",
          "args": [
            "virLogFilters",
            "virLogNbFilters"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virLogFilterListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "354-365",
          "snippet": "void\nvirLogFilterListFree(virLogFilterPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogFilterFree(list[i]);\n    VIR_FREE(list);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogFilterListFree(virLogFilterPtr *list, int count)\n{\n    size_t i;\n\n    if (!list || count < 0)\n        return;\n\n    for (i = 0; i < count; i++)\n        virLogFilterFree(list[i]);\n    VIR_FREE(list);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic void virLogResetFilters(void);\n\nstatic void\nvirLogResetFilters(void)\n{\n    virLogFilterListFree(virLogFilters, virLogNbFilters);\n    virLogFilters = NULL;\n    virLogNbFilters = 0;\n    virLogFiltersSerial++;\n}"
  },
  {
    "function_name": "virLogSetDefaultPriority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "304-318",
    "snippet": "int\nvirLogSetDefaultPriority(virLogPriority priority)\n{\n    if ((priority < VIR_LOG_DEBUG) || (priority > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Failed to set logging priority, argument '%u' is \"\n                         \"invalid\"), priority);\n        return -1;\n    }\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogDefaultPriority = priority;\n    return 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Failed to set logging priority, argument '%u' is \"\n                         \"invalid\")",
            "priority"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to set logging priority, argument '%u' is \"\n                         \"invalid\""
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nint\nvirLogSetDefaultPriority(virLogPriority priority)\n{\n    if ((priority < VIR_LOG_DEBUG) || (priority > VIR_LOG_ERROR)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Failed to set logging priority, argument '%u' is \"\n                         \"invalid\"), priority);\n        return -1;\n    }\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogDefaultPriority = priority;\n    return 0;\n}"
  },
  {
    "function_name": "virLogReset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "280-292",
    "snippet": "int\nvirLogReset(void)\n{\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetFilters();\n    virLogResetOutputs();\n    virLogDefaultPriority = VIR_LOG_DEFAULT;\n    virLogUnlock();\n    return 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;",
      "static void virLogResetFilters(void);",
      "static void virLogResetOutputs(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogResetOutputs",
          "args": [],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "virLogResetOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "373-379",
          "snippet": "static void\nvirLogResetOutputs(void)\n{\n    virLogOutputListFree(virLogOutputs, virLogNbOutputs);\n    virLogOutputs = NULL;\n    virLogNbOutputs = 0;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virLogOutputPtr *virLogOutputs;",
            "static size_t virLogNbOutputs;",
            "static void virLogResetOutputs(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogOutputPtr *virLogOutputs;\nstatic size_t virLogNbOutputs;\nstatic void virLogResetOutputs(void);\n\nstatic void\nvirLogResetOutputs(void)\n{\n    virLogOutputListFree(virLogOutputs, virLogNbOutputs);\n    virLogOutputs = NULL;\n    virLogNbOutputs = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogResetFilters",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "virLogResetFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "326-333",
          "snippet": "static void\nvirLogResetFilters(void)\n{\n    virLogFilterListFree(virLogFilters, virLogNbFilters);\n    virLogFilters = NULL;\n    virLogNbFilters = 0;\n    virLogFiltersSerial++;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int virLogFiltersSerial = 1;",
            "static virLogFilterPtr *virLogFilters;",
            "static size_t virLogNbFilters;",
            "static void virLogResetFilters(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic int virLogFiltersSerial = 1;\nstatic virLogFilterPtr *virLogFilters;\nstatic size_t virLogNbFilters;\nstatic void virLogResetFilters(void);\n\nstatic void\nvirLogResetFilters(void)\n{\n    virLogFilterListFree(virLogFilters, virLogNbFilters);\n    virLogFilters = NULL;\n    virLogNbFilters = 0;\n    virLogFiltersSerial++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogInitialize",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\nstatic void virLogResetFilters(void);\nstatic void virLogResetOutputs(void);\n\nint\nvirLogReset(void)\n{\n    if (virLogInitialize() < 0)\n        return -1;\n\n    virLogLock();\n    virLogResetFilters();\n    virLogResetOutputs();\n    virLogDefaultPriority = VIR_LOG_DEFAULT;\n    virLogUnlock();\n    return 0;\n}"
  },
  {
    "function_name": "virLogOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "247-268",
    "snippet": "static int\nvirLogOnceInit(void)\n{\n    if (virMutexInit(&virLogMutex) < 0)\n        return -1;\n\n    virLogLock();\n    virLogDefaultPriority = VIR_LOG_DEFAULT;\n\n    virLogRegex = g_regex_new(VIR_LOG_REGEX, G_REGEX_OPTIMIZE, 0, NULL);\n\n    /* GLib caches the hostname using a one time thread initializer.\n     * We want to prime this cache early though, because at later time\n     * it might not be possible to load NSS modules via getaddrinfo()\n     * (e.g. at container startup the host filesystem will not be\n     * accessible anymore.\n     */\n    ignore_value(g_get_host_name());\n\n    virLogUnlock();\n    return 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_LOG_REGEX \\\n    VIR_LOG_DATE_REGEX \" \" VIR_LOG_TIME_REGEX \": \" \\\n    VIR_LOG_PID_REGEX \": \" VIR_LOG_LEVEL_REGEX \" : \""
    ],
    "globals_used": [
      "static GRegex *virLogRegex;",
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;",
      "virMutex virLogMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogUnlock",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "virLogUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "137-141",
          "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "g_get_host_name()"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_get_host_name",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_regex_new",
          "args": [
            "VIR_LOG_REGEX",
            "G_REGEX_OPTIMIZE",
            "0",
            "NULL"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogLock",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "virLogLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "130-134",
          "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virMutex virLogMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexInit",
          "args": [
            "&virLogMutex"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\n#define VIR_LOG_REGEX \\\n    VIR_LOG_DATE_REGEX \" \" VIR_LOG_TIME_REGEX \": \" \\\n    VIR_LOG_PID_REGEX \": \" VIR_LOG_LEVEL_REGEX \" : \"\n\nstatic GRegex *virLogRegex;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\nvirMutex virLogMutex;\n\nstatic int\nvirLogOnceInit(void)\n{\n    if (virMutexInit(&virLogMutex) < 0)\n        return -1;\n\n    virLogLock();\n    virLogDefaultPriority = VIR_LOG_DEFAULT;\n\n    virLogRegex = g_regex_new(VIR_LOG_REGEX, G_REGEX_OPTIMIZE, 0, NULL);\n\n    /* GLib caches the hostname using a one time thread initializer.\n     * We want to prime this cache early though, because at later time\n     * it might not be possible to load NSS modules via getaddrinfo()\n     * (e.g. at container startup the host filesystem will not be\n     * accessible anymore.\n     */\n    ignore_value(g_get_host_name());\n\n    virLogUnlock();\n    return 0;\n}"
  },
  {
    "function_name": "virLogPriorityString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "230-244",
    "snippet": "static const char *\nvirLogPriorityString(virLogPriority lvl)\n{\n    switch (lvl) {\n    case VIR_LOG_DEBUG:\n        return \"debug\";\n    case VIR_LOG_INFO:\n        return \"info\";\n    case VIR_LOG_WARN:\n        return \"warning\";\n    case VIR_LOG_ERROR:\n        return \"error\";\n    }\n    return \"unknown\";\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic const char *\nvirLogPriorityString(virLogPriority lvl)\n{\n    switch (lvl) {\n    case VIR_LOG_DEBUG:\n        return \"debug\";\n    case VIR_LOG_INFO:\n        return \"info\";\n    case VIR_LOG_WARN:\n        return \"warning\";\n    case VIR_LOG_ERROR:\n        return \"error\";\n    }\n    return \"unknown\";\n}"
  },
  {
    "function_name": "virLogGetDefaultOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "223-227",
    "snippet": "char *\nvirLogGetDefaultOutput(void)\n{\n    return virLogDefaultOutput;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *virLogDefaultOutput;"
    ],
    "called_functions": [],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\n\nchar *\nvirLogGetDefaultOutput(void)\n{\n    return virLogDefaultOutput;\n}"
  },
  {
    "function_name": "virLogSetDefaultOutput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "204-220",
    "snippet": "void\nvirLogSetDefaultOutput(const char *binary, bool godaemon, bool privileged)\n{\n    bool have_journald = access(\"/run/systemd/journal/socket\", W_OK) >= 0;\n\n    if (godaemon) {\n        if (have_journald)\n            virLogSetDefaultOutputToJournald();\n        else\n            virLogSetDefaultOutputToFile(binary, privileged);\n    } else {\n        if (!isatty(STDIN_FILENO) && have_journald)\n            virLogSetDefaultOutputToJournald();\n        else\n            virLogSetDefaultOutputToStderr();\n    }\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogSetDefaultOutputToStderr",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetDefaultOutputToStderr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "144-149",
          "snippet": "static void\nvirLogSetDefaultOutputToStderr(void)\n{\n    virLogDefaultOutput = g_strdup_printf(\"%d:stderr\",\n                                          virLogDefaultPriority);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *virLogDefaultOutput;",
            "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic void\nvirLogSetDefaultOutputToStderr(void)\n{\n    virLogDefaultOutput = g_strdup_printf(\"%d:stderr\",\n                                          virLogDefaultPriority);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogSetDefaultOutputToJournald",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetDefaultOutputToJournald",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "152-163",
          "snippet": "static void\nvirLogSetDefaultOutputToJournald(void)\n{\n    virLogPriority priority = virLogDefaultPriority;\n\n    /* By default we don't want to log too much stuff into journald as\n     * it may employ rate limiting and thus block libvirt execution. */\n    if (priority == VIR_LOG_DEBUG)\n        priority = VIR_LOG_INFO;\n\n    virLogDefaultOutput = g_strdup_printf(\"%d:journald\", priority);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *virLogDefaultOutput;",
            "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic void\nvirLogSetDefaultOutputToJournald(void)\n{\n    virLogPriority priority = virLogDefaultPriority;\n\n    /* By default we don't want to log too much stuff into journald as\n     * it may employ rate limiting and thus block libvirt execution. */\n    if (priority == VIR_LOG_DEBUG)\n        priority = VIR_LOG_INFO;\n\n    virLogDefaultOutput = g_strdup_printf(\"%d:journald\", priority);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isatty",
          "args": [
            "STDIN_FILENO"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLogSetDefaultOutputToFile",
          "args": [
            "binary",
            "privileged"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "virLogSetDefaultOutputToFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "166-190",
          "snippet": "static int\nvirLogSetDefaultOutputToFile(const char *binary, bool privileged)\n{\n    g_autofree char *logdir = NULL;\n    mode_t old_umask;\n\n    if (privileged) {\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/log/libvirt/%s.log\",\n                                              virLogDefaultPriority, LOCALSTATEDIR, binary);\n    } else {\n        logdir = virGetUserCacheDirectory();\n\n        old_umask = umask(077);\n        if (virFileMakePath(logdir) < 0) {\n            umask(old_umask);\n            return -1;\n        }\n        umask(old_umask);\n\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/%s.log\",\n                                              virLogDefaultPriority, logdir, binary);\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *virLogDefaultOutput;",
            "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic int\nvirLogSetDefaultOutputToFile(const char *binary, bool privileged)\n{\n    g_autofree char *logdir = NULL;\n    mode_t old_umask;\n\n    if (privileged) {\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/log/libvirt/%s.log\",\n                                              virLogDefaultPriority, LOCALSTATEDIR, binary);\n    } else {\n        logdir = virGetUserCacheDirectory();\n\n        old_umask = umask(077);\n        if (virFileMakePath(logdir) < 0) {\n            umask(old_umask);\n            return -1;\n        }\n        umask(old_umask);\n\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/%s.log\",\n                                              virLogDefaultPriority, logdir, binary);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "\"/run/systemd/journal/socket\"",
            "W_OK"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogSetDefaultOutput(const char *binary, bool godaemon, bool privileged)\n{\n    bool have_journald = access(\"/run/systemd/journal/socket\", W_OK) >= 0;\n\n    if (godaemon) {\n        if (have_journald)\n            virLogSetDefaultOutputToJournald();\n        else\n            virLogSetDefaultOutputToFile(binary, privileged);\n    } else {\n        if (!isatty(STDIN_FILENO) && have_journald)\n            virLogSetDefaultOutputToJournald();\n        else\n            virLogSetDefaultOutputToStderr();\n    }\n}"
  },
  {
    "function_name": "virLogSetDefaultOutputToFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "166-190",
    "snippet": "static int\nvirLogSetDefaultOutputToFile(const char *binary, bool privileged)\n{\n    g_autofree char *logdir = NULL;\n    mode_t old_umask;\n\n    if (privileged) {\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/log/libvirt/%s.log\",\n                                              virLogDefaultPriority, LOCALSTATEDIR, binary);\n    } else {\n        logdir = virGetUserCacheDirectory();\n\n        old_umask = umask(077);\n        if (virFileMakePath(logdir) < 0) {\n            umask(old_umask);\n            return -1;\n        }\n        umask(old_umask);\n\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/%s.log\",\n                                              virLogDefaultPriority, logdir, binary);\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *virLogDefaultOutput;",
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%d:file:%s/%s.log\"",
            "virLogDefaultPriority",
            "logdir",
            "binary"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "umask",
          "args": [
            "old_umask"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "umask",
          "args": [
            "old_umask"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "logdir"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "umask",
          "args": [
            "077"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetUserCacheDirectory",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserCacheDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "584-591",
          "snippet": "char *virGetUserCacheDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_cache_dir());\n#else\n    return g_build_filename(g_get_user_cache_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserCacheDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_cache_dir());\n#else\n    return g_build_filename(g_get_user_cache_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic int\nvirLogSetDefaultOutputToFile(const char *binary, bool privileged)\n{\n    g_autofree char *logdir = NULL;\n    mode_t old_umask;\n\n    if (privileged) {\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/log/libvirt/%s.log\",\n                                              virLogDefaultPriority, LOCALSTATEDIR, binary);\n    } else {\n        logdir = virGetUserCacheDirectory();\n\n        old_umask = umask(077);\n        if (virFileMakePath(logdir) < 0) {\n            umask(old_umask);\n            return -1;\n        }\n        umask(old_umask);\n\n        virLogDefaultOutput = g_strdup_printf(\"%d:file:%s/%s.log\",\n                                              virLogDefaultPriority, logdir, binary);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virLogSetDefaultOutputToJournald",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "152-163",
    "snippet": "static void\nvirLogSetDefaultOutputToJournald(void)\n{\n    virLogPriority priority = virLogDefaultPriority;\n\n    /* By default we don't want to log too much stuff into journald as\n     * it may employ rate limiting and thus block libvirt execution. */\n    if (priority == VIR_LOG_DEBUG)\n        priority = VIR_LOG_INFO;\n\n    virLogDefaultOutput = g_strdup_printf(\"%d:journald\", priority);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *virLogDefaultOutput;",
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%d:journald\"",
            "priority"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic void\nvirLogSetDefaultOutputToJournald(void)\n{\n    virLogPriority priority = virLogDefaultPriority;\n\n    /* By default we don't want to log too much stuff into journald as\n     * it may employ rate limiting and thus block libvirt execution. */\n    if (priority == VIR_LOG_DEBUG)\n        priority = VIR_LOG_INFO;\n\n    virLogDefaultOutput = g_strdup_printf(\"%d:journald\", priority);\n}"
  },
  {
    "function_name": "virLogSetDefaultOutputToStderr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "144-149",
    "snippet": "static void\nvirLogSetDefaultOutputToStderr(void)\n{\n    virLogDefaultOutput = g_strdup_printf(\"%d:stderr\",\n                                          virLogDefaultPriority);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *virLogDefaultOutput;",
      "static virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%d:stderr\"",
            "virLogDefaultPriority"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic char *virLogDefaultOutput;\nstatic virLogPriority virLogDefaultPriority = VIR_LOG_DEFAULT;\n\nstatic void\nvirLogSetDefaultOutputToStderr(void)\n{\n    virLogDefaultOutput = g_strdup_printf(\"%d:stderr\",\n                                          virLogDefaultPriority);\n}"
  },
  {
    "function_name": "virLogUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "137-141",
    "snippet": "void\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virMutex virLogMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&virLogMutex"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogUnlock(void)\n{\n    virMutexUnlock(&virLogMutex);\n}"
  },
  {
    "function_name": "virLogLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
    "lines": "130-134",
    "snippet": "void\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}",
    "includes": [
      "# include <sys/uio.h>",
      "#include \"virsocket.h\"",
      "#include \"configmake.h\"",
      "#include \"virstring.h\"",
      "#include \"virtime.h\"",
      "#include \"virfile.h\"",
      "#include \"virthread.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virutil.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <syslog.h>",
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virMutex virLogMutex;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&virLogMutex"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvirMutex virLogMutex;\n\nvoid\nvirLogLock(void)\n{\n    virMutexLock(&virLogMutex);\n}"
  }
]