[
  {
    "function_name": "virRandomGenerateWWN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
    "lines": "133-164",
    "snippet": "int\nvirRandomGenerateWWN(char **wwn,\n                     const char *virt_type)\n{\n    const char *oui = NULL;\n\n    if (!virt_type) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"argument virt_type must not be NULL\"));\n        return -1;\n    }\n\n    if (STREQ(virt_type, \"QEMU\")) {\n        oui = QUMRANET_OUI;\n    } else if (STREQ(virt_type, \"Xen\") ||\n               STREQ(virt_type, \"xenlight\")) {\n        oui = XEN_OUI;\n    } else if (STREQ(virt_type, \"ESX\") ||\n               STREQ(virt_type, \"VMWARE\")) {\n        oui = VMWARE_OUI;\n    } else if (STREQ(virt_type, \"HYPER-V\")) {\n        oui = MICROSOFT_OUI;\n    } else {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unsupported virt type\"));\n        return -1;\n    }\n\n    *wwn = g_strdup_printf(\"5\" \"%s%09llx\", oui,\n                           (unsigned long long)virRandomBits(36));\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virthread.h\"",
      "#include \"virrandom.h\"",
      "#include <gnutls/crypto.h>",
      "#include <gnutls/gnutls.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <time.h>",
      "#include <math.h>",
      "#include <inttypes.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define XEN_OUI \"00163e\"",
      "#define MICROSOFT_OUI \"0050f2\"",
      "#define VMWARE_OUI \"000569\"",
      "#define QUMRANET_OUI \"001a4a\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"5\" \"%s%09llx\"",
            "oui",
            "(unsigned long long)virRandomBits(36)"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRandomBits",
          "args": [
            "36"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "virRandomBits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
          "lines": "50-64",
          "snippet": "uint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virrandom.h\"",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <time.h>",
            "#include <math.h>",
            "#include <inttypes.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nuint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unsupported virt type\")"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virt_type",
            "\"HYPER-V\""
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virt_type",
            "\"VMWARE\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virt_type",
            "\"ESX\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virt_type",
            "\"xenlight\""
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virt_type",
            "\"Xen\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "virt_type",
            "\"QEMU\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"argument virt_type must not be NULL\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\n#define XEN_OUI \"00163e\"\n#define MICROSOFT_OUI \"0050f2\"\n#define VMWARE_OUI \"000569\"\n#define QUMRANET_OUI \"001a4a\"\n\nint\nvirRandomGenerateWWN(char **wwn,\n                     const char *virt_type)\n{\n    const char *oui = NULL;\n\n    if (!virt_type) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"argument virt_type must not be NULL\"));\n        return -1;\n    }\n\n    if (STREQ(virt_type, \"QEMU\")) {\n        oui = QUMRANET_OUI;\n    } else if (STREQ(virt_type, \"Xen\") ||\n               STREQ(virt_type, \"xenlight\")) {\n        oui = XEN_OUI;\n    } else if (STREQ(virt_type, \"ESX\") ||\n               STREQ(virt_type, \"VMWARE\")) {\n        oui = VMWARE_OUI;\n    } else if (STREQ(virt_type, \"HYPER-V\")) {\n        oui = MICROSOFT_OUI;\n    } else {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unsupported virt type\"));\n        return -1;\n    }\n\n    *wwn = g_strdup_printf(\"5\" \"%s%09llx\", oui,\n                           (unsigned long long)virRandomBits(36));\n    return 0;\n}"
  },
  {
    "function_name": "virRandomBytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
    "lines": "110-124",
    "snippet": "int\nvirRandomBytes(unsigned char *buf,\n               size_t buflen)\n{\n    int rv;\n\n    if ((rv = gnutls_rnd(GNUTLS_RND_RANDOM, buf, buflen)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to generate byte stream: %s\"),\n                       gnutls_strerror(rv));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virthread.h\"",
      "#include \"virrandom.h\"",
      "#include <gnutls/crypto.h>",
      "#include <gnutls/gnutls.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <time.h>",
      "#include <math.h>",
      "#include <inttypes.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to generate byte stream: %s\")",
            "gnutls_strerror(rv)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_strerror",
          "args": [
            "rv"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to generate byte stream: %s\""
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gnutls_rnd",
          "args": [
            "GNUTLS_RND_RANDOM",
            "buf",
            "buflen"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nint\nvirRandomBytes(unsigned char *buf,\n               size_t buflen)\n{\n    int rv;\n\n    if ((rv = gnutls_rnd(GNUTLS_RND_RANDOM, buf, buflen)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to generate byte stream: %s\"),\n                       gnutls_strerror(rv));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virRandomInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
    "lines": "90-97",
    "snippet": "uint32_t virRandomInt(uint32_t max)\n{\n    if ((max & (max - 1)) == 0)\n        return virRandomBits(__builtin_ffs(max) - 1);\n\n    double val = virRandom();\n    return val * max;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virthread.h\"",
      "#include \"virrandom.h\"",
      "#include <gnutls/crypto.h>",
      "#include <gnutls/gnutls.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <time.h>",
      "#include <math.h>",
      "#include <inttypes.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRandom",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "virRandom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
          "lines": "74-79",
          "snippet": "double virRandom(void)\n{\n    uint64_t val = virRandomBits(48);\n\n    return ldexp(val, -48);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virrandom.h\"",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <time.h>",
            "#include <math.h>",
            "#include <inttypes.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\ndouble virRandom(void)\n{\n    uint64_t val = virRandomBits(48);\n\n    return ldexp(val, -48);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRandomBits",
          "args": [
            "__builtin_ffs(max) - 1"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virRandomBits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
          "lines": "50-64",
          "snippet": "uint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virrandom.h\"",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <time.h>",
            "#include <math.h>",
            "#include <inttypes.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nuint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__builtin_ffs",
          "args": [
            "max"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nuint32_t virRandomInt(uint32_t max)\n{\n    if ((max & (max - 1)) == 0)\n        return virRandomBits(__builtin_ffs(max) - 1);\n\n    double val = virRandom();\n    return val * max;\n}"
  },
  {
    "function_name": "virRandom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
    "lines": "74-79",
    "snippet": "double virRandom(void)\n{\n    uint64_t val = virRandomBits(48);\n\n    return ldexp(val, -48);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virthread.h\"",
      "#include \"virrandom.h\"",
      "#include <gnutls/crypto.h>",
      "#include <gnutls/gnutls.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <time.h>",
      "#include <math.h>",
      "#include <inttypes.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ldexp",
          "args": [
            "val",
            "-48"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virRandomBits",
          "args": [
            "48"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "virRandomBits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
          "lines": "50-64",
          "snippet": "uint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virrandom.h\"",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <time.h>",
            "#include <math.h>",
            "#include <inttypes.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nuint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\ndouble virRandom(void)\n{\n    uint64_t val = virRandomBits(48);\n\n    return ldexp(val, -48);\n}"
  },
  {
    "function_name": "virRandomBits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
    "lines": "50-64",
    "snippet": "uint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"virthread.h\"",
      "#include \"virrandom.h\"",
      "#include <gnutls/crypto.h>",
      "#include <gnutls/gnutls.h>",
      "#include <sys/types.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <time.h>",
      "#include <math.h>",
      "#include <inttypes.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRandomBytes",
          "args": [
            "(unsigned char *) &ret",
            "sizeof(ret)"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "virRandomBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
          "lines": "110-124",
          "snippet": "int\nvirRandomBytes(unsigned char *buf,\n               size_t buflen)\n{\n    int rv;\n\n    if ((rv = gnutls_rnd(GNUTLS_RND_RANDOM, buf, buflen)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to generate byte stream: %s\"),\n                       gnutls_strerror(rv));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virrandom.h\"",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <time.h>",
            "#include <math.h>",
            "#include <inttypes.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nint\nvirRandomBytes(unsigned char *buf,\n               size_t buflen)\n{\n    int rv;\n\n    if ((rv = gnutls_rnd(GNUTLS_RND_RANDOM, buf, buflen)) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to generate byte stream: %s\"),\n                       gnutls_strerror(rv));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nuint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}"
  }
]