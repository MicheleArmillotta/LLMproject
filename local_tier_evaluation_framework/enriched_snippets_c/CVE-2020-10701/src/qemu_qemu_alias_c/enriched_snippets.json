[
  {
    "function_name": "qemuAliasDBusVMStateFromId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "833-847",
    "snippet": "char *\nqemuAliasDBusVMStateFromId(const char *id)\n{\n    char *ret;\n    size_t i;\n\n    ret = g_strdup_printf(\"dbus-vms-%s\", id);\n\n    for (i = 0; ret[i]; i++) {\n        if (ret[i] == ':')\n            ret[i] = '_';\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"dbus-vms-%s\"",
            "id"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasDBusVMStateFromId(const char *id)\n{\n    char *ret;\n    size_t i;\n\n    ret = g_strdup_printf(\"dbus-vms-%s\", id);\n\n    for (i = 0; ret[i]; i++) {\n        if (ret[i] == ':')\n            ret[i] = '_';\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuDomainGetUnmanagedPRAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "823-831",
    "snippet": "char *\nqemuDomainGetUnmanagedPRAlias(const char *parentalias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"pr-helper-%s\", parentalias);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"pr-helper-%s\"",
            "parentalias"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuDomainGetUnmanagedPRAlias(const char *parentalias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"pr-helper-%s\", parentalias);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuDomainGetManagedPRAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "816-820",
    "snippet": "const char *\nqemuDomainGetManagedPRAlias(void)\n{\n    return \"pr-helper0\";\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nconst char *\nqemuDomainGetManagedPRAlias(void)\n{\n    return \"pr-helper0\";\n}"
  },
  {
    "function_name": "qemuAliasChardevFromDevAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "805-813",
    "snippet": "char *\nqemuAliasChardevFromDevAlias(const char *devAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"char%s\", devAlias);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"char%s\"",
            "devAlias"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasChardevFromDevAlias(const char *devAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"char%s\", devAlias);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuAliasTLSObjFromSrcAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "789-797",
    "snippet": "char *\nqemuAliasTLSObjFromSrcAlias(const char *srcAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"obj%s_tls0\", srcAlias);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"obj%s_tls0\"",
            "srcAlias"
          ],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasTLSObjFromSrcAlias(const char *srcAlias)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"obj%s_tls0\", srcAlias);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuAliasForSecret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "774-782",
    "snippet": "char *\nqemuAliasForSecret(const char *parentalias,\n                   const char *obj)\n{\n    if (obj)\n        return g_strdup_printf(\"%s-%s-secret0\", parentalias, obj);\n    else\n        return g_strdup_printf(\"%s-secret0\", parentalias);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s-secret0\"",
            "parentalias"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasForSecret(const char *parentalias,\n                   const char *obj)\n{\n    if (obj)\n        return g_strdup_printf(\"%s-%s-secret0\", parentalias, obj);\n    else\n        return g_strdup_printf(\"%s-secret0\", parentalias);\n}"
  },
  {
    "function_name": "qemuDomainGetMasterKeyAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "756-764",
    "snippet": "char *\nqemuDomainGetMasterKeyAlias(void)\n{\n    char *alias;\n\n    alias = g_strdup(\"masterKey0\");\n\n    return alias;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"masterKey0\""
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuDomainGetMasterKeyAlias(void)\n{\n    char *alias;\n\n    alias = g_strdup(\"masterKey0\");\n\n    return alias;\n}"
  },
  {
    "function_name": "qemuAliasFromHostdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "732-747",
    "snippet": "char *\nqemuAliasFromHostdev(const virDomainHostdevDef *hostdev)\n{\n    char *ret;\n\n    if (!hostdev->info->alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"hostdev does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s-%s\",\n                          virDomainDeviceAddressTypeToString(hostdev->info->type),\n                          hostdev->info->alias);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s-%s\"",
            "virDomainDeviceAddressTypeToString(hostdev->info->type)",
            "hostdev->info->alias"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceAddressTypeToString",
          "args": [
            "hostdev->info->type"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"hostdev does not have an alias\")"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"hostdev does not have an alias\""
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nchar *\nqemuAliasFromHostdev(const virDomainHostdevDef *hostdev)\n{\n    char *ret;\n\n    if (!hostdev->info->alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"hostdev does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s-%s\",\n                          virDomainDeviceAddressTypeToString(hostdev->info->type),\n                          hostdev->info->alias);\n    return ret;\n}"
  },
  {
    "function_name": "qemuAliasDiskDriveSkipPrefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "718-724",
    "snippet": "const char *\nqemuAliasDiskDriveSkipPrefix(const char *dev_name)\n{\n    if (STRPREFIX(dev_name, QEMU_DRIVE_HOST_PREFIX))\n        dev_name += strlen(QEMU_DRIVE_HOST_PREFIX);\n    return dev_name;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define QEMU_DRIVE_HOST_PREFIX \"drive-\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "QEMU_DRIVE_HOST_PREFIX"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "dev_name",
            "QEMU_DRIVE_HOST_PREFIX"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\n#define QEMU_DRIVE_HOST_PREFIX \"drive-\"\n\nconst char *\nqemuAliasDiskDriveSkipPrefix(const char *dev_name)\n{\n    if (STRPREFIX(dev_name, QEMU_DRIVE_HOST_PREFIX))\n        dev_name += strlen(QEMU_DRIVE_HOST_PREFIX);\n    return dev_name;\n}"
  },
  {
    "function_name": "qemuAliasDiskDriveFromDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "696-709",
    "snippet": "char *\nqemuAliasDiskDriveFromDisk(const virDomainDiskDef *disk)\n{\n    char *ret;\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"disk does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s%s\", QEMU_DRIVE_HOST_PREFIX, disk->info.alias);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define QEMU_DRIVE_HOST_PREFIX \"drive-\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s\"",
            "QEMU_DRIVE_HOST_PREFIX",
            "disk->info.alias"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"disk does not have an alias\")"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"disk does not have an alias\""
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\n#define QEMU_DRIVE_HOST_PREFIX \"drive-\"\n\nchar *\nqemuAliasDiskDriveFromDisk(const virDomainDiskDef *disk)\n{\n    char *ret;\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"disk does not have an alias\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%s%s\", QEMU_DRIVE_HOST_PREFIX, disk->info.alias);\n    return ret;\n}"
  },
  {
    "function_name": "qemuAssignDeviceAliases",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "584-686",
    "snippet": "int\nqemuAssignDeviceAliases(virDomainDefPtr def, virQEMUCapsPtr qemuCaps)\n{\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (qemuAssignDeviceDiskAlias(def, def->disks[i], qemuCaps) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuAssignDeviceNetAlias(def, def->nets[i], -1) < 0)\n            return -1;\n    }\n\n    for (i = 0; i < def->nfss; i++) {\n        if (qemuAssignDeviceFSAlias(def->fss[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nsounds; i++) {\n        if (qemuAssignDeviceSoundAlias(def->sounds[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nhostdevs; i++) {\n        /* we can't start assigning at 0, since netdevs may have used\n         * up some hostdevN entries already. Also if the HostdevDef is\n         * linked to a NetDef, they will share an info and the alias\n         * will already be set, so don't try to set it again.\n         */\n        if (qemuAssignDeviceHostdevAlias(def, &def->hostdevs[i]->info->alias, -1) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nredirdevs; i++) {\n        if (qemuAssignDeviceRedirdevAlias(def, def->redirdevs[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nvideos; i++) {\n        if (qemuAssignDeviceVideoAlias(def->videos[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->ncontrollers; i++) {\n        if (qemuAssignDeviceControllerAlias(def, qemuCaps, def->controllers[i]) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->ninputs; i++) {\n        if (qemuAssignDeviceInputAlias(def, def->inputs[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nparallels; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->parallels[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nserials; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->serials[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nchannels; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->channels[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nconsoles; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->consoles[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nhubs; i++) {\n        if (qemuAssignDeviceHubAlias(def->hubs[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nshmems; i++) {\n        if (qemuAssignDeviceShmemAlias(def, def->shmems[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nsmartcards; i++) {\n        if (qemuAssignDeviceSmartcardAlias(def->smartcards[i], i) < 0)\n            return -1;\n    }\n    if (def->watchdog) {\n        if (qemuAssignDeviceWatchdogAlias(def->watchdog) < 0)\n            return -1;\n    }\n    if (def->memballoon &&\n        def->memballoon->model != VIR_DOMAIN_MEMBALLOON_MODEL_NONE) {\n        if (qemuAssingDeviceMemballoonAlias(def->memballoon, 0) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nrngs; i++) {\n        if (qemuAssignDeviceRNGAlias(def, def->rngs[i]) < 0)\n            return -1;\n    }\n    if (def->tpm) {\n        if (qemuAssignDeviceTPMAlias(def->tpm, 0) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nmems; i++) {\n        if (qemuAssignDeviceMemoryAlias(NULL, def->mems[i], false) < 0)\n            return -1;\n    }\n    if (def->vsock) {\n        if (qemuAssignDeviceVsockAlias(def->vsock) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuAssignDeviceVsockAlias",
          "args": [
            "def->vsock"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceVsockAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "573-581",
          "snippet": "int\nqemuAssignDeviceVsockAlias(virDomainVsockDefPtr vsock)\n{\n    if (vsock->info.alias)\n        return 0;\n    vsock->info.alias = g_strdup(\"vsock0\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceVsockAlias(virDomainVsockDefPtr vsock)\n{\n    if (vsock->info.alias)\n        return 0;\n    vsock->info.alias = g_strdup(\"vsock0\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceMemoryAlias",
          "args": [
            "NULL",
            "def->mems[i]",
            "false"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceMemoryAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "475-505",
          "snippet": "int\nqemuAssignDeviceMemoryAlias(virDomainDefPtr def,\n                            virDomainMemoryDefPtr mem,\n                            bool oldAlias)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n    const char *prefix;\n\n    if (mem->info.alias)\n        return 0;\n\n    if (mem->model == VIR_DOMAIN_MEMORY_MODEL_DIMM)\n        prefix = \"dimm\";\n    else\n        prefix = \"nvdimm\";\n\n    if (oldAlias) {\n        for (i = 0; i < def->nmems; i++) {\n            if ((idx = qemuDomainDeviceAliasIndex(&def->mems[i]->info, prefix)) >= maxidx)\n                maxidx = idx + 1;\n        }\n    } else {\n        maxidx = mem->info.addr.dimm.slot;\n    }\n\n    mem->info.alias = g_strdup_printf(\"%s%d\", prefix, maxidx);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceMemoryAlias(virDomainDefPtr def,\n                            virDomainMemoryDefPtr mem,\n                            bool oldAlias)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n    const char *prefix;\n\n    if (mem->info.alias)\n        return 0;\n\n    if (mem->model == VIR_DOMAIN_MEMORY_MODEL_DIMM)\n        prefix = \"dimm\";\n    else\n        prefix = \"nvdimm\";\n\n    if (oldAlias) {\n        for (i = 0; i < def->nmems; i++) {\n            if ((idx = qemuDomainDeviceAliasIndex(&def->mems[i]->info, prefix)) >= maxidx)\n                maxidx = idx + 1;\n        }\n    } else {\n        maxidx = mem->info.addr.dimm.slot;\n    }\n\n    mem->info.alias = g_strdup_printf(\"%s%d\", prefix, maxidx);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceTPMAlias",
          "args": [
            "def->tpm",
            "0"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceTPMAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "404-413",
          "snippet": "static int\nqemuAssignDeviceTPMAlias(virDomainTPMDefPtr tpm,\n                         int idx)\n{\n    if (tpm->info.alias)\n        return 0;\n\n    tpm->info.alias = g_strdup_printf(\"tpm%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceTPMAlias(virDomainTPMDefPtr tpm,\n                         int idx)\n{\n    if (tpm->info.alias)\n        return 0;\n\n    tpm->info.alias = g_strdup_printf(\"tpm%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceRNGAlias",
          "args": [
            "def",
            "def->rngs[i]"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceRNGAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "441-460",
          "snippet": "int\nqemuAssignDeviceRNGAlias(virDomainDefPtr def,\n                         virDomainRNGDefPtr rng)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n\n    if (rng->info.alias)\n        return 0;\n\n    for (i = 0; i < def->nrngs; i++) {\n        if ((idx = qemuDomainDeviceAliasIndex(&def->rngs[i]->info, \"rng\")) >= maxidx)\n            maxidx = idx + 1;\n    }\n\n    rng->info.alias = g_strdup_printf(\"rng%d\", maxidx);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceRNGAlias(virDomainDefPtr def,\n                         virDomainRNGDefPtr rng)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n\n    if (rng->info.alias)\n        return 0;\n\n    for (i = 0; i < def->nrngs; i++) {\n        if ((idx = qemuDomainDeviceAliasIndex(&def->rngs[i]->info, \"rng\")) >= maxidx)\n            maxidx = idx + 1;\n    }\n\n    rng->info.alias = g_strdup_printf(\"rng%d\", maxidx);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssingDeviceMemballoonAlias",
          "args": [
            "def->memballoon",
            "0"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssingDeviceMemballoonAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "392-401",
          "snippet": "static int\nqemuAssingDeviceMemballoonAlias(virDomainMemballoonDefPtr memballoon,\n                                int idx)\n{\n    if (memballoon->info.alias)\n        return 0;\n\n    memballoon->info.alias = g_strdup_printf(\"balloon%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssingDeviceMemballoonAlias(virDomainMemballoonDefPtr memballoon,\n                                int idx)\n{\n    if (memballoon->info.alias)\n        return 0;\n\n    memballoon->info.alias = g_strdup_printf(\"balloon%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceWatchdogAlias",
          "args": [
            "def->watchdog"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceWatchdogAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "536-547",
          "snippet": "int\nqemuAssignDeviceWatchdogAlias(virDomainWatchdogDefPtr watchdog)\n{\n    /* Currently, there's just one watchdog per domain */\n\n    if (watchdog->info.alias)\n        return 0;\n\n    watchdog->info.alias = g_strdup(\"watchdog0\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceWatchdogAlias(virDomainWatchdogDefPtr watchdog)\n{\n    /* Currently, there's just one watchdog per domain */\n\n    if (watchdog->info.alias)\n        return 0;\n\n    watchdog->info.alias = g_strdup(\"watchdog0\");\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceSmartcardAlias",
          "args": [
            "def->smartcards[i]",
            "i"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceSmartcardAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "380-389",
          "snippet": "static int\nqemuAssignDeviceSmartcardAlias(virDomainSmartcardDefPtr smartcard,\n                               int idx)\n{\n    if (smartcard->info.alias)\n        return 0;\n\n    smartcard->info.alias = g_strdup_printf(\"smartcard%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceSmartcardAlias(virDomainSmartcardDefPtr smartcard,\n                               int idx)\n{\n    if (smartcard->info.alias)\n        return 0;\n\n    smartcard->info.alias = g_strdup_printf(\"smartcard%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceShmemAlias",
          "args": [
            "def",
            "def->shmems[i]",
            "i"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceShmemAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "508-533",
          "snippet": "int\nqemuAssignDeviceShmemAlias(virDomainDefPtr def,\n                           virDomainShmemDefPtr shmem,\n                           int idx)\n{\n    if (shmem->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nshmems; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->shmems[i]->info,\n                                                      \"shmem\")) < 0)\n                continue;\n\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    shmem->info.alias = g_strdup_printf(\"shmem%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceShmemAlias(virDomainDefPtr def,\n                           virDomainShmemDefPtr shmem,\n                           int idx)\n{\n    if (shmem->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nshmems; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->shmems[i]->info,\n                                                      \"shmem\")) < 0)\n                continue;\n\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    shmem->info.alias = g_strdup_printf(\"shmem%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceHubAlias",
          "args": [
            "def->hubs[i]",
            "i"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceHubAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "368-377",
          "snippet": "static int\nqemuAssignDeviceHubAlias(virDomainHubDefPtr hub,\n                         int idx)\n{\n    if (hub->info.alias)\n        return 0;\n\n    hub->info.alias = g_strdup_printf(\"hub%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceHubAlias(virDomainHubDefPtr hub,\n                         int idx)\n{\n    if (hub->info.alias)\n        return 0;\n\n    hub->info.alias = g_strdup_printf(\"hub%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceChrAlias",
          "args": [
            "def",
            "def->consoles[i]",
            "i"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceChrAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "84-120",
          "snippet": "int\nqemuAssignDeviceChrAlias(virDomainDefPtr def,\n                         virDomainChrDefPtr chr,\n                         ssize_t idx)\n{\n    const char *prefix = NULL;\n\n    if (chr->info.alias)\n        return 0;\n\n    switch ((virDomainChrDeviceType)chr->deviceType) {\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_PARALLEL:\n        prefix = \"parallel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_SERIAL:\n        prefix = \"serial\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE:\n        prefix = \"console\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CHANNEL:\n        prefix = \"channel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_LAST:\n        return -1;\n    }\n\n    if (idx == -1 && (idx = qemuGetNextChrDevIndex(def, chr, prefix)) < 0)\n        return -1;\n\n    chr->info.alias = g_strdup_printf(\"%s%zd\", prefix, idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceChrAlias(virDomainDefPtr def,\n                         virDomainChrDefPtr chr,\n                         ssize_t idx)\n{\n    const char *prefix = NULL;\n\n    if (chr->info.alias)\n        return 0;\n\n    switch ((virDomainChrDeviceType)chr->deviceType) {\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_PARALLEL:\n        prefix = \"parallel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_SERIAL:\n        prefix = \"serial\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE:\n        prefix = \"console\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CHANNEL:\n        prefix = \"channel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_LAST:\n        return -1;\n    }\n\n    if (idx == -1 && (idx = qemuGetNextChrDevIndex(def, chr, prefix)) < 0)\n        return -1;\n\n    chr->info.alias = g_strdup_printf(\"%s%zd\", prefix, idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceInputAlias",
          "args": [
            "def",
            "def->inputs[i]",
            "i"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceInputAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "549-570",
          "snippet": "int\nqemuAssignDeviceInputAlias(virDomainDefPtr def,\n                           virDomainInputDefPtr input,\n                           int idx)\n{\n    if (input->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        int thisidx;\n        size_t i;\n\n        for (i = 0; i < def->ninputs; i++) {\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->inputs[i]->info, \"input\")) >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    input->info.alias = g_strdup_printf(\"input%d\", idx);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceInputAlias(virDomainDefPtr def,\n                           virDomainInputDefPtr input,\n                           int idx)\n{\n    if (input->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        int thisidx;\n        size_t i;\n\n        for (i = 0; i < def->ninputs; i++) {\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->inputs[i]->info, \"input\")) >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    input->info.alias = g_strdup_printf(\"input%d\", idx);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceControllerAlias",
          "args": [
            "def",
            "qemuCaps",
            "def->controllers[i]"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceControllerAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "123-185",
          "snippet": "int\nqemuAssignDeviceControllerAlias(virDomainDefPtr domainDef,\n                                virQEMUCapsPtr qemuCaps,\n                                virDomainControllerDefPtr controller)\n{\n    const char *prefix = virDomainControllerTypeToString(controller->type);\n\n    if (controller->info.alias)\n        return 0;\n\n    if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_PCI) {\n        if (!virQEMUCapsHasPCIMultiBus(qemuCaps, domainDef)) {\n            /* qemus that don't support multiple PCI buses have\n             * hardcoded the name of their single PCI controller as\n             * \"pci\".\n             */\n            controller->info.alias = g_strdup(\"pci\");\n            return 0;\n        } else if (controller->model == VIR_DOMAIN_CONTROLLER_MODEL_PCIE_ROOT) {\n            /* The pcie-root controller on Q35 machinetypes uses a\n             * different naming convention (\"pcie.0\"), because it is\n             * hardcoded that way in qemu.\n             */\n            controller->info.alias = g_strdup_printf(\"pcie.%d\", controller->idx);\n            return 0;\n        }\n        /* All other PCI controllers use the consistent \"pci.%u\"\n         * (including the hardcoded pci-root controller on\n         * multibus-capable qemus).\n         */\n        controller->info.alias = g_strdup_printf(\"pci.%d\", controller->idx);\n        return 0;\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_IDE) {\n        /* for any machine based on e.g. I440FX or G3Beige, the\n         * first (and currently only) IDE controller is an integrated\n         * controller hardcoded with id \"ide\"\n         */\n        if (qemuDomainHasBuiltinIDE(domainDef) &&\n            controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SATA) {\n        /* for any Q35 machine, the first SATA controller is the\n         * integrated one, and it too is hardcoded with id \"ide\"\n         */\n        if (qemuDomainIsQ35(domainDef) && controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_USB) {\n        /* first USB device is \"usb\", others are normal \"usb%d\" */\n        if (controller->idx == 0) {\n            controller->info.alias = g_strdup(\"usb\");\n            return 0;\n        }\n    }\n    /* all other controllers use the default ${type}${index} naming\n     * scheme for alias/id.\n     */\n    controller->info.alias = g_strdup_printf(\"%s%d\", prefix, controller->idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceControllerAlias(virDomainDefPtr domainDef,\n                                virQEMUCapsPtr qemuCaps,\n                                virDomainControllerDefPtr controller)\n{\n    const char *prefix = virDomainControllerTypeToString(controller->type);\n\n    if (controller->info.alias)\n        return 0;\n\n    if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_PCI) {\n        if (!virQEMUCapsHasPCIMultiBus(qemuCaps, domainDef)) {\n            /* qemus that don't support multiple PCI buses have\n             * hardcoded the name of their single PCI controller as\n             * \"pci\".\n             */\n            controller->info.alias = g_strdup(\"pci\");\n            return 0;\n        } else if (controller->model == VIR_DOMAIN_CONTROLLER_MODEL_PCIE_ROOT) {\n            /* The pcie-root controller on Q35 machinetypes uses a\n             * different naming convention (\"pcie.0\"), because it is\n             * hardcoded that way in qemu.\n             */\n            controller->info.alias = g_strdup_printf(\"pcie.%d\", controller->idx);\n            return 0;\n        }\n        /* All other PCI controllers use the consistent \"pci.%u\"\n         * (including the hardcoded pci-root controller on\n         * multibus-capable qemus).\n         */\n        controller->info.alias = g_strdup_printf(\"pci.%d\", controller->idx);\n        return 0;\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_IDE) {\n        /* for any machine based on e.g. I440FX or G3Beige, the\n         * first (and currently only) IDE controller is an integrated\n         * controller hardcoded with id \"ide\"\n         */\n        if (qemuDomainHasBuiltinIDE(domainDef) &&\n            controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SATA) {\n        /* for any Q35 machine, the first SATA controller is the\n         * integrated one, and it too is hardcoded with id \"ide\"\n         */\n        if (qemuDomainIsQ35(domainDef) && controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_USB) {\n        /* first USB device is \"usb\", others are normal \"usb%d\" */\n        if (controller->idx == 0) {\n            controller->info.alias = g_strdup(\"usb\");\n            return 0;\n        }\n    }\n    /* all other controllers use the default ${type}${index} naming\n     * scheme for alias/id.\n     */\n    controller->info.alias = g_strdup_printf(\"%s%d\", prefix, controller->idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceVideoAlias",
          "args": [
            "def->videos[i]",
            "i"
          ],
          "line": 620
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceVideoAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "356-365",
          "snippet": "static int\nqemuAssignDeviceVideoAlias(virDomainVideoDefPtr video,\n                           int idx)\n{\n    if (video->info.alias)\n        return 0;\n\n    video->info.alias = g_strdup_printf(\"video%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceVideoAlias(virDomainVideoDefPtr video,\n                           int idx)\n{\n    if (video->info.alias)\n        return 0;\n\n    video->info.alias = g_strdup_printf(\"video%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceRedirdevAlias",
          "args": [
            "def",
            "def->redirdevs[i]",
            "i"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceRedirdevAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "416-438",
          "snippet": "int\nqemuAssignDeviceRedirdevAlias(virDomainDefPtr def,\n                              virDomainRedirdevDefPtr redirdev,\n                              int idx)\n{\n    if (redirdev->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nredirdevs; i++) {\n            int thisidx;\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->redirdevs[i]->info, \"redir\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    redirdev->info.alias = g_strdup_printf(\"redir%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceRedirdevAlias(virDomainDefPtr def,\n                              virDomainRedirdevDefPtr redirdev,\n                              int idx)\n{\n    if (redirdev->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nredirdevs; i++) {\n            int thisidx;\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->redirdevs[i]->info, \"redir\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    redirdev->info.alias = g_strdup_printf(\"redir%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceHostdevAlias",
          "args": [
            "def",
            "&def->hostdevs[i]->info->alias",
            "-1"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceHostdevAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "261-295",
          "snippet": "int\nqemuAssignDeviceHostdevAlias(virDomainDefPtr def,\n                             char **alias,\n                             int idx)\n{\n    if (*alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nhostdevs; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(def->hostdevs[i]->info, \"hostdev\")) < 0)\n                continue; /* error just means the alias wasn't \"hostdevN\", but something else */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n        /* network interfaces can also have a hostdevN alias */\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"hostdev\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    *alias = g_strdup_printf(\"hostdev%d\", idx);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceHostdevAlias(virDomainDefPtr def,\n                             char **alias,\n                             int idx)\n{\n    if (*alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nhostdevs; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(def->hostdevs[i]->info, \"hostdev\")) < 0)\n                continue; /* error just means the alias wasn't \"hostdevN\", but something else */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n        /* network interfaces can also have a hostdevN alias */\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"hostdev\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    *alias = g_strdup_printf(\"hostdev%d\", idx);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceSoundAlias",
          "args": [
            "def->sounds[i]",
            "i"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceSoundAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "344-353",
          "snippet": "static int\nqemuAssignDeviceSoundAlias(virDomainSoundDefPtr sound,\n                           int idx)\n{\n    if (sound->info.alias)\n        return 0;\n\n    sound->info.alias = g_strdup_printf(\"sound%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceSoundAlias(virDomainSoundDefPtr sound,\n                           int idx)\n{\n    if (sound->info.alias)\n        return 0;\n\n    sound->info.alias = g_strdup_printf(\"sound%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceFSAlias",
          "args": [
            "def->fss[i]",
            "i"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceFSAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "332-341",
          "snippet": "static int\nqemuAssignDeviceFSAlias(virDomainFSDefPtr fss,\n                        int idx)\n{\n    if (fss->info.alias)\n        return 0;\n\n    fss->info.alias = g_strdup_printf(\"fs%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceFSAlias(virDomainFSDefPtr fss,\n                        int idx)\n{\n    if (fss->info.alias)\n        return 0;\n\n    fss->info.alias = g_strdup_printf(\"fs%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceNetAlias",
          "args": [
            "def",
            "def->nets[i]",
            "-1"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceNetAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "298-329",
          "snippet": "int\nqemuAssignDeviceNetAlias(virDomainDefPtr def,\n                         virDomainNetDefPtr net,\n                         int idx)\n{\n    if (net->info.alias)\n        return 0;\n\n    /* <interface type='hostdev'> uses \"hostdevN\" as the alias\n     * We must use \"-1\" as the index because the caller doesn't know\n     * that we're now looking for a unique hostdevN rather than netN\n     */\n    if (virDomainNetResolveActualType(net) == VIR_DOMAIN_NET_TYPE_HOSTDEV)\n        return qemuAssignDeviceHostdevAlias(def, &net->info.alias, -1);\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"net\")) < 0)\n                continue; /* failure could be due to \"hostdevN\" */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    net->info.alias = g_strdup_printf(\"net%d\", idx);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceNetAlias(virDomainDefPtr def,\n                         virDomainNetDefPtr net,\n                         int idx)\n{\n    if (net->info.alias)\n        return 0;\n\n    /* <interface type='hostdev'> uses \"hostdevN\" as the alias\n     * We must use \"-1\" as the index because the caller doesn't know\n     * that we're now looking for a unique hostdevN rather than netN\n     */\n    if (virDomainNetResolveActualType(net) == VIR_DOMAIN_NET_TYPE_HOSTDEV)\n        return qemuAssignDeviceHostdevAlias(def, &net->info.alias, -1);\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"net\")) < 0)\n                continue; /* failure could be due to \"hostdevN\" */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    net->info.alias = g_strdup_printf(\"net%d\", idx);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceDiskAlias",
          "args": [
            "def",
            "def->disks[i]",
            "qemuCaps"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceDiskAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "188-258",
          "snippet": "int\nqemuAssignDeviceDiskAlias(virDomainDefPtr def,\n                          virDomainDiskDefPtr disk,\n                          virQEMUCapsPtr qemuCaps)\n{\n    qemuDomainDiskPrivatePtr diskPriv = QEMU_DOMAIN_DISK_PRIVATE(disk);\n    const char *prefix = virDomainDiskBusTypeToString(disk->bus);\n    int controllerModel = -1;\n\n    if (!disk->info.alias) {\n        if (disk->info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE) {\n            if (disk->bus == VIR_DOMAIN_DISK_BUS_SCSI) {\n                controllerModel = qemuDomainFindSCSIControllerModel(def,\n                                                                    &disk->info);\n                if (controllerModel < 0)\n                    return -1;\n            }\n\n            if (disk->bus != VIR_DOMAIN_DISK_BUS_SCSI ||\n                controllerModel == VIR_DOMAIN_CONTROLLER_MODEL_SCSI_LSILOGIC) {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.unit);\n            } else {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.target,\n                                                   disk->info.addr.drive.unit);\n            }\n        } else {\n            int idx = virDiskNameToIndex(disk->dst);\n            disk->info.alias = g_strdup_printf(\"%s-disk%d\", prefix, idx);\n        }\n    }\n\n    /* For -blockdev we need to know the qom names of the disk which are based\n     * on the alias in qemu. While certain disk types use just the alias, some\n     * need the full path into /machine/peripheral as a historical artifact.\n     */\n    if (!diskPriv->qomName &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_BLOCKDEV)) {\n        switch ((virDomainDiskBus) disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_FDC:\n        case VIR_DOMAIN_DISK_BUS_IDE:\n        case VIR_DOMAIN_DISK_BUS_SATA:\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            diskPriv->qomName = g_strdup(disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_VIRTIO:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/virtio-backend\",\n                                                disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_USB:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/%s.0/legacy[0]\",\n                                                disk->info.alias, disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_XEN:\n        case VIR_DOMAIN_DISK_BUS_UML:\n        case VIR_DOMAIN_DISK_BUS_SD:\n        case VIR_DOMAIN_DISK_BUS_LAST:\n            break;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceDiskAlias(virDomainDefPtr def,\n                          virDomainDiskDefPtr disk,\n                          virQEMUCapsPtr qemuCaps)\n{\n    qemuDomainDiskPrivatePtr diskPriv = QEMU_DOMAIN_DISK_PRIVATE(disk);\n    const char *prefix = virDomainDiskBusTypeToString(disk->bus);\n    int controllerModel = -1;\n\n    if (!disk->info.alias) {\n        if (disk->info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE) {\n            if (disk->bus == VIR_DOMAIN_DISK_BUS_SCSI) {\n                controllerModel = qemuDomainFindSCSIControllerModel(def,\n                                                                    &disk->info);\n                if (controllerModel < 0)\n                    return -1;\n            }\n\n            if (disk->bus != VIR_DOMAIN_DISK_BUS_SCSI ||\n                controllerModel == VIR_DOMAIN_CONTROLLER_MODEL_SCSI_LSILOGIC) {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.unit);\n            } else {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.target,\n                                                   disk->info.addr.drive.unit);\n            }\n        } else {\n            int idx = virDiskNameToIndex(disk->dst);\n            disk->info.alias = g_strdup_printf(\"%s-disk%d\", prefix, idx);\n        }\n    }\n\n    /* For -blockdev we need to know the qom names of the disk which are based\n     * on the alias in qemu. While certain disk types use just the alias, some\n     * need the full path into /machine/peripheral as a historical artifact.\n     */\n    if (!diskPriv->qomName &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_BLOCKDEV)) {\n        switch ((virDomainDiskBus) disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_FDC:\n        case VIR_DOMAIN_DISK_BUS_IDE:\n        case VIR_DOMAIN_DISK_BUS_SATA:\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            diskPriv->qomName = g_strdup(disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_VIRTIO:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/virtio-backend\",\n                                                disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_USB:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/%s.0/legacy[0]\",\n                                                disk->info.alias, disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_XEN:\n        case VIR_DOMAIN_DISK_BUS_UML:\n        case VIR_DOMAIN_DISK_BUS_SD:\n        case VIR_DOMAIN_DISK_BUS_LAST:\n            break;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceAliases(virDomainDefPtr def, virQEMUCapsPtr qemuCaps)\n{\n    size_t i;\n\n    for (i = 0; i < def->ndisks; i++) {\n        if (qemuAssignDeviceDiskAlias(def, def->disks[i], qemuCaps) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuAssignDeviceNetAlias(def, def->nets[i], -1) < 0)\n            return -1;\n    }\n\n    for (i = 0; i < def->nfss; i++) {\n        if (qemuAssignDeviceFSAlias(def->fss[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nsounds; i++) {\n        if (qemuAssignDeviceSoundAlias(def->sounds[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nhostdevs; i++) {\n        /* we can't start assigning at 0, since netdevs may have used\n         * up some hostdevN entries already. Also if the HostdevDef is\n         * linked to a NetDef, they will share an info and the alias\n         * will already be set, so don't try to set it again.\n         */\n        if (qemuAssignDeviceHostdevAlias(def, &def->hostdevs[i]->info->alias, -1) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nredirdevs; i++) {\n        if (qemuAssignDeviceRedirdevAlias(def, def->redirdevs[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nvideos; i++) {\n        if (qemuAssignDeviceVideoAlias(def->videos[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->ncontrollers; i++) {\n        if (qemuAssignDeviceControllerAlias(def, qemuCaps, def->controllers[i]) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->ninputs; i++) {\n        if (qemuAssignDeviceInputAlias(def, def->inputs[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nparallels; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->parallels[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nserials; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->serials[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nchannels; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->channels[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nconsoles; i++) {\n        if (qemuAssignDeviceChrAlias(def, def->consoles[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nhubs; i++) {\n        if (qemuAssignDeviceHubAlias(def->hubs[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nshmems; i++) {\n        if (qemuAssignDeviceShmemAlias(def, def->shmems[i], i) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nsmartcards; i++) {\n        if (qemuAssignDeviceSmartcardAlias(def->smartcards[i], i) < 0)\n            return -1;\n    }\n    if (def->watchdog) {\n        if (qemuAssignDeviceWatchdogAlias(def->watchdog) < 0)\n            return -1;\n    }\n    if (def->memballoon &&\n        def->memballoon->model != VIR_DOMAIN_MEMBALLOON_MODEL_NONE) {\n        if (qemuAssingDeviceMemballoonAlias(def->memballoon, 0) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nrngs; i++) {\n        if (qemuAssignDeviceRNGAlias(def, def->rngs[i]) < 0)\n            return -1;\n    }\n    if (def->tpm) {\n        if (qemuAssignDeviceTPMAlias(def->tpm, 0) < 0)\n            return -1;\n    }\n    for (i = 0; i < def->nmems; i++) {\n        if (qemuAssignDeviceMemoryAlias(NULL, def->mems[i], false) < 0)\n            return -1;\n    }\n    if (def->vsock) {\n        if (qemuAssignDeviceVsockAlias(def->vsock) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceVsockAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "573-581",
    "snippet": "int\nqemuAssignDeviceVsockAlias(virDomainVsockDefPtr vsock)\n{\n    if (vsock->info.alias)\n        return 0;\n    vsock->info.alias = g_strdup(\"vsock0\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"vsock0\""
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceVsockAlias(virDomainVsockDefPtr vsock)\n{\n    if (vsock->info.alias)\n        return 0;\n    vsock->info.alias = g_strdup(\"vsock0\");\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceInputAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "549-570",
    "snippet": "int\nqemuAssignDeviceInputAlias(virDomainDefPtr def,\n                           virDomainInputDefPtr input,\n                           int idx)\n{\n    if (input->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        int thisidx;\n        size_t i;\n\n        for (i = 0; i < def->ninputs; i++) {\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->inputs[i]->info, \"input\")) >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    input->info.alias = g_strdup_printf(\"input%d\", idx);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"input%d\"",
            "idx"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->inputs[i]->info",
            "\"input\""
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceInputAlias(virDomainDefPtr def,\n                           virDomainInputDefPtr input,\n                           int idx)\n{\n    if (input->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        int thisidx;\n        size_t i;\n\n        for (i = 0; i < def->ninputs; i++) {\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->inputs[i]->info, \"input\")) >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    input->info.alias = g_strdup_printf(\"input%d\", idx);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceWatchdogAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "536-547",
    "snippet": "int\nqemuAssignDeviceWatchdogAlias(virDomainWatchdogDefPtr watchdog)\n{\n    /* Currently, there's just one watchdog per domain */\n\n    if (watchdog->info.alias)\n        return 0;\n\n    watchdog->info.alias = g_strdup(\"watchdog0\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"watchdog0\""
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceWatchdogAlias(virDomainWatchdogDefPtr watchdog)\n{\n    /* Currently, there's just one watchdog per domain */\n\n    if (watchdog->info.alias)\n        return 0;\n\n    watchdog->info.alias = g_strdup(\"watchdog0\");\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceShmemAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "508-533",
    "snippet": "int\nqemuAssignDeviceShmemAlias(virDomainDefPtr def,\n                           virDomainShmemDefPtr shmem,\n                           int idx)\n{\n    if (shmem->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nshmems; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->shmems[i]->info,\n                                                      \"shmem\")) < 0)\n                continue;\n\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    shmem->info.alias = g_strdup_printf(\"shmem%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"shmem%d\"",
            "idx"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->shmems[i]->info",
            "\"shmem\""
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceShmemAlias(virDomainDefPtr def,\n                           virDomainShmemDefPtr shmem,\n                           int idx)\n{\n    if (shmem->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nshmems; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->shmems[i]->info,\n                                                      \"shmem\")) < 0)\n                continue;\n\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    shmem->info.alias = g_strdup_printf(\"shmem%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceMemoryAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "475-505",
    "snippet": "int\nqemuAssignDeviceMemoryAlias(virDomainDefPtr def,\n                            virDomainMemoryDefPtr mem,\n                            bool oldAlias)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n    const char *prefix;\n\n    if (mem->info.alias)\n        return 0;\n\n    if (mem->model == VIR_DOMAIN_MEMORY_MODEL_DIMM)\n        prefix = \"dimm\";\n    else\n        prefix = \"nvdimm\";\n\n    if (oldAlias) {\n        for (i = 0; i < def->nmems; i++) {\n            if ((idx = qemuDomainDeviceAliasIndex(&def->mems[i]->info, prefix)) >= maxidx)\n                maxidx = idx + 1;\n        }\n    } else {\n        maxidx = mem->info.addr.dimm.slot;\n    }\n\n    mem->info.alias = g_strdup_printf(\"%s%d\", prefix, maxidx);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%d\"",
            "prefix",
            "maxidx"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->mems[i]->info",
            "prefix"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceMemoryAlias(virDomainDefPtr def,\n                            virDomainMemoryDefPtr mem,\n                            bool oldAlias)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n    const char *prefix;\n\n    if (mem->info.alias)\n        return 0;\n\n    if (mem->model == VIR_DOMAIN_MEMORY_MODEL_DIMM)\n        prefix = \"dimm\";\n    else\n        prefix = \"nvdimm\";\n\n    if (oldAlias) {\n        for (i = 0; i < def->nmems; i++) {\n            if ((idx = qemuDomainDeviceAliasIndex(&def->mems[i]->info, prefix)) >= maxidx)\n                maxidx = idx + 1;\n        }\n    } else {\n        maxidx = mem->info.addr.dimm.slot;\n    }\n\n    mem->info.alias = g_strdup_printf(\"%s%d\", prefix, maxidx);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceRNGAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "441-460",
    "snippet": "int\nqemuAssignDeviceRNGAlias(virDomainDefPtr def,\n                         virDomainRNGDefPtr rng)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n\n    if (rng->info.alias)\n        return 0;\n\n    for (i = 0; i < def->nrngs; i++) {\n        if ((idx = qemuDomainDeviceAliasIndex(&def->rngs[i]->info, \"rng\")) >= maxidx)\n            maxidx = idx + 1;\n    }\n\n    rng->info.alias = g_strdup_printf(\"rng%d\", maxidx);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"rng%d\"",
            "maxidx"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->rngs[i]->info",
            "\"rng\""
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceRNGAlias(virDomainDefPtr def,\n                         virDomainRNGDefPtr rng)\n{\n    size_t i;\n    int maxidx = 0;\n    int idx;\n\n    if (rng->info.alias)\n        return 0;\n\n    for (i = 0; i < def->nrngs; i++) {\n        if ((idx = qemuDomainDeviceAliasIndex(&def->rngs[i]->info, \"rng\")) >= maxidx)\n            maxidx = idx + 1;\n    }\n\n    rng->info.alias = g_strdup_printf(\"rng%d\", maxidx);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceRedirdevAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "416-438",
    "snippet": "int\nqemuAssignDeviceRedirdevAlias(virDomainDefPtr def,\n                              virDomainRedirdevDefPtr redirdev,\n                              int idx)\n{\n    if (redirdev->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nredirdevs; i++) {\n            int thisidx;\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->redirdevs[i]->info, \"redir\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    redirdev->info.alias = g_strdup_printf(\"redir%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"redir%d\"",
            "idx"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->redirdevs[i]->info",
            "\"redir\""
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceRedirdevAlias(virDomainDefPtr def,\n                              virDomainRedirdevDefPtr redirdev,\n                              int idx)\n{\n    if (redirdev->info.alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n        idx = 0;\n        for (i = 0; i < def->nredirdevs; i++) {\n            int thisidx;\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->redirdevs[i]->info, \"redir\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    redirdev->info.alias = g_strdup_printf(\"redir%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceTPMAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "404-413",
    "snippet": "static int\nqemuAssignDeviceTPMAlias(virDomainTPMDefPtr tpm,\n                         int idx)\n{\n    if (tpm->info.alias)\n        return 0;\n\n    tpm->info.alias = g_strdup_printf(\"tpm%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"tpm%d\"",
            "idx"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceTPMAlias(virDomainTPMDefPtr tpm,\n                         int idx)\n{\n    if (tpm->info.alias)\n        return 0;\n\n    tpm->info.alias = g_strdup_printf(\"tpm%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssingDeviceMemballoonAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "392-401",
    "snippet": "static int\nqemuAssingDeviceMemballoonAlias(virDomainMemballoonDefPtr memballoon,\n                                int idx)\n{\n    if (memballoon->info.alias)\n        return 0;\n\n    memballoon->info.alias = g_strdup_printf(\"balloon%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"balloon%d\"",
            "idx"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssingDeviceMemballoonAlias(virDomainMemballoonDefPtr memballoon,\n                                int idx)\n{\n    if (memballoon->info.alias)\n        return 0;\n\n    memballoon->info.alias = g_strdup_printf(\"balloon%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceSmartcardAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "380-389",
    "snippet": "static int\nqemuAssignDeviceSmartcardAlias(virDomainSmartcardDefPtr smartcard,\n                               int idx)\n{\n    if (smartcard->info.alias)\n        return 0;\n\n    smartcard->info.alias = g_strdup_printf(\"smartcard%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"smartcard%d\"",
            "idx"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceSmartcardAlias(virDomainSmartcardDefPtr smartcard,\n                               int idx)\n{\n    if (smartcard->info.alias)\n        return 0;\n\n    smartcard->info.alias = g_strdup_printf(\"smartcard%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceHubAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "368-377",
    "snippet": "static int\nqemuAssignDeviceHubAlias(virDomainHubDefPtr hub,\n                         int idx)\n{\n    if (hub->info.alias)\n        return 0;\n\n    hub->info.alias = g_strdup_printf(\"hub%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"hub%d\"",
            "idx"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceHubAlias(virDomainHubDefPtr hub,\n                         int idx)\n{\n    if (hub->info.alias)\n        return 0;\n\n    hub->info.alias = g_strdup_printf(\"hub%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceVideoAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "356-365",
    "snippet": "static int\nqemuAssignDeviceVideoAlias(virDomainVideoDefPtr video,\n                           int idx)\n{\n    if (video->info.alias)\n        return 0;\n\n    video->info.alias = g_strdup_printf(\"video%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"video%d\"",
            "idx"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceVideoAlias(virDomainVideoDefPtr video,\n                           int idx)\n{\n    if (video->info.alias)\n        return 0;\n\n    video->info.alias = g_strdup_printf(\"video%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceSoundAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "344-353",
    "snippet": "static int\nqemuAssignDeviceSoundAlias(virDomainSoundDefPtr sound,\n                           int idx)\n{\n    if (sound->info.alias)\n        return 0;\n\n    sound->info.alias = g_strdup_printf(\"sound%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"sound%d\"",
            "idx"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceSoundAlias(virDomainSoundDefPtr sound,\n                           int idx)\n{\n    if (sound->info.alias)\n        return 0;\n\n    sound->info.alias = g_strdup_printf(\"sound%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceFSAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "332-341",
    "snippet": "static int\nqemuAssignDeviceFSAlias(virDomainFSDefPtr fss,\n                        int idx)\n{\n    if (fss->info.alias)\n        return 0;\n\n    fss->info.alias = g_strdup_printf(\"fs%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"fs%d\"",
            "idx"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic int\nqemuAssignDeviceFSAlias(virDomainFSDefPtr fss,\n                        int idx)\n{\n    if (fss->info.alias)\n        return 0;\n\n    fss->info.alias = g_strdup_printf(\"fs%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceNetAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "298-329",
    "snippet": "int\nqemuAssignDeviceNetAlias(virDomainDefPtr def,\n                         virDomainNetDefPtr net,\n                         int idx)\n{\n    if (net->info.alias)\n        return 0;\n\n    /* <interface type='hostdev'> uses \"hostdevN\" as the alias\n     * We must use \"-1\" as the index because the caller doesn't know\n     * that we're now looking for a unique hostdevN rather than netN\n     */\n    if (virDomainNetResolveActualType(net) == VIR_DOMAIN_NET_TYPE_HOSTDEV)\n        return qemuAssignDeviceHostdevAlias(def, &net->info.alias, -1);\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"net\")) < 0)\n                continue; /* failure could be due to \"hostdevN\" */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    net->info.alias = g_strdup_printf(\"net%d\", idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"net%d\"",
            "idx"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->nets[i]->info",
            "\"net\""
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuAssignDeviceHostdevAlias",
          "args": [
            "def",
            "&net->info.alias",
            "-1"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "qemuAssignDeviceHostdevAlias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "261-295",
          "snippet": "int\nqemuAssignDeviceHostdevAlias(virDomainDefPtr def,\n                             char **alias,\n                             int idx)\n{\n    if (*alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nhostdevs; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(def->hostdevs[i]->info, \"hostdev\")) < 0)\n                continue; /* error just means the alias wasn't \"hostdevN\", but something else */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n        /* network interfaces can also have a hostdevN alias */\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"hostdev\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    *alias = g_strdup_printf(\"hostdev%d\", idx);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceHostdevAlias(virDomainDefPtr def,\n                             char **alias,\n                             int idx)\n{\n    if (*alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nhostdevs; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(def->hostdevs[i]->info, \"hostdev\")) < 0)\n                continue; /* error just means the alias wasn't \"hostdevN\", but something else */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n        /* network interfaces can also have a hostdevN alias */\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"hostdev\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    *alias = g_strdup_printf(\"hostdev%d\", idx);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetResolveActualType",
          "args": [
            "net"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetResolveActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "31654-31729",
          "snippet": "int\nvirDomainNetResolveActualType(virDomainNetDefPtr iface)\n{\n    virNetworkDefPtr def = NULL;\n    int ret = -1;\n    g_autofree char *xml = NULL;\n    g_autoptr(virConnect) conn = NULL;\n    g_autoptr(virNetwork) net = NULL;\n\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n\n    if (iface->data.network.actual)\n        return iface->data.network.actual->type;\n\n    if (!(conn = virGetConnectNetwork()))\n        return -1;\n\n    if (!(net = virNetworkLookupByName(conn, iface->data.network.name)))\n        goto cleanup;\n\n    if (!(xml = virNetworkGetXMLDesc(net, 0)))\n        goto cleanup;\n\n    if (!(def = virNetworkDefParseString(xml, NULL)))\n        goto cleanup;\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        /* for these forward types, the actual net type really *is*\n         * NETWORK; we just keep the info from the portgroup in\n         * iface->data.network.actual\n         */\n        ret = VIR_DOMAIN_NET_TYPE_NETWORK;\n        break;\n\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        ret = VIR_DOMAIN_NET_TYPE_HOSTDEV;\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n        if (def->bridge) {\n            /* <forward type='bridge'/> <bridge name='xxx'/>\n             * is VIR_DOMAIN_NET_TYPE_BRIDGE\n             */\n            ret = VIR_DOMAIN_NET_TYPE_BRIDGE;\n            break;\n        }\n\n        /* intentionally fall through to the direct case for\n         * VIR_NETWORK_FORWARD_BRIDGE with no bridge device defined\n         */\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n        /* <forward type='bridge|private|vepa|passthrough'> are all\n         * VIR_DOMAIN_NET_TYPE_DIRECT.\n         */\n        ret = VIR_DOMAIN_NET_TYPE_DIRECT;\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto cleanup;\n    }\n\n cleanup:\n    virNetworkDefFree(def);\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetResolveActualType(virDomainNetDefPtr iface)\n{\n    virNetworkDefPtr def = NULL;\n    int ret = -1;\n    g_autofree char *xml = NULL;\n    g_autoptr(virConnect) conn = NULL;\n    g_autoptr(virNetwork) net = NULL;\n\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n\n    if (iface->data.network.actual)\n        return iface->data.network.actual->type;\n\n    if (!(conn = virGetConnectNetwork()))\n        return -1;\n\n    if (!(net = virNetworkLookupByName(conn, iface->data.network.name)))\n        goto cleanup;\n\n    if (!(xml = virNetworkGetXMLDesc(net, 0)))\n        goto cleanup;\n\n    if (!(def = virNetworkDefParseString(xml, NULL)))\n        goto cleanup;\n\n    switch ((virNetworkForwardType) def->forward.type) {\n    case VIR_NETWORK_FORWARD_NONE:\n    case VIR_NETWORK_FORWARD_NAT:\n    case VIR_NETWORK_FORWARD_ROUTE:\n    case VIR_NETWORK_FORWARD_OPEN:\n        /* for these forward types, the actual net type really *is*\n         * NETWORK; we just keep the info from the portgroup in\n         * iface->data.network.actual\n         */\n        ret = VIR_DOMAIN_NET_TYPE_NETWORK;\n        break;\n\n    case VIR_NETWORK_FORWARD_HOSTDEV:\n        ret = VIR_DOMAIN_NET_TYPE_HOSTDEV;\n        break;\n\n    case VIR_NETWORK_FORWARD_BRIDGE:\n        if (def->bridge) {\n            /* <forward type='bridge'/> <bridge name='xxx'/>\n             * is VIR_DOMAIN_NET_TYPE_BRIDGE\n             */\n            ret = VIR_DOMAIN_NET_TYPE_BRIDGE;\n            break;\n        }\n\n        /* intentionally fall through to the direct case for\n         * VIR_NETWORK_FORWARD_BRIDGE with no bridge device defined\n         */\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_NETWORK_FORWARD_PRIVATE:\n    case VIR_NETWORK_FORWARD_VEPA:\n    case VIR_NETWORK_FORWARD_PASSTHROUGH:\n        /* <forward type='bridge|private|vepa|passthrough'> are all\n         * VIR_DOMAIN_NET_TYPE_DIRECT.\n         */\n        ret = VIR_DOMAIN_NET_TYPE_DIRECT;\n        break;\n\n    case VIR_NETWORK_FORWARD_LAST:\n    default:\n        virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n        goto cleanup;\n    }\n\n cleanup:\n    virNetworkDefFree(def);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceNetAlias(virDomainDefPtr def,\n                         virDomainNetDefPtr net,\n                         int idx)\n{\n    if (net->info.alias)\n        return 0;\n\n    /* <interface type='hostdev'> uses \"hostdevN\" as the alias\n     * We must use \"-1\" as the index because the caller doesn't know\n     * that we're now looking for a unique hostdevN rather than netN\n     */\n    if (virDomainNetResolveActualType(net) == VIR_DOMAIN_NET_TYPE_HOSTDEV)\n        return qemuAssignDeviceHostdevAlias(def, &net->info.alias, -1);\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"net\")) < 0)\n                continue; /* failure could be due to \"hostdevN\" */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    net->info.alias = g_strdup_printf(\"net%d\", idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceHostdevAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "261-295",
    "snippet": "int\nqemuAssignDeviceHostdevAlias(virDomainDefPtr def,\n                             char **alias,\n                             int idx)\n{\n    if (*alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nhostdevs; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(def->hostdevs[i]->info, \"hostdev\")) < 0)\n                continue; /* error just means the alias wasn't \"hostdevN\", but something else */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n        /* network interfaces can also have a hostdevN alias */\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"hostdev\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    *alias = g_strdup_printf(\"hostdev%d\", idx);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"hostdev%d\"",
            "idx"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&def->nets[i]->info",
            "\"hostdev\""
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceHostdevAlias(virDomainDefPtr def,\n                             char **alias,\n                             int idx)\n{\n    if (*alias)\n        return 0;\n\n    if (idx == -1) {\n        size_t i;\n\n        idx = 0;\n        for (i = 0; i < def->nhostdevs; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(def->hostdevs[i]->info, \"hostdev\")) < 0)\n                continue; /* error just means the alias wasn't \"hostdevN\", but something else */\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n        /* network interfaces can also have a hostdevN alias */\n        for (i = 0; i < def->nnets; i++) {\n            int thisidx;\n\n            if ((thisidx = qemuDomainDeviceAliasIndex(&def->nets[i]->info, \"hostdev\")) < 0)\n                continue;\n            if (thisidx >= idx)\n                idx = thisidx + 1;\n        }\n    }\n\n    *alias = g_strdup_printf(\"hostdev%d\", idx);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceDiskAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "188-258",
    "snippet": "int\nqemuAssignDeviceDiskAlias(virDomainDefPtr def,\n                          virDomainDiskDefPtr disk,\n                          virQEMUCapsPtr qemuCaps)\n{\n    qemuDomainDiskPrivatePtr diskPriv = QEMU_DOMAIN_DISK_PRIVATE(disk);\n    const char *prefix = virDomainDiskBusTypeToString(disk->bus);\n    int controllerModel = -1;\n\n    if (!disk->info.alias) {\n        if (disk->info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE) {\n            if (disk->bus == VIR_DOMAIN_DISK_BUS_SCSI) {\n                controllerModel = qemuDomainFindSCSIControllerModel(def,\n                                                                    &disk->info);\n                if (controllerModel < 0)\n                    return -1;\n            }\n\n            if (disk->bus != VIR_DOMAIN_DISK_BUS_SCSI ||\n                controllerModel == VIR_DOMAIN_CONTROLLER_MODEL_SCSI_LSILOGIC) {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.unit);\n            } else {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.target,\n                                                   disk->info.addr.drive.unit);\n            }\n        } else {\n            int idx = virDiskNameToIndex(disk->dst);\n            disk->info.alias = g_strdup_printf(\"%s-disk%d\", prefix, idx);\n        }\n    }\n\n    /* For -blockdev we need to know the qom names of the disk which are based\n     * on the alias in qemu. While certain disk types use just the alias, some\n     * need the full path into /machine/peripheral as a historical artifact.\n     */\n    if (!diskPriv->qomName &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_BLOCKDEV)) {\n        switch ((virDomainDiskBus) disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_FDC:\n        case VIR_DOMAIN_DISK_BUS_IDE:\n        case VIR_DOMAIN_DISK_BUS_SATA:\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            diskPriv->qomName = g_strdup(disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_VIRTIO:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/virtio-backend\",\n                                                disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_USB:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/%s.0/legacy[0]\",\n                                                disk->info.alias, disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_XEN:\n        case VIR_DOMAIN_DISK_BUS_UML:\n        case VIR_DOMAIN_DISK_BUS_SD:\n        case VIR_DOMAIN_DISK_BUS_LAST:\n            break;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/machine/peripheral/%s/%s.0/legacy[0]\"",
            "disk->info.alias",
            "disk->info.alias"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsGet",
          "args": [
            "qemuCaps",
            "QEMU_CAPS_BLOCKDEV"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsGetPreferredMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "5555-5564",
          "snippet": "const char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nconst char *\nvirQEMUCapsGetPreferredMachine(virQEMUCapsPtr qemuCaps,\n                               virDomainVirtType virtType)\n{\n    virQEMUCapsAccelPtr accel = virQEMUCapsGetAccel(qemuCaps, virtType);\n\n    if (!accel->nmachineTypes)\n        return NULL;\n    return accel->machineTypes[0].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDiskNameToIndex",
          "args": [
            "disk->dst"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "virDiskNameToIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "426-434",
          "snippet": "int virDiskNameToIndex(const char *name)\n{\n    int idx;\n\n    if (virDiskNameParse(name, &idx, NULL) < 0)\n        idx = -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virDiskNameToIndex(const char *name)\n{\n    int idx;\n\n    if (virDiskNameParse(name, &idx, NULL) < 0)\n        idx = -1;\n\n    return idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainFindSCSIControllerModel",
          "args": [
            "def",
            "&disk->info"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainFindSCSIControllerModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain_address.c",
          "lines": "109-123",
          "snippet": "int\nqemuDomainFindSCSIControllerModel(const virDomainDef *def,\n                                  virDomainDeviceInfoPtr info)\n{\n    virDomainControllerDefPtr cont;\n\n    if (!(cont = virDomainDeviceFindSCSIController(def, &info->addr.drive))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to find a SCSI controller for idx=%d\"),\n                       info->addr.drive.controller);\n        return -1;\n    }\n\n    return cont->model;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_domain_address.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_domain_address.h\"\n#include <config.h>\n\nint\nqemuDomainFindSCSIControllerModel(const virDomainDef *def,\n                                  virDomainDeviceInfoPtr info)\n{\n    virDomainControllerDefPtr cont;\n\n    if (!(cont = virDomainDeviceFindSCSIController(def, &info->addr.drive))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to find a SCSI controller for idx=%d\"),\n                       info->addr.drive.controller);\n        return -1;\n    }\n\n    return cont->model;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskBusTypeToString",
          "args": [
            "disk->bus"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QEMU_DOMAIN_DISK_PRIVATE",
          "args": [
            "disk"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceDiskAlias(virDomainDefPtr def,\n                          virDomainDiskDefPtr disk,\n                          virQEMUCapsPtr qemuCaps)\n{\n    qemuDomainDiskPrivatePtr diskPriv = QEMU_DOMAIN_DISK_PRIVATE(disk);\n    const char *prefix = virDomainDiskBusTypeToString(disk->bus);\n    int controllerModel = -1;\n\n    if (!disk->info.alias) {\n        if (disk->info.type == VIR_DOMAIN_DEVICE_ADDRESS_TYPE_DRIVE) {\n            if (disk->bus == VIR_DOMAIN_DISK_BUS_SCSI) {\n                controllerModel = qemuDomainFindSCSIControllerModel(def,\n                                                                    &disk->info);\n                if (controllerModel < 0)\n                    return -1;\n            }\n\n            if (disk->bus != VIR_DOMAIN_DISK_BUS_SCSI ||\n                controllerModel == VIR_DOMAIN_CONTROLLER_MODEL_SCSI_LSILOGIC) {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.unit);\n            } else {\n                disk->info.alias = g_strdup_printf(\"%s%d-%d-%d-%d\", prefix,\n                                                   disk->info.addr.drive.controller,\n                                                   disk->info.addr.drive.bus,\n                                                   disk->info.addr.drive.target,\n                                                   disk->info.addr.drive.unit);\n            }\n        } else {\n            int idx = virDiskNameToIndex(disk->dst);\n            disk->info.alias = g_strdup_printf(\"%s-disk%d\", prefix, idx);\n        }\n    }\n\n    /* For -blockdev we need to know the qom names of the disk which are based\n     * on the alias in qemu. While certain disk types use just the alias, some\n     * need the full path into /machine/peripheral as a historical artifact.\n     */\n    if (!diskPriv->qomName &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_BLOCKDEV)) {\n        switch ((virDomainDiskBus) disk->bus) {\n        case VIR_DOMAIN_DISK_BUS_FDC:\n        case VIR_DOMAIN_DISK_BUS_IDE:\n        case VIR_DOMAIN_DISK_BUS_SATA:\n        case VIR_DOMAIN_DISK_BUS_SCSI:\n            diskPriv->qomName = g_strdup(disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_VIRTIO:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/virtio-backend\",\n                                                disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_USB:\n            diskPriv->qomName = g_strdup_printf(\"/machine/peripheral/%s/%s.0/legacy[0]\",\n                                                disk->info.alias, disk->info.alias);\n            break;\n\n        case VIR_DOMAIN_DISK_BUS_XEN:\n        case VIR_DOMAIN_DISK_BUS_UML:\n        case VIR_DOMAIN_DISK_BUS_SD:\n        case VIR_DOMAIN_DISK_BUS_LAST:\n            break;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceControllerAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "123-185",
    "snippet": "int\nqemuAssignDeviceControllerAlias(virDomainDefPtr domainDef,\n                                virQEMUCapsPtr qemuCaps,\n                                virDomainControllerDefPtr controller)\n{\n    const char *prefix = virDomainControllerTypeToString(controller->type);\n\n    if (controller->info.alias)\n        return 0;\n\n    if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_PCI) {\n        if (!virQEMUCapsHasPCIMultiBus(qemuCaps, domainDef)) {\n            /* qemus that don't support multiple PCI buses have\n             * hardcoded the name of their single PCI controller as\n             * \"pci\".\n             */\n            controller->info.alias = g_strdup(\"pci\");\n            return 0;\n        } else if (controller->model == VIR_DOMAIN_CONTROLLER_MODEL_PCIE_ROOT) {\n            /* The pcie-root controller on Q35 machinetypes uses a\n             * different naming convention (\"pcie.0\"), because it is\n             * hardcoded that way in qemu.\n             */\n            controller->info.alias = g_strdup_printf(\"pcie.%d\", controller->idx);\n            return 0;\n        }\n        /* All other PCI controllers use the consistent \"pci.%u\"\n         * (including the hardcoded pci-root controller on\n         * multibus-capable qemus).\n         */\n        controller->info.alias = g_strdup_printf(\"pci.%d\", controller->idx);\n        return 0;\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_IDE) {\n        /* for any machine based on e.g. I440FX or G3Beige, the\n         * first (and currently only) IDE controller is an integrated\n         * controller hardcoded with id \"ide\"\n         */\n        if (qemuDomainHasBuiltinIDE(domainDef) &&\n            controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SATA) {\n        /* for any Q35 machine, the first SATA controller is the\n         * integrated one, and it too is hardcoded with id \"ide\"\n         */\n        if (qemuDomainIsQ35(domainDef) && controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_USB) {\n        /* first USB device is \"usb\", others are normal \"usb%d\" */\n        if (controller->idx == 0) {\n            controller->info.alias = g_strdup(\"usb\");\n            return 0;\n        }\n    }\n    /* all other controllers use the default ${type}${index} naming\n     * scheme for alias/id.\n     */\n    controller->info.alias = g_strdup_printf(\"%s%d\", prefix, controller->idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%d\"",
            "prefix",
            "controller->idx"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainIsQ35",
          "args": [
            "domainDef"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainIsQ35",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "12877-12881",
          "snippet": "bool\nqemuDomainIsQ35(const virDomainDef *def)\n{\n    return qemuDomainMachineIsQ35(def->os.machine, def->os.arch);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainIsQ35(const virDomainDef *def)\n{\n    return qemuDomainMachineIsQ35(def->os.machine, def->os.arch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainHasBuiltinIDE",
          "args": [
            "domainDef"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainHasBuiltinIDE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "12949-12953",
          "snippet": "bool\nqemuDomainHasBuiltinIDE(const virDomainDef *def)\n{\n    return qemuDomainMachineHasBuiltinIDE(def->os.machine, def->os.arch);\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainHasBuiltinIDE(const virDomainDef *def)\n{\n    return qemuDomainMachineHasBuiltinIDE(def->os.machine, def->os.arch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsHasPCIMultiBus",
          "args": [
            "qemuCaps",
            "domainDef"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsHasPCIMultiBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "1947-2008",
          "snippet": "bool virQEMUCapsHasPCIMultiBus(virQEMUCapsPtr qemuCaps,\n                               const virDomainDef *def)\n{\n    /* x86_64 and i686 support PCI-multibus on all machine types\n     * since forever */\n    if (ARCH_IS_X86(def->os.arch))\n        return true;\n\n    if (def->os.arch == VIR_ARCH_PPC ||\n        ARCH_IS_PPC64(def->os.arch)) {\n        /*\n         * Usage of pci.0 naming:\n         *\n         *    ref405ep: no pci\n         *       taihu: no pci\n         *      bamboo: 1.1.0 (<= 1.5.0, so basically forever)\n         *       mac99: 2.0.0\n         *     g3beige: 2.0.0\n         *        prep: 1.4.0 (<= 1.5.0, so basically forever)\n         *     pseries: 2.0.0\n         *   mpc8544ds: forever\n         * virtex-m507: no pci\n         *     ppce500: 1.6.0\n         */\n\n        /* We do not store the qemu version in domain status XML.\n         * Hope the user is using a QEMU new enough to use 'pci.0',\n         * otherwise the results of this function will be wrong\n         * for domains already running at the time of daemon\n         * restart */\n        if (qemuCaps->version == 0)\n            return true;\n\n        if (qemuCaps->version >= 2000000)\n            return true;\n\n        if (qemuCaps->version >= 1006000 &&\n            STREQ(def->os.machine, \"ppce500\"))\n            return true;\n\n        if (STREQ(def->os.machine, \"bamboo\") ||\n            STREQ(def->os.machine, \"mpc8544ds\") ||\n            STREQ(def->os.machine, \"prep\")) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /* S390 supports PCI-multibus. */\n    if (ARCH_IS_S390(def->os.arch))\n        return true;\n\n    /* If the virt machine, both on ARM and RISC-V, supports PCI,\n     * then it also supports multibus */\n    if (qemuDomainIsARMVirt(def) ||\n        qemuDomainIsRISCVVirt(def)) {\n        return true;\n    }\n\n    return false;\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nbool virQEMUCapsHasPCIMultiBus(virQEMUCapsPtr qemuCaps,\n                               const virDomainDef *def)\n{\n    /* x86_64 and i686 support PCI-multibus on all machine types\n     * since forever */\n    if (ARCH_IS_X86(def->os.arch))\n        return true;\n\n    if (def->os.arch == VIR_ARCH_PPC ||\n        ARCH_IS_PPC64(def->os.arch)) {\n        /*\n         * Usage of pci.0 naming:\n         *\n         *    ref405ep: no pci\n         *       taihu: no pci\n         *      bamboo: 1.1.0 (<= 1.5.0, so basically forever)\n         *       mac99: 2.0.0\n         *     g3beige: 2.0.0\n         *        prep: 1.4.0 (<= 1.5.0, so basically forever)\n         *     pseries: 2.0.0\n         *   mpc8544ds: forever\n         * virtex-m507: no pci\n         *     ppce500: 1.6.0\n         */\n\n        /* We do not store the qemu version in domain status XML.\n         * Hope the user is using a QEMU new enough to use 'pci.0',\n         * otherwise the results of this function will be wrong\n         * for domains already running at the time of daemon\n         * restart */\n        if (qemuCaps->version == 0)\n            return true;\n\n        if (qemuCaps->version >= 2000000)\n            return true;\n\n        if (qemuCaps->version >= 1006000 &&\n            STREQ(def->os.machine, \"ppce500\"))\n            return true;\n\n        if (STREQ(def->os.machine, \"bamboo\") ||\n            STREQ(def->os.machine, \"mpc8544ds\") ||\n            STREQ(def->os.machine, \"prep\")) {\n            return true;\n        }\n\n        return false;\n    }\n\n    /* S390 supports PCI-multibus. */\n    if (ARCH_IS_S390(def->os.arch))\n        return true;\n\n    /* If the virt machine, both on ARM and RISC-V, supports PCI,\n     * then it also supports multibus */\n    if (qemuDomainIsARMVirt(def) ||\n        qemuDomainIsRISCVVirt(def)) {\n        return true;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainControllerTypeToString",
          "args": [
            "controller->type"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceControllerAlias(virDomainDefPtr domainDef,\n                                virQEMUCapsPtr qemuCaps,\n                                virDomainControllerDefPtr controller)\n{\n    const char *prefix = virDomainControllerTypeToString(controller->type);\n\n    if (controller->info.alias)\n        return 0;\n\n    if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_PCI) {\n        if (!virQEMUCapsHasPCIMultiBus(qemuCaps, domainDef)) {\n            /* qemus that don't support multiple PCI buses have\n             * hardcoded the name of their single PCI controller as\n             * \"pci\".\n             */\n            controller->info.alias = g_strdup(\"pci\");\n            return 0;\n        } else if (controller->model == VIR_DOMAIN_CONTROLLER_MODEL_PCIE_ROOT) {\n            /* The pcie-root controller on Q35 machinetypes uses a\n             * different naming convention (\"pcie.0\"), because it is\n             * hardcoded that way in qemu.\n             */\n            controller->info.alias = g_strdup_printf(\"pcie.%d\", controller->idx);\n            return 0;\n        }\n        /* All other PCI controllers use the consistent \"pci.%u\"\n         * (including the hardcoded pci-root controller on\n         * multibus-capable qemus).\n         */\n        controller->info.alias = g_strdup_printf(\"pci.%d\", controller->idx);\n        return 0;\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_IDE) {\n        /* for any machine based on e.g. I440FX or G3Beige, the\n         * first (and currently only) IDE controller is an integrated\n         * controller hardcoded with id \"ide\"\n         */\n        if (qemuDomainHasBuiltinIDE(domainDef) &&\n            controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_SATA) {\n        /* for any Q35 machine, the first SATA controller is the\n         * integrated one, and it too is hardcoded with id \"ide\"\n         */\n        if (qemuDomainIsQ35(domainDef) && controller->idx == 0) {\n            controller->info.alias = g_strdup(\"ide\");\n            return 0;\n        }\n    } else if (controller->type == VIR_DOMAIN_CONTROLLER_TYPE_USB) {\n        /* first USB device is \"usb\", others are normal \"usb%d\" */\n        if (controller->idx == 0) {\n            controller->info.alias = g_strdup(\"usb\");\n            return 0;\n        }\n    }\n    /* all other controllers use the default ${type}${index} naming\n     * scheme for alias/id.\n     */\n    controller->info.alias = g_strdup_printf(\"%s%d\", prefix, controller->idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuAssignDeviceChrAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "84-120",
    "snippet": "int\nqemuAssignDeviceChrAlias(virDomainDefPtr def,\n                         virDomainChrDefPtr chr,\n                         ssize_t idx)\n{\n    const char *prefix = NULL;\n\n    if (chr->info.alias)\n        return 0;\n\n    switch ((virDomainChrDeviceType)chr->deviceType) {\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_PARALLEL:\n        prefix = \"parallel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_SERIAL:\n        prefix = \"serial\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE:\n        prefix = \"console\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CHANNEL:\n        prefix = \"channel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_LAST:\n        return -1;\n    }\n\n    if (idx == -1 && (idx = qemuGetNextChrDevIndex(def, chr, prefix)) < 0)\n        return -1;\n\n    chr->info.alias = g_strdup_printf(\"%s%zd\", prefix, idx);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%zd\"",
            "prefix",
            "idx"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetNextChrDevIndex",
          "args": [
            "def",
            "chr",
            "prefix"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetNextChrDevIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "54-81",
          "snippet": "static ssize_t\nqemuGetNextChrDevIndex(virDomainDefPtr def,\n                       virDomainChrDefPtr chr,\n                       const char *prefix)\n{\n    const virDomainChrDef **arrPtr;\n    size_t cnt;\n    size_t i;\n    ssize_t idx = 0;\n    const char *prefix2 = NULL;\n\n    if (chr->deviceType == VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE)\n        prefix2 = \"serial\";\n\n    virDomainChrGetDomainPtrs(def, chr->deviceType, &arrPtr, &cnt);\n\n    for (i = 0; i < cnt; i++) {\n        ssize_t thisidx;\n        if (((thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix)) < 0) &&\n            (prefix2 &&\n             (thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix2)) < 0))\n            continue;\n        if (thisidx >= idx)\n            idx = thisidx + 1;\n    }\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic ssize_t\nqemuGetNextChrDevIndex(virDomainDefPtr def,\n                       virDomainChrDefPtr chr,\n                       const char *prefix)\n{\n    const virDomainChrDef **arrPtr;\n    size_t cnt;\n    size_t i;\n    ssize_t idx = 0;\n    const char *prefix2 = NULL;\n\n    if (chr->deviceType == VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE)\n        prefix2 = \"serial\";\n\n    virDomainChrGetDomainPtrs(def, chr->deviceType, &arrPtr, &cnt);\n\n    for (i = 0; i < cnt; i++) {\n        ssize_t thisidx;\n        if (((thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix)) < 0) &&\n            (prefix2 &&\n             (thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix2)) < 0))\n            continue;\n        if (thisidx >= idx)\n            idx = thisidx + 1;\n    }\n\n    return idx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuAssignDeviceChrAlias(virDomainDefPtr def,\n                         virDomainChrDefPtr chr,\n                         ssize_t idx)\n{\n    const char *prefix = NULL;\n\n    if (chr->info.alias)\n        return 0;\n\n    switch ((virDomainChrDeviceType)chr->deviceType) {\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_PARALLEL:\n        prefix = \"parallel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_SERIAL:\n        prefix = \"serial\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE:\n        prefix = \"console\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_CHANNEL:\n        prefix = \"channel\";\n        break;\n\n    case VIR_DOMAIN_CHR_DEVICE_TYPE_LAST:\n        return -1;\n    }\n\n    if (idx == -1 && (idx = qemuGetNextChrDevIndex(def, chr, prefix)) < 0)\n        return -1;\n\n    chr->info.alias = g_strdup_printf(\"%s%zd\", prefix, idx);\n    return 0;\n}"
  },
  {
    "function_name": "qemuGetNextChrDevIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "54-81",
    "snippet": "static ssize_t\nqemuGetNextChrDevIndex(virDomainDefPtr def,\n                       virDomainChrDefPtr chr,\n                       const char *prefix)\n{\n    const virDomainChrDef **arrPtr;\n    size_t cnt;\n    size_t i;\n    ssize_t idx = 0;\n    const char *prefix2 = NULL;\n\n    if (chr->deviceType == VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE)\n        prefix2 = \"serial\";\n\n    virDomainChrGetDomainPtrs(def, chr->deviceType, &arrPtr, &cnt);\n\n    for (i = 0; i < cnt; i++) {\n        ssize_t thisidx;\n        if (((thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix)) < 0) &&\n            (prefix2 &&\n             (thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix2)) < 0))\n            continue;\n        if (thisidx >= idx)\n            idx = thisidx + 1;\n    }\n\n    return idx;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDomainDeviceAliasIndex",
          "args": [
            "&arrPtr[i]->info",
            "prefix2"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainDeviceAliasIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
          "lines": "36-51",
          "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_alias.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrGetDomainPtrs",
          "args": [
            "def",
            "chr->deviceType",
            "&arrPtr",
            "&cnt"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrGetDomainPtrs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "18089-18107",
          "snippet": "void\nvirDomainChrGetDomainPtrs(const virDomainDef *vmdef,\n                          virDomainChrDeviceType type,\n                          const virDomainChrDef ***arrPtr,\n                          size_t *cntPtr)\n{\n    virDomainChrDef ***arrVar = NULL;\n    size_t *cntVar = NULL;\n\n    /* Cast away const; we add it back in the final assignment.  */\n    if (virDomainChrGetDomainPtrsInternal((virDomainDefPtr) vmdef, type,\n                                          &arrVar, &cntVar) < 0) {\n        *arrPtr = NULL;\n        *cntPtr = 0;\n    } else {\n        *arrPtr = (const virDomainChrDef **) *arrVar;\n        *cntPtr = *cntVar;\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainChrGetDomainPtrs(const virDomainDef *vmdef,\n                          virDomainChrDeviceType type,\n                          const virDomainChrDef ***arrPtr,\n                          size_t *cntPtr)\n{\n    virDomainChrDef ***arrVar = NULL;\n    size_t *cntVar = NULL;\n\n    /* Cast away const; we add it back in the final assignment.  */\n    if (virDomainChrGetDomainPtrsInternal((virDomainDefPtr) vmdef, type,\n                                          &arrVar, &cntVar) < 0) {\n        *arrPtr = NULL;\n        *cntPtr = 0;\n    } else {\n        *arrPtr = (const virDomainChrDef **) *arrVar;\n        *cntPtr = *cntVar;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nstatic ssize_t\nqemuGetNextChrDevIndex(virDomainDefPtr def,\n                       virDomainChrDefPtr chr,\n                       const char *prefix)\n{\n    const virDomainChrDef **arrPtr;\n    size_t cnt;\n    size_t i;\n    ssize_t idx = 0;\n    const char *prefix2 = NULL;\n\n    if (chr->deviceType == VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE)\n        prefix2 = \"serial\";\n\n    virDomainChrGetDomainPtrs(def, chr->deviceType, &arrPtr, &cnt);\n\n    for (i = 0; i < cnt; i++) {\n        ssize_t thisidx;\n        if (((thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix)) < 0) &&\n            (prefix2 &&\n             (thisidx = qemuDomainDeviceAliasIndex(&arrPtr[i]->info, prefix2)) < 0))\n            continue;\n        if (thisidx >= idx)\n            idx = thisidx + 1;\n    }\n\n    return idx;\n}"
  },
  {
    "function_name": "qemuDomainDeviceAliasIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_alias.c",
    "lines": "36-51",
    "snippet": "int\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_alias.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "info->alias + strlen(prefix)",
            "NULL",
            "10",
            "&idx"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "info->alias",
            "prefix"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_alias.h\"\n#include <config.h>\n\nint\nqemuDomainDeviceAliasIndex(const virDomainDeviceInfo *info,\n                           const char *prefix)\n{\n    int idx;\n\n    if (!info->alias)\n        return -1;\n    if (!STRPREFIX(info->alias, prefix))\n        return -1;\n\n    if (virStrToLong_i(info->alias + strlen(prefix), NULL, 10, &idx) < 0)\n        return -1;\n\n    return idx;\n}"
  }
]