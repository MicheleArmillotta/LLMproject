[
  {
    "function_name": "bhyveDomainCmdlineDefFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
    "lines": "103-116",
    "snippet": "void\nbhyveDomainCmdlineDefFree(bhyveDomainCmdlineDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    for (i = 0; i < def->num_args; i++)\n        VIR_FREE(def->args[i]);\n\n    VIR_FREE(def->args);\n    VIR_FREE(def);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->args"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "def->args[i]"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nbhyveDomainCmdlineDefFree(bhyveDomainCmdlineDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    for (i = 0; i < def->num_args; i++)\n        VIR_FREE(def->args[i]);\n\n    VIR_FREE(def->args);\n    VIR_FREE(def);\n}"
  },
  {
    "function_name": "virBhyveDriverConfigDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
    "lines": "95-101",
    "snippet": "static void\nvirBhyveDriverConfigDispose(void *obj)\n{\n    virBhyveDriverConfigPtr cfg = obj;\n\n    VIR_FREE(cfg->firmwareDir);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virBhyveDriverConfigDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->firmwareDir"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic void virBhyveDriverConfigDispose(void *obj);\n\nstatic void\nvirBhyveDriverConfigDispose(void *obj)\n{\n    virBhyveDriverConfigPtr cfg = obj;\n\n    VIR_FREE(cfg->firmwareDir);\n}"
  },
  {
    "function_name": "virBhyveDriverGetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
    "lines": "85-93",
    "snippet": "virBhyveDriverConfigPtr\nvirBhyveDriverGetConfig(bhyveConnPtr driver)\n{\n    virBhyveDriverConfigPtr cfg;\n    bhyveDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    bhyveDriverUnlock(driver);\n    return cfg;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bhyveDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "79-83",
          "snippet": "void\nbhyveDriverUnlock(bhyveConnPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nbhyveDriverUnlock(bhyveConnPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "driver->config"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bhyveDriverLock",
          "args": [
            "driver"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "bhyveDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_driver.c",
          "lines": "73-77",
          "snippet": "void\nbhyveDriverLock(bhyveConnPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"bhyve_capabilities.h\"",
            "#include \"bhyve_process.h\"",
            "#include \"bhyve_domain.h\"",
            "#include \"bhyve_parse_command.h\"",
            "#include \"bhyve_command.h\"",
            "#include \"bhyve_driver.h\"",
            "#include \"bhyve_device.h\"",
            "#include \"bhyve_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"conf/domain_capabilities.h\"",
            "#include \"virportallocator.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virxml.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virfdstream.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_audit.h\"",
            "#include \"interface_conf.h\"",
            "#include \"network_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <sys/utsname.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bhyve_capabilities.h\"\n#include \"bhyve_process.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_parse_command.h\"\n#include \"bhyve_command.h\"\n#include \"bhyve_driver.h\"\n#include \"bhyve_device.h\"\n#include \"bhyve_conf.h\"\n#include \"virutil.h\"\n#include \"conf/domain_capabilities.h\"\n#include \"virportallocator.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"viraccessapicheck.h\"\n#include \"cpu/cpu.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virtypedparam.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virxml.h\"\n#include \"virdomainobjlist.h\"\n#include \"node_device_conf.h\"\n#include \"storage_conf.h\"\n#include \"virfdstream.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_event.h\"\n#include \"domain_audit.h\"\n#include \"interface_conf.h\"\n#include \"network_conf.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <sys/utsname.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nbhyveDriverLock(bhyveConnPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirBhyveDriverConfigPtr\nvirBhyveDriverGetConfig(bhyveConnPtr driver)\n{\n    virBhyveDriverConfigPtr cfg;\n    bhyveDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    bhyveDriverUnlock(driver);\n    return cfg;\n}"
  },
  {
    "function_name": "virBhyveLoadDriverConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
    "lines": "64-83",
    "snippet": "int\nvirBhyveLoadDriverConfig(virBhyveDriverConfigPtr cfg,\n                         const char *filename)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (access(filename, R_OK) == -1) {\n        VIR_INFO(\"Could not read bhyve config file %s\", filename);\n        return 0;\n    }\n\n    if (!(conf = virConfReadFile(filename, 0)))\n        return -1;\n\n    if (virConfGetValueString(conf, \"firmware_dir\",\n                              &cfg->firmwareDir) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"firmware_dir\"",
            "&cfg->firmwareDir"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfReadFile",
          "args": [
            "filename",
            "0"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "730-752",
          "snippet": "virConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_CONFIG_FILE_SIZE (1024*1024*10)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024*1024*10)\n\nvirConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Could not read bhyve config file %s\"",
            "filename"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "filename",
            "R_OK"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirBhyveLoadDriverConfig(virBhyveDriverConfigPtr cfg,\n                         const char *filename)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    if (access(filename, R_OK) == -1) {\n        VIR_INFO(\"Could not read bhyve config file %s\", filename);\n        return 0;\n    }\n\n    if (!(conf = virConfReadFile(filename, 0)))\n        return -1;\n\n    if (virConfGetValueString(conf, \"firmware_dir\",\n                              &cfg->firmwareDir) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virBhyveDriverConfigNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
    "lines": "48-62",
    "snippet": "virBhyveDriverConfigPtr\nvirBhyveDriverConfigNew(void)\n{\n    virBhyveDriverConfigPtr cfg;\n\n    if (virBhyveConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virBhyveDriverConfigClass)))\n        return NULL;\n\n    cfg->firmwareDir = g_strdup(DATADIR \"/uefi-firmware\");\n\n    return cfg;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virBhyveDriverConfigClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "DATADIR \"/uefi-firmware\""
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "virBhyveDriverConfigClass"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBhyveConfigInitialize",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virClassPtr virBhyveDriverConfigClass;\n\nvirBhyveDriverConfigPtr\nvirBhyveDriverConfigNew(void)\n{\n    virBhyveDriverConfigPtr cfg;\n\n    if (virBhyveConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virBhyveDriverConfigClass)))\n        return NULL;\n\n    cfg->firmwareDir = g_strdup(DATADIR \"/uefi-firmware\");\n\n    return cfg;\n}"
  },
  {
    "function_name": "virBhyveConfigOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/bhyve/bhyve_conf.c",
    "lines": "38-44",
    "snippet": "static int virBhyveConfigOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virBhyveDriverConfig, virClassForObject()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"bhyve_domain.h\"",
      "#include \"bhyve_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virBhyveDriverConfig",
            "virClassForObject()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObject",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"bhyve_domain.h\"\n#include \"bhyve_conf.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic int virBhyveConfigOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virBhyveDriverConfig, virClassForObject()))\n        return -1;\n\n    return 0;\n}"
  }
]