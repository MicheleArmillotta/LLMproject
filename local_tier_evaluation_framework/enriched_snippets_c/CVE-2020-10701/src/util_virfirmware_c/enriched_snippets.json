[
  {
    "function_name": "virFirmwareParseList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
    "lines": "92-133",
    "snippet": "int\nvirFirmwareParseList(const char *list,\n                     virFirmwarePtr **firmwares,\n                     size_t *nfirmwares)\n{\n    int ret = -1;\n    char **token;\n    size_t i, j;\n\n    if (!(token = virStringSplit(list, \":\", 0)))\n        goto cleanup;\n\n    for (i = 0; token[i]; i += 2) {\n        if (!token[i] || !token[i + 1] ||\n            STREQ(token[i], \"\") || STREQ(token[i + 1], \"\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid --with-loader-nvram list: %s\"),\n                           list);\n            goto cleanup;\n        }\n    }\n\n    if (i) {\n        if (VIR_ALLOC_N(*firmwares, i / 2) < 0)\n            goto cleanup;\n        *nfirmwares = i / 2;\n\n        for (j = 0; j < i / 2; j++) {\n            virFirmwarePtr *fws = *firmwares;\n\n            if (VIR_ALLOC(fws[j]) < 0)\n                goto cleanup;\n            fws[j]->name = g_strdup(token[2 * j]);\n            fws[j]->nvram = g_strdup(token[2 * j + 1]);\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfirmware.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "token"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "token[2 * j + 1]"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "fws[j]"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*firmwares",
            "i / 2"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid --with-loader-nvram list: %s\")",
            "list"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "token[i + 1]",
            "\"\""
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "token[i]",
            "\"\""
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "list",
            "\":\"",
            "0"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirFirmwareParseList(const char *list,\n                     virFirmwarePtr **firmwares,\n                     size_t *nfirmwares)\n{\n    int ret = -1;\n    char **token;\n    size_t i, j;\n\n    if (!(token = virStringSplit(list, \":\", 0)))\n        goto cleanup;\n\n    for (i = 0; token[i]; i += 2) {\n        if (!token[i] || !token[i + 1] ||\n            STREQ(token[i], \"\") || STREQ(token[i + 1], \"\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid --with-loader-nvram list: %s\"),\n                           list);\n            goto cleanup;\n        }\n    }\n\n    if (i) {\n        if (VIR_ALLOC_N(*firmwares, i / 2) < 0)\n            goto cleanup;\n        *nfirmwares = i / 2;\n\n        for (j = 0; j < i / 2; j++) {\n            virFirmwarePtr *fws = *firmwares;\n\n            if (VIR_ALLOC(fws[j]) < 0)\n                goto cleanup;\n            fws[j]->name = g_strdup(token[2 * j]);\n            fws[j]->nvram = g_strdup(token[2 * j + 1]);\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}"
  },
  {
    "function_name": "virFirmwareParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
    "lines": "58-89",
    "snippet": "int\nvirFirmwareParse(const char *str, virFirmwarePtr firmware)\n{\n    int ret = -1;\n    char **token;\n\n    if (!(token = virStringSplit(str, \":\", 0)))\n        goto cleanup;\n\n    if (token[0]) {\n        virSkipSpaces((const char **) &token[0]);\n        if (token[1])\n            virSkipSpaces((const char **) &token[1]);\n    }\n\n    /* Exactly two tokens are expected */\n    if (!token[0] || !token[1] || token[2] ||\n        STREQ(token[0], \"\") || STREQ(token[1], \"\")) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Invalid nvram format: '%s'\"),\n                       str);\n        goto cleanup;\n    }\n\n    firmware->name = g_strdup(token[0]);\n    firmware->nvram = g_strdup(token[1]);\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfirmware.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "token"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "token[1]"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"Invalid nvram format: '%s'\")",
            "str"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "token[1]",
            "\"\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "token[0]",
            "\"\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSkipSpaces",
          "args": [
            "(const char **) &token[1]"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virSkipSpacesAndBackslash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "810-818",
          "snippet": "void\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirSkipSpacesAndBackslash(const char **str)\n{\n    const char *cur = *str;\n\n    while (g_ascii_isspace(*cur) || *cur == '\\\\')\n        cur++;\n    *str = cur;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "str",
            "\":\"",
            "0"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirFirmwareParse(const char *str, virFirmwarePtr firmware)\n{\n    int ret = -1;\n    char **token;\n\n    if (!(token = virStringSplit(str, \":\", 0)))\n        goto cleanup;\n\n    if (token[0]) {\n        virSkipSpaces((const char **) &token[0]);\n        if (token[1])\n            virSkipSpaces((const char **) &token[1]);\n    }\n\n    /* Exactly two tokens are expected */\n    if (!token[0] || !token[1] || token[2] ||\n        STREQ(token[0], \"\") || STREQ(token[1], \"\")) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Invalid nvram format: '%s'\"),\n                       str);\n        goto cleanup;\n    }\n\n    firmware->name = g_strdup(token[0]);\n    firmware->nvram = g_strdup(token[1]);\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}"
  },
  {
    "function_name": "virFirmwareFreeList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
    "lines": "46-55",
    "snippet": "void\nvirFirmwareFreeList(virFirmwarePtr *firmwares, size_t nfirmwares)\n{\n    size_t i;\n\n    for (i = 0; i < nfirmwares; i++)\n        virFirmwareFree(firmwares[i]);\n\n    VIR_FREE(firmwares);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfirmware.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "firmwares"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFirmwareFree",
          "args": [
            "firmwares[i]"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "virFirmwareFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
          "lines": "34-43",
          "snippet": "void\nvirFirmwareFree(virFirmwarePtr firmware)\n{\n    if (!firmware)\n        return;\n\n    VIR_FREE(firmware->name);\n    VIR_FREE(firmware->nvram);\n    VIR_FREE(firmware);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfirmware.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirFirmwareFree(virFirmwarePtr firmware)\n{\n    if (!firmware)\n        return;\n\n    VIR_FREE(firmware->name);\n    VIR_FREE(firmware->nvram);\n    VIR_FREE(firmware);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirFirmwareFreeList(virFirmwarePtr *firmwares, size_t nfirmwares)\n{\n    size_t i;\n\n    for (i = 0; i < nfirmwares; i++)\n        virFirmwareFree(firmwares[i]);\n\n    VIR_FREE(firmwares);\n}"
  },
  {
    "function_name": "virFirmwareFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
    "lines": "34-43",
    "snippet": "void\nvirFirmwareFree(virFirmwarePtr firmware)\n{\n    if (!firmware)\n        return;\n\n    VIR_FREE(firmware->name);\n    VIR_FREE(firmware->nvram);\n    VIR_FREE(firmware);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfirmware.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "firmware"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "firmware->nvram"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "firmware->name"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirFirmwareFree(virFirmwarePtr firmware)\n{\n    if (!firmware)\n        return;\n\n    VIR_FREE(firmware->name);\n    VIR_FREE(firmware->nvram);\n    VIR_FREE(firmware);\n}"
  }
]