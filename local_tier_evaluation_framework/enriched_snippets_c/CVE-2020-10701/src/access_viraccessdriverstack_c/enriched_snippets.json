[
  {
    "function_name": "virAccessDriverStackCheckStorageVol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "293-315",
    "snippet": "static int\nvirAccessDriverStackCheckStorageVol(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virStoragePoolDefPtr pool,\n                                    virStorageVolDefPtr vol,\n                                    virAccessPermStorageVol perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckStorageVol(priv->managers[i], driverName, pool, vol, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckStorageVol",
          "args": [
            "priv->managers[i]",
            "driverName",
            "pool",
            "vol",
            "perm"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckStorageVol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "368-382",
          "snippet": "int virAccessManagerCheckStorageVol(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virStoragePoolDefPtr pool,\n                                    virStorageVolDefPtr vol,\n                                    virAccessPermStorageVol perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p vol=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, vol, perm);\n\n    if (manager->drv->checkStorageVol)\n        ret = manager->drv->checkStorageVol(manager, driverName, pool, vol, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckStorageVol(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virStoragePoolDefPtr pool,\n                                    virStorageVolDefPtr vol,\n                                    virAccessPermStorageVol perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p vol=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, vol, perm);\n\n    if (manager->drv->checkStorageVol)\n        ret = manager->drv->checkStorageVol(manager, driverName, pool, vol, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckStorageVol(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virStoragePoolDefPtr pool,\n                                    virStorageVolDefPtr vol,\n                                    virAccessPermStorageVol perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckStorageVol(priv->managers[i], driverName, pool, vol, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckStoragePool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "270-291",
    "snippet": "static int\nvirAccessDriverStackCheckStoragePool(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virAccessPermStoragePool perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckStoragePool(priv->managers[i], driverName, pool, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckStoragePool",
          "args": [
            "priv->managers[i]",
            "driverName",
            "pool",
            "perm"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "353-366",
          "snippet": "int virAccessManagerCheckStoragePool(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virAccessPermStoragePool perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, perm);\n\n    if (manager->drv->checkStoragePool)\n        ret = manager->drv->checkStoragePool(manager, driverName, pool, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckStoragePool(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virAccessPermStoragePool perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s pool=%p perm=%d\",\n              manager, manager->drv->name, driverName, pool, perm);\n\n    if (manager->drv->checkStoragePool)\n        ret = manager->drv->checkStoragePool(manager, driverName, pool, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckStoragePool(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virStoragePoolDefPtr pool,\n                                     virAccessPermStoragePool perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckStoragePool(priv->managers[i], driverName, pool, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckSecret",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "247-268",
    "snippet": "static int\nvirAccessDriverStackCheckSecret(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virSecretDefPtr secret,\n                                virAccessPermSecret perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckSecret(priv->managers[i], driverName, secret, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckSecret",
          "args": [
            "priv->managers[i]",
            "driverName",
            "secret",
            "perm"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckSecret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "338-351",
          "snippet": "int virAccessManagerCheckSecret(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virSecretDefPtr secret,\n                                virAccessPermSecret perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s secret=%p perm=%d\",\n              manager, manager->drv->name, driverName, secret, perm);\n\n    if (manager->drv->checkSecret)\n        ret = manager->drv->checkSecret(manager, driverName, secret, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckSecret(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virSecretDefPtr secret,\n                                virAccessPermSecret perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s secret=%p perm=%d\",\n              manager, manager->drv->name, driverName, secret, perm);\n\n    if (manager->drv->checkSecret)\n        ret = manager->drv->checkSecret(manager, driverName, secret, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckSecret(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virSecretDefPtr secret,\n                                virAccessPermSecret perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckSecret(priv->managers[i], driverName, secret, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckNWFilterBinding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "224-245",
    "snippet": "static int\nvirAccessDriverStackCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNWFilterBinding(priv->managers[i], driverName, binding, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckNWFilterBinding",
          "args": [
            "priv->managers[i]",
            "driverName",
            "binding",
            "perm"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "323-336",
          "snippet": "int virAccessManagerCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s binding=%p perm=%d\",\n              manager, manager->drv->name, driverName, binding, perm);\n\n    if (manager->drv->checkNWFilterBinding)\n        ret = manager->drv->checkNWFilterBinding(manager, driverName, binding, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s binding=%p perm=%d\",\n              manager, manager->drv->name, driverName, binding, perm);\n\n    if (manager->drv->checkNWFilterBinding)\n        ret = manager->drv->checkNWFilterBinding(manager, driverName, binding, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNWFilterBinding(priv->managers[i], driverName, binding, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckNWFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "201-222",
    "snippet": "static int\nvirAccessDriverStackCheckNWFilter(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virNWFilterDefPtr nwfilter,\n                                  virAccessPermNWFilter perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNWFilter(priv->managers[i], driverName, nwfilter, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckNWFilter",
          "args": [
            "priv->managers[i]",
            "driverName",
            "nwfilter",
            "perm"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "323-336",
          "snippet": "int virAccessManagerCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s binding=%p perm=%d\",\n              manager, manager->drv->name, driverName, binding, perm);\n\n    if (manager->drv->checkNWFilterBinding)\n        ret = manager->drv->checkNWFilterBinding(manager, driverName, binding, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNWFilterBinding(virAccessManagerPtr manager,\n                                         const char *driverName,\n                                         virNWFilterBindingDefPtr binding,\n                                         virAccessPermNWFilterBinding perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s binding=%p perm=%d\",\n              manager, manager->drv->name, driverName, binding, perm);\n\n    if (manager->drv->checkNWFilterBinding)\n        ret = manager->drv->checkNWFilterBinding(manager, driverName, binding, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckNWFilter(virAccessManagerPtr manager,\n                                  const char *driverName,\n                                  virNWFilterDefPtr nwfilter,\n                                  virAccessPermNWFilter perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNWFilter(priv->managers[i], driverName, nwfilter, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckNodeDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "178-199",
    "snippet": "static int\nvirAccessDriverStackCheckNodeDevice(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virNodeDeviceDefPtr nodedev,\n                                    virAccessPermNodeDevice perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNodeDevice(priv->managers[i], driverName, nodedev, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckNodeDevice",
          "args": [
            "priv->managers[i]",
            "driverName",
            "nodedev",
            "perm"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckNodeDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "293-306",
          "snippet": "int virAccessManagerCheckNodeDevice(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virNodeDeviceDefPtr nodedev,\n                                    virAccessPermNodeDevice perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s nodedev=%p perm=%d\",\n              manager, manager->drv->name, driverName, nodedev, perm);\n\n    if (manager->drv->checkNodeDevice)\n        ret = manager->drv->checkNodeDevice(manager, driverName, nodedev, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNodeDevice(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virNodeDeviceDefPtr nodedev,\n                                    virAccessPermNodeDevice perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s nodedev=%p perm=%d\",\n              manager, manager->drv->name, driverName, nodedev, perm);\n\n    if (manager->drv->checkNodeDevice)\n        ret = manager->drv->checkNodeDevice(manager, driverName, nodedev, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckNodeDevice(virAccessManagerPtr manager,\n                                    const char *driverName,\n                                    virNodeDeviceDefPtr nodedev,\n                                    virAccessPermNodeDevice perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNodeDevice(priv->managers[i], driverName, nodedev, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckNetworkPort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "154-176",
    "snippet": "static int\nvirAccessDriverStackCheckNetworkPort(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNetworkDefPtr network,\n                                     virNetworkPortDefPtr port,\n                                     virAccessPermNetworkPort perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNetworkPort(priv->managers[i], driverName, network, port, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckNetworkPort",
          "args": [
            "priv->managers[i]",
            "driverName",
            "network",
            "port",
            "perm"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckNetworkPort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "277-291",
          "snippet": "int virAccessManagerCheckNetworkPort(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNetworkDefPtr network,\n                                     virNetworkPortDefPtr port,\n                                     virAccessPermNetworkPort perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p port=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, port, perm);\n\n    if (manager->drv->checkNetworkPort)\n        ret = manager->drv->checkNetworkPort(manager, driverName, network, port, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNetworkPort(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNetworkDefPtr network,\n                                     virNetworkPortDefPtr port,\n                                     virAccessPermNetworkPort perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p port=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, port, perm);\n\n    if (manager->drv->checkNetworkPort)\n        ret = manager->drv->checkNetworkPort(manager, driverName, network, port, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckNetworkPort(virAccessManagerPtr manager,\n                                     const char *driverName,\n                                     virNetworkDefPtr network,\n                                     virNetworkPortDefPtr port,\n                                     virAccessPermNetworkPort perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNetworkPort(priv->managers[i], driverName, network, port, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckNetwork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "131-152",
    "snippet": "static int\nvirAccessDriverStackCheckNetwork(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virNetworkDefPtr network,\n                                 virAccessPermNetwork perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNetwork(priv->managers[i], driverName, network, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckNetwork",
          "args": [
            "priv->managers[i]",
            "driverName",
            "network",
            "perm"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "262-275",
          "snippet": "int virAccessManagerCheckNetwork(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virNetworkDefPtr network,\n                                 virAccessPermNetwork perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, perm);\n\n    if (manager->drv->checkNetwork)\n        ret = manager->drv->checkNetwork(manager, driverName, network, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckNetwork(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virNetworkDefPtr network,\n                                 virAccessPermNetwork perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s network=%p perm=%d\",\n              manager, manager->drv->name, driverName, network, perm);\n\n    if (manager->drv->checkNetwork)\n        ret = manager->drv->checkNetwork(manager, driverName, network, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckNetwork(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virNetworkDefPtr network,\n                                 virAccessPermNetwork perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckNetwork(priv->managers[i], driverName, network, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckInterface",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "108-129",
    "snippet": "static int\nvirAccessDriverStackCheckInterface(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virInterfaceDefPtr iface,\n                                   virAccessPermInterface perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckInterface(priv->managers[i], driverName, iface, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckInterface",
          "args": [
            "priv->managers[i]",
            "driverName",
            "iface",
            "perm"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckInterface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "247-260",
          "snippet": "int virAccessManagerCheckInterface(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virInterfaceDefPtr iface,\n                                   virAccessPermInterface perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s iface=%p perm=%d\",\n              manager, manager->drv->name, driverName, iface, perm);\n\n    if (manager->drv->checkInterface)\n        ret = manager->drv->checkInterface(manager, driverName, iface, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckInterface(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virInterfaceDefPtr iface,\n                                   virAccessPermInterface perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s iface=%p perm=%d\",\n              manager, manager->drv->name, driverName, iface, perm);\n\n    if (manager->drv->checkInterface)\n        ret = manager->drv->checkInterface(manager, driverName, iface, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckInterface(virAccessManagerPtr manager,\n                                   const char *driverName,\n                                   virInterfaceDefPtr iface,\n                                   virAccessPermInterface perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckInterface(priv->managers[i], driverName, iface, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "85-106",
    "snippet": "static int\nvirAccessDriverStackCheckDomain(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virDomainDefPtr domain,\n                                virAccessPermDomain perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckDomain(priv->managers[i], driverName, domain, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckDomain",
          "args": [
            "priv->managers[i]",
            "driverName",
            "domain",
            "perm"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "232-245",
          "snippet": "int virAccessManagerCheckDomain(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virDomainDefPtr domain,\n                                virAccessPermDomain perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s domain=%p perm=%d\",\n              manager, manager->drv->name, driverName, domain, perm);\n\n    if (manager->drv->checkDomain)\n        ret = manager->drv->checkDomain(manager, driverName, domain, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckDomain(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virDomainDefPtr domain,\n                                virAccessPermDomain perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s domain=%p perm=%d\",\n              manager, manager->drv->name, driverName, domain, perm);\n\n    if (manager->drv->checkDomain)\n        ret = manager->drv->checkDomain(manager, driverName, domain, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckDomain(virAccessManagerPtr manager,\n                                const char *driverName,\n                                virDomainDefPtr domain,\n                                virAccessPermDomain perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckDomain(priv->managers[i], driverName, domain, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCheckConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "63-83",
    "snippet": "static int\nvirAccessDriverStackCheckConnect(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virAccessPermConnect perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckConnect(priv->managers[i], driverName, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virAccessManagerCheckConnect",
          "args": [
            "priv->managers[i]",
            "driverName",
            "perm"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerCheckConnect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "217-229",
          "snippet": "int virAccessManagerCheckConnect(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virAccessPermConnect perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s perm=%d\",\n              manager, manager->drv->name, driverName, perm);\n\n    if (manager->drv->checkConnect)\n        ret = manager->drv->checkConnect(manager, driverName, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nint virAccessManagerCheckConnect(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virAccessPermConnect perm)\n{\n    int ret = 0;\n    VIR_DEBUG(\"manager=%p(name=%s) driver=%s perm=%d\",\n              manager, manager->drv->name, driverName, perm);\n\n    if (manager->drv->checkConnect)\n        ret = manager->drv->checkConnect(manager, driverName, perm);\n\n    return virAccessManagerSanitizeError(ret, driverName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic int\nvirAccessDriverStackCheckConnect(virAccessManagerPtr manager,\n                                 const char *driverName,\n                                 virAccessPermConnect perm)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    int ret = 1;\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++) {\n        int rv;\n        /* We do not short-circuit on first denial - always check all drivers */\n        rv = virAccessManagerCheckConnect(priv->managers[i], driverName, perm);\n        if (rv == 0 && ret != -1)\n            ret = 0;\n        else if (rv < 0)\n            ret = -1;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virAccessDriverStackCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "52-60",
    "snippet": "static void virAccessDriverStackCleanup(virAccessManagerPtr manager)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++)\n        virObjectUnref(priv->managers[i]);\n    VIR_FREE(priv->managers);\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "priv->managers"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "priv->managers[i]"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nstatic void virAccessDriverStackCleanup(virAccessManagerPtr manager)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n    size_t i;\n\n    for (i = 0; i < priv->managersLen; i++)\n        virObjectUnref(priv->managers[i]);\n    VIR_FREE(priv->managers);\n}"
  },
  {
    "function_name": "virAccessDriverStackAppend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessdriverstack.c",
    "lines": "38-49",
    "snippet": "int virAccessDriverStackAppend(virAccessManagerPtr manager,\n                               virAccessManagerPtr child)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n\n    if (VIR_EXPAND_N(priv->managers, priv->managersLen, 1) < 0)\n        return -1;\n\n    priv->managers[priv->managersLen-1] = child;\n\n    return 0;\n}",
    "includes": [
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"viraccessdriverstack.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "priv->managers",
            "priv->managersLen",
            "1"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAccessManagerGetPrivateData",
          "args": [
            "manager"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "virAccessManagerGetPrivateData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/access/viraccessmanager.c",
          "lines": "182-185",
          "snippet": "void *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "# include \"viraccessdriverpolkit.h\"",
            "#include \"viraccessdriverstack.h\"",
            "#include \"viraccessdrivernop.h\"",
            "#include \"viraccessmanager.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n# include \"viraccessdriverpolkit.h\"\n#include \"viraccessdriverstack.h\"\n#include \"viraccessdrivernop.h\"\n#include \"viraccessmanager.h\"\n#include <config.h>\n\nvoid *virAccessManagerGetPrivateData(virAccessManagerPtr mgr)\n{\n    return mgr->privateData;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viraccessdriverstack.h\"\n#include <config.h>\n\nint virAccessDriverStackAppend(virAccessManagerPtr manager,\n                               virAccessManagerPtr child)\n{\n    virAccessDriverStackPrivatePtr priv = virAccessManagerGetPrivateData(manager);\n\n    if (VIR_EXPAND_N(priv->managers, priv->managersLen, 1) < 0)\n        return -1;\n\n    priv->managers[priv->managersLen-1] = child;\n\n    return 0;\n}"
  }
]