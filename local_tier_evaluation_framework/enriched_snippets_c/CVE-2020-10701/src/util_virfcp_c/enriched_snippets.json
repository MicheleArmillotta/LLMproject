[
  {
    "function_name": "virFCReadRportValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfcp.c",
    "lines": "79-86",
    "snippet": "int\nvirFCReadRportValue(const char *rport G_GNUC_UNUSED,\n                    const char *entry G_GNUC_UNUSED,\n                    char **result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virfcp.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfcp.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFCReadRportValue(const char *rport G_GNUC_UNUSED,\n                    const char *entry G_GNUC_UNUSED,\n                    char **result G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virFCIsCapableRport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfcp.c",
    "lines": "72-77",
    "snippet": "bool\nvirFCIsCapableRport(const char *rport G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return false;\n}",
    "includes": [
      "#include \"virfcp.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Not supported on this platform\")"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Not supported on this platform\""
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfcp.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFCIsCapableRport(const char *rport G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\", _(\"Not supported on this platform\"));\n    return false;\n}"
  },
  {
    "function_name": "virFCReadRportValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfcp.c",
    "lines": "49-68",
    "snippet": "int\nvirFCReadRportValue(const char *rport,\n                    const char *entry,\n                    char **result)\n{\n    g_autofree char *buf = NULL;\n    char *p = NULL;\n\n    if (virFileReadValueString(&buf, \"%s/%s/%s\",\n                               SYSFS_FC_RPORT_PATH, rport, entry) < 0) {\n        return -1;\n    }\n\n    if ((p = strchr(buf, '\\n')))\n        *p = '\\0';\n\n    *result = g_strdup(buf);\n\n    return 0;\n}",
    "includes": [
      "#include \"virfcp.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "buf"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "buf",
            "'\\n'"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadValueString",
          "args": [
            "&buf",
            "\"%s/%s/%s\"",
            "SYSFS_FC_RPORT_PATH",
            "rport",
            "entry"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "4279-4299",
          "snippet": "int\nvirFileReadValueString(char **value, const char *format, ...)\n{\n    int ret;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    ret = virFileReadAll(path, VIR_FILE_READ_VALUE_STRING_MAX, value);\n\n    if (*value)\n        virStringTrimOptionalNewline(*value);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_FILE_READ_VALUE_STRING_MAX 4096"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\n#define VIR_FILE_READ_VALUE_STRING_MAX 4096\n\nint\nvirFileReadValueString(char **value, const char *format, ...)\n{\n    int ret;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    ret = virFileReadAll(path, VIR_FILE_READ_VALUE_STRING_MAX, value);\n\n    if (*value)\n        virStringTrimOptionalNewline(*value);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfcp.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFCReadRportValue(const char *rport,\n                    const char *entry,\n                    char **result)\n{\n    g_autofree char *buf = NULL;\n    char *p = NULL;\n\n    if (virFileReadValueString(&buf, \"%s/%s/%s\",\n                               SYSFS_FC_RPORT_PATH, rport, entry) < 0) {\n        return -1;\n    }\n\n    if ((p = strchr(buf, '\\n')))\n        *p = '\\0';\n\n    *result = g_strdup(buf);\n\n    return 0;\n}"
  },
  {
    "function_name": "virFCIsCapableRport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfcp.c",
    "lines": "38-47",
    "snippet": "bool\nvirFCIsCapableRport(const char *rport)\n{\n    g_autofree char *path = NULL;\n\n    if (virBuildPath(&path, SYSFS_FC_RPORT_PATH, rport) < 0)\n        return false;\n\n    return virFileExists(path);\n}",
    "includes": [
      "#include \"virfcp.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBuildPath",
          "args": [
            "&path",
            "SYSFS_FC_RPORT_PATH",
            "rport"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "virBuildPathInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1302-1327",
          "snippet": "int\nvirBuildPathInternal(char **path, ...)\n{\n    char *path_component = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    va_list ap;\n    int ret = 0;\n\n    va_start(ap, path);\n\n    path_component = va_arg(ap, char *);\n    virBufferAdd(&buf, path_component, -1);\n\n    while ((path_component = va_arg(ap, char *)) != NULL) {\n        virBufferAddChar(&buf, '/');\n        virBufferAdd(&buf, path_component, -1);\n    }\n\n    va_end(ap);\n\n    *path = virBufferContentAndReset(&buf);\n    if (*path == NULL)\n        ret = -1;\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirBuildPathInternal(char **path, ...)\n{\n    char *path_component = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    va_list ap;\n    int ret = 0;\n\n    va_start(ap, path);\n\n    path_component = va_arg(ap, char *);\n    virBufferAdd(&buf, path_component, -1);\n\n    while ((path_component = va_arg(ap, char *)) != NULL) {\n        virBufferAddChar(&buf, '/');\n        virBufferAdd(&buf, path_component, -1);\n    }\n\n    va_end(ap);\n\n    *path = virBufferContentAndReset(&buf);\n    if (*path == NULL)\n        ret = -1;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virfcp.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFCIsCapableRport(const char *rport)\n{\n    g_autofree char *path = NULL;\n\n    if (virBuildPath(&path, SYSFS_FC_RPORT_PATH, rport) < 0)\n        return false;\n\n    return virFileExists(path);\n}"
  }
]