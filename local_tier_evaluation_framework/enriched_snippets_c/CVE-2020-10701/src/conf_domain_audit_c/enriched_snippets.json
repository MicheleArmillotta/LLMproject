[
  {
    "function_name": "virDomainAuditInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "941-971",
    "snippet": "void\nvirDomainAuditInput(virDomainObjPtr vm,\n                    virDomainInputDefPtr input,\n                    const char *reason,\n                    bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *vmname = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    switch ((virDomainInputType) input->type) {\n    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n    case VIR_DOMAIN_INPUT_TYPE_KBD:\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=evdev reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(input->source.evdev));\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_LAST:\n        break;\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=evdev reason=%s %s uuid=%s path=%s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "VIR_AUDIT_STR(input->source.evdev)"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "input->source.evdev"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"vm\"",
            "vm->def->name"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditInput(virDomainObjPtr vm,\n                    virDomainInputDefPtr input,\n                    const char *reason,\n                    bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *vmname = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    switch ((virDomainInputType) input->type) {\n    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n    case VIR_DOMAIN_INPUT_TYPE_KBD:\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=evdev reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(input->source.evdev));\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_LAST:\n        break;\n    }\n}"
  },
  {
    "function_name": "virDomainAuditShmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "898-938",
    "snippet": "void\nvirDomainAuditShmem(virDomainObjPtr vm,\n                    virDomainShmemDefPtr def,\n                    const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname = virAuditEncode(\"vm\", vm->def->name);\n    const char *srcpath = virDomainChrSourceDefGetPath(&def->server.chr);\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n    char *shmpath = NULL;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!vmname) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    shmpath = g_strdup_printf(\"/dev/shm/%s\", def->name);\n\n    if (!virt) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 vm->def->virtType);\n        virt = \"?\";\n    }\n\n    if (def->server.enabled) {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=ivshmem-socket reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(srcpath));\n    } else {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=shmem reason=%s %s uuid=%s size=%llu path=%s\",\n                  virt, reason, vmname, uuidstr, def->size, VIR_AUDIT_STR(shmpath));\n   }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(shmpath);\n    return;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "shmpath"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=shmem reason=%s %s uuid=%s size=%llu path=%s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "def->size",
            "VIR_AUDIT_STR(shmpath)"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "shmpath"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=ivshmem-socket reason=%s %s uuid=%s path=%s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "VIR_AUDIT_STR(srcpath)"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "srcpath"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected virt type %d while encoding audit message\"",
            "vm->def->virtType"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/shm/%s\"",
            "def->name"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrSourceDefGetPath",
          "args": [
            "&def->server.chr"
          ],
          "line": 905
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrSourceDefGetPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2492-2521",
          "snippet": "const char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"vm\"",
            "vm->def->name"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditShmem(virDomainObjPtr vm,\n                    virDomainShmemDefPtr def,\n                    const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname = virAuditEncode(\"vm\", vm->def->name);\n    const char *srcpath = virDomainChrSourceDefGetPath(&def->server.chr);\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n    char *shmpath = NULL;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!vmname) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    shmpath = g_strdup_printf(\"/dev/shm/%s\", def->name);\n\n    if (!virt) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 vm->def->virtType);\n        virt = \"?\";\n    }\n\n    if (def->server.enabled) {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=ivshmem-socket reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(srcpath));\n    } else {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=shmem reason=%s %s uuid=%s size=%llu path=%s\",\n                  virt, reason, vmname, uuidstr, def->size, VIR_AUDIT_STR(shmpath));\n   }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(shmpath);\n    return;\n}"
  },
  {
    "function_name": "virDomainAuditSecurityLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "872-896",
    "snippet": "void\nvirDomainAuditSecurityLabel(virDomainObjPtr vm, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    size_t i;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    for (i = 0; i < vm->def->nseclabels; i++) {\n        VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_ID, success,\n                  \"virt=%s %s uuid=%s vm-ctx=%s img-ctx=%s model=%s\",\n                  virt, vmname, uuidstr,\n                  VIR_AUDIT_STR(vm->def->seclabels[i]->label),\n                  VIR_AUDIT_STR(vm->def->seclabels[i]->imagelabel),\n                  VIR_AUDIT_STR(vm->def->seclabels[i]->model));\n    }\n\n    VIR_FREE(vmname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_MACHINE_ID",
            "success",
            "\"virt=%s %s uuid=%s vm-ctx=%s img-ctx=%s model=%s\"",
            "virt",
            "vmname",
            "uuidstr",
            "VIR_AUDIT_STR(vm->def->seclabels[i]->label)",
            "VIR_AUDIT_STR(vm->def->seclabels[i]->imagelabel)",
            "VIR_AUDIT_STR(vm->def->seclabels[i]->model)"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "vm->def->seclabels[i]->model"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "vm->def->seclabels[i]->imagelabel"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "vm->def->seclabels[i]->label"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"vm\"",
            "vm->def->name"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 880
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditSecurityLabel(virDomainObjPtr vm, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    size_t i;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    for (i = 0; i < vm->def->nseclabels; i++) {\n        VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_ID, success,\n                  \"virt=%s %s uuid=%s vm-ctx=%s img-ctx=%s model=%s\",\n                  virt, vmname, uuidstr,\n                  VIR_AUDIT_STR(vm->def->seclabels[i]->label),\n                  VIR_AUDIT_STR(vm->def->seclabels[i]->imagelabel),\n                  VIR_AUDIT_STR(vm->def->seclabels[i]->model));\n    }\n\n    VIR_FREE(vmname);\n}"
  },
  {
    "function_name": "virDomainAuditStop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "866-870",
    "snippet": "void\nvirDomainAuditStop(virDomainObjPtr vm, const char *reason)\n{\n    virDomainAuditLifecycle(vm, \"stop\", reason, true);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditLifecycle",
          "args": [
            "vm",
            "\"stop\"",
            "reason",
            "true"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditLifecycle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "748-768",
          "snippet": "static void\nvirDomainAuditLifecycle(virDomainObjPtr vm, const char *op,\n                        const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, success,\n              \"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\",\n              virt, op, reason, vmname, uuidstr, (long long)vm->pid);\n\n    VIR_FREE(vmname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditLifecycle(virDomainObjPtr vm, const char *op,\n                        const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, success,\n              \"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\",\n              virt, op, reason, vmname, uuidstr, (long long)vm->pid);\n\n    VIR_FREE(vmname);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditStop(virDomainObjPtr vm, const char *reason)\n{\n    virDomainAuditLifecycle(vm, \"stop\", reason, true);\n}"
  },
  {
    "function_name": "virDomainAuditInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "842-864",
    "snippet": "void\nvirDomainAuditInit(virDomainObjPtr vm,\n                   pid_t initpid,\n                   ino_t pidns)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, true,\n              \"virt=%s op=init %s uuid=%s vm-pid=%lld init-pid=%lld pid-ns=%lld\",\n              virt, vmname, uuidstr, (long long)vm->pid, (long long)initpid,\n              (long long)pidns);\n\n    VIR_FREE(vmname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_MACHINE_CONTROL",
            "true",
            "\"virt=%s op=init %s uuid=%s vm-pid=%lld init-pid=%lld pid-ns=%lld\"",
            "virt",
            "vmname",
            "uuidstr",
            "(long long)vm->pid",
            "(long long)initpid",
            "(long long)pidns"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"vm\"",
            "vm->def->name"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditInit(virDomainObjPtr vm,\n                   pid_t initpid,\n                   ino_t pidns)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, true,\n              \"virt=%s op=init %s uuid=%s vm-pid=%lld init-pid=%lld pid-ns=%lld\",\n              virt, vmname, uuidstr, (long long)vm->pid, (long long)initpid,\n              (long long)pidns);\n\n    VIR_FREE(vmname);\n}"
  },
  {
    "function_name": "virDomainAuditStart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "771-840",
    "snippet": "void\nvirDomainAuditStart(virDomainObjPtr vm, const char *reason, bool success)\n{\n    size_t i;\n\n    for (i = 0; i < vm->def->ndisks; i++)\n        virDomainAuditDisk(vm, NULL, vm->def->disks[i]->src, \"start\", true);\n\n    for (i = 0; i < vm->def->nfss; i++) {\n        virDomainFSDefPtr fs = vm->def->fss[i];\n        virDomainAuditFS(vm, NULL, fs, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n        virDomainAuditNet(vm, NULL, net, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = vm->def->hostdevs[i];\n        virDomainAuditHostdev(vm, hostdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nredirdevs; i++) {\n        virDomainRedirdevDefPtr redirdev = vm->def->redirdevs[i];\n        virDomainAuditRedirdev(vm, redirdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nserials; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->serials[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nparallels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->parallels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nchannels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->channels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (i == 0 &&\n            (vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_SERIAL ||\n             vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE) &&\n             vm->def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n            continue;\n\n        virDomainAuditChardev(vm, NULL, vm->def->consoles[i], \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nsmartcards; i++)\n        virDomainAuditSmartcard(vm, vm->def->smartcards[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nrngs; i++)\n        virDomainAuditRNG(vm, NULL, vm->def->rngs[i], \"start\", true);\n\n    if (vm->def->tpm)\n        virDomainAuditTPM(vm, vm->def->tpm, \"start\", true);\n\n    for (i = 0; i < vm->def->nshmems; i++)\n        virDomainAuditShmem(vm, vm->def->shmems[i], \"start\", true);\n\n    for (i = 0; i < vm->def->ninputs; i++)\n        virDomainAuditInput(vm, vm->def->inputs[i], \"start\", true);\n\n    virDomainAuditMemory(vm, 0, virDomainDefGetMemoryTotal(vm->def),\n                         \"start\", true);\n    virDomainAuditVcpu(vm, 0, virDomainDefGetVcpus(vm->def), \"start\", true);\n    if (vm->def->niothreadids)\n        virDomainAuditIOThread(vm, 0, vm->def->niothreadids, \"start\", true);\n\n    virDomainAuditLifecycle(vm, \"start\", reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditLifecycle",
          "args": [
            "vm",
            "\"start\"",
            "reason",
            "success"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditLifecycle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "748-768",
          "snippet": "static void\nvirDomainAuditLifecycle(virDomainObjPtr vm, const char *op,\n                        const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, success,\n              \"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\",\n              virt, op, reason, vmname, uuidstr, (long long)vm->pid);\n\n    VIR_FREE(vmname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditLifecycle(virDomainObjPtr vm, const char *op,\n                        const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, success,\n              \"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\",\n              virt, op, reason, vmname, uuidstr, (long long)vm->pid);\n\n    VIR_FREE(vmname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditIOThread",
          "args": [
            "vm",
            "0",
            "vm->def->niothreadids",
            "\"start\"",
            "true"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditIOThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "739-746",
          "snippet": "void\nvirDomainAuditIOThread(virDomainObjPtr vm,\n                       unsigned int oldiothread, unsigned int newiothread,\n                       const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"iothread\", oldiothread, newiothread,\n                                  reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditIOThread(virDomainObjPtr vm,\n                       unsigned int oldiothread, unsigned int newiothread,\n                       const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"iothread\", oldiothread, newiothread,\n                                  reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditVcpu",
          "args": [
            "vm",
            "0",
            "virDomainDefGetVcpus(vm->def)",
            "\"start\"",
            "true"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditVcpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "731-737",
          "snippet": "void\nvirDomainAuditVcpu(virDomainObjPtr vm,\n                   unsigned int oldvcpu, unsigned int newvcpu,\n                   const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"vcpu\", oldvcpu, newvcpu, reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditVcpu(virDomainObjPtr vm,\n                   unsigned int oldvcpu, unsigned int newvcpu,\n                   const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"vcpu\", oldvcpu, newvcpu, reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "vm->def"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditMemory",
          "args": [
            "vm",
            "0",
            "virDomainDefGetMemoryTotal(vm->def)",
            "\"start\"",
            "true"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditMemory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "723-729",
          "snippet": "void\nvirDomainAuditMemory(virDomainObjPtr vm,\n                     unsigned long long oldmem, unsigned long long newmem,\n                     const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"mem\", oldmem, newmem, reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditMemory(virDomainObjPtr vm,\n                     unsigned long long oldmem, unsigned long long newmem,\n                     const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"mem\", oldmem, newmem, reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "vm->def"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditInput",
          "args": [
            "vm",
            "vm->def->inputs[i]",
            "\"start\"",
            "true"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditInput",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "941-971",
          "snippet": "void\nvirDomainAuditInput(virDomainObjPtr vm,\n                    virDomainInputDefPtr input,\n                    const char *reason,\n                    bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *vmname = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    switch ((virDomainInputType) input->type) {\n    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n    case VIR_DOMAIN_INPUT_TYPE_KBD:\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=evdev reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(input->source.evdev));\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_LAST:\n        break;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditInput(virDomainObjPtr vm,\n                    virDomainInputDefPtr input,\n                    const char *reason,\n                    bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    g_autofree char *vmname = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    switch ((virDomainInputType) input->type) {\n    case VIR_DOMAIN_INPUT_TYPE_MOUSE:\n    case VIR_DOMAIN_INPUT_TYPE_TABLET:\n    case VIR_DOMAIN_INPUT_TYPE_KBD:\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_PASSTHROUGH:\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=evdev reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(input->source.evdev));\n        break;\n\n    case VIR_DOMAIN_INPUT_TYPE_LAST:\n        break;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditShmem",
          "args": [
            "vm",
            "vm->def->shmems[i]",
            "\"start\"",
            "true"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditShmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "898-938",
          "snippet": "void\nvirDomainAuditShmem(virDomainObjPtr vm,\n                    virDomainShmemDefPtr def,\n                    const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname = virAuditEncode(\"vm\", vm->def->name);\n    const char *srcpath = virDomainChrSourceDefGetPath(&def->server.chr);\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n    char *shmpath = NULL;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!vmname) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    shmpath = g_strdup_printf(\"/dev/shm/%s\", def->name);\n\n    if (!virt) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 vm->def->virtType);\n        virt = \"?\";\n    }\n\n    if (def->server.enabled) {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=ivshmem-socket reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(srcpath));\n    } else {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=shmem reason=%s %s uuid=%s size=%llu path=%s\",\n                  virt, reason, vmname, uuidstr, def->size, VIR_AUDIT_STR(shmpath));\n   }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(shmpath);\n    return;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditShmem(virDomainObjPtr vm,\n                    virDomainShmemDefPtr def,\n                    const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname = virAuditEncode(\"vm\", vm->def->name);\n    const char *srcpath = virDomainChrSourceDefGetPath(&def->server.chr);\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n    char *shmpath = NULL;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!vmname) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    shmpath = g_strdup_printf(\"/dev/shm/%s\", def->name);\n\n    if (!virt) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 vm->def->virtType);\n        virt = \"?\";\n    }\n\n    if (def->server.enabled) {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=ivshmem-socket reason=%s %s uuid=%s path=%s\",\n                  virt, reason, vmname, uuidstr, VIR_AUDIT_STR(srcpath));\n    } else {\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=shmem reason=%s %s uuid=%s size=%llu path=%s\",\n                  virt, reason, vmname, uuidstr, def->size, VIR_AUDIT_STR(shmpath));\n   }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(shmpath);\n    return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditTPM",
          "args": [
            "vm",
            "vm->def->tpm",
            "\"start\"",
            "true"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditTPM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "525-572",
          "snippet": "static void\nvirDomainAuditTPM(virDomainObjPtr vm, virDomainTPMDefPtr tpm,\n                  const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *path = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (tpm->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        path = tpm->data.passthrough.source.data.file.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n        path = tpm->data.emulator.source.data.nix.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm-emulator reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n    default:\n        break;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditTPM(virDomainObjPtr vm, virDomainTPMDefPtr tpm,\n                  const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *path = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (tpm->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        path = tpm->data.passthrough.source.data.file.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n        path = tpm->data.emulator.source.data.nix.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm-emulator reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n    default:\n        break;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditRNG",
          "args": [
            "vm",
            "NULL",
            "vm->def->rngs[i]",
            "\"start\"",
            "true"
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditRNG",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "210-251",
          "snippet": "void\nvirDomainAuditRNG(virDomainObjPtr vm,\n                  virDomainRNGDefPtr oldDef, virDomainRNGDefPtr newDef,\n                  const char *reason, bool success)\n{\n    const char *newsrcpath = NULL;\n    const char *oldsrcpath = NULL;\n\n    if (newDef) {\n        switch ((virDomainRNGBackend) newDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            newsrcpath = newDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            newsrcpath = virDomainChrSourceDefGetPath(newDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    if (oldDef) {\n        switch ((virDomainRNGBackend) oldDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            oldsrcpath = oldDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            oldsrcpath = virDomainChrSourceDefGetPath(oldDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    virDomainAuditGenericDev(vm, \"rng\", oldsrcpath, newsrcpath, reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditRNG(virDomainObjPtr vm,\n                  virDomainRNGDefPtr oldDef, virDomainRNGDefPtr newDef,\n                  const char *reason, bool success)\n{\n    const char *newsrcpath = NULL;\n    const char *oldsrcpath = NULL;\n\n    if (newDef) {\n        switch ((virDomainRNGBackend) newDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            newsrcpath = newDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            newsrcpath = virDomainChrSourceDefGetPath(newDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    if (oldDef) {\n        switch ((virDomainRNGBackend) oldDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            oldsrcpath = oldDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            oldsrcpath = virDomainChrSourceDefGetPath(oldDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    virDomainAuditGenericDev(vm, \"rng\", oldsrcpath, newsrcpath, reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditSmartcard",
          "args": [
            "vm",
            "vm->def->smartcards[i]",
            "\"start\"",
            "true"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditSmartcard",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "145-187",
          "snippet": "static void\nvirDomainAuditSmartcard(virDomainObjPtr vm,\n                        virDomainSmartcardDefPtr def,\n                        const char *reason,\n                        bool success)\n{\n    const char *database = VIR_DOMAIN_SMARTCARD_DEFAULT_DATABASE;\n    size_t i;\n\n    if (def) {\n        switch ((virDomainSmartcardType) def->type) {\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST:\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, \"nss-smartcard-device\",\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST_CERTIFICATES:\n            for (i = 0; i < VIR_DOMAIN_SMARTCARD_NUM_CERTIFICATES; i++) {\n                virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                         def->data.cert.file[i],\n                                         reason, success);\n            }\n\n            if (def->data.cert.database)\n                database = def->data.cert.database;\n\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, database,\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_PASSTHROUGH:\n            virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                     virDomainChrSourceDefGetPath(def->data.passthru),\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_LAST:\n            break;\n        }\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditSmartcard(virDomainObjPtr vm,\n                        virDomainSmartcardDefPtr def,\n                        const char *reason,\n                        bool success)\n{\n    const char *database = VIR_DOMAIN_SMARTCARD_DEFAULT_DATABASE;\n    size_t i;\n\n    if (def) {\n        switch ((virDomainSmartcardType) def->type) {\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST:\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, \"nss-smartcard-device\",\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST_CERTIFICATES:\n            for (i = 0; i < VIR_DOMAIN_SMARTCARD_NUM_CERTIFICATES; i++) {\n                virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                         def->data.cert.file[i],\n                                         reason, success);\n            }\n\n            if (def->data.cert.database)\n                database = def->data.cert.database;\n\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, database,\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_PASSTHROUGH:\n            virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                     virDomainChrSourceDefGetPath(def->data.passthru),\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_LAST:\n            break;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditChardev",
          "args": [
            "vm",
            "NULL",
            "vm->def->consoles[i]",
            "\"start\"",
            "true"
          ],
          "line": 815
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditChardev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "122-142",
          "snippet": "void\nvirDomainAuditChardev(virDomainObjPtr vm,\n                      virDomainChrDefPtr oldDef,\n                      virDomainChrDefPtr newDef,\n                      const char *reason,\n                      bool success)\n{\n    virDomainChrSourceDefPtr oldsrc = NULL;\n    virDomainChrSourceDefPtr newsrc = NULL;\n\n    if (oldDef)\n        oldsrc = oldDef->source;\n\n    if (newDef)\n        newsrc = newDef->source;\n\n    virDomainAuditGenericDev(vm, \"chardev\",\n                             virDomainChrSourceDefGetPath(oldsrc),\n                             virDomainChrSourceDefGetPath(newsrc),\n                             reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditChardev(virDomainObjPtr vm,\n                      virDomainChrDefPtr oldDef,\n                      virDomainChrDefPtr newDef,\n                      const char *reason,\n                      bool success)\n{\n    virDomainChrSourceDefPtr oldsrc = NULL;\n    virDomainChrSourceDefPtr newsrc = NULL;\n\n    if (oldDef)\n        oldsrc = oldDef->source;\n\n    if (newDef)\n        newsrc = newDef->source;\n\n    virDomainAuditGenericDev(vm, \"chardev\",\n                             virDomainChrSourceDefGetPath(oldsrc),\n                             virDomainChrSourceDefGetPath(newsrc),\n                             reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditRedirdev",
          "args": [
            "vm",
            "redirdev",
            "\"start\"",
            "true"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditRedirdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "471-512",
          "snippet": "void\nvirDomainAuditRedirdev(virDomainObjPtr vm, virDomainRedirdevDefPtr redirdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (redirdev->bus) {\n    case VIR_DOMAIN_REDIRDEV_BUS_USB:\n        address = g_strdup(\"USB redirdev\");\n        break;\n    default:\n        VIR_WARN(\"Unexpected redirdev bus while encoding audit message: %d\",\n                 redirdev->bus);\n        goto cleanup;\n    }\n\n    if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n              virt, reason, vmname, uuidstr,\n              virDomainRedirdevBusTypeToString(redirdev->bus),\n              device);\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditRedirdev(virDomainObjPtr vm, virDomainRedirdevDefPtr redirdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (redirdev->bus) {\n    case VIR_DOMAIN_REDIRDEV_BUS_USB:\n        address = g_strdup(\"USB redirdev\");\n        break;\n    default:\n        VIR_WARN(\"Unexpected redirdev bus while encoding audit message: %d\",\n                 redirdev->bus);\n        goto cleanup;\n    }\n\n    if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n              virt, reason, vmname, uuidstr,\n              virDomainRedirdevBusTypeToString(redirdev->bus),\n              device);\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "hostdev",
            "\"start\"",
            "true"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditNet",
          "args": [
            "vm",
            "NULL",
            "net",
            "\"start\"",
            "true"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "266-284",
          "snippet": "void\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditFS",
          "args": [
            "vm",
            "NULL",
            "fs",
            "\"start\"",
            "true"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditFS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "254-263",
          "snippet": "void\nvirDomainAuditFS(virDomainObjPtr vm,\n                 virDomainFSDefPtr oldDef, virDomainFSDefPtr newDef,\n                 const char *reason, bool success)\n{\n    virDomainAuditGenericDev(vm, \"fs\",\n                             oldDef ? oldDef->src->path : NULL,\n                             newDef ? newDef->src->path : NULL,\n                             reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditFS(virDomainObjPtr vm,\n                 virDomainFSDefPtr oldDef, virDomainFSDefPtr newDef,\n                 const char *reason, bool success)\n{\n    virDomainAuditGenericDev(vm, \"fs\",\n                             oldDef ? oldDef->src->path : NULL,\n                             newDef ? newDef->src->path : NULL,\n                             reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditDisk",
          "args": [
            "vm",
            "NULL",
            "vm->def->disks[i]->src",
            "\"start\"",
            "true"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "190-207",
          "snippet": "void\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditStart(virDomainObjPtr vm, const char *reason, bool success)\n{\n    size_t i;\n\n    for (i = 0; i < vm->def->ndisks; i++)\n        virDomainAuditDisk(vm, NULL, vm->def->disks[i]->src, \"start\", true);\n\n    for (i = 0; i < vm->def->nfss; i++) {\n        virDomainFSDefPtr fs = vm->def->fss[i];\n        virDomainAuditFS(vm, NULL, fs, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n        virDomainAuditNet(vm, NULL, net, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = vm->def->hostdevs[i];\n        virDomainAuditHostdev(vm, hostdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nredirdevs; i++) {\n        virDomainRedirdevDefPtr redirdev = vm->def->redirdevs[i];\n        virDomainAuditRedirdev(vm, redirdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nserials; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->serials[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nparallels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->parallels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nchannels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->channels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (i == 0 &&\n            (vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_SERIAL ||\n             vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE) &&\n             vm->def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n            continue;\n\n        virDomainAuditChardev(vm, NULL, vm->def->consoles[i], \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nsmartcards; i++)\n        virDomainAuditSmartcard(vm, vm->def->smartcards[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nrngs; i++)\n        virDomainAuditRNG(vm, NULL, vm->def->rngs[i], \"start\", true);\n\n    if (vm->def->tpm)\n        virDomainAuditTPM(vm, vm->def->tpm, \"start\", true);\n\n    for (i = 0; i < vm->def->nshmems; i++)\n        virDomainAuditShmem(vm, vm->def->shmems[i], \"start\", true);\n\n    for (i = 0; i < vm->def->ninputs; i++)\n        virDomainAuditInput(vm, vm->def->inputs[i], \"start\", true);\n\n    virDomainAuditMemory(vm, 0, virDomainDefGetMemoryTotal(vm->def),\n                         \"start\", true);\n    virDomainAuditVcpu(vm, 0, virDomainDefGetVcpus(vm->def), \"start\", true);\n    if (vm->def->niothreadids)\n        virDomainAuditIOThread(vm, 0, vm->def->niothreadids, \"start\", true);\n\n    virDomainAuditLifecycle(vm, \"start\", reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditLifecycle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "748-768",
    "snippet": "static void\nvirDomainAuditLifecycle(virDomainObjPtr vm, const char *op,\n                        const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, success,\n              \"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\",\n              virt, op, reason, vmname, uuidstr, (long long)vm->pid);\n\n    VIR_FREE(vmname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_MACHINE_CONTROL",
            "success",
            "\"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\"",
            "virt",
            "op",
            "reason",
            "vmname",
            "uuidstr",
            "(long long)vm->pid"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"vm\"",
            "vm->def->name"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditLifecycle(virDomainObjPtr vm, const char *op,\n                        const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_MACHINE_CONTROL, success,\n              \"virt=%s op=%s reason=%s %s uuid=%s vm-pid=%lld\",\n              virt, op, reason, vmname, uuidstr, (long long)vm->pid);\n\n    VIR_FREE(vmname);\n}"
  },
  {
    "function_name": "virDomainAuditIOThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "739-746",
    "snippet": "void\nvirDomainAuditIOThread(virDomainObjPtr vm,\n                       unsigned int oldiothread, unsigned int newiothread,\n                       const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"iothread\", oldiothread, newiothread,\n                                  reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditResource",
          "args": [
            "vm",
            "\"iothread\"",
            "oldiothread",
            "newiothread",
            "reason",
            "success"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditResource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "700-721",
          "snippet": "static void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditIOThread(virDomainObjPtr vm,\n                       unsigned int oldiothread, unsigned int newiothread,\n                       const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"iothread\", oldiothread, newiothread,\n                                  reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditVcpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "731-737",
    "snippet": "void\nvirDomainAuditVcpu(virDomainObjPtr vm,\n                   unsigned int oldvcpu, unsigned int newvcpu,\n                   const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"vcpu\", oldvcpu, newvcpu, reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditResource",
          "args": [
            "vm",
            "\"vcpu\"",
            "oldvcpu",
            "newvcpu",
            "reason",
            "success"
          ],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditResource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "700-721",
          "snippet": "static void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditVcpu(virDomainObjPtr vm,\n                   unsigned int oldvcpu, unsigned int newvcpu,\n                   const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"vcpu\", oldvcpu, newvcpu, reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "723-729",
    "snippet": "void\nvirDomainAuditMemory(virDomainObjPtr vm,\n                     unsigned long long oldmem, unsigned long long newmem,\n                     const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"mem\", oldmem, newmem, reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditResource",
          "args": [
            "vm",
            "\"mem\"",
            "oldmem",
            "newmem",
            "reason",
            "success"
          ],
          "line": 728
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditResource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "700-721",
          "snippet": "static void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditMemory(virDomainObjPtr vm,\n                     unsigned long long oldmem, unsigned long long newmem,\n                     const char *reason, bool success)\n{\n    return virDomainAuditResource(vm, \"mem\", oldmem, newmem, reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditResource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "700-721",
    "snippet": "static void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\"",
            "virt",
            "resource",
            "reason",
            "vmname",
            "uuidstr",
            "resource",
            "oldval",
            "resource",
            "newval"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"vm\"",
            "vm->def->name"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditResource(virDomainObjPtr vm, const char *resource,\n                       unsigned long long oldval, unsigned long long newval,\n                       const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s old-%s=%lld new-%s=%lld\",\n              virt, resource, reason, vmname, uuidstr,\n              resource, oldval, resource, newval);\n\n    VIR_FREE(vmname);\n}"
  },
  {
    "function_name": "virDomainAuditCgroupPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "658-687",
    "snippet": "void\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "rdev"
          ],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "detail"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "extra"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroup",
          "args": [
            "vm",
            "cgroup",
            "reason",
            "extra",
            "rc == 0"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "588-617",
          "snippet": "void\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"path %s rdev=%s acl=%s\"",
            "detail",
            "VIR_AUDIT_STR(rdev)",
            "perms"
          ],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "rdev"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"path\"",
            "path"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetRdev",
          "args": [
            "path"
          ],
          "line": 671
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetRdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "59-63",
          "snippet": "static char *\nvirDomainAuditGetRdev(const char *path G_GNUC_UNUSED)\n{\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic char *\nvirDomainAuditGetRdev(const char *path G_GNUC_UNUSED)\n{\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupPath(virDomainObjPtr vm, virCgroupPtr cgroup,\n                         const char *reason, const char *path, const char *perms,\n                         int rc)\n{\n    char *detail;\n    char *rdev;\n    char *extra = NULL;\n\n    /* Nothing to audit for regular files.  */\n    if (rc > 0)\n        return;\n\n    rdev = virDomainAuditGetRdev(path);\n\n    if (!(detail = virAuditEncode(\"path\", path))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    extra = g_strdup_printf(\"path %s rdev=%s acl=%s\",\n                            detail, VIR_AUDIT_STR(rdev), perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, rc == 0);\n\n cleanup:\n    VIR_FREE(extra);\n    VIR_FREE(detail);\n    VIR_FREE(rdev);\n}"
  },
  {
    "function_name": "virDomainAuditCgroupMajor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "631-644",
    "snippet": "void\nvirDomainAuditCgroupMajor(virDomainObjPtr vm, virCgroupPtr cgroup,\n                          const char *reason, int maj, const char *name,\n                          const char *perms, bool success)\n{\n    char *extra;\n\n    extra = g_strdup_printf(\"major category=%s maj=%02X acl=%s\",\n                            name, maj, perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, success);\n\n    VIR_FREE(extra);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "extra"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainAuditCgroup",
          "args": [
            "vm",
            "cgroup",
            "reason",
            "extra",
            "success"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditCgroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "588-617",
          "snippet": "void\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"major category=%s maj=%02X acl=%s\"",
            "name",
            "maj",
            "perms"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroupMajor(virDomainObjPtr vm, virCgroupPtr cgroup,\n                          const char *reason, int maj, const char *name,\n                          const char *perms, bool success)\n{\n    char *extra;\n\n    extra = g_strdup_printf(\"major category=%s maj=%02X acl=%s\",\n                            name, maj, perms);\n\n    virDomainAuditCgroup(vm, cgroup, reason, extra, success);\n\n    VIR_FREE(extra);\n}"
  },
  {
    "function_name": "virDomainAuditCgroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "588-617",
    "snippet": "void\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "detail"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "controller"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "detail ? detail : \"cgroup=?\"",
            "extra"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"cgroup\"",
            "VIR_AUDIT_STR(controller)"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "controller"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller)"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupPathOfController",
          "args": [
            "cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "NULL",
            "&controller"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2907-2916",
          "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditCgroup(virDomainObjPtr vm, virCgroupPtr cgroup,\n                     const char *reason, const char *extra, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *controller = NULL;\n    char *detail;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    ignore_value(virCgroupPathOfController(cgroup,\n                                           VIR_CGROUP_CONTROLLER_DEVICES,\n                                           NULL, &controller));\n    detail = virAuditEncode(\"cgroup\", VIR_AUDIT_STR(controller));\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=cgroup reason=%s %s uuid=%s %s class=%s\",\n              virt, reason, vmname, uuidstr,\n              detail ? detail : \"cgroup=?\", extra);\n\n    VIR_FREE(vmname);\n    VIR_FREE(controller);\n    VIR_FREE(detail);\n}"
  },
  {
    "function_name": "virDomainAuditTPM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "525-572",
    "snippet": "static void\nvirDomainAuditTPM(virDomainObjPtr vm, virDomainTPMDefPtr tpm,\n                  const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *path = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (tpm->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        path = tpm->data.passthrough.source.data.file.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n        path = tpm->data.emulator.source.data.nix.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm-emulator reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n    default:\n        break;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "device"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=tpm-emulator reason=%s %s uuid=%s %s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "device"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"device\"",
            "VIR_AUDIT_STR(path)"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "path"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=tpm reason=%s %s uuid=%s %s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "device"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "path"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditTPM(virDomainObjPtr vm, virDomainTPMDefPtr tpm,\n                  const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *path = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (tpm->type) {\n    case VIR_DOMAIN_TPM_TYPE_PASSTHROUGH:\n        path = tpm->data.passthrough.source.data.file.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_EMULATOR:\n        path = tpm->data.emulator.source.data.nix.path;\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(path)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=tpm-emulator reason=%s %s uuid=%s %s\",\n                  virt, reason, vmname, uuidstr, device);\n        break;\n    case VIR_DOMAIN_TPM_TYPE_LAST:\n    default:\n        break;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n}"
  },
  {
    "function_name": "virDomainAuditRedirdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "471-512",
    "snippet": "void\nvirDomainAuditRedirdev(virDomainObjPtr vm, virDomainRedirdevDefPtr redirdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (redirdev->bus) {\n    case VIR_DOMAIN_REDIRDEV_BUS_USB:\n        address = g_strdup(\"USB redirdev\");\n        break;\n    default:\n        VIR_WARN(\"Unexpected redirdev bus while encoding audit message: %d\",\n                 redirdev->bus);\n        goto cleanup;\n    }\n\n    if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n              virt, reason, vmname, uuidstr,\n              virDomainRedirdevBusTypeToString(redirdev->bus),\n              device);\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "address"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "device"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "virDomainRedirdevBusTypeToString(redirdev->bus)",
            "device"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainRedirdevBusTypeToString",
          "args": [
            "redirdev->bus"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"device\"",
            "VIR_AUDIT_STR(address)"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "address"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected redirdev bus while encoding audit message: %d\"",
            "redirdev->bus"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"USB redirdev\""
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditRedirdev(virDomainObjPtr vm, virDomainRedirdevDefPtr redirdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch (redirdev->bus) {\n    case VIR_DOMAIN_REDIRDEV_BUS_USB:\n        address = g_strdup(\"USB redirdev\");\n        break;\n    default:\n        VIR_WARN(\"Unexpected redirdev bus while encoding audit message: %d\",\n                 redirdev->bus);\n        goto cleanup;\n    }\n\n    if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n              virt, reason, vmname, uuidstr,\n              virDomainRedirdevBusTypeToString(redirdev->bus),\n              device);\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
  },
  {
    "function_name": "virDomainAuditHostdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "338-459",
    "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "address"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "device"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected hostdev mode while encoding audit message: %d\"",
            "hostdev->mode"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected hostdev type while encoding audit message: %d\"",
            "hostdev->source.caps.type"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "device"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"chardev\"",
            "VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "hostdev->source.caps.u.misc.chardev"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "device"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "hostdev->source.caps.u.storage.block"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\"",
            "virt",
            "reason",
            "vmname",
            "uuidstr",
            "virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type)",
            "device"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevSubsysTypeToString",
          "args": [
            "hostdev->source.subsys.type"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "address"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected hostdev type while encoding audit message: %d\"",
            "hostdev->source.subsys.type"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mdevsrc->uuidstr"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
  },
  {
    "function_name": "virDomainAuditNetDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "298-327",
    "snippet": "void\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "rdev"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dev_name"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vmname"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\"",
            "virt",
            "vmname",
            "uuidstr",
            "macstr",
            "dev_name",
            "VIR_AUDIT_STR(rdev)"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "rdev"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"OOM while encoding audit message\""
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "\"path\"",
            "device"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetRdev",
          "args": [
            "device"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetRdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "59-63",
          "snippet": "static char *\nvirDomainAuditGetRdev(const char *path G_GNUC_UNUSED)\n{\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic char *\nvirDomainAuditGetRdev(const char *path G_GNUC_UNUSED)\n{\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&netDef->mac",
            "macstr"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vmDef->uuid",
            "uuidstr"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vmDef"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}"
  },
  {
    "function_name": "virDomainAuditNet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "266-284",
    "snippet": "void\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditGenericDev",
          "args": [
            "vm",
            "\"net\"",
            "oldDef ? oldMacstr : NULL",
            "newDef ? newMacstr : NULL",
            "reason",
            "success"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGenericDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "82-119",
          "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&newDef->mac",
            "newMacstr"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditFS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "254-263",
    "snippet": "void\nvirDomainAuditFS(virDomainObjPtr vm,\n                 virDomainFSDefPtr oldDef, virDomainFSDefPtr newDef,\n                 const char *reason, bool success)\n{\n    virDomainAuditGenericDev(vm, \"fs\",\n                             oldDef ? oldDef->src->path : NULL,\n                             newDef ? newDef->src->path : NULL,\n                             reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditGenericDev",
          "args": [
            "vm",
            "\"fs\"",
            "oldDef ? oldDef->src->path : NULL",
            "newDef ? newDef->src->path : NULL",
            "reason",
            "success"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGenericDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "82-119",
          "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditFS(virDomainObjPtr vm,\n                 virDomainFSDefPtr oldDef, virDomainFSDefPtr newDef,\n                 const char *reason, bool success)\n{\n    virDomainAuditGenericDev(vm, \"fs\",\n                             oldDef ? oldDef->src->path : NULL,\n                             newDef ? newDef->src->path : NULL,\n                             reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditRNG",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "210-251",
    "snippet": "void\nvirDomainAuditRNG(virDomainObjPtr vm,\n                  virDomainRNGDefPtr oldDef, virDomainRNGDefPtr newDef,\n                  const char *reason, bool success)\n{\n    const char *newsrcpath = NULL;\n    const char *oldsrcpath = NULL;\n\n    if (newDef) {\n        switch ((virDomainRNGBackend) newDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            newsrcpath = newDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            newsrcpath = virDomainChrSourceDefGetPath(newDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    if (oldDef) {\n        switch ((virDomainRNGBackend) oldDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            oldsrcpath = oldDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            oldsrcpath = virDomainChrSourceDefGetPath(oldDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    virDomainAuditGenericDev(vm, \"rng\", oldsrcpath, newsrcpath, reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditGenericDev",
          "args": [
            "vm",
            "\"rng\"",
            "oldsrcpath",
            "newsrcpath",
            "reason",
            "success"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGenericDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "82-119",
          "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrSourceDefGetPath",
          "args": [
            "oldDef->source.chardev"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrSourceDefGetPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2492-2521",
          "snippet": "const char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditRNG(virDomainObjPtr vm,\n                  virDomainRNGDefPtr oldDef, virDomainRNGDefPtr newDef,\n                  const char *reason, bool success)\n{\n    const char *newsrcpath = NULL;\n    const char *oldsrcpath = NULL;\n\n    if (newDef) {\n        switch ((virDomainRNGBackend) newDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            newsrcpath = newDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            newsrcpath = virDomainChrSourceDefGetPath(newDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    if (oldDef) {\n        switch ((virDomainRNGBackend) oldDef->backend) {\n        case VIR_DOMAIN_RNG_BACKEND_RANDOM:\n            oldsrcpath = oldDef->source.file;\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_EGD:\n            oldsrcpath = virDomainChrSourceDefGetPath(oldDef->source.chardev);\n            break;\n\n        case VIR_DOMAIN_RNG_BACKEND_BUILTIN:\n        case VIR_DOMAIN_RNG_BACKEND_LAST:\n            break;\n        }\n    }\n\n    virDomainAuditGenericDev(vm, \"rng\", oldsrcpath, newsrcpath, reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "190-207",
    "snippet": "void\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditGenericDev",
          "args": [
            "vm",
            "\"disk\"",
            "oldsrc",
            "newsrc",
            "reason",
            "success"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGenericDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "82-119",
          "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsLocalStorage",
          "args": [
            "newDef"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsLocalStorage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2586-2608",
          "snippet": "bool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsLocalStorage(const virStorageSource *src)\n{\n    virStorageType type = virStorageSourceGetActualType(src);\n\n    switch (type) {\n    case VIR_STORAGE_TYPE_FILE:\n    case VIR_STORAGE_TYPE_BLOCK:\n    case VIR_STORAGE_TYPE_DIR:\n        return true;\n\n    case VIR_STORAGE_TYPE_NETWORK:\n    case VIR_STORAGE_TYPE_VOLUME:\n        /* While NVMe disks are local, they are not accessible via src->path.\n         * Therefore, we have to return false here. */\n    case VIR_STORAGE_TYPE_NVME:\n    case VIR_STORAGE_TYPE_LAST:\n    case VIR_STORAGE_TYPE_NONE:\n        return false;\n    }\n\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditSmartcard",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "145-187",
    "snippet": "static void\nvirDomainAuditSmartcard(virDomainObjPtr vm,\n                        virDomainSmartcardDefPtr def,\n                        const char *reason,\n                        bool success)\n{\n    const char *database = VIR_DOMAIN_SMARTCARD_DEFAULT_DATABASE;\n    size_t i;\n\n    if (def) {\n        switch ((virDomainSmartcardType) def->type) {\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST:\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, \"nss-smartcard-device\",\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST_CERTIFICATES:\n            for (i = 0; i < VIR_DOMAIN_SMARTCARD_NUM_CERTIFICATES; i++) {\n                virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                         def->data.cert.file[i],\n                                         reason, success);\n            }\n\n            if (def->data.cert.database)\n                database = def->data.cert.database;\n\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, database,\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_PASSTHROUGH:\n            virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                     virDomainChrSourceDefGetPath(def->data.passthru),\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_LAST:\n            break;\n        }\n    }\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditGenericDev",
          "args": [
            "vm",
            "\"smartcard\"",
            "NULL",
            "virDomainChrSourceDefGetPath(def->data.passthru)",
            "reason",
            "success"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGenericDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "82-119",
          "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrSourceDefGetPath",
          "args": [
            "def->data.passthru"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrSourceDefGetPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2492-2521",
          "snippet": "const char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditSmartcard(virDomainObjPtr vm,\n                        virDomainSmartcardDefPtr def,\n                        const char *reason,\n                        bool success)\n{\n    const char *database = VIR_DOMAIN_SMARTCARD_DEFAULT_DATABASE;\n    size_t i;\n\n    if (def) {\n        switch ((virDomainSmartcardType) def->type) {\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST:\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, \"nss-smartcard-device\",\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_HOST_CERTIFICATES:\n            for (i = 0; i < VIR_DOMAIN_SMARTCARD_NUM_CERTIFICATES; i++) {\n                virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                         def->data.cert.file[i],\n                                         reason, success);\n            }\n\n            if (def->data.cert.database)\n                database = def->data.cert.database;\n\n            virDomainAuditGenericDev(vm, \"smartcard\",\n                                     NULL, database,\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_PASSTHROUGH:\n            virDomainAuditGenericDev(vm, \"smartcard\", NULL,\n                                     virDomainChrSourceDefGetPath(def->data.passthru),\n                                     reason, success);\n            break;\n\n        case VIR_DOMAIN_SMARTCARD_TYPE_LAST:\n            break;\n        }\n    }\n}"
  },
  {
    "function_name": "virDomainAuditChardev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "122-142",
    "snippet": "void\nvirDomainAuditChardev(virDomainObjPtr vm,\n                      virDomainChrDefPtr oldDef,\n                      virDomainChrDefPtr newDef,\n                      const char *reason,\n                      bool success)\n{\n    virDomainChrSourceDefPtr oldsrc = NULL;\n    virDomainChrSourceDefPtr newsrc = NULL;\n\n    if (oldDef)\n        oldsrc = oldDef->source;\n\n    if (newDef)\n        newsrc = newDef->source;\n\n    virDomainAuditGenericDev(vm, \"chardev\",\n                             virDomainChrSourceDefGetPath(oldsrc),\n                             virDomainChrSourceDefGetPath(newsrc),\n                             reason, success);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditGenericDev",
          "args": [
            "vm",
            "\"chardev\"",
            "virDomainChrSourceDefGetPath(oldsrc)",
            "virDomainChrSourceDefGetPath(newsrc)",
            "reason",
            "success"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGenericDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "82-119",
          "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainChrSourceDefGetPath",
          "args": [
            "newsrc"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainChrSourceDefGetPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2492-2521",
          "snippet": "const char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainChrSourceDefGetPath(virDomainChrSourceDefPtr chr)\n{\n    if (!chr)\n        return NULL;\n\n    switch ((virDomainChrType) chr->type) {\n    case VIR_DOMAIN_CHR_TYPE_PTY:\n    case VIR_DOMAIN_CHR_TYPE_DEV:\n    case VIR_DOMAIN_CHR_TYPE_FILE:\n    case VIR_DOMAIN_CHR_TYPE_PIPE:\n    case VIR_DOMAIN_CHR_TYPE_NMDM:\n        return chr->data.file.path;\n\n    case VIR_DOMAIN_CHR_TYPE_UNIX:\n        return chr->data.nix.path;\n\n    case VIR_DOMAIN_CHR_TYPE_TCP:\n    case VIR_DOMAIN_CHR_TYPE_UDP:\n    case VIR_DOMAIN_CHR_TYPE_NULL:\n    case VIR_DOMAIN_CHR_TYPE_VC:\n    case VIR_DOMAIN_CHR_TYPE_STDIO:\n    case VIR_DOMAIN_CHR_TYPE_SPICEVMC:\n    case VIR_DOMAIN_CHR_TYPE_SPICEPORT:\n    case VIR_DOMAIN_CHR_TYPE_LAST:\n        return NULL;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditChardev(virDomainObjPtr vm,\n                      virDomainChrDefPtr oldDef,\n                      virDomainChrDefPtr newDef,\n                      const char *reason,\n                      bool success)\n{\n    virDomainChrSourceDefPtr oldsrc = NULL;\n    virDomainChrSourceDefPtr newsrc = NULL;\n\n    if (oldDef)\n        oldsrc = oldDef->source;\n\n    if (newDef)\n        newsrc = newDef->source;\n\n    virDomainAuditGenericDev(vm, \"chardev\",\n                             virDomainChrSourceDefGetPath(oldsrc),\n                             virDomainChrSourceDefGetPath(newsrc),\n                             reason, success);\n}"
  },
  {
    "function_name": "virDomainAuditGenericDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "82-119",
    "snippet": "static void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_AUDIT",
          "args": [
            "VIR_AUDIT_RECORD_RESOURCE",
            "success",
            "\"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\"",
            "virt",
            "type",
            "reason",
            "vmname",
            "uuidstr",
            "oldsrc",
            "newsrc"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virAuditEncode",
          "args": [
            "olddev",
            "VIR_AUDIT_STR(oldsrcpath)"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virAuditEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viraudit.c",
          "lines": "138-147",
          "snippet": "char *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viraudit.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <libaudit.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viraudit.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <libaudit.h>\n#include <config.h>\n\nchar *virAuditEncode(const char *key, const char *value)\n{\n#if WITH_AUDIT\n    return audit_encode_nv_string(key, value, 0);\n#else\n    char *str;\n    str = g_strdup_printf(\"%s=%s\", key, value);\n    return str;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "oldsrcpath"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_AUDIT_STR",
          "args": [
            "newsrcpath"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "vm->def->uuid",
            "uuidstr"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"old-%s\"",
            "type"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditGetVirtType",
          "args": [
            "vm->def"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditGetVirtType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "67-79",
          "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic void\nvirDomainAuditGenericDev(virDomainObjPtr vm,\n                         const char *type,\n                         const char *oldsrcpath,\n                         const char *newsrcpath,\n                         const char *reason,\n                         bool success)\n{\n    g_autofree char *newdev = NULL;\n    g_autofree char *olddev = NULL;\n    g_autofree char *vmname = NULL;\n    g_autofree char *oldsrc = NULL;\n    g_autofree char *newsrc = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    /* if both new and old source aren't provided don't log anything */\n    if (!newsrcpath && !oldsrcpath)\n        return;\n\n    newdev = g_strdup_printf(\"new-%s\", type);\n    olddev = g_strdup_printf(\"old-%s\", type);\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name)))\n        return;\n\n    if (!(newsrc = virAuditEncode(newdev, VIR_AUDIT_STR(newsrcpath))))\n        return;\n\n    if (!(oldsrc = virAuditEncode(olddev, VIR_AUDIT_STR(oldsrcpath))))\n        return;\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=%s reason=%s %s uuid=%s %s %s\",\n              virt, type, reason, vmname, uuidstr, oldsrc, newsrc);\n}"
  },
  {
    "function_name": "virDomainAuditGetVirtType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "67-79",
    "snippet": "static const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected virt type %d while encoding audit message\"",
            "def->virtType"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainVirtTypeToString",
          "args": [
            "def->virtType"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic const char *\nvirDomainAuditGetVirtType(virDomainDefPtr def)\n{\n    const char *virt;\n\n    if (!(virt = virDomainVirtTypeToString(def->virtType))) {\n        VIR_WARN(\"Unexpected virt type %d while encoding audit message\",\n                 def->virtType);\n        virt = \"?\";\n    }\n\n    return virt;\n}"
  },
  {
    "function_name": "virDomainAuditGetRdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "59-63",
    "snippet": "static char *\nvirDomainAuditGetRdev(const char *path G_GNUC_UNUSED)\n{\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic char *\nvirDomainAuditGetRdev(const char *path G_GNUC_UNUSED)\n{\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainAuditGetRdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
    "lines": "44-57",
    "snippet": "static char *\nvirDomainAuditGetRdev(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) == 0 &&\n        (S_ISCHR(sb.st_mode) || S_ISBLK(sb.st_mode))) {\n        int maj = major(sb.st_rdev);\n        int min = minor(sb.st_rdev);\n        ret = g_strdup_printf(\"%02X:%02X\", maj, min);\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"virlog.h\"",
      "#include \"viruuid.h\"",
      "#include \"viraudit.h\"",
      "#include \"domain_audit.h\"",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%02X:%02X\"",
            "maj",
            "min"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nstatic char *\nvirDomainAuditGetRdev(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) == 0 &&\n        (S_ISCHR(sb.st_mode) || S_ISBLK(sb.st_mode))) {\n        int maj = major(sb.st_rdev);\n        int min = minor(sb.st_rdev);\n        ret = g_strdup_printf(\"%02X:%02X\", maj, min);\n    }\n    return ret;\n}"
  }
]