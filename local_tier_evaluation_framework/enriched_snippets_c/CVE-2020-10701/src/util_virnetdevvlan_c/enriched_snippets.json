[
  {
    "function_name": "virNetDevVlanCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvlan.c",
    "lines": "80-95",
    "snippet": "int\nvirNetDevVlanCopy(virNetDevVlanPtr dst, const virNetDevVlan *src)\n{\n    if (!src || src->nTags == 0)\n        return 0;\n\n    if (VIR_ALLOC_N(dst->tag, src->nTags) < 0)\n        return -1;\n\n    dst->trunk = src->trunk;\n    dst->nTags = src->nTags;\n    dst->nativeMode = src->nativeMode;\n    dst->nativeTag = src->nativeTag;\n    memcpy(dst->tag, src->tag, src->nTags * sizeof(*src->tag));\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virnetdevvlan.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst->tag",
            "src->tag",
            "src->nTags * sizeof(*src->tag)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "dst->tag",
            "src->nTags"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virnetdevvlan.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNetDevVlanCopy(virNetDevVlanPtr dst, const virNetDevVlan *src)\n{\n    if (!src || src->nTags == 0)\n        return 0;\n\n    if (VIR_ALLOC_N(dst->tag, src->nTags) < 0)\n        return -1;\n\n    dst->trunk = src->trunk;\n    dst->nTags = src->nTags;\n    dst->nativeMode = src->nativeMode;\n    dst->nativeTag = src->nativeTag;\n    memcpy(dst->tag, src->tag, src->nTags * sizeof(*src->tag));\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevVlanEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvlan.c",
    "lines": "45-73",
    "snippet": "int\nvirNetDevVlanEqual(const virNetDevVlan *a, const virNetDevVlan *b)\n{\n    int ai, bi;\n\n    if (!(a || b))\n        return true;\n    if (!a || !b)\n        return false;\n\n    if (a->trunk != b->trunk ||\n        a->nTags != b->nTags ||\n        a->nativeMode != b->nativeMode ||\n        a->nativeTag != b->nativeTag) {\n        return false;\n    }\n\n    for (ai = 0; ai < a->nTags; ai++) {\n        for (bi = 0; bi < b->nTags; bi++) {\n            if (a->tag[ai] == b->tag[bi])\n                break;\n        }\n        if (bi >= b->nTags) {\n            /* no matches for a->tag[ai] anywhere in b->tag */\n            return false;\n        }\n    }\n    return true;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virnetdevvlan.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virnetdevvlan.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNetDevVlanEqual(const virNetDevVlan *a, const virNetDevVlan *b)\n{\n    int ai, bi;\n\n    if (!(a || b))\n        return true;\n    if (!a || !b)\n        return false;\n\n    if (a->trunk != b->trunk ||\n        a->nTags != b->nTags ||\n        a->nativeMode != b->nativeMode ||\n        a->nativeTag != b->nativeTag) {\n        return false;\n    }\n\n    for (ai = 0; ai < a->nTags; ai++) {\n        for (bi = 0; bi < b->nTags; bi++) {\n            if (a->tag[ai] == b->tag[bi])\n                break;\n        }\n        if (bi >= b->nTags) {\n            /* no matches for a->tag[ai] anywhere in b->tag */\n            return false;\n        }\n    }\n    return true;\n}"
  },
  {
    "function_name": "virNetDevVlanFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvlan.c",
    "lines": "37-43",
    "snippet": "void\nvirNetDevVlanFree(virNetDevVlanPtr vlan)\n{\n    if (vlan)\n        virNetDevVlanClear(vlan);\n    VIR_FREE(vlan);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virnetdevvlan.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vlan"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevVlanClear",
          "args": [
            "vlan"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVlanClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvlan.c",
          "lines": "28-35",
          "snippet": "void\nvirNetDevVlanClear(virNetDevVlanPtr vlan)\n{\n    VIR_FREE(vlan->tag);\n    vlan->nTags = 0;\n    vlan->nativeMode = 0;\n    vlan->nativeTag = 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virnetdevvlan.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNetDevVlanClear(virNetDevVlanPtr vlan)\n{\n    VIR_FREE(vlan->tag);\n    vlan->nTags = 0;\n    vlan->nativeMode = 0;\n    vlan->nativeTag = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virnetdevvlan.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNetDevVlanFree(virNetDevVlanPtr vlan)\n{\n    if (vlan)\n        virNetDevVlanClear(vlan);\n    VIR_FREE(vlan);\n}"
  },
  {
    "function_name": "virNetDevVlanClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevvlan.c",
    "lines": "28-35",
    "snippet": "void\nvirNetDevVlanClear(virNetDevVlanPtr vlan)\n{\n    VIR_FREE(vlan->tag);\n    vlan->nTags = 0;\n    vlan->nativeMode = 0;\n    vlan->nativeTag = 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virnetdevvlan.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vlan->tag"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virnetdevvlan.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNetDevVlanClear(virNetDevVlanPtr vlan)\n{\n    VIR_FREE(vlan->tag);\n    vlan->nTags = 0;\n    vlan->nativeMode = 0;\n    vlan->nativeTag = 0;\n}"
  }
]