[
  {
    "function_name": "virNetworkPortRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1714-1726",
    "snippet": "int\nvirNetworkPortRef(virNetworkPortPtr port)\n{\n    VIR_DEBUG(\"port=%p refs=%d\", port,\n              port ? port->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n\n    virObjectRef(port);\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "port"
          ],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1720
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p refs=%d\"",
            "port",
            "port ? port->parent.u.s.refs : 0"
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortRef(virNetworkPortPtr port)\n{\n    VIR_DEBUG(\"port=%p refs=%d\", port,\n              port ? port->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n\n    virObjectRef(port);\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkPortFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1683-1694",
    "snippet": "int\nvirNetworkPortFree(virNetworkPortPtr port)\n{\n    VIR_DEBUG(\"port=%p\", port);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n\n    virObjectUnref(port);\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "port"
          ],
          "line": 1692
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1688
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p\"",
            "port"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortFree(virNetworkPortPtr port)\n{\n    VIR_DEBUG(\"port=%p\", port);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n\n    virObjectUnref(port);\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkListAllPorts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1646-1671",
    "snippet": "int\nvirNetworkListAllPorts(virNetworkPtr network,\n                       virNetworkPortPtr **ports,\n                       unsigned int flags)\n{\n    VIR_DEBUG(\"network=%p, ports=%p, flags=0x%x\", network, ports, flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n\n    if (network->conn->networkDriver &&\n        network->conn->networkDriver->networkListAllPorts) {\n        int ret;\n        ret = network->conn->networkDriver->networkListAllPorts(network, ports, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "network->conn->networkDriver->networkListAllPorts",
          "args": [
            "network",
            "ports",
            "flags"
          ],
          "line": 1660
        },
        "resolved": true,
        "details": {
          "function_name": "networkListAllPorts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5768-5800",
          "snippet": "static int\nnetworkListAllPorts(virNetworkPtr net,\n                    virNetworkPortPtr **ports,\n                    unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkListAllPortsEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    ret = virNetworkObjPortListExport(net, obj, ports,\n                                      virNetworkListAllPortsCheckACL);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic int\nnetworkListAllPorts(virNetworkPtr net,\n                    virNetworkPortPtr **ports,\n                    unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkListAllPortsEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    ret = virNetworkObjPortListExport(net, obj, ports,\n                                      virNetworkListAllPortsCheckACL);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 1655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1653
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, ports=%p, flags=0x%x\"",
            "network",
            "ports",
            "flags"
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkListAllPorts(virNetworkPtr network,\n                       virNetworkPortPtr **ports,\n                       unsigned int flags)\n{\n    VIR_DEBUG(\"network=%p, ports=%p, flags=0x%x\", network, ports, flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n\n    if (network->conn->networkDriver &&\n        network->conn->networkDriver->networkListAllPorts) {\n        int ret;\n        ret = network->conn->networkDriver->networkListAllPorts(network, ports, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkPortDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1598-1625",
    "snippet": "int\nvirNetworkPortDelete(virNetworkPortPtr port,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, flags=0x%x\", port, flags);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    conn = port->net->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkPortDelete) {\n        int ret;\n        ret = conn->networkDriver->networkPortDelete(port, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkPortDelete",
          "args": [
            "port",
            "flags"
          ],
          "line": 1614
        },
        "resolved": true,
        "details": {
          "function_name": "networkPortDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5561-5600",
          "snippet": "static int\nnetworkPortDelete(virNetworkPortPtr port,\n                  unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortDeleteEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (networkReleasePort(obj, portdef) < 0)\n        goto cleanup;\n\n    virNetworkObjDeletePort(obj, port->uuid, driver->stateDir);\n\n    ret = 0;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);",
            "static int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\nstatic int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);\n\nstatic int\nnetworkPortDelete(virNetworkPortPtr port,\n                  unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortDeleteEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (networkReleasePort(obj, portdef) < 0)\n        goto cleanup;\n\n    virNetworkObjDeletePort(obj, port->uuid, driver->stateDir);\n\n    ret = 0;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1605
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p, flags=0x%x\"",
            "port",
            "flags"
          ],
          "line": 1603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortDelete(virNetworkPortPtr port,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, flags=0x%x\", port, flags);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    conn = port->net->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkPortDelete) {\n        int ret;\n        ret = conn->networkDriver->networkPortDelete(port, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkPortGetUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1566-1583",
    "snippet": "int\nvirNetworkPortGetUUIDString(virNetworkPortPtr port,\n                            char *buf)\n{\n    VIR_DEBUG(\"port=%p, buf=%p\", port, buf);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(port->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(port->net->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "port->net->conn"
          ],
          "line": 1581
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "port->uuid",
            "buf"
          ],
          "line": 1577
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buf",
            "error"
          ],
          "line": 1575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p, buf=%p\"",
            "port",
            "buf"
          ],
          "line": 1570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortGetUUIDString(virNetworkPortPtr port,\n                            char *buf)\n{\n    VIR_DEBUG(\"port=%p, buf=%p\", port, buf);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(port->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(port->net->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkPortGetUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1535-1553",
    "snippet": "int\nvirNetworkPortGetUUID(virNetworkPortPtr port,\n                      unsigned char *uuid)\n{\n    VIR_DEBUG(\"port=%p, uuid=%p\", port, uuid);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &port->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(port->net->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "port->net->conn"
          ],
          "line": 1551
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "uuid",
            "&port->uuid[0]",
            "VIR_UUID_BUFLEN"
          ],
          "line": 1546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 1544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1541
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p, uuid=%p\"",
            "port",
            "uuid"
          ],
          "line": 1539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortGetUUID(virNetworkPortPtr port,\n                      unsigned char *uuid)\n{\n    VIR_DEBUG(\"port=%p, uuid=%p\", port, uuid);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &port->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(port->net->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkPortGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1498-1523",
    "snippet": "char *\nvirNetworkPortGetXMLDesc(virNetworkPortPtr port,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, flags=0x%x\", port, flags);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, NULL);\n    conn = port->net->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkPortGetXMLDesc) {\n        char *ret;\n        ret = conn->networkDriver->networkPortGetXMLDesc(port, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkPortGetXMLDesc",
          "args": [
            "port",
            "flags"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "networkPortGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5523-5558",
          "snippet": "static char *\nnetworkPortGetXMLDesc(virNetworkPortPtr port,\n                      unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef = NULL;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortGetXMLDescEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n   if (!(ret = virNetworkPortDefFormat(portdef)))\n       goto cleanup;\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);\n\nstatic char *\nnetworkPortGetXMLDesc(virNetworkPortPtr port,\n                      unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef = NULL;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortGetXMLDescEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n   if (!(ret = virNetworkPortDefFormat(portdef)))\n       goto cleanup;\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "NULL"
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1505
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p, flags=0x%x\"",
            "port",
            "flags"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirNetworkPortGetXMLDesc(virNetworkPortPtr port,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, flags=0x%x\", port, flags);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, NULL);\n    conn = port->net->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkPortGetXMLDesc) {\n        char *ret;\n        ret = conn->networkDriver->networkPortGetXMLDesc(port, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkPortGetNetwork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1474-1484",
    "snippet": "virNetworkPtr\nvirNetworkPortGetNetwork(virNetworkPortPtr port)\n{\n    VIR_DEBUG(\"port=%p\", port);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, NULL);\n\n    return port->net;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "NULL"
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1479
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p\"",
            "port"
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkPortGetNetwork(virNetworkPortPtr port)\n{\n    VIR_DEBUG(\"port=%p\", port);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, NULL);\n\n    return port->net;\n}"
  },
  {
    "function_name": "virNetworkPortCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1436-1462",
    "snippet": "virNetworkPortPtr\nvirNetworkPortCreateXML(virNetworkPtr net,\n                        const char *xmldesc,\n                        unsigned int flags)\n{\n    VIR_DEBUG(\"net=%p, xmldesc=%s, flags=0x%x\", net, NULLSTR(xmldesc), flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(xmldesc, error);\n    virCheckReadOnlyGoto(net->conn->flags, error);\n\n    if (net->conn->networkDriver && net->conn->networkDriver->networkPortCreateXML) {\n        virNetworkPortPtr ret;\n        ret = net->conn->networkDriver->networkPortCreateXML(net, xmldesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "net->conn"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net->conn->networkDriver->networkPortCreateXML",
          "args": [
            "net",
            "xmldesc",
            "flags"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "networkPortCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5452-5520",
          "snippet": "static virNetworkPortPtr\nnetworkPortCreateXML(virNetworkPtr net,\n                     const char *xmldesc,\n                     unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    g_autoptr(virNetworkPortDef) portdef = NULL;\n    virNetworkPortPtr ret = NULL;\n    int rc;\n\n    virCheckFlags(VIR_NETWORK_PORT_CREATE_RECLAIM, NULL);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkPortDefParseString(xmldesc)))\n        goto cleanup;\n\n    if (virNetworkPortCreateXMLEnsureACL(net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (portdef->plugtype == VIR_NETWORK_PORT_PLUG_TYPE_NONE) {\n        if (flags & VIR_NETWORK_PORT_CREATE_RECLAIM) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Port reclaim requested but plug type is none\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(flags & VIR_NETWORK_PORT_CREATE_RECLAIM)) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Port reclaim not requested but plug type is not none\"));\n            goto cleanup;\n        }\n    }\n\n    if (flags & VIR_NETWORK_PORT_CREATE_RECLAIM)\n        rc = networkNotifyPort(obj, portdef);\n    else\n        rc = networkAllocatePort(obj, portdef);\n    if (rc < 0)\n        goto cleanup;\n\n    if (virNetworkObjAddPort(obj, portdef, driver->stateDir) < 0) {\n        virErrorPtr save_err;\n\n        virErrorPreserveLast(&save_err);\n        ignore_value(networkReleasePort(obj, portdef));\n        virErrorRestore(&save_err);\n\n        goto cleanup;\n    }\n\n    ret = virGetNetworkPort(net, portdef->uuid);\n    portdef = NULL;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic virNetworkPortPtr\nnetworkPortCreateXML(virNetworkPtr net,\n                     const char *xmldesc,\n                     unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    g_autoptr(virNetworkPortDef) portdef = NULL;\n    virNetworkPortPtr ret = NULL;\n    int rc;\n\n    virCheckFlags(VIR_NETWORK_PORT_CREATE_RECLAIM, NULL);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkPortDefParseString(xmldesc)))\n        goto cleanup;\n\n    if (virNetworkPortCreateXMLEnsureACL(net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (portdef->plugtype == VIR_NETWORK_PORT_PLUG_TYPE_NONE) {\n        if (flags & VIR_NETWORK_PORT_CREATE_RECLAIM) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Port reclaim requested but plug type is none\"));\n            goto cleanup;\n        }\n    } else {\n        if (!(flags & VIR_NETWORK_PORT_CREATE_RECLAIM)) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"Port reclaim not requested but plug type is not none\"));\n            goto cleanup;\n        }\n    }\n\n    if (flags & VIR_NETWORK_PORT_CREATE_RECLAIM)\n        rc = networkNotifyPort(obj, portdef);\n    else\n        rc = networkAllocatePort(obj, portdef);\n    if (rc < 0)\n        goto cleanup;\n\n    if (virNetworkObjAddPort(obj, portdef, driver->stateDir) < 0) {\n        virErrorPtr save_err;\n\n        virErrorPreserveLast(&save_err);\n        ignore_value(networkReleasePort(obj, portdef));\n        virErrorRestore(&save_err);\n\n        goto cleanup;\n    }\n\n    ret = virGetNetworkPort(net, portdef->uuid);\n    portdef = NULL;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "net->conn->flags",
            "error"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmldesc",
            "error"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "net",
            "NULL"
          ],
          "line": 1445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"net=%p, xmldesc=%s, flags=0x%x\"",
            "net",
            "NULLSTR(xmldesc)",
            "flags"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmldesc"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPortPtr\nvirNetworkPortCreateXML(virNetworkPtr net,\n                        const char *xmldesc,\n                        unsigned int flags)\n{\n    VIR_DEBUG(\"net=%p, xmldesc=%s, flags=0x%x\", net, NULLSTR(xmldesc), flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(xmldesc, error);\n    virCheckReadOnlyGoto(net->conn->flags, error);\n\n    if (net->conn->networkDriver && net->conn->networkDriver->networkPortCreateXML) {\n        virNetworkPortPtr ret;\n        ret = net->conn->networkDriver->networkPortCreateXML(net, xmldesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkPortGetParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1392-1419",
    "snippet": "int\nvirNetworkPortGetParameters(virNetworkPortPtr port,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, params=%p, nparams=%p, flags=0x%x\", port, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    conn = port->net->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkPortGetParameters) {\n        int ret;\n        ret = conn->networkDriver->networkPortGetParameters(port, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1417
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkPortGetParameters",
          "args": [
            "port",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1408
        },
        "resolved": true,
        "details": {
          "function_name": "networkPortGetParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5697-5765",
          "snippet": "static int\nnetworkPortGetParameters(virNetworkPortPtr port,\n                         virTypedParameterPtr *params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef;\n    int maxparams = 0;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    *params = NULL;\n    *nparams = 0;\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortGetParametersEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (portdef->bandwidth) {\n        if ((portdef->bandwidth->in != NULL) &&\n            (virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_AVERAGE,\n                                   portdef->bandwidth->in->average) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_PEAK,\n                                   portdef->bandwidth->in->peak) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_FLOOR,\n                                   portdef->bandwidth->in->floor) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_BURST,\n                                   portdef->bandwidth->in->burst) < 0))\n            goto cleanup;\n\n        if ((portdef->bandwidth->out != NULL) &&\n            (virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_OUT_AVERAGE,\n                                   portdef->bandwidth->out->average) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_OUT_PEAK,\n                                   portdef->bandwidth->out->peak) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_OUT_BURST,\n                                   portdef->bandwidth->out->burst) < 0))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);\n\nstatic int\nnetworkPortGetParameters(virNetworkPortPtr port,\n                         virTypedParameterPtr *params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef;\n    int maxparams = 0;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    *params = NULL;\n    *nparams = 0;\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortGetParametersEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (portdef->bandwidth) {\n        if ((portdef->bandwidth->in != NULL) &&\n            (virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_AVERAGE,\n                                   portdef->bandwidth->in->average) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_PEAK,\n                                   portdef->bandwidth->in->peak) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_FLOOR,\n                                   portdef->bandwidth->in->floor) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_IN_BURST,\n                                   portdef->bandwidth->in->burst) < 0))\n            goto cleanup;\n\n        if ((portdef->bandwidth->out != NULL) &&\n            (virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_OUT_AVERAGE,\n                                   portdef->bandwidth->out->average) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_OUT_PEAK,\n                                   portdef->bandwidth->out->peak) < 0 ||\n             virTypedParamsAddUInt(params, nparams, &maxparams,\n                                   VIR_NETWORK_PORT_BANDWIDTH_OUT_BURST,\n                                   portdef->bandwidth->out->burst) < 0))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1401
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p, params=%p, nparams=%p, flags=0x%x\"",
            "port",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortGetParameters(virNetworkPortPtr port,\n                            virTypedParameterPtr *params,\n                            int *nparams,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, params=%p, nparams=%p, flags=0x%x\", port, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    conn = port->net->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkPortGetParameters) {\n        int ret;\n        ret = conn->networkDriver->networkPortGetParameters(port, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkPortSetParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1344-1374",
    "snippet": "int\nvirNetworkPortSetParameters(virNetworkPortPtr port,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, params=%p, nparams=%d, flags=0x%x\", port, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    conn = port->net->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkPortSetParameters) {\n        int ret;\n        ret = conn->networkDriver->networkPortSetParameters(port, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1372
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkPortSetParameters",
          "args": [
            "port",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1363
        },
        "resolved": true,
        "details": {
          "function_name": "networkPortSetParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5603-5694",
          "snippet": "static int\nnetworkPortSetParameters(virNetworkPortPtr port,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef;\n    virNetDevBandwidthPtr bandwidth = NULL;\n    char *dir = NULL;\n    int ret = -1;\n    size_t i;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortSetParametersEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(dir = virNetworkObjGetPortStatusDir(obj, driver->stateDir)))\n        goto cleanup;\n\n    if ((VIR_ALLOC(bandwidth) < 0) ||\n        (VIR_ALLOC(bandwidth->in) < 0) ||\n        (VIR_ALLOC(bandwidth->out) < 0))\n        goto cleanup;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_AVERAGE)) {\n            bandwidth->in->average = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_PEAK)) {\n            bandwidth->in->peak = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_BURST)) {\n            bandwidth->in->burst = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_FLOOR)) {\n            bandwidth->in->floor = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_OUT_AVERAGE)) {\n            bandwidth->out->average = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_OUT_PEAK)) {\n            bandwidth->out->peak = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_OUT_BURST)) {\n            bandwidth->out->burst = param->value.ui;\n        }\n    }\n\n    /* average or floor are mandatory, peak and burst are optional.\n     * So if no average or floor is given, we free inbound/outbound\n     * here which causes inbound/outbound to not be set. */\n    if (!bandwidth->in->average && !bandwidth->in->floor)\n        VIR_FREE(bandwidth->in);\n    if (!bandwidth->out->average)\n        VIR_FREE(bandwidth->out);\n\n    if (networkUpdatePortBandwidth(obj,\n                                   &portdef->mac,\n                                   &portdef->class_id,\n                                   portdef->bandwidth,\n                                   bandwidth) < 0)\n        goto cleanup;\n\n    virNetDevBandwidthFree(portdef->bandwidth);\n    portdef->bandwidth = bandwidth;\n    bandwidth = NULL;\n\n    if (virNetworkPortDefSaveStatus(portdef, dir) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNetDevBandwidthFree(bandwidth);\n    virNetworkObjEndAPI(&obj);\n    VIR_FREE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);",
            "static int\nnetworkPlugBandwidth(virNetworkObjPtr obj,\n                     virMacAddrPtr mac,\n                     virNetDevBandwidthPtr ifaceBand,\n                     unsigned int *class_id);",
            "static int\nnetworkUnplugBandwidth(virNetworkObjPtr obj,\n                       virNetDevBandwidthPtr ifaceBand,\n                       unsigned int *class_id);",
            "static int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\nstatic int\nnetworkPlugBandwidth(virNetworkObjPtr obj,\n                     virMacAddrPtr mac,\n                     virNetDevBandwidthPtr ifaceBand,\n                     unsigned int *class_id);\nstatic int\nnetworkUnplugBandwidth(virNetworkObjPtr obj,\n                       virNetDevBandwidthPtr ifaceBand,\n                       unsigned int *class_id);\nstatic int\nnetworkNotifyPort(virNetworkObjPtr obj,\n                  virNetworkPortDefPtr port);\n\nstatic int\nnetworkPortSetParameters(virNetworkPortPtr port,\n                         virTypedParameterPtr params,\n                         int nparams,\n                         unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef;\n    virNetDevBandwidthPtr bandwidth = NULL;\n    char *dir = NULL;\n    int ret = -1;\n    size_t i;\n\n    virCheckFlags(0, -1);\n\n    if (!(obj = networkObjFromNetwork(port->net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, port->uuid)))\n        goto cleanup;\n\n    if (virNetworkPortSetParametersEnsureACL(port->net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if (!(dir = virNetworkObjGetPortStatusDir(obj, driver->stateDir)))\n        goto cleanup;\n\n    if ((VIR_ALLOC(bandwidth) < 0) ||\n        (VIR_ALLOC(bandwidth->in) < 0) ||\n        (VIR_ALLOC(bandwidth->out) < 0))\n        goto cleanup;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_AVERAGE)) {\n            bandwidth->in->average = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_PEAK)) {\n            bandwidth->in->peak = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_BURST)) {\n            bandwidth->in->burst = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_IN_FLOOR)) {\n            bandwidth->in->floor = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_OUT_AVERAGE)) {\n            bandwidth->out->average = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_OUT_PEAK)) {\n            bandwidth->out->peak = param->value.ui;\n        } else if (STREQ(param->field, VIR_NETWORK_PORT_BANDWIDTH_OUT_BURST)) {\n            bandwidth->out->burst = param->value.ui;\n        }\n    }\n\n    /* average or floor are mandatory, peak and burst are optional.\n     * So if no average or floor is given, we free inbound/outbound\n     * here which causes inbound/outbound to not be set. */\n    if (!bandwidth->in->average && !bandwidth->in->floor)\n        VIR_FREE(bandwidth->in);\n    if (!bandwidth->out->average)\n        VIR_FREE(bandwidth->out);\n\n    if (networkUpdatePortBandwidth(obj,\n                                   &portdef->mac,\n                                   &portdef->class_id,\n                                   portdef->bandwidth,\n                                   bandwidth) < 0)\n        goto cleanup;\n\n    virNetDevBandwidthFree(portdef->bandwidth);\n    portdef->bandwidth = bandwidth;\n    bandwidth = NULL;\n\n    if (virNetworkPortDefSaveStatus(portdef, dir) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNetDevBandwidthFree(bandwidth);\n    virNetworkObjEndAPI(&obj);\n    VIR_FREE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkPortReturn",
          "args": [
            "port",
            "-1"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1354
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"port=%p, params=%p, nparams=%d, flags=0x%x\"",
            "port",
            "params",
            "nparams",
            "flags"
          ],
          "line": 1351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkPortSetParameters(virNetworkPortPtr port,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"port=%p, params=%p, nparams=%d, flags=0x%x\", port, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckNetworkPortReturn(port, -1);\n    conn = port->net->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkPortSetParameters) {\n        int ret;\n        ret = conn->networkDriver->networkPortSetParameters(port, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkPortLookupByUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1304-1328",
    "snippet": "virNetworkPortPtr\nvirNetworkPortLookupByUUIDString(virNetworkPtr net,\n                                 const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"net=%p, uuidstr=%s\", net, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNetworkPortLookupByUUID(net, &uuid[0]);\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "net->conn"
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkPortLookupByUUID",
          "args": [
            "net",
            "&uuid[0]"
          ],
          "line": 1323
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkPortLookupByUUIDString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
          "lines": "1304-1328",
          "snippet": "virNetworkPortPtr\nvirNetworkPortLookupByUUIDString(virNetworkPtr net,\n                                 const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"net=%p, uuidstr=%s\", net, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNetworkPortLookupByUUID(net, &uuid[0]);\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "uuidstr",
            "_(\"uuidstr in %s must be a valid UUID\")",
            "__FUNCTION__"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"uuidstr in %s must be a valid UUID\""
          ],
          "line": 1318
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuidstr",
            "uuid"
          ],
          "line": 1316
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuidstr",
            "error"
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "net",
            "NULL"
          ],
          "line": 1313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1311
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"net=%p, uuidstr=%s\"",
            "net",
            "NULLSTR(uuidstr)"
          ],
          "line": 1309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uuidstr"
          ],
          "line": 1309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPortPtr\nvirNetworkPortLookupByUUIDString(virNetworkPtr net,\n                                 const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"net=%p, uuidstr=%s\", net, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNetworkPortLookupByUUID(net, &uuid[0]);\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkPortLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1267-1291",
    "snippet": "virNetworkPortPtr\nvirNetworkPortLookupByUUID(virNetworkPtr net,\n                           const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(net, uuid);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (net->conn->networkDriver && net->conn->networkDriver->networkPortLookupByUUID) {\n        virNetworkPortPtr ret;\n        ret = net->conn->networkDriver->networkPortLookupByUUID(net, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "net->conn"
          ],
          "line": 1289
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net->conn->networkDriver->networkPortLookupByUUID",
          "args": [
            "net",
            "uuid"
          ],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "networkPortLookupByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "5415-5449",
          "snippet": "static virNetworkPortPtr\nnetworkPortLookupByUUID(virNetworkPtr net,\n                        const unsigned char *uuid)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef = NULL;\n    virNetworkPortPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virUUIDFormat(uuid, uuidstr);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, uuid)))\n        goto cleanup;\n\n    if (virNetworkPortLookupByUUIDEnsureACL(net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    ret = virGetNetworkPort(net, uuid);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic virNetworkPortPtr\nnetworkPortLookupByUUID(virNetworkPtr net,\n                        const unsigned char *uuid)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPortDefPtr portdef = NULL;\n    virNetworkPortPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virUUIDFormat(uuid, uuidstr);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    def = virNetworkObjGetDef(obj);\n\n    if (!(portdef = virNetworkObjLookupPort(obj, uuid)))\n        goto cleanup;\n\n    if (virNetworkPortLookupByUUIDEnsureACL(net->conn, def, portdef) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    ret = virGetNetworkPort(net, uuid);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "net",
            "NULL"
          ],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_UUID_DEBUG",
          "args": [
            "net",
            "uuid"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPortPtr\nvirNetworkPortLookupByUUID(virNetworkPtr net,\n                           const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(net, uuid);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (net->conn->networkDriver && net->conn->networkDriver->networkPortLookupByUUID) {\n        virNetworkPortPtr ret;\n        ret = net->conn->networkDriver->networkPortLookupByUUID(net, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(net->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkDHCPLeaseFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1239-1251",
    "snippet": "void\nvirNetworkDHCPLeaseFree(virNetworkDHCPLeasePtr lease)\n{\n    if (!lease)\n        return;\n    VIR_FREE(lease->iface);\n    VIR_FREE(lease->mac);\n    VIR_FREE(lease->iaid);\n    VIR_FREE(lease->ipaddr);\n    VIR_FREE(lease->hostname);\n    VIR_FREE(lease->clientid);\n    VIR_FREE(lease);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease"
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease->clientid"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease->hostname"
          ],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease->ipaddr"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease->iaid"
          ],
          "line": 1246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease->mac"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lease->iface"
          ],
          "line": 1244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNetworkDHCPLeaseFree(virNetworkDHCPLeasePtr lease)\n{\n    if (!lease)\n        return;\n    VIR_FREE(lease->iface);\n    VIR_FREE(lease->mac);\n    VIR_FREE(lease->iaid);\n    VIR_FREE(lease->ipaddr);\n    VIR_FREE(lease->hostname);\n    VIR_FREE(lease->clientid);\n    VIR_FREE(lease);\n}"
  },
  {
    "function_name": "virNetworkGetDHCPLeases",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1198-1230",
    "snippet": "int\nvirNetworkGetDHCPLeases(virNetworkPtr network,\n                        const char *mac,\n                        virNetworkDHCPLeasePtr **leases,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, mac='%s' leases=%p, flags=0x%x\",\n               network, NULLSTR(mac), leases, flags);\n\n    virResetLastError();\n\n    if (leases)\n        *leases = NULL;\n\n    virCheckNetworkReturn(network, -1);\n\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetDHCPLeases) {\n        int ret;\n        ret = conn->networkDriver->networkGetDHCPLeases(network, mac, leases, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 1228
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkGetDHCPLeases",
          "args": [
            "network",
            "mac",
            "leases",
            "flags"
          ],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "networkGetDHCPLeases",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4240-4431",
          "snippet": "static int\nnetworkGetDHCPLeases(virNetworkPtr net,\n                     const char *mac,\n                     virNetworkDHCPLeasePtr **leases,\n                     unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    size_t i, j;\n    size_t nleases = 0;\n    int rv = -1;\n    size_t size = 0;\n    int custom_lease_file_len = 0;\n    bool need_results = !!leases;\n    long long currtime = 0;\n    long long expirytime_tmp = -1;\n    bool ipv6 = false;\n    char *lease_entries = NULL;\n    char *custom_lease_file = NULL;\n    const char *ip_tmp = NULL;\n    const char *mac_tmp = NULL;\n    virJSONValuePtr lease_tmp = NULL;\n    virJSONValuePtr leases_array = NULL;\n    virNetworkIPDefPtr ipdef_tmp = NULL;\n    virNetworkDHCPLeasePtr lease = NULL;\n    virNetworkDHCPLeasePtr *leases_ret = NULL;\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virMacAddr mac_addr;\n\n    virCheckFlags(0, -1);\n\n    /* only to check if the MAC is valid */\n    if (mac && virMacAddrParse(mac, &mac_addr) < 0) {\n        virReportError(VIR_ERR_INVALID_MAC, \"%s\", mac);\n        return -1;\n    }\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return -1;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkGetDHCPLeasesEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    /* Retrieve custom leases file location */\n    custom_lease_file = networkDnsmasqLeaseFileNameCustom(driver, def->bridge);\n\n    /* Read entire contents */\n    if ((custom_lease_file_len = virFileReadAllQuiet(custom_lease_file,\n                                                     VIR_NETWORK_DHCP_LEASE_FILE_SIZE_MAX,\n                                                     &lease_entries)) < 0) {\n        /* Not all networks are guaranteed to have leases file.\n         * Only those which run dnsmasq. Therefore, if we failed\n         * to read the leases file, don't report error. Return 0\n         * leases instead. */\n        if (errno == ENOENT) {\n            rv = 0;\n        } else {\n            virReportSystemError(errno,\n                                 _(\"Unable to read leases file: %s\"),\n                                 custom_lease_file);\n        }\n        goto error;\n    }\n\n    if (custom_lease_file_len) {\n        if (!(leases_array = virJSONValueFromString(lease_entries))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid json in file: %s\"), custom_lease_file);\n            goto error;\n        }\n\n        if (!virJSONValueIsArray(leases_array)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed lease_entries array\"));\n            goto error;\n        }\n        size = virJSONValueArraySize(leases_array);\n    }\n\n    currtime = (long long)time(NULL);\n\n    for (i = 0; i < size; i++) {\n        if (!(lease_tmp = virJSONValueArrayGet(leases_array, i))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"failed to parse json\"));\n            goto error;\n        }\n\n        if (!(mac_tmp = virJSONValueObjectGetString(lease_tmp, \"mac-address\"))) {\n            /* leaseshelper program guarantees that lease will be stored only if\n             * mac-address is known otherwise not */\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"found lease without mac-address\"));\n            goto error;\n        }\n\n        if (mac && virMacAddrCompare(mac, mac_tmp))\n            continue;\n\n        if (virJSONValueObjectGetNumberLong(lease_tmp, \"expiry-time\", &expirytime_tmp) < 0) {\n            /* A lease cannot be present without expiry-time */\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"found lease without expiry-time\"));\n            goto error;\n        }\n\n        /* Do not report expired lease */\n        if (expirytime_tmp < currtime)\n            continue;\n\n        if (need_results) {\n            if (VIR_ALLOC(lease) < 0)\n                goto error;\n\n            lease->expirytime = expirytime_tmp;\n\n            if (!(ip_tmp = virJSONValueObjectGetString(lease_tmp, \"ip-address\"))) {\n                /* A lease without ip-address makes no sense */\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"found lease without ip-address\"));\n                goto error;\n            }\n\n            /* Unlike IPv4, IPv6 uses ':' instead of '.' as separator */\n            ipv6 = strchr(ip_tmp, ':') ? true : false;\n            lease->type = ipv6 ? VIR_IP_ADDR_TYPE_IPV6 : VIR_IP_ADDR_TYPE_IPV4;\n\n            /* Obtain prefix */\n            for (j = 0; j < def->nips; j++) {\n                ipdef_tmp = &def->ips[j];\n\n                if (ipv6 && VIR_SOCKET_ADDR_IS_FAMILY(&ipdef_tmp->address,\n                                                      AF_INET6)) {\n                    lease->prefix = ipdef_tmp->prefix;\n                    break;\n                }\n                if (!ipv6 && VIR_SOCKET_ADDR_IS_FAMILY(&ipdef_tmp->address,\n                                                      AF_INET)) {\n                    lease->prefix = virSocketAddrGetIPPrefix(&ipdef_tmp->address,\n                                                             &ipdef_tmp->netmask,\n                                                             ipdef_tmp->prefix);\n                    break;\n                }\n            }\n\n            lease->mac = g_strdup(mac_tmp);\n            lease->ipaddr = g_strdup(ip_tmp);\n            lease->iface = g_strdup(def->bridge);\n\n            /* Fields that can be NULL */\n            lease->iaid = g_strdup(virJSONValueObjectGetString(lease_tmp, \"iaid\"));\n            lease->clientid = g_strdup(virJSONValueObjectGetString(lease_tmp, \"client-id\"));\n            lease->hostname = g_strdup(virJSONValueObjectGetString(lease_tmp, \"hostname\"));\n\n            if (VIR_INSERT_ELEMENT(leases_ret, nleases, nleases, lease) < 0)\n                goto error;\n\n        } else {\n            nleases++;\n        }\n\n        VIR_FREE(lease);\n    }\n\n    if (leases_ret) {\n        /* NULL terminated array */\n        ignore_value(VIR_REALLOC_N(leases_ret, nleases + 1));\n        *leases = leases_ret;\n        leases_ret = NULL;\n    }\n\n    rv = nleases;\n\n cleanup:\n    VIR_FREE(lease);\n    VIR_FREE(lease_entries);\n    VIR_FREE(custom_lease_file);\n    virJSONValueFree(leases_array);\n\n    virNetworkObjEndAPI(&obj);\n\n    return rv;\n\n error:\n    if (leases_ret) {\n        for (i = 0; i < nleases; i++)\n            virNetworkDHCPLeaseFree(leases_ret[i]);\n        VIR_FREE(leases_ret);\n    }\n    goto cleanup;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_NETWORK_DHCP_LEASE_FILE_SIZE_MAX (32 * 1024 * 1024)"
          ],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_NETWORK_DHCP_LEASE_FILE_SIZE_MAX (32 * 1024 * 1024)\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic int\nnetworkGetDHCPLeases(virNetworkPtr net,\n                     const char *mac,\n                     virNetworkDHCPLeasePtr **leases,\n                     unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    size_t i, j;\n    size_t nleases = 0;\n    int rv = -1;\n    size_t size = 0;\n    int custom_lease_file_len = 0;\n    bool need_results = !!leases;\n    long long currtime = 0;\n    long long expirytime_tmp = -1;\n    bool ipv6 = false;\n    char *lease_entries = NULL;\n    char *custom_lease_file = NULL;\n    const char *ip_tmp = NULL;\n    const char *mac_tmp = NULL;\n    virJSONValuePtr lease_tmp = NULL;\n    virJSONValuePtr leases_array = NULL;\n    virNetworkIPDefPtr ipdef_tmp = NULL;\n    virNetworkDHCPLeasePtr lease = NULL;\n    virNetworkDHCPLeasePtr *leases_ret = NULL;\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virMacAddr mac_addr;\n\n    virCheckFlags(0, -1);\n\n    /* only to check if the MAC is valid */\n    if (mac && virMacAddrParse(mac, &mac_addr) < 0) {\n        virReportError(VIR_ERR_INVALID_MAC, \"%s\", mac);\n        return -1;\n    }\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return -1;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkGetDHCPLeasesEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    /* Retrieve custom leases file location */\n    custom_lease_file = networkDnsmasqLeaseFileNameCustom(driver, def->bridge);\n\n    /* Read entire contents */\n    if ((custom_lease_file_len = virFileReadAllQuiet(custom_lease_file,\n                                                     VIR_NETWORK_DHCP_LEASE_FILE_SIZE_MAX,\n                                                     &lease_entries)) < 0) {\n        /* Not all networks are guaranteed to have leases file.\n         * Only those which run dnsmasq. Therefore, if we failed\n         * to read the leases file, don't report error. Return 0\n         * leases instead. */\n        if (errno == ENOENT) {\n            rv = 0;\n        } else {\n            virReportSystemError(errno,\n                                 _(\"Unable to read leases file: %s\"),\n                                 custom_lease_file);\n        }\n        goto error;\n    }\n\n    if (custom_lease_file_len) {\n        if (!(leases_array = virJSONValueFromString(lease_entries))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid json in file: %s\"), custom_lease_file);\n            goto error;\n        }\n\n        if (!virJSONValueIsArray(leases_array)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Malformed lease_entries array\"));\n            goto error;\n        }\n        size = virJSONValueArraySize(leases_array);\n    }\n\n    currtime = (long long)time(NULL);\n\n    for (i = 0; i < size; i++) {\n        if (!(lease_tmp = virJSONValueArrayGet(leases_array, i))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"failed to parse json\"));\n            goto error;\n        }\n\n        if (!(mac_tmp = virJSONValueObjectGetString(lease_tmp, \"mac-address\"))) {\n            /* leaseshelper program guarantees that lease will be stored only if\n             * mac-address is known otherwise not */\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"found lease without mac-address\"));\n            goto error;\n        }\n\n        if (mac && virMacAddrCompare(mac, mac_tmp))\n            continue;\n\n        if (virJSONValueObjectGetNumberLong(lease_tmp, \"expiry-time\", &expirytime_tmp) < 0) {\n            /* A lease cannot be present without expiry-time */\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"found lease without expiry-time\"));\n            goto error;\n        }\n\n        /* Do not report expired lease */\n        if (expirytime_tmp < currtime)\n            continue;\n\n        if (need_results) {\n            if (VIR_ALLOC(lease) < 0)\n                goto error;\n\n            lease->expirytime = expirytime_tmp;\n\n            if (!(ip_tmp = virJSONValueObjectGetString(lease_tmp, \"ip-address\"))) {\n                /* A lease without ip-address makes no sense */\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"found lease without ip-address\"));\n                goto error;\n            }\n\n            /* Unlike IPv4, IPv6 uses ':' instead of '.' as separator */\n            ipv6 = strchr(ip_tmp, ':') ? true : false;\n            lease->type = ipv6 ? VIR_IP_ADDR_TYPE_IPV6 : VIR_IP_ADDR_TYPE_IPV4;\n\n            /* Obtain prefix */\n            for (j = 0; j < def->nips; j++) {\n                ipdef_tmp = &def->ips[j];\n\n                if (ipv6 && VIR_SOCKET_ADDR_IS_FAMILY(&ipdef_tmp->address,\n                                                      AF_INET6)) {\n                    lease->prefix = ipdef_tmp->prefix;\n                    break;\n                }\n                if (!ipv6 && VIR_SOCKET_ADDR_IS_FAMILY(&ipdef_tmp->address,\n                                                      AF_INET)) {\n                    lease->prefix = virSocketAddrGetIPPrefix(&ipdef_tmp->address,\n                                                             &ipdef_tmp->netmask,\n                                                             ipdef_tmp->prefix);\n                    break;\n                }\n            }\n\n            lease->mac = g_strdup(mac_tmp);\n            lease->ipaddr = g_strdup(ip_tmp);\n            lease->iface = g_strdup(def->bridge);\n\n            /* Fields that can be NULL */\n            lease->iaid = g_strdup(virJSONValueObjectGetString(lease_tmp, \"iaid\"));\n            lease->clientid = g_strdup(virJSONValueObjectGetString(lease_tmp, \"client-id\"));\n            lease->hostname = g_strdup(virJSONValueObjectGetString(lease_tmp, \"hostname\"));\n\n            if (VIR_INSERT_ELEMENT(leases_ret, nleases, nleases, lease) < 0)\n                goto error;\n\n        } else {\n            nleases++;\n        }\n\n        VIR_FREE(lease);\n    }\n\n    if (leases_ret) {\n        /* NULL terminated array */\n        ignore_value(VIR_REALLOC_N(leases_ret, nleases + 1));\n        *leases = leases_ret;\n        leases_ret = NULL;\n    }\n\n    rv = nleases;\n\n cleanup:\n    VIR_FREE(lease);\n    VIR_FREE(lease_entries);\n    VIR_FREE(custom_lease_file);\n    virJSONValueFree(leases_array);\n\n    virNetworkObjEndAPI(&obj);\n\n    return rv;\n\n error:\n    if (leases_ret) {\n        for (i = 0; i < nleases; i++)\n            virNetworkDHCPLeaseFree(leases_ret[i]);\n        VIR_FREE(leases_ret);\n    }\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, mac='%s' leases=%p, flags=0x%x\"",
            "network",
            "NULLSTR(mac)",
            "leases",
            "flags"
          ],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "mac"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkGetDHCPLeases(virNetworkPtr network,\n                        const char *mac,\n                        virNetworkDHCPLeasePtr **leases,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, mac='%s' leases=%p, flags=0x%x\",\n               network, NULLSTR(mac), leases, flags);\n\n    virResetLastError();\n\n    if (leases)\n        *leases = NULL;\n\n    virCheckNetworkReturn(network, -1);\n\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetDHCPLeases) {\n        int ret;\n        ret = conn->networkDriver->networkGetDHCPLeases(network, mac, leases, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNetworkEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1096-1121",
    "snippet": "int\nvirConnectNetworkEventDeregisterAny(virConnectPtr conn,\n                                    int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->networkDriver &&\n        conn->networkDriver->connectNetworkEventDeregisterAny) {\n        int ret;\n        ret = conn->networkDriver->connectNetworkEventDeregisterAny(conn,\n                                                                    callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectNetworkEventDeregisterAny",
          "args": [
            "conn",
            "callbackID"
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "callbackID",
            "error"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, callbackID=%d\"",
            "conn",
            "callbackID"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNetworkEventDeregisterAny(virConnectPtr conn,\n                                    int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->networkDriver &&\n        conn->networkDriver->connectNetworkEventDeregisterAny) {\n        int ret;\n        ret = conn->networkDriver->connectNetworkEventDeregisterAny(conn,\n                                                                    callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNetworkEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "1035-1083",
    "snippet": "int\nvirConnectNetworkEventRegisterAny(virConnectPtr conn,\n                                  virNetworkPtr net,\n                                  int eventID,\n                                  virConnectNetworkEventGenericCallback cb,\n                                  void *opaque,\n                                  virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n              conn, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (net) {\n        virCheckNetworkGoto(net, error);\n        if (net->conn != conn) {\n            virReportInvalidArg(net,\n                                _(\"network '%s' in %s must match connection\"),\n                                net->name, __FUNCTION__);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n\n    if (eventID >= VIR_NETWORK_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID in %s must be less than %d\"),\n                            __FUNCTION__, VIR_NETWORK_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->networkDriver && conn->networkDriver->connectNetworkEventRegisterAny) {\n        int ret;\n        ret = conn->networkDriver->connectNetworkEventRegisterAny(conn, net,\n                                                                  eventID,\n                                                                  cb, opaque,\n                                                                  freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1081
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectNetworkEventRegisterAny",
          "args": [
            "conn",
            "net",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "eventID",
            "_(\"eventID in %s must be less than %d\")",
            "__FUNCTION__",
            "VIR_NETWORK_EVENT_ID_LAST"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"eventID in %s must be less than %d\""
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "eventID",
            "error"
          ],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "net",
            "_(\"network '%s' in %s must match connection\")",
            "net->name",
            "__FUNCTION__"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkGoto",
          "args": [
            "net",
            "error"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\"",
            "conn",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNetworkEventRegisterAny(virConnectPtr conn,\n                                  virNetworkPtr net,\n                                  int eventID,\n                                  virConnectNetworkEventGenericCallback cb,\n                                  void *opaque,\n                                  virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n              conn, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (net) {\n        virCheckNetworkGoto(net, error);\n        if (net->conn != conn) {\n            virReportInvalidArg(net,\n                                _(\"network '%s' in %s must match connection\"),\n                                net->name, __FUNCTION__);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n\n    if (eventID >= VIR_NETWORK_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID in %s must be less than %d\"),\n                            __FUNCTION__, VIR_NETWORK_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->networkDriver && conn->networkDriver->connectNetworkEventRegisterAny) {\n        int ret;\n        ret = conn->networkDriver->connectNetworkEventRegisterAny(conn, net,\n                                                                  eventID,\n                                                                  cb, opaque,\n                                                                  freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "976-997",
    "snippet": "int\nvirNetworkIsPersistent(virNetworkPtr net)\n{\n    VIR_DEBUG(\"net=%p\", net);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, -1);\n\n    if (net->conn->networkDriver->networkIsPersistent) {\n        int ret;\n        ret = net->conn->networkDriver->networkIsPersistent(net);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(net->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "net->conn"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net->conn->networkDriver->networkIsPersistent",
          "args": [
            "net"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "networkIsPersistent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3249-3266",
          "snippet": "static int\nnetworkIsPersistent(virNetworkPtr net)\n{\n    virNetworkObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    if (virNetworkIsPersistentEnsureACL(net->conn, virNetworkObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    ret = virNetworkObjIsPersistent(obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic int\nnetworkIsPersistent(virNetworkPtr net)\n{\n    virNetworkObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    if (virNetworkIsPersistentEnsureACL(net->conn, virNetworkObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    ret = virNetworkObjIsPersistent(obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "net",
            "-1"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 981
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"net=%p\"",
            "net"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkIsPersistent(virNetworkPtr net)\n{\n    VIR_DEBUG(\"net=%p\", net);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, -1);\n\n    if (net->conn->networkDriver->networkIsPersistent) {\n        int ret;\n        ret = net->conn->networkDriver->networkIsPersistent(net);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(net->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "943-964",
    "snippet": "int\nvirNetworkIsActive(virNetworkPtr net)\n{\n    VIR_DEBUG(\"net=%p\", net);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, -1);\n\n    if (net->conn->networkDriver->networkIsActive) {\n        int ret;\n        ret = net->conn->networkDriver->networkIsActive(net);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(net->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "net->conn"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net->conn->networkDriver->networkIsActive",
          "args": [
            "net"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "networkIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3229-3246",
          "snippet": "static int\nnetworkIsActive(virNetworkPtr net)\n{\n    virNetworkObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    if (virNetworkIsActiveEnsureACL(net->conn, virNetworkObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    ret = virNetworkObjIsActive(obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic int\nnetworkIsActive(virNetworkPtr net)\n{\n    virNetworkObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    if (virNetworkIsActiveEnsureACL(net->conn, virNetworkObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    ret = virNetworkObjIsActive(obj);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "net",
            "-1"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"net=%p\"",
            "net"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkIsActive(virNetworkPtr net)\n{\n    VIR_DEBUG(\"net=%p\", net);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, -1);\n\n    if (net->conn->networkDriver->networkIsActive) {\n        int ret;\n        ret = net->conn->networkDriver->networkIsActive(net);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(net->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "905-932",
    "snippet": "int\nvirNetworkSetAutostart(virNetworkPtr network,\n                       int autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, autostart=%d\", network, autostart);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkSetAutostart) {\n        int ret;\n        ret = conn->networkDriver->networkSetAutostart(network, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkSetAutostart",
          "args": [
            "network",
            "autostart"
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "networkSetAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4169-4237",
          "snippet": "static int\nnetworkSetAutostart(virNetworkPtr net,\n                    int autostart)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    char *configFile = NULL, *autostartLink = NULL;\n    bool new_autostart;\n    bool cur_autostart;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkSetAutostartEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsPersistent(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cannot set autostart for transient network\"));\n        goto cleanup;\n    }\n\n    new_autostart = (autostart != 0);\n    cur_autostart = virNetworkObjIsAutostart(obj);\n    if (cur_autostart != new_autostart) {\n        if ((configFile = virNetworkConfigFile(driver->networkConfigDir,\n                                               def->name)) == NULL)\n            goto cleanup;\n        if ((autostartLink = virNetworkConfigFile(driver->networkAutostartDir,\n                                                  def->name)) == NULL)\n            goto cleanup;\n\n        if (new_autostart) {\n            if (virFileMakePath(driver->networkAutostartDir) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory '%s'\"),\n                                     driver->networkAutostartDir);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (unlink(autostartLink) < 0 && errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n\n        virNetworkObjSetAutostart(obj, new_autostart);\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic int\nnetworkSetAutostart(virNetworkPtr net,\n                    int autostart)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    char *configFile = NULL, *autostartLink = NULL;\n    bool new_autostart;\n    bool cur_autostart;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkSetAutostartEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsPersistent(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cannot set autostart for transient network\"));\n        goto cleanup;\n    }\n\n    new_autostart = (autostart != 0);\n    cur_autostart = virNetworkObjIsAutostart(obj);\n    if (cur_autostart != new_autostart) {\n        if ((configFile = virNetworkConfigFile(driver->networkConfigDir,\n                                               def->name)) == NULL)\n            goto cleanup;\n        if ((autostartLink = virNetworkConfigFile(driver->networkAutostartDir,\n                                                  def->name)) == NULL)\n            goto cleanup;\n\n        if (new_autostart) {\n            if (virFileMakePath(driver->networkAutostartDir) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot create autostart directory '%s'\"),\n                                     driver->networkAutostartDir);\n                goto cleanup;\n            }\n\n            if (symlink(configFile, autostartLink) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to create symlink '%s' to '%s'\"),\n                                     autostartLink, configFile);\n                goto cleanup;\n            }\n        } else {\n            if (unlink(autostartLink) < 0 && errno != ENOENT && errno != ENOTDIR) {\n                virReportSystemError(errno,\n                                     _(\"Failed to delete symlink '%s'\"),\n                                     autostartLink);\n                goto cleanup;\n            }\n        }\n\n        virNetworkObjSetAutostart(obj, new_autostart);\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, autostart=%d\"",
            "network",
            "autostart"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkSetAutostart(virNetworkPtr network,\n                       int autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, autostart=%d\", network, autostart);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkSetAutostart) {\n        int ret;\n        ret = conn->networkDriver->networkSetAutostart(network, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "865-892",
    "snippet": "int\nvirNetworkGetAutostart(virNetworkPtr network,\n                       int *autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, autostart=%p\", network, autostart);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    virCheckNonNullArgGoto(autostart, error);\n\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetAutostart) {\n        int ret;\n        ret = conn->networkDriver->networkGetAutostart(network, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkGetAutostart",
          "args": [
            "network",
            "autostart"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "networkGetAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4147-4166",
          "snippet": "static int\nnetworkGetAutostart(virNetworkPtr net,\n                    int *autostart)\n{\n    virNetworkObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    if (virNetworkGetAutostartEnsureACL(net->conn, virNetworkObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    *autostart = virNetworkObjIsAutostart(obj) ? 1 : 0;\n    ret = 0;\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic int\nnetworkGetAutostart(virNetworkPtr net,\n                    int *autostart)\n{\n    virNetworkObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n\n    if (virNetworkGetAutostartEnsureACL(net->conn, virNetworkObjGetDef(obj)) < 0)\n        goto cleanup;\n\n    *autostart = virNetworkObjIsAutostart(obj) ? 1 : 0;\n    ret = 0;\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "autostart",
            "error"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, autostart=%p\"",
            "network",
            "autostart"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkGetAutostart(virNetworkPtr network,\n                       int *autostart)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, autostart=%p\", network, autostart);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    virCheckNonNullArgGoto(autostart, error);\n\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetAutostart) {\n        int ret;\n        ret = conn->networkDriver->networkGetAutostart(network, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkGetBridgeName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "827-851",
    "snippet": "char *\nvirNetworkGetBridgeName(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, NULL);\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetBridgeName) {\n        char *ret;\n        ret = conn->networkDriver->networkGetBridgeName(network);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkGetBridgeName",
          "args": [
            "network"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "networkGetBridgeName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4118-4144",
          "snippet": "static char *\nnetworkGetBridgeName(virNetworkPtr net)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    char *bridge = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return bridge;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkGetBridgeNameEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!(def->bridge)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"network '%s' does not have a bridge name.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    bridge = g_strdup(def->bridge);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return bridge;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic char *\nnetworkGetBridgeName(virNetworkPtr net)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    char *bridge = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return bridge;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkGetBridgeNameEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!(def->bridge)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"network '%s' does not have a bridge name.\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    bridge = g_strdup(def->bridge);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return bridge;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "NULL"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p\"",
            "network"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirNetworkGetBridgeName(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, NULL);\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetBridgeName) {\n        char *ret;\n        ret = conn->networkDriver->networkGetBridgeName(network);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "790-814",
    "snippet": "char *\nvirNetworkGetXMLDesc(virNetworkPtr network, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, flags=0x%x\", network, flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, NULL);\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetXMLDesc) {\n        char *ret;\n        ret = conn->networkDriver->networkGetXMLDesc(network, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkGetXMLDesc",
          "args": [
            "network",
            "flags"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "networkGetXMLDesc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4085-4115",
          "snippet": "static char *\nnetworkGetXMLDesc(virNetworkPtr net,\n                  unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr curDef;\n    virNetworkDefPtr def;\n    virNetworkDefPtr newDef;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_NETWORK_XML_INACTIVE, NULL);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n    def = virNetworkObjGetDef(obj);\n    newDef = virNetworkObjGetNewDef(obj);\n\n    if (virNetworkGetXMLDescEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if ((flags & VIR_NETWORK_XML_INACTIVE) && newDef)\n        curDef = newDef;\n    else\n        curDef = def;\n\n    ret = virNetworkDefFormat(curDef, network_driver->xmlopt, flags);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNetworkDriverStatePtr network_driver;",
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNetworkDriverStatePtr network_driver;\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\n\nstatic char *\nnetworkGetXMLDesc(virNetworkPtr net,\n                  unsigned int flags)\n{\n    virNetworkObjPtr obj;\n    virNetworkDefPtr curDef;\n    virNetworkDefPtr def;\n    virNetworkDefPtr newDef;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_NETWORK_XML_INACTIVE, NULL);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        return ret;\n    def = virNetworkObjGetDef(obj);\n    newDef = virNetworkObjGetNewDef(obj);\n\n    if (virNetworkGetXMLDescEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if ((flags & VIR_NETWORK_XML_INACTIVE) && newDef)\n        curDef = newDef;\n    else\n        curDef = def;\n\n    ret = virNetworkDefFormat(curDef, network_driver->xmlopt, flags);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "NULL"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, flags=0x%x\"",
            "network",
            "flags"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nchar *\nvirNetworkGetXMLDesc(virNetworkPtr network, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, flags=0x%x\", network, flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, NULL);\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetXMLDesc) {\n        char *ret;\n        ret = conn->networkDriver->networkGetXMLDesc(network, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkGetUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "755-771",
    "snippet": "int\nvirNetworkGetUUIDString(virNetworkPtr network, char *buf)\n{\n    VIR_DEBUG(\"network=%p, buf=%p\", network, buf);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(network->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 769
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "network->uuid",
            "buf"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buf",
            "error"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, buf=%p\"",
            "network",
            "buf"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkGetUUIDString(virNetworkPtr network, char *buf)\n{\n    VIR_DEBUG(\"network=%p, buf=%p\", network, buf);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(network->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkGetUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "725-742",
    "snippet": "int\nvirNetworkGetUUID(virNetworkPtr network, unsigned char *uuid)\n{\n    VIR_DEBUG(\"network=%p, uuid=%p\", network, uuid);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &network->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "uuid",
            "&network->uuid[0]",
            "VIR_UUID_BUFLEN"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, uuid=%p\"",
            "network",
            "uuid"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkGetUUID(virNetworkPtr network, unsigned char *uuid)\n{\n    VIR_DEBUG(\"network=%p, uuid=%p\", network, uuid);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &network->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "703-713",
    "snippet": "const char *\nvirNetworkGetName(virNetworkPtr network)\n{\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, NULL);\n\n    return network->name;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "NULL"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p\"",
            "network"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nconst char *\nvirNetworkGetName(virNetworkPtr network)\n{\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, NULL);\n\n    return network->name;\n}"
  },
  {
    "function_name": "virNetworkRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "679-691",
    "snippet": "int\nvirNetworkRef(virNetworkPtr network)\n{\n    VIR_DEBUG(\"network=%p refs=%d\", network,\n              network ? network->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n\n    virObjectRef(network);\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "network"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p refs=%d\"",
            "network",
            "network ? network->parent.u.s.refs : 0"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkRef(virNetworkPtr network)\n{\n    VIR_DEBUG(\"network=%p refs=%d\", network,\n              network ? network->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n\n    virObjectRef(network);\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "648-659",
    "snippet": "int\nvirNetworkFree(virNetworkPtr network)\n{\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n\n    virObjectUnref(network);\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "network"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p\"",
            "network"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkFree(virNetworkPtr network)\n{\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n\n    virObjectUnref(network);\n    return 0;\n}"
  },
  {
    "function_name": "virNetworkDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "610-636",
    "snippet": "int\nvirNetworkDestroy(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkDestroy) {\n        int ret;\n        ret = conn->networkDriver->networkDestroy(network);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 634
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkDestroy",
          "args": [
            "network"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "networkDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4036-4082",
          "snippet": "static int\nnetworkDestroy(virNetworkPtr net)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkDestroyEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if ((ret = networkShutdownNetwork(driver, obj)) < 0)\n        goto cleanup;\n\n    virNetworkObjDeleteAllPorts(obj, driver->stateDir);\n\n    /* @def replaced in virNetworkObjUnsetDefTransient */\n    def = virNetworkObjGetDef(obj);\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_STOPPED,\n                                        0);\n\n    if (!virNetworkObjIsPersistent(obj) &&\n        networkRemoveInactive(driver, obj) < 0) {\n        ret = -1;\n        goto cleanup;\n    }\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic int\nnetworkDestroy(virNetworkPtr net)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkDestroyEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (!virNetworkObjIsActive(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       _(\"network '%s' is not active\"),\n                       def->name);\n        goto cleanup;\n    }\n\n    if ((ret = networkShutdownNetwork(driver, obj)) < 0)\n        goto cleanup;\n\n    virNetworkObjDeleteAllPorts(obj, driver->stateDir);\n\n    /* @def replaced in virNetworkObjUnsetDefTransient */\n    def = virNetworkObjGetDef(obj);\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_STOPPED,\n                                        0);\n\n    if (!virNetworkObjIsPersistent(obj) &&\n        networkRemoveInactive(driver, obj) < 0) {\n        ret = -1;\n        goto cleanup;\n    }\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p\"",
            "network"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkDestroy(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkDestroy) {\n        int ret;\n        ret = conn->networkDriver->networkDestroy(network);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "570-596",
    "snippet": "int\nvirNetworkCreate(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkCreate) {\n        int ret;\n        ret = conn->networkDriver->networkCreate(network);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkCreate",
          "args": [
            "network"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "networkCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "4005-4033",
          "snippet": "static int\nnetworkCreate(virNetworkPtr net)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkCreateEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if ((ret = networkStartNetwork(driver, obj)) < 0)\n        goto cleanup;\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_STARTED,\n                                        0);\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic int\nnetworkCreate(virNetworkPtr net)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n    virObjectEventPtr event = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkCreateEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if ((ret = networkStartNetwork(driver, obj)) < 0)\n        goto cleanup;\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_STARTED,\n                                        0);\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p\"",
            "network"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkCreate(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkCreate) {\n        int ret;\n        ret = conn->networkDriver->networkCreate(network);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkUpdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "524-558",
    "snippet": "int\nvirNetworkUpdate(virNetworkPtr network,\n                 unsigned int command, /* virNetworkUpdateCommand */\n                 unsigned int section, /* virNetworkUpdateSection */\n                 int parentIndex,\n                 const char *xml,\n                 unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, section=%d, parentIndex=%d, xml=%s, flags=0x%x\",\n              network, section, parentIndex, xml, flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkUpdate) {\n        int ret;\n        ret = conn->networkDriver->networkUpdate(network, section, command,\n                                                 parentIndex, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkUpdate",
          "args": [
            "network",
            "section",
            "command",
            "parentIndex",
            "xml",
            "flags"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "networkUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3809-4002",
          "snippet": "static int\nnetworkUpdate(virNetworkPtr net,\n              unsigned int command,\n              unsigned int section,\n              int parentIndex,\n              const char *xml,\n              unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj = NULL;\n    virNetworkDefPtr def;\n    int isActive, ret = -1;\n    size_t i;\n    virNetworkIPDefPtr ipdef;\n    bool oldDhcpActive = false;\n    bool needFirewallRefresh = false;\n\n\n    virCheckFlags(VIR_NETWORK_UPDATE_AFFECT_LIVE |\n                  VIR_NETWORK_UPDATE_AFFECT_CONFIG,\n                  -1);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkUpdateEnsureACL(net->conn, def, flags) < 0)\n        goto cleanup;\n\n    /* see if we are listening for dhcp pre-modification */\n    for (i = 0;\n         (ipdef = virNetworkDefGetIPByIndex(def, AF_INET, i));\n         i++) {\n        if (ipdef->nranges || ipdef->nhosts) {\n            oldDhcpActive = true;\n            break;\n        }\n    }\n\n    /* VIR_NETWORK_UPDATE_AFFECT_CURRENT means \"change LIVE if network\n     * is active, else change CONFIG\n     */\n    isActive = virNetworkObjIsActive(obj);\n    if ((flags & (VIR_NETWORK_UPDATE_AFFECT_LIVE |\n                  VIR_NETWORK_UPDATE_AFFECT_CONFIG)) ==\n        VIR_NETWORK_UPDATE_AFFECT_CURRENT) {\n        if (isActive)\n            flags |= VIR_NETWORK_UPDATE_AFFECT_LIVE;\n        else\n            flags |= VIR_NETWORK_UPDATE_AFFECT_CONFIG;\n    }\n\n    if (isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        /* Take care of anything that must be done before updating the\n         * live NetworkDef.\n         */\n        switch ((virNetworkForwardType) def->forward.type) {\n        case VIR_NETWORK_FORWARD_NONE:\n        case VIR_NETWORK_FORWARD_NAT:\n        case VIR_NETWORK_FORWARD_ROUTE:\n            switch (section) {\n            case VIR_NETWORK_SECTION_FORWARD:\n            case VIR_NETWORK_SECTION_FORWARD_INTERFACE:\n            case VIR_NETWORK_SECTION_IP:\n            case VIR_NETWORK_SECTION_IP_DHCP_RANGE:\n            case VIR_NETWORK_SECTION_IP_DHCP_HOST:\n                /* these could affect the firewall rules, so remove the\n                 * old rules (and remember to load new ones after the\n                 * update).\n                 */\n                networkRemoveFirewallRules(def);\n                needFirewallRefresh = true;\n                break;\n            default:\n                break;\n            }\n            break;\n\n        case VIR_NETWORK_FORWARD_OPEN:\n        case VIR_NETWORK_FORWARD_BRIDGE:\n        case VIR_NETWORK_FORWARD_PRIVATE:\n        case VIR_NETWORK_FORWARD_VEPA:\n        case VIR_NETWORK_FORWARD_PASSTHROUGH:\n        case VIR_NETWORK_FORWARD_HOSTDEV:\n            break;\n\n        case VIR_NETWORK_FORWARD_LAST:\n        default:\n            virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n            goto cleanup;\n        }\n    }\n\n    /* update the network config in memory/on disk */\n    if (virNetworkObjUpdate(obj, command, section,\n                            parentIndex, xml,\n                            network_driver->xmlopt, flags) < 0) {\n        if (needFirewallRefresh)\n            ignore_value(networkAddFirewallRules(def));\n        goto cleanup;\n    }\n\n    /* @def is replaced */\n    def = virNetworkObjGetDef(obj);\n\n    if (needFirewallRefresh && networkAddFirewallRules(def) < 0)\n        goto cleanup;\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        /* save updated persistent config to disk */\n        if (virNetworkSaveConfig(driver->networkConfigDir,\n                                 virNetworkObjGetPersistentDef(obj),\n                                 network_driver->xmlopt) < 0) {\n            goto cleanup;\n        }\n    }\n\n    if (isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        /* rewrite dnsmasq host files, restart dnsmasq, update iptables\n         * rules, etc, according to which section was modified. Note that\n         * some sections require multiple actions, so a single switch\n         * statement is inadequate.\n         */\n        if (section == VIR_NETWORK_SECTION_BRIDGE ||\n            section == VIR_NETWORK_SECTION_DOMAIN ||\n            section == VIR_NETWORK_SECTION_IP ||\n            section == VIR_NETWORK_SECTION_IP_DHCP_RANGE ||\n            section == VIR_NETWORK_SECTION_DNS_TXT ||\n            section == VIR_NETWORK_SECTION_DNS_SRV) {\n            /* these sections all change things on the dnsmasq\n             * commandline (i.e. in the .conf file), so we need to\n             * kill and restart dnsmasq, because dnsmasq sets its uid\n             * to \"nobody\" after it starts, and is unable to re-read\n             * the conf file (owned by root, mode 600)\n             */\n            if (networkRestartDhcpDaemon(driver, obj) < 0)\n                goto cleanup;\n\n        } else if (section == VIR_NETWORK_SECTION_IP_DHCP_HOST) {\n            /* if we previously weren't listening for dhcp and now we\n             * are (or vice-versa) then we need to do a restart,\n             * otherwise we just need to do a refresh (redo the config\n             * files and send SIGHUP)\n             */\n            bool newDhcpActive = false;\n\n            for (i = 0; (ipdef = virNetworkDefGetIPByIndex(def, AF_INET, i));\n                 i++) {\n                if (ipdef->nranges || ipdef->nhosts) {\n                    newDhcpActive = true;\n                    break;\n                }\n            }\n\n            if ((newDhcpActive != oldDhcpActive &&\n                 networkRestartDhcpDaemon(driver, obj) < 0) ||\n                networkRefreshDhcpDaemon(driver, obj) < 0) {\n                goto cleanup;\n            }\n\n        } else if (section == VIR_NETWORK_SECTION_DNS_HOST) {\n            /* this section only changes data in an external file\n             * (not the .conf file) so we can just update the config\n             * files and send SIGHUP to dnsmasq.\n             */\n            if (networkRefreshDhcpDaemon(driver, obj) < 0)\n                goto cleanup;\n\n        }\n\n        if (section == VIR_NETWORK_SECTION_IP) {\n            /* only a change in IP addresses will affect radvd, and all of radvd's\n             * config is stored in the conf file which will be re-read with a SIGHUP.\n             */\n            if (networkRefreshRadvd(driver, obj) < 0)\n                goto cleanup;\n        }\n\n        /* save current network state to disk */\n        if ((ret = virNetworkObjSaveStatus(driver->stateDir,\n                                           obj, network_driver->xmlopt)) < 0)\n            goto cleanup;\n    }\n\n    /* call the 'updated' network hook script */\n    if (networkRunHook(obj, NULL, VIR_HOOK_NETWORK_OP_UPDATED,\n                       VIR_HOOK_SUBOP_BEGIN) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNetworkDriverStatePtr network_driver;",
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNetworkDriverStatePtr network_driver;\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic int\nnetworkUpdate(virNetworkPtr net,\n              unsigned int command,\n              unsigned int section,\n              int parentIndex,\n              const char *xml,\n              unsigned int flags)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj = NULL;\n    virNetworkDefPtr def;\n    int isActive, ret = -1;\n    size_t i;\n    virNetworkIPDefPtr ipdef;\n    bool oldDhcpActive = false;\n    bool needFirewallRefresh = false;\n\n\n    virCheckFlags(VIR_NETWORK_UPDATE_AFFECT_LIVE |\n                  VIR_NETWORK_UPDATE_AFFECT_CONFIG,\n                  -1);\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkUpdateEnsureACL(net->conn, def, flags) < 0)\n        goto cleanup;\n\n    /* see if we are listening for dhcp pre-modification */\n    for (i = 0;\n         (ipdef = virNetworkDefGetIPByIndex(def, AF_INET, i));\n         i++) {\n        if (ipdef->nranges || ipdef->nhosts) {\n            oldDhcpActive = true;\n            break;\n        }\n    }\n\n    /* VIR_NETWORK_UPDATE_AFFECT_CURRENT means \"change LIVE if network\n     * is active, else change CONFIG\n     */\n    isActive = virNetworkObjIsActive(obj);\n    if ((flags & (VIR_NETWORK_UPDATE_AFFECT_LIVE |\n                  VIR_NETWORK_UPDATE_AFFECT_CONFIG)) ==\n        VIR_NETWORK_UPDATE_AFFECT_CURRENT) {\n        if (isActive)\n            flags |= VIR_NETWORK_UPDATE_AFFECT_LIVE;\n        else\n            flags |= VIR_NETWORK_UPDATE_AFFECT_CONFIG;\n    }\n\n    if (isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        /* Take care of anything that must be done before updating the\n         * live NetworkDef.\n         */\n        switch ((virNetworkForwardType) def->forward.type) {\n        case VIR_NETWORK_FORWARD_NONE:\n        case VIR_NETWORK_FORWARD_NAT:\n        case VIR_NETWORK_FORWARD_ROUTE:\n            switch (section) {\n            case VIR_NETWORK_SECTION_FORWARD:\n            case VIR_NETWORK_SECTION_FORWARD_INTERFACE:\n            case VIR_NETWORK_SECTION_IP:\n            case VIR_NETWORK_SECTION_IP_DHCP_RANGE:\n            case VIR_NETWORK_SECTION_IP_DHCP_HOST:\n                /* these could affect the firewall rules, so remove the\n                 * old rules (and remember to load new ones after the\n                 * update).\n                 */\n                networkRemoveFirewallRules(def);\n                needFirewallRefresh = true;\n                break;\n            default:\n                break;\n            }\n            break;\n\n        case VIR_NETWORK_FORWARD_OPEN:\n        case VIR_NETWORK_FORWARD_BRIDGE:\n        case VIR_NETWORK_FORWARD_PRIVATE:\n        case VIR_NETWORK_FORWARD_VEPA:\n        case VIR_NETWORK_FORWARD_PASSTHROUGH:\n        case VIR_NETWORK_FORWARD_HOSTDEV:\n            break;\n\n        case VIR_NETWORK_FORWARD_LAST:\n        default:\n            virReportEnumRangeError(virNetworkForwardType, def->forward.type);\n            goto cleanup;\n        }\n    }\n\n    /* update the network config in memory/on disk */\n    if (virNetworkObjUpdate(obj, command, section,\n                            parentIndex, xml,\n                            network_driver->xmlopt, flags) < 0) {\n        if (needFirewallRefresh)\n            ignore_value(networkAddFirewallRules(def));\n        goto cleanup;\n    }\n\n    /* @def is replaced */\n    def = virNetworkObjGetDef(obj);\n\n    if (needFirewallRefresh && networkAddFirewallRules(def) < 0)\n        goto cleanup;\n\n    if (flags & VIR_NETWORK_UPDATE_AFFECT_CONFIG) {\n        /* save updated persistent config to disk */\n        if (virNetworkSaveConfig(driver->networkConfigDir,\n                                 virNetworkObjGetPersistentDef(obj),\n                                 network_driver->xmlopt) < 0) {\n            goto cleanup;\n        }\n    }\n\n    if (isActive && (flags & VIR_NETWORK_UPDATE_AFFECT_LIVE)) {\n        /* rewrite dnsmasq host files, restart dnsmasq, update iptables\n         * rules, etc, according to which section was modified. Note that\n         * some sections require multiple actions, so a single switch\n         * statement is inadequate.\n         */\n        if (section == VIR_NETWORK_SECTION_BRIDGE ||\n            section == VIR_NETWORK_SECTION_DOMAIN ||\n            section == VIR_NETWORK_SECTION_IP ||\n            section == VIR_NETWORK_SECTION_IP_DHCP_RANGE ||\n            section == VIR_NETWORK_SECTION_DNS_TXT ||\n            section == VIR_NETWORK_SECTION_DNS_SRV) {\n            /* these sections all change things on the dnsmasq\n             * commandline (i.e. in the .conf file), so we need to\n             * kill and restart dnsmasq, because dnsmasq sets its uid\n             * to \"nobody\" after it starts, and is unable to re-read\n             * the conf file (owned by root, mode 600)\n             */\n            if (networkRestartDhcpDaemon(driver, obj) < 0)\n                goto cleanup;\n\n        } else if (section == VIR_NETWORK_SECTION_IP_DHCP_HOST) {\n            /* if we previously weren't listening for dhcp and now we\n             * are (or vice-versa) then we need to do a restart,\n             * otherwise we just need to do a refresh (redo the config\n             * files and send SIGHUP)\n             */\n            bool newDhcpActive = false;\n\n            for (i = 0; (ipdef = virNetworkDefGetIPByIndex(def, AF_INET, i));\n                 i++) {\n                if (ipdef->nranges || ipdef->nhosts) {\n                    newDhcpActive = true;\n                    break;\n                }\n            }\n\n            if ((newDhcpActive != oldDhcpActive &&\n                 networkRestartDhcpDaemon(driver, obj) < 0) ||\n                networkRefreshDhcpDaemon(driver, obj) < 0) {\n                goto cleanup;\n            }\n\n        } else if (section == VIR_NETWORK_SECTION_DNS_HOST) {\n            /* this section only changes data in an external file\n             * (not the .conf file) so we can just update the config\n             * files and send SIGHUP to dnsmasq.\n             */\n            if (networkRefreshDhcpDaemon(driver, obj) < 0)\n                goto cleanup;\n\n        }\n\n        if (section == VIR_NETWORK_SECTION_IP) {\n            /* only a change in IP addresses will affect radvd, and all of radvd's\n             * config is stored in the conf file which will be re-read with a SIGHUP.\n             */\n            if (networkRefreshRadvd(driver, obj) < 0)\n                goto cleanup;\n        }\n\n        /* save current network state to disk */\n        if ((ret = virNetworkObjSaveStatus(driver->stateDir,\n                                           obj, network_driver->xmlopt)) < 0)\n            goto cleanup;\n    }\n\n    /* call the 'updated' network hook script */\n    if (networkRunHook(obj, NULL, VIR_HOOK_NETWORK_OP_UPDATED,\n                       VIR_HOOK_SUBOP_BEGIN) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p, section=%d, parentIndex=%d, xml=%s, flags=0x%x\"",
            "network",
            "section",
            "parentIndex",
            "xml",
            "flags"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkUpdate(virNetworkPtr network,\n                 unsigned int command, /* virNetworkUpdateCommand */\n                 unsigned int section, /* virNetworkUpdateSection */\n                 int parentIndex,\n                 const char *xml,\n                 unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, section=%d, parentIndex=%d, xml=%s, flags=0x%x\",\n              network, section, parentIndex, xml, flags);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkUpdate) {\n        int ret;\n        ret = conn->networkDriver->networkUpdate(network, section, command,\n                                                 parentIndex, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "476-502",
    "snippet": "int\nvirNetworkUndefine(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkUndefine) {\n        int ret;\n        ret = conn->networkDriver->networkUndefine(network);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "network->conn"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkUndefine",
          "args": [
            "network"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "networkUndefine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3751-3806",
          "snippet": "static int\nnetworkUndefine(virNetworkPtr net)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n    bool active = false;\n    virObjectEventPtr event = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkUndefineEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (virNetworkObjIsActive(obj))\n        active = true;\n\n    if (!virNetworkObjIsPersistent(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"can't undefine transient network\"));\n        goto cleanup;\n    }\n\n    /* remove autostart link */\n    if (virNetworkObjDeleteConfig(driver->networkConfigDir,\n                                  driver->networkAutostartDir,\n                                  obj) < 0)\n        goto cleanup;\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_UNDEFINED,\n                                        0);\n\n    VIR_INFO(\"Undefining network '%s'\", def->name);\n    if (!active) {\n        if (networkRemoveInactive(driver, obj) < 0)\n            goto cleanup;\n    } else {\n\n        /* if the network still exists, it was active, and we need to make\n         * it transient (by deleting the persistent def)\n         */\n        virNetworkObjUpdateAssignDef(obj, NULL, false);\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic int\nnetworkUndefine(virNetworkPtr net)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    int ret = -1;\n    bool active = false;\n    virObjectEventPtr event = NULL;\n\n    if (!(obj = networkObjFromNetwork(net)))\n        goto cleanup;\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkUndefineEnsureACL(net->conn, def) < 0)\n        goto cleanup;\n\n    if (virNetworkObjIsActive(obj))\n        active = true;\n\n    if (!virNetworkObjIsPersistent(obj)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"can't undefine transient network\"));\n        goto cleanup;\n    }\n\n    /* remove autostart link */\n    if (virNetworkObjDeleteConfig(driver->networkConfigDir,\n                                  driver->networkAutostartDir,\n                                  obj) < 0)\n        goto cleanup;\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_UNDEFINED,\n                                        0);\n\n    VIR_INFO(\"Undefining network '%s'\", def->name);\n    if (!active) {\n        if (networkRemoveInactive(driver, obj) < 0)\n            goto cleanup;\n    } else {\n\n        /* if the network still exists, it was active, and we need to make\n         * it transient (by deleting the persistent def)\n         */\n        virNetworkObjUpdateAssignDef(obj, NULL, false);\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "network",
            "-1"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"network=%p\"",
            "network"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkUndefine(virNetworkPtr network)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p\", network);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(network, -1);\n    conn = network->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkUndefine) {\n        int ret;\n        ret = conn->networkDriver->networkUndefine(network);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "441-465",
    "snippet": "virNetworkPtr\nvirNetworkDefineXML(virConnectPtr conn, const char *xml)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkDefineXML) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkDefineXML(conn, xml);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkDefineXML",
          "args": [
            "conn",
            "xml"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "networkDefineXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3695-3748",
          "snippet": "static virNetworkPtr\nnetworkDefineXML(virConnectPtr conn,\n                 const char *xml)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkDefPtr def = NULL;\n    bool freeDef = true;\n    virNetworkObjPtr obj = NULL;\n    virNetworkPtr net = NULL;\n    virObjectEventPtr event = NULL;\n\n    if (!(def = virNetworkDefParseString(xml, network_driver->xmlopt)))\n        goto cleanup;\n\n    if (virNetworkDefineXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (networkValidate(driver, def) < 0)\n        goto cleanup;\n\n    if (!(obj = virNetworkObjAssignDef(driver->networks, def, 0)))\n        goto cleanup;\n\n    /* def was assigned to network object */\n    freeDef = false;\n\n    if (virNetworkSaveConfig(driver->networkConfigDir,\n                             def, network_driver->xmlopt) < 0) {\n        if (!virNetworkObjIsActive(obj)) {\n            virNetworkObjRemoveInactive(driver->networks, obj);\n            goto cleanup;\n        }\n        /* if network was active already, just undo new persistent\n         * definition by making it transient.\n         * XXX - this isn't necessarily the correct thing to do.\n         */\n        virNetworkObjUpdateAssignDef(obj, NULL, false);\n        goto cleanup;\n    }\n\n    event = virNetworkEventLifecycleNew(def->name, def->uuid,\n                                        VIR_NETWORK_EVENT_DEFINED,\n                                        0);\n\n    VIR_INFO(\"Defining network '%s'\", def->name);\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    if (freeDef)\n        virNetworkDefFree(def);\n    virNetworkObjEndAPI(&obj);\n    return net;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNetworkDriverStatePtr network_driver;",
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNetworkDriverStatePtr network_driver;\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic virNetworkPtr\nnetworkDefineXML(virConnectPtr conn,\n                 const char *xml)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkDefPtr def = NULL;\n    bool freeDef = true;\n    virNetworkObjPtr obj = NULL;\n    virNetworkPtr net = NULL;\n    virObjectEventPtr event = NULL;\n\n    if (!(def = virNetworkDefParseString(xml, network_driver->xmlopt)))\n        goto cleanup;\n\n    if (virNetworkDefineXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (networkValidate(driver, def) < 0)\n        goto cleanup;\n\n    if (!(obj = virNetworkObjAssignDef(driver->networks, def, 0)))\n        goto cleanup;\n\n    /* def was assigned to network object */\n    freeDef = false;\n\n    if (virNetworkSaveConfig(driver->networkConfigDir,\n                             def, network_driver->xmlopt) < 0) {\n        if (!virNetworkObjIsActive(obj)) {\n            virNetworkObjRemoveInactive(driver->networks, obj);\n            goto cleanup;\n        }\n        /* if network was active already, just undo new persistent\n         * definition by making it transient.\n         * XXX - this isn't necessarily the correct thing to do.\n         */\n        virNetworkObjUpdateAssignDef(obj, NULL, false);\n        goto cleanup;\n    }\n\n    event = virNetworkEventLifecycleNew(def->name, def->uuid,\n                                        VIR_NETWORK_EVENT_DEFINED,\n                                        0);\n\n    VIR_INFO(\"Defining network '%s'\", def->name);\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virObjectEventStateQueue(driver->networkEventState, event);\n    if (freeDef)\n        virNetworkDefFree(def);\n    virNetworkObjEndAPI(&obj);\n    return net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xml=%s\"",
            "conn",
            "NULLSTR(xml)"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkDefineXML(virConnectPtr conn, const char *xml)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkDefineXML) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkDefineXML(conn, xml);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "401-425",
    "snippet": "virNetworkPtr\nvirNetworkCreateXML(virConnectPtr conn, const char *xmlDesc)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s\", conn, NULLSTR(xmlDesc));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkCreateXML) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkCreateXML(conn, xmlDesc);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkCreateXML",
          "args": [
            "conn",
            "xmlDesc"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "networkCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3643-3692",
          "snippet": "static virNetworkPtr\nnetworkCreateXML(virConnectPtr conn,\n                 const char *xml)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkDefPtr newDef;\n    virNetworkObjPtr obj = NULL;\n    virNetworkDefPtr def;\n    virNetworkPtr net = NULL;\n    virObjectEventPtr event = NULL;\n\n    if (!(newDef = virNetworkDefParseString(xml, network_driver->xmlopt)))\n        goto cleanup;\n\n    if (virNetworkCreateXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if (networkValidate(driver, newDef) < 0)\n        goto cleanup;\n\n    /* NB: even though this transient network hasn't yet been started,\n     * we assign the def with live = true in anticipation that it will\n     * be started momentarily.\n     */\n    if (!(obj = virNetworkObjAssignDef(driver->networks, newDef,\n                                       VIR_NETWORK_OBJ_LIST_ADD_LIVE |\n                                       VIR_NETWORK_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    newDef = NULL;\n    def = virNetworkObjGetDef(obj);\n\n    if (networkStartNetwork(driver, obj) < 0) {\n        virNetworkObjRemoveInactive(driver->networks, obj);\n        goto cleanup;\n    }\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_STARTED,\n                                        0);\n\n    VIR_INFO(\"Creating network '%s'\", def->name);\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virNetworkDefFree(newDef);\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return net;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNetworkDriverStatePtr network_driver;",
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNetworkDriverStatePtr network_driver;\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic virNetworkPtr\nnetworkCreateXML(virConnectPtr conn,\n                 const char *xml)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkDefPtr newDef;\n    virNetworkObjPtr obj = NULL;\n    virNetworkDefPtr def;\n    virNetworkPtr net = NULL;\n    virObjectEventPtr event = NULL;\n\n    if (!(newDef = virNetworkDefParseString(xml, network_driver->xmlopt)))\n        goto cleanup;\n\n    if (virNetworkCreateXMLEnsureACL(conn, newDef) < 0)\n        goto cleanup;\n\n    if (networkValidate(driver, newDef) < 0)\n        goto cleanup;\n\n    /* NB: even though this transient network hasn't yet been started,\n     * we assign the def with live = true in anticipation that it will\n     * be started momentarily.\n     */\n    if (!(obj = virNetworkObjAssignDef(driver->networks, newDef,\n                                       VIR_NETWORK_OBJ_LIST_ADD_LIVE |\n                                       VIR_NETWORK_OBJ_LIST_ADD_CHECK_LIVE)))\n        goto cleanup;\n    newDef = NULL;\n    def = virNetworkObjGetDef(obj);\n\n    if (networkStartNetwork(driver, obj) < 0) {\n        virNetworkObjRemoveInactive(driver->networks, obj);\n        goto cleanup;\n    }\n\n    event = virNetworkEventLifecycleNew(def->name,\n                                        def->uuid,\n                                        VIR_NETWORK_EVENT_STARTED,\n                                        0);\n\n    VIR_INFO(\"Creating network '%s'\", def->name);\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virNetworkDefFree(newDef);\n    virObjectEventStateQueue(driver->networkEventState, event);\n    virNetworkObjEndAPI(&obj);\n    return net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xmlDesc=%s\"",
            "conn",
            "NULLSTR(xmlDesc)"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkCreateXML(virConnectPtr conn, const char *xmlDesc)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s\", conn, NULLSTR(xmlDesc));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkCreateXML) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkCreateXML(conn, xmlDesc);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkLookupByUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "362-385",
    "snippet": "virNetworkPtr\nvirNetworkLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNetworkLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkLookupByUUID",
          "args": [
            "conn",
            "&uuid[0]"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkLookupByUUIDString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
          "lines": "362-385",
          "snippet": "virNetworkPtr\nvirNetworkLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNetworkLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "uuidstr",
            "_(\"uuidstr in %s must be a valid UUID\")",
            "__FUNCTION__"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"uuidstr in %s must be a valid UUID\""
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuidstr",
            "uuid"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuidstr",
            "error"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, uuidstr=%s\"",
            "conn",
            "NULLSTR(uuidstr)"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uuidstr"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr,\n                            _(\"uuidstr in %s must be a valid UUID\"),\n                            __FUNCTION__);\n        goto error;\n    }\n\n    return virNetworkLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "326-349",
    "snippet": "virNetworkPtr\nvirNetworkLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkLookupByUUID) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkLookupByUUID",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "networkLookupByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3052-3080",
          "snippet": "static virNetworkPtr\nnetworkLookupByUUID(virConnectPtr conn,\n                    const unsigned char *uuid)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPtr net = NULL;\n\n    obj = virNetworkObjFindByUUID(driver->networks, uuid);\n    if (!obj) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NETWORK,\n                       _(\"no network with matching uuid '%s'\"),\n                       uuidstr);\n        goto cleanup;\n    }\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return net;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic virNetworkPtr\nnetworkLookupByUUID(virConnectPtr conn,\n                    const unsigned char *uuid)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPtr net = NULL;\n\n    obj = virNetworkObjFindByUUID(driver->networks, uuid);\n    if (!obj) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NETWORK,\n                       _(\"no network with matching uuid '%s'\"),\n                       uuidstr);\n        goto cleanup;\n    }\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_UUID_DEBUG",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkLookupByUUID) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetworkLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "287-310",
    "snippet": "virNetworkPtr\nvirNetworkLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkLookupByName) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->networkLookupByName",
          "args": [
            "conn",
            "name"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "networkLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/network/bridge_driver.c",
          "lines": "3083-3108",
          "snippet": "static virNetworkPtr\nnetworkLookupByName(virConnectPtr conn,\n                    const char *name)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPtr net = NULL;\n\n    obj = virNetworkObjFindByName(driver->networks, name);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NETWORK,\n                       _(\"no network with matching name '%s'\"), name);\n        goto cleanup;\n    }\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return net;\n}",
          "includes": [
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virjson.h\"",
            "#include \"virhook.h\"",
            "#include \"network_event.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virdbus.h\"",
            "#include \"virpci.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include \"configmake.h\"",
            "#include \"virdnsmasq.h\"",
            "#include \"virlog.h\"",
            "#include \"viriptables.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virbuffer.h\"",
            "#include \"driver.h\"",
            "#include \"device_conf.h\"",
            "#include \"bridge_driver_platform.h\"",
            "#include \"bridge_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "# include <sys/sysctl.h>",
            "#include <net/if.h>",
            "#include <sys/ioctl.h>",
            "#include <pwd.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/utsname.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);",
            "static int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);",
            "static int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);",
            "static void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netdev_bandwidth_conf.h\"\n#include \"virutil.h\"\n#include \"virnetworkportdef.h\"\n#include \"virjson.h\"\n#include \"virhook.h\"\n#include \"network_event.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virdbus.h\"\n#include \"virpci.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include \"configmake.h\"\n#include \"virdnsmasq.h\"\n#include \"virlog.h\"\n#include \"viriptables.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virpidfile.h\"\n#include \"virbuffer.h\"\n#include \"driver.h\"\n#include \"device_conf.h\"\n#include \"bridge_driver_platform.h\"\n#include \"bridge_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n# include <sys/sysctl.h>\n#include <net/if.h>\n#include <sys/ioctl.h>\n#include <pwd.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/utsname.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nnetworkStartNetwork(virNetworkDriverStatePtr driver,\n                    virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetwork(virNetworkDriverStatePtr driver,\n                       virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkVirtual(virNetworkDriverStatePtr driver,\n                           virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkVirtual(virNetworkDriverStatePtr driver,\n                              virNetworkObjPtr obj);\nstatic int\nnetworkStartNetworkExternal(virNetworkObjPtr obj);\nstatic int\nnetworkShutdownNetworkExternal(virNetworkObjPtr obj);\nstatic void\nnetworkRefreshDaemons(virNetworkDriverStatePtr driver);\n\nstatic virNetworkPtr\nnetworkLookupByName(virConnectPtr conn,\n                    const char *name)\n{\n    virNetworkDriverStatePtr driver = networkGetDriver();\n    virNetworkObjPtr obj;\n    virNetworkDefPtr def;\n    virNetworkPtr net = NULL;\n\n    obj = virNetworkObjFindByName(driver->networks, name);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NETWORK,\n                       _(\"no network with matching name '%s'\"), name);\n        goto cleanup;\n    }\n    def = virNetworkObjGetDef(obj);\n\n    if (virNetworkLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    net = virGetNetwork(conn, def->name, def->uuid);\n\n cleanup:\n    virNetworkObjEndAPI(&obj);\n    return net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "error"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s\"",
            "conn",
            "NULLSTR(name)"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkLookupByName) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectListDefinedNetworks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "246-271",
    "snippet": "int\nvirConnectListDefinedNetworks(virConnectPtr conn, char **const names,\n                              int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->networkDriver && conn->networkDriver->connectListDefinedNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectListDefinedNetworks(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectListDefinedNetworks",
          "args": [
            "conn",
            "names",
            "maxnames"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, names=%p, maxnames=%d\"",
            "conn",
            "names",
            "maxnames"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListDefinedNetworks(virConnectPtr conn, char **const names,\n                              int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->networkDriver && conn->networkDriver->connectListDefinedNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectListDefinedNetworks(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNumOfDefinedNetworks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "205-227",
    "snippet": "int\nvirConnectNumOfDefinedNetworks(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->networkDriver && conn->networkDriver->connectNumOfDefinedNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectNumOfDefinedNetworks(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectNumOfDefinedNetworks",
          "args": [
            "conn"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNumOfDefinedNetworks(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->networkDriver && conn->networkDriver->connectNumOfDefinedNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectNumOfDefinedNetworks(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListNetworks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "170-194",
    "snippet": "int\nvirConnectListNetworks(virConnectPtr conn, char **const names, int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->networkDriver && conn->networkDriver->connectListNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectListNetworks(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectListNetworks",
          "args": [
            "conn",
            "names",
            "maxnames"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, names=%p, maxnames=%d\"",
            "conn",
            "names",
            "maxnames"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListNetworks(virConnectPtr conn, char **const names, int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->networkDriver && conn->networkDriver->connectListNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectListNetworks(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNumOfNetworks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "129-151",
    "snippet": "int\nvirConnectNumOfNetworks(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->networkDriver && conn->networkDriver->connectNumOfNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectNumOfNetworks(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectNumOfNetworks",
          "args": [
            "conn"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectNumOfNetworks(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->networkDriver && conn->networkDriver->connectNumOfNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectNumOfNetworks(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListAllNetworks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "90-118",
    "snippet": "int\nvirConnectListAllNetworks(virConnectPtr conn,\n                          virNetworkPtr **nets,\n                          unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, nets=%p, flags=0x%x\", conn, nets, flags);\n\n    virResetLastError();\n\n    if (nets)\n        *nets = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->networkDriver &&\n        conn->networkDriver->connectListAllNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectListAllNetworks(conn, nets, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->networkDriver->connectListAllNetworks",
          "args": [
            "conn",
            "nets",
            "flags"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, nets=%p, flags=0x%x\"",
            "conn",
            "nets",
            "flags"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirConnectListAllNetworks(virConnectPtr conn,\n                          virNetworkPtr **nets,\n                          unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, nets=%p, flags=0x%x\", conn, nets, flags);\n\n    virResetLastError();\n\n    if (nets)\n        *nets = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->networkDriver &&\n        conn->networkDriver->connectListAllNetworks) {\n        int ret;\n        ret = conn->networkDriver->connectListAllNetworks(conn, nets, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virNetworkGetConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
    "lines": "42-52",
    "snippet": "virConnectPtr\nvirNetworkGetConnect(virNetworkPtr net)\n{\n    VIR_DEBUG(\"net=%p\", net);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n\n    return net->conn;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckNetworkReturn",
          "args": [
            "net",
            "NULL"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"net=%p\"",
            "net"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirConnectPtr\nvirNetworkGetConnect(virNetworkPtr net)\n{\n    VIR_DEBUG(\"net=%p\", net);\n\n    virResetLastError();\n\n    virCheckNetworkReturn(net, NULL);\n\n    return net->conn;\n}"
  }
]