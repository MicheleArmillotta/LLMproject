[
  {
    "function_name": "interfaceRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/interface/interface_driver.c",
    "lines": "25-39",
    "snippet": "int\ninterfaceRegister(void)\n{\n#ifdef WITH_NETCF\n    /* Attempt to load the netcf based backend first */\n    if (netcfIfaceRegister() == 0)\n        return 0;\n#endif /* WITH_NETCF */\n#if WITH_UDEV\n    /* If there's no netcf or it failed to load, register the udev backend */\n    if (udevIfaceRegister() == 0)\n        return 0;\n#endif /* WITH_UDEV */\n    return -1;\n}",
    "includes": [
      "#include \"interface_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "udevIfaceRegister",
          "args": [],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "udevIfaceRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/interface/interface_backend_udev.c",
          "lines": "1308-1321",
          "snippet": "int\nudevIfaceRegister(void)\n{\n    if (virRegisterConnectDriver(&udevConnectDriver, false) < 0)\n        return -1;\n    if (virSetSharedInterfaceDriver(&udevIfaceDriver) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to register udev interface driver\"));\n        return -1;\n    }\n    if (virRegisterStateDriver(&interfaceStateDriver) < 0)\n        return -1;\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"interface_driver.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include <libudev.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct udev_iface_driver *driver;",
            "static virInterfaceDriver udevIfaceDriver = {\n    .name = \"udev\",\n    .connectNumOfInterfaces = udevConnectNumOfInterfaces, /* 1.0.0 */\n    .connectListInterfaces = udevConnectListInterfaces, /* 1.0.0 */\n    .connectNumOfDefinedInterfaces = udevConnectNumOfDefinedInterfaces, /* 1.0.0 */\n    .connectListDefinedInterfaces = udevConnectListDefinedInterfaces, /* 1.0.0 */\n    .connectListAllInterfaces = udevConnectListAllInterfaces, /* 1.0.0 */\n    .interfaceLookupByName = udevInterfaceLookupByName, /* 1.0.0 */\n    .interfaceLookupByMACString = udevInterfaceLookupByMACString, /* 1.0.0 */\n    .interfaceIsActive = udevInterfaceIsActive, /* 1.0.0 */\n    .interfaceGetXMLDesc = udevInterfaceGetXMLDesc, /* 1.0.0 */\n};",
            "static virConnectDriver udevConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"interface\", NULL },\n    .hypervisorDriver = &udevHypervisorDriver,\n    .interfaceDriver = &udevIfaceDriver,\n};",
            "static virStateDriver interfaceStateDriver = {\n    .name = \"udev\",\n    .stateInitialize = udevStateInitialize,\n    .stateCleanup = udevStateCleanup,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virnetdev.h\"\n#include \"virinterfaceobj.h\"\n#include \"viraccessapicheck.h\"\n#include \"virpidfile.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"interface_driver.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include <libudev.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic struct udev_iface_driver *driver;\nstatic virInterfaceDriver udevIfaceDriver = {\n    .name = \"udev\",\n    .connectNumOfInterfaces = udevConnectNumOfInterfaces, /* 1.0.0 */\n    .connectListInterfaces = udevConnectListInterfaces, /* 1.0.0 */\n    .connectNumOfDefinedInterfaces = udevConnectNumOfDefinedInterfaces, /* 1.0.0 */\n    .connectListDefinedInterfaces = udevConnectListDefinedInterfaces, /* 1.0.0 */\n    .connectListAllInterfaces = udevConnectListAllInterfaces, /* 1.0.0 */\n    .interfaceLookupByName = udevInterfaceLookupByName, /* 1.0.0 */\n    .interfaceLookupByMACString = udevInterfaceLookupByMACString, /* 1.0.0 */\n    .interfaceIsActive = udevInterfaceIsActive, /* 1.0.0 */\n    .interfaceGetXMLDesc = udevInterfaceGetXMLDesc, /* 1.0.0 */\n};\nstatic virConnectDriver udevConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"interface\", NULL },\n    .hypervisorDriver = &udevHypervisorDriver,\n    .interfaceDriver = &udevIfaceDriver,\n};\nstatic virStateDriver interfaceStateDriver = {\n    .name = \"udev\",\n    .stateInitialize = udevStateInitialize,\n    .stateCleanup = udevStateCleanup,\n};\n\nint\nudevIfaceRegister(void)\n{\n    if (virRegisterConnectDriver(&udevConnectDriver, false) < 0)\n        return -1;\n    if (virSetSharedInterfaceDriver(&udevIfaceDriver) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to register udev interface driver\"));\n        return -1;\n    }\n    if (virRegisterStateDriver(&interfaceStateDriver) < 0)\n        return -1;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "netcfIfaceRegister",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "netcfIfaceRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/interface/interface_backend_netcf.c",
          "lines": "1245-1254",
          "snippet": "int netcfIfaceRegister(void)\n{\n    if (virRegisterConnectDriver(&interfaceConnectDriver, false) < 0)\n        return -1;\n    if (virSetSharedInterfaceDriver(&interfaceDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&interfaceStateDriver) < 0)\n        return -1;\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"interface_driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <netcf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virInterfaceDriver interfaceDriver = {\n    .name = INTERFACE_DRIVER_NAME,\n    .connectNumOfInterfaces = netcfConnectNumOfInterfaces, /* 0.7.0 */\n    .connectListInterfaces = netcfConnectListInterfaces, /* 0.7.0 */\n    .connectNumOfDefinedInterfaces = netcfConnectNumOfDefinedInterfaces, /* 0.7.0 */\n    .connectListDefinedInterfaces = netcfConnectListDefinedInterfaces, /* 0.7.0 */\n    .connectListAllInterfaces = netcfConnectListAllInterfaces, /* 0.10.2 */\n    .interfaceLookupByName = netcfInterfaceLookupByName, /* 0.7.0 */\n    .interfaceLookupByMACString = netcfInterfaceLookupByMACString, /* 0.7.0 */\n    .interfaceGetXMLDesc = netcfInterfaceGetXMLDesc, /* 0.7.0 */\n    .interfaceDefineXML = netcfInterfaceDefineXML, /* 0.7.0 */\n    .interfaceUndefine = netcfInterfaceUndefine, /* 0.7.0 */\n    .interfaceCreate = netcfInterfaceCreate, /* 0.7.0 */\n    .interfaceDestroy = netcfInterfaceDestroy, /* 0.7.0 */\n    .interfaceIsActive = netcfInterfaceIsActive, /* 0.7.3 */\n    .interfaceChangeBegin = netcfInterfaceChangeBegin, /* 0.9.2 */\n    .interfaceChangeCommit = netcfInterfaceChangeCommit, /* 0.9.2 */\n    .interfaceChangeRollback = netcfInterfaceChangeRollback, /* 0.9.2 */\n};",
            "static virConnectDriver interfaceConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"interface\", NULL },\n    .hypervisorDriver = &interfaceHypervisorDriver,\n    .interfaceDriver = &interfaceDriver,\n};",
            "static virStateDriver interfaceStateDriver = {\n    .name = INTERFACE_DRIVER_NAME,\n    .stateInitialize = netcfStateInitialize,\n    .stateCleanup = netcfStateCleanup,\n    .stateReload = netcfStateReload,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virinterfaceobj.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"interface_driver.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <netcf.h>\n#include <config.h>\n\nstatic virInterfaceDriver interfaceDriver = {\n    .name = INTERFACE_DRIVER_NAME,\n    .connectNumOfInterfaces = netcfConnectNumOfInterfaces, /* 0.7.0 */\n    .connectListInterfaces = netcfConnectListInterfaces, /* 0.7.0 */\n    .connectNumOfDefinedInterfaces = netcfConnectNumOfDefinedInterfaces, /* 0.7.0 */\n    .connectListDefinedInterfaces = netcfConnectListDefinedInterfaces, /* 0.7.0 */\n    .connectListAllInterfaces = netcfConnectListAllInterfaces, /* 0.10.2 */\n    .interfaceLookupByName = netcfInterfaceLookupByName, /* 0.7.0 */\n    .interfaceLookupByMACString = netcfInterfaceLookupByMACString, /* 0.7.0 */\n    .interfaceGetXMLDesc = netcfInterfaceGetXMLDesc, /* 0.7.0 */\n    .interfaceDefineXML = netcfInterfaceDefineXML, /* 0.7.0 */\n    .interfaceUndefine = netcfInterfaceUndefine, /* 0.7.0 */\n    .interfaceCreate = netcfInterfaceCreate, /* 0.7.0 */\n    .interfaceDestroy = netcfInterfaceDestroy, /* 0.7.0 */\n    .interfaceIsActive = netcfInterfaceIsActive, /* 0.7.3 */\n    .interfaceChangeBegin = netcfInterfaceChangeBegin, /* 0.9.2 */\n    .interfaceChangeCommit = netcfInterfaceChangeCommit, /* 0.9.2 */\n    .interfaceChangeRollback = netcfInterfaceChangeRollback, /* 0.9.2 */\n};\nstatic virConnectDriver interfaceConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"interface\", NULL },\n    .hypervisorDriver = &interfaceHypervisorDriver,\n    .interfaceDriver = &interfaceDriver,\n};\nstatic virStateDriver interfaceStateDriver = {\n    .name = INTERFACE_DRIVER_NAME,\n    .stateInitialize = netcfStateInitialize,\n    .stateCleanup = netcfStateCleanup,\n    .stateReload = netcfStateReload,\n};\n\nint netcfIfaceRegister(void)\n{\n    if (virRegisterConnectDriver(&interfaceConnectDriver, false) < 0)\n        return -1;\n    if (virSetSharedInterfaceDriver(&interfaceDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&interfaceStateDriver) < 0)\n        return -1;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"interface_driver.h\"\n#include <config.h>\n\nint\ninterfaceRegister(void)\n{\n#ifdef WITH_NETCF\n    /* Attempt to load the netcf based backend first */\n    if (netcfIfaceRegister() == 0)\n        return 0;\n#endif /* WITH_NETCF */\n#if WITH_UDEV\n    /* If there's no netcf or it failed to load, register the udev backend */\n    if (udevIfaceRegister() == 0)\n        return 0;\n#endif /* WITH_UDEV */\n    return -1;\n}"
  }
]