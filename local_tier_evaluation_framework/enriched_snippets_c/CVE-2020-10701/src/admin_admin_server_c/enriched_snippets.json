[
  {
    "function_name": "adminServerUpdateTlsFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "371-378",
    "snippet": "int\nadminServerUpdateTlsFiles(virNetServerPtr srv,\n                          unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    return virNetServerUpdateTlsFiles(srv);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerUpdateTlsFiles",
          "args": [
            "srv"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerUpdateTlsFiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1228-1257",
          "snippet": "int\nvirNetServerUpdateTlsFiles(virNetServerPtr srv)\n{\n    int ret = -1;\n    virNetTLSContextPtr ctxt = NULL;\n    bool privileged = geteuid() == 0 ? true : false;\n\n    ctxt = virNetServerGetTLSContext(srv);\n    if (!ctxt) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no tls service found, unable to update tls files\"));\n        return -1;\n    }\n\n    virObjectLock(srv);\n    virObjectLock(ctxt);\n\n    if (virNetTLSContextReloadForServer(ctxt, !privileged)) {\n        VIR_DEBUG(\"failed to reload server's tls context\");\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"update tls files success\");\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ctxt);\n    virObjectUnlock(srv);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nint\nvirNetServerUpdateTlsFiles(virNetServerPtr srv)\n{\n    int ret = -1;\n    virNetTLSContextPtr ctxt = NULL;\n    bool privileged = geteuid() == 0 ? true : false;\n\n    ctxt = virNetServerGetTLSContext(srv);\n    if (!ctxt) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no tls service found, unable to update tls files\"));\n        return -1;\n    }\n\n    virObjectLock(srv);\n    virObjectLock(ctxt);\n\n    if (virNetTLSContextReloadForServer(ctxt, !privileged)) {\n        VIR_DEBUG(\"failed to reload server's tls context\");\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"update tls files success\");\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ctxt);\n    virObjectUnlock(srv);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminServerUpdateTlsFiles(virNetServerPtr srv,\n                          unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    return virNetServerUpdateTlsFiles(srv);\n}"
  },
  {
    "function_name": "adminServerSetClientLimits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "336-369",
    "snippet": "int\nadminServerSetClientLimits(virNetServerPtr srv,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    long long int maxClients = -1;\n    long long int maxClientsUnauth = -1;\n    virTypedParameterPtr param = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_SERVER_CLIENTS_MAX,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_SERVER_CLIENTS_UNAUTH_MAX,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_SERVER_CLIENTS_MAX)))\n        maxClients = param->value.ui;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_SERVER_CLIENTS_UNAUTH_MAX)))\n        maxClientsUnauth = param->value.ui;\n\n    if (virNetServerSetClientLimits(srv, maxClients,\n                                    maxClientsUnauth) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerSetClientLimits",
          "args": [
            "srv",
            "maxClients",
            "maxClientsUnauth"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerSetClientLimits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1174-1208",
          "snippet": "int\nvirNetServerSetClientLimits(virNetServerPtr srv,\n                            long long int maxClients,\n                            long long int maxClientsUnauth)\n{\n    int ret = -1;\n    size_t max, max_unauth;\n\n    virObjectLock(srv);\n\n    max = maxClients >= 0 ? maxClients : srv->nclients_max;\n    max_unauth = maxClientsUnauth >= 0 ?\n        maxClientsUnauth : srv->nclients_unauth_max;\n\n    if (max < max_unauth) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"The overall maximum number of clients must be \"\n                         \"greater than the maximum number of clients waiting \"\n                         \"for authentication\"));\n        goto cleanup;\n    }\n\n    if (maxClients >= 0)\n        srv->nclients_max = maxClients;\n\n    if (maxClientsUnauth >= 0)\n        srv->nclients_unauth_max = maxClientsUnauth;\n\n    virNetServerCheckLimits(srv);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(srv);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nint\nvirNetServerSetClientLimits(virNetServerPtr srv,\n                            long long int maxClients,\n                            long long int maxClientsUnauth)\n{\n    int ret = -1;\n    size_t max, max_unauth;\n\n    virObjectLock(srv);\n\n    max = maxClients >= 0 ? maxClients : srv->nclients_max;\n    max_unauth = maxClientsUnauth >= 0 ?\n        maxClientsUnauth : srv->nclients_unauth_max;\n\n    if (max < max_unauth) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"The overall maximum number of clients must be \"\n                         \"greater than the maximum number of clients waiting \"\n                         \"for authentication\"));\n        goto cleanup;\n    }\n\n    if (maxClients >= 0)\n        srv->nclients_max = maxClients;\n\n    if (maxClientsUnauth >= 0)\n        srv->nclients_unauth_max = maxClientsUnauth;\n\n    virNetServerCheckLimits(srv);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(srv);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "VIR_SERVER_CLIENTS_UNAUTH_MAX"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_SERVER_CLIENTS_MAX",
            "VIR_TYPED_PARAM_UINT",
            "VIR_SERVER_CLIENTS_UNAUTH_MAX",
            "VIR_TYPED_PARAM_UINT",
            "NULL"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminServerSetClientLimits(virNetServerPtr srv,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    long long int maxClients = -1;\n    long long int maxClientsUnauth = -1;\n    virTypedParameterPtr param = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_SERVER_CLIENTS_MAX,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_SERVER_CLIENTS_UNAUTH_MAX,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_SERVER_CLIENTS_MAX)))\n        maxClients = param->value.ui;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_SERVER_CLIENTS_UNAUTH_MAX)))\n        maxClientsUnauth = param->value.ui;\n\n    if (virNetServerSetClientLimits(srv, maxClients,\n                                    maxClientsUnauth) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "adminServerGetClientLimits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "301-334",
    "snippet": "int\nadminServerGetClientLimits(virNetServerPtr srv,\n                           virTypedParameterPtr *params,\n                           int *nparams,\n                           unsigned int flags)\n{\n    g_autoptr(virTypedParamList) paramlist = g_new0(virTypedParamList, 1);\n\n    virCheckFlags(0, -1);\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetMaxClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_MAX) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetCurrentClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_CURRENT) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetMaxUnauthClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_UNAUTH_MAX) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetCurrentUnauthClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_UNAUTH_CURRENT) < 0)\n        return -1;\n\n    *nparams = virTypedParamListStealParams(paramlist, params);\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamListStealParams",
          "args": [
            "paramlist",
            "params"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListStealParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "737-748",
          "snippet": "size_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nsize_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddUInt",
          "args": [
            "paramlist",
            "virNetServerGetCurrentUnauthClients(srv)",
            "\"%s\"",
            "VIR_SERVER_CLIENTS_UNAUTH_CURRENT"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListAddUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "799-818",
          "snippet": "int\nvirTypedParamListAddUInt(virTypedParamListPtr list,\n                         unsigned int value,\n                         const char *namefmt,\n                         ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_UINT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddUInt(virTypedParamListPtr list,\n                         unsigned int value,\n                         const char *namefmt,\n                         ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_UINT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetCurrentUnauthClients",
          "args": [
            "srv"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetCurrentUnauthClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1093-1103",
          "snippet": "size_t\nvirNetServerGetCurrentUnauthClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients_unauth;\n    virObjectUnlock(srv);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nsize_t\nvirNetServerGetCurrentUnauthClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients_unauth;\n    virObjectUnlock(srv);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetMaxUnauthClients",
          "args": [
            "srv"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetMaxUnauthClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1081-1091",
          "snippet": "size_t\nvirNetServerGetMaxUnauthClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients_unauth_max;\n    virObjectUnlock(srv);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nsize_t\nvirNetServerGetMaxUnauthClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients_unauth_max;\n    virObjectUnlock(srv);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetCurrentClients",
          "args": [
            "srv"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetCurrentClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1069-1079",
          "snippet": "size_t\nvirNetServerGetCurrentClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients;\n    virObjectUnlock(srv);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nsize_t\nvirNetServerGetCurrentClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients;\n    virObjectUnlock(srv);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetMaxClients",
          "args": [
            "srv"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetMaxClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1057-1067",
          "snippet": "size_t\nvirNetServerGetMaxClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients_max;\n    virObjectUnlock(srv);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nsize_t\nvirNetServerGetMaxClients(virNetServerPtr srv)\n{\n    size_t ret;\n\n    virObjectLock(srv);\n    ret = srv->nclients_max;\n    virObjectUnlock(srv);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virTypedParamList",
            "1"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminServerGetClientLimits(virNetServerPtr srv,\n                           virTypedParameterPtr *params,\n                           int *nparams,\n                           unsigned int flags)\n{\n    g_autoptr(virTypedParamList) paramlist = g_new0(virTypedParamList, 1);\n\n    virCheckFlags(0, -1);\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetMaxClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_MAX) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetCurrentClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_CURRENT) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetMaxUnauthClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_UNAUTH_MAX) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist,\n                                 virNetServerGetCurrentUnauthClients(srv),\n                                 \"%s\", VIR_SERVER_CLIENTS_UNAUTH_CURRENT) < 0)\n        return -1;\n\n    *nparams = virTypedParamListStealParams(paramlist, params);\n\n    return 0;\n}"
  },
  {
    "function_name": "adminClientClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "292-299",
    "snippet": "int adminClientClose(virNetServerClientPtr client,\n                     unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    virNetServerClientClose(client);\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerClientClose",
          "args": [
            "client"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientClose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1060-1066",
          "snippet": "void\nvirNetServerClientClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    virNetServerClientCloseLocked(client);\n    virObjectUnlock(client);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nvoid\nvirNetServerClientClose(virNetServerClientPtr client)\n{\n    virObjectLock(client);\n    virNetServerClientCloseLocked(client);\n    virObjectUnlock(client);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint adminClientClose(virNetServerClientPtr client,\n                     unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    virNetServerClientClose(client);\n    return 0;\n}"
  },
  {
    "function_name": "adminClientGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "200-290",
    "snippet": "int\nadminClientGetInfo(virNetServerClientPtr client,\n                   virTypedParameterPtr *params,\n                   int *nparams,\n                   unsigned int flags)\n{\n    bool readonly;\n    g_autofree char *sock_addr = NULL;\n    const char *attr = NULL;\n    g_autoptr(virTypedParamList) paramlist = g_new0(virTypedParamList, 1);\n    g_autoptr(virIdentity) identity = NULL;\n    int rc;\n\n    virCheckFlags(0, -1);\n\n    if (virNetServerClientGetInfo(client, &readonly,\n                                  &sock_addr, &identity) < 0)\n        return -1;\n\n    if (virTypedParamListAddBoolean(paramlist, readonly,\n                                    \"%s\", VIR_CLIENT_INFO_READONLY) < 0)\n        return -1;\n\n    if ((rc = virIdentityGetSASLUserName(identity, &attr)) < 0)\n        return -1;\n    if (rc == 1 &&\n        virTypedParamListAddString(paramlist, attr,\n                                   \"%s\", VIR_CLIENT_INFO_SASL_USER_NAME) < 0)\n        return -1;\n\n    if (!virNetServerClientIsLocal(client)) {\n        if (virTypedParamListAddString(paramlist, sock_addr,\n                                       \"%s\", VIR_CLIENT_INFO_SOCKET_ADDR) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetX509DName(identity, &attr)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddString(paramlist, attr,\n                                       \"%s\", VIR_CLIENT_INFO_X509_DISTINGUISHED_NAME) < 0)\n            return -1;\n    } else {\n        pid_t pid;\n        uid_t uid;\n        gid_t gid;\n        if ((rc = virIdentityGetUNIXUserID(identity, &uid)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddInt(paramlist, uid,\n                                    \"%s\", VIR_CLIENT_INFO_UNIX_USER_ID) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetUserName(identity, &attr)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddString(paramlist, attr,\n                                       \"%s\", VIR_CLIENT_INFO_UNIX_USER_NAME) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetUNIXGroupID(identity, &gid)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddInt(paramlist, gid,\n                                    \"%s\", VIR_CLIENT_INFO_UNIX_GROUP_ID) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetGroupName(identity, &attr)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddString(paramlist, attr,\n                                       \"%s\", VIR_CLIENT_INFO_UNIX_GROUP_NAME) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetProcessID(identity, &pid)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddInt(paramlist, pid,\n                                    \"%s\", VIR_CLIENT_INFO_UNIX_PROCESS_ID) < 0)\n            return -1;\n    }\n\n    if ((rc = virIdentityGetSELinuxContext(identity, &attr)) < 0)\n        return -1;\n    if (rc == 1 &&\n        virTypedParamListAddString(paramlist, attr,\n                                   \"%s\", VIR_CLIENT_INFO_SELINUX_CONTEXT) < 0)\n        return -1;\n\n    *nparams = virTypedParamListStealParams(paramlist, params);\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamListStealParams",
          "args": [
            "paramlist",
            "params"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListStealParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "737-748",
          "snippet": "size_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nsize_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddString",
          "args": [
            "paramlist",
            "attr",
            "\"%s\"",
            "VIR_CLIENT_INFO_SELINUX_CONTEXT"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListAddString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "865-884",
          "snippet": "int\nvirTypedParamListAddString(virTypedParamListPtr list,\n                           const char *value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_STRING, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddString(virTypedParamListPtr list,\n                           const char *value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_STRING, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityGetSELinuxContext",
          "args": [
            "identity",
            "&attr"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetSELinuxContext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "374-382",
          "snippet": "int virIdentityGetSELinuxContext(virIdentityPtr ident,\n                                 const char **context)\n{\n    *context = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetSELinuxContext(virIdentityPtr ident,\n                                 const char **context)\n{\n    *context = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SELINUX_CONTEXT,\n                                   context);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddInt",
          "args": [
            "paramlist",
            "pid",
            "\"%s\"",
            "VIR_CLIENT_INFO_UNIX_PROCESS_ID"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityGetProcessID",
          "args": [
            "identity",
            "&pid"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetProcessID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "309-326",
          "snippet": "int virIdentityGetProcessID(virIdentityPtr ident,\n                            pid_t *pid)\n{\n    long long val;\n    int rc;\n\n    *pid = 0;\n    rc = virTypedParamsGetLLong(ident->params,\n                                ident->nparams,\n                                VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                &val);\n    if (rc <= 0)\n        return rc;\n\n    *pid = (pid_t)val;\n\n    return 1;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetProcessID(virIdentityPtr ident,\n                            pid_t *pid)\n{\n    long long val;\n    int rc;\n\n    *pid = 0;\n    rc = virTypedParamsGetLLong(ident->params,\n                                ident->nparams,\n                                VIR_CONNECT_IDENTITY_PROCESS_ID,\n                                &val);\n    if (rc <= 0)\n        return rc;\n\n    *pid = (pid_t)val;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityGetGroupName",
          "args": [
            "identity",
            "&attr"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetGroupName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "272-280",
          "snippet": "int virIdentityGetGroupName(virIdentityPtr ident,\n                            const char **groupname)\n{\n    *groupname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetGroupName(virIdentityPtr ident,\n                            const char **groupname)\n{\n    *groupname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_GROUP_NAME,\n                                   groupname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddInt",
          "args": [
            "paramlist",
            "gid",
            "\"%s\"",
            "VIR_CLIENT_INFO_UNIX_GROUP_ID"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityGetUNIXGroupID",
          "args": [
            "identity",
            "&gid"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetUNIXGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "286-303",
          "snippet": "int virIdentityGetUNIXGroupID(virIdentityPtr ident,\n                              gid_t *gid)\n{\n    unsigned long long val;\n    int rc;\n\n    *gid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *gid = (gid_t)val;\n\n    return 1;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUNIXGroupID(virIdentityPtr ident,\n                              gid_t *gid)\n{\n    unsigned long long val;\n    int rc;\n\n    *gid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_GROUP_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *gid = (gid_t)val;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityGetUserName",
          "args": [
            "identity",
            "&attr"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "235-243",
          "snippet": "int virIdentityGetUserName(virIdentityPtr ident,\n                           const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUserName(virIdentityPtr ident,\n                           const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_USER_NAME,\n                                   username);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddInt",
          "args": [
            "paramlist",
            "uid",
            "\"%s\"",
            "VIR_CLIENT_INFO_UNIX_USER_ID"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virIdentityGetUNIXUserID",
          "args": [
            "identity",
            "&uid"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetUNIXUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "249-266",
          "snippet": "int virIdentityGetUNIXUserID(virIdentityPtr ident,\n                             uid_t *uid)\n{\n    unsigned long long val;\n    int rc;\n\n    *uid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *uid = (uid_t)val;\n\n    return 1;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetUNIXUserID(virIdentityPtr ident,\n                             uid_t *uid)\n{\n    unsigned long long val;\n    int rc;\n\n    *uid = -1;\n    rc = virTypedParamsGetULLong(ident->params,\n                                 ident->nparams,\n                                 VIR_CONNECT_IDENTITY_UNIX_USER_ID,\n                                 &val);\n    if (rc <= 0)\n        return rc;\n\n    *uid = (uid_t)val;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityGetX509DName",
          "args": [
            "identity",
            "&attr"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetX509DName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "360-368",
          "snippet": "int virIdentityGetX509DName(virIdentityPtr ident,\n                            const char **dname)\n{\n    *dname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetX509DName(virIdentityPtr ident,\n                            const char **dname)\n{\n    *dname = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_X509_DISTINGUISHED_NAME,\n                                   dname);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientIsLocal",
          "args": [
            "client"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientIsLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "730-738",
          "snippet": "bool virNetServerClientIsLocal(virNetServerClientPtr client)\n{\n    bool local = false;\n    virObjectLock(client);\n    if (client->sock)\n        local = virNetSocketIsLocal(client->sock);\n    virObjectUnlock(client);\n    return local;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nbool virNetServerClientIsLocal(virNetServerClientPtr client)\n{\n    bool local = false;\n    virObjectLock(client);\n    if (client->sock)\n        local = virNetSocketIsLocal(client->sock);\n    virObjectUnlock(client);\n    return local;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virIdentityGetSASLUserName",
          "args": [
            "identity",
            "&attr"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "virIdentityGetSASLUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viridentity.c",
          "lines": "346-354",
          "snippet": "int virIdentityGetSASLUserName(virIdentityPtr ident,\n                               const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"viridentity.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "# include <selinux/selinux.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n# include <selinux/selinux.h>\n#include <unistd.h>\n#include <config.h>\n\nint virIdentityGetSASLUserName(virIdentityPtr ident,\n                               const char **username)\n{\n    *username = NULL;\n    return virTypedParamsGetString(ident->params,\n                                   ident->nparams,\n                                   VIR_CONNECT_IDENTITY_SASL_USER_NAME,\n                                   username);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddBoolean",
          "args": [
            "paramlist",
            "readonly",
            "\"%s\"",
            "VIR_CLIENT_INFO_READONLY"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListAddBoolean",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "887-906",
          "snippet": "int\nvirTypedParamListAddBoolean(virTypedParamListPtr list,\n                            bool value,\n                            const char *namefmt,\n                            ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_BOOLEAN, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddBoolean(virTypedParamListPtr list,\n                            bool value,\n                            const char *namefmt,\n                            ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_BOOLEAN, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerClientGetInfo",
          "args": [
            "client",
            "&readonly",
            "&sock_addr",
            "&identity"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerClientGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserverclient.c",
          "lines": "1652-1683",
          "snippet": "int\nvirNetServerClientGetInfo(virNetServerClientPtr client,\n                          bool *readonly, char **sock_addr,\n                          virIdentityPtr *identity)\n{\n    int ret = -1;\n    const char *addr;\n\n    virObjectLock(client);\n    *readonly = client->readonly;\n\n    if (!(addr = virNetServerClientRemoteAddrStringURI(client))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No network socket associated with client\"));\n        goto cleanup;\n    }\n\n    *sock_addr = g_strdup(addr);\n\n    if (!client->identity) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No identity information available for client\"));\n        goto cleanup;\n    }\n\n    *identity = g_object_ref(client->identity);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(client);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virkeepalive.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserverclient.h\"",
            "#include \"virnetserver.h\"",
            "# include <sasl/sasl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNetServerClientUpdateEvent(virNetServerClientPtr client);",
            "static virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virkeepalive.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virnetserverclient.h\"\n#include \"virnetserver.h\"\n# include <sasl/sasl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNetServerClientUpdateEvent(virNetServerClientPtr client);\nstatic virNetMessagePtr virNetServerClientDispatchRead(virNetServerClientPtr client);\n\nint\nvirNetServerClientGetInfo(virNetServerClientPtr client,\n                          bool *readonly, char **sock_addr,\n                          virIdentityPtr *identity)\n{\n    int ret = -1;\n    const char *addr;\n\n    virObjectLock(client);\n    *readonly = client->readonly;\n\n    if (!(addr = virNetServerClientRemoteAddrStringURI(client))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No network socket associated with client\"));\n        goto cleanup;\n    }\n\n    *sock_addr = g_strdup(addr);\n\n    if (!client->identity) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No identity information available for client\"));\n        goto cleanup;\n    }\n\n    *identity = g_object_ref(client->identity);\n\n    ret = 0;\n cleanup:\n    virObjectUnlock(client);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virTypedParamList",
            "1"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminClientGetInfo(virNetServerClientPtr client,\n                   virTypedParameterPtr *params,\n                   int *nparams,\n                   unsigned int flags)\n{\n    bool readonly;\n    g_autofree char *sock_addr = NULL;\n    const char *attr = NULL;\n    g_autoptr(virTypedParamList) paramlist = g_new0(virTypedParamList, 1);\n    g_autoptr(virIdentity) identity = NULL;\n    int rc;\n\n    virCheckFlags(0, -1);\n\n    if (virNetServerClientGetInfo(client, &readonly,\n                                  &sock_addr, &identity) < 0)\n        return -1;\n\n    if (virTypedParamListAddBoolean(paramlist, readonly,\n                                    \"%s\", VIR_CLIENT_INFO_READONLY) < 0)\n        return -1;\n\n    if ((rc = virIdentityGetSASLUserName(identity, &attr)) < 0)\n        return -1;\n    if (rc == 1 &&\n        virTypedParamListAddString(paramlist, attr,\n                                   \"%s\", VIR_CLIENT_INFO_SASL_USER_NAME) < 0)\n        return -1;\n\n    if (!virNetServerClientIsLocal(client)) {\n        if (virTypedParamListAddString(paramlist, sock_addr,\n                                       \"%s\", VIR_CLIENT_INFO_SOCKET_ADDR) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetX509DName(identity, &attr)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddString(paramlist, attr,\n                                       \"%s\", VIR_CLIENT_INFO_X509_DISTINGUISHED_NAME) < 0)\n            return -1;\n    } else {\n        pid_t pid;\n        uid_t uid;\n        gid_t gid;\n        if ((rc = virIdentityGetUNIXUserID(identity, &uid)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddInt(paramlist, uid,\n                                    \"%s\", VIR_CLIENT_INFO_UNIX_USER_ID) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetUserName(identity, &attr)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddString(paramlist, attr,\n                                       \"%s\", VIR_CLIENT_INFO_UNIX_USER_NAME) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetUNIXGroupID(identity, &gid)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddInt(paramlist, gid,\n                                    \"%s\", VIR_CLIENT_INFO_UNIX_GROUP_ID) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetGroupName(identity, &attr)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddString(paramlist, attr,\n                                       \"%s\", VIR_CLIENT_INFO_UNIX_GROUP_NAME) < 0)\n            return -1;\n\n        if ((rc = virIdentityGetProcessID(identity, &pid)) < 0)\n            return -1;\n        if (rc == 1 &&\n            virTypedParamListAddInt(paramlist, pid,\n                                    \"%s\", VIR_CLIENT_INFO_UNIX_PROCESS_ID) < 0)\n            return -1;\n    }\n\n    if ((rc = virIdentityGetSELinuxContext(identity, &attr)) < 0)\n        return -1;\n    if (rc == 1 &&\n        virTypedParamListAddString(paramlist, attr,\n                                   \"%s\", VIR_CLIENT_INFO_SELINUX_CONTEXT) < 0)\n        return -1;\n\n    *nparams = virTypedParamListStealParams(paramlist, params);\n    return 0;\n}"
  },
  {
    "function_name": "adminServerLookupClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "190-198",
    "snippet": "virNetServerClientPtr\nadminServerLookupClient(virNetServerPtr srv,\n                        unsigned long long id,\n                        unsigned int flags)\n{\n    virCheckFlags(0, NULL);\n\n    return virNetServerGetClient(srv, id);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerGetClient",
          "args": [
            "srv",
            "id"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetClient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1151-1172",
          "snippet": "virNetServerClientPtr\nvirNetServerGetClient(virNetServerPtr srv,\n                      unsigned long long id)\n{\n    size_t i;\n    virNetServerClientPtr ret = NULL;\n\n    virObjectLock(srv);\n\n    for (i = 0; i < srv->nclients; i++) {\n        virNetServerClientPtr client = srv->clients[i];\n        if (virNetServerClientGetID(client) == id)\n            ret = virObjectRef(client);\n    }\n\n    virObjectUnlock(srv);\n\n    if (!ret)\n        virReportError(VIR_ERR_NO_CLIENT,\n                       _(\"No client with matching ID '%llu'\"), id);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nvirNetServerClientPtr\nvirNetServerGetClient(virNetServerPtr srv,\n                      unsigned long long id)\n{\n    size_t i;\n    virNetServerClientPtr ret = NULL;\n\n    virObjectLock(srv);\n\n    for (i = 0; i < srv->nclients; i++) {\n        virNetServerClientPtr client = srv->clients[i];\n        if (virNetServerClientGetID(client) == id)\n            ret = virObjectRef(client);\n    }\n\n    virObjectUnlock(srv);\n\n    if (!ret)\n        virReportError(VIR_ERR_NO_CLIENT,\n                       _(\"No client with matching ID '%llu'\"), id);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nvirNetServerClientPtr\nadminServerLookupClient(virNetServerPtr srv,\n                        unsigned long long id,\n                        unsigned int flags)\n{\n    virCheckFlags(0, NULL);\n\n    return virNetServerGetClient(srv, id);\n}"
  },
  {
    "function_name": "adminServerListClients",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "168-188",
    "snippet": "int\nadminServerListClients(virNetServerPtr srv,\n                       virNetServerClientPtr **clients,\n                       unsigned int flags)\n{\n    int ret = -1;\n    virNetServerClientPtr *clts;\n\n    virCheckFlags(0, -1);\n\n    if ((ret = virNetServerGetClients(srv, &clts)) < 0)\n        return -1;\n\n    if (clients) {\n        *clients = clts;\n        clts = NULL;\n    }\n\n    virObjectListFreeCount(clts, ret);\n    return ret;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFreeCount",
          "args": [
            "clts",
            "ret"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFreeCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "625-638",
          "snippet": "void\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetClients",
          "args": [
            "srv",
            "&clts"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetClients",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1122-1149",
          "snippet": "int\nvirNetServerGetClients(virNetServerPtr srv,\n                       virNetServerClientPtr **clts)\n{\n    int ret = -1;\n    size_t i;\n    size_t nclients = 0;\n    virNetServerClientPtr *list = NULL;\n\n    virObjectLock(srv);\n\n    for (i = 0; i < srv->nclients; i++) {\n        virNetServerClientPtr client = virObjectRef(srv->clients[i]);\n        if (VIR_APPEND_ELEMENT(list, nclients, client) < 0) {\n            virObjectUnref(client);\n            goto cleanup;\n        }\n    }\n\n    *clts = list;\n    list = NULL;\n    ret = nclients;\n\n cleanup:\n    virObjectListFreeCount(list, nclients);\n    virObjectUnlock(srv);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nint\nvirNetServerGetClients(virNetServerPtr srv,\n                       virNetServerClientPtr **clts)\n{\n    int ret = -1;\n    size_t i;\n    size_t nclients = 0;\n    virNetServerClientPtr *list = NULL;\n\n    virObjectLock(srv);\n\n    for (i = 0; i < srv->nclients; i++) {\n        virNetServerClientPtr client = virObjectRef(srv->clients[i]);\n        if (VIR_APPEND_ELEMENT(list, nclients, client) < 0) {\n            virObjectUnref(client);\n            goto cleanup;\n        }\n    }\n\n    *clts = list;\n    list = NULL;\n    ret = nclients;\n\n cleanup:\n    virObjectListFreeCount(list, nclients);\n    virObjectUnlock(srv);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminServerListClients(virNetServerPtr srv,\n                       virNetServerClientPtr **clients,\n                       unsigned int flags)\n{\n    int ret = -1;\n    virNetServerClientPtr *clts;\n\n    virCheckFlags(0, -1);\n\n    if ((ret = virNetServerGetClients(srv, &clts)) < 0)\n        return -1;\n\n    if (clients) {\n        *clients = clts;\n        clts = NULL;\n    }\n\n    virObjectListFreeCount(clts, ret);\n    return ret;\n}"
  },
  {
    "function_name": "adminServerSetThreadPoolParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "126-166",
    "snippet": "int\nadminServerSetThreadPoolParameters(virNetServerPtr srv,\n                                   virTypedParameterPtr params,\n                                   int nparams,\n                                   unsigned int flags)\n{\n    long long int minWorkers = -1;\n    long long int maxWorkers = -1;\n    long long int prioWorkers = -1;\n    virTypedParameterPtr param = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_THREADPOOL_WORKERS_MIN,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_THREADPOOL_WORKERS_MAX,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_THREADPOOL_WORKERS_PRIORITY,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_THREADPOOL_WORKERS_MIN)))\n        minWorkers = param->value.ui;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_THREADPOOL_WORKERS_MAX)))\n        maxWorkers = param->value.ui;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_THREADPOOL_WORKERS_PRIORITY)))\n        prioWorkers = param->value.ui;\n\n    if (virNetServerSetThreadPoolParameters(srv, minWorkers,\n                                            maxWorkers, prioWorkers) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetServerSetThreadPoolParameters",
          "args": [
            "srv",
            "minWorkers",
            "maxWorkers",
            "prioWorkers"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerSetThreadPoolParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1041-1055",
          "snippet": "int\nvirNetServerSetThreadPoolParameters(virNetServerPtr srv,\n                                    long long int minWorkers,\n                                    long long int maxWorkers,\n                                    long long int prioWorkers)\n{\n    int ret;\n\n    virObjectLock(srv);\n    ret = virThreadPoolSetParameters(srv->workers, minWorkers,\n                                     maxWorkers, prioWorkers);\n    virObjectUnlock(srv);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nint\nvirNetServerSetThreadPoolParameters(virNetServerPtr srv,\n                                    long long int minWorkers,\n                                    long long int maxWorkers,\n                                    long long int prioWorkers)\n{\n    int ret;\n\n    virObjectLock(srv);\n    ret = virThreadPoolSetParameters(srv->workers, minWorkers,\n                                     maxWorkers, prioWorkers);\n    virObjectUnlock(srv);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "params",
            "nparams",
            "VIR_THREADPOOL_WORKERS_PRIORITY"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_THREADPOOL_WORKERS_MIN",
            "VIR_TYPED_PARAM_UINT",
            "VIR_THREADPOOL_WORKERS_MAX",
            "VIR_TYPED_PARAM_UINT",
            "VIR_THREADPOOL_WORKERS_PRIORITY",
            "VIR_TYPED_PARAM_UINT",
            "NULL"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminServerSetThreadPoolParameters(virNetServerPtr srv,\n                                   virTypedParameterPtr params,\n                                   int nparams,\n                                   unsigned int flags)\n{\n    long long int minWorkers = -1;\n    long long int maxWorkers = -1;\n    long long int prioWorkers = -1;\n    virTypedParameterPtr param = NULL;\n\n    virCheckFlags(0, -1);\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_THREADPOOL_WORKERS_MIN,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_THREADPOOL_WORKERS_MAX,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_THREADPOOL_WORKERS_PRIORITY,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_THREADPOOL_WORKERS_MIN)))\n        minWorkers = param->value.ui;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_THREADPOOL_WORKERS_MAX)))\n        maxWorkers = param->value.ui;\n\n    if ((param = virTypedParamsGet(params, nparams,\n                                   VIR_THREADPOOL_WORKERS_PRIORITY)))\n        prioWorkers = param->value.ui;\n\n    if (virNetServerSetThreadPoolParameters(srv, minWorkers,\n                                            maxWorkers, prioWorkers) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "adminServerGetThreadPoolParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "72-124",
    "snippet": "int\nadminServerGetThreadPoolParameters(virNetServerPtr srv,\n                                   virTypedParameterPtr *params,\n                                   int *nparams,\n                                   unsigned int flags)\n{\n    size_t minWorkers;\n    size_t maxWorkers;\n    size_t nWorkers;\n    size_t freeWorkers;\n    size_t nPrioWorkers;\n    size_t jobQueueDepth;\n    g_autoptr(virTypedParamList) paramlist = g_new0(virTypedParamList, 1);\n\n    virCheckFlags(0, -1);\n\n    if (virNetServerGetThreadPoolParameters(srv, &minWorkers, &maxWorkers,\n                                            &nWorkers, &freeWorkers,\n                                            &nPrioWorkers,\n                                            &jobQueueDepth) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to retrieve threadpool parameters\"));\n        return -1;\n    }\n\n    if (virTypedParamListAddUInt(paramlist, minWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_MIN) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, maxWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_MAX) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, nWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_CURRENT) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, freeWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_FREE) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, nPrioWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_PRIORITY) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, jobQueueDepth,\n                                 \"%s\", VIR_THREADPOOL_JOB_QUEUE_DEPTH) < 0)\n        return -1;\n\n    *nparams = virTypedParamListStealParams(paramlist, params);\n\n    return 0;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamListStealParams",
          "args": [
            "paramlist",
            "params"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListStealParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "737-748",
          "snippet": "size_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nsize_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListAddUInt",
          "args": [
            "paramlist",
            "jobQueueDepth",
            "\"%s\"",
            "VIR_THREADPOOL_JOB_QUEUE_DEPTH"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamListAddUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "799-818",
          "snippet": "int\nvirTypedParamListAddUInt(virTypedParamListPtr list,\n                         unsigned int value,\n                         const char *namefmt,\n                         ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_UINT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddUInt(virTypedParamListPtr list,\n                         unsigned int value,\n                         const char *namefmt,\n                         ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_UINT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to retrieve threadpool parameters\")"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to retrieve threadpool parameters\""
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetServerGetThreadPoolParameters",
          "args": [
            "srv",
            "&minWorkers",
            "&maxWorkers",
            "&nWorkers",
            "&freeWorkers",
            "&nPrioWorkers",
            "&jobQueueDepth"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virNetServerGetThreadPoolParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetserver.c",
          "lines": "1019-1039",
          "snippet": "int\nvirNetServerGetThreadPoolParameters(virNetServerPtr srv,\n                                    size_t *minWorkers,\n                                    size_t *maxWorkers,\n                                    size_t *nWorkers,\n                                    size_t *freeWorkers,\n                                    size_t *nPrioWorkers,\n                                    size_t *jobQueueDepth)\n{\n    virObjectLock(srv);\n\n    *minWorkers = virThreadPoolGetMinWorkers(srv->workers);\n    *maxWorkers = virThreadPoolGetMaxWorkers(srv->workers);\n    *freeWorkers = virThreadPoolGetFreeWorkers(srv->workers);\n    *nWorkers = virThreadPoolGetCurrentWorkers(srv->workers);\n    *nPrioWorkers = virThreadPoolGetPriorityWorkers(srv->workers);\n    *jobQueueDepth = virThreadPoolGetJobQueueDepth(srv->workers);\n\n    virObjectUnlock(srv);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetserver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);",
            "static inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetserver.h\"\n#include <config.h>\n\nstatic inline size_t virNetServerTrackPendingAuthLocked(virNetServerPtr srv);\nstatic inline size_t virNetServerTrackCompletedAuthLocked(virNetServerPtr srv);\n\nint\nvirNetServerGetThreadPoolParameters(virNetServerPtr srv,\n                                    size_t *minWorkers,\n                                    size_t *maxWorkers,\n                                    size_t *nWorkers,\n                                    size_t *freeWorkers,\n                                    size_t *nPrioWorkers,\n                                    size_t *jobQueueDepth)\n{\n    virObjectLock(srv);\n\n    *minWorkers = virThreadPoolGetMinWorkers(srv->workers);\n    *maxWorkers = virThreadPoolGetMaxWorkers(srv->workers);\n    *freeWorkers = virThreadPoolGetFreeWorkers(srv->workers);\n    *nWorkers = virThreadPoolGetCurrentWorkers(srv->workers);\n    *nPrioWorkers = virThreadPoolGetPriorityWorkers(srv->workers);\n    *jobQueueDepth = virThreadPoolGetJobQueueDepth(srv->workers);\n\n    virObjectUnlock(srv);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new0",
          "args": [
            "virTypedParamList",
            "1"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminServerGetThreadPoolParameters(virNetServerPtr srv,\n                                   virTypedParameterPtr *params,\n                                   int *nparams,\n                                   unsigned int flags)\n{\n    size_t minWorkers;\n    size_t maxWorkers;\n    size_t nWorkers;\n    size_t freeWorkers;\n    size_t nPrioWorkers;\n    size_t jobQueueDepth;\n    g_autoptr(virTypedParamList) paramlist = g_new0(virTypedParamList, 1);\n\n    virCheckFlags(0, -1);\n\n    if (virNetServerGetThreadPoolParameters(srv, &minWorkers, &maxWorkers,\n                                            &nWorkers, &freeWorkers,\n                                            &nPrioWorkers,\n                                            &jobQueueDepth) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to retrieve threadpool parameters\"));\n        return -1;\n    }\n\n    if (virTypedParamListAddUInt(paramlist, minWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_MIN) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, maxWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_MAX) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, nWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_CURRENT) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, freeWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_FREE) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, nPrioWorkers,\n                                 \"%s\", VIR_THREADPOOL_WORKERS_PRIORITY) < 0)\n        return -1;\n\n    if (virTypedParamListAddUInt(paramlist, jobQueueDepth,\n                                 \"%s\", VIR_THREADPOOL_JOB_QUEUE_DEPTH) < 0)\n        return -1;\n\n    *nparams = virTypedParamListStealParams(paramlist, params);\n\n    return 0;\n}"
  },
  {
    "function_name": "adminConnectLookupServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "62-70",
    "snippet": "virNetServerPtr\nadminConnectLookupServer(virNetDaemonPtr dmn,\n                         const char *name,\n                         unsigned int flags)\n{\n    virCheckFlags(flags, NULL);\n\n    return virNetDaemonGetServer(dmn, name);\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDaemonGetServer",
          "args": [
            "dmn",
            "name"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonGetServers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "240-264",
          "snippet": "ssize_t\nvirNetDaemonGetServers(virNetDaemonPtr dmn,\n                       virNetServerPtr **servers)\n{\n    struct collectData data = { servers, 0 };\n    ssize_t ret = -1;\n\n    *servers = NULL;\n\n    virObjectLock(dmn);\n\n    if (virHashForEach(dmn->servers, collectServers, &data) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot get all servers from daemon\"));\n        goto cleanup;\n    }\n\n    ret = data.nservers;\n\n cleanup:\n    if (ret < 0)\n        virObjectListFreeCount(*servers, data.nservers);\n    virObjectUnlock(dmn);\n    return ret;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nssize_t\nvirNetDaemonGetServers(virNetDaemonPtr dmn,\n                       virNetServerPtr **servers)\n{\n    struct collectData data = { servers, 0 };\n    ssize_t ret = -1;\n\n    *servers = NULL;\n\n    virObjectLock(dmn);\n\n    if (virHashForEach(dmn->servers, collectServers, &data) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot get all servers from daemon\"));\n        goto cleanup;\n    }\n\n    ret = data.nservers;\n\n cleanup:\n    if (ret < 0)\n        virObjectListFreeCount(*servers, data.nservers);\n    virObjectUnlock(dmn);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "flags",
            "NULL"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nvirNetServerPtr\nadminConnectLookupServer(virNetDaemonPtr dmn,\n                         const char *name,\n                         unsigned int flags)\n{\n    virCheckFlags(flags, NULL);\n\n    return virNetDaemonGetServer(dmn, name);\n}"
  },
  {
    "function_name": "adminConnectListServers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/admin/admin_server.c",
    "lines": "39-60",
    "snippet": "int\nadminConnectListServers(virNetDaemonPtr dmn,\n                        virNetServerPtr **servers,\n                        unsigned int flags)\n{\n    int ret = -1;\n    virNetServerPtr *srvs = NULL;\n\n    virCheckFlags(0, -1);\n\n    if ((ret = virNetDaemonGetServers(dmn, &srvs)) < 0)\n        goto cleanup;\n\n    if (servers) {\n        *servers = srvs;\n        srvs = NULL;\n    }\n cleanup:\n    if (ret > 0)\n        virObjectListFreeCount(srvs, ret);\n    return ret;\n}",
    "includes": [
      "#include \"virtypedparam.h\"",
      "#include \"virthreadpool.h\"",
      "#include \"virstring.h\"",
      "#include \"rpc/virnetserver.h\"",
      "#include \"rpc/virnetdaemon.h\"",
      "#include \"virlog.h\"",
      "#include \"viridentity.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"admin_server.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFreeCount",
          "args": [
            "srvs",
            "ret"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFreeCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "625-638",
          "snippet": "void\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFreeCount(void *list,\n                       size_t count)\n{\n    size_t i;\n\n    if (!list)\n        return;\n\n    for (i = 0; i < count; i++)\n        virObjectUnref(((void **)list)[i]);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDaemonGetServers",
          "args": [
            "dmn",
            "&srvs"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDaemonGetServers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetdaemon.c",
          "lines": "240-264",
          "snippet": "ssize_t\nvirNetDaemonGetServers(virNetDaemonPtr dmn,\n                       virNetServerPtr **servers)\n{\n    struct collectData data = { servers, 0 };\n    ssize_t ret = -1;\n\n    *servers = NULL;\n\n    virObjectLock(dmn);\n\n    if (virHashForEach(dmn->servers, collectServers, &data) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot get all servers from daemon\"));\n        goto cleanup;\n    }\n\n    ret = data.nservers;\n\n cleanup:\n    if (ret < 0)\n        virObjectListFreeCount(*servers, data.nservers);\n    virObjectUnlock(dmn);\n    return ret;\n}",
          "includes": [
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhash.h\"",
            "#include \"virdbus.h\"",
            "#include \"virnetserver.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdaemon.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhash.h\"\n#include \"virdbus.h\"\n#include \"virnetserver.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virthreadpool.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virnetdaemon.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nssize_t\nvirNetDaemonGetServers(virNetDaemonPtr dmn,\n                       virNetServerPtr **servers)\n{\n    struct collectData data = { servers, 0 };\n    ssize_t ret = -1;\n\n    *servers = NULL;\n\n    virObjectLock(dmn);\n\n    if (virHashForEach(dmn->servers, collectServers, &data) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Cannot get all servers from daemon\"));\n        goto cleanup;\n    }\n\n    ret = data.nservers;\n\n cleanup:\n    if (ret < 0)\n        virObjectListFreeCount(*servers, data.nservers);\n    virObjectUnlock(dmn);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virthreadpool.h\"\n#include \"virstring.h\"\n#include \"rpc/virnetserver.h\"\n#include \"rpc/virnetdaemon.h\"\n#include \"virlog.h\"\n#include \"viridentity.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"admin_server.h\"\n#include <config.h>\n\nint\nadminConnectListServers(virNetDaemonPtr dmn,\n                        virNetServerPtr **servers,\n                        unsigned int flags)\n{\n    int ret = -1;\n    virNetServerPtr *srvs = NULL;\n\n    virCheckFlags(0, -1);\n\n    if ((ret = virNetDaemonGetServers(dmn, &srvs)) < 0)\n        goto cleanup;\n\n    if (servers) {\n        *servers = srvs;\n        srvs = NULL;\n    }\n cleanup:\n    if (ret > 0)\n        virObjectListFreeCount(srvs, ret);\n    return ret;\n}"
  }
]