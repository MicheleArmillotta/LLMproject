[
  {
    "function_name": "virPipeNonBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1813-1817",
    "snippet": "int\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPipeImpl",
          "args": [
            "fds",
            "true",
            "true"
          ],
          "line": 1816
        },
        "resolved": true,
        "details": {
          "function_name": "virPipeImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1756-1796",
          "snippet": "static int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}"
  },
  {
    "function_name": "virPipeQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1806-1810",
    "snippet": "int\nvirPipeQuiet(int fds[2])\n{\n    return virPipeImpl(fds, false, false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPipeImpl",
          "args": [
            "fds",
            "false",
            "false"
          ],
          "line": 1809
        },
        "resolved": true,
        "details": {
          "function_name": "virPipeImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1756-1796",
          "snippet": "static int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirPipeQuiet(int fds[2])\n{\n    return virPipeImpl(fds, false, false);\n}"
  },
  {
    "function_name": "virPipe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1799-1803",
    "snippet": "int\nvirPipe(int fds[2])\n{\n    return virPipeImpl(fds, false, true);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPipeImpl",
          "args": [
            "fds",
            "false",
            "true"
          ],
          "line": 1802
        },
        "resolved": true,
        "details": {
          "function_name": "virPipeImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1756-1796",
          "snippet": "static int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirPipe(int fds[2])\n{\n    return virPipeImpl(fds, false, true);\n}"
  },
  {
    "function_name": "virPipeImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1756-1796",
    "snippet": "static int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fds[1]"
          ],
          "line": 1789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fds[0]"
          ],
          "line": 1788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to create pipes\")"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to create pipes\""
          ],
          "line": 1787
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to set pipes to non-blocking\")"
          ],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSetNonBlock",
          "args": [
            "fds[1]"
          ],
          "line": 1782
        },
        "resolved": true,
        "details": {
          "function_name": "virSetNonBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "126-129",
          "snippet": "int virSetNonBlock(int fd)\n{\n    return virSetBlocking(fd, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetNonBlock(int fd)\n{\n    return virSetBlocking(fd, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to create pipes\")"
          ],
          "line": 1774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pipe",
          "args": [
            "fds"
          ],
          "line": 1768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_pipe",
          "args": [
            "fds",
            "4096",
            "_O_BINARY"
          ],
          "line": 1766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pipe2",
          "args": [
            "fds",
            "flags"
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirPipeImpl(int fds[2], bool nonblock, bool errreport)\n{\n#ifdef HAVE_PIPE2\n    int flags = O_CLOEXEC;\n    if (nonblock)\n        flags |= O_NONBLOCK;\n    int rv = pipe2(fds, flags);\n#else /* !HAVE_PIPE2 */\n# ifdef WIN32\n    int rv = _pipe(fds, 4096, _O_BINARY);\n# else /* !WIN32 */\n    int rv = pipe(fds);\n# endif /* !WIN32 */\n#endif /* !HAVE_PIPE2 */\n\n    if (rv < 0) {\n        if (errreport)\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n        return rv;\n    }\n\n#ifndef HAVE_PIPE2\n    if (nonblock) {\n        if (virSetNonBlock(fds[0]) < 0 ||\n            virSetNonBlock(fds[1]) < 0) {\n            if (errreport)\n                virReportSystemError(errno, \"%s\",\n                                     _(\"Unable to set pipes to non-blocking\"));\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to create pipes\"));\n            VIR_FORCE_CLOSE(fds[0]);\n            VIR_FORCE_CLOSE(fds[1]);\n            return -1;\n        }\n    }\n#endif /* !HAVE_PIPE2 */\n\n    return 0;\n}"
  },
  {
    "function_name": "virGetPassword",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1736-1753",
    "snippet": "char *virGetPassword(void)\n{\n#ifdef WIN32\n    GString *pw = g_string_new(\"\");\n\n    while (1) {\n        char c = _getch();\n        if (c == '\\r')\n            break;\n\n        g_string_append_c(pw, c);\n    }\n\n    return g_string_free(pw, FALSE);\n#else /* !WIN32 */\n    return g_strdup(getpass(\"\"));\n#endif /* ! WIN32 */\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "getpass(\"\")"
          ],
          "line": 1751
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpass",
          "args": [
            "\"\""
          ],
          "line": 1751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_string_free",
          "args": [
            "pw",
            "FALSE"
          ],
          "line": 1749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_string_append_c",
          "args": [
            "pw",
            "c"
          ],
          "line": 1746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_getch",
          "args": [],
          "line": 1742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_string_new",
          "args": [
            "\"\""
          ],
          "line": 1739
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetPassword(void)\n{\n#ifdef WIN32\n    GString *pw = g_string_new(\"\");\n\n    while (1) {\n        char c = _getch();\n        if (c == '\\r')\n            break;\n\n        g_string_append_c(pw, c);\n    }\n\n    return g_string_free(pw, FALSE);\n#else /* !WIN32 */\n    return g_strdup(getpass(\"\"));\n#endif /* ! WIN32 */\n}"
  },
  {
    "function_name": "virHostGetDRMRenderNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1693-1728",
    "snippet": "char *\nvirHostGetDRMRenderNode(void)\n{\n    char *ret = NULL;\n    DIR *driDir = NULL;\n    const char *driPath = \"/dev/dri\";\n    struct dirent *ent = NULL;\n    int dirErr = 0;\n    bool have_rendernode = false;\n\n    if (virDirOpen(&driDir, driPath) < 0)\n        return NULL;\n\n    while ((dirErr = virDirRead(driDir, &ent, driPath)) > 0) {\n        if (STRPREFIX(ent->d_name, \"renderD\")) {\n            have_rendernode = true;\n            break;\n        }\n    }\n\n    if (dirErr < 0)\n        goto cleanup;\n\n    /* even if /dev/dri exists, there might be no renderDX nodes available */\n    if (!have_rendernode) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No DRM render nodes available\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup_printf(\"%s/%s\", driPath, ent->d_name);\n\n cleanup:\n    VIR_DIR_CLOSE(driDir);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "driDir"
          ],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "driPath",
            "ent->d_name"
          ],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No DRM render nodes available\")"
          ],
          "line": 1718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "ent->d_name",
            "\"renderD\""
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "driDir",
            "&ent",
            "driPath"
          ],
          "line": 1706
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&driDir",
            "driPath"
          ],
          "line": 1703
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirHostGetDRMRenderNode(void)\n{\n    char *ret = NULL;\n    DIR *driDir = NULL;\n    const char *driPath = \"/dev/dri\";\n    struct dirent *ent = NULL;\n    int dirErr = 0;\n    bool have_rendernode = false;\n\n    if (virDirOpen(&driDir, driPath) < 0)\n        return NULL;\n\n    while ((dirErr = virDirRead(driDir, &ent, driPath)) > 0) {\n        if (STRPREFIX(ent->d_name, \"renderD\")) {\n            have_rendernode = true;\n            break;\n        }\n    }\n\n    if (dirErr < 0)\n        goto cleanup;\n\n    /* even if /dev/dri exists, there might be no renderDX nodes available */\n    if (!have_rendernode) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"No DRM render nodes available\"));\n        goto cleanup;\n    }\n\n    ret = g_strdup_printf(\"%s/%s\", driPath, ent->d_name);\n\n cleanup:\n    VIR_DIR_CLOSE(driDir);\n    return ret;\n}"
  },
  {
    "function_name": "virHostHasIOMMU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1657-1679",
    "snippet": "bool\nvirHostHasIOMMU(void)\n{\n    DIR *iommuDir = NULL;\n    struct dirent *iommuGroup = NULL;\n    bool ret = false;\n    int direrr;\n\n    if (virDirOpenQuiet(&iommuDir, \"/sys/kernel/iommu_groups/\") < 0)\n        goto cleanup;\n\n    while ((direrr = virDirRead(iommuDir, &iommuGroup, NULL)) > 0)\n        break;\n\n    if (direrr < 0 || !iommuGroup)\n        goto cleanup;\n\n    ret = true;\n\n cleanup:\n    VIR_DIR_CLOSE(iommuDir);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "iommuDir"
          ],
          "line": 1677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "iommuDir",
            "&iommuGroup",
            "NULL"
          ],
          "line": 1668
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenQuiet",
          "args": [
            "&iommuDir",
            "\"/sys/kernel/iommu_groups/\""
          ],
          "line": 1665
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirHostHasIOMMU(void)\n{\n    DIR *iommuDir = NULL;\n    struct dirent *iommuGroup = NULL;\n    bool ret = false;\n    int direrr;\n\n    if (virDirOpenQuiet(&iommuDir, \"/sys/kernel/iommu_groups/\") < 0)\n        goto cleanup;\n\n    while ((direrr = virDirRead(iommuDir, &iommuGroup, NULL)) > 0)\n        break;\n\n    if (direrr < 0 || !iommuGroup)\n        goto cleanup;\n\n    ret = true;\n\n cleanup:\n    VIR_DIR_CLOSE(iommuDir);\n    return ret;\n}"
  },
  {
    "function_name": "virMemoryMaxValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1645-1654",
    "snippet": "unsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}"
  },
  {
    "function_name": "virMemoryLimitIsSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1628-1632",
    "snippet": "bool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
  },
  {
    "function_name": "virMemoryLimitTruncate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1616-1621",
    "snippet": "unsigned long long\nvirMemoryLimitTruncate(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED ? value :\n        VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirMemoryLimitTruncate(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED ? value :\n        VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
  },
  {
    "function_name": "virGetSystemPageSizeKB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1602-1608",
    "snippet": "long virGetSystemPageSizeKB(void)\n{\n    long val = virGetSystemPageSize();\n    if (val < 0)\n        return val;\n    return val / 1024;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetSystemPageSize",
          "args": [],
          "line": 1604
        },
        "resolved": true,
        "details": {
          "function_name": "virGetSystemPageSizeKB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1602-1608",
          "snippet": "long virGetSystemPageSizeKB(void)\n{\n    long val = virGetSystemPageSize();\n    if (val < 0)\n        return val;\n    return val / 1024;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nlong virGetSystemPageSizeKB(void)\n{\n    long val = virGetSystemPageSize();\n    if (val < 0)\n        return val;\n    return val / 1024;\n}"
  },
  {
    "function_name": "virGetSystemPageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1595-1599",
    "snippet": "long virGetSystemPageSize(void)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nlong virGetSystemPageSize(void)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virGetSystemPageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1590-1593",
    "snippet": "long virGetSystemPageSize(void)\n{\n    return sysconf(_SC_PAGESIZE);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_PAGESIZE"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nlong virGetSystemPageSize(void)\n{\n    return sysconf(_SC_PAGESIZE);\n}"
  },
  {
    "function_name": "virUpdateSelfLastChanged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1574-1586",
    "snippet": "void virUpdateSelfLastChanged(const char *path)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0)\n        return;\n\n    if (sb.st_ctime > selfLastChanged) {\n        VIR_DEBUG(\"Setting self last changed to %lld for '%s'\",\n                  (long long)sb.st_ctime, path);\n        selfLastChanged = sb.st_ctime;\n    }\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static time_t selfLastChanged;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Setting self last changed to %lld for '%s'\"",
            "(long long)sb.st_ctime",
            "path"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 1578
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic time_t selfLastChanged;\n\nvoid virUpdateSelfLastChanged(const char *path)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0)\n        return;\n\n    if (sb.st_ctime > selfLastChanged) {\n        VIR_DEBUG(\"Setting self last changed to %lld for '%s'\",\n                  (long long)sb.st_ctime, path);\n        selfLastChanged = sb.st_ctime;\n    }\n}"
  },
  {
    "function_name": "virGetSelfLastChanged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1568-1571",
    "snippet": "time_t virGetSelfLastChanged(void)\n{\n    return selfLastChanged;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static time_t selfLastChanged;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic time_t selfLastChanged;\n\ntime_t virGetSelfLastChanged(void)\n{\n    return selfLastChanged;\n}"
  },
  {
    "function_name": "virParseOwnershipIds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1521-1564",
    "snippet": "int\nvirParseOwnershipIds(const char *label, uid_t *uidPtr, gid_t *gidPtr)\n{\n    int rc = -1;\n    uid_t theuid;\n    gid_t thegid;\n    char *tmp_label = NULL;\n    char *sep = NULL;\n    char *owner = NULL;\n    char *group = NULL;\n\n    tmp_label = g_strdup(label);\n\n    /* Split label */\n    sep = strchr(tmp_label, ':');\n    if (sep == NULL) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Failed to parse uid and gid from '%s'\"),\n                       label);\n        goto cleanup;\n    }\n    *sep = '\\0';\n    owner = tmp_label;\n    group = sep + 1;\n\n    /* Parse owner and group, error message is defined by\n     * virGetUserID or virGetGroupID.\n     */\n    if (virGetUserID(owner, &theuid) < 0 ||\n        virGetGroupID(group, &thegid) < 0)\n        goto cleanup;\n\n    if (uidPtr)\n        *uidPtr = theuid;\n    if (gidPtr)\n        *gidPtr = thegid;\n\n    rc = 0;\n\n cleanup:\n    VIR_FREE(tmp_label);\n\n    return rc;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "tmp_label"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetGroupID",
          "args": [
            "group",
            "&thegid"
          ],
          "line": 1550
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1138-1145",
          "snippet": "int virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserID",
          "args": [
            "owner",
            "&theuid"
          ],
          "line": 1549
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1128-1135",
          "snippet": "int virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Failed to parse uid and gid from '%s'\")",
            "label"
          ],
          "line": 1537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse uid and gid from '%s'\""
          ],
          "line": 1538
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp_label",
            "':'"
          ],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseOwnershipIds(const char *label, uid_t *uidPtr, gid_t *gidPtr)\n{\n    int rc = -1;\n    uid_t theuid;\n    gid_t thegid;\n    char *tmp_label = NULL;\n    char *sep = NULL;\n    char *owner = NULL;\n    char *group = NULL;\n\n    tmp_label = g_strdup(label);\n\n    /* Split label */\n    sep = strchr(tmp_label, ':');\n    if (sep == NULL) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Failed to parse uid and gid from '%s'\"),\n                       label);\n        goto cleanup;\n    }\n    *sep = '\\0';\n    owner = tmp_label;\n    group = sep + 1;\n\n    /* Parse owner and group, error message is defined by\n     * virGetUserID or virGetGroupID.\n     */\n    if (virGetUserID(owner, &theuid) < 0 ||\n        virGetGroupID(group, &thegid) < 0)\n        goto cleanup;\n\n    if (uidPtr)\n        *uidPtr = theuid;\n    if (gidPtr)\n        *gidPtr = thegid;\n\n    rc = 0;\n\n cleanup:\n    VIR_FREE(tmp_label);\n\n    return rc;\n}"
  },
  {
    "function_name": "virGetDeviceUnprivSGIO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1472-1508",
    "snippet": "int\nvirGetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int *unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *buf = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    if (virFileReadAll(sysfs_path, 1024, &buf) < 0)\n        goto cleanup;\n\n    if ((tmp = strchr(buf, '\\n')))\n        *tmp = '\\0';\n\n    if (virStrToLong_i(buf, NULL, 10, unpriv_sgio) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to parse value of %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(buf);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "sysfs_path"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to parse value of %s\")",
            "sysfs_path"
          ],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to parse value of %s\""
          ],
          "line": 1499
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "buf",
            "NULL",
            "10",
            "unpriv_sgio"
          ],
          "line": 1497
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "buf",
            "'\\n'"
          ],
          "line": 1494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "sysfs_path",
            "1024",
            "&buf"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"unpriv_sgio is not supported by this kernel\")"
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "sysfs_path"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUnprivSGIOSysfsPath",
          "args": [
            "path",
            "sysfs_dir"
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUnprivSGIOSysfsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1418-1437",
          "snippet": "char *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\"\n\nchar *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int *unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *buf = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    if (virFileReadAll(sysfs_path, 1024, &buf) < 0)\n        goto cleanup;\n\n    if ((tmp = strchr(buf, '\\n')))\n        *tmp = '\\0';\n\n    if (virStrToLong_i(buf, NULL, 10, unpriv_sgio) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to parse value of %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(buf);\n    return ret;\n}"
  },
  {
    "function_name": "virSetDeviceUnprivSGIO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1439-1470",
    "snippet": "int\nvirSetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *val = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    val = g_strdup_printf(\"%d\", unpriv_sgio);\n\n    if ((rc = virFileWriteStr(sysfs_path, val, 0)) < 0) {\n        virReportSystemError(-rc, _(\"failed to set %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(val);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "val"
          ],
          "line": 1468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "sysfs_path"
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-rc",
            "_(\"failed to set %s\")",
            "sysfs_path"
          ],
          "line": 1461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to set %s\""
          ],
          "line": 1461
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileWriteStr",
          "args": [
            "sysfs_path",
            "val",
            "0"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1502-1524",
          "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"unpriv_sgio is not supported by this kernel\")"
          ],
          "line": 1453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "sysfs_path"
          ],
          "line": 1452
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUnprivSGIOSysfsPath",
          "args": [
            "path",
            "sysfs_dir"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUnprivSGIOSysfsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1418-1437",
          "snippet": "char *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\"\n\nchar *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *val = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    val = g_strdup_printf(\"%d\", unpriv_sgio);\n\n    if ((rc = virFileWriteStr(sysfs_path, val, 0)) < 0) {\n        virReportSystemError(-rc, _(\"failed to set %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(val);\n    return ret;\n}"
  },
  {
    "function_name": "virGetUnprivSGIOSysfsPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1418-1437",
    "snippet": "char *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%d:%d/queue/unpriv_sgio\"",
            "sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH",
            "maj",
            "min"
          ],
          "line": 1433
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-rc",
            "_(\"Unable to get device ID '%s'\")",
            "path"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetDeviceID",
          "args": [
            "path",
            "&maj",
            "&min"
          ],
          "line": 1426
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDeviceID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1406-1413",
          "snippet": "int\nvirGetDeviceID(const char *path G_GNUC_UNUSED,\n               int *maj,\n               int *min)\n{\n    *maj = *min = 0;\n    return -ENOSYS;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetDeviceID(const char *path G_GNUC_UNUSED,\n               int *maj,\n               int *min)\n{\n    *maj = *min = 0;\n    return -ENOSYS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\"\n\nchar *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}"
  },
  {
    "function_name": "virGetDeviceID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1406-1413",
    "snippet": "int\nvirGetDeviceID(const char *path G_GNUC_UNUSED,\n               int *maj,\n               int *min)\n{\n    *maj = *min = 0;\n    return -ENOSYS;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetDeviceID(const char *path G_GNUC_UNUSED,\n               int *maj,\n               int *min)\n{\n    *maj = *min = 0;\n    return -ENOSYS;\n}"
  },
  {
    "function_name": "virGetDeviceID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1387-1404",
    "snippet": "int\nvirGetDeviceID(const char *path, int *maj, int *min)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0)\n        return -errno;\n\n    if (!S_ISBLK(sb.st_mode))\n        return -EINVAL;\n\n    if (maj)\n        *maj = major(sb.st_rdev);\n    if (min)\n        *min = minor(sb.st_rdev);\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 1395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetDeviceID(const char *path, int *maj, int *min)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0)\n        return -errno;\n\n    if (!S_ISBLK(sb.st_mode))\n        return -EINVAL;\n\n    if (maj)\n        *maj = major(sb.st_rdev);\n    if (min)\n        *min = minor(sb.st_rdev);\n\n    return 0;\n}"
  },
  {
    "function_name": "virValidateWWN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1363-1384",
    "snippet": "bool\nvirValidateWWN(const char *wwn)\n{\n    size_t i;\n    const char *p = wwn;\n\n    if (STRPREFIX(wwn, \"0x\"))\n        p += 2;\n\n    for (i = 0; p[i]; i++) {\n        if (!g_ascii_isxdigit(p[i]))\n            break;\n    }\n\n    if (i != 16 || p[i]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Malformed wwn: %s\"), wwn);\n        return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Malformed wwn: %s\")",
            "wwn"
          ],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Malformed wwn: %s\""
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_ascii_isxdigit",
          "args": [
            "p[i]"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "wwn",
            "\"0x\""
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirValidateWWN(const char *wwn)\n{\n    size_t i;\n    const char *p = wwn;\n\n    if (STRPREFIX(wwn, \"0x\"))\n        p += 2;\n\n    for (i = 0; p[i]; i++) {\n        if (!g_ascii_isxdigit(p[i]))\n            break;\n    }\n\n    if (i != 16 || p[i]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Malformed wwn: %s\"), wwn);\n        return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virIsDevMapperDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1357-1360",
    "snippet": "bool virIsDevMapperDevice(const char *dev_name G_GNUC_UNUSED)\n{\n    return false;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool virIsDevMapperDevice(const char *dev_name G_GNUC_UNUSED)\n{\n    return false;\n}"
  },
  {
    "function_name": "virIsDevMapperDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1344-1355",
    "snippet": "bool\nvirIsDevMapperDevice(const char *dev_name)\n{\n    struct stat buf;\n\n    if (!stat(dev_name, &buf) &&\n        S_ISBLK(buf.st_mode) &&\n        dm_is_dm_major(major(buf.st_rdev)))\n            return true;\n\n    return false;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dm_is_dm_major",
          "args": [
            "major(buf.st_rdev)"
          ],
          "line": 1351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "buf.st_rdev"
          ],
          "line": 1351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "buf.st_mode"
          ],
          "line": 1350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "dev_name",
            "&buf"
          ],
          "line": 1349
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirIsDevMapperDevice(const char *dev_name)\n{\n    struct stat buf;\n\n    if (!stat(dev_name, &buf) &&\n        S_ISBLK(buf.st_mode) &&\n        dm_is_dm_major(major(buf.st_rdev)))\n            return true;\n\n    return false;\n}"
  },
  {
    "function_name": "virWaitForDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1324-1341",
    "snippet": "void virWaitForDevices(void)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *udev = NULL;\n    int exitstatus;\n\n    if (!(udev = virFindFileInPath(UDEVADM)))\n        return;\n\n    if (!(cmd = virCommandNewArgList(udev, \"settle\", NULL)))\n        return;\n\n    /*\n     * NOTE: we ignore errors here; this is just to make sure that any device\n     * nodes that are being created finish before we try to scan them.\n     */\n    ignore_value(virCommandRun(cmd, &exitstatus));\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virCommandRun(cmd, &exitstatus)"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "&exitstatus"
          ],
          "line": 1340
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "udev",
            "\"settle\"",
            "NULL"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFindFileInPath",
          "args": [
            "UDEVADM"
          ],
          "line": 1330
        },
        "resolved": true,
        "details": {
          "function_name": "virFindFileInPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1657-1709",
          "snippet": "char *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid virWaitForDevices(void)\n{\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *udev = NULL;\n    int exitstatus;\n\n    if (!(udev = virFindFileInPath(UDEVADM)))\n        return;\n\n    if (!(cmd = virCommandNewArgList(udev, \"settle\", NULL)))\n        return;\n\n    /*\n     * NOTE: we ignore errors here; this is just to make sure that any device\n     * nodes that are being created finish before we try to scan them.\n     */\n    ignore_value(virCommandRun(cmd, &exitstatus));\n}"
  },
  {
    "function_name": "virSetUIDGIDWithCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1314-1320",
    "snippet": "int\nvirSetUIDGIDWithCaps(uid_t uid, gid_t gid, gid_t *groups, int ngroups,\n                     unsigned long long capBits G_GNUC_UNUSED,\n                     bool clearExistingCaps G_GNUC_UNUSED)\n{\n    return virSetUIDGID(uid, gid, groups, ngroups);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSetUIDGID",
          "args": [
            "uid",
            "gid",
            "groups",
            "ngroups"
          ],
          "line": 1319
        },
        "resolved": true,
        "details": {
          "function_name": "virSetUIDGID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1147-1156",
          "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGIDWithCaps(uid_t uid, gid_t gid, gid_t *groups, int ngroups,\n                     unsigned long long capBits G_GNUC_UNUSED,\n                     bool clearExistingCaps G_GNUC_UNUSED)\n{\n    return virSetUIDGID(uid, gid, groups, ngroups);\n}"
  },
  {
    "function_name": "virSetUIDGIDWithCaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1174-1306",
    "snippet": "int\nvirSetUIDGIDWithCaps(uid_t uid, gid_t gid, gid_t *groups, int ngroups,\n                     unsigned long long capBits, bool clearExistingCaps)\n{\n    size_t i;\n    int capng_ret;\n    bool need_setgid = false;\n    bool need_setuid = false;\n    bool need_setpcap = false;\n    const char *capstr = NULL;\n\n    /* First drop all caps (unless the requested uid is \"unchanged\" or\n     * root and clearExistingCaps wasn't requested), then add back\n     * those in capBits + the extra ones we need to change uid/gid and\n     * change the capabilities bounding set.\n     */\n\n    if (clearExistingCaps || (uid != (uid_t)-1 && uid != 0))\n        capng_clear(CAPNG_SELECT_BOTH);\n\n    for (i = 0; i <= CAP_LAST_CAP; i++) {\n        capstr = capng_capability_to_name(i);\n\n        if (capBits & (1ULL << i)) {\n            capng_update(CAPNG_ADD,\n                         CAPNG_EFFECTIVE|CAPNG_INHERITABLE|\n                         CAPNG_PERMITTED|CAPNG_BOUNDING_SET,\n                         i);\n\n            VIR_DEBUG(\"Added '%s' to child capabilities' set\", capstr);\n        }\n    }\n\n    if (gid != (gid_t)-1 &&\n        !capng_have_capability(CAPNG_EFFECTIVE, CAP_SETGID)) {\n        need_setgid = true;\n        capng_update(CAPNG_ADD, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETGID);\n    }\n    if (uid != (uid_t)-1 &&\n        !capng_have_capability(CAPNG_EFFECTIVE, CAP_SETUID)) {\n        need_setuid = true;\n        capng_update(CAPNG_ADD, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETUID);\n    }\n# ifdef PR_CAPBSET_DROP\n    /* If newer kernel, we need also need setpcap to change the bounding set */\n    if ((capBits || need_setgid || need_setuid) &&\n        !capng_have_capability(CAPNG_EFFECTIVE, CAP_SETPCAP)) {\n        need_setpcap = true;\n    }\n    if (need_setpcap)\n        capng_update(CAPNG_ADD, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETPCAP);\n# endif\n\n    /* Tell system we want to keep caps across uid change */\n    if (prctl(PR_SET_KEEPCAPS, 1, 0, 0, 0)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"prctl failed to set KEEPCAPS\"));\n        return -1;\n    }\n\n    /* Change to the temp capabilities */\n    if ((capng_ret = capng_apply(CAPNG_SELECT_CAPS)) < 0) {\n        /* Failed.  If we are running unprivileged, and the arguments make sense\n         * for this scenario, assume we're starting some kind of setuid helper:\n         * do not set any of capBits in the permitted or effective sets, and let\n         * the program get them on its own.\n         *\n         * (Too bad we cannot restrict the bounding set to the capabilities we\n         * would like the helper to have!).\n         */\n        if (getuid() > 0 && clearExistingCaps && !need_setuid && !need_setgid) {\n            capng_clear(CAPNG_SELECT_CAPS);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot apply process capabilities %d\"), capng_ret);\n            return -1;\n        }\n    }\n\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0)\n        return -1;\n\n    /* Tell it we are done keeping capabilities */\n    if (prctl(PR_SET_KEEPCAPS, 0, 0, 0, 0)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"prctl failed to reset KEEPCAPS\"));\n        return -1;\n    }\n\n# ifdef PR_CAP_AMBIENT\n    /* we couldn't do this in the loop earlier above, because the capabilities\n     * were not applied yet, since in order to add a capability into the AMBIENT\n     * set, it has to be present in both the PERMITTED and INHERITABLE sets\n     * (capabilities(7))\n     */\n    for (i = 0; i <= CAP_LAST_CAP; i++) {\n        capstr = capng_capability_to_name(i);\n\n        if (capBits & (1ULL << i)) {\n            if (prctl(PR_CAP_AMBIENT, PR_CAP_AMBIENT_RAISE, i, 0, 0) < 0) {\n                virReportSystemError(errno,\n                                     _(\"prctl failed to enable '%s' in the \"\n                                       \"AMBIENT set\"),\n                                     capstr);\n                return -1;\n            }\n        }\n    }\n# endif\n\n    /* Set bounding set while we have CAP_SETPCAP.  Unfortunately we cannot\n     * do this if we failed to get the capability above, so ignore the\n     * return value.\n     */\n    capng_apply(CAPNG_SELECT_BOUNDS);\n\n    /* Drop the caps that allow setuid/gid (unless they were requested) */\n    if (need_setgid)\n        capng_update(CAPNG_DROP, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETGID);\n    if (need_setuid)\n        capng_update(CAPNG_DROP, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETUID);\n    /* Throw away CAP_SETPCAP so no more changes */\n    if (need_setpcap)\n        capng_update(CAPNG_DROP, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETPCAP);\n\n    if (((capng_ret = capng_apply(CAPNG_SELECT_CAPS)) < 0)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot apply process capabilities %d\"), capng_ret);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot apply process capabilities %d\")",
            "capng_ret"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot apply process capabilities %d\""
          ],
          "line": 1301
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "capng_apply",
          "args": [
            "CAPNG_SELECT_CAPS"
          ],
          "line": 1299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_DROP",
            "CAPNG_EFFECTIVE|CAPNG_PERMITTED",
            "CAP_SETPCAP"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_DROP",
            "CAPNG_EFFECTIVE|CAPNG_PERMITTED",
            "CAP_SETUID"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_DROP",
            "CAPNG_EFFECTIVE|CAPNG_PERMITTED",
            "CAP_SETGID"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_apply",
          "args": [
            "CAPNG_SELECT_BOUNDS"
          ],
          "line": 1288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"prctl failed to enable '%s' in the \"\n                                       \"AMBIENT set\")",
            "capstr"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prctl",
          "args": [
            "PR_CAP_AMBIENT",
            "PR_CAP_AMBIENT_RAISE",
            "i",
            "0",
            "0"
          ],
          "line": 1273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_capability_to_name",
          "args": [
            "i"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"prctl failed to reset KEEPCAPS\")"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prctl",
          "args": [
            "PR_SET_KEEPCAPS",
            "0",
            "0",
            "0",
            "0"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSetUIDGID",
          "args": [
            "uid",
            "gid",
            "groups",
            "ngroups"
          ],
          "line": 1253
        },
        "resolved": true,
        "details": {
          "function_name": "virSetUIDGID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1147-1156",
          "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot apply process capabilities %d\")",
            "capng_ret"
          ],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_clear",
          "args": [
            "CAPNG_SELECT_CAPS"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 1244
        },
        "resolved": true,
        "details": {
          "function_name": "getuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "63-64",
          "snippet": "static inline int getuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "capng_apply",
          "args": [
            "CAPNG_SELECT_CAPS"
          ],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"prctl failed to set KEEPCAPS\")"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prctl",
          "args": [
            "PR_SET_KEEPCAPS",
            "1",
            "0",
            "0",
            "0"
          ],
          "line": 1228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_ADD",
            "CAPNG_EFFECTIVE|CAPNG_PERMITTED",
            "CAP_SETPCAP"
          ],
          "line": 1224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_have_capability",
          "args": [
            "CAPNG_EFFECTIVE",
            "CAP_SETPCAP"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_ADD",
            "CAPNG_EFFECTIVE|CAPNG_PERMITTED",
            "CAP_SETUID"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_have_capability",
          "args": [
            "CAPNG_EFFECTIVE",
            "CAP_SETUID"
          ],
          "line": 1213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_ADD",
            "CAPNG_EFFECTIVE|CAPNG_PERMITTED",
            "CAP_SETGID"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_have_capability",
          "args": [
            "CAPNG_EFFECTIVE",
            "CAP_SETGID"
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Added '%s' to child capabilities' set\"",
            "capstr"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_update",
          "args": [
            "CAPNG_ADD",
            "CAPNG_EFFECTIVE|CAPNG_INHERITABLE|\n                         CAPNG_PERMITTED|CAPNG_BOUNDING_SET",
            "i"
          ],
          "line": 1198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_capability_to_name",
          "args": [
            "i"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capng_clear",
          "args": [
            "CAPNG_SELECT_BOTH"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGIDWithCaps(uid_t uid, gid_t gid, gid_t *groups, int ngroups,\n                     unsigned long long capBits, bool clearExistingCaps)\n{\n    size_t i;\n    int capng_ret;\n    bool need_setgid = false;\n    bool need_setuid = false;\n    bool need_setpcap = false;\n    const char *capstr = NULL;\n\n    /* First drop all caps (unless the requested uid is \"unchanged\" or\n     * root and clearExistingCaps wasn't requested), then add back\n     * those in capBits + the extra ones we need to change uid/gid and\n     * change the capabilities bounding set.\n     */\n\n    if (clearExistingCaps || (uid != (uid_t)-1 && uid != 0))\n        capng_clear(CAPNG_SELECT_BOTH);\n\n    for (i = 0; i <= CAP_LAST_CAP; i++) {\n        capstr = capng_capability_to_name(i);\n\n        if (capBits & (1ULL << i)) {\n            capng_update(CAPNG_ADD,\n                         CAPNG_EFFECTIVE|CAPNG_INHERITABLE|\n                         CAPNG_PERMITTED|CAPNG_BOUNDING_SET,\n                         i);\n\n            VIR_DEBUG(\"Added '%s' to child capabilities' set\", capstr);\n        }\n    }\n\n    if (gid != (gid_t)-1 &&\n        !capng_have_capability(CAPNG_EFFECTIVE, CAP_SETGID)) {\n        need_setgid = true;\n        capng_update(CAPNG_ADD, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETGID);\n    }\n    if (uid != (uid_t)-1 &&\n        !capng_have_capability(CAPNG_EFFECTIVE, CAP_SETUID)) {\n        need_setuid = true;\n        capng_update(CAPNG_ADD, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETUID);\n    }\n# ifdef PR_CAPBSET_DROP\n    /* If newer kernel, we need also need setpcap to change the bounding set */\n    if ((capBits || need_setgid || need_setuid) &&\n        !capng_have_capability(CAPNG_EFFECTIVE, CAP_SETPCAP)) {\n        need_setpcap = true;\n    }\n    if (need_setpcap)\n        capng_update(CAPNG_ADD, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETPCAP);\n# endif\n\n    /* Tell system we want to keep caps across uid change */\n    if (prctl(PR_SET_KEEPCAPS, 1, 0, 0, 0)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"prctl failed to set KEEPCAPS\"));\n        return -1;\n    }\n\n    /* Change to the temp capabilities */\n    if ((capng_ret = capng_apply(CAPNG_SELECT_CAPS)) < 0) {\n        /* Failed.  If we are running unprivileged, and the arguments make sense\n         * for this scenario, assume we're starting some kind of setuid helper:\n         * do not set any of capBits in the permitted or effective sets, and let\n         * the program get them on its own.\n         *\n         * (Too bad we cannot restrict the bounding set to the capabilities we\n         * would like the helper to have!).\n         */\n        if (getuid() > 0 && clearExistingCaps && !need_setuid && !need_setgid) {\n            capng_clear(CAPNG_SELECT_CAPS);\n        } else {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot apply process capabilities %d\"), capng_ret);\n            return -1;\n        }\n    }\n\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0)\n        return -1;\n\n    /* Tell it we are done keeping capabilities */\n    if (prctl(PR_SET_KEEPCAPS, 0, 0, 0, 0)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"prctl failed to reset KEEPCAPS\"));\n        return -1;\n    }\n\n# ifdef PR_CAP_AMBIENT\n    /* we couldn't do this in the loop earlier above, because the capabilities\n     * were not applied yet, since in order to add a capability into the AMBIENT\n     * set, it has to be present in both the PERMITTED and INHERITABLE sets\n     * (capabilities(7))\n     */\n    for (i = 0; i <= CAP_LAST_CAP; i++) {\n        capstr = capng_capability_to_name(i);\n\n        if (capBits & (1ULL << i)) {\n            if (prctl(PR_CAP_AMBIENT, PR_CAP_AMBIENT_RAISE, i, 0, 0) < 0) {\n                virReportSystemError(errno,\n                                     _(\"prctl failed to enable '%s' in the \"\n                                       \"AMBIENT set\"),\n                                     capstr);\n                return -1;\n            }\n        }\n    }\n# endif\n\n    /* Set bounding set while we have CAP_SETPCAP.  Unfortunately we cannot\n     * do this if we failed to get the capability above, so ignore the\n     * return value.\n     */\n    capng_apply(CAPNG_SELECT_BOUNDS);\n\n    /* Drop the caps that allow setuid/gid (unless they were requested) */\n    if (need_setgid)\n        capng_update(CAPNG_DROP, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETGID);\n    if (need_setuid)\n        capng_update(CAPNG_DROP, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETUID);\n    /* Throw away CAP_SETPCAP so no more changes */\n    if (need_setpcap)\n        capng_update(CAPNG_DROP, CAPNG_EFFECTIVE|CAPNG_PERMITTED, CAP_SETPCAP);\n\n    if (((capng_ret = capng_apply(CAPNG_SELECT_CAPS)) < 0)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot apply process capabilities %d\"), capng_ret);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virGetGroupName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1158-1165",
    "snippet": "char *\nvirGetGroupName(gid_t gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupName is not available\"));\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetGroupName is not available\")"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetGroupName is not available\""
          ],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetGroupName(gid_t gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupName is not available\"));\n\n    return NULL;\n}"
  },
  {
    "function_name": "virSetUIDGID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1147-1156",
    "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virSetUIDGID is not available\")"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virSetUIDGID is not available\""
          ],
          "line": 1154
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
  },
  {
    "function_name": "virGetGroupID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1138-1145",
    "snippet": "int virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetGroupID is not available\")"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetGroupID is not available\""
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}"
  },
  {
    "function_name": "virGetUserID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1128-1135",
    "snippet": "int virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetUserID is not available\")"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetUserID is not available\""
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}"
  },
  {
    "function_name": "virGetUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1119-1126",
    "snippet": "char *\nvirGetUserName(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserName is not available\"));\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetUserName is not available\")"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetUserName is not available\""
          ],
          "line": 1123
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserName(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserName is not available\"));\n\n    return NULL;\n}"
  },
  {
    "function_name": "virGetUserShell",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1109-1116",
    "snippet": "char *\nvirGetUserShell(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserShell is not available\"));\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetUserShell is not available\")"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetUserShell is not available\""
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserShell(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserShell is not available\"));\n\n    return NULL;\n}"
  },
  {
    "function_name": "virGetUserDirectoryByUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1100-1107",
    "snippet": "char *\nvirGetUserDirectoryByUID(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserDirectory is not available\"));\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetUserDirectory is not available\")"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetUserDirectory is not available\""
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserDirectoryByUID(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserDirectory is not available\"));\n\n    return NULL;\n}"
  },
  {
    "function_name": "virGetUserShell",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1090-1097",
    "snippet": "char *\nvirGetUserShell(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserShell is not available\"));\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virGetUserShell is not available\")"
          ],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virGetUserShell is not available\""
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserShell(uid_t uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserShell is not available\"));\n\n    return NULL;\n}"
  },
  {
    "function_name": "virGetUserDirectoryByUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1080-1088",
    "snippet": "char *\nvirGetUserDirectoryByUID(uid_t uid G_GNUC_UNUSED)\n{\n    /* Since Windows lacks setuid binaries, and since we already fake\n     * geteuid(), we can safely assume that this is only called when\n     * querying about the current user */\n\n    return g_strdup(g_get_home_dir());\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "g_get_home_dir()"
          ],
          "line": 1087
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_home_dir",
          "args": [],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserDirectoryByUID(uid_t uid G_GNUC_UNUSED)\n{\n    /* Since Windows lacks setuid binaries, and since we already fake\n     * geteuid(), we can safely assume that this is only called when\n     * querying about the current user */\n\n    return g_strdup(g_get_home_dir());\n}"
  },
  {
    "function_name": "virDoesGroupExist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1073-1077",
    "snippet": "bool\nvirDoesGroupExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirDoesGroupExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}"
  },
  {
    "function_name": "virDoesUserExist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1067-1071",
    "snippet": "bool\nvirDoesUserExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirDoesUserExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}"
  },
  {
    "function_name": "virGetGroupList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1059-1065",
    "snippet": "int\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}"
  },
  {
    "function_name": "virSetUIDGID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "1020-1055",
    "snippet": "VIR_WARNINGS_RESET\n\n\n/* Set the real and effective uid and gid to the given values, as well\n * as all the supplementary groups, so that the process has all the\n * assumed group membership of that uid. Return 0 on success, -1 on\n * failure (the original system error remains in errno).\n */\nint\nvirSetUIDGID(uid_t uid, gid_t gid, gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    if (gid != (gid_t)-1 && setregid(gid, gid) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot change to '%u' group\"),\n                             (unsigned int) gid);\n        return -1;\n    }\n\n# if HAVE_SETGROUPS\n    if (gid != (gid_t)-1 && setgroups(ngroups, groups) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"cannot set supplemental groups\"));\n        return -1;\n    }\n# endif\n\n    if (uid != (uid_t)-1 && setreuid(uid, uid) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot change to uid to '%u'\"),\n                             (unsigned int) uid);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot change to uid to '%u'\")",
            "(unsigned int) uid"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot change to uid to '%u'\""
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setreuid",
          "args": [
            "uid",
            "uid"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"cannot set supplemental groups\")"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setgroups",
          "args": [
            "ngroups",
            "groups"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot change to '%u' group\")",
            "(unsigned int) gid"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setregid",
          "args": [
            "gid",
            "gid"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nVIR_WARNINGS_RESET\n\n\n/* Set the real and effective uid and gid to the given values, as well\n * as all the supplementary groups, so that the process has all the\n * assumed group membership of that uid. Return 0 on success, -1 on\n * failure (the original system error remains in errno).\n */\nint\nvirSetUIDGID(uid_t uid, gid_t gid, gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    if (gid != (gid_t)-1 && setregid(gid, gid) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot change to '%u' group\"),\n                             (unsigned int) gid);\n        return -1;\n    }\n\n# if HAVE_SETGROUPS\n    if (gid != (gid_t)-1 && setgroups(ngroups, groups) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"cannot set supplemental groups\"));\n        return -1;\n    }\n# endif\n\n    if (uid != (uid_t)-1 && setreuid(uid, uid) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot change to uid to '%u'\"),\n                             (unsigned int) uid);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virGetGroupList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "952-1018",
    "snippet": "VIR_WARNINGS_NO_POINTER_SIGN\n\n/* Compute the list of primary and supplementary groups associated\n * with @uid, and including @gid in the list (unless it is -1),\n * storing a malloc'd result into @list. If uid is -1 or doesn't exist in the\n * system database querying of the supplementary groups is skipped.\n *\n * Returns the size of the list on success, or -1 on failure with error\n * reported and errno set. May not be called between fork and exec.\n * */\nint\nvirGetGroupList(uid_t uid, gid_t gid, gid_t **list)\n{\n    int ret = 0;\n    char *user = NULL;\n    gid_t primary;\n\n    *list = NULL;\n\n    /* invalid users have no supplementary groups */\n    if (uid != (uid_t)-1 &&\n        virGetUserEnt(uid, &user, &primary, NULL, NULL, true) >= 0) {\n        int nallocgrps = 10;\n        gid_t *grps = g_new(gid_t, nallocgrps);\n\n        while (1) {\n            int nprevallocgrps = nallocgrps;\n            int rv;\n\n            rv = getgrouplist(user, primary, grps, &nallocgrps);\n\n            /* Some systems (like Darwin) have a bug where they\n               never increase max_n_groups.  */\n            if (rv < 0 && nprevallocgrps == nallocgrps)\n                nallocgrps *= 2;\n\n            /* either shrinks to actual size, or enlarges to new size */\n            grps = g_renew(gid_t, grps, nallocgrps);\n\n            if (rv >= 0) {\n                ret = rv;\n                *list = grps;\n                break;\n            }\n        }\n    }\n\n    if (gid != (gid_t)-1) {\n        size_t i;\n\n        for (i = 0; i < ret; i++) {\n            if ((*list)[i] == gid)\n                goto cleanup;\n        }\n        if (VIR_APPEND_ELEMENT(*list, i, gid) < 0) {\n            ret = -1;\n            VIR_FREE(*list);\n            goto cleanup;\n        } else {\n            ret = i;\n        }\n    }\n\n cleanup:\n    VIR_FREE(user);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "user"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*list"
          ],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "*list",
            "i",
            "gid"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_renew",
          "args": [
            "gid_t",
            "grps",
            "nallocgrps"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getgrouplist",
          "args": [
            "user",
            "primary",
            "grps",
            "&nallocgrps"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_new",
          "args": [
            "gid_t",
            "nallocgrps"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetUserEnt",
          "args": [
            "uid",
            "&user",
            "&primary",
            "NULL",
            "NULL",
            "true"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserEnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "608-684",
          "snippet": "static int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nVIR_WARNINGS_NO_POINTER_SIGN\n\n/* Compute the list of primary and supplementary groups associated\n * with @uid, and including @gid in the list (unless it is -1),\n * storing a malloc'd result into @list. If uid is -1 or doesn't exist in the\n * system database querying of the supplementary groups is skipped.\n *\n * Returns the size of the list on success, or -1 on failure with error\n * reported and errno set. May not be called between fork and exec.\n * */\nint\nvirGetGroupList(uid_t uid, gid_t gid, gid_t **list)\n{\n    int ret = 0;\n    char *user = NULL;\n    gid_t primary;\n\n    *list = NULL;\n\n    /* invalid users have no supplementary groups */\n    if (uid != (uid_t)-1 &&\n        virGetUserEnt(uid, &user, &primary, NULL, NULL, true) >= 0) {\n        int nallocgrps = 10;\n        gid_t *grps = g_new(gid_t, nallocgrps);\n\n        while (1) {\n            int nprevallocgrps = nallocgrps;\n            int rv;\n\n            rv = getgrouplist(user, primary, grps, &nallocgrps);\n\n            /* Some systems (like Darwin) have a bug where they\n               never increase max_n_groups.  */\n            if (rv < 0 && nprevallocgrps == nallocgrps)\n                nallocgrps *= 2;\n\n            /* either shrinks to actual size, or enlarges to new size */\n            grps = g_renew(gid_t, grps, nallocgrps);\n\n            if (rv >= 0) {\n                ret = rv;\n                *list = grps;\n                break;\n            }\n        }\n    }\n\n    if (gid != (gid_t)-1) {\n        size_t i;\n\n        for (i = 0; i < ret; i++) {\n            if ((*list)[i] == gid)\n                goto cleanup;\n        }\n        if (VIR_APPEND_ELEMENT(*list, i, gid) < 0) {\n            ret = -1;\n            VIR_FREE(*list);\n            goto cleanup;\n        } else {\n            ret = i;\n        }\n    }\n\n cleanup:\n    VIR_FREE(user);\n    return ret;\n}"
  },
  {
    "function_name": "virDoesGroupExist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "942-946",
    "snippet": "bool\nvirDoesGroupExist(const char *name)\n{\n    return virGetGroupIDByName(name, NULL, true) == 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetGroupIDByName",
          "args": [
            "name",
            "NULL",
            "true"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupIDByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "853-897",
          "snippet": "static int\nvirGetGroupIDByName(const char *name, gid_t *gid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getgrnam_r(name, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!gr) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getgrnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"Group record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (gid)\n        *gid = gr->gr_gid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetGroupIDByName(const char *name, gid_t *gid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getgrnam_r(name, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!gr) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getgrnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"Group record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (gid)\n        *gid = gr->gr_gid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirDoesGroupExist(const char *name)\n{\n    return virGetGroupIDByName(name, NULL, true) == 0;\n}"
  },
  {
    "function_name": "virDoesUserExist",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "933-937",
    "snippet": "bool\nvirDoesUserExist(const char *name)\n{\n    return virGetUserIDByName(name, NULL, true) == 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetUserIDByName",
          "args": [
            "name",
            "NULL",
            "true"
          ],
          "line": 936
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserIDByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "771-815",
          "snippet": "static int\nvirGetUserIDByName(const char *name, uid_t *uid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getpwnam_r(name, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!pw) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getpwnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"User record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (uid)\n        *uid = pw->pw_uid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserIDByName(const char *name, uid_t *uid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getpwnam_r(name, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!pw) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getpwnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"User record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (uid)\n        *uid = pw->pw_uid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirDoesUserExist(const char *name)\n{\n    return virGetUserIDByName(name, NULL, true) == 0;\n}"
  },
  {
    "function_name": "virGetGroupID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "905-928",
    "snippet": "int\nvirGetGroupID(const char *group, gid_t *gid)\n{\n    unsigned int uint_gid;\n\n    if (*group == '+') {\n        group++;\n    } else {\n        int rc = virGetGroupIDByName(group, gid, false);\n        if (rc <= 0)\n            return rc;\n    }\n\n    if (virStrToLong_ui(group, NULL, 10, &uint_gid) < 0 ||\n        ((gid_t) uint_gid) != uint_gid) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Failed to parse group '%s'\"),\n                       group);\n        return -1;\n    }\n\n    *gid = uint_gid;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Failed to parse group '%s'\")",
            "group"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse group '%s'\""
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "group",
            "NULL",
            "10",
            "&uint_gid"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupIDByName",
          "args": [
            "group",
            "gid",
            "false"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupIDByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "853-897",
          "snippet": "static int\nvirGetGroupIDByName(const char *name, gid_t *gid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getgrnam_r(name, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!gr) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getgrnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"Group record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (gid)\n        *gid = gr->gr_gid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetGroupIDByName(const char *name, gid_t *gid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getgrnam_r(name, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!gr) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getgrnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"Group record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (gid)\n        *gid = gr->gr_gid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetGroupID(const char *group, gid_t *gid)\n{\n    unsigned int uint_gid;\n\n    if (*group == '+') {\n        group++;\n    } else {\n        int rc = virGetGroupIDByName(group, gid, false);\n        if (rc <= 0)\n            return rc;\n    }\n\n    if (virStrToLong_ui(group, NULL, 10, &uint_gid) < 0 ||\n        ((gid_t) uint_gid) != uint_gid) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Failed to parse group '%s'\"),\n                       group);\n        return -1;\n    }\n\n    *gid = uint_gid;\n\n    return 0;\n}"
  },
  {
    "function_name": "virGetGroupIDByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "853-897",
    "snippet": "static int\nvirGetGroupIDByName(const char *name, gid_t *gid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getgrnam_r(name, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!gr) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getgrnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"Group record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (gid)\n        *gid = gr->gr_gid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strbuf"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Group record for user '%s' was not found: %s\"",
            "name",
            "g_strerror(rc)"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "rc"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "strbuf",
            "strbuflen",
            "strbuflen",
            "strbuflen"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getgrnam_r",
          "args": [
            "name",
            "&grbuf",
            "strbuf",
            "strbuflen",
            "&gr"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "strbuf",
            "strbuflen"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_GETGR_R_SIZE_MAX"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetGroupIDByName(const char *name, gid_t *gid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getgrnam_r(name, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!gr) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getgrnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"Group record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (gid)\n        *gid = gr->gr_gid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}"
  },
  {
    "function_name": "virGetUserID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "823-846",
    "snippet": "int\nvirGetUserID(const char *user, uid_t *uid)\n{\n    unsigned int uint_uid;\n\n    if (*user == '+') {\n        user++;\n    } else {\n        int rc = virGetUserIDByName(user, uid, false);\n        if (rc <= 0)\n            return rc;\n    }\n\n    if (virStrToLong_ui(user, NULL, 10, &uint_uid) < 0 ||\n        ((uid_t) uint_uid) != uint_uid) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Failed to parse user '%s'\"),\n                       user);\n        return -1;\n    }\n\n    *uid = uint_uid;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Failed to parse user '%s'\")",
            "user"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse user '%s'\""
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "user",
            "NULL",
            "10",
            "&uint_uid"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserIDByName",
          "args": [
            "user",
            "uid",
            "false"
          ],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserIDByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "771-815",
          "snippet": "static int\nvirGetUserIDByName(const char *name, uid_t *uid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getpwnam_r(name, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!pw) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getpwnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"User record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (uid)\n        *uid = pw->pw_uid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserIDByName(const char *name, uid_t *uid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getpwnam_r(name, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!pw) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getpwnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"User record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (uid)\n        *uid = pw->pw_uid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetUserID(const char *user, uid_t *uid)\n{\n    unsigned int uint_uid;\n\n    if (*user == '+') {\n        user++;\n    } else {\n        int rc = virGetUserIDByName(user, uid, false);\n        if (rc <= 0)\n            return rc;\n    }\n\n    if (virStrToLong_ui(user, NULL, 10, &uint_uid) < 0 ||\n        ((uid_t) uint_uid) != uint_uid) {\n        virReportError(VIR_ERR_INVALID_ARG, _(\"Failed to parse user '%s'\"),\n                       user);\n        return -1;\n    }\n\n    *uid = uint_uid;\n\n    return 0;\n}"
  },
  {
    "function_name": "virGetUserIDByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "771-815",
    "snippet": "static int\nvirGetUserIDByName(const char *name, uid_t *uid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getpwnam_r(name, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!pw) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getpwnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"User record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (uid)\n        *uid = pw->pw_uid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strbuf"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"User record for user '%s' was not found: %s\"",
            "name",
            "g_strerror(rc)"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "rc"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "strbuf",
            "strbuflen",
            "strbuflen",
            "strbuflen"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwnam_r",
          "args": [
            "name",
            "&pwbuf",
            "strbuf",
            "strbuflen",
            "&pw"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "strbuf",
            "strbuflen"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_GETPW_R_SIZE_MAX"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserIDByName(const char *name, uid_t *uid, bool missing_ok)\n{\n    char *strbuf = NULL;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        goto cleanup;\n\n    while ((rc = getpwnam_r(name, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (!pw) {\n        if (rc != 0 && !missing_ok) {\n            /* log the possible error from getpwnam_r. Unfortunately error\n             * reporting from this function is bad and we can't really\n             * rely on it, so we just report that the user wasn't found */\n            VIR_WARN(\"User record for user '%s' was not found: %s\",\n                     name, g_strerror(rc));\n        }\n\n        ret = 1;\n        goto cleanup;\n    }\n\n    if (uid)\n        *uid = pw->pw_uid;\n    ret = 0;\n\n cleanup:\n    VIR_FREE(strbuf);\n\n    return ret;\n}"
  },
  {
    "function_name": "virGetGroupName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "761-764",
    "snippet": "char *virGetGroupName(gid_t gid)\n{\n    return virGetGroupEnt(gid);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetGroupEnt",
          "args": [
            "gid"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupEnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "686-734",
          "snippet": "static char *virGetGroupEnt(gid_t gid)\n{\n    char *strbuf;\n    char *ret;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return NULL;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or gid was not found.\n     */\n    while ((rc = getgrgid_r(gid, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0) {\n            VIR_FREE(strbuf);\n            return NULL;\n        }\n    }\n    if (rc != 0 || gr == NULL) {\n        if (rc != 0) {\n            virReportSystemError(rc,\n                                 _(\"Failed to find group record for gid '%u'\"),\n                                 (unsigned int) gid);\n        } else {\n            virReportError(VIR_ERR_SYSTEM_ERROR,\n                           _(\"Failed to find group record for gid '%u'\"),\n                           (unsigned int) gid);\n        }\n\n        VIR_FREE(strbuf);\n        return NULL;\n    }\n\n    ret = g_strdup(gr->gr_name);\n    VIR_FREE(strbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *virGetGroupEnt(gid_t gid)\n{\n    char *strbuf;\n    char *ret;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return NULL;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or gid was not found.\n     */\n    while ((rc = getgrgid_r(gid, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0) {\n            VIR_FREE(strbuf);\n            return NULL;\n        }\n    }\n    if (rc != 0 || gr == NULL) {\n        if (rc != 0) {\n            virReportSystemError(rc,\n                                 _(\"Failed to find group record for gid '%u'\"),\n                                 (unsigned int) gid);\n        } else {\n            virReportError(VIR_ERR_SYSTEM_ERROR,\n                           _(\"Failed to find group record for gid '%u'\"),\n                           (unsigned int) gid);\n        }\n\n        VIR_FREE(strbuf);\n        return NULL;\n    }\n\n    ret = g_strdup(gr->gr_name);\n    VIR_FREE(strbuf);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetGroupName(gid_t gid)\n{\n    return virGetGroupEnt(gid);\n}"
  },
  {
    "function_name": "virGetUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "754-759",
    "snippet": "char *virGetUserName(uid_t uid)\n{\n    char *ret;\n    virGetUserEnt(uid, &ret, NULL, NULL, NULL, false);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetUserEnt",
          "args": [
            "uid",
            "&ret",
            "NULL",
            "NULL",
            "NULL",
            "false"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserEnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "608-684",
          "snippet": "static int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserName(uid_t uid)\n{\n    char *ret;\n    virGetUserEnt(uid, &ret, NULL, NULL, NULL, false);\n    return ret;\n}"
  },
  {
    "function_name": "virGetUserShell",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "746-751",
    "snippet": "char *virGetUserShell(uid_t uid)\n{\n    char *ret;\n    virGetUserEnt(uid, NULL, NULL, NULL, &ret, false);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetUserEnt",
          "args": [
            "uid",
            "NULL",
            "NULL",
            "NULL",
            "&ret",
            "false"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserEnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "608-684",
          "snippet": "static int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserShell(uid_t uid)\n{\n    char *ret;\n    virGetUserEnt(uid, NULL, NULL, NULL, &ret, false);\n    return ret;\n}"
  },
  {
    "function_name": "virGetUserDirectoryByUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "737-743",
    "snippet": "char *\nvirGetUserDirectoryByUID(uid_t uid)\n{\n    char *ret;\n    virGetUserEnt(uid, NULL, NULL, &ret, NULL, false);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetUserEnt",
          "args": [
            "uid",
            "NULL",
            "NULL",
            "&ret",
            "NULL",
            "false"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserEnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "608-684",
          "snippet": "static int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserDirectoryByUID(uid_t uid)\n{\n    char *ret;\n    virGetUserEnt(uid, NULL, NULL, &ret, NULL, false);\n    return ret;\n}"
  },
  {
    "function_name": "virGetGroupEnt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "686-734",
    "snippet": "static char *virGetGroupEnt(gid_t gid)\n{\n    char *strbuf;\n    char *ret;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return NULL;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or gid was not found.\n     */\n    while ((rc = getgrgid_r(gid, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0) {\n            VIR_FREE(strbuf);\n            return NULL;\n        }\n    }\n    if (rc != 0 || gr == NULL) {\n        if (rc != 0) {\n            virReportSystemError(rc,\n                                 _(\"Failed to find group record for gid '%u'\"),\n                                 (unsigned int) gid);\n        } else {\n            virReportError(VIR_ERR_SYSTEM_ERROR,\n                           _(\"Failed to find group record for gid '%u'\"),\n                           (unsigned int) gid);\n        }\n\n        VIR_FREE(strbuf);\n        return NULL;\n    }\n\n    ret = g_strdup(gr->gr_name);\n    VIR_FREE(strbuf);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strbuf"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "gr->gr_name"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strbuf"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_SYSTEM_ERROR",
            "_(\"Failed to find group record for gid '%u'\")",
            "(unsigned int) gid"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "rc",
            "_(\"Failed to find group record for gid '%u'\")",
            "(unsigned int) gid"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strbuf"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "strbuf",
            "strbuflen",
            "strbuflen",
            "strbuflen"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getgrgid_r",
          "args": [
            "gid",
            "&grbuf",
            "strbuf",
            "strbuflen",
            "&gr"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "strbuf",
            "strbuflen"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_GETGR_R_SIZE_MAX"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *virGetGroupEnt(gid_t gid)\n{\n    char *strbuf;\n    char *ret;\n    struct group grbuf;\n    struct group *gr = NULL;\n    long val = sysconf(_SC_GETGR_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return NULL;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or gid was not found.\n     */\n    while ((rc = getgrgid_r(gid, &grbuf, strbuf, strbuflen, &gr)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0) {\n            VIR_FREE(strbuf);\n            return NULL;\n        }\n    }\n    if (rc != 0 || gr == NULL) {\n        if (rc != 0) {\n            virReportSystemError(rc,\n                                 _(\"Failed to find group record for gid '%u'\"),\n                                 (unsigned int) gid);\n        } else {\n            virReportError(VIR_ERR_SYSTEM_ERROR,\n                           _(\"Failed to find group record for gid '%u'\"),\n                           (unsigned int) gid);\n        }\n\n        VIR_FREE(strbuf);\n        return NULL;\n    }\n\n    ret = g_strdup(gr->gr_name);\n    VIR_FREE(strbuf);\n    return ret;\n}"
  },
  {
    "function_name": "virGetUserEnt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "608-684",
    "snippet": "static int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "strbuf"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*shell"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*dir"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*name"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "pw->pw_shell"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_SYSTEM_ERROR",
            "_(\"Failed to find user record for uid '%u'\")",
            "(unsigned int) uid"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "rc",
            "_(\"Failed to find user record for uid '%u'\")",
            "(unsigned int) uid"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "strbuf",
            "strbuflen",
            "strbuflen",
            "strbuflen"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid_r",
          "args": [
            "uid",
            "&pwbuf",
            "strbuf",
            "strbuflen",
            "&pw"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "strbuf",
            "strbuflen"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_GETPW_R_SIZE_MAX"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirGetUserEnt(uid_t uid, char **name, gid_t *group, char **dir, char **shell, bool quiet)\n{\n    char *strbuf;\n    struct passwd pwbuf;\n    struct passwd *pw = NULL;\n    long val = sysconf(_SC_GETPW_R_SIZE_MAX);\n    size_t strbuflen = val;\n    int rc;\n    int ret = -1;\n\n    if (name)\n        *name = NULL;\n    if (dir)\n        *dir = NULL;\n    if (shell)\n        *shell = NULL;\n\n    /* sysconf is a hint; if it fails, fall back to a reasonable size */\n    if (val < 0)\n        strbuflen = 1024;\n\n    if (VIR_ALLOC_N(strbuf, strbuflen) < 0)\n        return -1;\n\n    /*\n     * From the manpage (terrifying but true):\n     *\n     * ERRORS\n     *  0 or ENOENT or ESRCH or EBADF or EPERM or ...\n     *        The given name or uid was not found.\n     */\n    while ((rc = getpwuid_r(uid, &pwbuf, strbuf, strbuflen, &pw)) == ERANGE) {\n        if (VIR_RESIZE_N(strbuf, strbuflen, strbuflen, strbuflen) < 0)\n            goto cleanup;\n    }\n\n    if (rc != 0) {\n        if (quiet)\n            goto cleanup;\n\n        virReportSystemError(rc,\n                             _(\"Failed to find user record for uid '%u'\"),\n                             (unsigned int) uid);\n        goto cleanup;\n    } else if (pw == NULL) {\n        if (quiet)\n            goto cleanup;\n\n        virReportError(VIR_ERR_SYSTEM_ERROR,\n                       _(\"Failed to find user record for uid '%u'\"),\n                       (unsigned int) uid);\n        goto cleanup;\n    }\n\n    if (name)\n        *name = g_strdup(pw->pw_name);\n    if (group)\n        *group = pw->pw_gid;\n    if (dir)\n        *dir = g_strdup(pw->pw_dir);\n    if (shell)\n        *shell = g_strdup(pw->pw_shell);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        if (name)\n            VIR_FREE(*name);\n        if (dir)\n            VIR_FREE(*dir);\n        if (shell)\n            VIR_FREE(*shell);\n    }\n    VIR_FREE(strbuf);\n    return ret;\n}"
  },
  {
    "function_name": "virGetUserRuntimeDirectory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "594-601",
    "snippet": "char *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_build_filename",
          "args": [
            "g_get_user_runtime_dir()",
            "\"libvirt\"",
            "NULL"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_get_user_runtime_dir",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "g_get_user_runtime_dir()"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_user_runtime_dir",
          "args": [],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}"
  },
  {
    "function_name": "virGetUserCacheDirectory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "584-591",
    "snippet": "char *virGetUserCacheDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_cache_dir());\n#else\n    return g_build_filename(g_get_user_cache_dir(), \"libvirt\", NULL);\n#endif\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_build_filename",
          "args": [
            "g_get_user_cache_dir()",
            "\"libvirt\"",
            "NULL"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_get_user_cache_dir",
          "args": [],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "g_get_user_cache_dir()"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_user_cache_dir",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserCacheDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_cache_dir());\n#else\n    return g_build_filename(g_get_user_cache_dir(), \"libvirt\", NULL);\n#endif\n}"
  },
  {
    "function_name": "virGetUserConfigDirectory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "574-581",
    "snippet": "char *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_build_filename",
          "args": [
            "g_get_user_config_dir()",
            "\"libvirt\"",
            "NULL"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_get_user_config_dir",
          "args": [],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "g_get_user_config_dir()"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_user_config_dir",
          "args": [],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}"
  },
  {
    "function_name": "virGetUserDirectory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "567-571",
    "snippet": "char *\nvirGetUserDirectory(void)\n{\n    return g_strdup(g_get_home_dir());\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "g_get_home_dir()"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_home_dir",
          "args": [],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetUserDirectory(void)\n{\n    return g_strdup(g_get_home_dir());\n}"
  },
  {
    "function_name": "virGetHostnameQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "560-564",
    "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetHostnameImpl",
          "args": [
            "true"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "493-550",
          "snippet": "static char *\nvirGetHostnameImpl(bool quiet)\n{\n    int r;\n    const char *hostname;\n    char *result = NULL;\n    struct addrinfo hints, *info;\n\n    hostname = g_get_host_name();\n\n    if (STRPREFIX(hostname, \"localhost\") || strchr(hostname, '.')) {\n        /* in this case, gethostname returned localhost (meaning we can't\n         * do any further canonicalization), or it returned an FQDN (and\n         * we don't need to do any further canonicalization).  Return the\n         * string as-is; it's up to callers to check whether \"localhost\"\n         * is allowed.\n         */\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* otherwise, it's a shortened, non-localhost, hostname.  Attempt to\n     * canonicalize the hostname by running it through getaddrinfo\n     */\n\n    memset(&hints, 0, sizeof(hints));\n    hints.ai_flags = AI_CANONNAME|AI_CANONIDN;\n    hints.ai_family = AF_UNSPEC;\n    r = getaddrinfo(hostname, NULL, &hints, &info);\n    if (r != 0) {\n        if (!quiet)\n            VIR_WARN(\"getaddrinfo failed for '%s': %s\",\n                     hostname, gai_strerror(r));\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* Tell static analyzers about getaddrinfo semantics.  */\n    sa_assert(info);\n\n    if (info->ai_canonname == NULL ||\n        STRPREFIX(info->ai_canonname, \"localhost\"))\n        /* in this case, we tried to canonicalize and we ended up back with\n         * localhost.  Ignore the canonicalized name and just return the\n         * original hostname\n         */\n        result = g_strdup(hostname);\n    else\n        /* Caller frees this string. */\n        result = g_strdup(info->ai_canonname);\n\n    freeaddrinfo(info);\n\n cleanup:\n    if (!result)\n        virReportOOMError();\n    return result;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirGetHostnameImpl(bool quiet)\n{\n    int r;\n    const char *hostname;\n    char *result = NULL;\n    struct addrinfo hints, *info;\n\n    hostname = g_get_host_name();\n\n    if (STRPREFIX(hostname, \"localhost\") || strchr(hostname, '.')) {\n        /* in this case, gethostname returned localhost (meaning we can't\n         * do any further canonicalization), or it returned an FQDN (and\n         * we don't need to do any further canonicalization).  Return the\n         * string as-is; it's up to callers to check whether \"localhost\"\n         * is allowed.\n         */\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* otherwise, it's a shortened, non-localhost, hostname.  Attempt to\n     * canonicalize the hostname by running it through getaddrinfo\n     */\n\n    memset(&hints, 0, sizeof(hints));\n    hints.ai_flags = AI_CANONNAME|AI_CANONIDN;\n    hints.ai_family = AF_UNSPEC;\n    r = getaddrinfo(hostname, NULL, &hints, &info);\n    if (r != 0) {\n        if (!quiet)\n            VIR_WARN(\"getaddrinfo failed for '%s': %s\",\n                     hostname, gai_strerror(r));\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* Tell static analyzers about getaddrinfo semantics.  */\n    sa_assert(info);\n\n    if (info->ai_canonname == NULL ||\n        STRPREFIX(info->ai_canonname, \"localhost\"))\n        /* in this case, we tried to canonicalize and we ended up back with\n         * localhost.  Ignore the canonicalized name and just return the\n         * original hostname\n         */\n        result = g_strdup(hostname);\n    else\n        /* Caller frees this string. */\n        result = g_strdup(info->ai_canonname);\n\n    freeaddrinfo(info);\n\n cleanup:\n    if (!result)\n        virReportOOMError();\n    return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
  },
  {
    "function_name": "virGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "553-557",
    "snippet": "char *\nvirGetHostname(void)\n{\n    return virGetHostnameImpl(false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetHostnameImpl",
          "args": [
            "false"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "493-550",
          "snippet": "static char *\nvirGetHostnameImpl(bool quiet)\n{\n    int r;\n    const char *hostname;\n    char *result = NULL;\n    struct addrinfo hints, *info;\n\n    hostname = g_get_host_name();\n\n    if (STRPREFIX(hostname, \"localhost\") || strchr(hostname, '.')) {\n        /* in this case, gethostname returned localhost (meaning we can't\n         * do any further canonicalization), or it returned an FQDN (and\n         * we don't need to do any further canonicalization).  Return the\n         * string as-is; it's up to callers to check whether \"localhost\"\n         * is allowed.\n         */\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* otherwise, it's a shortened, non-localhost, hostname.  Attempt to\n     * canonicalize the hostname by running it through getaddrinfo\n     */\n\n    memset(&hints, 0, sizeof(hints));\n    hints.ai_flags = AI_CANONNAME|AI_CANONIDN;\n    hints.ai_family = AF_UNSPEC;\n    r = getaddrinfo(hostname, NULL, &hints, &info);\n    if (r != 0) {\n        if (!quiet)\n            VIR_WARN(\"getaddrinfo failed for '%s': %s\",\n                     hostname, gai_strerror(r));\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* Tell static analyzers about getaddrinfo semantics.  */\n    sa_assert(info);\n\n    if (info->ai_canonname == NULL ||\n        STRPREFIX(info->ai_canonname, \"localhost\"))\n        /* in this case, we tried to canonicalize and we ended up back with\n         * localhost.  Ignore the canonicalized name and just return the\n         * original hostname\n         */\n        result = g_strdup(hostname);\n    else\n        /* Caller frees this string. */\n        result = g_strdup(info->ai_canonname);\n\n    freeaddrinfo(info);\n\n cleanup:\n    if (!result)\n        virReportOOMError();\n    return result;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirGetHostnameImpl(bool quiet)\n{\n    int r;\n    const char *hostname;\n    char *result = NULL;\n    struct addrinfo hints, *info;\n\n    hostname = g_get_host_name();\n\n    if (STRPREFIX(hostname, \"localhost\") || strchr(hostname, '.')) {\n        /* in this case, gethostname returned localhost (meaning we can't\n         * do any further canonicalization), or it returned an FQDN (and\n         * we don't need to do any further canonicalization).  Return the\n         * string as-is; it's up to callers to check whether \"localhost\"\n         * is allowed.\n         */\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* otherwise, it's a shortened, non-localhost, hostname.  Attempt to\n     * canonicalize the hostname by running it through getaddrinfo\n     */\n\n    memset(&hints, 0, sizeof(hints));\n    hints.ai_flags = AI_CANONNAME|AI_CANONIDN;\n    hints.ai_family = AF_UNSPEC;\n    r = getaddrinfo(hostname, NULL, &hints, &info);\n    if (r != 0) {\n        if (!quiet)\n            VIR_WARN(\"getaddrinfo failed for '%s': %s\",\n                     hostname, gai_strerror(r));\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* Tell static analyzers about getaddrinfo semantics.  */\n    sa_assert(info);\n\n    if (info->ai_canonname == NULL ||\n        STRPREFIX(info->ai_canonname, \"localhost\"))\n        /* in this case, we tried to canonicalize and we ended up back with\n         * localhost.  Ignore the canonicalized name and just return the\n         * original hostname\n         */\n        result = g_strdup(hostname);\n    else\n        /* Caller frees this string. */\n        result = g_strdup(info->ai_canonname);\n\n    freeaddrinfo(info);\n\n cleanup:\n    if (!result)\n        virReportOOMError();\n    return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostname(void)\n{\n    return virGetHostnameImpl(false);\n}"
  },
  {
    "function_name": "virGetHostnameImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "493-550",
    "snippet": "static char *\nvirGetHostnameImpl(bool quiet)\n{\n    int r;\n    const char *hostname;\n    char *result = NULL;\n    struct addrinfo hints, *info;\n\n    hostname = g_get_host_name();\n\n    if (STRPREFIX(hostname, \"localhost\") || strchr(hostname, '.')) {\n        /* in this case, gethostname returned localhost (meaning we can't\n         * do any further canonicalization), or it returned an FQDN (and\n         * we don't need to do any further canonicalization).  Return the\n         * string as-is; it's up to callers to check whether \"localhost\"\n         * is allowed.\n         */\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* otherwise, it's a shortened, non-localhost, hostname.  Attempt to\n     * canonicalize the hostname by running it through getaddrinfo\n     */\n\n    memset(&hints, 0, sizeof(hints));\n    hints.ai_flags = AI_CANONNAME|AI_CANONIDN;\n    hints.ai_family = AF_UNSPEC;\n    r = getaddrinfo(hostname, NULL, &hints, &info);\n    if (r != 0) {\n        if (!quiet)\n            VIR_WARN(\"getaddrinfo failed for '%s': %s\",\n                     hostname, gai_strerror(r));\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* Tell static analyzers about getaddrinfo semantics.  */\n    sa_assert(info);\n\n    if (info->ai_canonname == NULL ||\n        STRPREFIX(info->ai_canonname, \"localhost\"))\n        /* in this case, we tried to canonicalize and we ended up back with\n         * localhost.  Ignore the canonicalized name and just return the\n         * original hostname\n         */\n        result = g_strdup(hostname);\n    else\n        /* Caller frees this string. */\n        result = g_strdup(info->ai_canonname);\n\n    freeaddrinfo(info);\n\n cleanup:\n    if (!result)\n        virReportOOMError();\n    return result;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freeaddrinfo",
          "args": [
            "info"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "info->ai_canonname"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "info->ai_canonname",
            "\"localhost\""
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sa_assert",
          "args": [
            "info"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"getaddrinfo failed for '%s': %s\"",
            "hostname",
            "gai_strerror(r)"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gai_strerror",
          "args": [
            "r"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getaddrinfo",
          "args": [
            "hostname",
            "NULL",
            "&hints",
            "&info"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&hints",
            "0",
            "sizeof(hints)"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "hostname",
            "'.'"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "hostname",
            "\"localhost\""
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_get_host_name",
          "args": [],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirGetHostnameImpl(bool quiet)\n{\n    int r;\n    const char *hostname;\n    char *result = NULL;\n    struct addrinfo hints, *info;\n\n    hostname = g_get_host_name();\n\n    if (STRPREFIX(hostname, \"localhost\") || strchr(hostname, '.')) {\n        /* in this case, gethostname returned localhost (meaning we can't\n         * do any further canonicalization), or it returned an FQDN (and\n         * we don't need to do any further canonicalization).  Return the\n         * string as-is; it's up to callers to check whether \"localhost\"\n         * is allowed.\n         */\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* otherwise, it's a shortened, non-localhost, hostname.  Attempt to\n     * canonicalize the hostname by running it through getaddrinfo\n     */\n\n    memset(&hints, 0, sizeof(hints));\n    hints.ai_flags = AI_CANONNAME|AI_CANONIDN;\n    hints.ai_family = AF_UNSPEC;\n    r = getaddrinfo(hostname, NULL, &hints, &info);\n    if (r != 0) {\n        if (!quiet)\n            VIR_WARN(\"getaddrinfo failed for '%s': %s\",\n                     hostname, gai_strerror(r));\n        result = g_strdup(hostname);\n        goto cleanup;\n    }\n\n    /* Tell static analyzers about getaddrinfo semantics.  */\n    sa_assert(info);\n\n    if (info->ai_canonname == NULL ||\n        STRPREFIX(info->ai_canonname, \"localhost\"))\n        /* in this case, we tried to canonicalize and we ended up back with\n         * localhost.  Ignore the canonicalized name and just return the\n         * original hostname\n         */\n        result = g_strdup(hostname);\n    else\n        /* Caller frees this string. */\n        result = g_strdup(info->ai_canonname);\n\n    freeaddrinfo(info);\n\n cleanup:\n    if (!result)\n        virReportOOMError();\n    return result;\n}"
  },
  {
    "function_name": "virIndexToDiskName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "436-463",
    "snippet": "char *virIndexToDiskName(int idx, const char *prefix)\n{\n    char *name = NULL;\n    size_t i;\n    int ctr;\n    int offset;\n\n    if (idx < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Disk index %d is negative\"), idx);\n        return NULL;\n    }\n\n    for (i = 0, ctr = idx; ctr >= 0; ++i, ctr = ctr / 26 - 1) { }\n\n    offset = strlen(prefix);\n\n    if (VIR_ALLOC_N(name, offset + i + 1))\n        return NULL;\n\n    strcpy(name, prefix);\n    name[offset + i] = '\\0';\n\n    for (i = i - 1, ctr = idx; ctr >= 0; --i, ctr = ctr / 26 - 1)\n        name[offset + i] = 'a' + (ctr % 26);\n\n    return name;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "name",
            "prefix"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "name",
            "offset + i + 1"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Disk index %d is negative\")",
            "idx"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Disk index %d is negative\""
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virIndexToDiskName(int idx, const char *prefix)\n{\n    char *name = NULL;\n    size_t i;\n    int ctr;\n    int offset;\n\n    if (idx < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Disk index %d is negative\"), idx);\n        return NULL;\n    }\n\n    for (i = 0, ctr = idx; ctr >= 0; ++i, ctr = ctr / 26 - 1) { }\n\n    offset = strlen(prefix);\n\n    if (VIR_ALLOC_N(name, offset + i + 1))\n        return NULL;\n\n    strcpy(name, prefix);\n    name[offset + i] = '\\0';\n\n    for (i = i - 1, ctr = idx; ctr >= 0; --i, ctr = ctr / 26 - 1)\n        name[offset + i] = 'a' + (ctr % 26);\n\n    return name;\n}"
  },
  {
    "function_name": "virDiskNameToIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "426-434",
    "snippet": "int virDiskNameToIndex(const char *name)\n{\n    int idx;\n\n    if (virDiskNameParse(name, &idx, NULL) < 0)\n        idx = -1;\n\n    return idx;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDiskNameParse",
          "args": [
            "name",
            "&idx",
            "NULL"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "virDiskNameParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "371-418",
          "snippet": "int virDiskNameParse(const char *name, int *disk, int *partition)\n{\n    const char *ptr = NULL;\n    char *rem;\n    int idx = 0;\n    static char const* const drive_prefix[] = {\"fd\", \"hd\", \"vd\", \"sd\", \"xvd\", \"ubd\"};\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(drive_prefix); i++) {\n        if (STRPREFIX(name, drive_prefix[i])) {\n            ptr = name + strlen(drive_prefix[i]);\n            break;\n        }\n    }\n\n    if (!ptr || !g_ascii_islower(*ptr))\n        return -1;\n\n    for (i = 0; *ptr; i++) {\n        if (!g_ascii_islower(*ptr))\n            break;\n\n        idx = (idx + (i < 1 ? 0 : 1)) * 26;\n        idx += *ptr - 'a';\n        ptr++;\n    }\n\n    /* Count the trailing digits.  */\n    size_t n_digits = strspn(ptr, \"0123456789\");\n    if (ptr[n_digits] != '\\0')\n        return -1;\n\n    *disk = idx;\n\n    /* Convert trailing digits into our partition index */\n    if (partition) {\n        *partition = 0;\n\n        /* Shouldn't start by zero */\n        if (n_digits > 1 && *ptr == '0')\n            return -1;\n\n        if (n_digits && virStrToLong_i(ptr, &rem, 10, partition) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virDiskNameParse(const char *name, int *disk, int *partition)\n{\n    const char *ptr = NULL;\n    char *rem;\n    int idx = 0;\n    static char const* const drive_prefix[] = {\"fd\", \"hd\", \"vd\", \"sd\", \"xvd\", \"ubd\"};\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(drive_prefix); i++) {\n        if (STRPREFIX(name, drive_prefix[i])) {\n            ptr = name + strlen(drive_prefix[i]);\n            break;\n        }\n    }\n\n    if (!ptr || !g_ascii_islower(*ptr))\n        return -1;\n\n    for (i = 0; *ptr; i++) {\n        if (!g_ascii_islower(*ptr))\n            break;\n\n        idx = (idx + (i < 1 ? 0 : 1)) * 26;\n        idx += *ptr - 'a';\n        ptr++;\n    }\n\n    /* Count the trailing digits.  */\n    size_t n_digits = strspn(ptr, \"0123456789\");\n    if (ptr[n_digits] != '\\0')\n        return -1;\n\n    *disk = idx;\n\n    /* Convert trailing digits into our partition index */\n    if (partition) {\n        *partition = 0;\n\n        /* Shouldn't start by zero */\n        if (n_digits > 1 && *ptr == '0')\n            return -1;\n\n        if (n_digits && virStrToLong_i(ptr, &rem, 10, partition) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virDiskNameToIndex(const char *name)\n{\n    int idx;\n\n    if (virDiskNameParse(name, &idx, NULL) < 0)\n        idx = -1;\n\n    return idx;\n}"
  },
  {
    "function_name": "virDiskNameParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "371-418",
    "snippet": "int virDiskNameParse(const char *name, int *disk, int *partition)\n{\n    const char *ptr = NULL;\n    char *rem;\n    int idx = 0;\n    static char const* const drive_prefix[] = {\"fd\", \"hd\", \"vd\", \"sd\", \"xvd\", \"ubd\"};\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(drive_prefix); i++) {\n        if (STRPREFIX(name, drive_prefix[i])) {\n            ptr = name + strlen(drive_prefix[i]);\n            break;\n        }\n    }\n\n    if (!ptr || !g_ascii_islower(*ptr))\n        return -1;\n\n    for (i = 0; *ptr; i++) {\n        if (!g_ascii_islower(*ptr))\n            break;\n\n        idx = (idx + (i < 1 ? 0 : 1)) * 26;\n        idx += *ptr - 'a';\n        ptr++;\n    }\n\n    /* Count the trailing digits.  */\n    size_t n_digits = strspn(ptr, \"0123456789\");\n    if (ptr[n_digits] != '\\0')\n        return -1;\n\n    *disk = idx;\n\n    /* Convert trailing digits into our partition index */\n    if (partition) {\n        *partition = 0;\n\n        /* Shouldn't start by zero */\n        if (n_digits > 1 && *ptr == '0')\n            return -1;\n\n        if (n_digits && virStrToLong_i(ptr, &rem, 10, partition) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "ptr",
            "&rem",
            "10",
            "partition"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "ptr",
            "\"0123456789\""
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_islower",
          "args": [
            "*ptr"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_islower",
          "args": [
            "*ptr"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "drive_prefix[i]"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "name",
            "drive_prefix[i]"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "drive_prefix"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virDiskNameParse(const char *name, int *disk, int *partition)\n{\n    const char *ptr = NULL;\n    char *rem;\n    int idx = 0;\n    static char const* const drive_prefix[] = {\"fd\", \"hd\", \"vd\", \"sd\", \"xvd\", \"ubd\"};\n    size_t i;\n\n    for (i = 0; i < G_N_ELEMENTS(drive_prefix); i++) {\n        if (STRPREFIX(name, drive_prefix[i])) {\n            ptr = name + strlen(drive_prefix[i]);\n            break;\n        }\n    }\n\n    if (!ptr || !g_ascii_islower(*ptr))\n        return -1;\n\n    for (i = 0; *ptr; i++) {\n        if (!g_ascii_islower(*ptr))\n            break;\n\n        idx = (idx + (i < 1 ? 0 : 1)) * 26;\n        idx += *ptr - 'a';\n        ptr++;\n    }\n\n    /* Count the trailing digits.  */\n    size_t n_digits = strspn(ptr, \"0123456789\");\n    if (ptr[n_digits] != '\\0')\n        return -1;\n\n    *disk = idx;\n\n    /* Convert trailing digits into our partition index */\n    if (partition) {\n        *partition = 0;\n\n        /* Shouldn't start by zero */\n        if (n_digits > 1 && *ptr == '0')\n            return -1;\n\n        if (n_digits && virStrToLong_i(ptr, &rem, 10, partition) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFormatIntPretty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "327-360",
    "snippet": "unsigned long long\nvirFormatIntPretty(unsigned long long val,\n                   const char **unit)\n{\n    unsigned long long limit = 1024;\n\n    if (val % limit || val == 0) {\n        *unit = \"B\";\n        return val;\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"KiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"MiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"GiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"TiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    *unit = \"PiB\";\n    return val / (limit / 1024);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirFormatIntPretty(unsigned long long val,\n                   const char **unit)\n{\n    unsigned long long limit = 1024;\n\n    if (val % limit || val == 0) {\n        *unit = \"B\";\n        return val;\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"KiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"MiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"GiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    if (val % limit) {\n        *unit = \"TiB\";\n        return val / (limit / 1024);\n    }\n    limit *= 1024;\n    *unit = \"PiB\";\n    return val / (limit / 1024);\n}"
  },
  {
    "function_name": "virFormatIntDecimal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "292-310",
    "snippet": "char *\nvirFormatIntDecimal(char *buf, size_t buflen, int val)\n{\n    char *p = buf + buflen - 1;\n    *p = '\\0';\n    if (val >= 0) {\n        do {\n            *--p = '0' + (val % 10);\n            val /= 10;\n        } while (val != 0);\n    } else {\n        do {\n            *--p = '0' - (val % 10);\n            val /= 10;\n        } while (val != 0);\n        *--p = '-';\n    }\n    return p;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirFormatIntDecimal(char *buf, size_t buflen, int val)\n{\n    char *p = buf + buflen - 1;\n    *p = '\\0';\n    if (val >= 0) {\n        do {\n            *--p = '0' + (val % 10);\n            val /= 10;\n        } while (val != 0);\n    } else {\n        do {\n            *--p = '0' - (val % 10);\n            val /= 10;\n        } while (val != 0);\n        *--p = '-';\n    }\n    return p;\n}"
  },
  {
    "function_name": "virParseVersionString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "254-282",
    "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "tmp + 1",
            "&tmp",
            "10",
            "&micro"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
  },
  {
    "function_name": "virScaleInteger",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "175-235",
    "snippet": "int\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"value too large: %llu%s\")",
            "*value",
            "suffix"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"value too large: %llu%s\""
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown suffix '%s'\")",
            "suffix"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_tolower",
          "args": [
            "*suffix"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown suffix '%s'\")",
            "suffix"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_tolower",
          "args": [
            "suffix[1]"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "suffix + 1",
            "\"iB\""
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "suffix",
            "\"bytes\""
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "suffix",
            "\"byte\""
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "suffix",
            "\"b\""
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid scale %llu\")",
            "scale"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}"
  },
  {
    "function_name": "virSetSockReuseAddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "152-163",
    "snippet": "int virSetSockReuseAddr(int fd, bool fatal)\n{\n    int opt = 1;\n    int ret = setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt));\n\n    if (ret < 0 && fatal) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to set socket reuse addr flag\"));\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to set socket reuse addr flag\")"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set socket reuse addr flag\""
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "fd",
            "SOL_SOCKET",
            "SO_REUSEADDR",
            "&opt",
            "sizeof(opt)"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "vir_setsockopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "331-348",
          "snippet": "int\nvir_setsockopt(int fd, int level, int optname,\n               const void *optval, socklen_t optlen)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (setsockopt(sk, level, optname, optval, optlen) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_setsockopt(int fd, int level, int optname,\n               const void *optval, socklen_t optlen)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (setsockopt(sk, level, optname, optval, optlen) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetSockReuseAddr(int fd, bool fatal)\n{\n    int opt = 1;\n    int ret = setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &opt, sizeof(opt));\n\n    if (ret < 0 && fatal) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to set socket reuse addr flag\"));\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virSetSockReuseAddr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "137-150",
    "snippet": "int virSetSockReuseAddr(int fd G_GNUC_UNUSED, bool fatal G_GNUC_UNUSED)\n{\n    /*\n     * SO_REUSEADDR on Windows is actually akin to SO_REUSEPORT\n     * on Linux/BSD. ie it allows 2 apps to listen to the same\n     * port at once which is certainly not what we want here.\n     *\n     * Win32 sockets have Linux/BSD-like SO_REUSEADDR behaviour\n     * by default, so we can be a no-op.\n     *\n     * http://msdn.microsoft.com/en-us/library/windows/desktop/ms740621.aspx\n     */\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetSockReuseAddr(int fd G_GNUC_UNUSED, bool fatal G_GNUC_UNUSED)\n{\n    /*\n     * SO_REUSEADDR on Windows is actually akin to SO_REUSEPORT\n     * on Linux/BSD. ie it allows 2 apps to listen to the same\n     * port at once which is certainly not what we want here.\n     *\n     * Win32 sockets have Linux/BSD-like SO_REUSEADDR behaviour\n     * by default, so we can be a no-op.\n     *\n     * http://msdn.microsoft.com/en-us/library/windows/desktop/ms740621.aspx\n     */\n    return 0;\n}"
  },
  {
    "function_name": "virSetCloseExec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "131-134",
    "snippet": "int virSetCloseExec(int fd)\n{\n    return virSetInherit(fd, false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSetInherit",
          "args": [
            "fd",
            "false"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virSetInherit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "104-111",
          "snippet": "int virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetCloseExec(int fd)\n{\n    return virSetInherit(fd, false);\n}"
  },
  {
    "function_name": "virSetNonBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "126-129",
    "snippet": "int virSetNonBlock(int fd)\n{\n    return virSetBlocking(fd, false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSetBlocking",
          "args": [
            "fd",
            "false"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "virSetBlocking",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "113-121",
          "snippet": "int virSetBlocking(int fd, bool blocking)\n{\n    unsigned long arg = blocking ? 0 : 1;\n\n    if (ioctlsocket(fd, FIONBIO, &arg) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetBlocking(int fd, bool blocking)\n{\n    unsigned long arg = blocking ? 0 : 1;\n\n    if (ioctlsocket(fd, FIONBIO, &arg) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetNonBlock(int fd)\n{\n    return virSetBlocking(fd, false);\n}"
  },
  {
    "function_name": "virSetBlocking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "113-121",
    "snippet": "int virSetBlocking(int fd, bool blocking)\n{\n    unsigned long arg = blocking ? 0 : 1;\n\n    if (ioctlsocket(fd, FIONBIO, &arg) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctlsocket",
          "args": [
            "fd",
            "FIONBIO",
            "&arg"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetBlocking(int fd, bool blocking)\n{\n    unsigned long arg = blocking ? 0 : 1;\n\n    if (ioctlsocket(fd, FIONBIO, &arg) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virSetInherit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "104-111",
    "snippet": "int virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}"
  },
  {
    "function_name": "virSetBlocking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "88-100",
    "snippet": "int virSetBlocking(int fd, bool block)\n{\n    int fflags;\n    if ((fflags = fcntl(fd, F_GETFL)) < 0)\n        return -1;\n    if (block)\n        fflags &= ~O_NONBLOCK;\n    else\n        fflags |= O_NONBLOCK;\n    if ((fcntl(fd, F_SETFL, fflags)) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "F_SETFL",
            "fflags"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "F_GETFL"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetBlocking(int fd, bool block)\n{\n    int fflags;\n    if ((fflags = fcntl(fd, F_GETFL)) < 0)\n        return -1;\n    if (block)\n        fflags &= ~O_NONBLOCK;\n    else\n        fflags |= O_NONBLOCK;\n    if ((fcntl(fd, F_SETFL, fflags)) < 0)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "virSetInherit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
    "lines": "73-85",
    "snippet": "int virSetInherit(int fd, bool inherit)\n{\n    int fflags;\n    if ((fflags = fcntl(fd, F_GETFD)) < 0)\n        return -1;\n    if (inherit)\n        fflags &= ~FD_CLOEXEC;\n    else\n        fflags |= FD_CLOEXEC;\n    if ((fcntl(fd, F_SETFD, fflags)) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "# include <sys/prctl.h>",
      "# include <cap-ng.h>",
      "# include <grp.h>",
      "# include <pwd.h>",
      "# include <libdevmapper.h>",
      "#include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <conio.h>",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "F_SETFD",
            "fflags"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "F_GETFD"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetInherit(int fd, bool inherit)\n{\n    int fflags;\n    if ((fflags = fcntl(fd, F_GETFD)) < 0)\n        return -1;\n    if (inherit)\n        fflags &= ~FD_CLOEXEC;\n    else\n        fflags |= FD_CLOEXEC;\n    if ((fcntl(fd, F_SETFD, fflags)) < 0)\n        return -1;\n    return 0;\n}"
  }
]