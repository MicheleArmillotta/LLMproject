[
  {
    "function_name": "virStorageBackendGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
    "lines": "187-200",
    "snippet": "virCapsPtr\nvirStorageBackendGetCapabilities(void)\n{\n    virCapsPtr caps;\n    size_t i;\n\n    if (!(caps = virCapabilitiesNew(VIR_ARCH_NONE, false, false)))\n        return NULL;\n\n    for (i = 0; i < virStorageBackendsCount; i++)\n        virCapabilitiesAddStoragePool(caps, virStorageBackends[i]->type);\n\n    return caps;\n}",
    "includes": [
      "# include \"storage_backend_vstorage.h\"",
      "# include \"storage_backend_zfs.h\"",
      "# include \"storage_backend_gluster.h\"",
      "# include \"storage_backend_sheepdog.h\"",
      "# include \"storage_backend_rbd.h\"",
      "# include \"storage_backend_fs.h\"",
      "# include \"storage_backend_disk.h\"",
      "# include \"storage_backend_mpath.h\"",
      "# include \"storage_backend_scsi.h\"",
      "# include \"storage_backend_iscsi_direct.h\"",
      "# include \"storage_backend_iscsi.h\"",
      "# include \"storage_backend_logical.h\"",
      "#include \"configmake.h\"",
      "#include \"virfile.h\"",
      "#include \"virmodule.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"internal.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
      "static size_t virStorageBackendsCount;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesAddStoragePool",
          "args": [
            "caps",
            "virStorageBackends[i]->type"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesAddStoragePool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "804-824",
          "snippet": "int\nvirCapabilitiesAddStoragePool(virCapsPtr caps,\n                              int poolType)\n{\n    virCapsStoragePoolPtr pool;\n\n    if (VIR_ALLOC(pool) < 0)\n        goto error;\n\n    pool->type = poolType;\n\n    if (VIR_RESIZE_N(caps->pools, caps->npools_max, caps->npools, 1) < 0)\n        goto error;\n    caps->pools[caps->npools++] = pool;\n\n    return 0;\n\n error:\n    virCapabilitiesFreeStoragePool(pool);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesAddStoragePool(virCapsPtr caps,\n                              int poolType)\n{\n    virCapsStoragePoolPtr pool;\n\n    if (VIR_ALLOC(pool) < 0)\n        goto error;\n\n    pool->type = poolType;\n\n    if (VIR_RESIZE_N(caps->pools, caps->npools_max, caps->npools, 1) < 0)\n        goto error;\n    caps->pools[caps->npools++] = pool;\n\n    return 0;\n\n error:\n    virCapabilitiesFreeStoragePool(pool);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesNew",
          "args": [
            "VIR_ARCH_NONE",
            "false",
            "false"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "78-96",
          "snippet": "virCapsPtr\nvirCapabilitiesNew(virArch hostarch,\n                   bool offlineMigrate,\n                   bool liveMigrate)\n{\n    virCapsPtr caps;\n\n    if (virCapabilitiesInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectNew(virCapsClass)))\n        return NULL;\n\n    caps->host.arch = hostarch;\n    caps->host.offlineMigrate = offlineMigrate;\n    caps->host.liveMigrate = liveMigrate;\n\n    return caps;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virCapsClass;\n\nvirCapsPtr\nvirCapabilitiesNew(virArch hostarch,\n                   bool offlineMigrate,\n                   bool liveMigrate)\n{\n    virCapsPtr caps;\n\n    if (virCapabilitiesInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectNew(virCapsClass)))\n        return NULL;\n\n    caps->host.arch = hostarch;\n    caps->host.offlineMigrate = offlineMigrate;\n    caps->host.liveMigrate = liveMigrate;\n\n    return caps;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirCapsPtr\nvirStorageBackendGetCapabilities(void)\n{\n    virCapsPtr caps;\n    size_t i;\n\n    if (!(caps = virCapabilitiesNew(VIR_ARCH_NONE, false, false)))\n        return NULL;\n\n    for (i = 0; i < virStorageBackendsCount; i++)\n        virCapabilitiesAddStoragePool(caps, virStorageBackends[i]->type);\n\n    return caps;\n}"
  },
  {
    "function_name": "virStorageBackendForType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
    "lines": "172-184",
    "snippet": "virStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}",
    "includes": [
      "# include \"storage_backend_vstorage.h\"",
      "# include \"storage_backend_zfs.h\"",
      "# include \"storage_backend_gluster.h\"",
      "# include \"storage_backend_sheepdog.h\"",
      "# include \"storage_backend_rbd.h\"",
      "# include \"storage_backend_fs.h\"",
      "# include \"storage_backend_disk.h\"",
      "# include \"storage_backend_mpath.h\"",
      "# include \"storage_backend_scsi.h\"",
      "# include \"storage_backend_iscsi_direct.h\"",
      "# include \"storage_backend_iscsi.h\"",
      "# include \"storage_backend_logical.h\"",
      "#include \"configmake.h\"",
      "#include \"virfile.h\"",
      "#include \"virmodule.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"internal.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
      "static size_t virStorageBackendsCount;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"missing backend for pool type %d (%s)\")",
            "type",
            "NULLSTR(virStoragePoolTypeToString(type))"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "virStoragePoolTypeToString(type)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeToString",
          "args": [
            "type"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing backend for pool type %d (%s)\""
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nvirStorageBackendPtr\nvirStorageBackendForType(int type)\n{\n    size_t i;\n    for (i = 0; i < virStorageBackendsCount; i++)\n        if (virStorageBackends[i]->type == type)\n            return virStorageBackends[i];\n\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   _(\"missing backend for pool type %d (%s)\"),\n                   type, NULLSTR(virStoragePoolTypeToString(type)));\n    return NULL;\n}"
  },
  {
    "function_name": "virStorageBackendRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
    "lines": "153-169",
    "snippet": "int\nvirStorageBackendRegister(virStorageBackendPtr backend)\n{\n    VIR_DEBUG(\"Registering storage backend '%s'\",\n              virStoragePoolTypeToString(backend->type));\n\n    if (virStorageBackendsCount >= VIR_STORAGE_BACKENDS_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register storage backend '%s'\"),\n                       virStoragePoolTypeToString(backend->type));\n        return -1;\n    }\n\n    virStorageBackends[virStorageBackendsCount] = backend;\n    virStorageBackendsCount++;\n    return 0;\n}",
    "includes": [
      "# include \"storage_backend_vstorage.h\"",
      "# include \"storage_backend_zfs.h\"",
      "# include \"storage_backend_gluster.h\"",
      "# include \"storage_backend_sheepdog.h\"",
      "# include \"storage_backend_rbd.h\"",
      "# include \"storage_backend_fs.h\"",
      "# include \"storage_backend_disk.h\"",
      "# include \"storage_backend_mpath.h\"",
      "# include \"storage_backend_scsi.h\"",
      "# include \"storage_backend_iscsi_direct.h\"",
      "# include \"storage_backend_iscsi.h\"",
      "# include \"storage_backend_logical.h\"",
      "#include \"configmake.h\"",
      "#include \"virfile.h\"",
      "#include \"virmodule.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"internal.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_STORAGE_BACKENDS_MAX 20"
    ],
    "globals_used": [
      "static virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];",
      "static size_t virStorageBackendsCount;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Too many drivers, cannot register storage backend '%s'\")",
            "virStoragePoolTypeToString(backend->type)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeToString",
          "args": [
            "backend->type"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Too many drivers, cannot register storage backend '%s'\""
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Registering storage backend '%s'\"",
            "virStoragePoolTypeToString(backend->type)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStoragePoolTypeToString",
          "args": [
            "backend->type"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\n#define VIR_STORAGE_BACKENDS_MAX 20\n\nstatic virStorageBackendPtr virStorageBackends[VIR_STORAGE_BACKENDS_MAX];\nstatic size_t virStorageBackendsCount;\n\nint\nvirStorageBackendRegister(virStorageBackendPtr backend)\n{\n    VIR_DEBUG(\"Registering storage backend '%s'\",\n              virStoragePoolTypeToString(backend->type));\n\n    if (virStorageBackendsCount >= VIR_STORAGE_BACKENDS_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register storage backend '%s'\"),\n                       virStoragePoolTypeToString(backend->type));\n        return -1;\n    }\n\n    virStorageBackends[virStorageBackendsCount] = backend;\n    virStorageBackendsCount++;\n    return 0;\n}"
  },
  {
    "function_name": "virStorageBackendDriversRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
    "lines": "108-149",
    "snippet": "int\nvirStorageBackendDriversRegister(bool allbackends G_GNUC_UNUSED)\n{\n#if WITH_STORAGE_DIR || WITH_STORAGE_FS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendFsRegister, \"fs\");\n#endif\n#if WITH_STORAGE_LVM\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendLogicalRegister, \"logical\");\n#endif\n#if WITH_STORAGE_ISCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIRegister, \"iscsi\");\n#endif\n#if WITH_STORAGE_ISCSI_DIRECT\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIDirectRegister, \"iscsi-direct\");\n#endif\n#if WITH_STORAGE_SCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSCSIRegister, \"scsi\");\n#endif\n#if WITH_STORAGE_MPATH\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendMpathRegister, \"mpath\");\n#endif\n#if WITH_STORAGE_DISK\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendDiskRegister, \"disk\");\n#endif\n#if WITH_STORAGE_RBD\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendRBDRegister, \"rbd\");\n#endif\n#if WITH_STORAGE_SHEEPDOG\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSheepdogRegister, \"sheepdog\");\n#endif\n#if WITH_STORAGE_GLUSTER\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendGlusterRegister, \"gluster\");\n#endif\n#if WITH_STORAGE_ZFS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendZFSRegister, \"zfs\");\n#endif\n#if WITH_STORAGE_VSTORAGE\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendVstorageRegister, \"vstorage\");\n#endif\n\n    return 0;\n}",
    "includes": [
      "# include \"storage_backend_vstorage.h\"",
      "# include \"storage_backend_zfs.h\"",
      "# include \"storage_backend_gluster.h\"",
      "# include \"storage_backend_sheepdog.h\"",
      "# include \"storage_backend_rbd.h\"",
      "# include \"storage_backend_fs.h\"",
      "# include \"storage_backend_disk.h\"",
      "# include \"storage_backend_mpath.h\"",
      "# include \"storage_backend_scsi.h\"",
      "# include \"storage_backend_iscsi_direct.h\"",
      "# include \"storage_backend_iscsi.h\"",
      "# include \"storage_backend_logical.h\"",
      "#include \"configmake.h\"",
      "#include \"virfile.h\"",
      "#include \"virmodule.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"internal.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendVstorageRegister",
            "\"vstorage\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendZFSRegister",
            "\"zfs\""
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendGlusterRegister",
            "\"gluster\""
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendSheepdogRegister",
            "\"sheepdog\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendRBDRegister",
            "\"rbd\""
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendDiskRegister",
            "\"disk\""
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendMpathRegister",
            "\"mpath\""
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendSCSIRegister",
            "\"scsi\""
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendISCSIDirectRegister",
            "\"iscsi-direct\""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendISCSIRegister",
            "\"iscsi\""
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendLogicalRegister",
            "\"logical\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_STORAGE_BACKEND_REGISTER",
          "args": [
            "virStorageBackendFsRegister",
            "\"fs\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirStorageBackendDriversRegister(bool allbackends G_GNUC_UNUSED)\n{\n#if WITH_STORAGE_DIR || WITH_STORAGE_FS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendFsRegister, \"fs\");\n#endif\n#if WITH_STORAGE_LVM\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendLogicalRegister, \"logical\");\n#endif\n#if WITH_STORAGE_ISCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIRegister, \"iscsi\");\n#endif\n#if WITH_STORAGE_ISCSI_DIRECT\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendISCSIDirectRegister, \"iscsi-direct\");\n#endif\n#if WITH_STORAGE_SCSI\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSCSIRegister, \"scsi\");\n#endif\n#if WITH_STORAGE_MPATH\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendMpathRegister, \"mpath\");\n#endif\n#if WITH_STORAGE_DISK\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendDiskRegister, \"disk\");\n#endif\n#if WITH_STORAGE_RBD\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendRBDRegister, \"rbd\");\n#endif\n#if WITH_STORAGE_SHEEPDOG\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendSheepdogRegister, \"sheepdog\");\n#endif\n#if WITH_STORAGE_GLUSTER\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendGlusterRegister, \"gluster\");\n#endif\n#if WITH_STORAGE_ZFS\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendZFSRegister, \"zfs\");\n#endif\n#if WITH_STORAGE_VSTORAGE\n    VIR_STORAGE_BACKEND_REGISTER(virStorageBackendVstorageRegister, \"vstorage\");\n#endif\n\n    return 0;\n}"
  },
  {
    "function_name": "virStorageDriverLoadBackendModule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/storage/storage_backend.c",
    "lines": "85-101",
    "snippet": "static int\nvirStorageDriverLoadBackendModule(const char *name,\n                                  const char *regfunc,\n                                  bool forceload)\n{\n    g_autofree char *modfile = NULL;\n\n    if (!(modfile = virFileFindResourceFull(name,\n                                            \"libvirt_storage_backend_\",\n                                            \".so\",\n                                            abs_top_builddir \"/src/.libs\",\n                                            STORAGE_BACKEND_MODULE_DIR,\n                                            \"LIBVIRT_STORAGE_BACKEND_DIR\")))\n        return -1;\n\n    return virModuleLoad(modfile, regfunc, forceload);\n}",
    "includes": [
      "# include \"storage_backend_vstorage.h\"",
      "# include \"storage_backend_zfs.h\"",
      "# include \"storage_backend_gluster.h\"",
      "# include \"storage_backend_sheepdog.h\"",
      "# include \"storage_backend_rbd.h\"",
      "# include \"storage_backend_fs.h\"",
      "# include \"storage_backend_disk.h\"",
      "# include \"storage_backend_mpath.h\"",
      "# include \"storage_backend_scsi.h\"",
      "# include \"storage_backend_iscsi_direct.h\"",
      "# include \"storage_backend_iscsi.h\"",
      "# include \"storage_backend_logical.h\"",
      "#include \"configmake.h\"",
      "#include \"virfile.h\"",
      "#include \"virmodule.h\"",
      "#include \"virlog.h\"",
      "#include \"storage_backend.h\"",
      "#include \"virstoragefile.h\"",
      "#include \"internal.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define STORAGE_BACKEND_MODULE_DIR LIBDIR \"/libvirt/storage-backend\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virModuleLoad",
          "args": [
            "modfile",
            "regfunc",
            "forceload"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "virModuleLoad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmodule.c",
          "lines": "145-162",
          "snippet": "int\nvirModuleLoad(const char *path,\n              const char *regfunc G_GNUC_UNUSED,\n              bool required)\n{\n    VIR_DEBUG(\"dlopen not available on this platform\");\n    if (required) {\n        virReportSystemError(ENOSYS,\n                             _(\"Failed to find module '%s'\"), path);\n        return -1;\n    } else {\n        /* Since we have no dlopen(), but definition we have no\n         * loadable modules on disk, so we can reasonably\n         * return '1' instead of an error.\n         */\n        return 1;\n    }\n}",
          "includes": [
            "# include <dlfcn.h>",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virmodule.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <dlfcn.h>\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virmodule.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirModuleLoad(const char *path,\n              const char *regfunc G_GNUC_UNUSED,\n              bool required)\n{\n    VIR_DEBUG(\"dlopen not available on this platform\");\n    if (required) {\n        virReportSystemError(ENOSYS,\n                             _(\"Failed to find module '%s'\"), path);\n        return -1;\n    } else {\n        /* Since we have no dlopen(), but definition we have no\n         * loadable modules on disk, so we can reasonably\n         * return '1' instead of an error.\n         */\n        return 1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileFindResourceFull",
          "args": [
            "name",
            "\"libvirt_storage_backend_\"",
            "\".so\"",
            "abs_top_builddir \"/src/.libs\"",
            "STORAGE_BACKEND_MODULE_DIR",
            "\"LIBVIRT_STORAGE_BACKEND_DIR\""
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFindResourceFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1741-1769",
          "snippet": "char *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool useDirOverride;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool useDirOverride;\n\nchar *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include \"storage_backend_vstorage.h\"\n# include \"storage_backend_zfs.h\"\n# include \"storage_backend_gluster.h\"\n# include \"storage_backend_sheepdog.h\"\n# include \"storage_backend_rbd.h\"\n# include \"storage_backend_fs.h\"\n# include \"storage_backend_disk.h\"\n# include \"storage_backend_mpath.h\"\n# include \"storage_backend_scsi.h\"\n# include \"storage_backend_iscsi_direct.h\"\n# include \"storage_backend_iscsi.h\"\n# include \"storage_backend_logical.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"storage_backend.h\"\n#include \"virstoragefile.h\"\n#include \"internal.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\n#define STORAGE_BACKEND_MODULE_DIR LIBDIR \"/libvirt/storage-backend\"\n\nstatic int\nvirStorageDriverLoadBackendModule(const char *name,\n                                  const char *regfunc,\n                                  bool forceload)\n{\n    g_autofree char *modfile = NULL;\n\n    if (!(modfile = virFileFindResourceFull(name,\n                                            \"libvirt_storage_backend_\",\n                                            \".so\",\n                                            abs_top_builddir \"/src/.libs\",\n                                            STORAGE_BACKEND_MODULE_DIR,\n                                            \"LIBVIRT_STORAGE_BACKEND_DIR\")))\n        return -1;\n\n    return virModuleLoad(modfile, regfunc, forceload);\n}"
  }
]