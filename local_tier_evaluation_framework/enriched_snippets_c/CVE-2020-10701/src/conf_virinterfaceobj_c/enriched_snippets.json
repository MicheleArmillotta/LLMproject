[
  {
    "function_name": "virInterfaceObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "553-577",
    "snippet": "int\nvirInterfaceObjListGetNames(virInterfaceObjListPtr interfaces,\n                            bool wantActive,\n                            char **const names,\n                            int maxnames)\n{\n    struct _virInterfaceObjGetNamesData data = {\n        .wantActive = wantActive, .error = false, .nnames = 0,\n        .maxnames = maxnames,  .names = names };\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListGetNamesCb, &data);\n    virObjectRWUnlock(interfaces);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames >= 0)\n        VIR_FREE(data.names[data.nnames]);\n\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.names[data.nnames]"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "interfaces->objsName",
            "virInterfaceObjListGetNamesCb",
            "&data"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "interfaces"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirInterfaceObjListGetNames(virInterfaceObjListPtr interfaces,\n                            bool wantActive,\n                            char **const names,\n                            int maxnames)\n{\n    struct _virInterfaceObjGetNamesData data = {\n        .wantActive = wantActive, .error = false, .nnames = 0,\n        .maxnames = maxnames,  .names = names };\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListGetNamesCb, &data);\n    virObjectRWUnlock(interfaces);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames >= 0)\n        VIR_FREE(data.names[data.nnames]);\n\n    return -1;\n}"
  },
  {
    "function_name": "virInterfaceObjListGetNamesCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "524-550",
    "snippet": "static int\nvirInterfaceObjListGetNamesCb(void *payload,\n                              const void *name G_GNUC_UNUSED,\n                              void *opaque)\n{\n    virInterfaceObjPtr obj = payload;\n    struct _virInterfaceObjGetNamesData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 && data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->wantActive != virInterfaceObjIsActive(obj))\n        goto cleanup;\n\n    data->names[data->nnames] = g_strdup(obj->def->name);\n\n    data->nnames++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "obj->def->name"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjIsActive",
          "args": [
            "obj"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "118-122",
          "snippet": "bool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nbool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic int\nvirInterfaceObjListGetNamesCb(void *payload,\n                              const void *name G_GNUC_UNUSED,\n                              void *opaque)\n{\n    virInterfaceObjPtr obj = payload;\n    struct _virInterfaceObjGetNamesData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxnames >= 0 && data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->wantActive != virInterfaceObjIsActive(obj))\n        goto cleanup;\n\n    data->names[data->nnames] = g_strdup(obj->def->name);\n\n    data->nnames++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virInterfaceObjListNumOfInterfaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "500-513",
    "snippet": "int\nvirInterfaceObjListNumOfInterfaces(virInterfaceObjListPtr interfaces,\n                                   bool wantActive)\n{\n    struct _virInterfaceObjNumOfInterfacesData data = {\n        .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListNumOfInterfacesCb,\n                   &data);\n    virObjectRWUnlock(interfaces);\n\n    return data.count;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "interfaces->objsName",
            "virInterfaceObjListNumOfInterfacesCb",
            "&data"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "interfaces"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirInterfaceObjListNumOfInterfaces(virInterfaceObjListPtr interfaces,\n                                   bool wantActive)\n{\n    struct _virInterfaceObjNumOfInterfacesData data = {\n        .wantActive = wantActive, .count = 0 };\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListNumOfInterfacesCb,\n                   &data);\n    virObjectRWUnlock(interfaces);\n\n    return data.count;\n}"
  },
  {
    "function_name": "virInterfaceObjListNumOfInterfacesCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "482-497",
    "snippet": "static int\nvirInterfaceObjListNumOfInterfacesCb(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virInterfaceObjPtr obj = payload;\n    struct _virInterfaceObjNumOfInterfacesData *data = opaque;\n\n    virObjectLock(obj);\n\n    if (data->wantActive == virInterfaceObjIsActive(obj))\n        data->count++;\n\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjIsActive",
          "args": [
            "obj"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "118-122",
          "snippet": "bool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nbool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic int\nvirInterfaceObjListNumOfInterfacesCb(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virInterfaceObjPtr obj = payload;\n    struct _virInterfaceObjNumOfInterfacesData *data = opaque;\n\n    virObjectLock(obj);\n\n    if (data->wantActive == virInterfaceObjIsActive(obj))\n        data->count++;\n\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virInterfaceObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "459-474",
    "snippet": "void\nvirInterfaceObjListRemove(virInterfaceObjListPtr interfaces,\n                          virInterfaceObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(interfaces);\n    virObjectLock(obj);\n    virHashRemoveEntry(interfaces->objsName, obj->def->name);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(interfaces);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "interfaces->objsName",
            "obj->def->name"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "interfaces"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvoid\nvirInterfaceObjListRemove(virInterfaceObjListPtr interfaces,\n                          virInterfaceObjPtr obj)\n{\n    if (!obj)\n        return;\n\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n    virObjectRWLockWrite(interfaces);\n    virObjectLock(obj);\n    virHashRemoveEntry(interfaces->objsName, obj->def->name);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(interfaces);\n}"
  },
  {
    "function_name": "virInterfaceObjListAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "429-456",
    "snippet": "virInterfaceObjPtr\nvirInterfaceObjListAssignDef(virInterfaceObjListPtr interfaces,\n                             virInterfaceDefPtr def)\n{\n    virInterfaceObjPtr obj;\n\n    virObjectRWLockWrite(interfaces);\n    if ((obj = virInterfaceObjListFindByNameLocked(interfaces, def->name))) {\n        virInterfaceDefFree(obj->def);\n    } else {\n        if (!(obj = virInterfaceObjNew()))\n            goto error;\n\n        if (virHashAddEntry(interfaces->objsName, def->name, obj) < 0)\n            goto error;\n        virObjectRef(obj);\n    }\n\n    obj->def = def;\n    virObjectRWUnlock(interfaces);\n\n    return obj;\n\n error:\n    virInterfaceObjEndAPI(&obj);\n    virObjectRWUnlock(interfaces);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "99-108",
          "snippet": "void\nvirInterfaceObjEndAPI(virInterfaceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvoid\nvirInterfaceObjEndAPI(virInterfaceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "interfaces->objsName",
            "def->name",
            "obj"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjNew",
          "args": [],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "82-96",
          "snippet": "static virInterfaceObjPtr\nvirInterfaceObjNew(void)\n{\n    virInterfaceObjPtr obj;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virInterfaceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virInterfaceObjClass;",
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virInterfaceObjClass;\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic virInterfaceObjPtr\nvirInterfaceObjNew(void)\n{\n    virInterfaceObjPtr obj;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virInterfaceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceDefFree",
          "args": [
            "obj->def"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/interface_conf.c",
          "lines": "73-115",
          "snippet": "void\nvirInterfaceDefFree(virInterfaceDefPtr def)\n{\n    size_t i;\n    int pp;\n\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->mac);\n\n    switch (def->type) {\n        case VIR_INTERFACE_TYPE_BRIDGE:\n            VIR_FREE(def->data.bridge.delay);\n            for (i = 0; i < def->data.bridge.nbItf; i++) {\n                if (def->data.bridge.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bridge.itf[i]);\n            }\n            VIR_FREE(def->data.bridge.itf);\n            break;\n        case VIR_INTERFACE_TYPE_BOND:\n            VIR_FREE(def->data.bond.target);\n            for (i = 0; i < def->data.bond.nbItf; i++) {\n                if (def->data.bond.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bond.itf[i]);\n            }\n            VIR_FREE(def->data.bond.itf);\n            break;\n        case VIR_INTERFACE_TYPE_VLAN:\n            VIR_FREE(def->data.vlan.tag);\n            VIR_FREE(def->data.vlan.dev_name);\n            break;\n    }\n\n    /* free all protos */\n    for (pp = 0; pp < def->nprotos; pp++)\n        virInterfaceProtocolDefFree(def->protos[pp]);\n    VIR_FREE(def->protos);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirInterfaceDefFree(virInterfaceDefPtr def)\n{\n    size_t i;\n    int pp;\n\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->mac);\n\n    switch (def->type) {\n        case VIR_INTERFACE_TYPE_BRIDGE:\n            VIR_FREE(def->data.bridge.delay);\n            for (i = 0; i < def->data.bridge.nbItf; i++) {\n                if (def->data.bridge.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bridge.itf[i]);\n            }\n            VIR_FREE(def->data.bridge.itf);\n            break;\n        case VIR_INTERFACE_TYPE_BOND:\n            VIR_FREE(def->data.bond.target);\n            for (i = 0; i < def->data.bond.nbItf; i++) {\n                if (def->data.bond.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bond.itf[i]);\n            }\n            VIR_FREE(def->data.bond.itf);\n            break;\n        case VIR_INTERFACE_TYPE_VLAN:\n            VIR_FREE(def->data.vlan.tag);\n            VIR_FREE(def->data.vlan.dev_name);\n            break;\n    }\n\n    /* free all protos */\n    for (pp = 0; pp < def->nprotos; pp++)\n        virInterfaceProtocolDefFree(def->protos[pp]);\n    VIR_FREE(def->protos);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjListFindByNameLocked",
          "args": [
            "interfaces",
            "def->name"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjListFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "218-223",
          "snippet": "static virInterfaceObjPtr\nvirInterfaceObjListFindByNameLocked(virInterfaceObjListPtr interfaces,\n                                    const char *name)\n{\n    return virObjectRef(virHashLookup(interfaces->objsName, name));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virInterfaceObjPtr\nvirInterfaceObjListFindByNameLocked(virInterfaceObjListPtr interfaces,\n                                    const char *name)\n{\n    return virObjectRef(virHashLookup(interfaces->objsName, name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "interfaces"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvirInterfaceObjPtr\nvirInterfaceObjListAssignDef(virInterfaceObjListPtr interfaces,\n                             virInterfaceDefPtr def)\n{\n    virInterfaceObjPtr obj;\n\n    virObjectRWLockWrite(interfaces);\n    if ((obj = virInterfaceObjListFindByNameLocked(interfaces, def->name))) {\n        virInterfaceDefFree(obj->def);\n    } else {\n        if (!(obj = virInterfaceObjNew()))\n            goto error;\n\n        if (virHashAddEntry(interfaces->objsName, def->name, obj) < 0)\n            goto error;\n        virObjectRef(obj);\n    }\n\n    obj->def = def;\n    virObjectRWUnlock(interfaces);\n\n    return obj;\n\n error:\n    virInterfaceObjEndAPI(&obj);\n    virObjectRWUnlock(interfaces);\n    return NULL;\n}"
  },
  {
    "function_name": "virInterfaceObjListClone",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "402-426",
    "snippet": "virInterfaceObjListPtr\nvirInterfaceObjListClone(virInterfaceObjListPtr interfaces)\n{\n    struct _virInterfaceObjListCloneData data = { .error = false,\n                                                  .dest = NULL };\n\n    if (!interfaces)\n        return NULL;\n\n    if (!(data.dest = virInterfaceObjListNew()))\n        return NULL;\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListCloneCb, &data);\n    virObjectRWUnlock(interfaces);\n\n    if (data.error)\n        goto error;\n\n    return data.dest;\n\n error:\n    virObjectUnref(data.dest);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "data.dest"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "interfaces->objsName",
            "virInterfaceObjListCloneCb",
            "&data"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "interfaces"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjListNew",
          "args": [],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "134-151",
          "snippet": "virInterfaceObjListPtr\nvirInterfaceObjListNew(void)\n{\n    virInterfaceObjListPtr interfaces;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(interfaces = virObjectRWLockableNew(virInterfaceObjListClass)))\n        return NULL;\n\n    if (!(interfaces->objsName = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(interfaces);\n        return NULL;\n    }\n\n    return interfaces;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virInterfaceObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virInterfaceObjListClass;\n\nvirInterfaceObjListPtr\nvirInterfaceObjListNew(void)\n{\n    virInterfaceObjListPtr interfaces;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(interfaces = virObjectRWLockableNew(virInterfaceObjListClass)))\n        return NULL;\n\n    if (!(interfaces->objsName = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(interfaces);\n        return NULL;\n    }\n\n    return interfaces;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirInterfaceObjListPtr\nvirInterfaceObjListClone(virInterfaceObjListPtr interfaces)\n{\n    struct _virInterfaceObjListCloneData data = { .error = false,\n                                                  .dest = NULL };\n\n    if (!interfaces)\n        return NULL;\n\n    if (!(data.dest = virInterfaceObjListNew()))\n        return NULL;\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListCloneCb, &data);\n    virObjectRWUnlock(interfaces);\n\n    if (data.error)\n        goto error;\n\n    return data.dest;\n\n error:\n    virObjectUnref(data.dest);\n    return NULL;\n}"
  },
  {
    "function_name": "virInterfaceObjListCloneCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "363-399",
    "snippet": "static int\nvirInterfaceObjListCloneCb(void *payload,\n                           const void *name G_GNUC_UNUSED,\n                           void *opaque)\n{\n    virInterfaceObjPtr srcObj = payload;\n    struct _virInterfaceObjListCloneData *data = opaque;\n    char *xml = NULL;\n    virInterfaceDefPtr backup = NULL;\n    virInterfaceObjPtr obj;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(srcObj);\n\n    if (!(xml = virInterfaceDefFormat(srcObj->def)))\n        goto error;\n\n    if (!(backup = virInterfaceDefParseString(xml)))\n        goto error;\n    VIR_FREE(xml);\n\n    if (!(obj = virInterfaceObjListAssignDef(data->dest, backup)))\n        goto error;\n    virInterfaceObjEndAPI(&obj);\n\n    virObjectUnlock(srcObj);\n    return 0;\n\n error:\n    data->error = true;\n    VIR_FREE(xml);\n    virInterfaceDefFree(backup);\n    virObjectUnlock(srcObj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "srcObj"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceDefFree",
          "args": [
            "backup"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/interface_conf.c",
          "lines": "73-115",
          "snippet": "void\nvirInterfaceDefFree(virInterfaceDefPtr def)\n{\n    size_t i;\n    int pp;\n\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->mac);\n\n    switch (def->type) {\n        case VIR_INTERFACE_TYPE_BRIDGE:\n            VIR_FREE(def->data.bridge.delay);\n            for (i = 0; i < def->data.bridge.nbItf; i++) {\n                if (def->data.bridge.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bridge.itf[i]);\n            }\n            VIR_FREE(def->data.bridge.itf);\n            break;\n        case VIR_INTERFACE_TYPE_BOND:\n            VIR_FREE(def->data.bond.target);\n            for (i = 0; i < def->data.bond.nbItf; i++) {\n                if (def->data.bond.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bond.itf[i]);\n            }\n            VIR_FREE(def->data.bond.itf);\n            break;\n        case VIR_INTERFACE_TYPE_VLAN:\n            VIR_FREE(def->data.vlan.tag);\n            VIR_FREE(def->data.vlan.dev_name);\n            break;\n    }\n\n    /* free all protos */\n    for (pp = 0; pp < def->nprotos; pp++)\n        virInterfaceProtocolDefFree(def->protos[pp]);\n    VIR_FREE(def->protos);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirInterfaceDefFree(virInterfaceDefPtr def)\n{\n    size_t i;\n    int pp;\n\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->mac);\n\n    switch (def->type) {\n        case VIR_INTERFACE_TYPE_BRIDGE:\n            VIR_FREE(def->data.bridge.delay);\n            for (i = 0; i < def->data.bridge.nbItf; i++) {\n                if (def->data.bridge.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bridge.itf[i]);\n            }\n            VIR_FREE(def->data.bridge.itf);\n            break;\n        case VIR_INTERFACE_TYPE_BOND:\n            VIR_FREE(def->data.bond.target);\n            for (i = 0; i < def->data.bond.nbItf; i++) {\n                if (def->data.bond.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bond.itf[i]);\n            }\n            VIR_FREE(def->data.bond.itf);\n            break;\n        case VIR_INTERFACE_TYPE_VLAN:\n            VIR_FREE(def->data.vlan.tag);\n            VIR_FREE(def->data.vlan.dev_name);\n            break;\n    }\n\n    /* free all protos */\n    for (pp = 0; pp < def->nprotos; pp++)\n        virInterfaceProtocolDefFree(def->protos[pp]);\n    VIR_FREE(def->protos);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virInterfaceObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "99-108",
          "snippet": "void\nvirInterfaceObjEndAPI(virInterfaceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvoid\nvirInterfaceObjEndAPI(virInterfaceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjListAssignDef",
          "args": [
            "data->dest",
            "backup"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjListAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "429-456",
          "snippet": "virInterfaceObjPtr\nvirInterfaceObjListAssignDef(virInterfaceObjListPtr interfaces,\n                             virInterfaceDefPtr def)\n{\n    virInterfaceObjPtr obj;\n\n    virObjectRWLockWrite(interfaces);\n    if ((obj = virInterfaceObjListFindByNameLocked(interfaces, def->name))) {\n        virInterfaceDefFree(obj->def);\n    } else {\n        if (!(obj = virInterfaceObjNew()))\n            goto error;\n\n        if (virHashAddEntry(interfaces->objsName, def->name, obj) < 0)\n            goto error;\n        virObjectRef(obj);\n    }\n\n    obj->def = def;\n    virObjectRWUnlock(interfaces);\n\n    return obj;\n\n error:\n    virInterfaceObjEndAPI(&obj);\n    virObjectRWUnlock(interfaces);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvirInterfaceObjPtr\nvirInterfaceObjListAssignDef(virInterfaceObjListPtr interfaces,\n                             virInterfaceDefPtr def)\n{\n    virInterfaceObjPtr obj;\n\n    virObjectRWLockWrite(interfaces);\n    if ((obj = virInterfaceObjListFindByNameLocked(interfaces, def->name))) {\n        virInterfaceDefFree(obj->def);\n    } else {\n        if (!(obj = virInterfaceObjNew()))\n            goto error;\n\n        if (virHashAddEntry(interfaces->objsName, def->name, obj) < 0)\n            goto error;\n        virObjectRef(obj);\n    }\n\n    obj->def = def;\n    virObjectRWUnlock(interfaces);\n\n    return obj;\n\n error:\n    virInterfaceObjEndAPI(&obj);\n    virObjectRWUnlock(interfaces);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "xml"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virInterfaceDefParseString",
          "args": [
            "xml"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/interface_conf.c",
          "lines": "855-859",
          "snippet": "virInterfaceDefPtr\nvirInterfaceDefParseString(const char *xmlStr)\n{\n    return virInterfaceDefParse(xmlStr, NULL);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirInterfaceDefPtr\nvirInterfaceDefParseString(const char *xmlStr)\n{\n    return virInterfaceDefParse(xmlStr, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceDefFormat",
          "args": [
            "srcObj->def"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/interface_conf.c",
          "lines": "1130-1140",
          "snippet": "char *\nvirInterfaceDefFormat(const virInterfaceDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virInterfaceDefDevFormat(&buf, def, VIR_INTERFACE_TYPE_LAST) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nchar *\nvirInterfaceDefFormat(const virInterfaceDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virInterfaceDefDevFormat(&buf, def, VIR_INTERFACE_TYPE_LAST) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "srcObj"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic int\nvirInterfaceObjListCloneCb(void *payload,\n                           const void *name G_GNUC_UNUSED,\n                           void *opaque)\n{\n    virInterfaceObjPtr srcObj = payload;\n    struct _virInterfaceObjListCloneData *data = opaque;\n    char *xml = NULL;\n    virInterfaceDefPtr backup = NULL;\n    virInterfaceObjPtr obj;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(srcObj);\n\n    if (!(xml = virInterfaceDefFormat(srcObj->def)))\n        goto error;\n\n    if (!(backup = virInterfaceDefParseString(xml)))\n        goto error;\n    VIR_FREE(xml);\n\n    if (!(obj = virInterfaceObjListAssignDef(data->dest, backup)))\n        goto error;\n    virInterfaceObjEndAPI(&obj);\n\n    virObjectUnlock(srcObj);\n    return 0;\n\n error:\n    data->error = true;\n    VIR_FREE(xml);\n    virInterfaceDefFree(backup);\n    virObjectUnlock(srcObj);\n    return 0;\n}"
  },
  {
    "function_name": "virInterfaceObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "349-355",
    "snippet": "void\nvirInterfaceObjListDispose(void *obj)\n{\n    virInterfaceObjListPtr interfaces = obj;\n\n    virHashFree(interfaces->objsName);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "interfaces->objsName"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvoid\nvirInterfaceObjListDispose(void *obj)\n{\n    virInterfaceObjListPtr interfaces = obj;\n\n    virHashFree(interfaces->objsName);\n}"
  },
  {
    "function_name": "virInterfaceObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "309-346",
    "snippet": "int\nvirInterfaceObjListExport(virConnectPtr conn,\n                          virInterfaceObjListPtr ifaceobjs,\n                          virInterfacePtr **ifaces,\n                          virInterfaceObjListFilter filter,\n                          unsigned int flags)\n{\n    int ret = -1;\n    virInterfaceObjListExportData data = {\n        .conn = conn, .ifaces = NULL, .filter = filter, .flags = flags,\n        .nifaces = 0, .error = false };\n\n    virObjectRWLockRead(ifaceobjs);\n    if (ifaces && VIR_ALLOC_N(data.ifaces,\n                              virHashSize(ifaceobjs->objsName) + 1) < 0)\n        goto cleanup;\n\n    virHashForEach(ifaceobjs->objsName, virInterfaceObjListExportCallback, &data);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.ifaces) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.ifaces, data.nifaces + 1));\n        *ifaces = data.ifaces;\n        data.ifaces = NULL;\n    }\n\n    ret = data.nifaces;\n cleanup:\n    virObjectRWUnlock(ifaceobjs);\n    while (data.ifaces && data.nifaces)\n        virObjectUnref(data.ifaces[--data.nifaces]);\n\n    VIR_FREE(data.ifaces);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.ifaces"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "data.ifaces[--data.nifaces]"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "ifaceobjs"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(data.ifaces, data.nifaces + 1)"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "data.ifaces",
            "data.nifaces + 1"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "ifaceobjs->objsName",
            "virInterfaceObjListExportCallback",
            "&data"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.ifaces",
            "virHashSize(ifaceobjs->objsName) + 1"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "ifaceobjs->objsName"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "ifaceobjs"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirInterfaceObjListExport(virConnectPtr conn,\n                          virInterfaceObjListPtr ifaceobjs,\n                          virInterfacePtr **ifaces,\n                          virInterfaceObjListFilter filter,\n                          unsigned int flags)\n{\n    int ret = -1;\n    virInterfaceObjListExportData data = {\n        .conn = conn, .ifaces = NULL, .filter = filter, .flags = flags,\n        .nifaces = 0, .error = false };\n\n    virObjectRWLockRead(ifaceobjs);\n    if (ifaces && VIR_ALLOC_N(data.ifaces,\n                              virHashSize(ifaceobjs->objsName) + 1) < 0)\n        goto cleanup;\n\n    virHashForEach(ifaceobjs->objsName, virInterfaceObjListExportCallback, &data);\n\n    if (data.error)\n        goto cleanup;\n\n    if (data.ifaces) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.ifaces, data.nifaces + 1));\n        *ifaces = data.ifaces;\n        data.ifaces = NULL;\n    }\n\n    ret = data.nifaces;\n cleanup:\n    virObjectRWUnlock(ifaceobjs);\n    while (data.ifaces && data.nifaces)\n        virObjectUnref(data.ifaces[--data.nifaces]);\n\n    VIR_FREE(data.ifaces);\n    return ret;\n}"
  },
  {
    "function_name": "virInterfaceObjListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "270-306",
    "snippet": "static int\nvirInterfaceObjListExportCallback(void *payload,\n                                  const void *name G_GNUC_UNUSED,\n                                  void *opaque)\n{\n    virInterfaceObjListExportDataPtr data = opaque;\n    virInterfaceObjPtr obj = payload;\n    virInterfacePtr iface = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter &&\n        !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (!virInterfaceObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (!data->ifaces) {\n        data->nifaces++;\n        goto cleanup;\n    }\n\n    if (!(iface = virGetInterface(data->conn, obj->def->name, obj->def->mac))) {\n        data->error = true;\n        goto cleanup;\n    }\n\n    data->ifaces[data->nifaces++] = iface;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetInterface",
          "args": [
            "data->conn",
            "obj->def->name",
            "obj->def->mac"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virGetInterface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "460-488",
          "snippet": "virInterfacePtr\nvirGetInterface(virConnectPtr conn, const char *name, const char *mac)\n{\n    virInterfacePtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n\n    /* a NULL mac from caller is okay. Treat it as blank */\n    if (mac == NULL)\n       mac = \"\";\n\n    if (!(ret = virObjectNew(virInterfaceClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n    ret->mac = g_strdup(mac);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virInterfaceClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virInterfaceClass;\n\nvirInterfacePtr\nvirGetInterface(virConnectPtr conn, const char *name, const char *mac)\n{\n    virInterfacePtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n\n    /* a NULL mac from caller is okay. Treat it as blank */\n    if (mac == NULL)\n       mac = \"\";\n\n    if (!(ret = virObjectNew(virInterfaceClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n    ret->mac = g_strdup(mac);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjMatch",
          "args": [
            "obj",
            "data->flags"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "242-255",
          "snippet": "static bool\nvirInterfaceObjMatch(virInterfaceObjPtr obj,\n                     unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_INTERFACES_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_INTERFACES_ACTIVE) &&\n           virInterfaceObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_INTERFACES_INACTIVE) &&\n           !virInterfaceObjIsActive(obj))))\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic bool\nvirInterfaceObjMatch(virInterfaceObjPtr obj,\n                     unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_INTERFACES_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_INTERFACES_ACTIVE) &&\n           virInterfaceObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_INTERFACES_INACTIVE) &&\n           !virInterfaceObjIsActive(obj))))\n        return false;\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "obj->def"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic int\nvirInterfaceObjListExportCallback(void *payload,\n                                  const void *name G_GNUC_UNUSED,\n                                  void *opaque)\n{\n    virInterfaceObjListExportDataPtr data = opaque;\n    virInterfaceObjPtr obj = payload;\n    virInterfacePtr iface = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (data->filter &&\n        !data->filter(data->conn, obj->def))\n        goto cleanup;\n\n    if (!virInterfaceObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (!data->ifaces) {\n        data->nifaces++;\n        goto cleanup;\n    }\n\n    if (!(iface = virGetInterface(data->conn, obj->def->name, obj->def->mac))) {\n        data->error = true;\n        goto cleanup;\n    }\n\n    data->ifaces[data->nifaces++] = iface;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virInterfaceObjMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "242-255",
    "snippet": "static bool\nvirInterfaceObjMatch(virInterfaceObjPtr obj,\n                     unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_INTERFACES_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_INTERFACES_ACTIVE) &&\n           virInterfaceObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_INTERFACES_INACTIVE) &&\n           !virInterfaceObjIsActive(obj))))\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virInterfaceObjIsActive",
          "args": [
            "obj"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "118-122",
          "snippet": "bool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virInterfaceObjDispose(void *obj);",
            "static void virInterfaceObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nbool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_INTERFACES_INACTIVE"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_INTERFACES_ACTIVE"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_INTERFACES_FILTERS_ACTIVE"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic bool\nvirInterfaceObjMatch(virInterfaceObjPtr obj,\n                     unsigned int flags)\n{\n    /* filter by active state */\n    if (MATCH(VIR_CONNECT_LIST_INTERFACES_FILTERS_ACTIVE) &&\n        !((MATCH(VIR_CONNECT_LIST_INTERFACES_ACTIVE) &&\n           virInterfaceObjIsActive(obj)) ||\n          (MATCH(VIR_CONNECT_LIST_INTERFACES_INACTIVE) &&\n           !virInterfaceObjIsActive(obj))))\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virInterfaceObjListFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "226-238",
    "snippet": "virInterfaceObjPtr\nvirInterfaceObjListFindByName(virInterfaceObjListPtr interfaces,\n                              const char *name)\n{\n    virInterfaceObjPtr obj;\n    virObjectRWLockRead(interfaces);\n    obj = virInterfaceObjListFindByNameLocked(interfaces, name);\n    virObjectRWUnlock(interfaces);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjListFindByNameLocked",
          "args": [
            "interfaces",
            "name"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceObjListFindByNameLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
          "lines": "218-223",
          "snippet": "static virInterfaceObjPtr\nvirInterfaceObjListFindByNameLocked(virInterfaceObjListPtr interfaces,\n                                    const char *name)\n{\n    return virObjectRef(virHashLookup(interfaces->objsName, name));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virinterfaceobj.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virInterfaceObjPtr\nvirInterfaceObjListFindByNameLocked(virInterfaceObjListPtr interfaces,\n                                    const char *name)\n{\n    return virObjectRef(virHashLookup(interfaces->objsName, name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "interfaces"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvirInterfaceObjPtr\nvirInterfaceObjListFindByName(virInterfaceObjListPtr interfaces,\n                              const char *name)\n{\n    virInterfaceObjPtr obj;\n    virObjectRWLockRead(interfaces);\n    obj = virInterfaceObjListFindByNameLocked(interfaces, name);\n    virObjectRWUnlock(interfaces);\n    if (obj)\n        virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virInterfaceObjListFindByNameLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "218-223",
    "snippet": "static virInterfaceObjPtr\nvirInterfaceObjListFindByNameLocked(virInterfaceObjListPtr interfaces,\n                                    const char *name)\n{\n    return virObjectRef(virHashLookup(interfaces->objsName, name));\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virHashLookup(interfaces->objsName, name)"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "interfaces->objsName",
            "name"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virInterfaceObjPtr\nvirInterfaceObjListFindByNameLocked(virInterfaceObjListPtr interfaces,\n                                    const char *name)\n{\n    return virObjectRef(virHashLookup(interfaces->objsName, name));\n}"
  },
  {
    "function_name": "virInterfaceObjListFindByMACString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "188-215",
    "snippet": "int\nvirInterfaceObjListFindByMACString(virInterfaceObjListPtr interfaces,\n                                   const char *mac,\n                                   char **const matches,\n                                   int maxmatches)\n{\n    struct _virInterfaceObjFindMACData data = { .matchStr = mac,\n                                                .error = false,\n                                                .nnames = 0,\n                                                .maxnames = maxmatches,\n                                                .names = matches };\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListFindByMACStringCb,\n                   &data);\n    virObjectRWUnlock(interfaces);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames >= 0)\n        VIR_FREE(data.names[data.nnames]);\n\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.names[data.nnames]"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "interfaces"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "interfaces->objsName",
            "virInterfaceObjListFindByMACStringCb",
            "&data"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "interfaces"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirInterfaceObjListFindByMACString(virInterfaceObjListPtr interfaces,\n                                   const char *mac,\n                                   char **const matches,\n                                   int maxmatches)\n{\n    struct _virInterfaceObjFindMACData data = { .matchStr = mac,\n                                                .error = false,\n                                                .nnames = 0,\n                                                .maxnames = maxmatches,\n                                                .names = matches };\n\n    virObjectRWLockRead(interfaces);\n    virHashForEach(interfaces->objsName, virInterfaceObjListFindByMACStringCb,\n                   &data);\n    virObjectRWUnlock(interfaces);\n\n    if (data.error)\n        goto error;\n\n    return data.nnames;\n\n error:\n    while (--data.nnames >= 0)\n        VIR_FREE(data.names[data.nnames]);\n\n    return -1;\n}"
  },
  {
    "function_name": "virInterfaceObjListFindByMACStringCb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "162-185",
    "snippet": "static int\nvirInterfaceObjListFindByMACStringCb(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virInterfaceObjPtr obj = payload;\n    struct _virInterfaceObjFindMACData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (STRCASEEQ(obj->def->mac, data->matchStr)) {\n        data->names[data->nnames] = g_strdup(obj->def->name);\n        data->nnames++;\n    }\n\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "obj->def->name"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRCASEEQ",
          "args": [
            "obj->def->mac",
            "data->matchStr"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic int\nvirInterfaceObjListFindByMACStringCb(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    virInterfaceObjPtr obj = payload;\n    struct _virInterfaceObjFindMACData *data = opaque;\n\n    if (data->error)\n        return 0;\n\n    if (data->nnames == data->maxnames)\n        return 0;\n\n    virObjectLock(obj);\n\n    if (STRCASEEQ(obj->def->mac, data->matchStr)) {\n        data->names[data->nnames] = g_strdup(obj->def->name);\n        data->nnames++;\n    }\n\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virInterfaceObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "134-151",
    "snippet": "virInterfaceObjListPtr\nvirInterfaceObjListNew(void)\n{\n    virInterfaceObjListPtr interfaces;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(interfaces = virObjectRWLockableNew(virInterfaceObjListClass)))\n        return NULL;\n\n    if (!(interfaces->objsName = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(interfaces);\n        return NULL;\n    }\n\n    return interfaces;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virInterfaceObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "interfaces"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "10",
            "virObjectFreeHashData"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virInterfaceObjListClass"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjInitialize",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virInterfaceObjListClass;\n\nvirInterfaceObjListPtr\nvirInterfaceObjListNew(void)\n{\n    virInterfaceObjListPtr interfaces;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(interfaces = virObjectRWLockableNew(virInterfaceObjListClass)))\n        return NULL;\n\n    if (!(interfaces->objsName = virHashCreate(10, virObjectFreeHashData))) {\n        virObjectUnref(interfaces);\n        return NULL;\n    }\n\n    return interfaces;\n}"
  },
  {
    "function_name": "virInterfaceObjSetActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "125-130",
    "snippet": "void\nvirInterfaceObjSetActive(virInterfaceObjPtr obj,\n                         bool active)\n{\n    obj->active = active;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvoid\nvirInterfaceObjSetActive(virInterfaceObjPtr obj,\n                         bool active)\n{\n    obj->active = active;\n}"
  },
  {
    "function_name": "virInterfaceObjIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "118-122",
    "snippet": "bool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nbool\nvirInterfaceObjIsActive(virInterfaceObjPtr obj)\n{\n    return obj->active;\n}"
  },
  {
    "function_name": "virInterfaceObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "111-115",
    "snippet": "virInterfaceDefPtr\nvirInterfaceObjGetDef(virInterfaceObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvirInterfaceDefPtr\nvirInterfaceObjGetDef(virInterfaceObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virInterfaceObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "99-108",
    "snippet": "void\nvirInterfaceObjEndAPI(virInterfaceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nvoid\nvirInterfaceObjEndAPI(virInterfaceObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virInterfaceObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "82-96",
    "snippet": "static virInterfaceObjPtr\nvirInterfaceObjNew(void)\n{\n    virInterfaceObjPtr obj;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virInterfaceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virInterfaceObjClass;",
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virInterfaceObjClass"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virInterfaceObjInitialize",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic virClassPtr virInterfaceObjClass;\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic virInterfaceObjPtr\nvirInterfaceObjNew(void)\n{\n    virInterfaceObjPtr obj;\n\n    if (virInterfaceObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virInterfaceObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virInterfaceObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "73-79",
    "snippet": "static void\nvirInterfaceObjDispose(void *opaque)\n{\n    virInterfaceObjPtr obj = opaque;\n\n    virInterfaceDefFree(obj->def);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virInterfaceObjDispose(void *obj);",
      "static void virInterfaceObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virInterfaceDefFree",
          "args": [
            "obj->def"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virInterfaceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/interface_conf.c",
          "lines": "73-115",
          "snippet": "void\nvirInterfaceDefFree(virInterfaceDefPtr def)\n{\n    size_t i;\n    int pp;\n\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->mac);\n\n    switch (def->type) {\n        case VIR_INTERFACE_TYPE_BRIDGE:\n            VIR_FREE(def->data.bridge.delay);\n            for (i = 0; i < def->data.bridge.nbItf; i++) {\n                if (def->data.bridge.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bridge.itf[i]);\n            }\n            VIR_FREE(def->data.bridge.itf);\n            break;\n        case VIR_INTERFACE_TYPE_BOND:\n            VIR_FREE(def->data.bond.target);\n            for (i = 0; i < def->data.bond.nbItf; i++) {\n                if (def->data.bond.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bond.itf[i]);\n            }\n            VIR_FREE(def->data.bond.itf);\n            break;\n        case VIR_INTERFACE_TYPE_VLAN:\n            VIR_FREE(def->data.vlan.tag);\n            VIR_FREE(def->data.vlan.dev_name);\n            break;\n    }\n\n    /* free all protos */\n    for (pp = 0; pp < def->nprotos; pp++)\n        virInterfaceProtocolDefFree(def->protos[pp]);\n    VIR_FREE(def->protos);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"interface_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirInterfaceDefFree(virInterfaceDefPtr def)\n{\n    size_t i;\n    int pp;\n\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->name);\n    VIR_FREE(def->mac);\n\n    switch (def->type) {\n        case VIR_INTERFACE_TYPE_BRIDGE:\n            VIR_FREE(def->data.bridge.delay);\n            for (i = 0; i < def->data.bridge.nbItf; i++) {\n                if (def->data.bridge.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bridge.itf[i]);\n            }\n            VIR_FREE(def->data.bridge.itf);\n            break;\n        case VIR_INTERFACE_TYPE_BOND:\n            VIR_FREE(def->data.bond.target);\n            for (i = 0; i < def->data.bond.nbItf; i++) {\n                if (def->data.bond.itf[i] == NULL)\n                    break; /* to cope with half parsed data on errors */\n                virInterfaceDefFree(def->data.bond.itf[i]);\n            }\n            VIR_FREE(def->data.bond.itf);\n            break;\n        case VIR_INTERFACE_TYPE_VLAN:\n            VIR_FREE(def->data.vlan.tag);\n            VIR_FREE(def->data.vlan.dev_name);\n            break;\n    }\n\n    /* free all protos */\n    for (pp = 0; pp < def->nprotos; pp++)\n        virInterfaceProtocolDefFree(def->protos[pp]);\n    VIR_FREE(def->protos);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic void virInterfaceObjDispose(void *obj);\nstatic void virInterfaceObjListDispose(void *obj);\n\nstatic void\nvirInterfaceObjDispose(void *opaque)\n{\n    virInterfaceObjPtr obj = opaque;\n\n    virInterfaceDefFree(obj->def);\n}"
  },
  {
    "function_name": "virInterfaceObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virinterfaceobj.c",
    "lines": "58-68",
    "snippet": "static int\nvirInterfaceObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virInterfaceObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virInterfaceObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virinterfaceobj.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"interface_conf.h\"",
      "#include \"datatypes.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virInterfaceObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virInterfaceObj",
            "virClassForObjectLockable()"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virinterfaceobj.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"interface_conf.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nstatic int\nvirInterfaceObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virInterfaceObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virInterfaceObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]