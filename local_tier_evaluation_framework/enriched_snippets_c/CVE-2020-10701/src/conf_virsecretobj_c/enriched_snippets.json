[
  {
    "function_name": "virSecretLoadAllConfigs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "904-940",
    "snippet": "int\nvirSecretLoadAllConfigs(virSecretObjListPtr secrets,\n                        const char *configDir)\n{\n    DIR *dir = NULL;\n    struct dirent *de;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    /* Ignore errors reported by readdir or other calls within the\n     * loop (if any).  It's better to keep the secrets we managed to find. */\n    while (virDirRead(dir, &de, NULL) > 0) {\n        char *path;\n        virSecretObjPtr obj;\n\n        if (!virStringHasSuffix(de->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, de->d_name, NULL)))\n            continue;\n\n        if (!(obj = virSecretLoad(secrets, de->d_name, path, configDir))) {\n            VIR_ERROR(_(\"Error reading secret: %s\"),\n                      virGetLastErrorMessage());\n            VIR_FREE(path);\n            continue;\n        }\n\n        VIR_FREE(path);\n        virSecretObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dir"
          ],
          "line": 938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecretObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "99-108",
          "snippet": "void\nvirSecretObjEndAPI(virSecretObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjEndAPI(virSecretObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Error reading secret: %s\")",
            "virGetLastErrorMessage()"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 929
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Error reading secret: %s\""
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretLoad",
          "args": [
            "secrets",
            "de->d_name",
            "path",
            "configDir"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLoad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "873-901",
          "snippet": "static virSecretObjPtr\nvirSecretLoad(virSecretObjListPtr secrets,\n              const char *file,\n              const char *path,\n              const char *configDir)\n{\n    virSecretDefPtr def = NULL;\n    virSecretObjPtr obj = NULL;\n\n    if (!(def = virSecretDefParseFile(path)))\n        goto cleanup;\n\n    if (virSecretLoadValidateUUID(def, file) < 0)\n        goto cleanup;\n\n    if (!(obj = virSecretObjListAdd(secrets, def, configDir, NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virSecretLoadValue(obj) < 0) {\n        virSecretObjListRemove(secrets, obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n cleanup:\n    virSecretDefFree(def);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretLoad(virSecretObjListPtr secrets,\n              const char *file,\n              const char *path,\n              const char *configDir)\n{\n    virSecretDefPtr def = NULL;\n    virSecretObjPtr obj = NULL;\n\n    if (!(def = virSecretDefParseFile(path)))\n        goto cleanup;\n\n    if (virSecretLoadValidateUUID(def, file) < 0)\n        goto cleanup;\n\n    if (!(obj = virSecretObjListAdd(secrets, def, configDir, NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virSecretLoadValue(obj) < 0) {\n        virSecretObjListRemove(secrets, obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n cleanup:\n    virSecretDefFree(def);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "configDir",
            "de->d_name",
            "NULL"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringHasSuffix",
          "args": [
            "de->d_name",
            "\".xml\""
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "virStringHasSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1097-1108",
          "snippet": "bool\nvirStringHasSuffix(const char *str,\n                   const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STREQ(str + len - suffixlen, suffix);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringHasSuffix(const char *str,\n                   const char *suffix)\n{\n    int len = strlen(str);\n    int suffixlen = strlen(suffix);\n\n    if (len < suffixlen)\n        return false;\n\n    return STREQ(str + len - suffixlen, suffix);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&de",
            "NULL"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dir",
            "configDir"
          ],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nint\nvirSecretLoadAllConfigs(virSecretObjListPtr secrets,\n                        const char *configDir)\n{\n    DIR *dir = NULL;\n    struct dirent *de;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    /* Ignore errors reported by readdir or other calls within the\n     * loop (if any).  It's better to keep the secrets we managed to find. */\n    while (virDirRead(dir, &de, NULL) > 0) {\n        char *path;\n        virSecretObjPtr obj;\n\n        if (!virStringHasSuffix(de->d_name, \".xml\"))\n            continue;\n\n        if (!(path = virFileBuildPath(configDir, de->d_name, NULL)))\n            continue;\n\n        if (!(obj = virSecretLoad(secrets, de->d_name, path, configDir))) {\n            VIR_ERROR(_(\"Error reading secret: %s\"),\n                      virGetLastErrorMessage());\n            VIR_FREE(path);\n            continue;\n        }\n\n        VIR_FREE(path);\n        virSecretObjEndAPI(&obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return 0;\n}"
  },
  {
    "function_name": "virSecretLoad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "873-901",
    "snippet": "static virSecretObjPtr\nvirSecretLoad(virSecretObjListPtr secrets,\n              const char *file,\n              const char *path,\n              const char *configDir)\n{\n    virSecretDefPtr def = NULL;\n    virSecretObjPtr obj = NULL;\n\n    if (!(def = virSecretDefParseFile(path)))\n        goto cleanup;\n\n    if (virSecretLoadValidateUUID(def, file) < 0)\n        goto cleanup;\n\n    if (!(obj = virSecretObjListAdd(secrets, def, configDir, NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virSecretLoadValue(obj) < 0) {\n        virSecretObjListRemove(secrets, obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n cleanup:\n    virSecretDefFree(def);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecretDefFree",
          "args": [
            "def"
          ],
          "line": 899
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_conf.c",
          "lines": "40-49",
          "snippet": "void\nvirSecretDefFree(virSecretDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->description);\n    VIR_FREE(def->usage_id);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virerror.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"secret_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virerror.h\"\n#include \"virsecretobj.h\"\n#include \"secret_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecretDefFree(virSecretDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->description);\n    VIR_FREE(def->usage_id);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjListRemove",
          "args": [
            "secrets",
            "obj"
          ],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "286-307",
          "snippet": "void\nvirSecretObjListRemove(virSecretObjListPtr secrets,\n                       virSecretObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virSecretDefPtr def;\n\n    if (!obj)\n        return;\n    def = obj->def;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n\n    virObjectRWLockWrite(secrets);\n    virObjectLock(obj);\n    virHashRemoveEntry(secrets->objs, uuidstr);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(secrets);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjListRemove(virSecretObjListPtr secrets,\n                       virSecretObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virSecretDefPtr def;\n\n    if (!obj)\n        return;\n    def = obj->def;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n\n    virObjectRWLockWrite(secrets);\n    virObjectLock(obj);\n    virHashRemoveEntry(secrets->objs, uuidstr);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(secrets);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretLoadValue",
          "args": [
            "obj"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLoadValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "819-870",
          "snippet": "static int\nvirSecretLoadValue(virSecretObjPtr obj)\n{\n    int ret = -1, fd = -1;\n    struct stat st;\n    g_autofree char *contents = NULL;\n\n    if ((fd = open(obj->base64File, O_RDONLY)) == -1) {\n        if (errno == ENOENT) {\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno, _(\"cannot open '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if (fstat(fd, &st) < 0) {\n        virReportSystemError(errno, _(\"cannot stat '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if ((size_t)st.st_size != st.st_size) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' file does not fit in memory\"),\n                       obj->base64File);\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(contents, st.st_size + 1) < 0)\n        goto cleanup;\n\n    if (saferead(fd, contents, st.st_size) != st.st_size) {\n        virReportSystemError(errno, _(\"cannot read '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n    contents[st.st_size] = '\\0';\n\n    VIR_FORCE_CLOSE(fd);\n\n    obj->value = g_base64_decode(contents, &obj->value_size);\n\n    ret = 0;\n\n cleanup:\n    if (contents != NULL)\n        memset(contents, 0, st.st_size);\n    VIR_FORCE_CLOSE(fd);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic int\nvirSecretLoadValue(virSecretObjPtr obj)\n{\n    int ret = -1, fd = -1;\n    struct stat st;\n    g_autofree char *contents = NULL;\n\n    if ((fd = open(obj->base64File, O_RDONLY)) == -1) {\n        if (errno == ENOENT) {\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno, _(\"cannot open '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if (fstat(fd, &st) < 0) {\n        virReportSystemError(errno, _(\"cannot stat '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if ((size_t)st.st_size != st.st_size) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' file does not fit in memory\"),\n                       obj->base64File);\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(contents, st.st_size + 1) < 0)\n        goto cleanup;\n\n    if (saferead(fd, contents, st.st_size) != st.st_size) {\n        virReportSystemError(errno, _(\"cannot read '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n    contents[st.st_size] = '\\0';\n\n    VIR_FORCE_CLOSE(fd);\n\n    obj->value = g_base64_decode(contents, &obj->value_size);\n\n    ret = 0;\n\n cleanup:\n    if (contents != NULL)\n        memset(contents, 0, st.st_size);\n    VIR_FORCE_CLOSE(fd);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjListAdd",
          "args": [
            "secrets",
            "def",
            "configDir",
            "NULL"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "321-402",
          "snippet": "virSecretObjPtr\nvirSecretObjListAdd(virSecretObjListPtr secrets,\n                    virSecretDefPtr newdef,\n                    const char *configDir,\n                    virSecretDefPtr *oldDef)\n{\n    virSecretObjPtr obj;\n    virSecretDefPtr objdef;\n    virSecretObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virObjectRWLockWrite(secrets);\n\n    if (oldDef)\n        *oldDef = NULL;\n\n    virUUIDFormat(newdef->uuid, uuidstr);\n\n    /* Is there a secret already matching this UUID */\n    if ((obj = virSecretObjListFindByUUIDLocked(secrets, uuidstr))) {\n        virObjectLock(obj);\n        objdef = obj->def;\n\n        if (STRNEQ_NULLABLE(objdef->usage_id, newdef->usage_id)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s is already defined for \"\n                             \"use with %s\"),\n                           uuidstr, objdef->usage_id);\n            goto cleanup;\n        }\n\n        if (objdef->isprivate && !newdef->isprivate) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"cannot change private flag on existing secret\"));\n            goto cleanup;\n        }\n\n        if (oldDef)\n            *oldDef = objdef;\n        else\n            virSecretDefFree(objdef);\n        obj->def = newdef;\n    } else {\n        /* No existing secret with same UUID,\n         * try look for matching usage instead */\n        if ((obj = virSecretObjListFindByUsageLocked(secrets,\n                                                     newdef->usage_type,\n                                                     newdef->usage_id))) {\n            virObjectLock(obj);\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s already defined for \"\n                             \"use with %s\"),\n                           uuidstr, newdef->usage_id);\n            goto cleanup;\n        }\n\n        if (!(obj = virSecretObjNew()))\n            goto cleanup;\n\n        /* Generate the possible configFile and base64File strings\n         * using the configDir, uuidstr, and appropriate suffix\n         */\n        if (!(obj->configFile = virFileBuildPath(configDir, uuidstr, \".xml\")) ||\n            !(obj->base64File = virFileBuildPath(configDir, uuidstr, \".base64\")))\n            goto cleanup;\n\n        if (virHashAddEntry(secrets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n\n        obj->def = newdef;\n        virObjectRef(obj);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virSecretObjEndAPI(&obj);\n    virObjectRWUnlock(secrets);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvirSecretObjPtr\nvirSecretObjListAdd(virSecretObjListPtr secrets,\n                    virSecretDefPtr newdef,\n                    const char *configDir,\n                    virSecretDefPtr *oldDef)\n{\n    virSecretObjPtr obj;\n    virSecretDefPtr objdef;\n    virSecretObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virObjectRWLockWrite(secrets);\n\n    if (oldDef)\n        *oldDef = NULL;\n\n    virUUIDFormat(newdef->uuid, uuidstr);\n\n    /* Is there a secret already matching this UUID */\n    if ((obj = virSecretObjListFindByUUIDLocked(secrets, uuidstr))) {\n        virObjectLock(obj);\n        objdef = obj->def;\n\n        if (STRNEQ_NULLABLE(objdef->usage_id, newdef->usage_id)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s is already defined for \"\n                             \"use with %s\"),\n                           uuidstr, objdef->usage_id);\n            goto cleanup;\n        }\n\n        if (objdef->isprivate && !newdef->isprivate) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"cannot change private flag on existing secret\"));\n            goto cleanup;\n        }\n\n        if (oldDef)\n            *oldDef = objdef;\n        else\n            virSecretDefFree(objdef);\n        obj->def = newdef;\n    } else {\n        /* No existing secret with same UUID,\n         * try look for matching usage instead */\n        if ((obj = virSecretObjListFindByUsageLocked(secrets,\n                                                     newdef->usage_type,\n                                                     newdef->usage_id))) {\n            virObjectLock(obj);\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s already defined for \"\n                             \"use with %s\"),\n                           uuidstr, newdef->usage_id);\n            goto cleanup;\n        }\n\n        if (!(obj = virSecretObjNew()))\n            goto cleanup;\n\n        /* Generate the possible configFile and base64File strings\n         * using the configDir, uuidstr, and appropriate suffix\n         */\n        if (!(obj->configFile = virFileBuildPath(configDir, uuidstr, \".xml\")) ||\n            !(obj->base64File = virFileBuildPath(configDir, uuidstr, \".base64\")))\n            goto cleanup;\n\n        if (virHashAddEntry(secrets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n\n        obj->def = newdef;\n        virObjectRef(obj);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virSecretObjEndAPI(&obj);\n    virObjectRWUnlock(secrets);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretLoadValidateUUID",
          "args": [
            "def",
            "file"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretLoadValidateUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "800-816",
          "snippet": "static int\nvirSecretLoadValidateUUID(virSecretDefPtr def,\n                          const char *file)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (!virStringMatchesNameSuffix(file, uuidstr, \".xml\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"<uuid> does not match secret file name '%s'\"),\n                       file);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirSecretLoadValidateUUID(virSecretDefPtr def,\n                          const char *file)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (!virStringMatchesNameSuffix(file, uuidstr, \".xml\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"<uuid> does not match secret file name '%s'\"),\n                       file);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretDefParseFile",
          "args": [
            "path"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretDefParseFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_conf.c",
          "lines": "220-224",
          "snippet": "virSecretDefPtr\nvirSecretDefParseFile(const char *filename)\n{\n    return virSecretDefParse(NULL, filename);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virerror.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"secret_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virerror.h\"\n#include \"virsecretobj.h\"\n#include \"secret_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirSecretDefPtr\nvirSecretDefParseFile(const char *filename)\n{\n    return virSecretDefParse(NULL, filename);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretLoad(virSecretObjListPtr secrets,\n              const char *file,\n              const char *path,\n              const char *configDir)\n{\n    virSecretDefPtr def = NULL;\n    virSecretObjPtr obj = NULL;\n\n    if (!(def = virSecretDefParseFile(path)))\n        goto cleanup;\n\n    if (virSecretLoadValidateUUID(def, file) < 0)\n        goto cleanup;\n\n    if (!(obj = virSecretObjListAdd(secrets, def, configDir, NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virSecretLoadValue(obj) < 0) {\n        virSecretObjListRemove(secrets, obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n cleanup:\n    virSecretDefFree(def);\n    return obj;\n}"
  },
  {
    "function_name": "virSecretLoadValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "819-870",
    "snippet": "static int\nvirSecretLoadValue(virSecretObjPtr obj)\n{\n    int ret = -1, fd = -1;\n    struct stat st;\n    g_autofree char *contents = NULL;\n\n    if ((fd = open(obj->base64File, O_RDONLY)) == -1) {\n        if (errno == ENOENT) {\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno, _(\"cannot open '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if (fstat(fd, &st) < 0) {\n        virReportSystemError(errno, _(\"cannot stat '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if ((size_t)st.st_size != st.st_size) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' file does not fit in memory\"),\n                       obj->base64File);\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(contents, st.st_size + 1) < 0)\n        goto cleanup;\n\n    if (saferead(fd, contents, st.st_size) != st.st_size) {\n        virReportSystemError(errno, _(\"cannot read '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n    contents[st.st_size] = '\\0';\n\n    VIR_FORCE_CLOSE(fd);\n\n    obj->value = g_base64_decode(contents, &obj->value_size);\n\n    ret = 0;\n\n cleanup:\n    if (contents != NULL)\n        memset(contents, 0, st.st_size);\n    VIR_FORCE_CLOSE(fd);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "contents",
            "0",
            "st.st_size"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_base64_decode",
          "args": [
            "contents",
            "&obj->value_size"
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot read '%s'\")",
            "obj->base64File"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot read '%s'\""
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "saferead",
          "args": [
            "fd",
            "contents",
            "st.st_size"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "contents",
            "st.st_size + 1"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"'%s' file does not fit in memory\")",
            "obj->base64File"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot stat '%s'\")",
            "obj->base64File"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fstat",
          "args": [
            "fd",
            "&st"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot open '%s'\")",
            "obj->base64File"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "obj->base64File",
            "O_RDONLY"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic int\nvirSecretLoadValue(virSecretObjPtr obj)\n{\n    int ret = -1, fd = -1;\n    struct stat st;\n    g_autofree char *contents = NULL;\n\n    if ((fd = open(obj->base64File, O_RDONLY)) == -1) {\n        if (errno == ENOENT) {\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno, _(\"cannot open '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if (fstat(fd, &st) < 0) {\n        virReportSystemError(errno, _(\"cannot stat '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n\n    if ((size_t)st.st_size != st.st_size) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"'%s' file does not fit in memory\"),\n                       obj->base64File);\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(contents, st.st_size + 1) < 0)\n        goto cleanup;\n\n    if (saferead(fd, contents, st.st_size) != st.st_size) {\n        virReportSystemError(errno, _(\"cannot read '%s'\"),\n                             obj->base64File);\n        goto cleanup;\n    }\n    contents[st.st_size] = '\\0';\n\n    VIR_FORCE_CLOSE(fd);\n\n    obj->value = g_base64_decode(contents, &obj->value_size);\n\n    ret = 0;\n\n cleanup:\n    if (contents != NULL)\n        memset(contents, 0, st.st_size);\n    VIR_FORCE_CLOSE(fd);\n    return ret;\n}"
  },
  {
    "function_name": "virSecretLoadValidateUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "800-816",
    "snippet": "static int\nvirSecretLoadValidateUUID(virSecretDefPtr def,\n                          const char *file)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (!virStringMatchesNameSuffix(file, uuidstr, \".xml\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"<uuid> does not match secret file name '%s'\"),\n                       file);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"<uuid> does not match secret file name '%s'\")",
            "file"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"<uuid> does not match secret file name '%s'\""
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringMatchesNameSuffix",
          "args": [
            "file",
            "uuidstr",
            "\".xml\""
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virStringMatchesNameSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1141-1156",
          "snippet": "bool\nvirStringMatchesNameSuffix(const char *file,\n                           const char *name,\n                           const char *suffix)\n{\n    int filelen = strlen(file);\n    int namelen = strlen(name);\n    int suffixlen = strlen(suffix);\n\n    if (filelen == (namelen + suffixlen) &&\n        STREQLEN(file, name, namelen) &&\n        STREQ(file + namelen, suffix))\n        return true;\n    else\n        return false;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nbool\nvirStringMatchesNameSuffix(const char *file,\n                           const char *name,\n                           const char *suffix)\n{\n    int filelen = strlen(file);\n    int namelen = strlen(name);\n    int suffixlen = strlen(suffix);\n\n    if (filelen == (namelen + suffixlen) &&\n        STREQLEN(file, name, namelen) &&\n        STREQ(file + namelen, suffix))\n        return true;\n    else\n        return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirSecretLoadValidateUUID(virSecretDefPtr def,\n                          const char *file)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virUUIDFormat(def->uuid, uuidstr);\n\n    if (!virStringMatchesNameSuffix(file, uuidstr, \".xml\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"<uuid> does not match secret file name '%s'\"),\n                       file);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjSetValueSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "792-797",
    "snippet": "void\nvirSecretObjSetValueSize(virSecretObjPtr obj,\n                         size_t value_size)\n{\n    obj->value_size = value_size;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjSetValueSize(virSecretObjPtr obj,\n                         size_t value_size)\n{\n    obj->value_size = value_size;\n}"
  },
  {
    "function_name": "virSecretObjGetValueSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "785-789",
    "snippet": "size_t\nvirSecretObjGetValueSize(virSecretObjPtr obj)\n{\n    return obj->value_size;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nsize_t\nvirSecretObjGetValueSize(virSecretObjPtr obj)\n{\n    return obj->value_size;\n}"
  },
  {
    "function_name": "virSecretObjSetValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "746-782",
    "snippet": "int\nvirSecretObjSetValue(virSecretObjPtr obj,\n                     const unsigned char *value,\n                     size_t value_size)\n{\n    virSecretDefPtr def = obj->def;\n    g_autofree unsigned char *old_value = NULL;\n    g_autofree unsigned char *new_value = NULL;\n    size_t old_value_size;\n\n    if (VIR_ALLOC_N(new_value, value_size) < 0)\n        return -1;\n\n    old_value = obj->value;\n    old_value_size = obj->value_size;\n\n    memcpy(new_value, value, value_size);\n    obj->value = g_steal_pointer(&new_value);\n    obj->value_size = value_size;\n\n    if (!def->isephemeral && virSecretObjSaveData(obj) < 0)\n        goto error;\n\n    /* Saved successfully - drop old value */\n    if (old_value)\n        memset(old_value, 0, old_value_size);\n\n    return 0;\n\n error:\n    /* Error - restore previous state and free new value */\n    new_value = g_steal_pointer(&obj->value);\n    obj->value = g_steal_pointer(&old_value);\n    obj->value_size = old_value_size;\n    memset(new_value, 0, value_size);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "new_value",
            "0",
            "value_size"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&old_value"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&obj->value"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "old_value",
            "0",
            "old_value_size"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecretObjSaveData",
          "args": [
            "obj"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjSaveData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "692-706",
          "snippet": "int\nvirSecretObjSaveData(virSecretObjPtr obj)\n{\n    g_autofree char *base64 = NULL;\n\n    if (!obj->value)\n        return 0;\n\n    base64 = g_base64_encode(obj->value, obj->value_size);\n\n    if (virFileRewriteStr(obj->base64File, S_IRUSR | S_IWUSR, base64) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nint\nvirSecretObjSaveData(virSecretObjPtr obj)\n{\n    g_autofree char *base64 = NULL;\n\n    if (!obj->value)\n        return 0;\n\n    base64 = g_base64_encode(obj->value, obj->value_size);\n\n    if (virFileRewriteStr(obj->base64File, S_IRUSR | S_IWUSR, base64) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&new_value"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new_value",
            "value",
            "value_size"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "new_value",
            "value_size"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nint\nvirSecretObjSetValue(virSecretObjPtr obj,\n                     const unsigned char *value,\n                     size_t value_size)\n{\n    virSecretDefPtr def = obj->def;\n    g_autofree unsigned char *old_value = NULL;\n    g_autofree unsigned char *new_value = NULL;\n    size_t old_value_size;\n\n    if (VIR_ALLOC_N(new_value, value_size) < 0)\n        return -1;\n\n    old_value = obj->value;\n    old_value_size = obj->value_size;\n\n    memcpy(new_value, value, value_size);\n    obj->value = g_steal_pointer(&new_value);\n    obj->value_size = value_size;\n\n    if (!def->isephemeral && virSecretObjSaveData(obj) < 0)\n        goto error;\n\n    /* Saved successfully - drop old value */\n    if (old_value)\n        memset(old_value, 0, old_value_size);\n\n    return 0;\n\n error:\n    /* Error - restore previous state and free new value */\n    new_value = g_steal_pointer(&obj->value);\n    obj->value = g_steal_pointer(&old_value);\n    obj->value_size = old_value_size;\n    memset(new_value, 0, value_size);\n    return -1;\n}"
  },
  {
    "function_name": "virSecretObjGetValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "724-743",
    "snippet": "unsigned char *\nvirSecretObjGetValue(virSecretObjPtr obj)\n{\n    virSecretDefPtr def = obj->def;\n    unsigned char *ret = NULL;\n\n    if (!obj->value) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(def->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_SECRET,\n                       _(\"secret '%s' does not have a value\"), uuidstr);\n        return NULL;\n    }\n\n    if (VIR_ALLOC_N(ret, obj->value_size) < 0)\n        return NULL;\n    memcpy(ret, obj->value, obj->value_size);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ret",
            "obj->value",
            "obj->value_size"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "ret",
            "obj->value_size"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SECRET",
            "_(\"secret '%s' does not have a value\")",
            "uuidstr"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"secret '%s' does not have a value\""
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nunsigned char *\nvirSecretObjGetValue(virSecretObjPtr obj)\n{\n    virSecretDefPtr def = obj->def;\n    unsigned char *ret = NULL;\n\n    if (!obj->value) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(def->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_SECRET,\n                       _(\"secret '%s' does not have a value\"), uuidstr);\n        return NULL;\n    }\n\n    if (VIR_ALLOC_N(ret, obj->value_size) < 0)\n        return NULL;\n    memcpy(ret, obj->value, obj->value_size);\n\n    return ret;\n}"
  },
  {
    "function_name": "virSecretObjSetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "716-721",
    "snippet": "void\nvirSecretObjSetDef(virSecretObjPtr obj,\n                   virSecretDefPtr def)\n{\n    obj->def = def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjSetDef(virSecretObjPtr obj,\n                   virSecretDefPtr def)\n{\n    obj->def = def;\n}"
  },
  {
    "function_name": "virSecretObjGetDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "709-713",
    "snippet": "virSecretDefPtr\nvirSecretObjGetDef(virSecretObjPtr obj)\n{\n    return obj->def;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvirSecretDefPtr\nvirSecretObjGetDef(virSecretObjPtr obj)\n{\n    return obj->def;\n}"
  },
  {
    "function_name": "virSecretObjSaveData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "692-706",
    "snippet": "int\nvirSecretObjSaveData(virSecretObjPtr obj)\n{\n    g_autofree char *base64 = NULL;\n\n    if (!obj->value)\n        return 0;\n\n    base64 = g_base64_encode(obj->value, obj->value_size);\n\n    if (virFileRewriteStr(obj->base64File, S_IRUSR | S_IWUSR, base64) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileRewriteStr",
          "args": [
            "obj->base64File",
            "S_IRUSR | S_IWUSR",
            "base64"
          ],
          "line": 702
        },
        "resolved": true,
        "details": {
          "function_name": "virFileRewriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "581-588",
          "snippet": "int\nvirFileRewriteStr(const char *path,\n                  mode_t mode,\n                  const char *str)\n{\n    return virFileRewrite(path, mode,\n                          virFileRewriteStrHelper, str);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRewriteStr(const char *path,\n                  mode_t mode,\n                  const char *str)\n{\n    return virFileRewrite(path, mode,\n                          virFileRewriteStrHelper, str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_base64_encode",
          "args": [
            "obj->value",
            "obj->value_size"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nint\nvirSecretObjSaveData(virSecretObjPtr obj)\n{\n    g_autofree char *base64 = NULL;\n\n    if (!obj->value)\n        return 0;\n\n    base64 = g_base64_encode(obj->value, obj->value_size);\n\n    if (virFileRewriteStr(obj->base64File, S_IRUSR | S_IWUSR, base64) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjSaveConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "677-689",
    "snippet": "int\nvirSecretObjSaveConfig(virSecretObjPtr obj)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virSecretDefFormat(obj->def)))\n        return -1;\n\n    if (virFileRewriteStr(obj->configFile, S_IRUSR | S_IWUSR, xml) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileRewriteStr",
          "args": [
            "obj->configFile",
            "S_IRUSR | S_IWUSR",
            "xml"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virFileRewriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "581-588",
          "snippet": "int\nvirFileRewriteStr(const char *path,\n                  mode_t mode,\n                  const char *str)\n{\n    return virFileRewrite(path, mode,\n                          virFileRewriteStrHelper, str);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRewriteStr(const char *path,\n                  mode_t mode,\n                  const char *str)\n{\n    return virFileRewrite(path, mode,\n                          virFileRewriteStrHelper, str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretDefFormat",
          "args": [
            "obj->def"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_conf.c",
          "lines": "277-306",
          "snippet": "char *\nvirSecretDefFormat(const virSecretDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const unsigned char *uuid;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virBufferAsprintf(&buf, \"<secret ephemeral='%s' private='%s'>\\n\",\n                      def->isephemeral ? \"yes\" : \"no\",\n                      def->isprivate ? \"yes\" : \"no\");\n\n    uuid = def->uuid;\n    virUUIDFormat(uuid, uuidstr);\n    virBufferAdjustIndent(&buf, 2);\n    virBufferEscapeString(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    if (def->description != NULL)\n        virBufferEscapeString(&buf, \"<description>%s</description>\\n\",\n                              def->description);\n    if (def->usage_type != VIR_SECRET_USAGE_TYPE_NONE &&\n        virSecretDefFormatUsage(&buf, def) < 0)\n        goto error;\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</secret>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virerror.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"secret_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virerror.h\"\n#include \"virsecretobj.h\"\n#include \"secret_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirSecretDefFormat(const virSecretDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const unsigned char *uuid;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virBufferAsprintf(&buf, \"<secret ephemeral='%s' private='%s'>\\n\",\n                      def->isephemeral ? \"yes\" : \"no\",\n                      def->isprivate ? \"yes\" : \"no\");\n\n    uuid = def->uuid;\n    virUUIDFormat(uuid, uuidstr);\n    virBufferAdjustIndent(&buf, 2);\n    virBufferEscapeString(&buf, \"<uuid>%s</uuid>\\n\", uuidstr);\n    if (def->description != NULL)\n        virBufferEscapeString(&buf, \"<description>%s</description>\\n\",\n                              def->description);\n    if (def->usage_type != VIR_SECRET_USAGE_TYPE_NONE &&\n        virSecretDefFormatUsage(&buf, def) < 0)\n        goto error;\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</secret>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nint\nvirSecretObjSaveConfig(virSecretObjPtr obj)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virSecretDefFormat(obj->def)))\n        return -1;\n\n    if (virFileRewriteStr(obj->configFile, S_IRUSR | S_IWUSR, xml) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjDeleteData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "662-668",
    "snippet": "void\nvirSecretObjDeleteData(virSecretObjPtr obj)\n{\n    /* The configFile will already be removed, so secret won't be\n     * loaded again if this fails */\n    unlink(obj->base64File);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "obj->base64File"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjDeleteData(virSecretObjPtr obj)\n{\n    /* The configFile will already be removed, so secret won't be\n     * loaded again if this fails */\n    unlink(obj->base64File);\n}"
  },
  {
    "function_name": "virSecretObjDeleteConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "646-659",
    "snippet": "int\nvirSecretObjDeleteConfig(virSecretObjPtr obj)\n{\n    virSecretDefPtr def = obj->def;\n\n    if (!def->isephemeral &&\n        unlink(obj->configFile) < 0 && errno != ENOENT) {\n        virReportSystemError(errno, _(\"cannot unlink '%s'\"),\n                             obj->configFile);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot unlink '%s'\")",
            "obj->configFile"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot unlink '%s'\""
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "obj->configFile"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nint\nvirSecretObjDeleteConfig(virSecretObjPtr obj)\n{\n    virSecretDefPtr def = obj->def;\n\n    if (!def->isephemeral &&\n        unlink(obj->configFile) < 0 && errno != ENOENT) {\n        virReportSystemError(errno, _(\"cannot unlink '%s'\"),\n                             obj->configFile);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjListGetUUIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "619-643",
    "snippet": "int\nvirSecretObjListGetUUIDs(virSecretObjListPtr secrets,\n                         char **uuids,\n                         int maxuuids,\n                         virSecretObjListACLFilter filter,\n                         virConnectPtr conn)\n{\n    struct virSecretListData data = {\n        .conn = conn, .filter = filter, .uuids = uuids, .nuuids = 0,\n        .maxuuids = maxuuids, .error = false };\n\n    virObjectRWLockRead(secrets);\n    virHashForEach(secrets->objs, virSecretObjListGetUUIDsCallback, &data);\n    virObjectRWUnlock(secrets);\n\n    if (data.error)\n        goto error;\n\n    return data.nuuids;\n\n error:\n    while (--data.nuuids)\n        VIR_FREE(data.uuids[data.nuuids]);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "data.uuids[data.nuuids]"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secrets"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "secrets->objs",
            "virSecretObjListGetUUIDsCallback",
            "&data"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "secrets"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSecretObjListGetUUIDs(virSecretObjListPtr secrets,\n                         char **uuids,\n                         int maxuuids,\n                         virSecretObjListACLFilter filter,\n                         virConnectPtr conn)\n{\n    struct virSecretListData data = {\n        .conn = conn, .filter = filter, .uuids = uuids, .nuuids = 0,\n        .maxuuids = maxuuids, .error = false };\n\n    virObjectRWLockRead(secrets);\n    virHashForEach(secrets->objs, virSecretObjListGetUUIDsCallback, &data);\n    virObjectRWUnlock(secrets);\n\n    if (data.error)\n        goto error;\n\n    return data.nuuids;\n\n error:\n    while (--data.nuuids)\n        VIR_FREE(data.uuids[data.nuuids]);\n    return -1;\n}"
  },
  {
    "function_name": "virSecretObjListExport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "580-616",
    "snippet": "int\nvirSecretObjListExport(virConnectPtr conn,\n                       virSecretObjListPtr secretobjs,\n                       virSecretPtr **secrets,\n                       virSecretObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virSecretObjListExportData data = {\n        .conn = conn, .secrets = NULL,\n        .filter = filter, .flags = flags,\n        .nsecrets = 0, .error = false };\n\n    virObjectRWLockRead(secretobjs);\n    if (secrets &&\n        VIR_ALLOC_N(data.secrets, virHashSize(secretobjs->objs) + 1) < 0) {\n        virObjectRWUnlock(secretobjs);\n        return -1;\n    }\n\n    virHashForEach(secretobjs->objs, virSecretObjListExportCallback, &data);\n    virObjectRWUnlock(secretobjs);\n\n    if (data.error)\n        goto error;\n\n    if (data.secrets) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.secrets, data.nsecrets + 1));\n        *secrets = data.secrets;\n    }\n\n    return data.nsecrets;\n\n error:\n    virObjectListFree(data.secrets);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectListFree",
          "args": [
            "data.secrets"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "603-615",
          "snippet": "void\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid\nvirObjectListFree(void *list)\n{\n    void **next;\n\n    if (!list)\n        return;\n\n    for (next = (void **) list; *next; next++)\n        virObjectUnref(*next);\n\n    VIR_FREE(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "VIR_REALLOC_N(data.secrets, data.nsecrets + 1)"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "data.secrets",
            "data.nsecrets + 1"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secretobjs"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "secretobjs->objs",
            "virSecretObjListExportCallback",
            "&data"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "data.secrets",
            "virHashSize(secretobjs->objs) + 1"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "secretobjs->objs"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "secretobjs"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSecretObjListExport(virConnectPtr conn,\n                       virSecretObjListPtr secretobjs,\n                       virSecretPtr **secrets,\n                       virSecretObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virSecretObjListExportData data = {\n        .conn = conn, .secrets = NULL,\n        .filter = filter, .flags = flags,\n        .nsecrets = 0, .error = false };\n\n    virObjectRWLockRead(secretobjs);\n    if (secrets &&\n        VIR_ALLOC_N(data.secrets, virHashSize(secretobjs->objs) + 1) < 0) {\n        virObjectRWUnlock(secretobjs);\n        return -1;\n    }\n\n    virHashForEach(secretobjs->objs, virSecretObjListExportCallback, &data);\n    virObjectRWUnlock(secretobjs);\n\n    if (data.error)\n        goto error;\n\n    if (data.secrets) {\n        /* trim the array to the final size */\n        ignore_value(VIR_REALLOC_N(data.secrets, data.nsecrets + 1));\n        *secrets = data.secrets;\n    }\n\n    return data.nsecrets;\n\n error:\n    virObjectListFree(data.secrets);\n    return -1;\n}"
  },
  {
    "function_name": "virSecretObjListExportCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "538-577",
    "snippet": "static int\nvirSecretObjListExportCallback(void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               void *opaque)\n{\n    virSecretObjListExportDataPtr data = opaque;\n    virSecretObjPtr obj = payload;\n    virSecretDefPtr def;\n    virSecretPtr secret = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (data->filter && !data->filter(data->conn, def))\n        goto cleanup;\n\n    if (!virSecretObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (!data->secrets) {\n        data->nsecrets++;\n        goto cleanup;\n    }\n\n    if (!(secret = virGetSecret(data->conn, def->uuid,\n                                def->usage_type,\n                                def->usage_id))) {\n        data->error = true;\n        goto cleanup;\n    }\n\n    data->secrets[data->nsecrets++] = secret;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetSecret",
          "args": [
            "data->conn",
            "def->uuid",
            "def->usage_type",
            "def->usage_id"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virGetSecret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "729-755",
          "snippet": "virSecretPtr\nvirGetSecret(virConnectPtr conn, const unsigned char *uuid,\n             int usageType, const char *usageID)\n{\n    virSecretPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virSecretClass)))\n        return NULL;\n\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n    ret->usageType = usageType;\n    ret->usageID = g_strdup(NULLSTR_EMPTY(usageID));\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virSecretClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virSecretClass;\n\nvirSecretPtr\nvirGetSecret(virConnectPtr conn, const unsigned char *uuid,\n             int usageType, const char *usageID)\n{\n    virSecretPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virSecretClass)))\n        return NULL;\n\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n    ret->usageType = usageType;\n    ret->usageID = g_strdup(NULLSTR_EMPTY(usageID));\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjMatch",
          "args": [
            "obj",
            "data->flags"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjMatch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "500-523",
          "snippet": "static bool\nvirSecretObjMatch(virSecretObjPtr obj,\n                  unsigned int flags)\n{\n    virSecretDefPtr def = obj->def;\n\n    /* filter by whether it's ephemeral */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_EPHEMERAL) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_EPHEMERAL) &&\n           def->isephemeral) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_EPHEMERAL) &&\n           !def->isephemeral)))\n        return false;\n\n    /* filter by whether it's private */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_PRIVATE) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_PRIVATE) &&\n           def->isprivate) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_PRIVATE) &&\n           !def->isprivate)))\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic bool\nvirSecretObjMatch(virSecretObjPtr obj,\n                  unsigned int flags)\n{\n    virSecretDefPtr def = obj->def;\n\n    /* filter by whether it's ephemeral */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_EPHEMERAL) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_EPHEMERAL) &&\n           def->isephemeral) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_EPHEMERAL) &&\n           !def->isephemeral)))\n        return false;\n\n    /* filter by whether it's private */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_PRIVATE) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_PRIVATE) &&\n           def->isprivate) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_PRIVATE) &&\n           !def->isprivate)))\n        return false;\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "def"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic int\nvirSecretObjListExportCallback(void *payload,\n                               const void *name G_GNUC_UNUSED,\n                               void *opaque)\n{\n    virSecretObjListExportDataPtr data = opaque;\n    virSecretObjPtr obj = payload;\n    virSecretDefPtr def;\n    virSecretPtr secret = NULL;\n\n    if (data->error)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (data->filter && !data->filter(data->conn, def))\n        goto cleanup;\n\n    if (!virSecretObjMatch(obj, data->flags))\n        goto cleanup;\n\n    if (!data->secrets) {\n        data->nsecrets++;\n        goto cleanup;\n    }\n\n    if (!(secret = virGetSecret(data->conn, def->uuid,\n                                def->usage_type,\n                                def->usage_id))) {\n        data->error = true;\n        goto cleanup;\n    }\n\n    data->secrets[data->nsecrets++] = secret;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjMatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "500-523",
    "snippet": "static bool\nvirSecretObjMatch(virSecretObjPtr obj,\n                  unsigned int flags)\n{\n    virSecretDefPtr def = obj->def;\n\n    /* filter by whether it's ephemeral */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_EPHEMERAL) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_EPHEMERAL) &&\n           def->isephemeral) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_EPHEMERAL) &&\n           !def->isephemeral)))\n        return false;\n\n    /* filter by whether it's private */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_PRIVATE) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_PRIVATE) &&\n           def->isprivate) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_PRIVATE) &&\n           !def->isprivate)))\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_SECRETS_NO_PRIVATE"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_SECRETS_PRIVATE"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_SECRETS_FILTERS_PRIVATE"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_SECRETS_NO_EPHEMERAL"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_SECRETS_EPHEMERAL"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MATCH",
          "args": [
            "VIR_CONNECT_LIST_SECRETS_FILTERS_EPHEMERAL"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic bool\nvirSecretObjMatch(virSecretObjPtr obj,\n                  unsigned int flags)\n{\n    virSecretDefPtr def = obj->def;\n\n    /* filter by whether it's ephemeral */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_EPHEMERAL) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_EPHEMERAL) &&\n           def->isephemeral) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_EPHEMERAL) &&\n           !def->isephemeral)))\n        return false;\n\n    /* filter by whether it's private */\n    if (MATCH(VIR_CONNECT_LIST_SECRETS_FILTERS_PRIVATE) &&\n        !((MATCH(VIR_CONNECT_LIST_SECRETS_PRIVATE) &&\n           def->isprivate) ||\n          (MATCH(VIR_CONNECT_LIST_SECRETS_NO_PRIVATE) &&\n           !def->isprivate)))\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virSecretObjListNumOfSecrets",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "483-496",
    "snippet": "int\nvirSecretObjListNumOfSecrets(virSecretObjListPtr secrets,\n                             virSecretObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virSecretCountData data = {\n        .conn = conn, .filter = filter, .count = 0 };\n\n    virObjectRWLockRead(secrets);\n    virHashForEach(secrets->objs, virSecretObjListNumOfSecretsCallback, &data);\n    virObjectRWUnlock(secrets);\n\n    return data.count;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secrets"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "secrets->objs",
            "virSecretObjListNumOfSecretsCallback",
            "&data"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "secrets"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirSecretObjListNumOfSecrets(virSecretObjListPtr secrets,\n                             virSecretObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virSecretCountData data = {\n        .conn = conn, .filter = filter, .count = 0 };\n\n    virObjectRWLockRead(secrets);\n    virHashForEach(secrets->objs, virSecretObjListNumOfSecretsCallback, &data);\n    virObjectRWUnlock(secrets);\n\n    return data.count;\n}"
  },
  {
    "function_name": "virSecretObjListGetUUIDsCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "444-480",
    "snippet": "static int\nvirSecretObjListGetUUIDsCallback(void *payload,\n                                 const void *name G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    struct virSecretListData *data = opaque;\n    virSecretObjPtr obj = payload;\n    virSecretDefPtr def;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxuuids >= 0 && data->nuuids == data->maxuuids)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (data->filter && !data->filter(data->conn, def))\n        goto cleanup;\n\n    if (data->uuids) {\n        char *uuidstr;\n\n        if (VIR_ALLOC_N(uuidstr, VIR_UUID_STRING_BUFLEN) < 0) {\n            data->error = true;\n            goto cleanup;\n        }\n\n        virUUIDFormat(def->uuid, uuidstr);\n        data->uuids[data->nuuids++] = uuidstr;\n    }\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "uuidstr",
            "VIR_UUID_STRING_BUFLEN"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "def"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic int\nvirSecretObjListGetUUIDsCallback(void *payload,\n                                 const void *name G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    struct virSecretListData *data = opaque;\n    virSecretObjPtr obj = payload;\n    virSecretDefPtr def;\n\n    if (data->error)\n        return 0;\n\n    if (data->maxuuids >= 0 && data->nuuids == data->maxuuids)\n        return 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (data->filter && !data->filter(data->conn, def))\n        goto cleanup;\n\n    if (data->uuids) {\n        char *uuidstr;\n\n        if (VIR_ALLOC_N(uuidstr, VIR_UUID_STRING_BUFLEN) < 0) {\n            data->error = true;\n            goto cleanup;\n        }\n\n        virUUIDFormat(def->uuid, uuidstr);\n        data->uuids[data->nuuids++] = uuidstr;\n    }\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjListNumOfSecretsCallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "411-431",
    "snippet": "static int\nvirSecretObjListNumOfSecretsCallback(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    struct virSecretCountData *data = opaque;\n    virSecretObjPtr obj = payload;\n    virSecretDefPtr def;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (data->filter && !data->filter(data->conn, def))\n        goto cleanup;\n\n    data->count++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "data->conn",
            "def"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic int\nvirSecretObjListNumOfSecretsCallback(void *payload,\n                                     const void *name G_GNUC_UNUSED,\n                                     void *opaque)\n{\n    struct virSecretCountData *data = opaque;\n    virSecretObjPtr obj = payload;\n    virSecretDefPtr def;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (data->filter && !data->filter(data->conn, def))\n        goto cleanup;\n\n    data->count++;\n\n cleanup:\n    virObjectUnlock(obj);\n    return 0;\n}"
  },
  {
    "function_name": "virSecretObjListAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "321-402",
    "snippet": "virSecretObjPtr\nvirSecretObjListAdd(virSecretObjListPtr secrets,\n                    virSecretDefPtr newdef,\n                    const char *configDir,\n                    virSecretDefPtr *oldDef)\n{\n    virSecretObjPtr obj;\n    virSecretDefPtr objdef;\n    virSecretObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virObjectRWLockWrite(secrets);\n\n    if (oldDef)\n        *oldDef = NULL;\n\n    virUUIDFormat(newdef->uuid, uuidstr);\n\n    /* Is there a secret already matching this UUID */\n    if ((obj = virSecretObjListFindByUUIDLocked(secrets, uuidstr))) {\n        virObjectLock(obj);\n        objdef = obj->def;\n\n        if (STRNEQ_NULLABLE(objdef->usage_id, newdef->usage_id)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s is already defined for \"\n                             \"use with %s\"),\n                           uuidstr, objdef->usage_id);\n            goto cleanup;\n        }\n\n        if (objdef->isprivate && !newdef->isprivate) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"cannot change private flag on existing secret\"));\n            goto cleanup;\n        }\n\n        if (oldDef)\n            *oldDef = objdef;\n        else\n            virSecretDefFree(objdef);\n        obj->def = newdef;\n    } else {\n        /* No existing secret with same UUID,\n         * try look for matching usage instead */\n        if ((obj = virSecretObjListFindByUsageLocked(secrets,\n                                                     newdef->usage_type,\n                                                     newdef->usage_id))) {\n            virObjectLock(obj);\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s already defined for \"\n                             \"use with %s\"),\n                           uuidstr, newdef->usage_id);\n            goto cleanup;\n        }\n\n        if (!(obj = virSecretObjNew()))\n            goto cleanup;\n\n        /* Generate the possible configFile and base64File strings\n         * using the configDir, uuidstr, and appropriate suffix\n         */\n        if (!(obj->configFile = virFileBuildPath(configDir, uuidstr, \".xml\")) ||\n            !(obj->base64File = virFileBuildPath(configDir, uuidstr, \".base64\")))\n            goto cleanup;\n\n        if (virHashAddEntry(secrets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n\n        obj->def = newdef;\n        virObjectRef(obj);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virSecretObjEndAPI(&obj);\n    virObjectRWUnlock(secrets);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secrets"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "99-108",
          "snippet": "void\nvirSecretObjEndAPI(virSecretObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjEndAPI(virSecretObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&obj"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "secrets->objs",
            "uuidstr",
            "obj"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileBuildPath",
          "args": [
            "configDir",
            "uuidstr",
            "\".base64\""
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "virFileBuildPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3116-3128",
          "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjNew",
          "args": [],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "82-96",
          "snippet": "static virSecretObjPtr\nvirSecretObjNew(void)\n{\n    virSecretObjPtr obj;\n\n    if (virSecretObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virSecretObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virSecretObjClass;",
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virSecretObjClass;\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretObjNew(void)\n{\n    virSecretObjPtr obj;\n\n    if (virSecretObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virSecretObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"a secret with UUID %s already defined for \"\n                             \"use with %s\")",
            "uuidstr",
            "newdef->usage_id"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"a secret with UUID %s already defined for \"\n                             \"use with %s\""
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "objdef->uuid",
            "uuidstr"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjListFindByUsageLocked",
          "args": [
            "secrets",
            "newdef->usage_type",
            "newdef->usage_id"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjListFindByUsageLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "234-247",
          "snippet": "static virSecretObjPtr\nvirSecretObjListFindByUsageLocked(virSecretObjListPtr secrets,\n                                  int usageType,\n                                  const char *usageID)\n{\n    virSecretObjPtr obj = NULL;\n    struct virSecretSearchData data = { .usageType = usageType,\n                                        .usageID = usageID };\n\n    obj = virHashSearch(secrets->objs, virSecretObjSearchName, &data, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretObjListFindByUsageLocked(virSecretObjListPtr secrets,\n                                  int usageType,\n                                  const char *usageID)\n{\n    virSecretObjPtr obj = NULL;\n    struct virSecretSearchData data = { .usageType = usageType,\n                                        .usageID = usageID };\n\n    obj = virHashSearch(secrets->objs, virSecretObjSearchName, &data, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretDefFree",
          "args": [
            "objdef"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_conf.c",
          "lines": "40-49",
          "snippet": "void\nvirSecretDefFree(virSecretDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->description);\n    VIR_FREE(def->usage_id);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virerror.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"secret_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virerror.h\"\n#include \"virsecretobj.h\"\n#include \"secret_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecretDefFree(virSecretDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->description);\n    VIR_FREE(def->usage_id);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"cannot change private flag on existing secret\")"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"a secret with UUID %s is already defined for \"\n                             \"use with %s\")",
            "uuidstr",
            "objdef->usage_id"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ_NULLABLE",
          "args": [
            "objdef->usage_id",
            "newdef->usage_id"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecretObjListFindByUUIDLocked",
          "args": [
            "secrets",
            "uuidstr"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjListFindByUUIDLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "165-170",
          "snippet": "static virSecretObjPtr\nvirSecretObjListFindByUUIDLocked(virSecretObjListPtr secrets,\n                                 const char *uuidstr)\n{\n    return virObjectRef(virHashLookup(secrets->objs, uuidstr));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic virSecretObjPtr\nvirSecretObjListFindByUUIDLocked(virSecretObjListPtr secrets,\n                                 const char *uuidstr)\n{\n    return virObjectRef(virHashLookup(secrets->objs, uuidstr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "secrets"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvirSecretObjPtr\nvirSecretObjListAdd(virSecretObjListPtr secrets,\n                    virSecretDefPtr newdef,\n                    const char *configDir,\n                    virSecretDefPtr *oldDef)\n{\n    virSecretObjPtr obj;\n    virSecretDefPtr objdef;\n    virSecretObjPtr ret = NULL;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    virObjectRWLockWrite(secrets);\n\n    if (oldDef)\n        *oldDef = NULL;\n\n    virUUIDFormat(newdef->uuid, uuidstr);\n\n    /* Is there a secret already matching this UUID */\n    if ((obj = virSecretObjListFindByUUIDLocked(secrets, uuidstr))) {\n        virObjectLock(obj);\n        objdef = obj->def;\n\n        if (STRNEQ_NULLABLE(objdef->usage_id, newdef->usage_id)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s is already defined for \"\n                             \"use with %s\"),\n                           uuidstr, objdef->usage_id);\n            goto cleanup;\n        }\n\n        if (objdef->isprivate && !newdef->isprivate) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"cannot change private flag on existing secret\"));\n            goto cleanup;\n        }\n\n        if (oldDef)\n            *oldDef = objdef;\n        else\n            virSecretDefFree(objdef);\n        obj->def = newdef;\n    } else {\n        /* No existing secret with same UUID,\n         * try look for matching usage instead */\n        if ((obj = virSecretObjListFindByUsageLocked(secrets,\n                                                     newdef->usage_type,\n                                                     newdef->usage_id))) {\n            virObjectLock(obj);\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"a secret with UUID %s already defined for \"\n                             \"use with %s\"),\n                           uuidstr, newdef->usage_id);\n            goto cleanup;\n        }\n\n        if (!(obj = virSecretObjNew()))\n            goto cleanup;\n\n        /* Generate the possible configFile and base64File strings\n         * using the configDir, uuidstr, and appropriate suffix\n         */\n        if (!(obj->configFile = virFileBuildPath(configDir, uuidstr, \".xml\")) ||\n            !(obj->base64File = virFileBuildPath(configDir, uuidstr, \".base64\")))\n            goto cleanup;\n\n        if (virHashAddEntry(secrets->objs, uuidstr, obj) < 0)\n            goto cleanup;\n\n        obj->def = newdef;\n        virObjectRef(obj);\n    }\n\n    ret = g_steal_pointer(&obj);\n\n cleanup:\n    virSecretObjEndAPI(&obj);\n    virObjectRWUnlock(secrets);\n    return ret;\n}"
  },
  {
    "function_name": "virSecretObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "286-307",
    "snippet": "void\nvirSecretObjListRemove(virSecretObjListPtr secrets,\n                       virSecretObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virSecretDefPtr def;\n\n    if (!obj)\n        return;\n    def = obj->def;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n\n    virObjectRWLockWrite(secrets);\n    virObjectLock(obj);\n    virHashRemoveEntry(secrets->objs, uuidstr);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(secrets);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secrets"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "obj"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "secrets->objs",
            "uuidstr"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockWrite",
          "args": [
            "secrets"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockWrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "482-491",
          "snippet": "void\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockWrite(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockWrite(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjListRemove(virSecretObjListPtr secrets,\n                       virSecretObjPtr obj)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virSecretDefPtr def;\n\n    if (!obj)\n        return;\n    def = obj->def;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    virObjectRef(obj);\n    virObjectUnlock(obj);\n\n    virObjectRWLockWrite(secrets);\n    virObjectLock(obj);\n    virHashRemoveEntry(secrets->objs, uuidstr);\n    virObjectUnlock(obj);\n    virObjectUnref(obj);\n    virObjectRWUnlock(secrets);\n}"
  },
  {
    "function_name": "virSecretObjListFindByUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "261-274",
    "snippet": "virSecretObjPtr\nvirSecretObjListFindByUsage(virSecretObjListPtr secrets,\n                            int usageType,\n                            const char *usageID)\n{\n    virSecretObjPtr obj;\n\n    virObjectRWLockRead(secrets);\n    obj = virSecretObjListFindByUsageLocked(secrets, usageType, usageID);\n    virObjectRWUnlock(secrets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secrets"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjListFindByUsageLocked",
          "args": [
            "secrets",
            "usageType",
            "usageID"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjListFindByUsageLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "234-247",
          "snippet": "static virSecretObjPtr\nvirSecretObjListFindByUsageLocked(virSecretObjListPtr secrets,\n                                  int usageType,\n                                  const char *usageID)\n{\n    virSecretObjPtr obj = NULL;\n    struct virSecretSearchData data = { .usageType = usageType,\n                                        .usageID = usageID };\n\n    obj = virHashSearch(secrets->objs, virSecretObjSearchName, &data, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virSecretObjDispose(void *obj);",
            "static void virSecretObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretObjListFindByUsageLocked(virSecretObjListPtr secrets,\n                                  int usageType,\n                                  const char *usageID)\n{\n    virSecretObjPtr obj = NULL;\n    struct virSecretSearchData data = { .usageType = usageType,\n                                        .usageID = usageID };\n\n    obj = virHashSearch(secrets->objs, virSecretObjSearchName, &data, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "secrets"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvirSecretObjPtr\nvirSecretObjListFindByUsage(virSecretObjListPtr secrets,\n                            int usageType,\n                            const char *usageID)\n{\n    virSecretObjPtr obj;\n\n    virObjectRWLockRead(secrets);\n    obj = virSecretObjListFindByUsageLocked(secrets, usageType, usageID);\n    virObjectRWUnlock(secrets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virSecretObjListFindByUsageLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "234-247",
    "snippet": "static virSecretObjPtr\nvirSecretObjListFindByUsageLocked(virSecretObjListPtr secrets,\n                                  int usageType,\n                                  const char *usageID)\n{\n    virSecretObjPtr obj = NULL;\n    struct virSecretSearchData data = { .usageType = usageType,\n                                        .usageID = usageID };\n\n    obj = virHashSearch(secrets->objs, virSecretObjSearchName, &data, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "obj"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSearch",
          "args": [
            "secrets->objs",
            "virSecretObjSearchName",
            "&data",
            "NULL"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "736-761",
          "snippet": "void *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *virHashSearch(const virHashTable *ctable,\n                    virHashSearcher iter,\n                    const void *data,\n                    void **name)\n{\n    size_t i;\n\n    /* Cast away const for internal detection of misuse.  */\n    virHashTablePtr table = (virHashTablePtr)ctable;\n\n    if (table == NULL || iter == NULL)\n        return NULL;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry;\n        for (entry = table->table[i]; entry; entry = entry->next) {\n            if (iter(entry->payload, entry->name, data)) {\n                if (name)\n                    *name = table->keyCopy(entry->name);\n                return entry->payload;\n            }\n        }\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretObjListFindByUsageLocked(virSecretObjListPtr secrets,\n                                  int usageType,\n                                  const char *usageID)\n{\n    virSecretObjPtr obj = NULL;\n    struct virSecretSearchData data = { .usageType = usageType,\n                                        .usageID = usageID };\n\n    obj = virHashSearch(secrets->objs, virSecretObjSearchName, &data, NULL);\n    if (obj)\n        virObjectRef(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virSecretObjSearchName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "198-221",
    "snippet": "static int\nvirSecretObjSearchName(const void *payload,\n                       const void *name G_GNUC_UNUSED,\n                       const void *opaque)\n{\n    virSecretObjPtr obj = (virSecretObjPtr) payload;\n    virSecretDefPtr def;\n    struct virSecretSearchData *data = (struct virSecretSearchData *) opaque;\n    int found = 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (def->usage_type != data->usageType)\n        goto cleanup;\n\n    if (data->usageType != VIR_SECRET_USAGE_TYPE_NONE &&\n        STREQ(def->usage_id, data->usageID))\n        found = 1;\n\n cleanup:\n    virObjectUnlock(obj);\n    return found;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "obj"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "def->usage_id",
            "data->usageID"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic int\nvirSecretObjSearchName(const void *payload,\n                       const void *name G_GNUC_UNUSED,\n                       const void *opaque)\n{\n    virSecretObjPtr obj = (virSecretObjPtr) payload;\n    virSecretDefPtr def;\n    struct virSecretSearchData *data = (struct virSecretSearchData *) opaque;\n    int found = 0;\n\n    virObjectLock(obj);\n    def = obj->def;\n\n    if (def->usage_type != data->usageType)\n        goto cleanup;\n\n    if (data->usageType != VIR_SECRET_USAGE_TYPE_NONE &&\n        STREQ(def->usage_id, data->usageID))\n        found = 1;\n\n cleanup:\n    virObjectUnlock(obj);\n    return found;\n}"
  },
  {
    "function_name": "virSecretObjListFindByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "183-195",
    "snippet": "virSecretObjPtr\nvirSecretObjListFindByUUID(virSecretObjListPtr secrets,\n                           const char *uuidstr)\n{\n    virSecretObjPtr obj;\n\n    virObjectRWLockRead(secrets);\n    obj = virSecretObjListFindByUUIDLocked(secrets, uuidstr);\n    virObjectRWUnlock(secrets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWUnlock",
          "args": [
            "secrets"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "520-529",
          "snippet": "void\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWUnlock(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjListFindByUUIDLocked",
          "args": [
            "secrets",
            "uuidstr"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretObjListFindByUUIDLocked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
          "lines": "165-170",
          "snippet": "static virSecretObjPtr\nvirSecretObjListFindByUUIDLocked(virSecretObjListPtr secrets,\n                                 const char *uuidstr)\n{\n    return virObjectRef(virHashLookup(secrets->objs, uuidstr));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic virSecretObjPtr\nvirSecretObjListFindByUUIDLocked(virSecretObjListPtr secrets,\n                                 const char *uuidstr)\n{\n    return virObjectRef(virHashLookup(secrets->objs, uuidstr));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockRead",
          "args": [
            "secrets"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "453-462",
          "snippet": "void\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectRWLockRead(void *anyobj)\n{\n    virObjectRWLockablePtr obj = virObjectGetRWLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virRWLockRead(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvirSecretObjPtr\nvirSecretObjListFindByUUID(virSecretObjListPtr secrets,\n                           const char *uuidstr)\n{\n    virSecretObjPtr obj;\n\n    virObjectRWLockRead(secrets);\n    obj = virSecretObjListFindByUUIDLocked(secrets, uuidstr);\n    virObjectRWUnlock(secrets);\n    if (obj)\n        virObjectLock(obj);\n    return obj;\n}"
  },
  {
    "function_name": "virSecretObjListFindByUUIDLocked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "165-170",
    "snippet": "static virSecretObjPtr\nvirSecretObjListFindByUUIDLocked(virSecretObjListPtr secrets,\n                                 const char *uuidstr)\n{\n    return virObjectRef(virHashLookup(secrets->objs, uuidstr));\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "virHashLookup(secrets->objs, uuidstr)"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "secrets->objs",
            "uuidstr"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic virSecretObjPtr\nvirSecretObjListFindByUUIDLocked(virSecretObjListPtr secrets,\n                                 const char *uuidstr)\n{\n    return virObjectRef(virHashLookup(secrets->objs, uuidstr));\n}"
  },
  {
    "function_name": "virSecretObjListDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "147-153",
    "snippet": "static void\nvirSecretObjListDispose(void *obj)\n{\n    virSecretObjListPtr secrets = obj;\n\n    virHashFree(secrets->objs);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "secrets->objs"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic void\nvirSecretObjListDispose(void *obj)\n{\n    virSecretObjListPtr secrets = obj;\n\n    virHashFree(secrets->objs);\n}"
  },
  {
    "function_name": "virSecretObjDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "131-144",
    "snippet": "static void\nvirSecretObjDispose(void *opaque)\n{\n    virSecretObjPtr obj = opaque;\n\n    virSecretDefFree(obj->def);\n    if (obj->value) {\n        /* Wipe before free to ensure we don't leave a secret on the heap */\n        memset(obj->value, 0, obj->value_size);\n        VIR_FREE(obj->value);\n    }\n    VIR_FREE(obj->configFile);\n    VIR_FREE(obj->base64File);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->base64File"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->configFile"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "obj->value"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "obj->value",
            "0",
            "obj->value_size"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSecretDefFree",
          "args": [
            "obj->def"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "virSecretDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_conf.c",
          "lines": "40-49",
          "snippet": "void\nvirSecretDefFree(virSecretDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->description);\n    VIR_FREE(def->usage_id);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virerror.h\"",
            "#include \"virsecretobj.h\"",
            "#include \"secret_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virerror.h\"\n#include \"virsecretobj.h\"\n#include \"secret_conf.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirSecretDefFree(virSecretDefPtr def)\n{\n    if (def == NULL)\n        return;\n\n    VIR_FREE(def->description);\n    VIR_FREE(def->usage_id);\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic void\nvirSecretObjDispose(void *opaque)\n{\n    virSecretObjPtr obj = opaque;\n\n    virSecretDefFree(obj->def);\n    if (obj->value) {\n        /* Wipe before free to ensure we don't leave a secret on the heap */\n        memset(obj->value, 0, obj->value_size);\n        VIR_FREE(obj->value);\n    }\n    VIR_FREE(obj->configFile);\n    VIR_FREE(obj->base64File);\n}"
  },
  {
    "function_name": "virSecretObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "111-128",
    "snippet": "virSecretObjListPtr\nvirSecretObjListNew(void)\n{\n    virSecretObjListPtr secrets;\n\n    if (virSecretObjInitialize() < 0)\n        return NULL;\n\n    if (!(secrets = virObjectRWLockableNew(virSecretObjListClass)))\n        return NULL;\n\n    if (!(secrets->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(secrets);\n        return NULL;\n    }\n\n    return secrets;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretObjListClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "secrets"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "virObjectFreeHashData"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRWLockableNew",
          "args": [
            "virSecretObjListClass"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRWLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "282-305",
          "snippet": "void *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectRWLockableNew(virClassPtr klass)\n{\n    virObjectRWLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectRWLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectRWLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virRWLockInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize RW lock\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjInitialize",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virSecretObjListClass;\n\nvirSecretObjListPtr\nvirSecretObjListNew(void)\n{\n    virSecretObjListPtr secrets;\n\n    if (virSecretObjInitialize() < 0)\n        return NULL;\n\n    if (!(secrets = virObjectRWLockableNew(virSecretObjListClass)))\n        return NULL;\n\n    if (!(secrets->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(secrets);\n        return NULL;\n    }\n\n    return secrets;\n}"
  },
  {
    "function_name": "virSecretObjEndAPI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "99-108",
    "snippet": "void\nvirSecretObjEndAPI(virSecretObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "*obj"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "*obj"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nvoid\nvirSecretObjEndAPI(virSecretObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
  },
  {
    "function_name": "virSecretObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "82-96",
    "snippet": "static virSecretObjPtr\nvirSecretObjNew(void)\n{\n    virSecretObjPtr obj;\n\n    if (virSecretObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virSecretObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretObjClass;",
      "static void virSecretObjDispose(void *obj);",
      "static void virSecretObjListDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "obj"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virSecretObjClass"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretObjInitialize",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic virClassPtr virSecretObjClass;\nstatic void virSecretObjDispose(void *obj);\nstatic void virSecretObjListDispose(void *obj);\n\nstatic virSecretObjPtr\nvirSecretObjNew(void)\n{\n    virSecretObjPtr obj;\n\n    if (virSecretObjInitialize() < 0)\n        return NULL;\n\n    if (!(obj = virObjectLockableNew(virSecretObjClass)))\n        return NULL;\n\n    virObjectLock(obj);\n\n    return obj;\n}"
  },
  {
    "function_name": "virSecretObjOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsecretobj.c",
    "lines": "67-77",
    "snippet": "static int\nvirSecretObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virSecretObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virSecretObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virsecretobj.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <fcntl.h>",
      "#include <dirent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virSecretObjList",
            "virClassForObjectRWLockable()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectRWLockable",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virSecretObj",
            "virClassForObjectLockable()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virsecretobj.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nstatic int\nvirSecretObjOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virSecretObj, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virSecretObjList, virClassForObjectRWLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]