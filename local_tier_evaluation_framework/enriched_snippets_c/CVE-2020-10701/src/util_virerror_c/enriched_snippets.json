[
  {
    "function_name": "virLastErrorPrefixMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1454-1476",
    "snippet": "void\nvirLastErrorPrefixMessage(const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr err = virGetLastError();\n    g_autofree char *fmtmsg = NULL;\n    g_autofree char *newmsg = NULL;\n    va_list args;\n\n    if (!err)\n        return;\n\n    va_start(args, fmt);\n    fmtmsg = g_strdup_vprintf(fmt, args);\n    va_end(args);\n\n    newmsg = g_strdup_printf(\"%s: %s\", fmtmsg, err->message);\n\n    VIR_FREE(err->message);\n    err->message = g_steal_pointer(&newmsg);\n\n    errno = save_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&newmsg"
          ],
          "line": 1473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err->message"
          ],
          "line": 1472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s: %s\"",
            "fmtmsg",
            "err->message"
          ],
          "line": 1470
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 1468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "fmt",
            "args"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 1466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastError",
          "args": [],
          "line": 1458
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLastErrorPrefixMessage(const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr err = virGetLastError();\n    g_autofree char *fmtmsg = NULL;\n    g_autofree char *newmsg = NULL;\n    va_list args;\n\n    if (!err)\n        return;\n\n    va_start(args, fmt);\n    fmtmsg = g_strdup_vprintf(fmt, args);\n    va_end(args);\n\n    newmsg = g_strdup_printf(\"%s: %s\", fmtmsg, err->message);\n\n    VIR_FREE(err->message);\n    err->message = g_steal_pointer(&newmsg);\n\n    errno = save_errno;\n}"
  },
  {
    "function_name": "virLastErrorIsSystemErrno",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1432-1442",
    "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetLastError",
          "args": [],
          "line": 1434
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
  },
  {
    "function_name": "virErrorSetErrnoFromLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1408-1418",
    "snippet": "void virErrorSetErrnoFromLastError(void)\n{\n    virErrorPtr err = virGetLastError();\n    if (err && err->code == VIR_ERR_SYSTEM_ERROR) {\n        errno = err->int1;\n    } else if (err && err->code == VIR_ERR_NO_MEMORY) {\n        errno = ENOMEM;\n    } else {\n        errno = EIO;\n    }\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetLastError",
          "args": [],
          "line": 1410
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virErrorSetErrnoFromLastError(void)\n{\n    virErrorPtr err = virGetLastError();\n    if (err && err->code == VIR_ERR_SYSTEM_ERROR) {\n        errno = err->int1;\n    } else if (err && err->code == VIR_ERR_NO_MEMORY) {\n        errno = ENOMEM;\n    } else {\n        errno = EIO;\n    }\n}"
  },
  {
    "function_name": "virSetErrorLogPriorityFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1391-1394",
    "snippet": "void virSetErrorLogPriorityFunc(virErrorLogPriorityFunc func)\n{\n    virErrorLogPriorityFilter = func;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;\n\nvoid virSetErrorLogPriorityFunc(virErrorLogPriorityFunc func)\n{\n    virErrorLogPriorityFilter = func;\n}"
  },
  {
    "function_name": "virReportOOMErrorFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1372-1383",
    "snippet": "void virReportOOMErrorFull(int domcode,\n                           const char *filename,\n                           const char *funcname,\n                           size_t linenr)\n{\n    const char *virerr;\n\n    virerr = virErrorMsg(VIR_ERR_NO_MEMORY, NULL);\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_NO_MEMORY, VIR_ERR_ERROR,\n                      virerr, NULL, NULL, -1, -1, virerr, NULL);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRaiseErrorFull",
          "args": [
            "filename",
            "funcname",
            "linenr",
            "domcode",
            "VIR_ERR_NO_MEMORY",
            "VIR_ERR_ERROR",
            "virerr",
            "NULL",
            "NULL",
            "-1",
            "-1",
            "virerr",
            "NULL"
          ],
          "line": 1380
        },
        "resolved": true,
        "details": {
          "function_name": "virRaiseErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "784-858",
          "snippet": "void\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorMsg",
          "args": [
            "VIR_ERR_NO_MEMORY",
            "NULL"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorMsg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1255-1265",
          "snippet": "const char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};\n\nconst char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportOOMErrorFull(int domcode,\n                           const char *filename,\n                           const char *funcname,\n                           size_t linenr)\n{\n    const char *virerr;\n\n    virerr = virErrorMsg(VIR_ERR_NO_MEMORY, NULL);\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_NO_MEMORY, VIR_ERR_ERROR,\n                      virerr, NULL, NULL, -1, -1, virerr, NULL);\n}"
  },
  {
    "function_name": "virReportSystemErrorFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1322-1360",
    "snippet": "void virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRaiseErrorFull",
          "args": [
            "filename",
            "funcname",
            "linenr",
            "domcode",
            "VIR_ERR_SYSTEM_ERROR",
            "VIR_ERR_ERROR",
            "msg",
            "msgDetail",
            "NULL",
            "theerrno",
            "-1",
            "msg",
            "msgDetail"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "virRaiseErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "784-858",
          "snippet": "void\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "msgDetailBuf + n",
            "errnoDetail"
          ],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "msgDetailBuf + n",
            "\": \""
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "errnoDetail"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_vsnprintf",
          "args": [
            "msgDetailBuf",
            "sizeof(msgDetailBuf)",
            "fmt",
            "args"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorMsg",
          "args": [
            "VIR_ERR_SYSTEM_ERROR",
            "fmt"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorMsg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1255-1265",
          "snippet": "const char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};\n\nconst char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "theerrno"
          ],
          "line": 1332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}"
  },
  {
    "function_name": "virReportErrorHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1282-1308",
    "snippet": "void virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRaiseErrorFull",
          "args": [
            "filename",
            "funcname",
            "linenr",
            "domcode",
            "errorcode",
            "VIR_ERR_ERROR",
            "virerr",
            "errorMessage",
            "NULL",
            "-1",
            "-1",
            "virerr",
            "errorMessage"
          ],
          "line": 1303
        },
        "resolved": true,
        "details": {
          "function_name": "virRaiseErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "784-858",
          "snippet": "void\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorMsg",
          "args": [
            "errorcode",
            "(errorMessage[0] ? errorMessage : NULL)"
          ],
          "line": 1302
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorMsg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1255-1265",
          "snippet": "const char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};\n\nconst char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_vsnprintf",
          "args": [
            "errorMessage",
            "sizeof(errorMessage)-1",
            "fmt",
            "args"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportErrorHelper(int domcode,\n                          int errorcode,\n                          const char *filename,\n                          const char *funcname,\n                          size_t linenr,\n                          const char *fmt, ...)\n{\n    int save_errno = errno;\n    va_list args;\n    char errorMessage[VIR_ERROR_MAX_LENGTH];\n    const char *virerr;\n\n    if (fmt) {\n        va_start(args, fmt);\n        g_vsnprintf(errorMessage, sizeof(errorMessage)-1, fmt, args);\n        va_end(args);\n    } else {\n        errorMessage[0] = '\\0';\n    }\n\n    virerr = virErrorMsg(errorcode, (errorMessage[0] ? errorMessage : NULL));\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, errorcode, VIR_ERR_ERROR,\n                      virerr, errorMessage, NULL,\n                      -1, -1, virerr, errorMessage);\n    errno = save_errno;\n}"
  },
  {
    "function_name": "virErrorMsg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "1255-1265",
    "snippet": "const char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_",
          "args": [
            "virErrorMsgStrings[error].msg"
          ],
          "line": 1264
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic const virErrorMsgTuple virErrorMsgStrings[] = {\n    [VIR_ERR_OK] = { NULL, NULL },\n    [VIR_ERR_INTERNAL_ERROR] = {\n        N_(\"internal error\"),\n        N_(\"internal error: %s\") },\n    [VIR_ERR_NO_MEMORY] = {\n        N_(\"out of memory\"),\n        N_(\"out of memory: %s\") },\n    [VIR_ERR_NO_SUPPORT] = {\n        N_(\"this function is not supported by the connection driver\"),\n        N_(\"this function is not supported by the connection driver: %s\") },\n    [VIR_ERR_UNKNOWN_HOST] = {\n        N_(\"unknown host\"),\n        N_(\"unknown host %s\") },\n    [VIR_ERR_NO_CONNECT] = {\n        N_(\"no connection driver available\"),\n        N_(\"no connection driver available for %s\") },\n    [VIR_ERR_INVALID_CONN] = {\n        N_(\"invalid connection pointer in\"),\n        N_(\"invalid connection pointer in %s\") },\n    [VIR_ERR_INVALID_DOMAIN] = {\n        N_(\"invalid domain pointer in\"),\n        N_(\"invalid domain pointer in %s\") },\n    [VIR_ERR_INVALID_ARG] = {\n        N_(\"invalid argument\"),\n        N_(\"invalid argument: %s\") },\n    [VIR_ERR_OPERATION_FAILED] = {\n        N_(\"operation failed\"),\n        N_(\"operation failed: %s\") },\n    [VIR_ERR_GET_FAILED] = {\n        N_(\"GET operation failed\"),\n        N_(\"GET operation failed: %s\") },\n    [VIR_ERR_POST_FAILED] = {\n        N_(\"POST operation failed\"),\n        N_(\"POST operation failed: %s\") },\n    [VIR_ERR_HTTP_ERROR] = {\n        N_(\"got unknown HTTP error code\"),\n        N_(\"got unknown HTTP error code %s\") },\n    [VIR_ERR_SEXPR_SERIAL] = {\n        N_(\"failed to serialize S-Expr\"),\n        N_(\"failed to serialize S-Expr: %s\") },\n    [VIR_ERR_NO_XEN] = {\n        N_(\"could not use Xen hypervisor entry\"),\n        N_(\"could not use Xen hypervisor entry %s\") },\n    [VIR_ERR_XEN_CALL] = {\n        N_(\"failed Xen syscall\"),\n        N_(\"failed Xen syscall %s\") },\n    [VIR_ERR_OS_TYPE] = {\n        N_(\"unknown OS type\"),\n        N_(\"unknown OS type %s\") },\n    [VIR_ERR_NO_KERNEL] = {\n        N_(\"missing kernel information\"),\n        N_(\"missing kernel information: %s\") },\n    [VIR_ERR_NO_ROOT] = {\n        N_(\"missing root device information\"),\n        N_(\"missing root device information in %s\") },\n    [VIR_ERR_NO_SOURCE] = {\n        N_(\"missing source information for device\"),\n        N_(\"missing source information for device %s\") },\n    [VIR_ERR_NO_TARGET] = {\n        N_(\"missing target information for device\"),\n        N_(\"missing target information for device %s\") },\n    [VIR_ERR_NO_NAME] = {\n        N_(\"missing name information\"),\n        N_(\"missing name information in %s\") },\n    [VIR_ERR_NO_OS] = {\n        N_(\"missing operating system information\"),\n        N_(\"missing operating system information for %s\") },\n    [VIR_ERR_NO_DEVICE] = {\n        N_(\"missing devices information\"),\n        N_(\"missing devices information for %s\") },\n    [VIR_ERR_NO_XENSTORE] = {\n        N_(\"could not connect to Xen Store\"),\n        N_(\"could not connect to Xen Store %s\") },\n    [VIR_ERR_DRIVER_FULL] = {\n        N_(\"too many drivers registered\"),\n        N_(\"too many drivers registered in %s\") },\n    [VIR_ERR_CALL_FAILED] = {\n        N_(\"library call failed\"),\n        N_(\"library call failed: %s\") },\n    [VIR_ERR_XML_ERROR] = {\n        N_(\"XML description is invalid or not well formed\"),\n        N_(\"XML error: %s\") },\n    [VIR_ERR_DOM_EXIST] = {\n        N_(\"this domain exists already\"),\n        N_(\"domain %s exists already\") },\n    [VIR_ERR_OPERATION_DENIED] = {\n        N_(\"operation forbidden for read only access\"),\n        N_(\"operation forbidden: %s\") },\n    [VIR_ERR_OPEN_FAILED] = {\n        N_(\"failed to open configuration file\"),\n        N_(\"failed to open configuration file %s\") },\n    [VIR_ERR_READ_FAILED] = {\n        N_(\"failed to read configuration file\"),\n        N_(\"failed to read configuration file %s\") },\n    [VIR_ERR_PARSE_FAILED] = {\n        N_(\"failed to parse configuration file\"),\n        N_(\"failed to parse configuration file %s\") },\n    [VIR_ERR_CONF_SYNTAX] = {\n        N_(\"configuration file syntax error\"),\n        N_(\"configuration file syntax error: %s\") },\n    [VIR_ERR_WRITE_FAILED] = {\n        N_(\"failed to write configuration file\"),\n        N_(\"failed to write configuration file: %s\") },\n    [VIR_ERR_XML_DETAIL] = {\n        N_(\"parser error\"),\n        \"%s\" },\n    [VIR_ERR_INVALID_NETWORK] = {\n        N_(\"invalid network pointer in\"),\n        N_(\"invalid network pointer in %s\") },\n    [VIR_ERR_NETWORK_EXIST] = {\n        N_(\"this network exists already\"),\n        N_(\"network %s exists already\") },\n    [VIR_ERR_SYSTEM_ERROR] = {\n        N_(\"system call error\"),\n        \"%s\" },\n    [VIR_ERR_RPC] = {\n        N_(\"RPC error\"),\n        \"%s\" },\n    [VIR_ERR_GNUTLS_ERROR] = {\n        N_(\"GNUTLS call error\"),\n        \"%s\" },\n    [VIR_WAR_NO_NETWORK] = {\n        N_(\"Failed to find the network\"),\n        N_(\"Failed to find the network: %s\") },\n    [VIR_ERR_NO_DOMAIN] = {\n        N_(\"Domain not found\"),\n        N_(\"Domain not found: %s\") },\n    [VIR_ERR_NO_NETWORK] = {\n        N_(\"Network not found\"),\n        N_(\"Network not found: %s\") },\n    [VIR_ERR_INVALID_MAC] = {\n        N_(\"invalid MAC address\"),\n        N_(\"invalid MAC address: %s\") },\n    [VIR_ERR_AUTH_FAILED] = {\n        N_(\"authentication failed\"),\n        N_(\"authentication failed: %s\") },\n    [VIR_ERR_INVALID_STORAGE_POOL] = {\n        N_(\"invalid storage pool pointer in\"),\n        N_(\"invalid storage pool pointer in %s\") },\n    [VIR_ERR_INVALID_STORAGE_VOL] = {\n        N_(\"invalid storage volume pointer in\"),\n        N_(\"invalid storage volume pointer in %s\") },\n    [VIR_WAR_NO_STORAGE] = {\n        N_(\"Failed to find a storage driver\"),\n        N_(\"Failed to find a storage driver: %s\") },\n    [VIR_ERR_NO_STORAGE_POOL] = {\n        N_(\"Storage pool not found\"),\n        N_(\"Storage pool not found: %s\") },\n    [VIR_ERR_NO_STORAGE_VOL] = {\n        N_(\"Storage volume not found\"),\n        N_(\"Storage volume not found: %s\") },\n    [VIR_WAR_NO_NODE] = {\n        N_(\"Failed to find a node driver\"),\n        N_(\"Failed to find a node driver: %s\") },\n    [VIR_ERR_INVALID_NODE_DEVICE] = {\n        N_(\"invalid node device pointer\"),\n        N_(\"invalid node device pointer in %s\") },\n    [VIR_ERR_NO_NODE_DEVICE] = {\n        N_(\"Node device not found\"),\n        N_(\"Node device not found: %s\") },\n    [VIR_ERR_NO_SECURITY_MODEL] = {\n        N_(\"Security model not found\"),\n        N_(\"Security model not found: %s\") },\n    [VIR_ERR_OPERATION_INVALID] = {\n        N_(\"Requested operation is not valid\"),\n        N_(\"Requested operation is not valid: %s\") },\n    [VIR_WAR_NO_INTERFACE] = {\n        N_(\"Failed to find the interface\"),\n        N_(\"Failed to find the interface: %s\") },\n    [VIR_ERR_NO_INTERFACE] = {\n        N_(\"Interface not found\"),\n        N_(\"Interface not found: %s\") },\n    [VIR_ERR_INVALID_INTERFACE] = {\n        N_(\"invalid interface pointer in\"),\n        N_(\"invalid interface pointer in %s\") },\n    [VIR_ERR_MULTIPLE_INTERFACES] = {\n        N_(\"multiple matching interfaces found\"),\n        N_(\"multiple matching interfaces found: %s\") },\n    [VIR_WAR_NO_NWFILTER] = {\n        N_(\"Failed to start the nwfilter driver\"),\n        N_(\"Failed to start the nwfilter driver: %s\") },\n    [VIR_ERR_INVALID_NWFILTER] = {\n        N_(\"Invalid network filter\"),\n        N_(\"Invalid network filter: %s\") },\n    [VIR_ERR_NO_NWFILTER] = {\n        N_(\"Network filter not found\"),\n        N_(\"Network filter not found: %s\") },\n    [VIR_ERR_BUILD_FIREWALL] = {\n        N_(\"Error while building firewall\"),\n        N_(\"Error while building firewall: %s\") },\n    [VIR_WAR_NO_SECRET] = {\n        N_(\"Failed to find a secret storage driver\"),\n        N_(\"Failed to find a secret storage driver: %s\") },\n    [VIR_ERR_INVALID_SECRET] = {\n        N_(\"Invalid secret\"),\n        N_(\"Invalid secret: %s\") },\n    [VIR_ERR_NO_SECRET] = {\n        N_(\"Secret not found\"),\n        N_(\"Secret not found: %s\") },\n    [VIR_ERR_CONFIG_UNSUPPORTED] = {\n        N_(\"unsupported configuration\"),\n        N_(\"unsupported configuration: %s\") },\n    [VIR_ERR_OPERATION_TIMEOUT] = {\n        N_(\"Timed out during operation\"),\n        N_(\"Timed out during operation: %s\") },\n    [VIR_ERR_MIGRATE_PERSIST_FAILED] = {\n        N_(\"Failed to make domain persistent after migration\"),\n        N_(\"Failed to make domain persistent after migration: %s\") },\n    [VIR_ERR_HOOK_SCRIPT_FAILED] = {\n        N_(\"Hook script execution failed\"),\n        N_(\"Hook script execution failed: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_SNAPSHOT] = {\n        N_(\"Invalid domain snapshot\"),\n        N_(\"Invalid domain snapshot: %s\") },\n    [VIR_ERR_NO_DOMAIN_SNAPSHOT] = {\n        N_(\"Domain snapshot not found\"),\n        N_(\"Domain snapshot not found: %s\") },\n    [VIR_ERR_INVALID_STREAM] = {\n        N_(\"invalid stream pointer\"),\n        N_(\"invalid stream pointer in %s\") },\n    [VIR_ERR_ARGUMENT_UNSUPPORTED] = {\n        N_(\"argument unsupported\"),\n        N_(\"argument unsupported: %s\") },\n    [VIR_ERR_STORAGE_PROBE_FAILED] = {\n        N_(\"Storage pool probe failed\"),\n        N_(\"Storage pool probe failed: %s\") },\n    [VIR_ERR_STORAGE_POOL_BUILT] = {\n        N_(\"Storage pool already built\"),\n        N_(\"Storage pool already built: %s\") },\n    [VIR_ERR_SNAPSHOT_REVERT_RISKY] = {\n        N_(\"revert requires force\"),\n        N_(\"revert requires force: %s\") },\n    [VIR_ERR_OPERATION_ABORTED] = {\n        N_(\"operation aborted\"),\n        N_(\"operation aborted: %s\") },\n    [VIR_ERR_AUTH_CANCELLED] = {\n        N_(\"authentication cancelled\"),\n        N_(\"authentication cancelled: %s\") },\n    [VIR_ERR_NO_DOMAIN_METADATA] = {\n        N_(\"metadata not found\"),\n        N_(\"metadata not found: %s\") },\n    [VIR_ERR_MIGRATE_UNSAFE] = {\n        N_(\"Unsafe migration\"),\n        N_(\"Unsafe migration: %s\") },\n    [VIR_ERR_OVERFLOW] = {\n        N_(\"numerical overflow\"),\n        N_(\"numerical overflow: %s\") },\n    [VIR_ERR_BLOCK_COPY_ACTIVE] = {\n        N_(\"block copy still active\"),\n        N_(\"block copy still active: %s\") },\n    [VIR_ERR_OPERATION_UNSUPPORTED] = {\n        N_(\"Operation not supported\"),\n        N_(\"Operation not supported: %s\") },\n    [VIR_ERR_SSH] = {\n        N_(\"SSH transport error\"),\n        N_(\"SSH transport error: %s\") },\n    [VIR_ERR_AGENT_UNRESPONSIVE] = {\n        N_(\"Guest agent is not responding\"),\n        N_(\"Guest agent is not responding: %s\") },\n    [VIR_ERR_RESOURCE_BUSY] = {\n        N_(\"resource busy\"),\n        N_(\"resource busy: %s\") },\n    [VIR_ERR_ACCESS_DENIED] = {\n        N_(\"access denied\"),\n        N_(\"access denied: %s\") },\n    [VIR_ERR_DBUS_SERVICE] = {\n        N_(\"error from service\"),\n        N_(\"error from service: %s\") },\n    [VIR_ERR_STORAGE_VOL_EXIST] = {\n        N_(\"this storage volume exists already\"),\n        N_(\"storage volume %s exists already\") },\n    [VIR_ERR_CPU_INCOMPATIBLE] = {\n        N_(\"the CPU is incompatible with host CPU\"),\n        N_(\"the CPU is incompatible with host CPU: %s\") },\n    [VIR_ERR_XML_INVALID_SCHEMA] = {\n        N_(\"XML document failed to validate against schema\"),\n        N_(\"XML document failed to validate against schema: %s\") },\n    [VIR_ERR_MIGRATE_FINISH_OK] = {\n        N_(\"migration successfully aborted\"),\n        N_(\"migration successfully aborted: %s\") },\n    [VIR_ERR_AUTH_UNAVAILABLE] = {\n        N_(\"authentication unavailable\"),\n        N_(\"authentication unavailable: %s\") },\n    [VIR_ERR_NO_SERVER] = {\n        N_(\"Server not found\"),\n        N_(\"Server not found: %s\") },\n    [VIR_ERR_NO_CLIENT] = {\n        N_(\"Client not found\"),\n        N_(\"Client not found: %s\") },\n    [VIR_ERR_AGENT_UNSYNCED] = {\n        N_(\"guest agent replied with wrong id to guest-sync command\"),\n        N_(\"guest agent replied with wrong id to guest-sync command: %s\") },\n    [VIR_ERR_LIBSSH] = {\n        N_(\"libssh transport error\"),\n        N_(\"libssh transport error: %s\") },\n    [VIR_ERR_DEVICE_MISSING] = {\n        N_(\"device not found\"),\n        N_(\"device not found: %s\") },\n    [VIR_ERR_INVALID_NWFILTER_BINDING] = {\n        N_(\"Invalid network filter binding\"),\n        N_(\"Invalid network filter binding: %s\") },\n    [VIR_ERR_NO_NWFILTER_BINDING] = {\n        N_(\"Network filter binding not found\"),\n        N_(\"Network filter binding not found: %s\") },\n    [VIR_ERR_INVALID_DOMAIN_CHECKPOINT] = {\n        N_(\"Invalid domain checkpoint\"),\n        N_(\"Invalid domain checkpoint: %s\") },\n    [VIR_ERR_NO_DOMAIN_CHECKPOINT] = {\n        N_(\"Domain checkpoint not found\"),\n        N_(\"Domain checkpoint not found: %s\") },\n    [VIR_ERR_NO_DOMAIN_BACKUP] = {\n        N_(\"Domain backup job id not found\"),\n        N_(\"Domain backup job id not found: %s\") },\n    [VIR_ERR_INVALID_NETWORK_PORT] = {\n        N_(\"Invalid network port pointer\"),\n        N_(\"Invalid network port pointer: %s\") },\n    [VIR_ERR_NETWORK_PORT_EXIST] = {\n        N_(\"this network port exists already\"),\n        N_(\"network port %s exists already\") },\n    [VIR_ERR_NO_NETWORK_PORT] = {\n        N_(\"network port not found\"),\n        N_(\"network port not found: %s\") },\n    [VIR_ERR_NO_HOSTNAME] = {\n        N_(\"no hostname found\"),\n        N_(\"no hostname found: %s\") },\n};\n\nconst char *\nvirErrorMsg(virErrorNumber error, const char *info)\n{\n    if (error >= VIR_ERR_NUMBER_LAST)\n        return NULL;\n\n    if (info)\n        return _(virErrorMsgStrings[error].msginfo);\n    else\n        return _(virErrorMsgStrings[error].msg);\n}"
  },
  {
    "function_name": "virRaiseErrorObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "880-903",
    "snippet": "void virRaiseErrorObject(const char *filename,\n                         const char *funcname,\n                         size_t linenr,\n                         virErrorPtr newerr)\n{\n    int saved_errno = errno;\n    virErrorPtr err;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = newerr->domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = newerr->code },\n        { .key = NULL },\n    };\n\n    err = virLastErrorObject();\n    if (!err)\n        goto cleanup;\n\n    virResetError(err);\n    virCopyError(newerr, err);\n    virRaiseErrorLog(filename, funcname, linenr,\n                     err, meta);\n cleanup:\n    errno = saved_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRaiseErrorLog",
          "args": [
            "filename",
            "funcname",
            "linenr",
            "err",
            "meta"
          ],
          "line": 899
        },
        "resolved": true,
        "details": {
          "function_name": "virRaiseErrorLog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "734-763",
          "snippet": "static\nvoid virRaiseErrorLog(const char *filename,\n                      const char *funcname,\n                      size_t linenr,\n                      virErrorPtr err,\n                      virLogMetadata *meta)\n{\n    int priority;\n\n    /*\n     * Hook up the error or warning to the logging facility\n     */\n    priority = virErrorLevelPriority(err->level);\n    if (virErrorLogPriorityFilter)\n        priority = virErrorLogPriorityFilter(err, priority);\n\n    /* We don't want to pollute stderr if no logging outputs\n     * are explicitly requested by the user, since the default\n     * error function already pollutes stderr and most apps\n     * hate & thus disable that too. If the daemon has set\n     * a priority filter though, we should always forward\n     * all errors to the logging code.\n     */\n    if (virLogGetNbOutputs() > 0 ||\n        virErrorLogPriorityFilter)\n        virLogMessage(&virLogSelf,\n                      priority,\n                      filename, linenr, funcname,\n                      meta, \"%s\", err->message);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;\n\nstatic\nvoid virRaiseErrorLog(const char *filename,\n                      const char *funcname,\n                      size_t linenr,\n                      virErrorPtr err,\n                      virLogMetadata *meta)\n{\n    int priority;\n\n    /*\n     * Hook up the error or warning to the logging facility\n     */\n    priority = virErrorLevelPriority(err->level);\n    if (virErrorLogPriorityFilter)\n        priority = virErrorLogPriorityFilter(err, priority);\n\n    /* We don't want to pollute stderr if no logging outputs\n     * are explicitly requested by the user, since the default\n     * error function already pollutes stderr and most apps\n     * hate & thus disable that too. If the daemon has set\n     * a priority filter though, we should always forward\n     * all errors to the logging code.\n     */\n    if (virLogGetNbOutputs() > 0 ||\n        virErrorLogPriorityFilter)\n        virLogMessage(&virLogSelf,\n                      priority,\n                      filename, linenr, funcname,\n                      meta, \"%s\", err->message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCopyError",
          "args": [
            "newerr",
            "err"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "197-220",
          "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "err"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virRaiseErrorObject(const char *filename,\n                         const char *funcname,\n                         size_t linenr,\n                         virErrorPtr newerr)\n{\n    int saved_errno = errno;\n    virErrorPtr err;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = newerr->domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = newerr->code },\n        { .key = NULL },\n    };\n\n    err = virLastErrorObject();\n    if (!err)\n        goto cleanup;\n\n    virResetError(err);\n    virCopyError(newerr, err);\n    virRaiseErrorLog(filename, funcname, linenr,\n                     err, meta);\n cleanup:\n    errno = saved_errno;\n}"
  },
  {
    "function_name": "virRaiseErrorFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "784-858",
    "snippet": "void\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRaiseErrorLog",
          "args": [
            "filename",
            "funcname",
            "linenr",
            "to",
            "meta"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "virRaiseErrorLog",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "734-763",
          "snippet": "static\nvoid virRaiseErrorLog(const char *filename,\n                      const char *funcname,\n                      size_t linenr,\n                      virErrorPtr err,\n                      virLogMetadata *meta)\n{\n    int priority;\n\n    /*\n     * Hook up the error or warning to the logging facility\n     */\n    priority = virErrorLevelPriority(err->level);\n    if (virErrorLogPriorityFilter)\n        priority = virErrorLogPriorityFilter(err, priority);\n\n    /* We don't want to pollute stderr if no logging outputs\n     * are explicitly requested by the user, since the default\n     * error function already pollutes stderr and most apps\n     * hate & thus disable that too. If the daemon has set\n     * a priority filter though, we should always forward\n     * all errors to the logging code.\n     */\n    if (virLogGetNbOutputs() > 0 ||\n        virErrorLogPriorityFilter)\n        virLogMessage(&virLogSelf,\n                      priority,\n                      filename, linenr, funcname,\n                      meta, \"%s\", err->message);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;\n\nstatic\nvoid virRaiseErrorLog(const char *filename,\n                      const char *funcname,\n                      size_t linenr,\n                      virErrorPtr err,\n                      virLogMetadata *meta)\n{\n    int priority;\n\n    /*\n     * Hook up the error or warning to the logging facility\n     */\n    priority = virErrorLevelPriority(err->level);\n    if (virErrorLogPriorityFilter)\n        priority = virErrorLogPriorityFilter(err, priority);\n\n    /* We don't want to pollute stderr if no logging outputs\n     * are explicitly requested by the user, since the default\n     * error function already pollutes stderr and most apps\n     * hate & thus disable that too. If the daemon has set\n     * a priority filter though, we should always forward\n     * all errors to the logging code.\n     */\n    if (virLogGetNbOutputs() > 0 ||\n        virErrorLogPriorityFilter)\n        virLogMessage(&virLogSelf,\n                      priority,\n                      filename, linenr, funcname,\n                      meta, \"%s\", err->message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "str3"
          ],
          "line": 850
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "fmt",
            "ap"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "to"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirRaiseErrorFull(const char *filename,\n                  const char *funcname,\n                  size_t linenr,\n                  int domain,\n                  int code,\n                  virErrorLevel level,\n                  const char *str1,\n                  const char *str2,\n                  const char *str3,\n                  int int1,\n                  int int2,\n                  const char *fmt, ...)\n{\n    int save_errno = errno;\n    virErrorPtr to;\n    char *str;\n    virLogMetadata meta[] = {\n        { .key = \"LIBVIRT_DOMAIN\", .s = NULL, .iv = domain },\n        { .key = \"LIBVIRT_CODE\", .s = NULL, .iv = code },\n        { .key = NULL },\n    };\n\n    /*\n     * All errors are recorded in thread local storage\n     * For compatibility, public API calls will copy them\n     * to the per-connection error object when necessary\n     */\n    to = virLastErrorObject();\n    if (!to) {\n        errno = save_errno;\n        return; /* Hit OOM allocating thread error object, sod all we can do now */\n    }\n\n    virResetError(to);\n\n    if (code == VIR_ERR_OK) {\n        errno = save_errno;\n        return;\n    }\n\n    /*\n     * formats the message; drop message on OOM situations\n     */\n    if (fmt == NULL) {\n        str = g_strdup(_(\"No error message provided\"));\n    } else {\n        va_list ap;\n        va_start(ap, fmt);\n        str = g_strdup_vprintf(fmt, ap);\n        va_end(ap);\n    }\n\n    /*\n     * Save the information about the error\n     */\n    /*\n     * Deliberately not setting conn, dom & net fields since\n     * they're utterly unsafe\n     */\n    to->domain = domain;\n    to->code = code;\n    to->message = str;\n    to->level = level;\n    to->str1 = g_strdup(str1);\n    to->str2 = g_strdup(str2);\n    to->str3 = g_strdup(str3);\n    to->int1 = int1;\n    to->int2 = int2;\n\n    virRaiseErrorLog(filename, funcname, linenr,\n                     to, meta);\n\n    errno = save_errno;\n}"
  },
  {
    "function_name": "virRaiseErrorLog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "734-763",
    "snippet": "static\nvoid virRaiseErrorLog(const char *filename,\n                      const char *funcname,\n                      size_t linenr,\n                      virErrorPtr err,\n                      virLogMetadata *meta)\n{\n    int priority;\n\n    /*\n     * Hook up the error or warning to the logging facility\n     */\n    priority = virErrorLevelPriority(err->level);\n    if (virErrorLogPriorityFilter)\n        priority = virErrorLogPriorityFilter(err, priority);\n\n    /* We don't want to pollute stderr if no logging outputs\n     * are explicitly requested by the user, since the default\n     * error function already pollutes stderr and most apps\n     * hate & thus disable that too. If the daemon has set\n     * a priority filter though, we should always forward\n     * all errors to the logging code.\n     */\n    if (virLogGetNbOutputs() > 0 ||\n        virErrorLogPriorityFilter)\n        virLogMessage(&virLogSelf,\n                      priority,\n                      filename, linenr, funcname,\n                      meta, \"%s\", err->message);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLogMessage",
          "args": [
            "&virLogSelf",
            "priority",
            "filename",
            "linenr",
            "funcname",
            "meta",
            "\"%s\"",
            "err->message"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "virLogMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "502-517",
          "snippet": "void\nvirLogMessage(virLogSourcePtr source,\n              virLogPriority priority,\n              const char *filename,\n              int linenr,\n              const char *funcname,\n              virLogMetadataPtr metadata,\n              const char *fmt, ...)\n{\n    va_list ap;\n    va_start(ap, fmt);\n    virLogVMessage(source, priority,\n                   filename, linenr, funcname,\n                   metadata, fmt, ap);\n    va_end(ap);\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirLogMessage(virLogSourcePtr source,\n              virLogPriority priority,\n              const char *filename,\n              int linenr,\n              const char *funcname,\n              virLogMetadataPtr metadata,\n              const char *fmt, ...)\n{\n    va_list ap;\n    va_start(ap, fmt);\n    virLogVMessage(source, priority,\n                   filename, linenr, funcname,\n                   metadata, fmt, ap);\n    va_end(ap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLogGetNbOutputs",
          "args": [],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virLogGetNbOutputs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virlog.c",
          "lines": "1163-1167",
          "snippet": "int\nvirLogGetNbOutputs(void)\n{\n    return virLogNbOutputs;\n}",
          "includes": [
            "# include <sys/uio.h>",
            "#include \"virsocket.h\"",
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <syslog.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static size_t virLogNbOutputs;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <sys/uio.h>\n#include \"virsocket.h\"\n#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <syslog.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/time.h>\n#include <time.h>\n#include <stdarg.h>\n#include <config.h>\n\nstatic size_t virLogNbOutputs;\n\nint\nvirLogGetNbOutputs(void)\n{\n    return virLogNbOutputs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorLogPriorityFilter",
          "args": [
            "err",
            "priority"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorLevelPriority",
          "args": [
            "err->level"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorLevelPriority",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "44-55",
          "snippet": "static virLogPriority virErrorLevelPriority(virErrorLevel level)\n{\n    switch (level) {\n        case VIR_ERR_NONE:\n            return VIR_LOG_INFO;\n        case VIR_ERR_WARNING:\n            return VIR_LOG_WARN;\n        case VIR_ERR_ERROR:\n            return VIR_LOG_ERROR;\n    }\n    return VIR_LOG_ERROR;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogPriority virErrorLevelPriority(virErrorLevel level)\n{\n    switch (level) {\n        case VIR_ERR_NONE:\n            return VIR_LOG_INFO;\n        case VIR_ERR_WARNING:\n            return VIR_LOG_WARN;\n        case VIR_ERR_ERROR:\n            return VIR_LOG_ERROR;\n    }\n    return VIR_LOG_ERROR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;\n\nstatic\nvoid virRaiseErrorLog(const char *filename,\n                      const char *funcname,\n                      size_t linenr,\n                      virErrorPtr err,\n                      virLogMetadata *meta)\n{\n    int priority;\n\n    /*\n     * Hook up the error or warning to the logging facility\n     */\n    priority = virErrorLevelPriority(err->level);\n    if (virErrorLogPriorityFilter)\n        priority = virErrorLogPriorityFilter(err, priority);\n\n    /* We don't want to pollute stderr if no logging outputs\n     * are explicitly requested by the user, since the default\n     * error function already pollutes stderr and most apps\n     * hate & thus disable that too. If the daemon has set\n     * a priority filter though, we should always forward\n     * all errors to the logging code.\n     */\n    if (virLogGetNbOutputs() > 0 ||\n        virErrorLogPriorityFilter)\n        virLogMessage(&virLogSelf,\n                      priority,\n                      filename, linenr, funcname,\n                      meta, \"%s\", err->message);\n}"
  },
  {
    "function_name": "virDispatchError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "695-728",
    "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virErrorFunc virErrorHandler = NULL;",
      "void *virUserData = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDefaultErrorFunc",
          "args": [
            "err"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "virDefaultErrorFunc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "644-682",
          "snippet": "void\nvirDefaultErrorFunc(virErrorPtr err)\n{\n    const char *lvl = \"\", *dom = \"\", *domain = \"\", *network = \"\";\n    int len;\n\n    if ((err == NULL) || (err->code == VIR_ERR_OK))\n        return;\n    switch (err->level) {\n        case VIR_ERR_NONE:\n            lvl = \"\";\n            break;\n        case VIR_ERR_WARNING:\n            lvl = _(\"warning\");\n            break;\n        case VIR_ERR_ERROR:\n            lvl = _(\"error\");\n            break;\n    }\n    dom = virErrorDomainTypeToString(err->domain);\n    if (!dom)\n        dom = \"Unknown\";\n    if ((err->dom != NULL) && (err->code != VIR_ERR_INVALID_DOMAIN)) {\n        domain = err->dom->name;\n    } else if ((err->net != NULL) && (err->code != VIR_ERR_INVALID_NETWORK)) {\n        network = err->net->name;\n    }\n    len = strlen(err->message);\n    if ((err->domain == VIR_FROM_XML) && (err->code == VIR_ERR_XML_DETAIL) &&\n        (err->int1 != 0))\n        fprintf(stderr, \"libvirt: %s %s %s%s: line %d: %s\",\n                dom, lvl, domain, network, err->int1, err->message);\n    else if ((len == 0) || (err->message[len - 1] != '\\n'))\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\\n\",\n                dom, lvl, domain, network, err->message);\n    else\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\",\n                dom, lvl, domain, network, err->message);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirDefaultErrorFunc(virErrorPtr err)\n{\n    const char *lvl = \"\", *dom = \"\", *domain = \"\", *network = \"\";\n    int len;\n\n    if ((err == NULL) || (err->code == VIR_ERR_OK))\n        return;\n    switch (err->level) {\n        case VIR_ERR_NONE:\n            lvl = \"\";\n            break;\n        case VIR_ERR_WARNING:\n            lvl = _(\"warning\");\n            break;\n        case VIR_ERR_ERROR:\n            lvl = _(\"error\");\n            break;\n    }\n    dom = virErrorDomainTypeToString(err->domain);\n    if (!dom)\n        dom = \"Unknown\";\n    if ((err->dom != NULL) && (err->code != VIR_ERR_INVALID_DOMAIN)) {\n        domain = err->dom->name;\n    } else if ((err->net != NULL) && (err->code != VIR_ERR_INVALID_NETWORK)) {\n        network = err->net->name;\n    }\n    len = strlen(err->message);\n    if ((err->domain == VIR_FROM_XML) && (err->code == VIR_ERR_XML_DETAIL) &&\n        (err->int1 != 0))\n        fprintf(stderr, \"libvirt: %s %s %s%s: line %d: %s\",\n                dom, lvl, domain, network, err->int1, err->message);\n    else if ((len == 0) || (err->message[len - 1] != '\\n'))\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\\n\",\n                dom, lvl, domain, network, err->message);\n    else\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\",\n                dom, lvl, domain, network, err->message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "userData",
            "err"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "conn"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCopyError",
          "args": [
            "err",
            "&conn->err"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "197-220",
          "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "conn"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorGenericFailure",
          "args": [
            "err"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorGenericFailure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "184-191",
          "snippet": "static void\nvirErrorGenericFailure(virErrorPtr err)\n{\n    err->code = VIR_ERR_INTERNAL_ERROR;\n    err->domain = VIR_FROM_NONE;\n    err->level = VIR_ERR_ERROR;\n    err->message = g_strdup(_(\"An error occurred, but the cause is unknown\"));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirErrorGenericFailure(virErrorPtr err)\n{\n    err->code = VIR_ERR_INTERNAL_ERROR;\n    err->domain = VIR_FROM_NONE;\n    err->level = VIR_ERR_ERROR;\n    err->message = g_strdup(_(\"An error occurred, but the cause is unknown\"));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
  },
  {
    "function_name": "virDefaultErrorFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "644-682",
    "snippet": "void\nvirDefaultErrorFunc(virErrorPtr err)\n{\n    const char *lvl = \"\", *dom = \"\", *domain = \"\", *network = \"\";\n    int len;\n\n    if ((err == NULL) || (err->code == VIR_ERR_OK))\n        return;\n    switch (err->level) {\n        case VIR_ERR_NONE:\n            lvl = \"\";\n            break;\n        case VIR_ERR_WARNING:\n            lvl = _(\"warning\");\n            break;\n        case VIR_ERR_ERROR:\n            lvl = _(\"error\");\n            break;\n    }\n    dom = virErrorDomainTypeToString(err->domain);\n    if (!dom)\n        dom = \"Unknown\";\n    if ((err->dom != NULL) && (err->code != VIR_ERR_INVALID_DOMAIN)) {\n        domain = err->dom->name;\n    } else if ((err->net != NULL) && (err->code != VIR_ERR_INVALID_NETWORK)) {\n        network = err->net->name;\n    }\n    len = strlen(err->message);\n    if ((err->domain == VIR_FROM_XML) && (err->code == VIR_ERR_XML_DETAIL) &&\n        (err->int1 != 0))\n        fprintf(stderr, \"libvirt: %s %s %s%s: line %d: %s\",\n                dom, lvl, domain, network, err->int1, err->message);\n    else if ((len == 0) || (err->message[len - 1] != '\\n'))\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\\n\",\n                dom, lvl, domain, network, err->message);\n    else\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\",\n                dom, lvl, domain, network, err->message);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"libvirt: %s %s %s%s: %s\"",
            "dom",
            "lvl",
            "domain",
            "network",
            "err->message"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"libvirt: %s %s %s%s: %s\\n\"",
            "dom",
            "lvl",
            "domain",
            "network",
            "err->message"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"libvirt: %s %s %s%s: line %d: %s\"",
            "dom",
            "lvl",
            "domain",
            "network",
            "err->int1",
            "err->message"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "err->message"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorDomainTypeToString",
          "args": [
            "err->domain"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"error\""
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirDefaultErrorFunc(virErrorPtr err)\n{\n    const char *lvl = \"\", *dom = \"\", *domain = \"\", *network = \"\";\n    int len;\n\n    if ((err == NULL) || (err->code == VIR_ERR_OK))\n        return;\n    switch (err->level) {\n        case VIR_ERR_NONE:\n            lvl = \"\";\n            break;\n        case VIR_ERR_WARNING:\n            lvl = _(\"warning\");\n            break;\n        case VIR_ERR_ERROR:\n            lvl = _(\"error\");\n            break;\n    }\n    dom = virErrorDomainTypeToString(err->domain);\n    if (!dom)\n        dom = \"Unknown\";\n    if ((err->dom != NULL) && (err->code != VIR_ERR_INVALID_DOMAIN)) {\n        domain = err->dom->name;\n    } else if ((err->net != NULL) && (err->code != VIR_ERR_INVALID_NETWORK)) {\n        network = err->net->name;\n    }\n    len = strlen(err->message);\n    if ((err->domain == VIR_FROM_XML) && (err->code == VIR_ERR_XML_DETAIL) &&\n        (err->int1 != 0))\n        fprintf(stderr, \"libvirt: %s %s %s%s: line %d: %s\",\n                dom, lvl, domain, network, err->int1, err->message);\n    else if ((len == 0) || (err->message[len - 1] != '\\n'))\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\\n\",\n                dom, lvl, domain, network, err->message);\n    else\n        fprintf(stderr, \"libvirt: %s %s %s%s: %s\",\n                dom, lvl, domain, network, err->message);\n}"
  },
  {
    "function_name": "virConnSetErrorFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "626-636",
    "snippet": "void\nvirConnSetErrorFunc(virConnectPtr conn, void *userData,\n                    virErrorFunc handler)\n{\n    if (conn == NULL)\n        return;\n    virObjectLock(conn);\n    conn->handler = handler;\n    conn->userData = userData;\n    virObjectUnlock(conn);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "conn"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "conn"
          ],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirConnSetErrorFunc(virConnectPtr conn, void *userData,\n                    virErrorFunc handler)\n{\n    if (conn == NULL)\n        return;\n    virObjectLock(conn);\n    conn->handler = handler;\n    conn->userData = userData;\n    virObjectUnlock(conn);\n}"
  },
  {
    "function_name": "virSetErrorFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "609-614",
    "snippet": "void\nvirSetErrorFunc(void *userData, virErrorFunc handler)\n{\n    virErrorHandler = handler;\n    virUserData = userData;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virErrorFunc virErrorHandler = NULL;",
      "void *virUserData = NULL;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirSetErrorFunc(void *userData, virErrorFunc handler)\n{\n    virErrorHandler = handler;\n    virUserData = userData;\n}"
  },
  {
    "function_name": "virConnResetLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "590-598",
    "snippet": "void\nvirConnResetLastError(virConnectPtr conn)\n{\n    if (conn == NULL)\n        return;\n    virObjectLock(conn);\n    virResetError(&conn->err);\n    virObjectUnlock(conn);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "conn"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "&conn->err"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "conn"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirConnResetLastError(virConnectPtr conn)\n{\n    if (conn == NULL)\n        return;\n    virObjectLock(conn);\n    virResetError(&conn->err);\n    virObjectUnlock(conn);\n}"
  },
  {
    "function_name": "virConnCopyLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "564-579",
    "snippet": "int\nvirConnCopyLastError(virConnectPtr conn, virErrorPtr to)\n{\n    /* We can't guarantee caller has initialized it to zero */\n    memset(to, 0, sizeof(*to));\n\n    if (conn == NULL)\n        return -1;\n    virObjectLock(conn);\n    if (conn->err.code == VIR_ERR_OK)\n        virResetError(to);\n    else\n        virCopyError(&conn->err, to);\n    virObjectUnlock(conn);\n    return to->code;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "conn"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCopyError",
          "args": [
            "&conn->err",
            "to"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "197-220",
          "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "to"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "conn"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "to",
            "0",
            "sizeof(*to)"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirConnCopyLastError(virConnectPtr conn, virErrorPtr to)\n{\n    /* We can't guarantee caller has initialized it to zero */\n    memset(to, 0, sizeof(*to));\n\n    if (conn == NULL)\n        return -1;\n    virObjectLock(conn);\n    if (conn->err.code == VIR_ERR_OK)\n        virResetError(to);\n    else\n        virCopyError(&conn->err, to);\n    virObjectUnlock(conn);\n    return to->code;\n}"
  },
  {
    "function_name": "virConnGetLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "530-536",
    "snippet": "virErrorPtr\nvirConnGetLastError(virConnectPtr conn)\n{\n    if (conn == NULL)\n        return NULL;\n    return &conn->err;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorPtr\nvirConnGetLastError(virConnectPtr conn)\n{\n    if (conn == NULL)\n        return NULL;\n    return &conn->err;\n}"
  },
  {
    "function_name": "virResetLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "500-506",
    "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "err"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
  },
  {
    "function_name": "virFreeError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "484-489",
    "snippet": "void\nvirFreeError(virErrorPtr err)\n{\n    virResetError(err);\n    VIR_FREE(err);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "err"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirFreeError(virErrorPtr err)\n{\n    virResetError(err);\n    VIR_FREE(err);\n}"
  },
  {
    "function_name": "virResetError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "466-476",
    "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "err",
            "0",
            "sizeof(virError)"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err->str3"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err->str2"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err->str1"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err->message"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
  },
  {
    "function_name": "virErrorRestore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "445-457",
    "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFreeError",
          "args": [
            "*savederr"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "virFreeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "484-489",
          "snippet": "void\nvirFreeError(virErrorPtr err)\n{\n    virResetError(err);\n    VIR_FREE(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirFreeError(virErrorPtr err)\n{\n    virResetError(err);\n    VIR_FREE(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetError",
          "args": [
            "*savederr"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "virSetErrorLogPriorityFunc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1391-1394",
          "snippet": "void virSetErrorLogPriorityFunc(virErrorLogPriorityFunc func)\n{\n    virErrorLogPriorityFilter = func;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorLogPriorityFunc virErrorLogPriorityFilter = NULL;\n\nvoid virSetErrorLogPriorityFunc(virErrorLogPriorityFunc func)\n{\n    virErrorLogPriorityFilter = func;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
  },
  {
    "function_name": "virErrorPreserveLast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "424-436",
    "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorCopyNew",
          "args": [
            "lasterr"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorCopyNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "223-235",
          "snippet": "virErrorPtr\nvirErrorCopyNew(virErrorPtr err)\n{\n    virErrorPtr ret;\n\n    if (VIR_ALLOC_QUIET(ret) < 0)\n        return NULL;\n\n    if (virCopyError(err, ret) < 0)\n        VIR_FREE(ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorPtr\nvirErrorCopyNew(virErrorPtr err)\n{\n    virErrorPtr ret;\n\n    if (VIR_ALLOC_QUIET(ret) < 0)\n        return NULL;\n\n    if (virCopyError(err, ret) < 0)\n        VIR_FREE(ret);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetLastError",
          "args": [],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
  },
  {
    "function_name": "virSaveLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "401-413",
    "snippet": "virErrorPtr\nvirSaveLastError(void)\n{\n    virErrorPtr to;\n    int saved_errno = errno;\n\n    if (VIR_ALLOC_QUIET(to) < 0)\n        return NULL;\n\n    virCopyLastError(to);\n    errno = saved_errno;\n    return to;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCopyLastError",
          "args": [
            "to"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "370-389",
          "snippet": "int\nvirCopyLastError(virErrorPtr to)\n{\n    virErrorPtr err = virLastErrorObject();\n\n    if (!to)\n        return -1;\n\n    /* We can't guarantee caller has initialized it to zero */\n    memset(to, 0, sizeof(*to));\n    if (err) {\n        virCopyError(err, to);\n    } else {\n        virResetError(to);\n        to->code = VIR_ERR_NO_MEMORY;\n        to->domain = VIR_FROM_NONE;\n        to->level = VIR_ERR_ERROR;\n    }\n    return to->code;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirCopyLastError(virErrorPtr to)\n{\n    virErrorPtr err = virLastErrorObject();\n\n    if (!to)\n        return -1;\n\n    /* We can't guarantee caller has initialized it to zero */\n    memset(to, 0, sizeof(*to));\n    if (err) {\n        virCopyError(err, to);\n    } else {\n        virResetError(to);\n        to->code = VIR_ERR_NO_MEMORY;\n        to->domain = VIR_FROM_NONE;\n        to->level = VIR_ERR_ERROR;\n    }\n    return to->code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_QUIET",
          "args": [
            "to"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorPtr\nvirSaveLastError(void)\n{\n    virErrorPtr to;\n    int saved_errno = errno;\n\n    if (VIR_ALLOC_QUIET(to) < 0)\n        return NULL;\n\n    virCopyLastError(to);\n    errno = saved_errno;\n    return to;\n}"
  },
  {
    "function_name": "virCopyLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "370-389",
    "snippet": "int\nvirCopyLastError(virErrorPtr to)\n{\n    virErrorPtr err = virLastErrorObject();\n\n    if (!to)\n        return -1;\n\n    /* We can't guarantee caller has initialized it to zero */\n    memset(to, 0, sizeof(*to));\n    if (err) {\n        virCopyError(err, to);\n    } else {\n        virResetError(to);\n        to->code = VIR_ERR_NO_MEMORY;\n        to->domain = VIR_FROM_NONE;\n        to->level = VIR_ERR_ERROR;\n    }\n    return to->code;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "to"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCopyError",
          "args": [
            "err",
            "to"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "197-220",
          "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "to",
            "0",
            "sizeof(*to)"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirCopyLastError(virErrorPtr to)\n{\n    virErrorPtr err = virLastErrorObject();\n\n    if (!to)\n        return -1;\n\n    /* We can't guarantee caller has initialized it to zero */\n    memset(to, 0, sizeof(*to));\n    if (err) {\n        virCopyError(err, to);\n    } else {\n        virResetError(to);\n        to->code = VIR_ERR_NO_MEMORY;\n        to->domain = VIR_FROM_NONE;\n        to->level = VIR_ERR_ERROR;\n    }\n    return to->code;\n}"
  },
  {
    "function_name": "virSetError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "339-355",
    "snippet": "int\nvirSetError(virErrorPtr newerr)\n{\n    virErrorPtr err;\n    int saved_errno = errno;\n    int ret = -1;\n\n    err = virLastErrorObject();\n    if (!err)\n        goto cleanup;\n\n    virResetError(err);\n    ret = virCopyError(newerr, err);\n cleanup:\n    errno = saved_errno;\n    return ret;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCopyError",
          "args": [
            "newerr",
            "err"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "197-220",
          "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "err"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirSetError(virErrorPtr newerr)\n{\n    virErrorPtr err;\n    int saved_errno = errno;\n    int ret = -1;\n\n    err = virLastErrorObject();\n    if (!err)\n        goto cleanup;\n\n    virResetError(err);\n    ret = virCopyError(newerr, err);\n cleanup:\n    errno = saved_errno;\n    return ret;\n}"
  },
  {
    "function_name": "virGetLastErrorMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "316-325",
    "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown error\""
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
  },
  {
    "function_name": "virGetLastErrorDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "298-305",
    "snippet": "int\nvirGetLastErrorDomain(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_FROM_NONE;\n    return err->domain;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirGetLastErrorDomain(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_FROM_NONE;\n    return err->domain;\n}"
  },
  {
    "function_name": "virGetLastErrorCode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "280-287",
    "snippet": "int\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}"
  },
  {
    "function_name": "virGetLastError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "263-270",
    "snippet": "virErrorPtr\nvirGetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err || err->code == VIR_ERR_OK)\n        return NULL;\n    return err;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virLastErrorObject",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "238-250",
          "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal virLastErr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorPtr\nvirGetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err || err->code == VIR_ERR_OK)\n        return NULL;\n    return err;\n}"
  },
  {
    "function_name": "virLastErrorObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "238-250",
    "snippet": "static virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virLastErr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadLocalSet",
          "args": [
            "&virLastErr",
            "err"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "352-360",
          "snippet": "int virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalSet(virThreadLocalPtr l, void *val)\n{\n    int err = pthread_setspecific(l->key, val);\n    if (err) {\n        errno = err;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_QUIET",
          "args": [
            "err"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virThreadLocalGet",
          "args": [
            "&virLastErr"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "347-350",
          "snippet": "void *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid *virThreadLocalGet(virThreadLocalPtr l)\n{\n    return pthread_getspecific(l->key);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nstatic virErrorPtr\nvirLastErrorObject(void)\n{\n    virErrorPtr err;\n    err = virThreadLocalGet(&virLastErr);\n    if (!err) {\n        if (VIR_ALLOC_QUIET(err) < 0)\n            return NULL;\n        if (virThreadLocalSet(&virLastErr, err) < 0)\n            VIR_FREE(err);\n    }\n    return err;\n}"
  },
  {
    "function_name": "virErrorCopyNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "223-235",
    "snippet": "virErrorPtr\nvirErrorCopyNew(virErrorPtr err)\n{\n    virErrorPtr ret;\n\n    if (VIR_ALLOC_QUIET(ret) < 0)\n        return NULL;\n\n    if (virCopyError(err, ret) < 0)\n        VIR_FREE(ret);\n\n    return ret;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ret"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCopyError",
          "args": [
            "err",
            "ret"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virCopyError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "197-220",
          "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_QUIET",
          "args": [
            "ret"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorPtr\nvirErrorCopyNew(virErrorPtr err)\n{\n    virErrorPtr ret;\n\n    if (VIR_ALLOC_QUIET(ret) < 0)\n        return NULL;\n\n    if (virCopyError(err, ret) < 0)\n        VIR_FREE(ret);\n\n    return ret;\n}"
  },
  {
    "function_name": "virCopyError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "197-220",
    "snippet": "static int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "from->str3"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "to"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic int\nvirCopyError(virErrorPtr from,\n             virErrorPtr to)\n{\n    int ret = 0;\n    if (!to)\n        return 0;\n    virResetError(to);\n    if (!from)\n        return 0;\n    to->code = from->code;\n    to->domain = from->domain;\n    to->level = from->level;\n    to->message = g_strdup(from->message);\n    to->str1 = g_strdup(from->str1);\n    to->str2 = g_strdup(from->str2);\n    to->str3 = g_strdup(from->str3);\n    to->int1 = from->int1;\n    to->int2 = from->int2;\n    /*\n     * Deliberately not setting 'conn', 'dom', 'net' references\n     */\n    return ret;\n}"
  },
  {
    "function_name": "virErrorGenericFailure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "184-191",
    "snippet": "static void\nvirErrorGenericFailure(virErrorPtr err)\n{\n    err->code = VIR_ERR_INTERNAL_ERROR;\n    err->domain = VIR_FROM_NONE;\n    err->level = VIR_ERR_ERROR;\n    err->message = g_strdup(_(\"An error occurred, but the cause is unknown\"));\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "_(\"An error occurred, but the cause is unknown\")"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirErrorGenericFailure(virErrorPtr err)\n{\n    err->code = VIR_ERR_INTERNAL_ERROR;\n    err->domain = VIR_FROM_NONE;\n    err->level = VIR_ERR_ERROR;\n    err->message = g_strdup(_(\"An error occurred, but the cause is unknown\"));\n}"
  },
  {
    "function_name": "virErrorInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "172-176",
    "snippet": "int\nvirErrorInitialize(void)\n{\n    return virThreadLocalInit(&virLastErr, virLastErrFreeData);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virThreadLocal virLastErr;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virThreadLocalInit",
          "args": [
            "&virLastErr",
            "virLastErrFreeData"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "virThreadLocalInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "336-345",
          "snippet": "int virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virThreadLocalInit(virThreadLocalPtr l,\n                       virThreadLocalCleanup c)\n{\n    int ret;\n    if ((ret = pthread_key_create(&l->key, c)) != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirThreadLocal virLastErr;\n\nint\nvirErrorInitialize(void)\n{\n    return virThreadLocalInit(&virLastErr, virLastErrFreeData);\n}"
  },
  {
    "function_name": "virLastErrFreeData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "154-162",
    "snippet": "static void\nvirLastErrFreeData(void *data)\n{\n    virErrorPtr err = data;\n    if (!err)\n        return;\n    virResetError(err);\n    VIR_FREE(err);\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "err"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetError",
          "args": [
            "err"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virResetError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "466-476",
          "snippet": "void\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetError(virErrorPtr err)\n{\n    if (err == NULL)\n        return;\n    VIR_FREE(err->message);\n    VIR_FREE(err->str1);\n    VIR_FREE(err->str2);\n    VIR_FREE(err->str3);\n    memset(err, 0, sizeof(virError));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic void\nvirLastErrFreeData(void *data)\n{\n    virErrorPtr err = data;\n    if (!err)\n        return;\n    virResetError(err);\n    VIR_FREE(err);\n}"
  },
  {
    "function_name": "virErrorLevelPriority",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
    "lines": "44-55",
    "snippet": "static virLogPriority virErrorLevelPriority(virErrorLevel level)\n{\n    switch (level) {\n        case VIR_ERR_NONE:\n            return VIR_LOG_INFO;\n        case VIR_ERR_WARNING:\n            return VIR_LOG_WARN;\n        case VIR_ERR_ERROR:\n            return VIR_LOG_ERROR;\n    }\n    return VIR_LOG_ERROR;\n}",
    "includes": [
      "#include \"virerrorpriv.h\"",
      "#include \"virstring.h\"",
      "#include \"virthread.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include <stdarg.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nstatic virLogPriority virErrorLevelPriority(virErrorLevel level)\n{\n    switch (level) {\n        case VIR_ERR_NONE:\n            return VIR_LOG_INFO;\n        case VIR_ERR_WARNING:\n            return VIR_LOG_WARN;\n        case VIR_ERR_ERROR:\n            return VIR_LOG_ERROR;\n    }\n    return VIR_LOG_ERROR;\n}"
  }
]