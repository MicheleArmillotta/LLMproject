[
  {
    "function_name": "virSecretEventValueChangedNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "282-302",
    "snippet": "virObjectEventPtr\nvirSecretEventValueChangedNew(const unsigned char *uuid,\n                              int usage_type,\n                              const char *usage_id)\n{\n    virSecretEventValueChangedPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    VIR_DEBUG(\"Event %s %d %s\", uuidstr, usage_type, usage_id);\n    if (!(event = virObjectEventNew(virSecretEventValueChangedClass,\n                                    virSecretEventDispatchDefaultFunc,\n                                    VIR_SECRET_EVENT_ID_VALUE_CHANGED,\n                                    usage_type, usage_id, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretEventValueChangedClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventNew",
          "args": [
            "virSecretEventValueChangedClass",
            "virSecretEventDispatchDefaultFunc",
            "VIR_SECRET_EVENT_ID_VALUE_CHANGED",
            "usage_type",
            "usage_id",
            "uuid",
            "uuidstr"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "597-633",
          "snippet": "void *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;",
            "static void virObjectEventDispose(void *obj);",
            "static void virObjectEventStateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nvoid *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Event %s %d %s\"",
            "uuidstr",
            "usage_type",
            "usage_id"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretEventsInitialize",
          "args": [],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic virClassPtr virSecretEventValueChangedClass;\n\nvirObjectEventPtr\nvirSecretEventValueChangedNew(const unsigned char *uuid,\n                              int usage_type,\n                              const char *usage_id)\n{\n    virSecretEventValueChangedPtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    VIR_DEBUG(\"Event %s %d %s\", uuidstr, usage_type, usage_id);\n    if (!(event = virObjectEventNew(virSecretEventValueChangedClass,\n                                    virSecretEventDispatchDefaultFunc,\n                                    VIR_SECRET_EVENT_ID_VALUE_CHANGED,\n                                    usage_type, usage_id, uuid, uuidstr)))\n        return NULL;\n\n    return (virObjectEventPtr)event;\n}"
  },
  {
    "function_name": "virSecretEventLifecycleNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "248-273",
    "snippet": "virObjectEventPtr\nvirSecretEventLifecycleNew(const unsigned char *uuid,\n                           int usage_type,\n                           const char *usage_id,\n                           int type,\n                           int detail)\n{\n    virSecretEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    VIR_DEBUG(\"Event %s %d %s %d %d\", uuidstr, usage_type, usage_id, type, detail);\n    if (!(event = virObjectEventNew(virSecretEventLifecycleClass,\n                                    virSecretEventDispatchDefaultFunc,\n                                    VIR_SECRET_EVENT_ID_LIFECYCLE,\n                                    usage_type, usage_id, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretEventLifecycleClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventNew",
          "args": [
            "virSecretEventLifecycleClass",
            "virSecretEventDispatchDefaultFunc",
            "VIR_SECRET_EVENT_ID_LIFECYCLE",
            "usage_type",
            "usage_id",
            "uuid",
            "uuidstr"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "597-633",
          "snippet": "void *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;",
            "static void virObjectEventDispose(void *obj);",
            "static void virObjectEventStateDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\nstatic void virObjectEventDispose(void *obj);\nstatic void virObjectEventStateDispose(void *obj);\n\nvoid *\nvirObjectEventNew(virClassPtr klass,\n                  virObjectEventDispatchFunc dispatcher,\n                  int eventID,\n                  int id,\n                  const char *name,\n                  const unsigned char *uuid,\n                  const char *key)\n{\n    virObjectEventPtr event;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!virClassIsDerivedFrom(klass, virObjectEventClass)) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectEvent\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(event = virObjectNew(klass)))\n        return NULL;\n\n    event->dispatch = dispatcher;\n    event->eventID = eventID;\n    event->remoteID = -1;\n\n    event->meta.name = g_strdup(name);\n    event->meta.key = g_strdup(key);\n    event->meta.id = id;\n    if (uuid)\n        memcpy(event->meta.uuid, uuid, VIR_UUID_BUFLEN);\n\n    VIR_DEBUG(\"obj=%p\", event);\n    return event;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Event %s %d %s %d %d\"",
            "uuidstr",
            "usage_type",
            "usage_id",
            "type",
            "detail"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretEventsInitialize",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic virClassPtr virSecretEventLifecycleClass;\n\nvirObjectEventPtr\nvirSecretEventLifecycleNew(const unsigned char *uuid,\n                           int usage_type,\n                           const char *usage_id,\n                           int type,\n                           int detail)\n{\n    virSecretEventLifecyclePtr event;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return NULL;\n\n    virUUIDFormat(uuid, uuidstr);\n    VIR_DEBUG(\"Event %s %d %s %d %d\", uuidstr, usage_type, usage_id, type, detail);\n    if (!(event = virObjectEventNew(virSecretEventLifecycleClass,\n                                    virSecretEventDispatchDefaultFunc,\n                                    VIR_SECRET_EVENT_ID_LIFECYCLE,\n                                    usage_type, usage_id, uuid, uuidstr)))\n        return NULL;\n\n    event->type = type;\n    event->detail = detail;\n\n    return (virObjectEventPtr)event;\n}"
  },
  {
    "function_name": "virSecretEventStateRegisterClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "211-235",
    "snippet": "int\nvirSecretEventStateRegisterClient(virConnectPtr conn,\n                                  virObjectEventStatePtr state,\n                                  virSecretPtr secret,\n                                  int eventID,\n                                  virConnectSecretEventGenericCallback cb,\n                                  void *opaque,\n                                  virFreeCallback freecb,\n                                  int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return -1;\n\n    if (secret)\n        virUUIDFormat(secret->uuid, uuidstr);\n\n    return virObjectEventStateRegisterID(conn, state,  secret ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virSecretEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, true);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateRegisterID",
          "args": [
            "conn",
            "state",
            "secret ? uuidstr : NULL",
            "NULL",
            "NULL",
            "virSecretEventClass",
            "eventID",
            "VIR_OBJECT_EVENT_CALLBACK(cb)",
            "opaque",
            "freecb",
            "false",
            "callbackID",
            "true"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "870-917",
          "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_OBJECT_EVENT_CALLBACK",
          "args": [
            "cb"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "secret->uuid",
            "uuidstr"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretEventsInitialize",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic virClassPtr virSecretEventClass;\n\nint\nvirSecretEventStateRegisterClient(virConnectPtr conn,\n                                  virObjectEventStatePtr state,\n                                  virSecretPtr secret,\n                                  int eventID,\n                                  virConnectSecretEventGenericCallback cb,\n                                  void *opaque,\n                                  virFreeCallback freecb,\n                                  int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return -1;\n\n    if (secret)\n        virUUIDFormat(secret->uuid, uuidstr);\n\n    return virObjectEventStateRegisterID(conn, state,  secret ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virSecretEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, true);\n}"
  },
  {
    "function_name": "virSecretEventStateRegisterID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "167-190",
    "snippet": "int\nvirSecretEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virSecretPtr secret,\n                              int eventID,\n                              virConnectSecretEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return -1;\n\n    if (secret)\n        virUUIDFormat(secret->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, secret ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virSecretEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateRegisterID",
          "args": [
            "conn",
            "state",
            "secret ? uuidstr : NULL",
            "NULL",
            "NULL",
            "virSecretEventClass",
            "eventID",
            "VIR_OBJECT_EVENT_CALLBACK(cb)",
            "opaque",
            "freecb",
            "false",
            "callbackID",
            "false"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "870-917",
          "snippet": "int\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              const char *key,\n                              virObjectEventCallbackFilter filter,\n                              void *filter_opaque,\n                              virClassPtr klass,\n                              int eventID,\n                              virConnectObjectEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              bool legacy,\n                              int *callbackID,\n                              bool serverFilter)\n{\n    int ret = -1;\n\n    virObjectLock(state);\n\n    if ((state->callbacks->count == 0) &&\n        (state->timer == -1)) {\n        if ((state->timer = virEventAddTimeout(-1,\n                                               virObjectEventTimer,\n                                               state,\n                                               virObjectFreeCallback)) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not initialize domain event timer\"));\n            goto cleanup;\n        }\n\n        /* event loop has one reference, but we need one more for the\n         * timer's opaque argument */\n        virObjectRef(state);\n    }\n\n    ret = virObjectEventCallbackListAddID(conn, state->callbacks,\n                                          key, filter, filter_opaque,\n                                          klass, eventID,\n                                          cb, opaque, freecb,\n                                          legacy, callbackID, serverFilter);\n\n    if (ret < 0)\n        virObjectEventStateCleanupTimer(state, false);\n\n cleanup:\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_OBJECT_EVENT_CALLBACK",
          "args": [
            "cb"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "secret->uuid",
            "uuidstr"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecretEventsInitialize",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic virClassPtr virSecretEventClass;\n\nint\nvirSecretEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virSecretPtr secret,\n                              int eventID,\n                              virConnectSecretEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virSecretEventsInitialize() < 0)\n        return -1;\n\n    if (secret)\n        virUUIDFormat(secret->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, secret ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virSecretEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
  },
  {
    "function_name": "virSecretEventDispatchDefaultFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "106-147",
    "snippet": "static void\nvirSecretEventDispatchDefaultFunc(virConnectPtr conn,\n                                  virObjectEventPtr event,\n                                  virConnectObjectEventGenericCallback cb,\n                                  void *cbopaque)\n{\n    virSecretPtr secret = virGetSecret(conn,\n                                       event->meta.uuid,\n                                       event->meta.id,\n                                       event->meta.name);\n\n    if (!secret)\n        return;\n\n    switch ((virSecretEventID)event->eventID) {\n    case VIR_SECRET_EVENT_ID_LIFECYCLE:\n        {\n            virSecretEventLifecyclePtr secretLifecycleEvent;\n\n            secretLifecycleEvent = (virSecretEventLifecyclePtr)event;\n            ((virConnectSecretEventLifecycleCallback)cb)(conn, secret,\n                                                         secretLifecycleEvent->type,\n                                                         secretLifecycleEvent->detail,\n                                                         cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_SECRET_EVENT_ID_VALUE_CHANGED:\n        {\n            ((virConnectSecretEventGenericCallback)cb)(conn, secret,\n                                                       cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_SECRET_EVENT_ID_LAST:\n        break;\n    }\n    VIR_WARN(\"Unexpected event ID %d\", event->eventID);\n\n cleanup:\n    virObjectUnref(secret);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "secret"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unexpected event ID %d\"",
            "event->eventID"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "conn",
            "secret",
            "cbopaque"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "conn",
            "secret",
            "secretLifecycleEvent->type",
            "secretLifecycleEvent->detail",
            "cbopaque"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetSecret",
          "args": [
            "conn",
            "event->meta.uuid",
            "event->meta.id",
            "event->meta.name"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "virGetSecret",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "729-755",
          "snippet": "virSecretPtr\nvirGetSecret(virConnectPtr conn, const unsigned char *uuid,\n             int usageType, const char *usageID)\n{\n    virSecretPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virSecretClass)))\n        return NULL;\n\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n    ret->usageType = usageType;\n    ret->usageID = g_strdup(NULLSTR_EMPTY(usageID));\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virSecretClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virSecretClass;\n\nvirSecretPtr\nvirGetSecret(virConnectPtr conn, const unsigned char *uuid,\n             int usageType, const char *usageID)\n{\n    virSecretPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virSecretClass)))\n        return NULL;\n\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n    ret->usageType = usageType;\n    ret->usageID = g_strdup(NULLSTR_EMPTY(usageID));\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic void\nvirSecretEventDispatchDefaultFunc(virConnectPtr conn,\n                                  virObjectEventPtr event,\n                                  virConnectObjectEventGenericCallback cb,\n                                  void *cbopaque)\n{\n    virSecretPtr secret = virGetSecret(conn,\n                                       event->meta.uuid,\n                                       event->meta.id,\n                                       event->meta.name);\n\n    if (!secret)\n        return;\n\n    switch ((virSecretEventID)event->eventID) {\n    case VIR_SECRET_EVENT_ID_LIFECYCLE:\n        {\n            virSecretEventLifecyclePtr secretLifecycleEvent;\n\n            secretLifecycleEvent = (virSecretEventLifecyclePtr)event;\n            ((virConnectSecretEventLifecycleCallback)cb)(conn, secret,\n                                                         secretLifecycleEvent->type,\n                                                         secretLifecycleEvent->detail,\n                                                         cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_SECRET_EVENT_ID_VALUE_CHANGED:\n        {\n            ((virConnectSecretEventGenericCallback)cb)(conn, secret,\n                                                       cbopaque);\n            goto cleanup;\n        }\n\n    case VIR_SECRET_EVENT_ID_LAST:\n        break;\n    }\n    VIR_WARN(\"Unexpected event ID %d\", event->eventID);\n\n cleanup:\n    virObjectUnref(secret);\n}"
  },
  {
    "function_name": "virSecretEventValueChangedDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "98-103",
    "snippet": "static void\nvirSecretEventValueChangedDispose(void *obj)\n{\n    virSecretEventValueChangedPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretEventDispose(void *obj);",
      "static void virSecretEventLifecycleDispose(void *obj);",
      "static void virSecretEventValueChangedDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic void virSecretEventDispose(void *obj);\nstatic void virSecretEventLifecycleDispose(void *obj);\nstatic void virSecretEventValueChangedDispose(void *obj);\n\nstatic void\nvirSecretEventValueChangedDispose(void *obj)\n{\n    virSecretEventValueChangedPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virSecretEventLifecycleDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "90-95",
    "snippet": "static void\nvirSecretEventLifecycleDispose(void *obj)\n{\n    virSecretEventLifecyclePtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretEventDispose(void *obj);",
      "static void virSecretEventLifecycleDispose(void *obj);",
      "static void virSecretEventValueChangedDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic void virSecretEventDispose(void *obj);\nstatic void virSecretEventLifecycleDispose(void *obj);\nstatic void virSecretEventValueChangedDispose(void *obj);\n\nstatic void\nvirSecretEventLifecycleDispose(void *obj)\n{\n    virSecretEventLifecyclePtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virSecretEventDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "82-87",
    "snippet": "static void\nvirSecretEventDispose(void *obj)\n{\n    virSecretEventPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virSecretEventDispose(void *obj);",
      "static void virSecretEventLifecycleDispose(void *obj);",
      "static void virSecretEventValueChangedDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "event"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic void virSecretEventDispose(void *obj);\nstatic void virSecretEventLifecycleDispose(void *obj);\nstatic void virSecretEventValueChangedDispose(void *obj);\n\nstatic void\nvirSecretEventDispose(void *obj)\n{\n    virSecretEventPtr event = obj;\n    VIR_DEBUG(\"obj=%p\", event);\n}"
  },
  {
    "function_name": "virSecretEventsOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/secret_event.c",
    "lines": "65-78",
    "snippet": "static int\nvirSecretEventsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virSecretEvent, virClassForObjectEvent()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virSecretEventLifecycle, virSecretEventClass))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virSecretEventValueChanged, virSecretEventClass))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"datatypes.h\"",
      "#include \"object_event_private.h\"",
      "#include \"object_event.h\"",
      "#include \"secret_event.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virSecretEventClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virSecretEventValueChanged",
            "virSecretEventClass"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virSecretEventLifecycle",
            "virSecretEventClass"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virSecretEvent",
            "virClassForObjectEvent()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectEvent",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "110-116",
          "snippet": "virClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\n\nvirClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"secret_event.h\"\n#include <config.h>\n\nstatic virClassPtr virSecretEventClass;\n\nstatic int\nvirSecretEventsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virSecretEvent, virClassForObjectEvent()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virSecretEventLifecycle, virSecretEventClass))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virSecretEventValueChanged, virSecretEventClass))\n        return -1;\n\n    return 0;\n}"
  }
]