[
  {
    "function_name": "virHashCodeGen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
    "lines": "63-125",
    "snippet": "uint32_t virHashCodeGen(const void *key, size_t len, uint32_t seed)\n{\n    const uint8_t *blocks;\n    const uint8_t *tail;\n    size_t nblocks;\n    uint32_t h1;\n    uint32_t k1;\n    uint32_t c1;\n    uint32_t c2;\n    size_t i;\n\n    blocks = (const uint8_t *)key;\n    nblocks = len / 4;\n    h1 = seed;\n    c1 = 0xcc9e2d51;\n    c2 = 0x1b873593;\n\n    /* body */\n\n    for (i = 0; i < nblocks; i++) {\n\n        k1 = getblock(blocks, i);\n\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n\n        h1 ^= k1;\n        h1 = rotl32(h1, 13);\n        h1 = h1 * 5 + 0xe6546b64;\n    }\n\n    /* tail */\n\n    tail = (const uint8_t *)key + nblocks * 4;\n\n    k1 = 0;\n\n    switch (len & 3) {\n    case 3:\n        k1 ^= tail[2] << 16;\n        G_GNUC_FALLTHROUGH;\n    case 2:\n        k1 ^= tail[1] << 8;\n        G_GNUC_FALLTHROUGH;\n    case 1:\n        k1 ^= tail[0];\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n        h1 ^= k1;\n        G_GNUC_FALLTHROUGH;\n    default:\n        break;\n    }\n\n    /* finalization */\n\n    h1 ^= len;\n    h1 = fmix(h1);\n\n    return h1;\n}",
    "includes": [
      "#include \"virhashcode.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fmix",
          "args": [
            "h1"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "fmix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
          "lines": "51-60",
          "snippet": "static inline uint32_t fmix(uint32_t h)\n{\n    h ^= h >> 16;\n    h *= 0x85ebca6b;\n    h ^= h >> 13;\n    h *= 0xc2b2ae35;\n    h ^= h >> 16;\n\n    return h;\n}",
          "includes": [
            "#include \"virhashcode.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nstatic inline uint32_t fmix(uint32_t h)\n{\n    h ^= h >> 16;\n    h *= 0x85ebca6b;\n    h ^= h >> 13;\n    h *= 0xc2b2ae35;\n    h ^= h >> 16;\n\n    return h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotl32",
          "args": [
            "k1",
            "15"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "rotl32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
          "lines": "32-35",
          "snippet": "static uint32_t rotl32(uint32_t x, int8_t r)\n{\n    return (x << r) | (x >> (32 - r));\n}",
          "includes": [
            "#include \"virhashcode.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nstatic uint32_t rotl32(uint32_t x, int8_t r)\n{\n    return (x << r) | (x >> (32 - r));\n}"
        }
      },
      {
        "call_info": {
          "callee": "getblock",
          "args": [
            "blocks",
            "i"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "getblock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
          "lines": "38-46",
          "snippet": "static inline uint32_t getblock(const uint8_t *p, int i)\n{\n    uint32_t r;\n    size_t size = sizeof(r);\n\n    memcpy(&r, &p[i * size], size);\n\n    return r;\n}",
          "includes": [
            "#include \"virhashcode.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nstatic inline uint32_t getblock(const uint8_t *p, int i)\n{\n    uint32_t r;\n    size_t size = sizeof(r);\n\n    memcpy(&r, &p[i * size], size);\n\n    return r;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nuint32_t virHashCodeGen(const void *key, size_t len, uint32_t seed)\n{\n    const uint8_t *blocks;\n    const uint8_t *tail;\n    size_t nblocks;\n    uint32_t h1;\n    uint32_t k1;\n    uint32_t c1;\n    uint32_t c2;\n    size_t i;\n\n    blocks = (const uint8_t *)key;\n    nblocks = len / 4;\n    h1 = seed;\n    c1 = 0xcc9e2d51;\n    c2 = 0x1b873593;\n\n    /* body */\n\n    for (i = 0; i < nblocks; i++) {\n\n        k1 = getblock(blocks, i);\n\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n\n        h1 ^= k1;\n        h1 = rotl32(h1, 13);\n        h1 = h1 * 5 + 0xe6546b64;\n    }\n\n    /* tail */\n\n    tail = (const uint8_t *)key + nblocks * 4;\n\n    k1 = 0;\n\n    switch (len & 3) {\n    case 3:\n        k1 ^= tail[2] << 16;\n        G_GNUC_FALLTHROUGH;\n    case 2:\n        k1 ^= tail[1] << 8;\n        G_GNUC_FALLTHROUGH;\n    case 1:\n        k1 ^= tail[0];\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n        h1 ^= k1;\n        G_GNUC_FALLTHROUGH;\n    default:\n        break;\n    }\n\n    /* finalization */\n\n    h1 ^= len;\n    h1 = fmix(h1);\n\n    return h1;\n}"
  },
  {
    "function_name": "fmix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
    "lines": "51-60",
    "snippet": "static inline uint32_t fmix(uint32_t h)\n{\n    h ^= h >> 16;\n    h *= 0x85ebca6b;\n    h ^= h >> 13;\n    h *= 0xc2b2ae35;\n    h ^= h >> 16;\n\n    return h;\n}",
    "includes": [
      "#include \"virhashcode.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nstatic inline uint32_t fmix(uint32_t h)\n{\n    h ^= h >> 16;\n    h *= 0x85ebca6b;\n    h ^= h >> 13;\n    h *= 0xc2b2ae35;\n    h ^= h >> 16;\n\n    return h;\n}"
  },
  {
    "function_name": "getblock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
    "lines": "38-46",
    "snippet": "static inline uint32_t getblock(const uint8_t *p, int i)\n{\n    uint32_t r;\n    size_t size = sizeof(r);\n\n    memcpy(&r, &p[i * size], size);\n\n    return r;\n}",
    "includes": [
      "#include \"virhashcode.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&r",
            "&p[i * size]",
            "size"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nstatic inline uint32_t getblock(const uint8_t *p, int i)\n{\n    uint32_t r;\n    size_t size = sizeof(r);\n\n    memcpy(&r, &p[i * size], size);\n\n    return r;\n}"
  },
  {
    "function_name": "rotl32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
    "lines": "32-35",
    "snippet": "static uint32_t rotl32(uint32_t x, int8_t r)\n{\n    return (x << r) | (x >> (32 - r));\n}",
    "includes": [
      "#include \"virhashcode.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nstatic uint32_t rotl32(uint32_t x, int8_t r)\n{\n    return (x << r) | (x >> (32 - r));\n}"
  }
]