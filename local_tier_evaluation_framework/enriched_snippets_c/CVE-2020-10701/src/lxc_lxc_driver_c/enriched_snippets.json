[
  {
    "function_name": "lxcRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "5192-5200",
    "snippet": "int lxcRegister(void)\n{\n    if (virRegisterConnectDriver(&lxcConnectDriver,\n                                 true) < 0)\n        return -1;\n    if (virRegisterStateDriver(&lxcStateDriver) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virConnectDriver lxcConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"lxc\", NULL },\n    .hypervisorDriver = &lxcHypervisorDriver,\n};",
      "static virStateDriver lxcStateDriver = {\n    .name = LXC_DRIVER_NAME,\n    .stateInitialize = lxcStateInitialize,\n    .stateCleanup = lxcStateCleanup,\n    .stateReload = lxcStateReload,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRegisterStateDriver",
          "args": [
            "&lxcStateDriver"
          ],
          "line": 5197
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterStateDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "588-602",
          "snippet": "int\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virStateDriverPtr virStateDriverTab[MAX_DRIVERS];",
            "static int virStateDriverTabCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virStateDriverPtr virStateDriverTab[MAX_DRIVERS];\nstatic int virStateDriverTabCount;\n\nint\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRegisterConnectDriver",
          "args": [
            "&lxcConnectDriver",
            "true"
          ],
          "line": 5194
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterConnectDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "515-550",
          "snippet": "int\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];",
            "static int virConnectDriverTabCount;",
            "static virNetworkDriverPtr virSharedNetworkDriver;",
            "static virInterfaceDriverPtr virSharedInterfaceDriver;",
            "static virStorageDriverPtr virSharedStorageDriver;",
            "static virNodeDeviceDriverPtr virSharedNodeDeviceDriver;",
            "static virSecretDriverPtr virSharedSecretDriver;",
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];\nstatic int virConnectDriverTabCount;\nstatic virNetworkDriverPtr virSharedNetworkDriver;\nstatic virInterfaceDriverPtr virSharedInterfaceDriver;\nstatic virStorageDriverPtr virSharedStorageDriver;\nstatic virNodeDeviceDriverPtr virSharedNodeDeviceDriver;\nstatic virSecretDriverPtr virSharedSecretDriver;\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virConnectDriver lxcConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"lxc\", NULL },\n    .hypervisorDriver = &lxcHypervisorDriver,\n};\nstatic virStateDriver lxcStateDriver = {\n    .name = LXC_DRIVER_NAME,\n    .stateInitialize = lxcStateInitialize,\n    .stateCleanup = lxcStateCleanup,\n    .stateReload = lxcStateReload,\n};\n\nint lxcRegister(void)\n{\n    if (virRegisterConnectDriver(&lxcConnectDriver,\n                                 true) < 0)\n        return -1;\n    if (virRegisterStateDriver(&lxcStateDriver) < 0)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "lxcDomainHasManagedSaveImage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "5059-5078",
    "snippet": "static int\nlxcDomainHasManagedSaveImage(virDomainPtr dom, unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    if (virDomainHasManagedSaveImageEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 5076
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHasManagedSaveImageEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 5070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 5067
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 5065
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainHasManagedSaveImage(virDomainPtr dom, unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    if (virDomainHasManagedSaveImageEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcNodeAllocPages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "5038-5056",
    "snippet": "static int\nlxcNodeAllocPages(virConnectPtr conn,\n                  unsigned int npages,\n                  unsigned int *pageSizes,\n                  unsigned long long *pageCounts,\n                  int startCell,\n                  unsigned int cellCount,\n                  unsigned int flags)\n{\n    bool add = !(flags & VIR_NODE_ALLOC_PAGES_SET);\n\n    virCheckFlags(VIR_NODE_ALLOC_PAGES_SET, -1);\n\n    if (virNodeAllocPagesEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemAllocPages(npages, pageSizes, pageCounts,\n                                startCell, cellCount, add);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemAllocPages",
          "args": [
            "npages",
            "pageSizes",
            "pageCounts",
            "startCell",
            "cellCount",
            "add"
          ],
          "line": 5054
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemAllocPages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "871-907",
          "snippet": "int\nvirHostMemAllocPages(unsigned int npages,\n                     unsigned int *pageSizes,\n                     unsigned long long *pageCounts,\n                     int startCell,\n                     unsigned int cellCount,\n                     bool add)\n{\n    int cell, lastCell;\n    size_t i, ncounts = 0;\n\n    if ((lastCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > lastCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, lastCell);\n        return -1;\n    }\n\n    lastCell = MIN(lastCell, startCell + (int) cellCount - 1);\n\n    for (cell = startCell; cell <= lastCell; cell++) {\n        for (i = 0; i < npages; i++) {\n            unsigned int page_size = pageSizes[i];\n            unsigned long long page_count = pageCounts[i];\n\n            if (virNumaSetPagePoolSize(cell, page_size, page_count, add) < 0)\n                return -1;\n\n            ncounts++;\n        }\n    }\n\n    return ncounts;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemAllocPages(unsigned int npages,\n                     unsigned int *pageSizes,\n                     unsigned long long *pageCounts,\n                     int startCell,\n                     unsigned int cellCount,\n                     bool add)\n{\n    int cell, lastCell;\n    size_t i, ncounts = 0;\n\n    if ((lastCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > lastCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, lastCell);\n        return -1;\n    }\n\n    lastCell = MIN(lastCell, startCell + (int) cellCount - 1);\n\n    for (cell = startCell; cell <= lastCell; cell++) {\n        for (i = 0; i < npages; i++) {\n            unsigned int page_size = pageSizes[i];\n            unsigned long long page_count = pageCounts[i];\n\n            if (virNumaSetPagePoolSize(cell, page_size, page_count, add) < 0)\n                return -1;\n\n            ncounts++;\n        }\n    }\n\n    return ncounts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeAllocPagesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 5051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_NODE_ALLOC_PAGES_SET",
            "-1"
          ],
          "line": 5049
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeAllocPages(virConnectPtr conn,\n                  unsigned int npages,\n                  unsigned int *pageSizes,\n                  unsigned long long *pageCounts,\n                  int startCell,\n                  unsigned int cellCount,\n                  unsigned int flags)\n{\n    bool add = !(flags & VIR_NODE_ALLOC_PAGES_SET);\n\n    virCheckFlags(VIR_NODE_ALLOC_PAGES_SET, -1);\n\n    if (virNodeAllocPagesEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemAllocPages(npages, pageSizes, pageCounts,\n                                startCell, cellCount, add);\n}"
  },
  {
    "function_name": "lxcNodeGetFreePages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "5020-5035",
    "snippet": "static int\nlxcNodeGetFreePages(virConnectPtr conn,\n                    unsigned int npages,\n                    unsigned int *pages,\n                    int startCell,\n                    unsigned int cellCount,\n                    unsigned long long *counts,\n                    unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    if (virNodeGetFreePagesEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetFreePages(npages, pages, startCell, cellCount, counts);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetFreePages",
          "args": [
            "npages",
            "pages",
            "startCell",
            "cellCount",
            "counts"
          ],
          "line": 5034
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetFreePages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "828-869",
          "snippet": "int\nvirHostMemGetFreePages(unsigned int npages,\n                       unsigned int *pages,\n                       int startCell,\n                       unsigned int cellCount,\n                       unsigned long long *counts)\n{\n    int cell, lastCell;\n    size_t i, ncounts = 0;\n\n    if ((lastCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > lastCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, lastCell);\n        return -1;\n    }\n\n    lastCell = MIN(lastCell, startCell + (int) cellCount - 1);\n\n    for (cell = startCell; cell <= lastCell; cell++) {\n        for (i = 0; i < npages; i++) {\n            unsigned int page_size = pages[i];\n            unsigned long long page_free;\n\n            if (virNumaGetPageInfo(cell, page_size, 0, NULL, &page_free) < 0)\n                return -1;\n\n            counts[ncounts++] = page_free;\n        }\n    }\n\n    if (!ncounts) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no suitable info found\"));\n        return -1;\n    }\n\n    return ncounts;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetFreePages(unsigned int npages,\n                       unsigned int *pages,\n                       int startCell,\n                       unsigned int cellCount,\n                       unsigned long long *counts)\n{\n    int cell, lastCell;\n    size_t i, ncounts = 0;\n\n    if ((lastCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > lastCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, lastCell);\n        return -1;\n    }\n\n    lastCell = MIN(lastCell, startCell + (int) cellCount - 1);\n\n    for (cell = startCell; cell <= lastCell; cell++) {\n        for (i = 0; i < npages; i++) {\n            unsigned int page_size = pages[i];\n            unsigned long long page_free;\n\n            if (virNumaGetPageInfo(cell, page_size, 0, NULL, &page_free) < 0)\n                return -1;\n\n            counts[ncounts++] = page_free;\n        }\n    }\n\n    if (!ncounts) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no suitable info found\"));\n        return -1;\n    }\n\n    return ncounts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetFreePagesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 5031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 5029
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetFreePages(virConnectPtr conn,\n                    unsigned int npages,\n                    unsigned int *pages,\n                    int startCell,\n                    unsigned int cellCount,\n                    unsigned long long *counts,\n                    unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    if (virNodeGetFreePagesEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetFreePages(npages, pages, startCell, cellCount, counts);\n}"
  },
  {
    "function_name": "lxcDomainGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4942-5017",
    "snippet": "static char *\nlxcDomainGetHostname(virDomainPtr dom,\n                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    g_autoptr(virConnect) conn = NULL;\n    virNetworkDHCPLeasePtr *leases = NULL;\n    int n_leases;\n    size_t i, j;\n    char *hostname = NULL;\n\n    virCheckFlags(VIR_DOMAIN_GET_HOSTNAME_LEASE, NULL);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return NULL;\n\n    if (virDomainGetHostnameEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!(conn = virGetConnectNetwork()))\n        goto endjob;\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        g_autoptr(virNetwork) network = NULL;\n        virDomainNetDefPtr net = vm->def->nets[i];\n\n        if (net->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n            continue;\n\n        virMacAddrFormat(&net->mac, macaddr);\n        network = virNetworkLookupByName(conn, net->data.network.name);\n\n        if (!network)\n            goto endjob;\n\n        if ((n_leases = virNetworkGetDHCPLeases(network, macaddr,\n                                                &leases, 0)) < 0)\n            goto endjob;\n\n        for (j = 0; j < n_leases; j++) {\n            virNetworkDHCPLeasePtr lease = leases[j];\n\n            if (lease->hostname && !hostname)\n                hostname = g_strdup(lease->hostname);\n\n            virNetworkDHCPLeaseFree(lease);\n        }\n\n        VIR_FREE(leases);\n\n        if (hostname)\n            goto endjob;\n    }\n\n    if (!hostname) {\n        virReportError(VIR_ERR_NO_HOSTNAME,\n                       _(\"no hostname found for domain %s\"),\n                       vm->def->name);\n        goto endjob;\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return hostname;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 5015
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 5012
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_HOSTNAME",
            "_(\"no hostname found for domain %s\")",
            "vm->def->name"
          ],
          "line": 5005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no hostname found for domain %s\""
          ],
          "line": 5006
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "leases"
          ],
          "line": 4998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetworkDHCPLeaseFree",
          "args": [
            "lease"
          ],
          "line": 4995
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkDHCPLeaseFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
          "lines": "1239-1251",
          "snippet": "void\nvirNetworkDHCPLeaseFree(virNetworkDHCPLeasePtr lease)\n{\n    if (!lease)\n        return;\n    VIR_FREE(lease->iface);\n    VIR_FREE(lease->mac);\n    VIR_FREE(lease->iaid);\n    VIR_FREE(lease->ipaddr);\n    VIR_FREE(lease->hostname);\n    VIR_FREE(lease->clientid);\n    VIR_FREE(lease);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvoid\nvirNetworkDHCPLeaseFree(virNetworkDHCPLeasePtr lease)\n{\n    if (!lease)\n        return;\n    VIR_FREE(lease->iface);\n    VIR_FREE(lease->mac);\n    VIR_FREE(lease->iaid);\n    VIR_FREE(lease->ipaddr);\n    VIR_FREE(lease->hostname);\n    VIR_FREE(lease->clientid);\n    VIR_FREE(lease);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "lease->hostname"
          ],
          "line": 4993
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkGetDHCPLeases",
          "args": [
            "network",
            "macaddr",
            "&leases",
            "0"
          ],
          "line": 4985
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkGetDHCPLeases",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
          "lines": "1198-1230",
          "snippet": "int\nvirNetworkGetDHCPLeases(virNetworkPtr network,\n                        const char *mac,\n                        virNetworkDHCPLeasePtr **leases,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, mac='%s' leases=%p, flags=0x%x\",\n               network, NULLSTR(mac), leases, flags);\n\n    virResetLastError();\n\n    if (leases)\n        *leases = NULL;\n\n    virCheckNetworkReturn(network, -1);\n\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetDHCPLeases) {\n        int ret;\n        ret = conn->networkDriver->networkGetDHCPLeases(network, mac, leases, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nint\nvirNetworkGetDHCPLeases(virNetworkPtr network,\n                        const char *mac,\n                        virNetworkDHCPLeasePtr **leases,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DEBUG(\"network=%p, mac='%s' leases=%p, flags=0x%x\",\n               network, NULLSTR(mac), leases, flags);\n\n    virResetLastError();\n\n    if (leases)\n        *leases = NULL;\n\n    virCheckNetworkReturn(network, -1);\n\n    conn = network->conn;\n\n    if (conn->networkDriver && conn->networkDriver->networkGetDHCPLeases) {\n        int ret;\n        ret = conn->networkDriver->networkGetDHCPLeases(network, mac, leases, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(network->conn);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetworkLookupByName",
          "args": [
            "conn",
            "net->data.network.name"
          ],
          "line": 4980
        },
        "resolved": true,
        "details": {
          "function_name": "virNetworkLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-network.c",
          "lines": "287-310",
          "snippet": "virNetworkPtr\nvirNetworkLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkLookupByName) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <config.h>\n\nvirNetworkPtr\nvirNetworkLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->networkDriver && conn->networkDriver->networkLookupByName) {\n        virNetworkPtr ret;\n        ret = conn->networkDriver->networkLookupByName(conn, name);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&net->mac",
            "macaddr"
          ],
          "line": 4979
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetConnectNetwork",
          "args": [],
          "line": 4969
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "169-172",
          "snippet": "virConnectPtr virGetConnectNetwork(void)\n{\n    return virGetConnectGeneric(&connectNetwork, \"network\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNetwork;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNetwork;\n\nvirConnectPtr virGetConnectNetwork(void)\n{\n    return virGetConnectGeneric(&connectNetwork, \"network\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 4966
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_QUERY"
          ],
          "line": 4963
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetHostnameEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 4960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4957
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_GET_HOSTNAME_LEASE",
            "NULL"
          ],
          "line": 4955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nlxcDomainGetHostname(virDomainPtr dom,\n                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    g_autoptr(virConnect) conn = NULL;\n    virNetworkDHCPLeasePtr *leases = NULL;\n    int n_leases;\n    size_t i, j;\n    char *hostname = NULL;\n\n    virCheckFlags(VIR_DOMAIN_GET_HOSTNAME_LEASE, NULL);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return NULL;\n\n    if (virDomainGetHostnameEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!(conn = virGetConnectNetwork()))\n        goto endjob;\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        g_autoptr(virNetwork) network = NULL;\n        virDomainNetDefPtr net = vm->def->nets[i];\n\n        if (net->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n            continue;\n\n        virMacAddrFormat(&net->mac, macaddr);\n        network = virNetworkLookupByName(conn, net->data.network.name);\n\n        if (!network)\n            goto endjob;\n\n        if ((n_leases = virNetworkGetDHCPLeases(network, macaddr,\n                                                &leases, 0)) < 0)\n            goto endjob;\n\n        for (j = 0; j < n_leases; j++) {\n            virNetworkDHCPLeasePtr lease = leases[j];\n\n            if (lease->hostname && !hostname)\n                hostname = g_strdup(lease->hostname);\n\n            virNetworkDHCPLeaseFree(lease);\n        }\n\n        VIR_FREE(leases);\n\n        if (hostname)\n            goto endjob;\n    }\n\n    if (!hostname) {\n        virReportError(VIR_ERR_NO_HOSTNAME,\n                       _(\"no hostname found for domain %s\"),\n                       vm->def->name);\n        goto endjob;\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return hostname;\n}"
  },
  {
    "function_name": "lxcDomainGetCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4899-4939",
    "snippet": "static int\nlxcDomainGetCPUStats(virDomainPtr dom,\n                     virTypedParameterPtr params,\n                     unsigned int nparams,\n                     int start_cpu,\n                     unsigned int ncpus,\n                     unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    priv = vm->privateData;\n\n    if (virDomainGetCPUStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUACCT)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPUACCT controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (start_cpu == -1)\n        ret = virCgroupGetDomainTotalCpuStats(priv->cgroup,\n                                              params, nparams);\n    else\n        ret = virCgroupGetPercpuStats(priv->cgroup, params,\n                                      nparams, start_cpu, ncpus, NULL);\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4937
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetPercpuStats",
          "args": [
            "priv->cgroup",
            "params",
            "nparams",
            "start_cpu",
            "ncpus",
            "NULL"
          ],
          "line": 4934
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetPercpuStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3497-3508",
          "snippet": "int\nvirCgroupGetPercpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                        virTypedParameterPtr params G_GNUC_UNUSED,\n                        unsigned int nparams G_GNUC_UNUSED,\n                        int start_cpu G_GNUC_UNUSED,\n                        unsigned int ncpus G_GNUC_UNUSED,\n                        virBitmapPtr guestvcpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetPercpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                        virTypedParameterPtr params G_GNUC_UNUSED,\n                        unsigned int nparams G_GNUC_UNUSED,\n                        int start_cpu G_GNUC_UNUSED,\n                        unsigned int ncpus G_GNUC_UNUSED,\n                        virBitmapPtr guestvcpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetDomainTotalCpuStats",
          "args": [
            "priv->cgroup",
            "params",
            "nparams"
          ],
          "line": 4931
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetDomainTotalCpuStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3447-3455",
          "snippet": "int\nvirCgroupGetDomainTotalCpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                                virTypedParameterPtr params G_GNUC_UNUSED,\n                                int nparams G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetDomainTotalCpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                                virTypedParameterPtr params G_GNUC_UNUSED,\n                                int nparams G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cgroup CPUACCT controller is not mounted\")"
          ],
          "line": 4925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup CPUACCT controller is not mounted\""
          ],
          "line": 4926
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPUACCT"
          ],
          "line": 4924
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 4921
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetCPUStatsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 4918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4913
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_TYPED_PARAM_STRING_OKAY",
            "-1"
          ],
          "line": 4911
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainGetCPUStats(virDomainPtr dom,\n                     virTypedParameterPtr params,\n                     unsigned int nparams,\n                     int start_cpu,\n                     unsigned int ncpus,\n                     unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    priv = vm->privateData;\n\n    if (virDomainGetCPUStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPUACCT)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPUACCT controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (start_cpu == -1)\n        ret = virCgroupGetDomainTotalCpuStats(priv->cgroup,\n                                              params, nparams);\n    else\n        ret = virCgroupGetPercpuStats(priv->cgroup, params,\n                                      nparams, start_cpu, ncpus, NULL);\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4876-4896",
    "snippet": "static char *\nlxcDomainGetMetadata(virDomainPtr dom,\n                      int type,\n                      const char *uri,\n                      unsigned int flags)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return NULL;\n\n    if (virDomainGetMetadataEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjGetMetadata(vm, type, uri, flags);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4894
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetMetadata",
          "args": [
            "vm",
            "type",
            "uri",
            "flags"
          ],
          "line": 4891
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetMetadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30667-30715",
          "snippet": "char *\nvirDomainObjGetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *uri,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, NULL);\n\n    if (type >= VIR_DOMAIN_METADATA_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown metadata type '%d'\"), type);\n        return NULL;\n    }\n\n    if (!(def = virDomainObjGetOneDef(vm, flags)))\n        return NULL;\n\n    switch ((virDomainMetadataType) type) {\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        ret = g_strdup(def->description);\n        break;\n\n    case VIR_DOMAIN_METADATA_TITLE:\n        ret = g_strdup(def->title);\n        break;\n\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        if (!def->metadata)\n            break;\n\n        if (virXMLExtractNamespaceXML(def->metadata, uri, &ret) < 0)\n            return NULL;\n        break;\n\n    /* coverity[dead_error_begin] */\n    case VIR_DOMAIN_METADATA_LAST:\n        break;\n    }\n\n    if (!ret)\n        virReportError(VIR_ERR_NO_DOMAIN_METADATA, \"%s\",\n                       _(\"Requested metadata element is not present\"));\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar *\nvirDomainObjGetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *uri,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, NULL);\n\n    if (type >= VIR_DOMAIN_METADATA_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unknown metadata type '%d'\"), type);\n        return NULL;\n    }\n\n    if (!(def = virDomainObjGetOneDef(vm, flags)))\n        return NULL;\n\n    switch ((virDomainMetadataType) type) {\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        ret = g_strdup(def->description);\n        break;\n\n    case VIR_DOMAIN_METADATA_TITLE:\n        ret = g_strdup(def->title);\n        break;\n\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        if (!def->metadata)\n            break;\n\n        if (virXMLExtractNamespaceXML(def->metadata, uri, &ret) < 0)\n            return NULL;\n        break;\n\n    /* coverity[dead_error_begin] */\n    case VIR_DOMAIN_METADATA_LAST:\n        break;\n    }\n\n    if (!ret)\n        virReportError(VIR_ERR_NO_DOMAIN_METADATA, \"%s\",\n                       _(\"Requested metadata element is not present\"));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetMetadataEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 4888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4885
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nlxcDomainGetMetadata(virDomainPtr dom,\n                      int type,\n                      const char *uri,\n                      unsigned int flags)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return NULL;\n\n    if (virDomainGetMetadataEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjGetMetadata(vm, type, uri, flags);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSetMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4830-4873",
    "snippet": "static int\nlxcDomainSetMetadata(virDomainPtr dom,\n                      int type,\n                      const char *metadata,\n                      const char *key,\n                      const char *uri,\n                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virLXCDriverConfigPtr cfg = NULL;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return -1;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    if (virDomainSetMetadataEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    ret = virDomainObjSetMetadata(vm, type, metadata, key, uri,\n                                  driver->xmlopt, cfg->stateDir,\n                                  cfg->configDir, flags);\n\n    if (ret == 0) {\n        virObjectEventPtr ev = NULL;\n        ev = virDomainEventMetadataChangeNewFromObj(vm, type, uri);\n        virObjectEventStateQueue(driver->domainEventState, ev);\n    }\n\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 4871
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4870
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 4867
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "ev"
          ],
          "line": 4864
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventMetadataChangeNewFromObj",
          "args": [
            "vm",
            "type",
            "uri"
          ],
          "line": 4863
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventMetadataChangeNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "1552-1559",
          "snippet": "virObjectEventPtr\nvirDomainEventMetadataChangeNewFromObj(virDomainObjPtr obj,\n                                       int type,\n                                       const char *nsuri)\n{\n    return virDomainEventMetadataChangeNew(obj->def->id, obj->def->name,\n                                           obj->def->uuid, type, nsuri);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventMetadataChangeNewFromObj(virDomainObjPtr obj,\n                                       int type,\n                                       const char *nsuri)\n{\n    return virDomainEventMetadataChangeNew(obj->def->id, obj->def->name,\n                                           obj->def->uuid, type, nsuri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetMetadata",
          "args": [
            "vm",
            "type",
            "metadata",
            "key",
            "uri",
            "driver->xmlopt",
            "cfg->stateDir",
            "cfg->configDir",
            "flags"
          ],
          "line": 4857
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetMetadata",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30803-30841",
          "snippet": "int\nvirDomainObjSetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *metadata,\n                        const char *key,\n                        const char *uri,\n                        virDomainXMLOptionPtr xmlopt,\n                        const char *stateDir,\n                        const char *configDir,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        return -1;\n\n    if (def) {\n        if (virDomainDefSetMetadata(def, type, metadata, key, uri) < 0)\n            return -1;\n\n        if (virDomainObjSave(vm, xmlopt, stateDir) < 0)\n            return -1;\n    }\n\n    if (persistentDef) {\n        if (virDomainDefSetMetadata(persistentDef, type, metadata, key,\n                                    uri) < 0)\n            return -1;\n\n        if (virDomainDefSave(persistentDef, xmlopt, configDir) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjSetMetadata(virDomainObjPtr vm,\n                        int type,\n                        const char *metadata,\n                        const char *key,\n                        const char *uri,\n                        virDomainXMLOptionPtr xmlopt,\n                        const char *stateDir,\n                        const char *configDir,\n                        unsigned int flags)\n{\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        return -1;\n\n    if (def) {\n        if (virDomainDefSetMetadata(def, type, metadata, key, uri) < 0)\n            return -1;\n\n        if (virDomainObjSave(vm, xmlopt, stateDir) < 0)\n            return -1;\n    }\n\n    if (persistentDef) {\n        if (virDomainDefSetMetadata(persistentDef, type, metadata, key,\n                                    uri) < 0)\n            return -1;\n\n        if (virDomainDefSave(persistentDef, xmlopt, configDir) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 4854
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetMetadataEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 4851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 4849
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4846
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 4843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSetMetadata(virDomainPtr dom,\n                      int type,\n                      const char *metadata,\n                      const char *key,\n                      const char *uri,\n                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virLXCDriverConfigPtr cfg = NULL;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return -1;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    if (virDomainSetMetadataEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    ret = virDomainObjSetMetadata(vm, type, metadata, key, uri,\n                                  driver->xmlopt, cfg->stateDir,\n                                  cfg->configDir, flags);\n\n    if (ret == 0) {\n        virObjectEventPtr ev = NULL;\n        ev = virDomainEventMetadataChangeNewFromObj(vm, type, uri);\n        virObjectEventStateQueue(driver->domainEventState, ev);\n    }\n\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcNodeSuspendForDuration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4817-4827",
    "snippet": "static int\nlxcNodeSuspendForDuration(virConnectPtr conn,\n                          unsigned int target,\n                          unsigned long long duration,\n                          unsigned int flags)\n{\n    if (virNodeSuspendForDurationEnsureACL(conn) < 0)\n        return -1;\n\n    return virNodeSuspend(target, duration, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNodeSuspend",
          "args": [
            "target",
            "duration",
            "flags"
          ],
          "line": 4826
        },
        "resolved": true,
        "details": {
          "function_name": "virNodeSuspend",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnodesuspend.c",
          "lines": "161-238",
          "snippet": "int virNodeSuspend(unsigned int target,\n                   unsigned long long duration,\n                   unsigned int flags)\n{\n    static virThread thread;\n    const char *cmdString = NULL;\n    int ret = -1;\n    unsigned int supported;\n\n    virCheckFlags(0, -1);\n\n    if (virNodeSuspendGetTargetMask(&supported) < 0)\n        return -1;\n\n    /*\n     * Ensure that we are the only ones trying to suspend.\n     * Fail if somebody has already initiated a suspend.\n     */\n    virNodeSuspendLock();\n\n    if (aboutToSuspend) {\n        /* A suspend operation is already in progress */\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Suspend operation already in progress\"));\n        goto cleanup;\n    }\n\n    /* Check if the host supports the requested suspend target */\n    switch (target) {\n    case VIR_NODE_SUSPEND_TARGET_MEM:\n        if (!(supported & (1 << VIR_NODE_SUSPEND_TARGET_MEM))) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\", _(\"Suspend-to-RAM\"));\n            goto cleanup;\n        }\n        cmdString = \"pm-suspend\";\n        break;\n\n    case VIR_NODE_SUSPEND_TARGET_DISK:\n        if (!(supported & (1 << VIR_NODE_SUSPEND_TARGET_DISK))) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\", _(\"Suspend-to-Disk\"));\n            goto cleanup;\n        }\n        cmdString = \"pm-hibernate\";\n        break;\n\n    case VIR_NODE_SUSPEND_TARGET_HYBRID:\n        if (!(supported & (1 << VIR_NODE_SUSPEND_TARGET_HYBRID))) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\", _(\"Hybrid-Suspend\"));\n            goto cleanup;\n        }\n        cmdString = \"pm-suspend-hybrid\";\n        break;\n\n    default:\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"Invalid suspend target\"));\n        goto cleanup;\n    }\n\n    /* Just set the RTC alarm. Don't suspend yet. */\n    if (virNodeSuspendSetNodeWakeup(duration) < 0)\n        goto cleanup;\n\n    if (virThreadCreateFull(&thread, false,\n                            virNodeSuspendHelper,\n                            \"node-suspend\",\n                            false,\n                            (void *)cmdString) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to create thread to suspend the host\"));\n        goto cleanup;\n    }\n\n    aboutToSuspend = true;\n    ret = 0;\n cleanup:\n    virNodeSuspendUnlock();\n    return ret;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virthread.h\"",
            "#include \"vircommand.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virnodesuspend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool aboutToSuspend;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virthread.h\"\n#include \"vircommand.h\"\n#include \"virsystemd.h\"\n#include \"virnodesuspend.h\"\n#include <config.h>\n\nstatic bool aboutToSuspend;\n\nint virNodeSuspend(unsigned int target,\n                   unsigned long long duration,\n                   unsigned int flags)\n{\n    static virThread thread;\n    const char *cmdString = NULL;\n    int ret = -1;\n    unsigned int supported;\n\n    virCheckFlags(0, -1);\n\n    if (virNodeSuspendGetTargetMask(&supported) < 0)\n        return -1;\n\n    /*\n     * Ensure that we are the only ones trying to suspend.\n     * Fail if somebody has already initiated a suspend.\n     */\n    virNodeSuspendLock();\n\n    if (aboutToSuspend) {\n        /* A suspend operation is already in progress */\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Suspend operation already in progress\"));\n        goto cleanup;\n    }\n\n    /* Check if the host supports the requested suspend target */\n    switch (target) {\n    case VIR_NODE_SUSPEND_TARGET_MEM:\n        if (!(supported & (1 << VIR_NODE_SUSPEND_TARGET_MEM))) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\", _(\"Suspend-to-RAM\"));\n            goto cleanup;\n        }\n        cmdString = \"pm-suspend\";\n        break;\n\n    case VIR_NODE_SUSPEND_TARGET_DISK:\n        if (!(supported & (1 << VIR_NODE_SUSPEND_TARGET_DISK))) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\", _(\"Suspend-to-Disk\"));\n            goto cleanup;\n        }\n        cmdString = \"pm-hibernate\";\n        break;\n\n    case VIR_NODE_SUSPEND_TARGET_HYBRID:\n        if (!(supported & (1 << VIR_NODE_SUSPEND_TARGET_HYBRID))) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\", _(\"Hybrid-Suspend\"));\n            goto cleanup;\n        }\n        cmdString = \"pm-suspend-hybrid\";\n        break;\n\n    default:\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"Invalid suspend target\"));\n        goto cleanup;\n    }\n\n    /* Just set the RTC alarm. Don't suspend yet. */\n    if (virNodeSuspendSetNodeWakeup(duration) < 0)\n        goto cleanup;\n\n    if (virThreadCreateFull(&thread, false,\n                            virNodeSuspendHelper,\n                            \"node-suspend\",\n                            false,\n                            (void *)cmdString) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to create thread to suspend the host\"));\n        goto cleanup;\n    }\n\n    aboutToSuspend = true;\n    ret = 0;\n cleanup:\n    virNodeSuspendUnlock();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeSuspendForDurationEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeSuspendForDuration(virConnectPtr conn,\n                          unsigned int target,\n                          unsigned long long duration,\n                          unsigned int flags)\n{\n    if (virNodeSuspendForDurationEnsureACL(conn) < 0)\n        return -1;\n\n    return virNodeSuspend(target, duration, flags);\n}"
  },
  {
    "function_name": "lxcNodeGetCPUMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4804-4814",
    "snippet": "static int\nlxcNodeGetCPUMap(virConnectPtr conn,\n                 unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    if (virNodeGetCPUMapEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetMap(cpumap, online, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetMap",
          "args": [
            "cpumap",
            "online",
            "flags"
          ],
          "line": 4813
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1087-1116",
          "snippet": "int\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetMap(unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    virBitmapPtr cpus = NULL;\n    int ret = -1;\n    int dummy;\n\n    virCheckFlags(0, -1);\n\n    if (!cpumap && !online)\n        return virHostCPUGetCount();\n\n    if (!(cpus = virHostCPUGetOnlineBitmap()))\n        goto cleanup;\n\n    if (cpumap && virBitmapToData(cpus, cpumap, &dummy) < 0)\n        goto cleanup;\n    if (online)\n        *online = virBitmapCountBits(cpus);\n\n    ret = virHostCPUGetCount();\n\n cleanup:\n    if (ret < 0 && cpumap)\n        VIR_FREE(*cpumap);\n    virBitmapFree(cpus);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCPUMapEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4810
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetCPUMap(virConnectPtr conn,\n                 unsigned char **cpumap,\n                 unsigned int *online,\n                 unsigned int flags)\n{\n    if (virNodeGetCPUMapEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetMap(cpumap, online, flags);\n}"
  },
  {
    "function_name": "lxcNodeSetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4791-4801",
    "snippet": "static int\nlxcNodeSetMemoryParameters(virConnectPtr conn,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    if (virNodeSetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemSetParameters(params, nparams, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemSetParameters",
          "args": [
            "params",
            "nparams",
            "flags"
          ],
          "line": 4800
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemSetParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "355-393",
          "snippet": "int\nvirHostMemSetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    size_t i;\n    int rc;\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if (!virHostMemParametersAreAllSupported(params, nparams))\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        rc = virHostMemSetParameterValue(&params[i]);\n\n        if (rc < 0)\n            return -1;\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node set memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemSetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    size_t i;\n    int rc;\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                               VIR_TYPED_PARAM_UINT,\n                               NULL) < 0)\n        return -1;\n\n    if (!virHostMemParametersAreAllSupported(params, nparams))\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        rc = virHostMemSetParameterValue(&params[i]);\n\n        if (rc < 0)\n            return -1;\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node set memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeSetMemoryParametersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeSetMemoryParameters(virConnectPtr conn,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    if (virNodeSetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemSetParameters(params, nparams, flags);\n}"
  },
  {
    "function_name": "lxcNodeGetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4778-4788",
    "snippet": "static int\nlxcNodeGetMemoryParameters(virConnectPtr conn,\n                           virTypedParameterPtr params,\n                           int *nparams,\n                           unsigned int flags)\n{\n    if (virNodeGetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetParameters(params, nparams, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetParameters",
          "args": [
            "params",
            "nparams",
            "flags"
          ],
          "line": 4787
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "438-579",
          "snippet": "int\nvirHostMemGetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int *nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n#ifdef __linux__\n    unsigned int pages_to_scan;\n    unsigned int sleep_millisecs;\n    unsigned int merge_across_nodes;\n    unsigned long long pages_shared;\n    unsigned long long pages_sharing;\n    unsigned long long pages_unshared;\n    unsigned long long pages_volatile;\n    unsigned long long full_scans = 0;\n    size_t i;\n    int ret;\n\n    if ((*nparams) == 0) {\n        *nparams = NODE_MEMORY_PARAMETERS_NUM;\n        return 0;\n    }\n\n    for (i = 0; i < *nparams && i < NODE_MEMORY_PARAMETERS_NUM; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        switch (i) {\n        case 0:\n            ret = virHostMemGetParameterValue(\"pages_to_scan\", &pages_to_scan);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                                        VIR_TYPED_PARAM_UINT, pages_to_scan) < 0)\n                return -1;\n\n            break;\n\n        case 1:\n            ret = virHostMemGetParameterValue(\"sleep_millisecs\", &sleep_millisecs);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                                        VIR_TYPED_PARAM_UINT, sleep_millisecs) < 0)\n                return -1;\n\n            break;\n\n        case 2:\n            ret = virHostMemGetParameterValue(\"pages_shared\", &pages_shared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_shared) < 0)\n                return -1;\n\n            break;\n\n        case 3:\n            ret = virHostMemGetParameterValue(\"pages_sharing\", &pages_sharing);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARING,\n                                        VIR_TYPED_PARAM_ULLONG, pages_sharing) < 0)\n                return -1;\n\n            break;\n\n        case 4:\n            ret = virHostMemGetParameterValue(\"pages_unshared\", &pages_unshared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_UNSHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_unshared) < 0)\n                return -1;\n\n            break;\n\n        case 5:\n            ret = virHostMemGetParameterValue(\"pages_volatile\", &pages_volatile);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_VOLATILE,\n                                        VIR_TYPED_PARAM_ULLONG, pages_volatile) < 0)\n                return -1;\n\n            break;\n\n        case 6:\n            ret = virHostMemGetParameterValue(\"full_scans\", &full_scans);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_FULL_SCANS,\n                                        VIR_TYPED_PARAM_ULLONG, full_scans) < 0)\n                return -1;\n\n            break;\n\n        case 7:\n            ret = virHostMemGetParameterValue(\"merge_across_nodes\", &merge_across_nodes);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                                        VIR_TYPED_PARAM_UINT, merge_across_nodes) < 0)\n                return -1;\n\n            break;\n        }\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node get memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define NODE_MEMORY_PARAMETERS_NUM 8"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define NODE_MEMORY_PARAMETERS_NUM 8\n\nint\nvirHostMemGetParameters(virTypedParameterPtr params G_GNUC_UNUSED,\n                        int *nparams G_GNUC_UNUSED,\n                        unsigned int flags)\n{\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n#ifdef __linux__\n    unsigned int pages_to_scan;\n    unsigned int sleep_millisecs;\n    unsigned int merge_across_nodes;\n    unsigned long long pages_shared;\n    unsigned long long pages_sharing;\n    unsigned long long pages_unshared;\n    unsigned long long pages_volatile;\n    unsigned long long full_scans = 0;\n    size_t i;\n    int ret;\n\n    if ((*nparams) == 0) {\n        *nparams = NODE_MEMORY_PARAMETERS_NUM;\n        return 0;\n    }\n\n    for (i = 0; i < *nparams && i < NODE_MEMORY_PARAMETERS_NUM; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        switch (i) {\n        case 0:\n            ret = virHostMemGetParameterValue(\"pages_to_scan\", &pages_to_scan);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_TO_SCAN,\n                                        VIR_TYPED_PARAM_UINT, pages_to_scan) < 0)\n                return -1;\n\n            break;\n\n        case 1:\n            ret = virHostMemGetParameterValue(\"sleep_millisecs\", &sleep_millisecs);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_SLEEP_MILLISECS,\n                                        VIR_TYPED_PARAM_UINT, sleep_millisecs) < 0)\n                return -1;\n\n            break;\n\n        case 2:\n            ret = virHostMemGetParameterValue(\"pages_shared\", &pages_shared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_shared) < 0)\n                return -1;\n\n            break;\n\n        case 3:\n            ret = virHostMemGetParameterValue(\"pages_sharing\", &pages_sharing);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_SHARING,\n                                        VIR_TYPED_PARAM_ULLONG, pages_sharing) < 0)\n                return -1;\n\n            break;\n\n        case 4:\n            ret = virHostMemGetParameterValue(\"pages_unshared\", &pages_unshared);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_UNSHARED,\n                                        VIR_TYPED_PARAM_ULLONG, pages_unshared) < 0)\n                return -1;\n\n            break;\n\n        case 5:\n            ret = virHostMemGetParameterValue(\"pages_volatile\", &pages_volatile);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_PAGES_VOLATILE,\n                                        VIR_TYPED_PARAM_ULLONG, pages_volatile) < 0)\n                return -1;\n\n            break;\n\n        case 6:\n            ret = virHostMemGetParameterValue(\"full_scans\", &full_scans);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_FULL_SCANS,\n                                        VIR_TYPED_PARAM_ULLONG, full_scans) < 0)\n                return -1;\n\n            break;\n\n        case 7:\n            ret = virHostMemGetParameterValue(\"merge_across_nodes\", &merge_across_nodes);\n            if (ret == -2)\n                continue;\n            else if (ret == -1)\n                return -1;\n\n            if (virTypedParameterAssign(param, VIR_NODE_MEMORY_SHARED_MERGE_ACROSS_NODES,\n                                        VIR_TYPED_PARAM_UINT, merge_across_nodes) < 0)\n                return -1;\n\n            break;\n        }\n    }\n\n    return 0;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node get memory parameters not implemented\"\n                     \" on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetMemoryParametersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4784
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetMemoryParameters(virConnectPtr conn,\n                           virTypedParameterPtr params,\n                           int *nparams,\n                           unsigned int flags)\n{\n    if (virNodeGetMemoryParametersEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetParameters(params, nparams, flags);\n}"
  },
  {
    "function_name": "lxcNodeGetFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4763-4775",
    "snippet": "static unsigned long long\nlxcNodeGetFreeMemory(virConnectPtr conn)\n{\n    unsigned long long freeMem;\n\n    if (virNodeGetFreeMemoryEnsureACL(conn) < 0)\n        return 0;\n\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n\n    return freeMem;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetInfo",
          "args": [
            "NULL",
            "&freeMem"
          ],
          "line": 4771
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "790-826",
          "snippet": "int\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetInfo(unsigned long long *mem,\n                  unsigned long long *freeMem)\n{\n    int max_node;\n    int n;\n\n    if (mem)\n        *mem = 0;\n\n    if (freeMem)\n        *freeMem = 0;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetInfoFake(mem, freeMem);\n\n    if ((max_node = virNumaGetMaxNode()) < 0)\n        return -1;\n\n    for (n = 0; n <= max_node; n++) {\n        unsigned long long tmp_mem = 0, tmp_freeMem = 0;\n\n        if (!virNumaNodeIsAvailable(n))\n            continue;\n\n        if (virNumaGetNodeMemory(n, &tmp_mem, &tmp_freeMem) < 0)\n            return -1;\n\n        if (mem)\n            *mem += tmp_mem;\n\n        if (freeMem)\n            *freeMem += tmp_freeMem;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetFreeMemoryEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4768
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned long long\nlxcNodeGetFreeMemory(virConnectPtr conn)\n{\n    unsigned long long freeMem;\n\n    if (virNodeGetFreeMemoryEnsureACL(conn) < 0)\n        return 0;\n\n    if (virHostMemGetInfo(NULL, &freeMem) < 0)\n        return 0;\n\n    return freeMem;\n}"
  },
  {
    "function_name": "lxcNodeGetCellsFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4750-4760",
    "snippet": "static int\nlxcNodeGetCellsFreeMemory(virConnectPtr conn,\n                          unsigned long long *freeMems,\n                          int startCell,\n                          int maxCells)\n{\n    if (virNodeGetCellsFreeMemoryEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetCellsFree(freeMems, startCell, maxCells);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetCellsFree",
          "args": [
            "freeMems",
            "startCell",
            "maxCells"
          ],
          "line": 4759
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetCellsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "756-788",
          "snippet": "int\nvirHostMemGetCellsFree(unsigned long long *freeMems,\n                       int startCell,\n                       int maxCells)\n{\n    unsigned long long mem;\n    int n, lastCell, numCells;\n    int maxCell;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetCellsFreeFake(freeMems,\n                                          startCell, maxCells);\n\n    if ((maxCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > maxCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, maxCell);\n        return -1;\n    }\n    lastCell = startCell + maxCells - 1;\n    if (lastCell > maxCell)\n        lastCell = maxCell;\n\n    for (numCells = 0, n = startCell; n <= lastCell; n++) {\n        virNumaGetNodeMemory(n, NULL, &mem);\n\n        freeMems[numCells++] = mem;\n    }\n    return numCells;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetCellsFree(unsigned long long *freeMems,\n                       int startCell,\n                       int maxCells)\n{\n    unsigned long long mem;\n    int n, lastCell, numCells;\n    int maxCell;\n\n    if (!virNumaIsAvailable())\n        return virHostMemGetCellsFreeFake(freeMems,\n                                          startCell, maxCells);\n\n    if ((maxCell = virNumaGetMaxNode()) < 0)\n        return 0;\n\n    if (startCell > maxCell) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"start cell %d out of range (0-%d)\"),\n                       startCell, maxCell);\n        return -1;\n    }\n    lastCell = startCell + maxCells - 1;\n    if (lastCell > maxCell)\n        lastCell = maxCell;\n\n    for (numCells = 0, n = startCell; n <= lastCell; n++) {\n        virNumaGetNodeMemory(n, NULL, &mem);\n\n        freeMems[numCells++] = mem;\n    }\n    return numCells;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCellsFreeMemoryEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4756
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetCellsFreeMemory(virConnectPtr conn,\n                          unsigned long long *freeMems,\n                          int startCell,\n                          int maxCells)\n{\n    if (virNodeGetCellsFreeMemoryEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetCellsFree(freeMems, startCell, maxCells);\n}"
  },
  {
    "function_name": "lxcNodeGetMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4736-4747",
    "snippet": "static int\nlxcNodeGetMemoryStats(virConnectPtr conn,\n                      int cellNum,\n                      virNodeMemoryStatsPtr params,\n                      int *nparams,\n                      unsigned int flags)\n{\n    if (virNodeGetMemoryStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostMemGetStats",
          "args": [
            "cellNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 4746
        },
        "resolved": true,
        "details": {
          "function_name": "virHostMemGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostmem.c",
          "lines": "244-302",
          "snippet": "int\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostmem.h\"",
            "#include \"viralloc.h\"",
            "# include <windows.h>",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostmem.h\"\n#include \"viralloc.h\"\n# include <windows.h>\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirHostMemGetStats(int cellNum G_GNUC_UNUSED,\n                   virNodeMemoryStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        g_autofree char *meminfo_path = NULL;\n        FILE *meminfo;\n        int max_node;\n\n        /*\n         * Even if built without numactl, libvirt claims\n         * to have a one-cells NUMA topology. In such a\n         * case return the statistics for the entire host.\n         */\n        if (!virNumaIsAvailable() && cellNum == 0)\n            cellNum = VIR_NODE_MEMORY_STATS_ALL_CELLS;\n\n        if (cellNum == VIR_NODE_MEMORY_STATS_ALL_CELLS) {\n            meminfo_path = g_strdup(MEMINFO_PATH);\n        } else {\n            if ((max_node = virNumaGetMaxNode()) < 0)\n                return -1;\n\n            if (cellNum > max_node) {\n                virReportInvalidArg(cellNum,\n                                    _(\"cellNum in %s must be less than or equal to %d\"),\n                                    __FUNCTION__, max_node);\n                return -1;\n            }\n\n            meminfo_path = g_strdup_printf(\n                                           SYSFS_SYSTEM_PATH \"/node/node%d/meminfo\", cellNum);\n        }\n        meminfo = fopen(meminfo_path, \"r\");\n\n        if (!meminfo) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), meminfo_path);\n            return -1;\n        }\n        ret = virHostMemGetStatsLinux(meminfo, cellNum, params, nparams);\n        VIR_FORCE_FCLOSE(meminfo);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostMemGetStatsFreeBSD(params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node memory stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetMemoryStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetMemoryStats(virConnectPtr conn,\n                      int cellNum,\n                      virNodeMemoryStatsPtr params,\n                      int *nparams,\n                      unsigned int flags)\n{\n    if (virNodeGetMemoryStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostMemGetStats(cellNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "lxcNodeGetCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4722-4733",
    "snippet": "static int\nlxcNodeGetCPUStats(virConnectPtr conn,\n                   int cpuNum,\n                   virNodeCPUStatsPtr params,\n                   int *nparams,\n                   unsigned int flags)\n{\n    if (virNodeGetCPUStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostCPUGetStats",
          "args": [
            "cpuNum",
            "params",
            "nparams",
            "flags"
          ],
          "line": 4732
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "998-1027",
          "snippet": "int\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetStats(int cpuNum G_GNUC_UNUSED,\n                   virNodeCPUStatsPtr params G_GNUC_UNUSED,\n                   int *nparams G_GNUC_UNUSED,\n                   unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n#ifdef __linux__\n    {\n        int ret;\n        FILE *procstat = fopen(PROCSTAT_PATH, \"r\");\n        if (!procstat) {\n            virReportSystemError(errno,\n                                 _(\"cannot open %s\"), PROCSTAT_PATH);\n            return -1;\n        }\n        ret = virHostCPUGetStatsLinux(procstat, cpuNum, params, nparams);\n        VIR_FORCE_FCLOSE(procstat);\n\n        return ret;\n    }\n#elif defined(__FreeBSD__)\n    return virHostCPUGetStatsFreeBSD(cpuNum, params, nparams);\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node CPU stats not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetCPUStatsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetCPUStats(virConnectPtr conn,\n                   int cpuNum,\n                   virNodeCPUStatsPtr params,\n                   int *nparams,\n                   unsigned int flags)\n{\n    if (virNodeGetCPUStatsEnsureACL(conn) < 0)\n        return -1;\n\n    return virHostCPUGetStats(cpuNum, params, nparams, flags);\n}"
  },
  {
    "function_name": "lxcDomainMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4661-4719",
    "snippet": "static int\nlxcDomainMemoryStats(virDomainPtr dom,\n                     virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats,\n                     unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    unsigned long long swap_usage;\n    unsigned long mem_usage;\n    virLXCDriverPtr driver = dom->conn->privateData;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainMemoryStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (virCgroupGetMemSwapUsage(priv->cgroup, &swap_usage) < 0)\n        goto endjob;\n\n    if (virCgroupGetMemoryUsage(priv->cgroup, &mem_usage) < 0)\n        goto endjob;\n\n    ret = 0;\n    if (ret < nr_stats) {\n        stats[ret].tag = VIR_DOMAIN_MEMORY_STAT_ACTUAL_BALLOON;\n        stats[ret].val = vm->def->mem.cur_balloon;\n        ret++;\n    }\n    if (ret < nr_stats) {\n        stats[ret].tag = VIR_DOMAIN_MEMORY_STAT_SWAP_IN;\n        stats[ret].val = swap_usage;\n        ret++;\n    }\n    if (ret < nr_stats) {\n        stats[ret].tag = VIR_DOMAIN_MEMORY_STAT_RSS;\n        stats[ret].val = mem_usage;\n        ret++;\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4717
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 4714
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetMemoryUsage",
          "args": [
            "priv->cgroup",
            "&mem_usage"
          ],
          "line": 4693
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemoryUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3121-3128",
          "snippet": "int\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetMemSwapUsage",
          "args": [
            "priv->cgroup",
            "&swap_usage"
          ],
          "line": 4690
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemSwapUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3191-3198",
          "snippet": "int\nvirCgroupGetMemSwapUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 4687
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_QUERY"
          ],
          "line": 4684
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMemoryStatsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 4681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4676
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 4674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainMemoryStats(virDomainPtr dom,\n                     virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats,\n                     unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    unsigned long long swap_usage;\n    unsigned long mem_usage;\n    virLXCDriverPtr driver = dom->conn->privateData;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainMemoryStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (virCgroupGetMemSwapUsage(priv->cgroup, &swap_usage) < 0)\n        goto endjob;\n\n    if (virCgroupGetMemoryUsage(priv->cgroup, &mem_usage) < 0)\n        goto endjob;\n\n    ret = 0;\n    if (ret < nr_stats) {\n        stats[ret].tag = VIR_DOMAIN_MEMORY_STAT_ACTUAL_BALLOON;\n        stats[ret].val = vm->def->mem.cur_balloon;\n        ret++;\n    }\n    if (ret < nr_stats) {\n        stats[ret].tag = VIR_DOMAIN_MEMORY_STAT_SWAP_IN;\n        stats[ret].val = swap_usage;\n        ret++;\n    }\n    if (ret < nr_stats) {\n        stats[ret].tag = VIR_DOMAIN_MEMORY_STAT_RSS;\n        stats[ret].val = mem_usage;\n        ret++;\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcNodeGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4650-4658",
    "snippet": "static int\nlxcNodeGetInfo(virConnectPtr conn,\n               virNodeInfoPtr nodeinfo)\n{\n    if (virNodeGetInfoEnsureACL(conn) < 0)\n        return -1;\n\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesGetNodeInfo",
          "args": [
            "nodeinfo"
          ],
          "line": 4657
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesGetNodeInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1434-1456",
          "snippet": "int\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirCapabilitiesGetNodeInfo(virNodeInfoPtr nodeinfo)\n{\n    virArch hostarch = virArchFromHost();\n    unsigned long long memorybytes;\n\n    memset(nodeinfo, 0, sizeof(*nodeinfo));\n\n    if (virStrcpyStatic(nodeinfo->model, virArchToString(hostarch)) < 0)\n        return -1;\n\n    if (virHostMemGetInfo(&memorybytes, NULL) < 0)\n        return -1;\n    nodeinfo->memory = memorybytes / 1024;\n\n    if (virHostCPUGetInfo(hostarch,\n                          &nodeinfo->cpus, &nodeinfo->mhz,\n                          &nodeinfo->nodes, &nodeinfo->sockets,\n                          &nodeinfo->cores, &nodeinfo->threads) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetInfoEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcNodeGetInfo(virConnectPtr conn,\n               virNodeInfoPtr nodeinfo)\n{\n    if (virNodeGetInfoEnsureACL(conn) < 0)\n        return -1;\n\n    return virCapabilitiesGetNodeInfo(nodeinfo);\n}"
  },
  {
    "function_name": "lxcConnectGetSysinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4627-4647",
    "snippet": "static char *\nlxcConnectGetSysinfo(virConnectPtr conn, unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetSysinfoEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!driver->hostsysinfo) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Host SMBIOS information is not available\"));\n        return NULL;\n    }\n\n    if (virSysinfoFormat(&buf, driver->hostsysinfo) < 0)\n        return NULL;\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 4646
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoFormat",
          "args": [
            "&buf",
            "driver->hostsysinfo"
          ],
          "line": 4644
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1446-1474",
          "snippet": "int\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSysinfoFormat(virBufferPtr buf, virSysinfoDefPtr def)\n{\n    virBuffer attrBuf = VIR_BUFFER_INITIALIZER;\n    virBuffer childrenBuf = VIR_BUFFER_INIT_CHILD(buf);\n    const char *type = virSysinfoTypeToString(def->type);\n\n    if (!type) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected sysinfo type model %d\"),\n                       def->type);\n        virBufferFreeAndReset(buf);\n        return -1;\n    }\n\n    virSysinfoBIOSFormat(&childrenBuf, def->bios);\n    virSysinfoSystemFormat(&childrenBuf, def->system);\n    virSysinfoBaseBoardFormat(&childrenBuf, def->baseBoard, def->nbaseBoard);\n    virSysinfoChassisFormat(&childrenBuf, def->chassis);\n    virSysinfoProcessorFormat(&childrenBuf, def);\n    virSysinfoMemoryFormat(&childrenBuf, def);\n    virSysinfoOEMStringsFormat(&childrenBuf, def->oemStrings);\n\n    virBufferAsprintf(&attrBuf, \" type='%s'\", type);\n\n    virXMLFormatElement(buf, \"sysinfo\", &attrBuf, &childrenBuf);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Host SMBIOS information is not available\")"
          ],
          "line": 4639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Host SMBIOS information is not available\""
          ],
          "line": 4640
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetSysinfoEnsureACL",
          "args": [
            "conn"
          ],
          "line": 4635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 4633
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *\nlxcConnectGetSysinfo(virConnectPtr conn, unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectGetSysinfoEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!driver->hostsysinfo) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Host SMBIOS information is not available\"));\n        return NULL;\n    }\n\n    if (virSysinfoFormat(&buf, driver->hostsysinfo) < 0)\n        return NULL;\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "lxcDomainLxcOpenNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4580-4624",
    "snippet": "static int lxcDomainLxcOpenNamespace(virDomainPtr dom,\n                                     int **fdlist,\n                                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virLXCDomainObjPrivatePtr priv;\n    int ret = -1;\n    size_t nfds = 0;\n\n    *fdlist = NULL;\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainLxcOpenNamespaceEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Init pid is not yet available\"));\n        goto endjob;\n    }\n\n    if (virProcessGetNamespaces(priv->initpid, &nfds, fdlist) < 0)\n        goto endjob;\n\n    ret = nfds;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4622
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 4619
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessGetNamespaces",
          "args": [
            "priv->initpid",
            "&nfds",
            "fdlist"
          ],
          "line": 4613
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessGetNamespaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "642-678",
          "snippet": "int virProcessGetNamespaces(pid_t pid,\n                            size_t *nfdlist,\n                            int **fdlist)\n{\n    int ret = -1;\n    size_t i = 0;\n    const char *ns[] = { \"user\", \"ipc\", \"uts\", \"net\", \"pid\", \"mnt\" };\n\n    *nfdlist = 0;\n    *fdlist = NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(ns); i++) {\n        int fd;\n        g_autofree char *nsfile = NULL;\n\n        nsfile = g_strdup_printf(\"/proc/%llu/ns/%s\", (long long)pid, ns[i]);\n\n        if ((fd = open(nsfile, O_RDONLY)) >= 0) {\n            if (VIR_EXPAND_N(*fdlist, *nfdlist, 1) < 0) {\n                VIR_FORCE_CLOSE(fd);\n                goto cleanup;\n            }\n\n            (*fdlist)[(*nfdlist)-1] = fd;\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        for (i = 0; i < *nfdlist; i++)\n            VIR_FORCE_CLOSE((*fdlist)[i]);\n        VIR_FREE(*fdlist);\n    }\n    return ret;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virProcessGetNamespaces(pid_t pid,\n                            size_t *nfdlist,\n                            int **fdlist)\n{\n    int ret = -1;\n    size_t i = 0;\n    const char *ns[] = { \"user\", \"ipc\", \"uts\", \"net\", \"pid\", \"mnt\" };\n\n    *nfdlist = 0;\n    *fdlist = NULL;\n\n    for (i = 0; i < G_N_ELEMENTS(ns); i++) {\n        int fd;\n        g_autofree char *nsfile = NULL;\n\n        nsfile = g_strdup_printf(\"/proc/%llu/ns/%s\", (long long)pid, ns[i]);\n\n        if ((fd = open(nsfile, O_RDONLY)) >= 0) {\n            if (VIR_EXPAND_N(*fdlist, *nfdlist, 1) < 0) {\n                VIR_FORCE_CLOSE(fd);\n                goto cleanup;\n            }\n\n            (*fdlist)[(*nfdlist)-1] = fd;\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        for (i = 0; i < *nfdlist; i++)\n            VIR_FORCE_CLOSE((*fdlist)[i]);\n        VIR_FREE(*fdlist);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Init pid is not yet available\")"
          ],
          "line": 4608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Init pid is not yet available\""
          ],
          "line": 4609
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 4604
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_QUERY"
          ],
          "line": 4601
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLxcOpenNamespaceEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 4598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4593
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 4591
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainLxcOpenNamespace(virDomainPtr dom,\n                                     int **fdlist,\n                                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virLXCDomainObjPrivatePtr priv;\n    int ret = -1;\n    size_t nfds = 0;\n\n    *fdlist = NULL;\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainLxcOpenNamespaceEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Init pid is not yet available\"));\n        goto endjob;\n    }\n\n    if (virProcessGetNamespaces(priv->initpid, &nfds, fdlist) < 0)\n        goto endjob;\n\n    ret = nfds;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDetachDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4572-4577",
    "snippet": "static int lxcDomainDetachDevice(virDomainPtr dom,\n                                 const char *xml)\n{\n    return lxcDomainDetachDeviceFlags(dom, xml,\n                                      VIR_DOMAIN_AFFECT_LIVE);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceFlags",
          "args": [
            "dom",
            "xml",
            "VIR_DOMAIN_AFFECT_LIVE"
          ],
          "line": 4575
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4475-4569",
          "snippet": "static int lxcDomainDetachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                             VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if ((ret = lxcDomainDetachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if ((ret = lxcDomainDetachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainDetachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                             VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if ((ret = lxcDomainDetachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if ((ret = lxcDomainDetachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainDetachDevice(virDomainPtr dom,\n                                 const char *xml)\n{\n    return lxcDomainDetachDeviceFlags(dom, xml,\n                                      VIR_DOMAIN_AFFECT_LIVE);\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4475-4569",
    "snippet": "static int lxcDomainDetachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                             VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if ((ret = lxcDomainDetachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if ((ret = lxcDomainDetachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 4567
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4565
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 4564
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "vmdef"
          ],
          "line": 4561
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 4558
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjAssignDef",
          "args": [
            "vm",
            "vmdef",
            "false",
            "NULL"
          ],
          "line": 4552
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3597-3626",
          "snippet": "void virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "vmdef",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 4550
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 4542
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceLive",
          "args": [
            "driver",
            "vm",
            "dev_copy"
          ],
          "line": 4535
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4271-4299",
          "snippet": "static int\nlxcDomainDetachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainDetachDeviceDiskLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainDetachDeviceNetLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainDetachDeviceHostdevLive(driver, vm, dev);\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be detached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainDetachDeviceDiskLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainDetachDeviceNetLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainDetachDeviceHostdevLive(driver, vm, dev);\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be detached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceConfig",
          "args": [
            "vmdef",
            "dev"
          ],
          "line": 4530
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3133-3185",
          "snippet": "static int\nlxcDomainDetachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk, det_disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev, det_hostdev;\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (!(det_disk = virDomainDiskRemoveByName(vmdef, disk->dst))) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no target device %s\"), disk->dst);\n            return -1;\n        }\n        virDomainDiskDefFree(det_disk);\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        /* this is guaranteed to succeed */\n        virDomainNetDefFree(virDomainNetRemove(vmdef, idx));\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV: {\n        hostdev = dev->data.hostdev;\n        if ((idx = virDomainHostdevFind(vmdef, hostdev, &det_hostdev)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device not present in domain configuration\"));\n            return -1;\n        }\n        virDomainHostdevRemove(vmdef, idx);\n        virDomainHostdevDefFree(det_hostdev);\n        ret = 0;\n        break;\n    }\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent detach of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk, det_disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev, det_hostdev;\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (!(det_disk = virDomainDiskRemoveByName(vmdef, disk->dst))) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no target device %s\"), disk->dst);\n            return -1;\n        }\n        virDomainDiskDefFree(det_disk);\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        /* this is guaranteed to succeed */\n        virDomainNetDefFree(virDomainNetRemove(vmdef, idx));\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV: {\n        hostdev = dev->data.hostdev;\n        if ((idx = virDomainHostdevFind(vmdef, hostdev, &det_hostdev)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device not present in domain configuration\"));\n            return -1;\n        }\n        virDomainHostdevRemove(vmdef, idx);\n        virDomainHostdevDefFree(det_hostdev);\n        ret = 0;\n        break;\n    }\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent detach of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCopyPersistentDef",
          "args": [
            "vm",
            "driver->xmlopt",
            "NULL"
          ],
          "line": 4526
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCopyPersistentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30026-30035",
          "snippet": "virDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefCopy",
          "args": [
            "dev",
            "vm->def",
            "driver->xmlopt",
            "NULL"
          ],
          "line": 4518
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30487-30580",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefCopy(virDomainDeviceDefPtr src,\n                       const virDomainDef *def,\n                       virDomainXMLOptionPtr xmlopt,\n                       void *parseOpaque)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n    int flags = VIR_DOMAIN_DEF_FORMAT_INACTIVE | VIR_DOMAIN_DEF_FORMAT_SECURE;\n    int rc = -1;\n    g_autofree char *xmlStr = NULL;\n\n    switch ((virDomainDeviceType) src->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        rc = virDomainDiskDefFormat(&buf, src->data.disk, flags, xmlopt);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        rc = virDomainLeaseDefFormat(&buf, src->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        rc = virDomainFSDefFormat(&buf, src->data.fs, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        rc = virDomainNetDefFormat(&buf, src->data.net, xmlopt, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        rc = virDomainInputDefFormat(&buf, src->data.input, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        rc = virDomainSoundDefFormat(&buf, src->data.sound, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        rc = virDomainVideoDefFormat(&buf, src->data.video, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        rc = virDomainHostdevDefFormat(&buf, src->data.hostdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        rc = virDomainWatchdogDefFormat(&buf, src->data.watchdog, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        rc = virDomainControllerDefFormat(&buf, src->data.controller, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        rc = virDomainGraphicsDefFormat(&buf, src->data.graphics, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        rc = virDomainHubDefFormat(&buf, src->data.hub, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        rc = virDomainRedirdevDefFormat(&buf, src->data.redirdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        rc = virDomainRNGDefFormat(&buf, src->data.rng, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        rc = virDomainChrDefFormat(&buf, src->data.chr, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        rc = virDomainTPMDefFormat(&buf, src->data.tpm, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        rc = virDomainPanicDefFormat(&buf, src->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        rc = virDomainMemoryDefFormat(&buf, src->data.memory, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        rc = virDomainShmemDefFormat(&buf, src->data.shmem, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        rc = virDomainVsockDefFormat(&buf, src->data.vsock);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n    case VIR_DOMAIN_DEVICE_NVRAM:\n    case VIR_DOMAIN_DEVICE_IOMMU:\n    case VIR_DOMAIN_DEVICE_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Copying definition of '%d' type \"\n                         \"is not implemented yet.\"),\n                       src->type);\n        return NULL;\n    }\n\n    if (rc < 0)\n        return NULL;\n\n    xmlStr = virBufferContentAndReset(&buf);\n    return virDomainDeviceDefParse(xmlStr, def, xmlopt, parseOpaque,\n                                   VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                   VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefCopy(virDomainDeviceDefPtr src,\n                       const virDomainDef *def,\n                       virDomainXMLOptionPtr xmlopt,\n                       void *parseOpaque)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n    int flags = VIR_DOMAIN_DEF_FORMAT_INACTIVE | VIR_DOMAIN_DEF_FORMAT_SECURE;\n    int rc = -1;\n    g_autofree char *xmlStr = NULL;\n\n    switch ((virDomainDeviceType) src->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        rc = virDomainDiskDefFormat(&buf, src->data.disk, flags, xmlopt);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        rc = virDomainLeaseDefFormat(&buf, src->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        rc = virDomainFSDefFormat(&buf, src->data.fs, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        rc = virDomainNetDefFormat(&buf, src->data.net, xmlopt, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        rc = virDomainInputDefFormat(&buf, src->data.input, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        rc = virDomainSoundDefFormat(&buf, src->data.sound, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        rc = virDomainVideoDefFormat(&buf, src->data.video, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        rc = virDomainHostdevDefFormat(&buf, src->data.hostdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        rc = virDomainWatchdogDefFormat(&buf, src->data.watchdog, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        rc = virDomainControllerDefFormat(&buf, src->data.controller, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        rc = virDomainGraphicsDefFormat(&buf, src->data.graphics, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        rc = virDomainHubDefFormat(&buf, src->data.hub, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        rc = virDomainRedirdevDefFormat(&buf, src->data.redirdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        rc = virDomainRNGDefFormat(&buf, src->data.rng, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        rc = virDomainChrDefFormat(&buf, src->data.chr, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        rc = virDomainTPMDefFormat(&buf, src->data.tpm, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        rc = virDomainPanicDefFormat(&buf, src->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        rc = virDomainMemoryDefFormat(&buf, src->data.memory, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        rc = virDomainShmemDefFormat(&buf, src->data.shmem, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        rc = virDomainVsockDefFormat(&buf, src->data.vsock);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n    case VIR_DOMAIN_DEVICE_NVRAM:\n    case VIR_DOMAIN_DEVICE_IOMMU:\n    case VIR_DOMAIN_DEVICE_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Copying definition of '%d' type \"\n                         \"is not implemented yet.\"),\n                       src->type);\n        return NULL;\n    }\n\n    if (rc < 0)\n        return NULL;\n\n    xmlStr = virBufferContentAndReset(&buf);\n    return virDomainDeviceDefParse(xmlStr, def, xmlopt, parseOpaque,\n                                   VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                   VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "vm->def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                             VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE"
          ],
          "line": 4505
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "false"
          ],
          "line": 4502
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjUpdateModificationImpact",
          "args": [
            "vm",
            "&flags"
          ],
          "line": 4499
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjUpdateModificationImpact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3786-3814",
          "snippet": "int\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 4496
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDetachDeviceFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 4493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4490
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 4487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 4485
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainDetachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDetachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                             VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if ((ret = lxcDomainDetachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if ((ret = lxcDomainDetachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainUpdateDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4411-4472",
    "snippet": "static int lxcDomainUpdateDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainUpdateDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Unable to modify live devices\"));\n        goto endjob;\n    }\n\n    if (!(dev = virDomainDeviceDefParse(xml, vm->def, driver->xmlopt, NULL,\n                                        VIR_DOMAIN_DEF_PARSE_INACTIVE)))\n        goto endjob;\n\n    /* Make a copy for updated domain. */\n    if (!(vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL)))\n        goto endjob;\n\n    /* virDomainDefCompatibleDevice call is delayed until we know the\n     * device we're going to update. */\n    if (lxcDomainUpdateDeviceConfig(vmdef, dev) < 0)\n        goto endjob;\n\n    if (virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir) < 0)\n        goto endjob;\n\n    virDomainObjAssignDef(vm, vmdef, false, NULL);\n    vmdef = NULL;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 4470
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4469
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 4468
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "vmdef"
          ],
          "line": 4467
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 4464
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjAssignDef",
          "args": [
            "vm",
            "vmdef",
            "false",
            "NULL"
          ],
          "line": 4459
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3597-3626",
          "snippet": "void virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "vmdef",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 4456
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainUpdateDeviceConfig",
          "args": [
            "vmdef",
            "dev"
          ],
          "line": 4453
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainUpdateDeviceConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3093-3130",
          "snippet": "static int\nlxcDomainUpdateDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainNetDefPtr net;\n    virDomainDeviceDef oldDev = { .type = dev->type };\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        oldDev.data.net = vmdef->nets[idx];\n        if (virDomainDefCompatibleDevice(vmdef, dev, &oldDev,\n                                         VIR_DOMAIN_DEVICE_ACTION_UPDATE,\n                                         false) < 0)\n            return -1;\n\n        if (virDomainNetUpdate(vmdef, idx, net) < 0)\n            return -1;\n\n        virDomainNetDefFree(oldDev.data.net);\n        dev->data.net = NULL;\n        ret = 0;\n\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent update of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainUpdateDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainNetDefPtr net;\n    virDomainDeviceDef oldDev = { .type = dev->type };\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        oldDev.data.net = vmdef->nets[idx];\n        if (virDomainDefCompatibleDevice(vmdef, dev, &oldDev,\n                                         VIR_DOMAIN_DEVICE_ACTION_UPDATE,\n                                         false) < 0)\n            return -1;\n\n        if (virDomainNetUpdate(vmdef, idx, net) < 0)\n            return -1;\n\n        virDomainNetDefFree(oldDev.data.net);\n        dev->data.net = NULL;\n        ret = 0;\n\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent update of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCopyPersistentDef",
          "args": [
            "vm",
            "driver->xmlopt",
            "NULL"
          ],
          "line": 4448
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCopyPersistentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30026-30035",
          "snippet": "virDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "vm->def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE"
          ],
          "line": 4443
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"Unable to modify live devices\")"
          ],
          "line": 4438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to modify live devices\""
          ],
          "line": 4439
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjUpdateModificationImpact",
          "args": [
            "vm",
            "&flags"
          ],
          "line": 4434
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjUpdateModificationImpact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3786-3814",
          "snippet": "int\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 4431
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainUpdateDeviceFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 4428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4425
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 4422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 4420
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainUpdateDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainUpdateDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Unable to modify live devices\"));\n        goto endjob;\n    }\n\n    if (!(dev = virDomainDeviceDefParse(xml, vm->def, driver->xmlopt, NULL,\n                                        VIR_DOMAIN_DEF_PARSE_INACTIVE)))\n        goto endjob;\n\n    /* Make a copy for updated domain. */\n    if (!(vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL)))\n        goto endjob;\n\n    /* virDomainDefCompatibleDevice call is delayed until we know the\n     * device we're going to update. */\n    if (lxcDomainUpdateDeviceConfig(vmdef, dev) < 0)\n        goto endjob;\n\n    if (virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir) < 0)\n        goto endjob;\n\n    virDomainObjAssignDef(vm, vmdef, false, NULL);\n    vmdef = NULL;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4403-4408",
    "snippet": "static int lxcDomainAttachDevice(virDomainPtr dom,\n                                 const char *xml)\n{\n    return lxcDomainAttachDeviceFlags(dom, xml,\n                                       VIR_DOMAIN_AFFECT_LIVE);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceFlags",
          "args": [
            "dom",
            "xml",
            "VIR_DOMAIN_AFFECT_LIVE"
          ],
          "line": 4406
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4302-4400",
          "snippet": "static int lxcDomainAttachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if (virDomainDefCompatibleDevice(vmdef, dev, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         false) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if (virDomainDefCompatibleDevice(vm->def, dev_copy, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         true) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainAttachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if (virDomainDefCompatibleDevice(vmdef, dev, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         false) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if (virDomainDefCompatibleDevice(vm->def, dev_copy, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         true) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainAttachDevice(virDomainPtr dom,\n                                 const char *xml)\n{\n    return lxcDomainAttachDeviceFlags(dom, xml,\n                                       VIR_DOMAIN_AFFECT_LIVE);\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4302-4400",
    "snippet": "static int lxcDomainAttachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if (virDomainDefCompatibleDevice(vmdef, dev, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         false) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if (virDomainDefCompatibleDevice(vm->def, dev_copy, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         true) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 4398
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 4397
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefFree",
          "args": [
            "dev"
          ],
          "line": 4396
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3062-3146",
          "snippet": "void virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def)\n{\n    if (!def)\n        return;\n\n    switch ((virDomainDeviceType) def->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        virDomainDiskDefFree(def->data.disk);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        virDomainLeaseDefFree(def->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        virDomainNetDefFree(def->data.net);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        virDomainInputDefFree(def->data.input);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        virDomainSoundDefFree(def->data.sound);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        virDomainVideoDefFree(def->data.video);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        virDomainHostdevDefFree(def->data.hostdev);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        virDomainWatchdogDefFree(def->data.watchdog);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        virDomainControllerDefFree(def->data.controller);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        virDomainGraphicsDefFree(def->data.graphics);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        virDomainHubDefFree(def->data.hub);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        virDomainRedirdevDefFree(def->data.redirdev);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        virDomainRNGDefFree(def->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        virDomainChrDefFree(def->data.chr);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        virDomainFSDefFree(def->data.fs);\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        virDomainSmartcardDefFree(def->data.smartcard);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        virDomainMemballoonDefFree(def->data.memballoon);\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        virDomainNVRAMDefFree(def->data.nvram);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        virDomainShmemDefFree(def->data.shmem);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        virDomainTPMDefFree(def->data.tpm);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        virDomainPanicDefFree(def->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        virDomainMemoryDefFree(def->data.memory);\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        VIR_FREE(def->data.iommu);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        virDomainVsockDefFree(def->data.vsock);\n        break;\n    case VIR_DOMAIN_DEVICE_LAST:\n    case VIR_DOMAIN_DEVICE_NONE:\n        break;\n    }\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "vmdef"
          ],
          "line": 4393
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 4390
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjAssignDef",
          "args": [
            "vm",
            "vmdef",
            "false",
            "NULL"
          ],
          "line": 4384
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3597-3626",
          "snippet": "void virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "vmdef",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 4382
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 4374
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceLive",
          "args": [
            "driver",
            "vm",
            "dev_copy"
          ],
          "line": 4367
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3868-3903",
          "snippet": "static int\nlxcDomainAttachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainAttachDeviceDiskLive(driver, vm, dev);\n        if (!ret)\n            dev->data.disk = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainAttachDeviceNetLive(driver, vm,\n                                           dev->data.net);\n        if (!ret)\n            dev->data.net = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainAttachDeviceHostdevLive(driver, vm, dev);\n        if (!ret)\n            dev->data.hostdev = NULL;\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be attached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainAttachDeviceDiskLive(driver, vm, dev);\n        if (!ret)\n            dev->data.disk = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainAttachDeviceNetLive(driver, vm,\n                                           dev->data.net);\n        if (!ret)\n            dev->data.net = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainAttachDeviceHostdevLive(driver, vm, dev);\n        if (!ret)\n            dev->data.hostdev = NULL;\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be attached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefCompatibleDevice",
          "args": [
            "vm->def",
            "dev_copy",
            "NULL",
            "VIR_DOMAIN_DEVICE_ACTION_ATTACH",
            "true"
          ],
          "line": 4362
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefCompatibleDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29597-29664",
          "snippet": "int\nvirDomainDefCompatibleDevice(virDomainDefPtr def,\n                             virDomainDeviceDefPtr dev,\n                             virDomainDeviceDefPtr oldDev,\n                             virDomainDeviceAction action,\n                             bool live)\n{\n    virDomainCompatibleDeviceData data = {\n        .newInfo = virDomainDeviceGetInfo(dev),\n        .oldInfo = NULL,\n    };\n\n    if (oldDev)\n        data.oldInfo = virDomainDeviceGetInfo(oldDev);\n\n    if (action == VIR_DOMAIN_DEVICE_ACTION_UPDATE &&\n        live &&\n        (data.newInfo && data.oldInfo &&\n         data.newInfo->alias && data.oldInfo->alias &&\n         STRNEQ(data.newInfo->alias, data.oldInfo->alias))) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"changing device alias is not allowed\"));\n        return -1;\n    }\n\n    if (!virDomainDefHasUSB(def) &&\n        def->os.type != VIR_DOMAIN_OSTYPE_EXE &&\n        virDomainDeviceIsUSB(dev)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Device configuration is not compatible: \"\n                         \"Domain has no USB bus support\"));\n        return -1;\n    }\n\n    if (data.newInfo && data.newInfo->bootIndex > 0) {\n        if (def->os.nBootDevs > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"per-device boot elements cannot be used\"\n                             \" together with os/boot elements\"));\n            return -1;\n        }\n        if (virDomainDeviceInfoIterate(def,\n                                       virDomainDeviceInfoCheckBootIndex,\n                                       &data) < 0)\n            return -1;\n    }\n\n    if (dev->type == VIR_DOMAIN_DEVICE_MEMORY) {\n        unsigned long long sz = dev->data.memory->size;\n\n        if (!virDomainDefHasMemoryHotplug(def)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use/hotplug a memory device when domain \"\n                             \"'maxMemory' is not defined\"));\n            return -1;\n        }\n\n        if ((virDomainDefGetMemoryTotal(def) + sz) > def->mem.max_memory) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Attaching memory device with size '%llu' would \"\n                             \"exceed domain's maxMemory config size '%llu'\"),\n                           sz, def->mem.max_memory);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefCompatibleDevice(virDomainDefPtr def,\n                             virDomainDeviceDefPtr dev,\n                             virDomainDeviceDefPtr oldDev,\n                             virDomainDeviceAction action,\n                             bool live)\n{\n    virDomainCompatibleDeviceData data = {\n        .newInfo = virDomainDeviceGetInfo(dev),\n        .oldInfo = NULL,\n    };\n\n    if (oldDev)\n        data.oldInfo = virDomainDeviceGetInfo(oldDev);\n\n    if (action == VIR_DOMAIN_DEVICE_ACTION_UPDATE &&\n        live &&\n        (data.newInfo && data.oldInfo &&\n         data.newInfo->alias && data.oldInfo->alias &&\n         STRNEQ(data.newInfo->alias, data.oldInfo->alias))) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"changing device alias is not allowed\"));\n        return -1;\n    }\n\n    if (!virDomainDefHasUSB(def) &&\n        def->os.type != VIR_DOMAIN_OSTYPE_EXE &&\n        virDomainDeviceIsUSB(dev)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Device configuration is not compatible: \"\n                         \"Domain has no USB bus support\"));\n        return -1;\n    }\n\n    if (data.newInfo && data.newInfo->bootIndex > 0) {\n        if (def->os.nBootDevs > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"per-device boot elements cannot be used\"\n                             \" together with os/boot elements\"));\n            return -1;\n        }\n        if (virDomainDeviceInfoIterate(def,\n                                       virDomainDeviceInfoCheckBootIndex,\n                                       &data) < 0)\n            return -1;\n    }\n\n    if (dev->type == VIR_DOMAIN_DEVICE_MEMORY) {\n        unsigned long long sz = dev->data.memory->size;\n\n        if (!virDomainDefHasMemoryHotplug(def)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use/hotplug a memory device when domain \"\n                             \"'maxMemory' is not defined\"));\n            return -1;\n        }\n\n        if ((virDomainDefGetMemoryTotal(def) + sz) > def->mem.max_memory) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Attaching memory device with size '%llu' would \"\n                             \"exceed domain's maxMemory config size '%llu'\"),\n                           sz, def->mem.max_memory);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceConfig",
          "args": [
            "vmdef",
            "dev"
          ],
          "line": 4357
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3038-3090",
          "snippet": "static int\nlxcDomainAttachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (virDomainDiskIndexByName(vmdef, disk->dst, true) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s already exists.\"), disk->dst);\n            return -1;\n        }\n        if (virDomainDiskInsert(vmdef, disk) < 0)\n            return -1;\n        /* vmdef has the pointer. Generic codes for vmdef will do all jobs */\n        dev->data.disk = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if (virDomainNetInsert(vmdef, net) < 0)\n            return -1;\n        dev->data.net = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        hostdev = dev->data.hostdev;\n        if (virDomainHostdevFind(vmdef, hostdev, NULL) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device is already in the domain configuration\"));\n            return -1;\n        }\n        if (virDomainHostdevInsert(vmdef, hostdev) < 0)\n            return -1;\n        dev->data.hostdev = NULL;\n        ret = 0;\n        break;\n\n    default:\n         virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                        _(\"persistent attach of device is not supported\"));\n         break;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (virDomainDiskIndexByName(vmdef, disk->dst, true) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s already exists.\"), disk->dst);\n            return -1;\n        }\n        if (virDomainDiskInsert(vmdef, disk) < 0)\n            return -1;\n        /* vmdef has the pointer. Generic codes for vmdef will do all jobs */\n        dev->data.disk = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if (virDomainNetInsert(vmdef, net) < 0)\n            return -1;\n        dev->data.net = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        hostdev = dev->data.hostdev;\n        if (virDomainHostdevFind(vmdef, hostdev, NULL) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device is already in the domain configuration\"));\n            return -1;\n        }\n        if (virDomainHostdevInsert(vmdef, hostdev) < 0)\n            return -1;\n        dev->data.hostdev = NULL;\n        ret = 0;\n        break;\n\n    default:\n         virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                        _(\"persistent attach of device is not supported\"));\n         break;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCopyPersistentDef",
          "args": [
            "vm",
            "driver->xmlopt",
            "NULL"
          ],
          "line": 4348
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCopyPersistentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30026-30035",
          "snippet": "virDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefCopy",
          "args": [
            "dev",
            "vm->def",
            "driver->xmlopt",
            "NULL"
          ],
          "line": 4340
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30487-30580",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefCopy(virDomainDeviceDefPtr src,\n                       const virDomainDef *def,\n                       virDomainXMLOptionPtr xmlopt,\n                       void *parseOpaque)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n    int flags = VIR_DOMAIN_DEF_FORMAT_INACTIVE | VIR_DOMAIN_DEF_FORMAT_SECURE;\n    int rc = -1;\n    g_autofree char *xmlStr = NULL;\n\n    switch ((virDomainDeviceType) src->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        rc = virDomainDiskDefFormat(&buf, src->data.disk, flags, xmlopt);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        rc = virDomainLeaseDefFormat(&buf, src->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        rc = virDomainFSDefFormat(&buf, src->data.fs, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        rc = virDomainNetDefFormat(&buf, src->data.net, xmlopt, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        rc = virDomainInputDefFormat(&buf, src->data.input, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        rc = virDomainSoundDefFormat(&buf, src->data.sound, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        rc = virDomainVideoDefFormat(&buf, src->data.video, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        rc = virDomainHostdevDefFormat(&buf, src->data.hostdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        rc = virDomainWatchdogDefFormat(&buf, src->data.watchdog, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        rc = virDomainControllerDefFormat(&buf, src->data.controller, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        rc = virDomainGraphicsDefFormat(&buf, src->data.graphics, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        rc = virDomainHubDefFormat(&buf, src->data.hub, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        rc = virDomainRedirdevDefFormat(&buf, src->data.redirdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        rc = virDomainRNGDefFormat(&buf, src->data.rng, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        rc = virDomainChrDefFormat(&buf, src->data.chr, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        rc = virDomainTPMDefFormat(&buf, src->data.tpm, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        rc = virDomainPanicDefFormat(&buf, src->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        rc = virDomainMemoryDefFormat(&buf, src->data.memory, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        rc = virDomainShmemDefFormat(&buf, src->data.shmem, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        rc = virDomainVsockDefFormat(&buf, src->data.vsock);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n    case VIR_DOMAIN_DEVICE_NVRAM:\n    case VIR_DOMAIN_DEVICE_IOMMU:\n    case VIR_DOMAIN_DEVICE_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Copying definition of '%d' type \"\n                         \"is not implemented yet.\"),\n                       src->type);\n        return NULL;\n    }\n\n    if (rc < 0)\n        return NULL;\n\n    xmlStr = virBufferContentAndReset(&buf);\n    return virDomainDeviceDefParse(xmlStr, def, xmlopt, parseOpaque,\n                                   VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                   VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefCopy(virDomainDeviceDefPtr src,\n                       const virDomainDef *def,\n                       virDomainXMLOptionPtr xmlopt,\n                       void *parseOpaque)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n    int flags = VIR_DOMAIN_DEF_FORMAT_INACTIVE | VIR_DOMAIN_DEF_FORMAT_SECURE;\n    int rc = -1;\n    g_autofree char *xmlStr = NULL;\n\n    switch ((virDomainDeviceType) src->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        rc = virDomainDiskDefFormat(&buf, src->data.disk, flags, xmlopt);\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        rc = virDomainLeaseDefFormat(&buf, src->data.lease);\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        rc = virDomainFSDefFormat(&buf, src->data.fs, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        rc = virDomainNetDefFormat(&buf, src->data.net, xmlopt, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        rc = virDomainInputDefFormat(&buf, src->data.input, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        rc = virDomainSoundDefFormat(&buf, src->data.sound, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        rc = virDomainVideoDefFormat(&buf, src->data.video, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        rc = virDomainHostdevDefFormat(&buf, src->data.hostdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        rc = virDomainWatchdogDefFormat(&buf, src->data.watchdog, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        rc = virDomainControllerDefFormat(&buf, src->data.controller, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        rc = virDomainGraphicsDefFormat(&buf, src->data.graphics, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        rc = virDomainHubDefFormat(&buf, src->data.hub, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        rc = virDomainRedirdevDefFormat(&buf, src->data.redirdev, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        rc = virDomainRNGDefFormat(&buf, src->data.rng, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        rc = virDomainChrDefFormat(&buf, src->data.chr, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        rc = virDomainTPMDefFormat(&buf, src->data.tpm, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        rc = virDomainPanicDefFormat(&buf, src->data.panic);\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        rc = virDomainMemoryDefFormat(&buf, src->data.memory, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        rc = virDomainShmemDefFormat(&buf, src->data.shmem, flags);\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        rc = virDomainVsockDefFormat(&buf, src->data.vsock);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n    case VIR_DOMAIN_DEVICE_NVRAM:\n    case VIR_DOMAIN_DEVICE_IOMMU:\n    case VIR_DOMAIN_DEVICE_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Copying definition of '%d' type \"\n                         \"is not implemented yet.\"),\n                       src->type);\n        return NULL;\n    }\n\n    if (rc < 0)\n        return NULL;\n\n    xmlStr = virBufferContentAndReset(&buf);\n    return virDomainDeviceDefParse(xmlStr, def, xmlopt, parseOpaque,\n                                   VIR_DOMAIN_DEF_PARSE_INACTIVE |\n                                   VIR_DOMAIN_DEF_PARSE_SKIP_VALIDATE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeviceDefParse",
          "args": [
            "xml",
            "vm->def",
            "driver->xmlopt",
            "NULL",
            "VIR_DOMAIN_DEF_PARSE_INACTIVE"
          ],
          "line": 4328
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeviceDefParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "16792-16961",
          "snippet": "virDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDeviceDefPtr\nvirDomainDeviceDefParse(const char *xmlStr,\n                        const virDomainDef *def,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    g_autoptr(xmlDoc) xml = NULL;\n    xmlNodePtr node;\n    g_autoptr(xmlXPathContext) ctxt = NULL;\n    g_autoptr(virDomainDeviceDef) dev = NULL;\n\n    if (!(xml = virXMLParseStringCtxt(xmlStr, _(\"(device_definition)\"), &ctxt)))\n        return NULL;\n\n    node = ctxt->node;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    if ((dev->type = virDomainDeviceTypeFromString((const char *) node->name)) < 0) {\n        /* Some crazy mapping of serial, parallel, console and channel to\n         * VIR_DOMAIN_DEVICE_CHR. */\n        if (virXMLNodeNameEqual(node, \"channel\") ||\n            virXMLNodeNameEqual(node, \"console\") ||\n            virXMLNodeNameEqual(node, \"parallel\") ||\n            virXMLNodeNameEqual(node, \"serial\")) {\n            dev->type = VIR_DOMAIN_DEVICE_CHR;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"unknown device type '%s'\"),\n                           node->name);\n            return NULL;\n        }\n    }\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        if (!(dev->data.disk = virDomainDiskDefParseXML(xmlopt, node, ctxt,\n                                                        flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_LEASE:\n        if (!(dev->data.lease = virDomainLeaseDefParseXML(node)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_FS:\n        if (!(dev->data.fs = virDomainFSDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NET:\n        if (!(dev->data.net = virDomainNetDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_INPUT:\n        if (!(dev->data.input = virDomainInputDefParseXML(xmlopt, def, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SOUND:\n        if (!(dev->data.sound = virDomainSoundDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n        if (!(dev->data.watchdog = virDomainWatchdogDefParseXML(xmlopt,\n                                                                node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        if (!(dev->data.video = virDomainVideoDefParseXML(xmlopt, node,\n                                                          ctxt, def, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        if (!(dev->data.hostdev = virDomainHostdevDefParseXML(xmlopt, node,\n                                                              ctxt,\n                                                              flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n        if (!(dev->data.controller = virDomainControllerDefParseXML(xmlopt, node,\n                                                                    ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n        if (!(dev->data.graphics = virDomainGraphicsDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_HUB:\n        if (!(dev->data.hub = virDomainHubDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n        if (!(dev->data.redirdev = virDomainRedirdevDefParseXML(xmlopt, node,\n                                                                ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_RNG:\n        if (!(dev->data.rng = virDomainRNGDefParseXML(xmlopt, node,\n                                                      ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_CHR:\n        if (!(dev->data.chr = virDomainChrDefParseXML(xmlopt,\n                                                      ctxt,\n                                                      node,\n                                                      flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n        if (!(dev->data.smartcard = virDomainSmartcardDefParseXML(xmlopt, node,\n                                                                  ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n        if (!(dev->data.memballoon = virDomainMemballoonDefParseXML(xmlopt,\n                                                                    node,\n                                                                    ctxt,\n                                                                    flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NVRAM:\n        if (!(dev->data.nvram = virDomainNVRAMDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_SHMEM:\n        if (!(dev->data.shmem = virDomainShmemDefParseXML(xmlopt, node,\n                                                          ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_TPM:\n        if (!(dev->data.tpm = virDomainTPMDefParseXML(xmlopt, node, ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_PANIC:\n        if (!(dev->data.panic = virDomainPanicDefParseXML(xmlopt, node, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_MEMORY:\n        if (!(dev->data.memory = virDomainMemoryDefParseXML(xmlopt, node,\n                                                            ctxt, flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_IOMMU:\n        if (!(dev->data.iommu = virDomainIOMMUDefParseXML(node, ctxt)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_VSOCK:\n        if (!(dev->data.vsock = virDomainVsockDefParseXML(xmlopt, node, ctxt,\n                                                          flags)))\n            return NULL;\n        break;\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    /* callback to fill driver specific device aspects */\n    if (virDomainDeviceDefPostParseOne(dev, def, flags,\n                                       xmlopt, parseOpaque) < 0)\n        return NULL;\n\n    /* validate the configuration */\n    if (virDomainDeviceDefValidate(dev, def, flags, xmlopt) < 0)\n        return NULL;\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjUpdateModificationImpact",
          "args": [
            "vm",
            "&flags"
          ],
          "line": 4325
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjUpdateModificationImpact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3786-3814",
          "snippet": "int\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjUpdateModificationImpact(virDomainObjPtr vm,\n                                     unsigned int *flags)\n{\n    bool isActive = virDomainObjIsActive(vm);\n\n    if ((*flags & (VIR_DOMAIN_AFFECT_LIVE | VIR_DOMAIN_AFFECT_CONFIG)) ==\n        VIR_DOMAIN_AFFECT_CURRENT) {\n        if (isActive)\n            *flags |= VIR_DOMAIN_AFFECT_LIVE;\n        else\n            *flags |= VIR_DOMAIN_AFFECT_CONFIG;\n    }\n\n    if (!isActive && (*flags & VIR_DOMAIN_AFFECT_LIVE)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"domain is not running\"));\n        return -1;\n    }\n\n    if (!vm->persistent && (*flags & VIR_DOMAIN_AFFECT_CONFIG)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"transient domains do not have any \"\n                         \"persistent config\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 4322
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAttachDeviceFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 4319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 4316
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 4313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 4311
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainAttachDeviceFlags(virDomainPtr dom,\n                                      const char *xml,\n                                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr vmdef = NULL;\n    virDomainDeviceDefPtr dev = NULL, dev_copy = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainAttachDeviceFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        goto endjob;\n\n    dev = dev_copy = virDomainDeviceDefParse(xml, vm->def,\n                                             driver->xmlopt, NULL,\n                                             VIR_DOMAIN_DEF_PARSE_INACTIVE);\n    if (dev == NULL)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG &&\n        flags & VIR_DOMAIN_AFFECT_LIVE) {\n        /* If we are affecting both CONFIG and LIVE\n         * create a deep copy of device as adding\n         * to CONFIG takes one instance.\n         */\n        dev_copy = virDomainDeviceDefCopy(dev, vm->def,\n                                          driver->xmlopt, NULL);\n        if (!dev_copy)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        /* Make a copy for updated domain. */\n        vmdef = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!vmdef)\n            goto endjob;\n\n        if (virDomainDefCompatibleDevice(vmdef, dev, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         false) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceConfig(vmdef, dev)) < 0)\n            goto endjob;\n    }\n\n    if (flags & VIR_DOMAIN_AFFECT_LIVE) {\n        if (virDomainDefCompatibleDevice(vm->def, dev_copy, NULL,\n                                         VIR_DOMAIN_DEVICE_ACTION_ATTACH,\n                                         true) < 0)\n            goto endjob;\n\n        if ((ret = lxcDomainAttachDeviceLive(driver, vm, dev_copy)) < 0)\n            goto endjob;\n        /*\n         * update domain status forcibly because the domain status may be\n         * changed even if we failed to attach the device. For example,\n         * a new controller may be created.\n         */\n        if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0) {\n            ret = -1;\n            goto endjob;\n        }\n    }\n\n    /* Finally, if no error until here, we can save config. */\n    if (flags & VIR_DOMAIN_AFFECT_CONFIG) {\n        ret = virDomainDefSave(vmdef, driver->xmlopt, cfg->configDir);\n        if (!ret) {\n            virDomainObjAssignDef(vm, vmdef, false, NULL);\n            vmdef = NULL;\n        }\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(vmdef);\n    if (dev != dev_copy)\n        virDomainDeviceDefFree(dev_copy);\n    virDomainDeviceDefFree(dev);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4271-4299",
    "snippet": "static int\nlxcDomainDetachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainDetachDeviceDiskLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainDetachDeviceNetLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainDetachDeviceHostdevLive(driver, vm, dev);\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be detached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"device type '%s' cannot be detached\")",
            "virDomainDeviceTypeToString(dev->type)"
          ],
          "line": 4292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDeviceTypeToString",
          "args": [
            "dev->type"
          ],
          "line": 4294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"device type '%s' cannot be detached\""
          ],
          "line": 4293
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceHostdevLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 4288
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceHostdevLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4242-4268",
          "snippet": "static int\nlxcDomainDetachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainDetachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainDetachDeviceHostdevCapsLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainDetachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainDetachDeviceHostdevCapsLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceNetLive",
          "args": [
            "vm",
            "dev"
          ],
          "line": 4284
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceNetLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3963-4046",
          "snippet": "static int\nlxcDomainDetachDeviceNetLive(virDomainObjPtr vm,\n                             virDomainDeviceDefPtr dev)\n{\n    int detachidx, ret = -1;\n    virDomainNetType actualType;\n    virDomainNetDefPtr detach = NULL;\n    const virNetDevVPortProfile *vport = NULL;\n    virErrorPtr save_err = NULL;\n\n    if ((detachidx = virDomainNetFindIdx(vm->def, dev->data.net)) < 0)\n        goto cleanup;\n\n    detach = vm->def->nets[detachidx];\n    actualType = virDomainNetGetActualType(detach);\n\n    /* clear network bandwidth */\n    if (virDomainNetGetActualBandwidth(detach) &&\n        virNetDevSupportsBandwidth(actualType) &&\n        virNetDevBandwidthClear(detach->ifname))\n        goto cleanup;\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (virNetDevVethDelete(detach->ifname) < 0) {\n            virDomainAuditNet(vm, detach, NULL, \"detach\", false);\n            goto cleanup;\n        }\n        break;\n\n        /* It'd be nice to support this, but with macvlan\n         * once assigned to a container nothing exists on\n         * the host side. Further the container can change\n         * the mac address of NIC name, so we can't easily\n         * find out which guest NIC it maps to\n         */\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only bridged veth devices can be detached\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, detach, NULL, \"detach\", true);\n\n    virDomainConfNWFilterTeardown(detach);\n\n    vport = virDomainNetGetActualVirtPortProfile(detach);\n    if (vport && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH)\n        ignore_value(virNetDevOpenvswitchRemovePort(\n                        virDomainNetGetActualBridgeName(detach),\n                        detach->ifname));\n    ret = 0;\n cleanup:\n    if (!ret) {\n        virErrorPreserveLast(&save_err);\n        if (detach->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n            virConnectPtr conn = virGetConnectNetwork();\n            if (conn) {\n                virDomainNetReleaseActualDevice(conn, vm->def, detach);\n                virObjectUnref(conn);\n            } else {\n                VIR_WARN(\"Unable to release network device '%s'\", NULLSTR(detach->ifname));\n            }\n        }\n        virDomainNetRemove(vm->def, detachidx);\n        virDomainNetDefFree(detach);\n        virErrorRestore(&save_err);\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceNetLive(virDomainObjPtr vm,\n                             virDomainDeviceDefPtr dev)\n{\n    int detachidx, ret = -1;\n    virDomainNetType actualType;\n    virDomainNetDefPtr detach = NULL;\n    const virNetDevVPortProfile *vport = NULL;\n    virErrorPtr save_err = NULL;\n\n    if ((detachidx = virDomainNetFindIdx(vm->def, dev->data.net)) < 0)\n        goto cleanup;\n\n    detach = vm->def->nets[detachidx];\n    actualType = virDomainNetGetActualType(detach);\n\n    /* clear network bandwidth */\n    if (virDomainNetGetActualBandwidth(detach) &&\n        virNetDevSupportsBandwidth(actualType) &&\n        virNetDevBandwidthClear(detach->ifname))\n        goto cleanup;\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (virNetDevVethDelete(detach->ifname) < 0) {\n            virDomainAuditNet(vm, detach, NULL, \"detach\", false);\n            goto cleanup;\n        }\n        break;\n\n        /* It'd be nice to support this, but with macvlan\n         * once assigned to a container nothing exists on\n         * the host side. Further the container can change\n         * the mac address of NIC name, so we can't easily\n         * find out which guest NIC it maps to\n         */\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only bridged veth devices can be detached\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, detach, NULL, \"detach\", true);\n\n    virDomainConfNWFilterTeardown(detach);\n\n    vport = virDomainNetGetActualVirtPortProfile(detach);\n    if (vport && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH)\n        ignore_value(virNetDevOpenvswitchRemovePort(\n                        virDomainNetGetActualBridgeName(detach),\n                        detach->ifname));\n    ret = 0;\n cleanup:\n    if (!ret) {\n        virErrorPreserveLast(&save_err);\n        if (detach->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n            virConnectPtr conn = virGetConnectNetwork();\n            if (conn) {\n                virDomainNetReleaseActualDevice(conn, vm->def, detach);\n                virObjectUnref(conn);\n            } else {\n                VIR_WARN(\"Unable to release network device '%s'\", NULLSTR(detach->ifname));\n            }\n        }\n        virDomainNetRemove(vm->def, detachidx);\n        virDomainNetDefFree(detach);\n        virErrorRestore(&save_err);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceDiskLive",
          "args": [
            "vm",
            "dev"
          ],
          "line": 4280
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceDiskLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3906-3960",
          "snippet": "static int\nlxcDomainDetachDeviceDiskLive(virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    const char *src;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if ((idx = virDomainDiskIndexByName(vm->def,\n                                        dev->data.disk->dst,\n                                        false)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"disk %s not found\"), dev->data.disk->dst);\n        goto cleanup;\n    }\n\n    def = vm->def->disks[idx];\n    src = virDomainDiskGetSource(def);\n\n    dst = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditDisk(vm, def->src, NULL, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditDisk(vm, def->src, NULL, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, src,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 src, vm->def->name, virGetLastErrorMessage());\n\n    virDomainDiskRemove(vm->def, idx);\n    virDomainDiskDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(dst);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceDiskLive(virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    const char *src;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if ((idx = virDomainDiskIndexByName(vm->def,\n                                        dev->data.disk->dst,\n                                        false)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"disk %s not found\"), dev->data.disk->dst);\n        goto cleanup;\n    }\n\n    def = vm->def->disks[idx];\n    src = virDomainDiskGetSource(def);\n\n    dst = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditDisk(vm, def->src, NULL, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditDisk(vm, def->src, NULL, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, src,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 src, vm->def->name, virGetLastErrorMessage());\n\n    virDomainDiskRemove(vm->def, idx);\n    virDomainDiskDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(dst);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainDetachDeviceDiskLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainDetachDeviceNetLive(vm, dev);\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainDetachDeviceHostdevLive(driver, vm, dev);\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be detached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceHostdevLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4242-4268",
    "snippet": "static int\nlxcDomainDetachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainDetachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainDetachDeviceHostdevCapsLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported host device mode %s\")",
            "virDomainHostdevModeTypeToString(dev->data.hostdev->mode)"
          ],
          "line": 4263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevModeTypeToString",
          "args": [
            "dev->data.hostdev->mode"
          ],
          "line": 4265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported host device mode %s\""
          ],
          "line": 4264
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceHostdevCapsLive",
          "args": [
            "vm",
            "dev"
          ],
          "line": 4260
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceHostdevCapsLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4222-4239",
          "snippet": "static int\nlxcDomainDetachDeviceHostdevCapsLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainDetachDeviceHostdevStorageLive(vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainDetachDeviceHostdevMiscLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevCapsLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainDetachDeviceHostdevStorageLive(vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainDetachDeviceHostdevMiscLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceHostdevSubsysLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 4257
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceHostdevSubsysLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4204-4219",
          "snippet": "static int\nlxcDomainDetachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainDetachDeviceHostdevUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainDetachDeviceHostdevUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach hostdev until init PID is known\")"
          ],
          "line": 4250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainDetachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainDetachDeviceHostdevCapsLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceHostdevCapsLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4222-4239",
    "snippet": "static int\nlxcDomainDetachDeviceHostdevCapsLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainDetachDeviceHostdevStorageLive(vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainDetachDeviceHostdevMiscLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported host device type %s\")",
            "virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type)"
          ],
          "line": 4234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevCapsTypeToString",
          "args": [
            "dev->data.hostdev->source.caps.type"
          ],
          "line": 4236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported host device type %s\""
          ],
          "line": 4235
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceHostdevMiscLive",
          "args": [
            "vm",
            "dev"
          ],
          "line": 4231
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceHostdevMiscLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4157-4201",
          "snippet": "static int\nlxcDomainDetachDeviceHostdevMiscLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.misc.chardev);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.misc.chardev) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.misc.chardev,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.misc.chardev, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevMiscLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.misc.chardev);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.misc.chardev) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.misc.chardev,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.misc.chardev, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceHostdevStorageLive",
          "args": [
            "vm",
            "dev"
          ],
          "line": 4228
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceHostdevStorageLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4110-4154",
          "snippet": "static int\nlxcDomainDetachDeviceHostdevStorageLive(virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.storage.block);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.storage.block) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.storage.block,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevStorageLive(virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.storage.block);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.storage.block) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.storage.block,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevCapsLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainDetachDeviceHostdevStorageLive(vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainDetachDeviceHostdevMiscLive(vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceHostdevSubsysLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4204-4219",
    "snippet": "static int\nlxcDomainDetachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainDetachDeviceHostdevUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported host device type %s\")",
            "virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type)"
          ],
          "line": 4214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevSubsysTypeToString",
          "args": [
            "dev->data.hostdev->source.subsys.type"
          ],
          "line": 4216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported host device type %s\""
          ],
          "line": 4215
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainDetachDeviceHostdevUSBLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 4211
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDetachDeviceHostdevUSBLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "4049-4107",
          "snippet": "static int\nlxcDomainDetachDeviceHostdevUSBLive(virLXCDriverPtr driver,\n                                    virDomainObjPtr vm,\n                                    virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    virUSBDevicePtr usb = NULL;\n    virHostdevManagerPtr hostdev_mgr = driver->hostdevMgr;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"usb device not found\"));\n        goto cleanup;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    dst = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCTeardownHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 dst, vm->def->name, virGetLastErrorMessage());\n\n    virObjectLock(hostdev_mgr->activeUSBHostdevs);\n    virUSBDeviceListDel(hostdev_mgr->activeUSBHostdevs, usb);\n    virObjectUnlock(hostdev_mgr->activeUSBHostdevs);\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    virUSBDeviceFree(usb);\n    VIR_FREE(dst);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevUSBLive(virLXCDriverPtr driver,\n                                    virDomainObjPtr vm,\n                                    virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    virUSBDevicePtr usb = NULL;\n    virHostdevManagerPtr hostdev_mgr = driver->hostdevMgr;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"usb device not found\"));\n        goto cleanup;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    dst = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCTeardownHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 dst, vm->def->name, virGetLastErrorMessage());\n\n    virObjectLock(hostdev_mgr->activeUSBHostdevs);\n    virUSBDeviceListDel(hostdev_mgr->activeUSBHostdevs, usb);\n    virObjectUnlock(hostdev_mgr->activeUSBHostdevs);\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    virUSBDeviceFree(usb);\n    VIR_FREE(dst);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainDetachDeviceHostdevUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceHostdevMiscLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4157-4201",
    "snippet": "static int\nlxcDomainDetachDeviceHostdevMiscLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.misc.chardev);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.misc.chardev) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.misc.chardev,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.misc.chardev, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainHostdevDefFree",
          "args": [
            "def"
          ],
          "line": 4198
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3002-3015",
          "snippet": "void virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevRemove",
          "args": [
            "vm->def",
            "idx"
          ],
          "line": 4197
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17015-17022",
          "snippet": "virDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "def->source.caps.u.misc.chardev",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 4194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 4195
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "def->source.caps.u.misc.chardev",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 4192
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "def",
            "\"detach\"",
            "true"
          ],
          "line": 4190
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceUnlink",
          "args": [
            "vm",
            "def->source.caps.u.misc.chardev"
          ],
          "line": 4186
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceUnlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3322-3335",
          "snippet": "static int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"devices cgroup isn't mounted\")"
          ],
          "line": 4181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"devices cgroup isn't mounted\""
          ],
          "line": 4182
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 4180
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"hostdev %s not found\")",
            "dev->data.hostdev->source.caps.u.misc.chardev"
          ],
          "line": 4174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vm->def",
            "dev->data.hostdev",
            "&def"
          ],
          "line": 4171
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach disk until init PID is known\")"
          ],
          "line": 4166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevMiscLive(virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.misc.chardev);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.misc.chardev) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.misc.chardev,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.misc.chardev, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceHostdevStorageLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4110-4154",
    "snippet": "static int\nlxcDomainDetachDeviceHostdevStorageLive(virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.storage.block);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.storage.block) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.storage.block,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainHostdevDefFree",
          "args": [
            "def"
          ],
          "line": 4151
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3002-3015",
          "snippet": "void virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevRemove",
          "args": [
            "vm->def",
            "idx"
          ],
          "line": 4150
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17015-17022",
          "snippet": "virDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "def->source.caps.u.storage.block",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 4147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 4148
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "def->source.caps.u.storage.block",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 4145
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "def",
            "\"detach\"",
            "true"
          ],
          "line": 4143
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceUnlink",
          "args": [
            "vm",
            "def->source.caps.u.storage.block"
          ],
          "line": 4139
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceUnlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3322-3335",
          "snippet": "static int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"devices cgroup isn't mounted\")"
          ],
          "line": 4134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"devices cgroup isn't mounted\""
          ],
          "line": 4135
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 4133
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"hostdev %s not found\")",
            "dev->data.hostdev->source.caps.u.storage.block"
          ],
          "line": 4127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vm->def",
            "dev->data.hostdev",
            "&def"
          ],
          "line": 4124
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach disk until init PID is known\")"
          ],
          "line": 4119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevStorageLive(virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"hostdev %s not found\"),\n                       dev->data.hostdev->source.caps.u.storage.block);\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, def->source.caps.u.storage.block) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        return -1;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, def->source.caps.u.storage.block,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceHostdevUSBLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "4049-4107",
    "snippet": "static int\nlxcDomainDetachDeviceHostdevUSBLive(virLXCDriverPtr driver,\n                                    virDomainObjPtr vm,\n                                    virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    virUSBDevicePtr usb = NULL;\n    virHostdevManagerPtr hostdev_mgr = driver->hostdevMgr;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"usb device not found\"));\n        goto cleanup;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    dst = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCTeardownHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 dst, vm->def->name, virGetLastErrorMessage());\n\n    virObjectLock(hostdev_mgr->activeUSBHostdevs);\n    virUSBDeviceListDel(hostdev_mgr->activeUSBHostdevs, usb);\n    virObjectUnlock(hostdev_mgr->activeUSBHostdevs);\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    virUSBDeviceFree(usb);\n    VIR_FREE(dst);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dst"
          ],
          "line": 4105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUSBDeviceFree",
          "args": [
            "usb"
          ],
          "line": 4104
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "353-363",
          "snippet": "void\nvirUSBDeviceFree(virUSBDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirUSBDeviceFree(virUSBDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevDefFree",
          "args": [
            "def"
          ],
          "line": 4099
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3002-3015",
          "snippet": "void virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevRemove",
          "args": [
            "vm->def",
            "idx"
          ],
          "line": 4098
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17015-17022",
          "snippet": "virDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "hostdev_mgr->activeUSBHostdevs"
          ],
          "line": 4096
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceListDel",
          "args": [
            "hostdev_mgr->activeUSBHostdevs",
            "usb"
          ],
          "line": 4095
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceListDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "490-495",
          "snippet": "void\nvirUSBDeviceListDel(virUSBDeviceListPtr list,\n                    virUSBDevicePtr dev)\n{\n    virUSBDeviceFree(virUSBDeviceListSteal(list, dev));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirUSBDeviceListDel(virUSBDeviceListPtr list,\n                    virUSBDevicePtr dev)\n{\n    virUSBDeviceFree(virUSBDeviceListSteal(list, dev));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "hostdev_mgr->activeUSBHostdevs"
          ],
          "line": 4094
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "dst",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 4091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 4092
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceFileIterate",
          "args": [
            "usb",
            "virLXCTeardownHostUSBDeviceCgroup",
            "priv->cgroup"
          ],
          "line": 4088
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceFileIterate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "409-414",
          "snippet": "int virUSBDeviceFileIterate(virUSBDevicePtr dev,\n                            virUSBDeviceFileActor actor,\n                            void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint virUSBDeviceFileIterate(virUSBDevicePtr dev,\n                            virUSBDeviceFileActor actor,\n                            void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "def",
            "\"detach\"",
            "true"
          ],
          "line": 4086
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceUnlink",
          "args": [
            "vm",
            "dst"
          ],
          "line": 4082
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceUnlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3322-3335",
          "snippet": "static int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceNew",
          "args": [
            "usbsrc->bus",
            "usbsrc->device",
            "NULL"
          ],
          "line": 4079
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "308-351",
          "snippet": "virUSBDevicePtr\nvirUSBDeviceNew(unsigned int bus,\n                unsigned int devno,\n                const char *vroot)\n{\n    virUSBDevicePtr dev;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->bus     = bus;\n    dev->dev     = devno;\n\n    if (g_snprintf(dev->name, sizeof(dev->name), \"%.3d:%.3d\",\n                   dev->bus, dev->dev) >= sizeof(dev->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->name buffer overflow: %.3d:%.3d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    if (vroot) {\n        dev->path = g_strdup_printf(\"%s/%03d/%03d\",\n                                    vroot, dev->bus, dev->dev);\n    } else {\n        dev->path = g_strdup_printf(USB_DEVFS \"%03d/%03d\",\n                                    dev->bus, dev->dev);\n    }\n\n    /* XXX fixme. this should be product/vendor */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%d %d\", dev->bus,\n                   dev->dev) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %d %d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return dev;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvirUSBDevicePtr\nvirUSBDeviceNew(unsigned int bus,\n                unsigned int devno,\n                const char *vroot)\n{\n    virUSBDevicePtr dev;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->bus     = bus;\n    dev->dev     = devno;\n\n    if (g_snprintf(dev->name, sizeof(dev->name), \"%.3d:%.3d\",\n                   dev->bus, dev->dev) >= sizeof(dev->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->name buffer overflow: %.3d:%.3d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    if (vroot) {\n        dev->path = g_strdup_printf(\"%s/%03d/%03d\",\n                                    vroot, dev->bus, dev->dev);\n    } else {\n        dev->path = g_strdup_printf(USB_DEVFS \"%03d/%03d\",\n                                    dev->bus, dev->dev);\n    }\n\n    /* XXX fixme. this should be product/vendor */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%d %d\", dev->bus,\n                   dev->dev) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %d %d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"devices cgroup isn't mounted\")"
          ],
          "line": 4074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"devices cgroup isn't mounted\""
          ],
          "line": 4075
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 4073
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/bus/usb/%03d/%03d\"",
            "usbsrc->bus",
            "usbsrc->device"
          ],
          "line": 4071
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"usb device not found\")"
          ],
          "line": 4065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vm->def",
            "dev->data.hostdev",
            "&def"
          ],
          "line": 4062
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceHostdevUSBLive(virLXCDriverPtr driver,\n                                    virDomainObjPtr vm,\n                                    virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    virUSBDevicePtr usb = NULL;\n    virHostdevManagerPtr hostdev_mgr = driver->hostdevMgr;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if ((idx = virDomainHostdevFind(vm->def,\n                                    dev->data.hostdev,\n                                    &def)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"usb device not found\"));\n        goto cleanup;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    dst = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditHostdev(vm, def, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditHostdev(vm, def, \"detach\", true);\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCTeardownHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 dst, vm->def->name, virGetLastErrorMessage());\n\n    virObjectLock(hostdev_mgr->activeUSBHostdevs);\n    virUSBDeviceListDel(hostdev_mgr->activeUSBHostdevs, usb);\n    virObjectUnlock(hostdev_mgr->activeUSBHostdevs);\n\n    virDomainHostdevRemove(vm->def, idx);\n    virDomainHostdevDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    virUSBDeviceFree(usb);\n    VIR_FREE(dst);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceNetLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3963-4046",
    "snippet": "static int\nlxcDomainDetachDeviceNetLive(virDomainObjPtr vm,\n                             virDomainDeviceDefPtr dev)\n{\n    int detachidx, ret = -1;\n    virDomainNetType actualType;\n    virDomainNetDefPtr detach = NULL;\n    const virNetDevVPortProfile *vport = NULL;\n    virErrorPtr save_err = NULL;\n\n    if ((detachidx = virDomainNetFindIdx(vm->def, dev->data.net)) < 0)\n        goto cleanup;\n\n    detach = vm->def->nets[detachidx];\n    actualType = virDomainNetGetActualType(detach);\n\n    /* clear network bandwidth */\n    if (virDomainNetGetActualBandwidth(detach) &&\n        virNetDevSupportsBandwidth(actualType) &&\n        virNetDevBandwidthClear(detach->ifname))\n        goto cleanup;\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (virNetDevVethDelete(detach->ifname) < 0) {\n            virDomainAuditNet(vm, detach, NULL, \"detach\", false);\n            goto cleanup;\n        }\n        break;\n\n        /* It'd be nice to support this, but with macvlan\n         * once assigned to a container nothing exists on\n         * the host side. Further the container can change\n         * the mac address of NIC name, so we can't easily\n         * find out which guest NIC it maps to\n         */\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only bridged veth devices can be detached\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, detach, NULL, \"detach\", true);\n\n    virDomainConfNWFilterTeardown(detach);\n\n    vport = virDomainNetGetActualVirtPortProfile(detach);\n    if (vport && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH)\n        ignore_value(virNetDevOpenvswitchRemovePort(\n                        virDomainNetGetActualBridgeName(detach),\n                        detach->ifname));\n    ret = 0;\n cleanup:\n    if (!ret) {\n        virErrorPreserveLast(&save_err);\n        if (detach->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n            virConnectPtr conn = virGetConnectNetwork();\n            if (conn) {\n                virDomainNetReleaseActualDevice(conn, vm->def, detach);\n                virObjectUnref(conn);\n            } else {\n                VIR_WARN(\"Unable to release network device '%s'\", NULLSTR(detach->ifname));\n            }\n        }\n        virDomainNetRemove(vm->def, detachidx);\n        virDomainNetDefFree(detach);\n        virErrorRestore(&save_err);\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&save_err"
          ],
          "line": 4043
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetDefFree",
          "args": [
            "detach"
          ],
          "line": 4042
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2481-2489",
          "snippet": "void\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetRemove",
          "args": [
            "vm->def",
            "detachidx"
          ],
          "line": 4041
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17557-17565",
          "snippet": "virDomainNetDefPtr\nvirDomainNetRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainNetDefPtr net = def->nets[i];\n\n    virDomainNetRemoveHostdev(def, net);\n    VIR_DELETE_ELEMENT(def->nets, i, def->nnets);\n    return net;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetDefPtr\nvirDomainNetRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainNetDefPtr net = def->nets[i];\n\n    virDomainNetRemoveHostdev(def, net);\n    VIR_DELETE_ELEMENT(def->nets, i, def->nnets);\n    return net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to release network device '%s'\"",
            "NULLSTR(detach->ifname)"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "detach->ifname"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "conn"
          ],
          "line": 4036
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetReleaseActualDevice",
          "args": [
            "conn",
            "vm->def",
            "detach"
          ],
          "line": 4035
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetReleaseActualDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "31536-31564",
          "snippet": "int\nvirDomainNetReleaseActualDevice(virConnectPtr conn,\n                                virDomainDefPtr dom G_GNUC_UNUSED,\n                                virDomainNetDefPtr iface)\n{\n    virNetworkPtr net = NULL;\n    virNetworkPortPtr port = NULL;\n    int ret = -1;\n\n    /* Port might not exist if a failure occurred during VM startup */\n    if (!virUUIDIsValid(iface->data.network.portid)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!(net = virNetworkLookupByName(conn, iface->data.network.name)))\n        goto cleanup;\n\n    if (!(port = virNetworkPortLookupByUUID(net, iface->data.network.portid)))\n        goto cleanup;\n\n    if (virNetworkPortDelete(port, 0) < 0)\n        goto cleanup;\n\n cleanup:\n    virObjectUnref(port);\n    virObjectUnref(net);\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetReleaseActualDevice(virConnectPtr conn,\n                                virDomainDefPtr dom G_GNUC_UNUSED,\n                                virDomainNetDefPtr iface)\n{\n    virNetworkPtr net = NULL;\n    virNetworkPortPtr port = NULL;\n    int ret = -1;\n\n    /* Port might not exist if a failure occurred during VM startup */\n    if (!virUUIDIsValid(iface->data.network.portid)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!(net = virNetworkLookupByName(conn, iface->data.network.name)))\n        goto cleanup;\n\n    if (!(port = virNetworkPortLookupByUUID(net, iface->data.network.portid)))\n        goto cleanup;\n\n    if (virNetworkPortDelete(port, 0) < 0)\n        goto cleanup;\n\n cleanup:\n    virObjectUnref(port);\n    virObjectUnref(net);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetConnectNetwork",
          "args": [],
          "line": 4033
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "169-172",
          "snippet": "virConnectPtr virGetConnectNetwork(void)\n{\n    return virGetConnectGeneric(&connectNetwork, \"network\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNetwork;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNetwork;\n\nvirConnectPtr virGetConnectNetwork(void)\n{\n    return virGetConnectGeneric(&connectNetwork, \"network\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&save_err"
          ],
          "line": 4031
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevOpenvswitchRemovePort(\n                        virDomainNetGetActualBridgeName(detach),\n                        detach->ifname)"
          ],
          "line": 4025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevOpenvswitchRemovePort",
          "args": [
            "virDomainNetGetActualBridgeName(detach)",
            "detach->ifname"
          ],
          "line": 4025
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevOpenvswitchRemovePort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevopenvswitch.c",
          "lines": "205-220",
          "snippet": "int virNetDevOpenvswitchRemovePort(const char *brname G_GNUC_UNUSED, const char *ifname)\n{\n    g_autoptr(virCommand) cmd = NULL;\n\n    cmd = virCommandNew(OVSVSCTL);\n    virNetDevOpenvswitchAddTimeout(cmd);\n    virCommandAddArgList(cmd, \"--\", \"--if-exists\", \"del-port\", ifname, NULL);\n\n    if (virCommandRun(cmd, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to delete port %s from OVS\"), ifname);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virjson.h\"",
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virjson.h\"\n#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"virmacaddr.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virnetdevopenvswitch.h\"\n#include <config.h>\n\nint virNetDevOpenvswitchRemovePort(const char *brname G_GNUC_UNUSED, const char *ifname)\n{\n    g_autoptr(virCommand) cmd = NULL;\n\n    cmd = virCommandNew(OVSVSCTL);\n    virNetDevOpenvswitchAddTimeout(cmd);\n    virCommandAddArgList(cmd, \"--\", \"--if-exists\", \"del-port\", ifname, NULL);\n\n    if (virCommandRun(cmd, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to delete port %s from OVS\"), ifname);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBridgeName",
          "args": [
            "detach"
          ],
          "line": 4026
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBridgeName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30164-30175",
          "snippet": "const char *\nvirDomainNetGetActualBridgeName(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_BRIDGE)\n        return iface->data.bridge.brname;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.brname;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainNetGetActualBridgeName(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_BRIDGE)\n        return iface->data.bridge.brname;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.brname;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualVirtPortProfile",
          "args": [
            "detach"
          ],
          "line": 4023
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualVirtPortProfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30224-30255",
          "snippet": "const virNetDevVPortProfile *\nvirDomainNetGetActualVirtPortProfile(const virDomainNetDef *iface)\n{\n    switch (iface->type) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        return iface->virtPortProfile;\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (!iface->data.network.actual)\n            return NULL;\n        switch (iface->data.network.actual->type) {\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n            return iface->data.network.actual->virtPortProfile;\n        default:\n            return NULL;\n        }\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevVPortProfile *\nvirDomainNetGetActualVirtPortProfile(const virDomainNetDef *iface)\n{\n    switch (iface->type) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        return iface->virtPortProfile;\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (!iface->data.network.actual)\n            return NULL;\n        switch (iface->data.network.actual->type) {\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n            return iface->data.network.actual->virtPortProfile;\n        default:\n            return NULL;\n        }\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainConfNWFilterTeardown",
          "args": [
            "detach"
          ],
          "line": 4021
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfNWFilterTeardown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
          "lines": "143-157",
          "snippet": "void\nvirDomainConfNWFilterTeardown(virDomainNetDefPtr net)\n{\n    virConnectPtr conn;\n\n    if (!net->filter)\n        return;\n\n    if (!(conn = virGetConnectNWFilter()))\n        return;\n\n    virDomainConfNWFilterTeardownImpl(conn, net);\n\n    virObjectUnref(conn);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainConfNWFilterTeardown(virDomainNetDefPtr net)\n{\n    virConnectPtr conn;\n\n    if (!net->filter)\n        return;\n\n    if (!(conn = virGetConnectNWFilter()))\n        return;\n\n    virDomainConfNWFilterTeardownImpl(conn, net);\n\n    virObjectUnref(conn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditNet",
          "args": [
            "vm",
            "detach",
            "NULL",
            "\"detach\"",
            "true"
          ],
          "line": 4019
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "266-284",
          "snippet": "void\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virDomainNetType",
            "actualType"
          ],
          "line": 4015
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only bridged veth devices can be detached\")"
          ],
          "line": 4010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Only bridged veth devices can be detached\""
          ],
          "line": 4011
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevVethDelete",
          "args": [
            "detach->ifname"
          ],
          "line": 3989
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVethDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevveth.c",
          "lines": "189-209",
          "snippet": "int virNetDevVethDelete(const char *veth)\n{\n    int status;\n    g_autoptr(virCommand) cmd = virCommandNewArgList(\"ip\", \"link\",\n                                                       \"del\", veth, NULL);\n\n    if (virCommandRun(cmd, &status) < 0)\n        return -1;\n\n    if (status != 0) {\n        if (!virNetDevExists(veth)) {\n            VIR_DEBUG(\"Device %s already deleted (by kernel namespace cleanup)\", veth);\n            return 0;\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to delete veth device %s\"), veth);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdevveth.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virnetdevveth.h\"\n#include <config.h>\n\nint virNetDevVethDelete(const char *veth)\n{\n    int status;\n    g_autoptr(virCommand) cmd = virCommandNewArgList(\"ip\", \"link\",\n                                                       \"del\", veth, NULL);\n\n    if (virCommandRun(cmd, &status) < 0)\n        return -1;\n\n    if (status != 0) {\n        if (!virNetDevExists(veth)) {\n            VIR_DEBUG(\"Device %s already deleted (by kernel namespace cleanup)\", veth);\n            return 0;\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to delete veth device %s\"), veth);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBandwidthClear",
          "args": [
            "detach->ifname"
          ],
          "line": 3982
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBandwidthClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbandwidth.c",
          "lines": "404-431",
          "snippet": "int\nvirNetDevBandwidthClear(const char *ifname)\n{\n    int ret = 0;\n    int dummy; /* for ignoring the exit status */\n    virCommandPtr cmd = NULL;\n\n    if (!ifname)\n       return 0;\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\", \"del\", \"dev\", ifname, \"root\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\",  \"del\", \"dev\", ifname, \"ingress\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virnetdevbandwidth.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetDevBandwidthClear(const char *ifname)\n{\n    int ret = 0;\n    int dummy; /* for ignoring the exit status */\n    virCommandPtr cmd = NULL;\n\n    if (!ifname)\n       return 0;\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\", \"del\", \"dev\", ifname, \"root\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    cmd = virCommandNew(TC);\n    virCommandAddArgList(cmd, \"qdisc\",  \"del\", \"dev\", ifname, \"ingress\", NULL);\n\n    if (virCommandRun(cmd, &dummy) < 0)\n        ret = -1;\n\n    virCommandFree(cmd);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSupportsBandwidth",
          "args": [
            "actualType"
          ],
          "line": 3981
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSupportsBandwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
          "lines": "302-322",
          "snippet": "bool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nbool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBandwidth",
          "args": [
            "detach"
          ],
          "line": 3980
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBandwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30257-30267",
          "snippet": "const virNetDevBandwidth *\nvirDomainNetGetActualBandwidth(const virDomainNetDef *iface)\n{\n    /* if there is an ActualNetDef, *always* return\n     * its bandwidth rather than the NetDef's bandwidth.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        return iface->data.network.actual->bandwidth;\n    return iface->bandwidth;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevBandwidth *\nvirDomainNetGetActualBandwidth(const virDomainNetDef *iface)\n{\n    /* if there is an ActualNetDef, *always* return\n     * its bandwidth rather than the NetDef's bandwidth.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        return iface->data.network.actual->bandwidth;\n    return iface->bandwidth;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualType",
          "args": [
            "detach"
          ],
          "line": 3977
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30154-30162",
          "snippet": "virDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetFindIdx",
          "args": [
            "vm->def",
            "dev->data.net"
          ],
          "line": 3973
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetFindIdx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17444-17513",
          "snippet": "int\nvirDomainNetFindIdx(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    size_t i;\n    int matchidx = -1;\n    char mac[VIR_MAC_STRING_BUFLEN];\n    bool MACAddrSpecified = !net->mac_generated;\n    bool PCIAddrSpecified = virDomainDeviceAddressIsValid(&net->info,\n                                                          VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI);\n\n    for (i = 0; i < def->nnets; i++) {\n        if (MACAddrSpecified &&\n            virMacAddrCmp(&def->nets[i]->mac, &net->mac) != 0)\n            continue;\n\n        if (PCIAddrSpecified &&\n            !virPCIDeviceAddressEqual(&def->nets[i]->info.addr.pci,\n                                      &net->info.addr.pci))\n            continue;\n\n        if (matchidx >= 0) {\n            /* there were multiple matches on mac address, and no\n             * qualifying guest-side PCI address was given, so we must\n             * fail (NB: a USB address isn't adequate, since it may\n             * specify only vendor and product ID, and there may be\n             * multiples of those.\n             */\n            if (MACAddrSpecified) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               _(\"multiple devices matching MAC address %s found\"),\n                               virMacAddrFormat(&net->mac, mac));\n            } else {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"multiple matching devices found\"));\n            }\n\n            return -1;\n        }\n\n        matchidx = i;\n    }\n\n    if (matchidx < 0) {\n        if (MACAddrSpecified && PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found on \"\n                             VIR_PCI_DEVICE_ADDRESS_FMT),\n                           virMacAddrFormat(&net->mac, mac),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device found on \" VIR_PCI_DEVICE_ADDRESS_FMT),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (MACAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found\"),\n                           virMacAddrFormat(&net->mac, mac));\n        } else {\n            virReportError(VIR_ERR_DEVICE_MISSING, \"%s\",\n                           _(\"no matching device found\"));\n        }\n    }\n    return matchidx;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetFindIdx(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    size_t i;\n    int matchidx = -1;\n    char mac[VIR_MAC_STRING_BUFLEN];\n    bool MACAddrSpecified = !net->mac_generated;\n    bool PCIAddrSpecified = virDomainDeviceAddressIsValid(&net->info,\n                                                          VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI);\n\n    for (i = 0; i < def->nnets; i++) {\n        if (MACAddrSpecified &&\n            virMacAddrCmp(&def->nets[i]->mac, &net->mac) != 0)\n            continue;\n\n        if (PCIAddrSpecified &&\n            !virPCIDeviceAddressEqual(&def->nets[i]->info.addr.pci,\n                                      &net->info.addr.pci))\n            continue;\n\n        if (matchidx >= 0) {\n            /* there were multiple matches on mac address, and no\n             * qualifying guest-side PCI address was given, so we must\n             * fail (NB: a USB address isn't adequate, since it may\n             * specify only vendor and product ID, and there may be\n             * multiples of those.\n             */\n            if (MACAddrSpecified) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               _(\"multiple devices matching MAC address %s found\"),\n                               virMacAddrFormat(&net->mac, mac));\n            } else {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"multiple matching devices found\"));\n            }\n\n            return -1;\n        }\n\n        matchidx = i;\n    }\n\n    if (matchidx < 0) {\n        if (MACAddrSpecified && PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found on \"\n                             VIR_PCI_DEVICE_ADDRESS_FMT),\n                           virMacAddrFormat(&net->mac, mac),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device found on \" VIR_PCI_DEVICE_ADDRESS_FMT),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (MACAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found\"),\n                           virMacAddrFormat(&net->mac, mac));\n        } else {\n            virReportError(VIR_ERR_DEVICE_MISSING, \"%s\",\n                           _(\"no matching device found\"));\n        }\n    }\n    return matchidx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceNetLive(virDomainObjPtr vm,\n                             virDomainDeviceDefPtr dev)\n{\n    int detachidx, ret = -1;\n    virDomainNetType actualType;\n    virDomainNetDefPtr detach = NULL;\n    const virNetDevVPortProfile *vport = NULL;\n    virErrorPtr save_err = NULL;\n\n    if ((detachidx = virDomainNetFindIdx(vm->def, dev->data.net)) < 0)\n        goto cleanup;\n\n    detach = vm->def->nets[detachidx];\n    actualType = virDomainNetGetActualType(detach);\n\n    /* clear network bandwidth */\n    if (virDomainNetGetActualBandwidth(detach) &&\n        virNetDevSupportsBandwidth(actualType) &&\n        virNetDevBandwidthClear(detach->ifname))\n        goto cleanup;\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (virNetDevVethDelete(detach->ifname) < 0) {\n            virDomainAuditNet(vm, detach, NULL, \"detach\", false);\n            goto cleanup;\n        }\n        break;\n\n        /* It'd be nice to support this, but with macvlan\n         * once assigned to a container nothing exists on\n         * the host side. Further the container can change\n         * the mac address of NIC name, so we can't easily\n         * find out which guest NIC it maps to\n         */\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Only bridged veth devices can be detached\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, detach, NULL, \"detach\", true);\n\n    virDomainConfNWFilterTeardown(detach);\n\n    vport = virDomainNetGetActualVirtPortProfile(detach);\n    if (vport && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH)\n        ignore_value(virNetDevOpenvswitchRemovePort(\n                        virDomainNetGetActualBridgeName(detach),\n                        detach->ifname));\n    ret = 0;\n cleanup:\n    if (!ret) {\n        virErrorPreserveLast(&save_err);\n        if (detach->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n            virConnectPtr conn = virGetConnectNetwork();\n            if (conn) {\n                virDomainNetReleaseActualDevice(conn, vm->def, detach);\n                virObjectUnref(conn);\n            } else {\n                VIR_WARN(\"Unable to release network device '%s'\", NULLSTR(detach->ifname));\n            }\n        }\n        virDomainNetRemove(vm->def, detachidx);\n        virDomainNetDefFree(detach);\n        virErrorRestore(&save_err);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceDiskLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3906-3960",
    "snippet": "static int\nlxcDomainDetachDeviceDiskLive(virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    const char *src;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if ((idx = virDomainDiskIndexByName(vm->def,\n                                        dev->data.disk->dst,\n                                        false)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"disk %s not found\"), dev->data.disk->dst);\n        goto cleanup;\n    }\n\n    def = vm->def->disks[idx];\n    src = virDomainDiskGetSource(def);\n\n    dst = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditDisk(vm, def->src, NULL, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditDisk(vm, def->src, NULL, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, src,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 src, vm->def->name, virGetLastErrorMessage());\n\n    virDomainDiskRemove(vm->def, idx);\n    virDomainDiskDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(dst);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dst"
          ],
          "line": 3958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskDefFree",
          "args": [
            "def"
          ],
          "line": 3953
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2117-2138",
          "snippet": "void\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskRemove",
          "args": [
            "vm->def",
            "idx"
          ],
          "line": 3952
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskRemoveByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17406-17413",
          "snippet": "virDomainDiskDefPtr\nvirDomainDiskRemoveByName(virDomainDefPtr def, const char *name)\n{\n    int idx = virDomainDiskIndexByName(def, name, false);\n    if (idx < 0)\n        return NULL;\n    return virDomainDiskRemove(def, idx);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDiskDefPtr\nvirDomainDiskRemoveByName(virDomainDefPtr def, const char *name)\n{\n    int idx = virDomainDiskIndexByName(def, name, false);\n    if (idx < 0)\n        return NULL;\n    return virDomainDiskRemove(def, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "src",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 3949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 3950
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevicePath",
          "args": [
            "priv->cgroup",
            "src",
            "VIR_CGROUP_DEVICE_RWM",
            "false"
          ],
          "line": 3947
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevicePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3316-3325",
          "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditDisk",
          "args": [
            "vm",
            "def->src",
            "NULL",
            "\"detach\"",
            "true"
          ],
          "line": 3945
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "190-207",
          "snippet": "void\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceUnlink",
          "args": [
            "vm",
            "dst"
          ],
          "line": 3941
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceUnlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3322-3335",
          "snippet": "static int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"devices cgroup isn't mounted\")"
          ],
          "line": 3936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"devices cgroup isn't mounted\""
          ],
          "line": 3937
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 3935
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/%s\"",
            "def->dst"
          ],
          "line": 3933
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "def"
          ],
          "line": 3931
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"disk %s not found\")",
            "dev->data.disk->dst"
          ],
          "line": 3925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskIndexByName",
          "args": [
            "vm->def",
            "dev->data.disk->dst",
            "false"
          ],
          "line": 3922
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskIndexByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17299-17325",
          "snippet": "int\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach disk until init PID is known\")"
          ],
          "line": 3917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceDiskLive(virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = NULL;\n    int idx, ret = -1;\n    char *dst = NULL;\n    const char *src;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if ((idx = virDomainDiskIndexByName(vm->def,\n                                        dev->data.disk->dst,\n                                        false)) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"disk %s not found\"), dev->data.disk->dst);\n        goto cleanup;\n    }\n\n    def = vm->def->disks[idx];\n    src = virDomainDiskGetSource(def);\n\n    dst = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    if (lxcDomainAttachDeviceUnlink(vm, dst) < 0) {\n        virDomainAuditDisk(vm, def->src, NULL, \"detach\", false);\n        goto cleanup;\n    }\n    virDomainAuditDisk(vm, def->src, NULL, \"detach\", true);\n\n    if (virCgroupDenyDevicePath(priv->cgroup, src,\n                                VIR_CGROUP_DEVICE_RWM, false) != 0)\n        VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                 src, vm->def->name, virGetLastErrorMessage());\n\n    virDomainDiskRemove(vm->def, idx);\n    virDomainDiskDefFree(def);\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(dst);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3868-3903",
    "snippet": "static int\nlxcDomainAttachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainAttachDeviceDiskLive(driver, vm, dev);\n        if (!ret)\n            dev->data.disk = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainAttachDeviceNetLive(driver, vm,\n                                           dev->data.net);\n        if (!ret)\n            dev->data.net = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainAttachDeviceHostdevLive(driver, vm, dev);\n        if (!ret)\n            dev->data.hostdev = NULL;\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be attached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"device type '%s' cannot be attached\")",
            "virDomainDeviceTypeToString(dev->type)"
          ],
          "line": 3896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDeviceTypeToString",
          "args": [
            "dev->type"
          ],
          "line": 3898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"device type '%s' cannot be attached\""
          ],
          "line": 3897
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceHostdevLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3890
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceHostdevLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3833-3865",
          "snippet": "static int\nlxcDomainAttachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainAttachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainAttachDeviceHostdevCapsLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainAttachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainAttachDeviceHostdevCapsLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceNetLive",
          "args": [
            "driver",
            "vm",
            "dev->data.net"
          ],
          "line": 3883
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceNetLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3440-3575",
          "snippet": "static int\nlxcDomainAttachDeviceNetLive(virLXCDriverPtr driver,\n                             virDomainObjPtr vm,\n                             virDomainNetDefPtr net)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    int ret = -1;\n    virDomainNetType actualType;\n    const virNetDevBandwidth *actualBandwidth;\n    char *veth = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if (virLXCProcessValidateInterface(net) < 0)\n       return -1;\n\n    /* preallocate new slot for device */\n    if (VIR_REALLOC_N(vm->def->nets, vm->def->nnets+1) < 0)\n        return -1;\n\n    /* If appropriate, grab a physical device from the configured\n     * network's pool of devices, or resolve bridge device name\n     * to the one defined in the network definition.\n     */\n    if (net->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n        virConnectPtr netconn = virGetConnectNetwork();\n        if (!netconn)\n            return -1;\n        if (virDomainNetAllocateActualDevice(netconn, vm->def, net) < 0) {\n            virObjectUnref(netconn);\n            return -1;\n        }\n        virObjectUnref(netconn);\n    }\n\n    /* final validation now that actual type is known */\n    if (virDomainActualNetDefValidate(net) < 0)\n        return -1;\n\n    actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK: {\n        const char *brname = virDomainNetGetActualBridgeName(net);\n        if (!brname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"No bridge name specified\"));\n            goto cleanup;\n        }\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, brname)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, NULL)))\n            goto cleanup;\n        break;\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        if (!(veth = virLXCProcessSetupInterfaceDirect(driver, vm->def, net)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Network device type is not supported\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n    /* Set bandwidth or warn if requested and not supported. */\n    actualBandwidth = virDomainNetGetActualBandwidth(net);\n    if (actualBandwidth) {\n        if (virNetDevSupportsBandwidth(actualType)) {\n            if (virNetDevBandwidthSet(net->ifname, actualBandwidth, false,\n                                      !virDomainNetTypeSharesHostView(net)) < 0)\n                goto cleanup;\n        } else {\n            VIR_WARN(\"setting bandwidth on interfaces of \"\n                     \"type '%s' is not implemented yet: %s\",\n                     virDomainNetTypeToString(actualType), virGetLastErrorMessage());\n        }\n    }\n\n    if (virNetDevSetNamespace(veth, priv->initpid) < 0) {\n        virDomainAuditNet(vm, NULL, net, \"attach\", false);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, NULL, net, \"attach\", true);\n\n    ret = 0;\n\n cleanup:\n    if (!ret) {\n        vm->def->nets[vm->def->nnets++] = net;\n    } else if (veth) {\n        switch (actualType) {\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_NETWORK:\n        case VIR_DOMAIN_NET_TYPE_ETHERNET:\n            ignore_value(virNetDevVethDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n            ignore_value(virNetDevMacVLanDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_USER:\n        case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n        case VIR_DOMAIN_NET_TYPE_SERVER:\n        case VIR_DOMAIN_NET_TYPE_CLIENT:\n        case VIR_DOMAIN_NET_TYPE_MCAST:\n        case VIR_DOMAIN_NET_TYPE_INTERNAL:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        case VIR_DOMAIN_NET_TYPE_UDP:\n        case VIR_DOMAIN_NET_TYPE_LAST:\n        default:\n            /* no-op */\n            break;\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceNetLive(virLXCDriverPtr driver,\n                             virDomainObjPtr vm,\n                             virDomainNetDefPtr net)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    int ret = -1;\n    virDomainNetType actualType;\n    const virNetDevBandwidth *actualBandwidth;\n    char *veth = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if (virLXCProcessValidateInterface(net) < 0)\n       return -1;\n\n    /* preallocate new slot for device */\n    if (VIR_REALLOC_N(vm->def->nets, vm->def->nnets+1) < 0)\n        return -1;\n\n    /* If appropriate, grab a physical device from the configured\n     * network's pool of devices, or resolve bridge device name\n     * to the one defined in the network definition.\n     */\n    if (net->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n        virConnectPtr netconn = virGetConnectNetwork();\n        if (!netconn)\n            return -1;\n        if (virDomainNetAllocateActualDevice(netconn, vm->def, net) < 0) {\n            virObjectUnref(netconn);\n            return -1;\n        }\n        virObjectUnref(netconn);\n    }\n\n    /* final validation now that actual type is known */\n    if (virDomainActualNetDefValidate(net) < 0)\n        return -1;\n\n    actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK: {\n        const char *brname = virDomainNetGetActualBridgeName(net);\n        if (!brname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"No bridge name specified\"));\n            goto cleanup;\n        }\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, brname)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, NULL)))\n            goto cleanup;\n        break;\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        if (!(veth = virLXCProcessSetupInterfaceDirect(driver, vm->def, net)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Network device type is not supported\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n    /* Set bandwidth or warn if requested and not supported. */\n    actualBandwidth = virDomainNetGetActualBandwidth(net);\n    if (actualBandwidth) {\n        if (virNetDevSupportsBandwidth(actualType)) {\n            if (virNetDevBandwidthSet(net->ifname, actualBandwidth, false,\n                                      !virDomainNetTypeSharesHostView(net)) < 0)\n                goto cleanup;\n        } else {\n            VIR_WARN(\"setting bandwidth on interfaces of \"\n                     \"type '%s' is not implemented yet: %s\",\n                     virDomainNetTypeToString(actualType), virGetLastErrorMessage());\n        }\n    }\n\n    if (virNetDevSetNamespace(veth, priv->initpid) < 0) {\n        virDomainAuditNet(vm, NULL, net, \"attach\", false);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, NULL, net, \"attach\", true);\n\n    ret = 0;\n\n cleanup:\n    if (!ret) {\n        vm->def->nets[vm->def->nnets++] = net;\n    } else if (veth) {\n        switch (actualType) {\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_NETWORK:\n        case VIR_DOMAIN_NET_TYPE_ETHERNET:\n            ignore_value(virNetDevVethDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n            ignore_value(virNetDevMacVLanDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_USER:\n        case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n        case VIR_DOMAIN_NET_TYPE_SERVER:\n        case VIR_DOMAIN_NET_TYPE_CLIENT:\n        case VIR_DOMAIN_NET_TYPE_MCAST:\n        case VIR_DOMAIN_NET_TYPE_INTERNAL:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        case VIR_DOMAIN_NET_TYPE_UDP:\n        case VIR_DOMAIN_NET_TYPE_LAST:\n        default:\n            /* no-op */\n            break;\n        }\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceDiskLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3877
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceDiskLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3338-3437",
          "snippet": "static int\nlxcDomainAttachDeviceDiskLive(virLXCDriverPtr driver,\n                              virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = dev->data.disk;\n    int ret = -1;\n    struct stat sb;\n    char *file = NULL;\n    int perms;\n    const char *src = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    src = virDomainDiskGetSource(def);\n    if (src == NULL) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk without media\"));\n        goto cleanup;\n    }\n\n    if (!virStorageSourceIsBlockLocal(def->src)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk for non-block device\"));\n        goto cleanup;\n    }\n\n    if (virDomainDiskIndexByName(vm->def, def->dst, true) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"target %s already exists\"), def->dst);\n        goto cleanup;\n    }\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Disk source %s must be a block device\"),\n                       src);\n        goto cleanup;\n    }\n\n    perms = (def->src->readonly ?\n             VIR_CGROUP_DEVICE_READ :\n             VIR_CGROUP_DEVICE_RW) |\n        VIR_CGROUP_DEVICE_MKNOD;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             perms) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->disks, vm->def->ndisks + 1) < 0)\n        goto cleanup;\n\n    file = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   file) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                perms) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    virDomainDiskInsertPreAlloced(vm->def, def);\n\n    ret = 0;\n\n cleanup:\n    if (src)\n        virDomainAuditDisk(vm, NULL, def->src, \"attach\", ret == 0);\n    VIR_FREE(file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceDiskLive(virLXCDriverPtr driver,\n                              virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = dev->data.disk;\n    int ret = -1;\n    struct stat sb;\n    char *file = NULL;\n    int perms;\n    const char *src = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    src = virDomainDiskGetSource(def);\n    if (src == NULL) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk without media\"));\n        goto cleanup;\n    }\n\n    if (!virStorageSourceIsBlockLocal(def->src)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk for non-block device\"));\n        goto cleanup;\n    }\n\n    if (virDomainDiskIndexByName(vm->def, def->dst, true) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"target %s already exists\"), def->dst);\n        goto cleanup;\n    }\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Disk source %s must be a block device\"),\n                       src);\n        goto cleanup;\n    }\n\n    perms = (def->src->readonly ?\n             VIR_CGROUP_DEVICE_READ :\n             VIR_CGROUP_DEVICE_RW) |\n        VIR_CGROUP_DEVICE_MKNOD;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             perms) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->disks, vm->def->ndisks + 1) < 0)\n        goto cleanup;\n\n    file = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   file) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                perms) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    virDomainDiskInsertPreAlloced(vm->def, def);\n\n    ret = 0;\n\n cleanup:\n    if (src)\n        virDomainAuditDisk(vm, NULL, def->src, \"attach\", ret == 0);\n    VIR_FREE(file);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceLive(virLXCDriverPtr driver,\n                          virDomainObjPtr vm,\n                          virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        ret = lxcDomainAttachDeviceDiskLive(driver, vm, dev);\n        if (!ret)\n            dev->data.disk = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        ret = lxcDomainAttachDeviceNetLive(driver, vm,\n                                           dev->data.net);\n        if (!ret)\n            dev->data.net = NULL;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        ret = lxcDomainAttachDeviceHostdevLive(driver, vm, dev);\n        if (!ret)\n            dev->data.hostdev = NULL;\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"device type '%s' cannot be attached\"),\n                       virDomainDeviceTypeToString(dev->type));\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceHostdevLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3833-3865",
    "snippet": "static int\nlxcDomainAttachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainAttachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainAttachDeviceHostdevCapsLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported host device mode %s\")",
            "virDomainHostdevModeTypeToString(dev->data.hostdev->mode)"
          ],
          "line": 3860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevModeTypeToString",
          "args": [
            "dev->data.hostdev->mode"
          ],
          "line": 3862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported host device mode %s\""
          ],
          "line": 3861
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceHostdevCapsLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3857
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceHostdevCapsLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3812-3830",
          "snippet": "static int\nlxcDomainAttachDeviceHostdevCapsLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainAttachDeviceHostdevStorageLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainAttachDeviceHostdevMiscLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevCapsLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainAttachDeviceHostdevStorageLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainAttachDeviceHostdevMiscLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceHostdevSubsysLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3854
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceHostdevSubsysLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3794-3809",
          "snippet": "static int\nlxcDomainAttachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainAttachDeviceHostdevSubsysUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainAttachDeviceHostdevSubsysUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"devices cgroup isn't mounted\")"
          ],
          "line": 3847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 3846
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach hostdev until init PID is known\")"
          ],
          "line": 3841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevLive(virLXCDriverPtr driver,\n                                 virDomainObjPtr vm,\n                                 virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach hostdev until init PID is known\"));\n        return -1;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        return -1;\n    }\n\n    switch (dev->data.hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        return lxcDomainAttachDeviceHostdevSubsysLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        return lxcDomainAttachDeviceHostdevCapsLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device mode %s\"),\n                       virDomainHostdevModeTypeToString(dev->data.hostdev->mode));\n        return -1;\n    }\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceHostdevCapsLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3812-3830",
    "snippet": "static int\nlxcDomainAttachDeviceHostdevCapsLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainAttachDeviceHostdevStorageLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainAttachDeviceHostdevMiscLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported host device type %s\")",
            "virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type)"
          ],
          "line": 3825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevCapsTypeToString",
          "args": [
            "dev->data.hostdev->source.caps.type"
          ],
          "line": 3827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported host device type %s\""
          ],
          "line": 3826
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceHostdevMiscLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3822
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceHostdevMiscLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3722-3791",
          "snippet": "static int\nlxcDomainAttachDeviceHostdevMiscLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.misc.chardev) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.misc.chardev, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'c',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.misc.chardev) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'c',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevMiscLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.misc.chardev) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.misc.chardev, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'c',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.misc.chardev) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'c',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceHostdevStorageLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3819
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceHostdevStorageLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3650-3719",
          "snippet": "static int\nlxcDomainAttachDeviceHostdevStorageLive(virLXCDriverPtr driver,\n                                        virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.storage.block) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.storage.block, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.storage.block) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevStorageLive(virLXCDriverPtr driver,\n                                        virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.storage.block) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.storage.block, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.storage.block) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevCapsLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.caps.type) {\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n        return lxcDomainAttachDeviceHostdevStorageLive(driver, vm, dev);\n\n    case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n        return lxcDomainAttachDeviceHostdevMiscLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevCapsTypeToString(dev->data.hostdev->source.caps.type));\n        return -1;\n    }\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceHostdevSubsysLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3794-3809",
    "snippet": "static int\nlxcDomainAttachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainAttachDeviceHostdevSubsysUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unsupported host device type %s\")",
            "virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type)"
          ],
          "line": 3804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevSubsysTypeToString",
          "args": [
            "dev->data.hostdev->source.subsys.type"
          ],
          "line": 3806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unsupported host device type %s\""
          ],
          "line": 3805
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceHostdevSubsysUSBLive",
          "args": [
            "driver",
            "vm",
            "dev"
          ],
          "line": 3801
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceHostdevSubsysUSBLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3578-3647",
          "snippet": "static int\nlxcDomainAttachDeviceHostdevSubsysUSBLive(virLXCDriverPtr driver,\n                                          virDomainObjPtr vm,\n                                          virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    char *src = NULL;\n    struct stat sb;\n    virUSBDevicePtr usb = NULL;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host USB device already exists\"));\n        return -1;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    src = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"USB source %s was not a character device\"),\n                       src);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs + 1) < 0)\n        goto cleanup;\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCSetupHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFCHR,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   src) < 0) {\n        if (virUSBDeviceFileIterate(usb,\n                                    virLXCTeardownHostUSBDeviceCgroup,\n                                    priv->cgroup) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    virUSBDeviceFree(usb);\n    VIR_FREE(src);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevSubsysUSBLive(virLXCDriverPtr driver,\n                                          virDomainObjPtr vm,\n                                          virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    char *src = NULL;\n    struct stat sb;\n    virUSBDevicePtr usb = NULL;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host USB device already exists\"));\n        return -1;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    src = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"USB source %s was not a character device\"),\n                       src);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs + 1) < 0)\n        goto cleanup;\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCSetupHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFCHR,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   src) < 0) {\n        if (virUSBDeviceFileIterate(usb,\n                                    virLXCTeardownHostUSBDeviceCgroup,\n                                    priv->cgroup) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    virUSBDeviceFree(usb);\n    VIR_FREE(src);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevSubsysLive(virLXCDriverPtr driver,\n                                       virDomainObjPtr vm,\n                                       virDomainDeviceDefPtr dev)\n{\n    switch (dev->data.hostdev->source.subsys.type) {\n    case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n        return lxcDomainAttachDeviceHostdevSubsysUSBLive(driver, vm, dev);\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Unsupported host device type %s\"),\n                       virDomainHostdevSubsysTypeToString(dev->data.hostdev->source.subsys.type));\n        return -1;\n    }\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceHostdevMiscLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3722-3791",
    "snippet": "static int\nlxcDomainAttachDeviceHostdevMiscLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.misc.chardev) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.misc.chardev, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'c',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.misc.chardev) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'c',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "def",
            "\"attach\"",
            "ret == 0"
          ],
          "line": 3789
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "def->source.caps.u.storage.block",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 3779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 3780
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevice",
          "args": [
            "priv->cgroup",
            "'c'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "VIR_CGROUP_DEVICE_RWM"
          ],
          "line": 3774
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3303-3313",
          "snippet": "int\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceMknod",
          "args": [
            "driver",
            "0700 | S_IFBLK",
            "sb.st_rdev",
            "vm",
            "dev",
            "def->source.caps.u.misc.chardev"
          ],
          "line": 3768
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceMknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3270-3302",
          "snippet": "static int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "vm->def->hostdevs",
            "vm->def->nhostdevs+1"
          ],
          "line": 3765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevice",
          "args": [
            "priv->cgroup",
            "'c'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "VIR_CGROUP_DEVICE_RWM"
          ],
          "line": 3758
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3278-3288",
          "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Hostdev source %s must be a block device\")",
            "def->source.caps.u.misc.chardev"
          ],
          "line": 3752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Hostdev source %s must be a block device\""
          ],
          "line": 3753
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 3751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to access %s\")",
            "def->source.caps.u.misc.chardev"
          ],
          "line": 3745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "def->source.caps.u.misc.chardev",
            "&sb"
          ],
          "line": 3744
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"host device already exists\")"
          ],
          "line": 3739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vm->def",
            "def",
            "NULL"
          ],
          "line": 3738
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Missing storage block path\")"
          ],
          "line": 3733
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevMiscLive(virLXCDriverPtr driver,\n                                     virDomainObjPtr vm,\n                                     virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.misc.chardev) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.misc.chardev, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.misc.chardev);\n        goto cleanup;\n    }\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'c',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.misc.chardev) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'c',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceHostdevStorageLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3650-3719",
    "snippet": "static int\nlxcDomainAttachDeviceHostdevStorageLive(virLXCDriverPtr driver,\n                                        virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.storage.block) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.storage.block, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.storage.block) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "def",
            "\"attach\"",
            "ret == 0"
          ],
          "line": 3717
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "def->source.caps.u.storage.block",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 3707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 3708
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevice",
          "args": [
            "priv->cgroup",
            "'b'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "VIR_CGROUP_DEVICE_RWM"
          ],
          "line": 3702
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3303-3313",
          "snippet": "int\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceMknod",
          "args": [
            "driver",
            "0700 | S_IFBLK",
            "sb.st_rdev",
            "vm",
            "dev",
            "def->source.caps.u.storage.block"
          ],
          "line": 3696
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceMknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3270-3302",
          "snippet": "static int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevice",
          "args": [
            "priv->cgroup",
            "'b'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "VIR_CGROUP_DEVICE_RWM"
          ],
          "line": 3689
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3278-3288",
          "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "vm->def->hostdevs",
            "vm->def->nhostdevs+1"
          ],
          "line": 3686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Hostdev source %s must be a block device\")",
            "def->source.caps.u.storage.block"
          ],
          "line": 3680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Hostdev source %s must be a block device\""
          ],
          "line": 3681
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 3679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to access %s\")",
            "def->source.caps.u.storage.block"
          ],
          "line": 3673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "def->source.caps.u.storage.block",
            "&sb"
          ],
          "line": 3672
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"host device already exists\")"
          ],
          "line": 3667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vm->def",
            "def",
            "NULL"
          ],
          "line": 3666
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Missing storage block path\")"
          ],
          "line": 3661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevStorageLive(virLXCDriverPtr driver,\n                                        virDomainObjPtr vm,\n                                        virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    struct stat sb;\n\n    if (!def->source.caps.u.storage.block) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Missing storage block path\"));\n        goto cleanup;\n    }\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host device already exists\"));\n        return -1;\n    }\n\n    if (stat(def->source.caps.u.storage.block, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"),\n                             def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Hostdev source %s must be a block device\"),\n                       def->source.caps.u.storage.block);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs+1) < 0)\n        goto cleanup;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             VIR_CGROUP_DEVICE_RWM) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   def->source.caps.u.storage.block) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                VIR_CGROUP_DEVICE_RWM) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     def->source.caps.u.storage.block, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceHostdevSubsysUSBLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3578-3647",
    "snippet": "static int\nlxcDomainAttachDeviceHostdevSubsysUSBLive(virLXCDriverPtr driver,\n                                          virDomainObjPtr vm,\n                                          virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    char *src = NULL;\n    struct stat sb;\n    virUSBDevicePtr usb = NULL;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host USB device already exists\"));\n        return -1;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    src = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"USB source %s was not a character device\"),\n                       src);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs + 1) < 0)\n        goto cleanup;\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCSetupHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFCHR,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   src) < 0) {\n        if (virUSBDeviceFileIterate(usb,\n                                    virLXCTeardownHostUSBDeviceCgroup,\n                                    priv->cgroup) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    virUSBDeviceFree(usb);\n    VIR_FREE(src);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "src"
          ],
          "line": 3645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUSBDeviceFree",
          "args": [
            "usb"
          ],
          "line": 3644
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "353-363",
          "snippet": "void\nvirUSBDeviceFree(virUSBDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirUSBDeviceFree(virUSBDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditHostdev",
          "args": [
            "vm",
            "def",
            "\"attach\"",
            "ret == 0"
          ],
          "line": 3643
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "338-459",
          "snippet": "void\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditHostdev(virDomainObjPtr vm, virDomainHostdevDefPtr hostdev,\n                      const char *reason, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *vmname;\n    char *address = NULL;\n    char *device = NULL;\n    const char *virt = virDomainAuditGetVirtType(vm->def);\n\n    virDomainHostdevSubsysUSBPtr usbsrc = &hostdev->source.subsys.u.usb;\n    virDomainHostdevSubsysPCIPtr pcisrc = &hostdev->source.subsys.u.pci;\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIVHostPtr hostsrc = &hostdev->source.subsys.u.scsi_host;\n    virDomainHostdevSubsysMediatedDevPtr mdevsrc = &hostdev->source.subsys.u.mdev;\n\n    virUUIDFormat(vm->def->uuid, uuidstr);\n    if (!(vmname = virAuditEncode(\"vm\", vm->def->name))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        return;\n    }\n\n    switch ((virDomainHostdevMode) hostdev->mode) {\n    case VIR_DOMAIN_HOSTDEV_MODE_SUBSYS:\n        switch ((virDomainHostdevSubsysType) hostdev->source.subsys.type) {\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_PCI:\n            address = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                                      pcisrc->addr.domain,\n                                      pcisrc->addr.bus,\n                                      pcisrc->addr.slot,\n                                      pcisrc->addr.function);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_USB:\n            address = g_strdup_printf(\"%.3d.%.3d\", usbsrc->bus, usbsrc->device);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI: {\n            if (scsisrc->protocol ==\n                VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI) {\n                /* Follow virDomainAuditDisk && virDomainAuditGenericDev\n                 * and don't audit the networked device.\n                 */\n                goto cleanup;\n            } else {\n                virDomainHostdevSubsysSCSIHostPtr scsihostsrc =\n                    &scsisrc->u.host;\n                address = g_strdup_printf(\"%s:%u:%u:%llu\",\n                                          scsihostsrc->adapter, scsihostsrc->bus,\n                                          scsihostsrc->target,\n                                          scsihostsrc->unit);\n            }\n            break;\n        }\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI_HOST:\n            address = g_strdup(hostsrc->wwpn);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_MDEV:\n            address = g_strdup(mdevsrc->uuidstr);\n            break;\n        case VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_LAST:\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.subsys.type);\n            goto cleanup;\n        }\n\n        if (!(device = virAuditEncode(\"device\", VIR_AUDIT_STR(address)))) {\n            VIR_WARN(\"OOM while encoding audit message\");\n            goto cleanup;\n        }\n\n        VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                  \"virt=%s resrc=dev reason=%s %s uuid=%s bus=%s %s\",\n                  virt, reason, vmname, uuidstr,\n                  virDomainHostdevSubsysTypeToString(hostdev->source.subsys.type),\n                  device);\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES:\n        switch (hostdev->source.caps.type) {\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_STORAGE:\n            if (!(device = virAuditEncode(\"disk\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.storage.block)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        case VIR_DOMAIN_HOSTDEV_CAPS_TYPE_MISC:\n            if (!(device = virAuditEncode(\"chardev\",\n                                          VIR_AUDIT_STR(hostdev->source.caps.u.misc.chardev)))) {\n                VIR_WARN(\"OOM while encoding audit message\");\n                goto cleanup;\n            }\n\n            VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n                      \"virt=%s resrc=hostdev reason=%s %s uuid=%s %s\",\n                      virt, reason, vmname, uuidstr, device);\n            break;\n\n        default:\n            VIR_WARN(\"Unexpected hostdev type while encoding audit message: %d\",\n                     hostdev->source.caps.type);\n            goto cleanup;\n        }\n        break;\n\n    case VIR_DOMAIN_HOSTDEV_MODE_LAST:\n    default:\n        VIR_WARN(\"Unexpected hostdev mode while encoding audit message: %d\",\n                 hostdev->mode);\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(device);\n    VIR_FREE(address);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "src",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 3633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 3634
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceFileIterate",
          "args": [
            "usb",
            "virLXCTeardownHostUSBDeviceCgroup",
            "priv->cgroup"
          ],
          "line": 3630
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceFileIterate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "409-414",
          "snippet": "int virUSBDeviceFileIterate(virUSBDevicePtr dev,\n                            virUSBDeviceFileActor actor,\n                            void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint virUSBDeviceFileIterate(virUSBDevicePtr dev,\n                            virUSBDeviceFileActor actor,\n                            void *opaque)\n{\n    return (actor)(dev, dev->path, opaque);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceMknod",
          "args": [
            "driver",
            "0700 | S_IFCHR",
            "sb.st_rdev",
            "vm",
            "dev",
            "src"
          ],
          "line": 3624
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceMknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3270-3302",
          "snippet": "static int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "vm->def->hostdevs",
            "vm->def->nhostdevs + 1"
          ],
          "line": 3616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"USB source %s was not a character device\")",
            "src"
          ],
          "line": 3610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"USB source %s was not a character device\""
          ],
          "line": 3611
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 3609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to access %s\")",
            "src"
          ],
          "line": 3604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "src",
            "&sb"
          ],
          "line": 3603
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUSBDeviceNew",
          "args": [
            "usbsrc->bus",
            "usbsrc->device",
            "NULL"
          ],
          "line": 3600
        },
        "resolved": true,
        "details": {
          "function_name": "virUSBDeviceNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virusb.c",
          "lines": "308-351",
          "snippet": "virUSBDevicePtr\nvirUSBDeviceNew(unsigned int bus,\n                unsigned int devno,\n                const char *vroot)\n{\n    virUSBDevicePtr dev;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->bus     = bus;\n    dev->dev     = devno;\n\n    if (g_snprintf(dev->name, sizeof(dev->name), \"%.3d:%.3d\",\n                   dev->bus, dev->dev) >= sizeof(dev->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->name buffer overflow: %.3d:%.3d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    if (vroot) {\n        dev->path = g_strdup_printf(\"%s/%03d/%03d\",\n                                    vroot, dev->bus, dev->dev);\n    } else {\n        dev->path = g_strdup_printf(USB_DEVFS \"%03d/%03d\",\n                                    dev->bus, dev->dev);\n    }\n\n    /* XXX fixme. this should be product/vendor */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%d %d\", dev->bus,\n                   dev->dev) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %d %d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return dev;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virusb.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virusb.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nvirUSBDevicePtr\nvirUSBDeviceNew(unsigned int bus,\n                unsigned int devno,\n                const char *vroot)\n{\n    virUSBDevicePtr dev;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->bus     = bus;\n    dev->dev     = devno;\n\n    if (g_snprintf(dev->name, sizeof(dev->name), \"%.3d:%.3d\",\n                   dev->bus, dev->dev) >= sizeof(dev->name)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->name buffer overflow: %.3d:%.3d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    if (vroot) {\n        dev->path = g_strdup_printf(\"%s/%03d/%03d\",\n                                    vroot, dev->bus, dev->dev);\n    } else {\n        dev->path = g_strdup_printf(USB_DEVFS \"%03d/%03d\",\n                                    dev->bus, dev->dev);\n    }\n\n    /* XXX fixme. this should be product/vendor */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%d %d\", dev->bus,\n                   dev->dev) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %d %d\"),\n                       dev->bus, dev->dev);\n        virUSBDeviceFree(dev);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return dev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/bus/usb/%03d/%03d\"",
            "usbsrc->bus",
            "usbsrc->device"
          ],
          "line": 3598
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"host USB device already exists\")"
          ],
          "line": 3592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vm->def",
            "def",
            "NULL"
          ],
          "line": 3591
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceHostdevSubsysUSBLive(virLXCDriverPtr driver,\n                                          virDomainObjPtr vm,\n                                          virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainHostdevDefPtr def = dev->data.hostdev;\n    int ret = -1;\n    char *src = NULL;\n    struct stat sb;\n    virUSBDevicePtr usb = NULL;\n    virDomainHostdevSubsysUSBPtr usbsrc;\n\n    if (virDomainHostdevFind(vm->def, def, NULL) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                       _(\"host USB device already exists\"));\n        return -1;\n    }\n\n    usbsrc = &def->source.subsys.u.usb;\n    src = g_strdup_printf(\"/dev/bus/usb/%03d/%03d\", usbsrc->bus, usbsrc->device);\n\n    if (!(usb = virUSBDeviceNew(usbsrc->bus, usbsrc->device, NULL)))\n        goto cleanup;\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISCHR(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"USB source %s was not a character device\"),\n                       src);\n        goto cleanup;\n    }\n\n    if (VIR_REALLOC_N(vm->def->hostdevs, vm->def->nhostdevs + 1) < 0)\n        goto cleanup;\n\n    if (virUSBDeviceFileIterate(usb,\n                                virLXCSetupHostUSBDeviceCgroup,\n                                priv->cgroup) < 0)\n        goto cleanup;\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFCHR,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   src) < 0) {\n        if (virUSBDeviceFileIterate(usb,\n                                    virLXCTeardownHostUSBDeviceCgroup,\n                                    priv->cgroup) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    vm->def->hostdevs[vm->def->nhostdevs++] = def;\n\n    ret = 0;\n\n cleanup:\n    virDomainAuditHostdev(vm, def, \"attach\", ret == 0);\n    virUSBDeviceFree(usb);\n    VIR_FREE(src);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceNetLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3440-3575",
    "snippet": "static int\nlxcDomainAttachDeviceNetLive(virLXCDriverPtr driver,\n                             virDomainObjPtr vm,\n                             virDomainNetDefPtr net)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    int ret = -1;\n    virDomainNetType actualType;\n    const virNetDevBandwidth *actualBandwidth;\n    char *veth = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if (virLXCProcessValidateInterface(net) < 0)\n       return -1;\n\n    /* preallocate new slot for device */\n    if (VIR_REALLOC_N(vm->def->nets, vm->def->nnets+1) < 0)\n        return -1;\n\n    /* If appropriate, grab a physical device from the configured\n     * network's pool of devices, or resolve bridge device name\n     * to the one defined in the network definition.\n     */\n    if (net->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n        virConnectPtr netconn = virGetConnectNetwork();\n        if (!netconn)\n            return -1;\n        if (virDomainNetAllocateActualDevice(netconn, vm->def, net) < 0) {\n            virObjectUnref(netconn);\n            return -1;\n        }\n        virObjectUnref(netconn);\n    }\n\n    /* final validation now that actual type is known */\n    if (virDomainActualNetDefValidate(net) < 0)\n        return -1;\n\n    actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK: {\n        const char *brname = virDomainNetGetActualBridgeName(net);\n        if (!brname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"No bridge name specified\"));\n            goto cleanup;\n        }\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, brname)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, NULL)))\n            goto cleanup;\n        break;\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        if (!(veth = virLXCProcessSetupInterfaceDirect(driver, vm->def, net)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Network device type is not supported\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n    /* Set bandwidth or warn if requested and not supported. */\n    actualBandwidth = virDomainNetGetActualBandwidth(net);\n    if (actualBandwidth) {\n        if (virNetDevSupportsBandwidth(actualType)) {\n            if (virNetDevBandwidthSet(net->ifname, actualBandwidth, false,\n                                      !virDomainNetTypeSharesHostView(net)) < 0)\n                goto cleanup;\n        } else {\n            VIR_WARN(\"setting bandwidth on interfaces of \"\n                     \"type '%s' is not implemented yet: %s\",\n                     virDomainNetTypeToString(actualType), virGetLastErrorMessage());\n        }\n    }\n\n    if (virNetDevSetNamespace(veth, priv->initpid) < 0) {\n        virDomainAuditNet(vm, NULL, net, \"attach\", false);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, NULL, net, \"attach\", true);\n\n    ret = 0;\n\n cleanup:\n    if (!ret) {\n        vm->def->nets[vm->def->nnets++] = net;\n    } else if (veth) {\n        switch (actualType) {\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_NETWORK:\n        case VIR_DOMAIN_NET_TYPE_ETHERNET:\n            ignore_value(virNetDevVethDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n            ignore_value(virNetDevMacVLanDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_USER:\n        case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n        case VIR_DOMAIN_NET_TYPE_SERVER:\n        case VIR_DOMAIN_NET_TYPE_CLIENT:\n        case VIR_DOMAIN_NET_TYPE_MCAST:\n        case VIR_DOMAIN_NET_TYPE_INTERNAL:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        case VIR_DOMAIN_NET_TYPE_UDP:\n        case VIR_DOMAIN_NET_TYPE_LAST:\n        default:\n            /* no-op */\n            break;\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevMacVLanDelete(veth)"
          ],
          "line": 3556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanDelete",
          "args": [
            "veth"
          ],
          "line": 3556
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1192-1197",
          "snippet": "int virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanDelete(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virNetDevVethDelete(veth)"
          ],
          "line": 3552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevVethDelete",
          "args": [
            "veth"
          ],
          "line": 3552
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevVethDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevveth.c",
          "lines": "189-209",
          "snippet": "int virNetDevVethDelete(const char *veth)\n{\n    int status;\n    g_autoptr(virCommand) cmd = virCommandNewArgList(\"ip\", \"link\",\n                                                       \"del\", veth, NULL);\n\n    if (virCommandRun(cmd, &status) < 0)\n        return -1;\n\n    if (status != 0) {\n        if (!virNetDevExists(veth)) {\n            VIR_DEBUG(\"Device %s already deleted (by kernel namespace cleanup)\", veth);\n            return 0;\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to delete veth device %s\"), veth);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdevveth.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virnetdevveth.h\"\n#include <config.h>\n\nint virNetDevVethDelete(const char *veth)\n{\n    int status;\n    g_autoptr(virCommand) cmd = virCommandNewArgList(\"ip\", \"link\",\n                                                       \"del\", veth, NULL);\n\n    if (virCommandRun(cmd, &status) < 0)\n        return -1;\n\n    if (status != 0) {\n        if (!virNetDevExists(veth)) {\n            VIR_DEBUG(\"Device %s already deleted (by kernel namespace cleanup)\", veth);\n            return 0;\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to delete veth device %s\"), veth);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditNet",
          "args": [
            "vm",
            "NULL",
            "net",
            "\"attach\"",
            "true"
          ],
          "line": 3540
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "266-284",
          "snippet": "void\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNet(virDomainObjPtr vm,\n                  virDomainNetDefPtr oldDef, virDomainNetDefPtr newDef,\n                  const char *reason, bool success)\n{\n    char newMacstr[VIR_MAC_STRING_BUFLEN];\n    char oldMacstr[VIR_MAC_STRING_BUFLEN];\n\n    if (oldDef)\n        virMacAddrFormat(&oldDef->mac, oldMacstr);\n\n    if (newDef)\n        virMacAddrFormat(&newDef->mac, newMacstr);\n\n    virDomainAuditGenericDev(vm, \"net\",\n                             oldDef ? oldMacstr : NULL,\n                             newDef ? newMacstr : NULL,\n                             reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetNamespace",
          "args": [
            "veth",
            "priv->initpid"
          ],
          "line": 3535
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetNamespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "506-550",
          "snippet": "int virNetDevSetNamespace(const char *ifname, pid_t pidInNs)\n{\n    int ret = -1;\n    char *pid = NULL;\n    char *phy = NULL;\n    char *phy_path = NULL;\n    int len;\n\n    pid = g_strdup_printf(\"%lld\", (long long) pidInNs);\n\n    /* The 802.11 wireless devices only move together with their PHY. */\n    if (virNetDevSysfsFile(&phy_path, ifname, \"phy80211/name\") < 0)\n        goto cleanup;\n\n    if ((len = virFileReadAllQuiet(phy_path, 1024, &phy)) <= 0) {\n        /* Not a wireless device. */\n        const char *argv[] = {\n            \"ip\", \"link\", \"set\", ifname, \"netns\", NULL, NULL\n        };\n\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n\n    } else {\n        const char *argv[] = {\n            \"iw\", \"phy\", NULL, \"set\", \"netns\", NULL, NULL\n        };\n\n        /* Remove a line break. */\n        phy[len - 1] = '\\0';\n\n        argv[2] = phy;\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(phy_path);\n    VIR_FREE(phy);\n    VIR_FREE(pid);\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetNamespace(const char *ifname, pid_t pidInNs)\n{\n    int ret = -1;\n    char *pid = NULL;\n    char *phy = NULL;\n    char *phy_path = NULL;\n    int len;\n\n    pid = g_strdup_printf(\"%lld\", (long long) pidInNs);\n\n    /* The 802.11 wireless devices only move together with their PHY. */\n    if (virNetDevSysfsFile(&phy_path, ifname, \"phy80211/name\") < 0)\n        goto cleanup;\n\n    if ((len = virFileReadAllQuiet(phy_path, 1024, &phy)) <= 0) {\n        /* Not a wireless device. */\n        const char *argv[] = {\n            \"ip\", \"link\", \"set\", ifname, \"netns\", NULL, NULL\n        };\n\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n\n    } else {\n        const char *argv[] = {\n            \"iw\", \"phy\", NULL, \"set\", \"netns\", NULL, NULL\n        };\n\n        /* Remove a line break. */\n        phy[len - 1] = '\\0';\n\n        argv[2] = phy;\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(phy_path);\n    VIR_FREE(phy);\n    VIR_FREE(pid);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"setting bandwidth on interfaces of \"\n                     \"type '%s' is not implemented yet: %s\"",
            "virDomainNetTypeToString(actualType)",
            "virGetLastErrorMessage()"
          ],
          "line": 3529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 3531
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetTypeToString",
          "args": [
            "actualType"
          ],
          "line": 3531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevBandwidthSet",
          "args": [
            "net->ifname",
            "actualBandwidth",
            "false",
            "!virDomainNetTypeSharesHostView(net)"
          ],
          "line": 3525
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBandwidthSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbandwidth.c",
          "lines": "189-392",
          "snippet": "int\nvirNetDevBandwidthSet(const char *ifname,\n                      const virNetDevBandwidth *bandwidth,\n                      bool hierarchical_class,\n                      bool swapped)\n{\n    int ret = -1;\n    virNetDevBandwidthRatePtr rx = NULL, tx = NULL; /* From domain POV */\n    virCommandPtr cmd = NULL;\n    char *average = NULL;\n    char *peak = NULL;\n    char *burst = NULL;\n\n    if (!bandwidth) {\n        /* nothing to be enabled */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (geteuid() != 0) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Network bandwidth tuning is not available\"\n                         \" in session mode\"));\n        return -1;\n    }\n\n    if (!ifname) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Unable to set bandwidth for interface because \"\n                         \"device name is unknown\"));\n        return -1;\n    }\n\n    if (swapped) {\n        rx = bandwidth->out;\n        tx = bandwidth->in;\n    } else {\n        rx = bandwidth->in;\n        tx = bandwidth->out;\n    }\n\n    virNetDevBandwidthClear(ifname);\n\n    if (tx && tx->average) {\n        average = g_strdup_printf(\"%llukbps\", tx->average);\n        if (tx->peak)\n            peak = g_strdup_printf(\"%llukbps\", tx->peak);\n        if (tx->burst)\n            burst = g_strdup_printf(\"%llukb\", tx->burst);\n\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"qdisc\", \"add\", \"dev\", ifname, \"root\",\n                             \"handle\", \"1:\", \"htb\", \"default\",\n                             hierarchical_class ? \"2\" : \"1\", NULL);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        /* If we are creating a hierarchical class, all non guaranteed traffic\n         * goes to the 1:2 class which will adjust 'rate' dynamically as NICs\n         * with guaranteed throughput are plugged and unplugged. Class 1:1\n         * exists so we don't exceed the maximum limit for the network. For each\n         * NIC with guaranteed throughput a separate classid will be created.\n         * NB '1:' is just a shorter notation of '1:0'.\n         *\n         * To get a picture how this works:\n         *\n         * +-----+     +---------+     +-----------+      +-----------+     +-----+\n         * |     |     |  qdisc  |     | class 1:1 |      | class 1:2 |     |     |\n         * | NIC |     | def 1:2 |     |   rate    |      |   rate    |     | sfq |\n         * |     | --> |         | --> |   peak    | -+-> |   peak    | --> |     |\n         * +-----+     +---------+     +-----------+  |   +-----------+     +-----+\n         *                                            |\n         *                                            |   +-----------+     +-----+\n         *                                            |   | class 1:3 |     |     |\n         *                                            |   |   rate    |     | sfq |\n         *                                            +-> |   peak    | --> |     |\n         *                                            |   +-----------+     +-----+\n         *                                           ...\n         *                                            |   +-----------+     +-----+\n         *                                            |   | class 1:n |     |     |\n         *                                            |   |   rate    |     | sfq |\n         *                                            +-> |   peak    | --> |     |\n         *                                                +-----------+     +-----+\n         *\n         * After the routing decision, when is it clear a packet is to be sent\n         * via a particular NIC, it is sent to the root qdisc (queuing\n         * discipline). In this case HTB (Hierarchical Token Bucket). It has\n         * only one direct child class (with id 1:1) which shapes the overall\n         * rate that is sent through the NIC.  This class has at least one child\n         * (1:2) which is meant for all non-privileged (non guaranteed) traffic\n         * from all domains. Then, for each interface with guaranteed\n         * throughput, a separate class (1:n) is created. Imagine a class is a\n         * box. Whenever a packet ends up in a class it is stored in this box\n         * until the kernel sends it, then it is removed from box. Packets are\n         * placed into boxes based on rules (filters) - e.g. depending on\n         * destination IP/MAC address. If there is no rule to be applied, the\n         * root qdisc has a default where such packets go (1:2 in this case).\n         * Packets come in over and over again and boxes get filled more and\n         * more. Imagine that kernel sends packets just once a second. So it\n         * starts to traverse through this tree. It starts with the root qdisc\n         * and through 1:1 it gets to 1:2. It sends packets up to 1:2's 'rate'.\n         * Then it moves to 1:3 and again sends packets up to 1:3's 'rate'.  The\n         * whole process is repeated until 1:n is processed. So now we have\n         * ensured each class its guaranteed bandwidth. If the sum of sent data\n         * doesn't exceed the 'rate' in 1:1 class, we can go further and send\n         * more packets. The rest of available bandwidth is distributed to the\n         * 1:2,1:3...1:n classes by ratio of their 'rate'. As soon as the root\n         * 'rate' limit is reached or there are no more packets to send, we stop\n         * sending and wait another second. Each class has an SFQ qdisc which\n         * shuffles packets in boxes stochastically, so one sender cannot\n         * starve others.\n         *\n         * Therefore, whenever we want to plug in a new guaranteed interface, we\n         * need to create a new class and adjust the 'rate' of the 1:2 class.\n         * When unplugging we do the exact opposite - remove the associated\n         * class, and adjust the 'rate'.\n         *\n         * This description is rather long, but it is still a good idea to read\n         * it before you dig into the code.\n         */\n        if (hierarchical_class) {\n            virCommandFree(cmd);\n            cmd = virCommandNew(TC);\n            virCommandAddArgList(cmd, \"class\", \"add\", \"dev\", ifname, \"parent\",\n                                 \"1:\", \"classid\", \"1:1\", \"htb\", \"rate\", average,\n                                 \"ceil\", peak ? peak : average, NULL);\n            virNetDevBandwidthCmdAddOptimalQuantum(cmd, tx);\n            if (virCommandRun(cmd, NULL) < 0)\n                goto cleanup;\n        }\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"class\", \"add\", \"dev\", ifname, \"parent\",\n                             hierarchical_class ? \"1:1\" : \"1:\", \"classid\",\n                             hierarchical_class ? \"1:2\" : \"1:1\", \"htb\",\n                             \"rate\", average, NULL);\n\n        if (peak)\n            virCommandAddArgList(cmd, \"ceil\", peak, NULL);\n        if (burst)\n            virCommandAddArgList(cmd, \"burst\", burst, NULL);\n\n        virNetDevBandwidthCmdAddOptimalQuantum(cmd, tx);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"qdisc\", \"add\", \"dev\", ifname, \"parent\",\n                             hierarchical_class ? \"1:2\" : \"1:1\",\n                             \"handle\", \"2:\", \"sfq\", \"perturb\",\n                             \"10\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"filter\", \"add\", \"dev\", ifname, \"parent\",\n                             \"1:0\", \"protocol\", \"all\", \"prio\", \"1\", \"handle\",\n                             \"1\", \"fw\", \"flowid\", \"1\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        VIR_FREE(average);\n        VIR_FREE(peak);\n        VIR_FREE(burst);\n    }\n\n    if (rx) {\n        average = g_strdup_printf(\"%llukbps\", rx->average);\n        burst = g_strdup_printf(\"%llukb\", rx->burst ? rx->burst : rx->average);\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n            virCommandAddArgList(cmd, \"qdisc\", \"add\", \"dev\", ifname,\n                                 \"ingress\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        /* Set filter to match all ingress traffic */\n        virCommandAddArgList(cmd, \"filter\", \"add\", \"dev\", ifname, \"parent\",\n                             \"ffff:\", \"protocol\", \"all\", \"u32\", \"match\", \"u32\",\n                             \"0\", \"0\", \"police\", \"rate\", average,\n                             \"burst\", burst, \"mtu\", \"64kb\", \"drop\", \"flowid\",\n                             \":1\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(average);\n    VIR_FREE(peak);\n    VIR_FREE(burst);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virnetdevbandwidth.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetDevBandwidthSet(const char *ifname,\n                      const virNetDevBandwidth *bandwidth,\n                      bool hierarchical_class,\n                      bool swapped)\n{\n    int ret = -1;\n    virNetDevBandwidthRatePtr rx = NULL, tx = NULL; /* From domain POV */\n    virCommandPtr cmd = NULL;\n    char *average = NULL;\n    char *peak = NULL;\n    char *burst = NULL;\n\n    if (!bandwidth) {\n        /* nothing to be enabled */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (geteuid() != 0) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Network bandwidth tuning is not available\"\n                         \" in session mode\"));\n        return -1;\n    }\n\n    if (!ifname) {\n        virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                       _(\"Unable to set bandwidth for interface because \"\n                         \"device name is unknown\"));\n        return -1;\n    }\n\n    if (swapped) {\n        rx = bandwidth->out;\n        tx = bandwidth->in;\n    } else {\n        rx = bandwidth->in;\n        tx = bandwidth->out;\n    }\n\n    virNetDevBandwidthClear(ifname);\n\n    if (tx && tx->average) {\n        average = g_strdup_printf(\"%llukbps\", tx->average);\n        if (tx->peak)\n            peak = g_strdup_printf(\"%llukbps\", tx->peak);\n        if (tx->burst)\n            burst = g_strdup_printf(\"%llukb\", tx->burst);\n\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"qdisc\", \"add\", \"dev\", ifname, \"root\",\n                             \"handle\", \"1:\", \"htb\", \"default\",\n                             hierarchical_class ? \"2\" : \"1\", NULL);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        /* If we are creating a hierarchical class, all non guaranteed traffic\n         * goes to the 1:2 class which will adjust 'rate' dynamically as NICs\n         * with guaranteed throughput are plugged and unplugged. Class 1:1\n         * exists so we don't exceed the maximum limit for the network. For each\n         * NIC with guaranteed throughput a separate classid will be created.\n         * NB '1:' is just a shorter notation of '1:0'.\n         *\n         * To get a picture how this works:\n         *\n         * +-----+     +---------+     +-----------+      +-----------+     +-----+\n         * |     |     |  qdisc  |     | class 1:1 |      | class 1:2 |     |     |\n         * | NIC |     | def 1:2 |     |   rate    |      |   rate    |     | sfq |\n         * |     | --> |         | --> |   peak    | -+-> |   peak    | --> |     |\n         * +-----+     +---------+     +-----------+  |   +-----------+     +-----+\n         *                                            |\n         *                                            |   +-----------+     +-----+\n         *                                            |   | class 1:3 |     |     |\n         *                                            |   |   rate    |     | sfq |\n         *                                            +-> |   peak    | --> |     |\n         *                                            |   +-----------+     +-----+\n         *                                           ...\n         *                                            |   +-----------+     +-----+\n         *                                            |   | class 1:n |     |     |\n         *                                            |   |   rate    |     | sfq |\n         *                                            +-> |   peak    | --> |     |\n         *                                                +-----------+     +-----+\n         *\n         * After the routing decision, when is it clear a packet is to be sent\n         * via a particular NIC, it is sent to the root qdisc (queuing\n         * discipline). In this case HTB (Hierarchical Token Bucket). It has\n         * only one direct child class (with id 1:1) which shapes the overall\n         * rate that is sent through the NIC.  This class has at least one child\n         * (1:2) which is meant for all non-privileged (non guaranteed) traffic\n         * from all domains. Then, for each interface with guaranteed\n         * throughput, a separate class (1:n) is created. Imagine a class is a\n         * box. Whenever a packet ends up in a class it is stored in this box\n         * until the kernel sends it, then it is removed from box. Packets are\n         * placed into boxes based on rules (filters) - e.g. depending on\n         * destination IP/MAC address. If there is no rule to be applied, the\n         * root qdisc has a default where such packets go (1:2 in this case).\n         * Packets come in over and over again and boxes get filled more and\n         * more. Imagine that kernel sends packets just once a second. So it\n         * starts to traverse through this tree. It starts with the root qdisc\n         * and through 1:1 it gets to 1:2. It sends packets up to 1:2's 'rate'.\n         * Then it moves to 1:3 and again sends packets up to 1:3's 'rate'.  The\n         * whole process is repeated until 1:n is processed. So now we have\n         * ensured each class its guaranteed bandwidth. If the sum of sent data\n         * doesn't exceed the 'rate' in 1:1 class, we can go further and send\n         * more packets. The rest of available bandwidth is distributed to the\n         * 1:2,1:3...1:n classes by ratio of their 'rate'. As soon as the root\n         * 'rate' limit is reached or there are no more packets to send, we stop\n         * sending and wait another second. Each class has an SFQ qdisc which\n         * shuffles packets in boxes stochastically, so one sender cannot\n         * starve others.\n         *\n         * Therefore, whenever we want to plug in a new guaranteed interface, we\n         * need to create a new class and adjust the 'rate' of the 1:2 class.\n         * When unplugging we do the exact opposite - remove the associated\n         * class, and adjust the 'rate'.\n         *\n         * This description is rather long, but it is still a good idea to read\n         * it before you dig into the code.\n         */\n        if (hierarchical_class) {\n            virCommandFree(cmd);\n            cmd = virCommandNew(TC);\n            virCommandAddArgList(cmd, \"class\", \"add\", \"dev\", ifname, \"parent\",\n                                 \"1:\", \"classid\", \"1:1\", \"htb\", \"rate\", average,\n                                 \"ceil\", peak ? peak : average, NULL);\n            virNetDevBandwidthCmdAddOptimalQuantum(cmd, tx);\n            if (virCommandRun(cmd, NULL) < 0)\n                goto cleanup;\n        }\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"class\", \"add\", \"dev\", ifname, \"parent\",\n                             hierarchical_class ? \"1:1\" : \"1:\", \"classid\",\n                             hierarchical_class ? \"1:2\" : \"1:1\", \"htb\",\n                             \"rate\", average, NULL);\n\n        if (peak)\n            virCommandAddArgList(cmd, \"ceil\", peak, NULL);\n        if (burst)\n            virCommandAddArgList(cmd, \"burst\", burst, NULL);\n\n        virNetDevBandwidthCmdAddOptimalQuantum(cmd, tx);\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"qdisc\", \"add\", \"dev\", ifname, \"parent\",\n                             hierarchical_class ? \"1:2\" : \"1:1\",\n                             \"handle\", \"2:\", \"sfq\", \"perturb\",\n                             \"10\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        virCommandAddArgList(cmd, \"filter\", \"add\", \"dev\", ifname, \"parent\",\n                             \"1:0\", \"protocol\", \"all\", \"prio\", \"1\", \"handle\",\n                             \"1\", \"fw\", \"flowid\", \"1\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        VIR_FREE(average);\n        VIR_FREE(peak);\n        VIR_FREE(burst);\n    }\n\n    if (rx) {\n        average = g_strdup_printf(\"%llukbps\", rx->average);\n        burst = g_strdup_printf(\"%llukb\", rx->burst ? rx->burst : rx->average);\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n            virCommandAddArgList(cmd, \"qdisc\", \"add\", \"dev\", ifname,\n                                 \"ingress\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n\n        virCommandFree(cmd);\n        cmd = virCommandNew(TC);\n        /* Set filter to match all ingress traffic */\n        virCommandAddArgList(cmd, \"filter\", \"add\", \"dev\", ifname, \"parent\",\n                             \"ffff:\", \"protocol\", \"all\", \"u32\", \"match\", \"u32\",\n                             \"0\", \"0\", \"police\", \"rate\", average,\n                             \"burst\", burst, \"mtu\", \"64kb\", \"drop\", \"flowid\",\n                             \":1\", NULL);\n\n        if (virCommandRun(cmd, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(average);\n    VIR_FREE(peak);\n    VIR_FREE(burst);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetTypeSharesHostView",
          "args": [
            "net"
          ],
          "line": 3526
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetTypeSharesHostView",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "31122-31144",
          "snippet": "bool\nvirDomainNetTypeSharesHostView(const virDomainNetDef *net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetTypeSharesHostView(const virDomainNetDef *net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSupportsBandwidth",
          "args": [
            "actualType"
          ],
          "line": 3524
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSupportsBandwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/netdev_bandwidth_conf.c",
          "lines": "302-322",
          "snippet": "bool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include <config.h>\n\nbool virNetDevSupportsBandwidth(virDomainNetType type)\n{\n    switch ((virDomainNetType) type) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBandwidth",
          "args": [
            "net"
          ],
          "line": 3522
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBandwidth",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30257-30267",
          "snippet": "const virNetDevBandwidth *\nvirDomainNetGetActualBandwidth(const virDomainNetDef *iface)\n{\n    /* if there is an ActualNetDef, *always* return\n     * its bandwidth rather than the NetDef's bandwidth.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        return iface->data.network.actual->bandwidth;\n    return iface->bandwidth;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevBandwidth *\nvirDomainNetGetActualBandwidth(const virDomainNetDef *iface)\n{\n    /* if there is an ActualNetDef, *always* return\n     * its bandwidth rather than the NetDef's bandwidth.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        return iface->data.network.actual->bandwidth;\n    return iface->bandwidth;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportEnumRangeError",
          "args": [
            "virDomainNetType",
            "actualType"
          ],
          "line": 3518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Network device type is not supported\")"
          ],
          "line": 3513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network device type is not supported\""
          ],
          "line": 3514
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessSetupInterfaceDirect",
          "args": [
            "driver",
            "vm->def",
            "net"
          ],
          "line": 3502
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessSetupInterfaceDirect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "338-396",
          "snippet": "char *\nvirLXCProcessSetupInterfaceDirect(virLXCDriverPtr driver,\n                                  virDomainDefPtr def,\n                                  virDomainNetDefPtr net)\n{\n    char *ret = NULL;\n    char *res_ifname = NULL;\n    const virNetDevBandwidth *bw;\n    const virNetDevVPortProfile *prof;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    const char *linkdev = virDomainNetGetActualDirectDev(net);\n    unsigned int macvlan_create_flags = VIR_NETDEV_MACVLAN_CREATE_IFUP;\n\n    /* XXX how todo bandwidth controls ?\n     * Since the 'net-ifname' is about to be moved to a different\n     * namespace & renamed, there will be no host side visible\n     * interface for the container to attach rules to\n     */\n    bw = virDomainNetGetActualBandwidth(net);\n    if (bw) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Unable to set network bandwidth on direct interfaces\"));\n        return NULL;\n    }\n\n    /* XXX how todo port profiles ?\n     * Although we can do the association during container\n     * startup, at shutdown we are unable to disassociate\n     * because the macvlan device was moved to the container\n     * and automagically dies when the container dies. So\n     * we have no dev to perform disassociation with.\n     */\n    prof = virDomainNetGetActualVirtPortProfile(net);\n    if (prof) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Unable to set port profile on direct interfaces\"));\n        return NULL;\n    }\n\n    if (virNetDevMacVLanCreateWithVPortProfile(\n            net->ifname, &net->mac,\n            linkdev,\n            virDomainNetGetActualDirectMode(net),\n            virDomainNetGetActualVlan(net),\n            def->uuid,\n            prof,\n            &res_ifname,\n            VIR_NETDEV_VPORT_PROFILE_OP_CREATE,\n            cfg->stateDir,\n            NULL, 0,\n            macvlan_create_flags) < 0)\n        goto cleanup;\n\n    ret = res_ifname;\n\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirLXCProcessSetupInterfaceDirect(virLXCDriverPtr driver,\n                                  virDomainDefPtr def,\n                                  virDomainNetDefPtr net)\n{\n    char *ret = NULL;\n    char *res_ifname = NULL;\n    const virNetDevBandwidth *bw;\n    const virNetDevVPortProfile *prof;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    const char *linkdev = virDomainNetGetActualDirectDev(net);\n    unsigned int macvlan_create_flags = VIR_NETDEV_MACVLAN_CREATE_IFUP;\n\n    /* XXX how todo bandwidth controls ?\n     * Since the 'net-ifname' is about to be moved to a different\n     * namespace & renamed, there will be no host side visible\n     * interface for the container to attach rules to\n     */\n    bw = virDomainNetGetActualBandwidth(net);\n    if (bw) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Unable to set network bandwidth on direct interfaces\"));\n        return NULL;\n    }\n\n    /* XXX how todo port profiles ?\n     * Although we can do the association during container\n     * startup, at shutdown we are unable to disassociate\n     * because the macvlan device was moved to the container\n     * and automagically dies when the container dies. So\n     * we have no dev to perform disassociation with.\n     */\n    prof = virDomainNetGetActualVirtPortProfile(net);\n    if (prof) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Unable to set port profile on direct interfaces\"));\n        return NULL;\n    }\n\n    if (virNetDevMacVLanCreateWithVPortProfile(\n            net->ifname, &net->mac,\n            linkdev,\n            virDomainNetGetActualDirectMode(net),\n            virDomainNetGetActualVlan(net),\n            def->uuid,\n            prof,\n            &res_ifname,\n            VIR_NETDEV_VPORT_PROFILE_OP_CREATE,\n            cfg->stateDir,\n            NULL, 0,\n            macvlan_create_flags) < 0)\n        goto cleanup;\n\n    ret = res_ifname;\n\n cleanup:\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessSetupInterfaceTap",
          "args": [
            "vm->def",
            "net",
            "NULL"
          ],
          "line": 3498
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessSetupInterfaceTap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "277-335",
          "snippet": "char *\nvirLXCProcessSetupInterfaceTap(virDomainDefPtr vm,\n                               virDomainNetDefPtr net,\n                               const char *brname)\n{\n    char *parentVeth;\n    char *containerVeth = NULL;\n    const virNetDevVPortProfile *vport = virDomainNetGetActualVirtPortProfile(net);\n\n    VIR_DEBUG(\"calling vethCreate()\");\n    parentVeth = net->ifname;\n    if (virNetDevVethCreate(&parentVeth, &containerVeth) < 0)\n        return NULL;\n    VIR_DEBUG(\"parentVeth: %s, containerVeth: %s\", parentVeth, containerVeth);\n\n    if (net->ifname == NULL)\n        net->ifname = parentVeth;\n\n    if (virNetDevSetMAC(containerVeth, &net->mac) < 0)\n        return NULL;\n\n    if (brname) {\n        if (vport && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH) {\n            if (virNetDevOpenvswitchAddPort(brname, parentVeth, &net->mac, vm->uuid,\n                                            vport, virDomainNetGetActualVlan(net)) < 0)\n                return NULL;\n        } else {\n            if (virNetDevBridgeAddPort(brname, parentVeth) < 0)\n                return NULL;\n\n            if (virDomainNetGetActualPortOptionsIsolated(net) == VIR_TRISTATE_BOOL_YES &&\n                virNetDevBridgePortSetIsolated(brname, parentVeth, true) < 0) {\n                virErrorPtr err;\n\n                virErrorPreserveLast(&err);\n                ignore_value(virNetDevBridgeRemovePort(brname, parentVeth));\n                virErrorRestore(&err);\n                return NULL;\n            }\n        }\n    }\n\n    if (virNetDevSetOnline(parentVeth, true) < 0)\n        return NULL;\n\n    if (virDomainNetGetActualType(net) == VIR_DOMAIN_NET_TYPE_ETHERNET) {\n        /* Set IP info for the host side, but only if the type is\n         * 'ethernet'.\n         */\n        if (virNetDevIPInfoAddToDev(parentVeth, &net->hostIP) < 0)\n            return NULL;\n    }\n\n    if (net->filter &&\n        virDomainConfNWFilterInstantiate(vm->name, vm->uuid, net, false) < 0)\n        return NULL;\n\n    return containerVeth;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirLXCProcessSetupInterfaceTap(virDomainDefPtr vm,\n                               virDomainNetDefPtr net,\n                               const char *brname)\n{\n    char *parentVeth;\n    char *containerVeth = NULL;\n    const virNetDevVPortProfile *vport = virDomainNetGetActualVirtPortProfile(net);\n\n    VIR_DEBUG(\"calling vethCreate()\");\n    parentVeth = net->ifname;\n    if (virNetDevVethCreate(&parentVeth, &containerVeth) < 0)\n        return NULL;\n    VIR_DEBUG(\"parentVeth: %s, containerVeth: %s\", parentVeth, containerVeth);\n\n    if (net->ifname == NULL)\n        net->ifname = parentVeth;\n\n    if (virNetDevSetMAC(containerVeth, &net->mac) < 0)\n        return NULL;\n\n    if (brname) {\n        if (vport && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH) {\n            if (virNetDevOpenvswitchAddPort(brname, parentVeth, &net->mac, vm->uuid,\n                                            vport, virDomainNetGetActualVlan(net)) < 0)\n                return NULL;\n        } else {\n            if (virNetDevBridgeAddPort(brname, parentVeth) < 0)\n                return NULL;\n\n            if (virDomainNetGetActualPortOptionsIsolated(net) == VIR_TRISTATE_BOOL_YES &&\n                virNetDevBridgePortSetIsolated(brname, parentVeth, true) < 0) {\n                virErrorPtr err;\n\n                virErrorPreserveLast(&err);\n                ignore_value(virNetDevBridgeRemovePort(brname, parentVeth));\n                virErrorRestore(&err);\n                return NULL;\n            }\n        }\n    }\n\n    if (virNetDevSetOnline(parentVeth, true) < 0)\n        return NULL;\n\n    if (virDomainNetGetActualType(net) == VIR_DOMAIN_NET_TYPE_ETHERNET) {\n        /* Set IP info for the host side, but only if the type is\n         * 'ethernet'.\n         */\n        if (virNetDevIPInfoAddToDev(parentVeth, &net->hostIP) < 0)\n            return NULL;\n    }\n\n    if (net->filter &&\n        virDomainConfNWFilterInstantiate(vm->name, vm->uuid, net, false) < 0)\n        return NULL;\n\n    return containerVeth;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"No bridge name specified\")"
          ],
          "line": 3490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBridgeName",
          "args": [
            "net"
          ],
          "line": 3488
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBridgeName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30164-30175",
          "snippet": "const char *\nvirDomainNetGetActualBridgeName(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_BRIDGE)\n        return iface->data.bridge.brname;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.brname;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainNetGetActualBridgeName(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_BRIDGE)\n        return iface->data.bridge.brname;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.brname;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualType",
          "args": [
            "net"
          ],
          "line": 3483
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30154-30162",
          "snippet": "virDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainActualNetDefValidate",
          "args": [
            "net"
          ],
          "line": 3480
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainActualNetDefValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "6296-6354",
          "snippet": "int\nvirDomainActualNetDefValidate(const virDomainNetDef *net)\n{\n    /* Unlike virDomainNetDefValidate(), which is a static function\n     * called internally to this file, virDomainActualNetDefValidate()\n     * is a public function that can be called from a hypervisor after\n     * it has completely setup the NetDef for use by a domain,\n     * including possibly allocating a port from the network driver\n     * (which could change the effective/\"actual\" type of the NetDef,\n     * thus changing what should/shouldn't be allowed by validation).\n     *\n     * This function should contain validations not specific to a\n     * particular hypervisor (e.g. whether or not specifying bandwidth\n     * is allowed for a type of interface), but *not*\n     * hypervisor-specific things.\n     */\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    const virNetDevVPortProfile *vport = virDomainNetGetActualVirtPortProfile(net);\n    const virNetDevBandwidth *bandwidth = virDomainNetGetActualBandwidth(net);\n\n    virMacAddrFormat(&net->mac, macstr);\n\n    if (virDomainNetGetActualVlan(net)) {\n        /* vlan configuration via libvirt is only supported for PCI\n         * Passthrough SR-IOV devices (hostdev or macvtap passthru\n         * mode) and openvswitch bridges. Otherwise log an error and\n         * fail\n         */\n        if (!(actualType == VIR_DOMAIN_NET_TYPE_HOSTDEV ||\n              (actualType == VIR_DOMAIN_NET_TYPE_DIRECT &&\n               virDomainNetGetActualDirectMode(net) == VIR_NETDEV_MACVLAN_MODE_PASSTHRU) ||\n              (actualType == VIR_DOMAIN_NET_TYPE_BRIDGE &&\n               vport  && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH))) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"interface %s - vlan tag not supported for this connection type\"),\n                           macstr);\n            return -1;\n        }\n    }\n\n    /* bandwidth configuration via libvirt is not supported for\n     * hostdev network devices\n     */\n    if (bandwidth && actualType == VIR_DOMAIN_NET_TYPE_HOSTDEV) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"interface %s - bandwidth settings are not supported \"\n                         \"for hostdev interfaces\"),\n                       macstr);\n        return -1;\n    }\n\n    if (virDomainNetDefValidatePortOptions(macstr, actualType, vport,\n                                           virDomainNetGetActualPortOptionsIsolated(net)) < 0) {\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainActualNetDefValidate(const virDomainNetDef *net)\n{\n    /* Unlike virDomainNetDefValidate(), which is a static function\n     * called internally to this file, virDomainActualNetDefValidate()\n     * is a public function that can be called from a hypervisor after\n     * it has completely setup the NetDef for use by a domain,\n     * including possibly allocating a port from the network driver\n     * (which could change the effective/\"actual\" type of the NetDef,\n     * thus changing what should/shouldn't be allowed by validation).\n     *\n     * This function should contain validations not specific to a\n     * particular hypervisor (e.g. whether or not specifying bandwidth\n     * is allowed for a type of interface), but *not*\n     * hypervisor-specific things.\n     */\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    const virNetDevVPortProfile *vport = virDomainNetGetActualVirtPortProfile(net);\n    const virNetDevBandwidth *bandwidth = virDomainNetGetActualBandwidth(net);\n\n    virMacAddrFormat(&net->mac, macstr);\n\n    if (virDomainNetGetActualVlan(net)) {\n        /* vlan configuration via libvirt is only supported for PCI\n         * Passthrough SR-IOV devices (hostdev or macvtap passthru\n         * mode) and openvswitch bridges. Otherwise log an error and\n         * fail\n         */\n        if (!(actualType == VIR_DOMAIN_NET_TYPE_HOSTDEV ||\n              (actualType == VIR_DOMAIN_NET_TYPE_DIRECT &&\n               virDomainNetGetActualDirectMode(net) == VIR_NETDEV_MACVLAN_MODE_PASSTHRU) ||\n              (actualType == VIR_DOMAIN_NET_TYPE_BRIDGE &&\n               vport  && vport->virtPortType == VIR_NETDEV_VPORT_PROFILE_OPENVSWITCH))) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"interface %s - vlan tag not supported for this connection type\"),\n                           macstr);\n            return -1;\n        }\n    }\n\n    /* bandwidth configuration via libvirt is not supported for\n     * hostdev network devices\n     */\n    if (bandwidth && actualType == VIR_DOMAIN_NET_TYPE_HOSTDEV) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"interface %s - bandwidth settings are not supported \"\n                         \"for hostdev interfaces\"),\n                       macstr);\n        return -1;\n    }\n\n    if (virDomainNetDefValidatePortOptions(macstr, actualType, vport,\n                                           virDomainNetGetActualPortOptionsIsolated(net)) < 0) {\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "netconn"
          ],
          "line": 3476
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetAllocateActualDevice",
          "args": [
            "netconn",
            "vm->def",
            "net"
          ],
          "line": 3472
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetAllocateActualDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "31498-31504",
          "snippet": "int\nvirDomainNetAllocateActualDevice(virConnectPtr conn,\n                                 virDomainDefPtr dom,\n                                 virDomainNetDefPtr iface)\n{\n    return virDomainNetCreatePort(conn, dom, iface, 0);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetAllocateActualDevice(virConnectPtr conn,\n                                 virDomainDefPtr dom,\n                                 virDomainNetDefPtr iface)\n{\n    return virDomainNetCreatePort(conn, dom, iface, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetConnectNetwork",
          "args": [],
          "line": 3469
        },
        "resolved": true,
        "details": {
          "function_name": "virGetConnectNetwork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "169-172",
          "snippet": "virConnectPtr virGetConnectNetwork(void)\n{\n    return virGetConnectGeneric(&connectNetwork, \"network\");\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virThreadLocal connectNetwork;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirThreadLocal connectNetwork;\n\nvirConnectPtr virGetConnectNetwork(void)\n{\n    return virGetConnectGeneric(&connectNetwork, \"network\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "vm->def->nets",
            "vm->def->nnets+1"
          ],
          "line": 3461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCProcessValidateInterface",
          "args": [
            "net"
          ],
          "line": 3457
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessValidateInterface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "265-274",
          "snippet": "int\nvirLXCProcessValidateInterface(virDomainNetDefPtr net)\n{\n    if (net->script) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"scripts are not supported on LXC network interfaces\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirLXCProcessValidateInterface(virDomainNetDefPtr net)\n{\n    if (net->script) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"scripts are not supported on LXC network interfaces\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach disk until init PID is known\")"
          ],
          "line": 3452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceNetLive(virLXCDriverPtr driver,\n                             virDomainObjPtr vm,\n                             virDomainNetDefPtr net)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    int ret = -1;\n    virDomainNetType actualType;\n    const virNetDevBandwidth *actualBandwidth;\n    char *veth = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        return -1;\n    }\n\n    if (virLXCProcessValidateInterface(net) < 0)\n       return -1;\n\n    /* preallocate new slot for device */\n    if (VIR_REALLOC_N(vm->def->nets, vm->def->nnets+1) < 0)\n        return -1;\n\n    /* If appropriate, grab a physical device from the configured\n     * network's pool of devices, or resolve bridge device name\n     * to the one defined in the network definition.\n     */\n    if (net->type == VIR_DOMAIN_NET_TYPE_NETWORK) {\n        virConnectPtr netconn = virGetConnectNetwork();\n        if (!netconn)\n            return -1;\n        if (virDomainNetAllocateActualDevice(netconn, vm->def, net) < 0) {\n            virObjectUnref(netconn);\n            return -1;\n        }\n        virObjectUnref(netconn);\n    }\n\n    /* final validation now that actual type is known */\n    if (virDomainActualNetDefValidate(net) < 0)\n        return -1;\n\n    actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK: {\n        const char *brname = virDomainNetGetActualBridgeName(net);\n        if (!brname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"No bridge name specified\"));\n            goto cleanup;\n        }\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, brname)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (!(veth = virLXCProcessSetupInterfaceTap(vm->def, net, NULL)))\n            goto cleanup;\n        break;\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        if (!(veth = virLXCProcessSetupInterfaceDirect(driver, vm->def, net)))\n            goto cleanup;\n    }   break;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Network device type is not supported\"));\n        goto cleanup;\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        virReportEnumRangeError(virDomainNetType, actualType);\n        goto cleanup;\n    }\n    /* Set bandwidth or warn if requested and not supported. */\n    actualBandwidth = virDomainNetGetActualBandwidth(net);\n    if (actualBandwidth) {\n        if (virNetDevSupportsBandwidth(actualType)) {\n            if (virNetDevBandwidthSet(net->ifname, actualBandwidth, false,\n                                      !virDomainNetTypeSharesHostView(net)) < 0)\n                goto cleanup;\n        } else {\n            VIR_WARN(\"setting bandwidth on interfaces of \"\n                     \"type '%s' is not implemented yet: %s\",\n                     virDomainNetTypeToString(actualType), virGetLastErrorMessage());\n        }\n    }\n\n    if (virNetDevSetNamespace(veth, priv->initpid) < 0) {\n        virDomainAuditNet(vm, NULL, net, \"attach\", false);\n        goto cleanup;\n    }\n\n    virDomainAuditNet(vm, NULL, net, \"attach\", true);\n\n    ret = 0;\n\n cleanup:\n    if (!ret) {\n        vm->def->nets[vm->def->nnets++] = net;\n    } else if (veth) {\n        switch (actualType) {\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_NETWORK:\n        case VIR_DOMAIN_NET_TYPE_ETHERNET:\n            ignore_value(virNetDevVethDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n            ignore_value(virNetDevMacVLanDelete(veth));\n            break;\n\n        case VIR_DOMAIN_NET_TYPE_USER:\n        case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n        case VIR_DOMAIN_NET_TYPE_SERVER:\n        case VIR_DOMAIN_NET_TYPE_CLIENT:\n        case VIR_DOMAIN_NET_TYPE_MCAST:\n        case VIR_DOMAIN_NET_TYPE_INTERNAL:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        case VIR_DOMAIN_NET_TYPE_UDP:\n        case VIR_DOMAIN_NET_TYPE_LAST:\n        default:\n            /* no-op */\n            break;\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceDiskLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3338-3437",
    "snippet": "static int\nlxcDomainAttachDeviceDiskLive(virLXCDriverPtr driver,\n                              virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = dev->data.disk;\n    int ret = -1;\n    struct stat sb;\n    char *file = NULL;\n    int perms;\n    const char *src = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    src = virDomainDiskGetSource(def);\n    if (src == NULL) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk without media\"));\n        goto cleanup;\n    }\n\n    if (!virStorageSourceIsBlockLocal(def->src)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk for non-block device\"));\n        goto cleanup;\n    }\n\n    if (virDomainDiskIndexByName(vm->def, def->dst, true) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"target %s already exists\"), def->dst);\n        goto cleanup;\n    }\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Disk source %s must be a block device\"),\n                       src);\n        goto cleanup;\n    }\n\n    perms = (def->src->readonly ?\n             VIR_CGROUP_DEVICE_READ :\n             VIR_CGROUP_DEVICE_RW) |\n        VIR_CGROUP_DEVICE_MKNOD;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             perms) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->disks, vm->def->ndisks + 1) < 0)\n        goto cleanup;\n\n    file = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   file) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                perms) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    virDomainDiskInsertPreAlloced(vm->def, def);\n\n    ret = 0;\n\n cleanup:\n    if (src)\n        virDomainAuditDisk(vm, NULL, def->src, \"attach\", ret == 0);\n    VIR_FREE(file);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "file"
          ],
          "line": 3435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainAuditDisk",
          "args": [
            "vm",
            "NULL",
            "def->src",
            "\"attach\"",
            "ret == 0"
          ],
          "line": 3434
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "190-207",
          "snippet": "void\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditDisk(virDomainObjPtr vm,\n                   virStorageSourcePtr oldDef,\n                   virStorageSourcePtr newDef,\n                   const char *reason,\n                   bool success)\n{\n    const char *oldsrc = NULL;\n    const char *newsrc = NULL;\n\n    if (oldDef && virStorageSourceIsLocalStorage(oldDef))\n        oldsrc = oldDef->path;\n\n    if (newDef && virStorageSourceIsLocalStorage(newDef))\n        newsrc = newDef->path;\n\n    virDomainAuditGenericDev(vm, \"disk\", oldsrc, newsrc, reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskInsertPreAlloced",
          "args": [
            "vm->def",
            "def"
          ],
          "line": 3428
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskInsertPreAlloced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17363-17394",
          "snippet": "void virDomainDiskInsertPreAlloced(virDomainDefPtr def,\n                                   virDomainDiskDefPtr disk)\n{\n    int idx;\n    /* Tentatively plan to insert disk at the end. */\n    int insertAt = -1;\n\n    /* Then work backwards looking for disks on\n     * the same bus. If we find a disk with a drive\n     * index greater than the new one, insert at\n     * that position\n     */\n    for (idx = (def->ndisks - 1); idx >= 0; idx--) {\n        /* If bus matches and current disk is after\n         * new disk, then new disk should go here */\n        if (def->disks[idx]->bus == disk->bus &&\n            (virDiskNameToIndex(def->disks[idx]->dst) >\n             virDiskNameToIndex(disk->dst))) {\n            insertAt = idx;\n        } else if (def->disks[idx]->bus == disk->bus &&\n                   insertAt == -1) {\n            /* Last disk with match bus is before the\n             * new disk, then put new disk just after\n             */\n            insertAt = idx + 1;\n        }\n    }\n\n    /* VIR_INSERT_ELEMENT_INPLACE will never return an error here. */\n    ignore_value(VIR_INSERT_ELEMENT_INPLACE(def->disks, insertAt,\n                                            def->ndisks, disk));\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDiskInsertPreAlloced(virDomainDefPtr def,\n                                   virDomainDiskDefPtr disk)\n{\n    int idx;\n    /* Tentatively plan to insert disk at the end. */\n    int insertAt = -1;\n\n    /* Then work backwards looking for disks on\n     * the same bus. If we find a disk with a drive\n     * index greater than the new one, insert at\n     * that position\n     */\n    for (idx = (def->ndisks - 1); idx >= 0; idx--) {\n        /* If bus matches and current disk is after\n         * new disk, then new disk should go here */\n        if (def->disks[idx]->bus == disk->bus &&\n            (virDiskNameToIndex(def->disks[idx]->dst) >\n             virDiskNameToIndex(disk->dst))) {\n            insertAt = idx;\n        } else if (def->disks[idx]->bus == disk->bus &&\n                   insertAt == -1) {\n            /* Last disk with match bus is before the\n             * new disk, then put new disk just after\n             */\n            insertAt = idx + 1;\n        }\n    }\n\n    /* VIR_INSERT_ELEMENT_INPLACE will never return an error here. */\n    ignore_value(VIR_INSERT_ELEMENT_INPLACE(def->disks, insertAt,\n                                            def->ndisks, disk));\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"cannot deny device %s for domain %s: %s\"",
            "src",
            "vm->def->name",
            "virGetLastErrorMessage()"
          ],
          "line": 3423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetLastErrorMessage",
          "args": [],
          "line": 3424
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDenyDevice",
          "args": [
            "priv->cgroup",
            "'b'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "perms"
          ],
          "line": 3418
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDenyDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3303-3313",
          "snippet": "int\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomainAttachDeviceMknod",
          "args": [
            "driver",
            "0700 | S_IFBLK",
            "sb.st_rdev",
            "vm",
            "dev",
            "file"
          ],
          "line": 3412
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainAttachDeviceMknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "3270-3302",
          "snippet": "static int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/%s\"",
            "def->dst"
          ],
          "line": 3410
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "vm->def->disks",
            "vm->def->ndisks + 1"
          ],
          "line": 3407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupAllowDevice",
          "args": [
            "priv->cgroup",
            "'b'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "perms"
          ],
          "line": 3400
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3278-3288",
          "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 3402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Disk source %s must be a block device\")",
            "src"
          ],
          "line": 3389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Disk source %s must be a block device\""
          ],
          "line": 3390
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 3388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to access %s\")",
            "src"
          ],
          "line": 3383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "src",
            "&sb"
          ],
          "line": 3382
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"target %s already exists\")",
            "def->dst"
          ],
          "line": 3377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskIndexByName",
          "args": [
            "vm->def",
            "def->dst",
            "true"
          ],
          "line": 3376
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskIndexByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17299-17325",
          "snippet": "int\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Can't setup disk for non-block device\")"
          ],
          "line": 3371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBlockLocal",
          "args": [
            "def->src"
          ],
          "line": 3370
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBlockLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2643-2647",
          "snippet": "bool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"Can't setup disk without media\")"
          ],
          "line": 3365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "def"
          ],
          "line": 3363
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"devices cgroup isn't mounted\")"
          ],
          "line": 3358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_DEVICES"
          ],
          "line": 3357
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot attach disk until init PID is known\")"
          ],
          "line": 3352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceDiskLive(virLXCDriverPtr driver,\n                              virDomainObjPtr vm,\n                              virDomainDeviceDefPtr dev)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virDomainDiskDefPtr def = dev->data.disk;\n    int ret = -1;\n    struct stat sb;\n    char *file = NULL;\n    int perms;\n    const char *src = NULL;\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Cannot attach disk until init PID is known\"));\n        goto cleanup;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"devices cgroup isn't mounted\"));\n        goto cleanup;\n    }\n\n    src = virDomainDiskGetSource(def);\n    if (src == NULL) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk without media\"));\n        goto cleanup;\n    }\n\n    if (!virStorageSourceIsBlockLocal(def->src)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Can't setup disk for non-block device\"));\n        goto cleanup;\n    }\n\n    if (virDomainDiskIndexByName(vm->def, def->dst, true) >= 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"target %s already exists\"), def->dst);\n        goto cleanup;\n    }\n\n    if (stat(src, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access %s\"), src);\n        goto cleanup;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"Disk source %s must be a block device\"),\n                       src);\n        goto cleanup;\n    }\n\n    perms = (def->src->readonly ?\n             VIR_CGROUP_DEVICE_READ :\n             VIR_CGROUP_DEVICE_RW) |\n        VIR_CGROUP_DEVICE_MKNOD;\n\n    if (virCgroupAllowDevice(priv->cgroup,\n                             'b',\n                             major(sb.st_rdev),\n                             minor(sb.st_rdev),\n                             perms) < 0)\n        goto cleanup;\n\n    if (VIR_REALLOC_N(vm->def->disks, vm->def->ndisks + 1) < 0)\n        goto cleanup;\n\n    file = g_strdup_printf(\"/dev/%s\", def->dst);\n\n    if (lxcDomainAttachDeviceMknod(driver,\n                                   0700 | S_IFBLK,\n                                   sb.st_rdev,\n                                   vm,\n                                   dev,\n                                   file) < 0) {\n        if (virCgroupDenyDevice(priv->cgroup,\n                                'b',\n                                major(sb.st_rdev),\n                                minor(sb.st_rdev),\n                                perms) < 0)\n            VIR_WARN(\"cannot deny device %s for domain %s: %s\",\n                     src, vm->def->name, virGetLastErrorMessage());\n        goto cleanup;\n    }\n\n    virDomainDiskInsertPreAlloced(vm->def, def);\n\n    ret = 0;\n\n cleanup:\n    if (src)\n        virDomainAuditDisk(vm, NULL, def->src, \"attach\", ret == 0);\n    VIR_FREE(file);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceUnlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3322-3335",
    "snippet": "static int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virProcessRunInMountNamespace",
          "args": [
            "priv->initpid",
            "lxcDomainAttachDeviceUnlinkHelper",
            "file"
          ],
          "line": 3328
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessRunInMountNamespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1115-1123",
          "snippet": "int\nvirProcessRunInMountNamespace(pid_t pid G_GNUC_UNUSED,\n                              virProcessNamespaceCallback cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInMountNamespace(pid_t pid G_GNUC_UNUSED,\n                              virProcessNamespaceCallback cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceUnlink(virDomainObjPtr vm,\n                            char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceUnlinkHelper,\n                                      file) < 0) {\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceUnlinkHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3305-3319",
    "snippet": "static int\nlxcDomainAttachDeviceUnlinkHelper(pid_t pid G_GNUC_UNUSED,\n                                  void *opaque)\n{\n    const char *path = opaque;\n\n    VIR_DEBUG(\"Unlinking %s\", path);\n    if (unlink(path) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove device %s\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove device %s\")",
            "path"
          ],
          "line": 3313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove device %s\""
          ],
          "line": 3314
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 3312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Unlinking %s\"",
            "path"
          ],
          "line": 3311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);\n\nstatic int\nlxcDomainAttachDeviceUnlinkHelper(pid_t pid G_GNUC_UNUSED,\n                                  void *opaque)\n{\n    const char *path = opaque;\n\n    VIR_DEBUG(\"Unlinking %s\", path);\n    if (unlink(path) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove device %s\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceMknod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3270-3302",
    "snippet": "static int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSecurityManagerPostFork",
          "args": [
            "driver->securityManager"
          ],
          "line": 3300
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerPostFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "238-242",
          "snippet": "void\nvirSecurityManagerPostFork(virSecurityManagerPtr mgr)\n{\n    virObjectUnlock(mgr);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirSecurityManagerPostFork(virSecurityManagerPtr mgr)\n{\n    virObjectUnlock(mgr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessRunInMountNamespace",
          "args": [
            "priv->initpid",
            "lxcDomainAttachDeviceMknodHelper",
            "&data"
          ],
          "line": 3293
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessRunInMountNamespace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1115-1123",
          "snippet": "int\nvirProcessRunInMountNamespace(pid_t pid G_GNUC_UNUSED,\n                              virProcessNamespaceCallback cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessRunInMountNamespace(pid_t pid G_GNUC_UNUSED,\n                              virProcessNamespaceCallback cb G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerPreFork",
          "args": [
            "driver->securityManager"
          ],
          "line": 3290
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerPreFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "218-231",
          "snippet": "int\nvirSecurityManagerPreFork(virSecurityManagerPtr mgr)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->preFork) {\n        ret = mgr->drv->preFork(mgr);\n        if (ret < 0)\n            virObjectUnlock(mgr);\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerPreFork(virSecurityManagerPtr mgr)\n{\n    int ret = 0;\n\n    virObjectLock(mgr);\n    if (mgr->drv->preFork) {\n        ret = mgr->drv->preFork(mgr);\n        if (ret < 0)\n            virObjectUnlock(mgr);\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&data",
            "0",
            "sizeof(data)"
          ],
          "line": 3281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceMknod(virLXCDriverPtr driver,\n                           mode_t mode,\n                           dev_t dev,\n                           virDomainObjPtr vm,\n                           virDomainDeviceDefPtr def,\n                           char *file)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    struct lxcDomainAttachDeviceMknodData data;\n\n    memset(&data, 0, sizeof(data));\n\n    data.driver = driver;\n    data.mode = mode;\n    data.dev = dev;\n    data.vm = vm;\n    data.def = def;\n    data.file = file;\n\n    if (virSecurityManagerPreFork(driver->securityManager) < 0)\n        return -1;\n\n    if (virProcessRunInMountNamespace(priv->initpid,\n                                      lxcDomainAttachDeviceMknodHelper,\n                                      &data) < 0) {\n        virSecurityManagerPostFork(driver->securityManager);\n        return -1;\n    }\n\n    virSecurityManagerPostFork(driver->securityManager);\n    return 0;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceMknodHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3197-3267",
    "snippet": "static int\nlxcDomainAttachDeviceMknodHelper(pid_t pid G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    struct lxcDomainAttachDeviceMknodData *data = opaque;\n    int ret = -1;\n\n    virSecurityManagerPostFork(data->driver->securityManager);\n\n    if (virFileMakeParentPath(data->file) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create %s\"), data->file);\n        goto cleanup;\n    }\n\n    /* Yes, the device name we're creating may not\n     * actually correspond to the major:minor number\n     * we're using, but we've no other option at this\n     * time. Just have to hope that containerized apps\n     * don't get upset that the major:minor is different\n     * to that normally implied by the device name\n     */\n    VIR_DEBUG(\"Creating dev %s (%d,%d)\",\n              data->file, major(data->dev), minor(data->dev));\n    if (mknod(data->file, data->mode, data->dev) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create device %s\"),\n                             data->file);\n        goto cleanup;\n    }\n\n    if (lxcContainerChown(data->vm->def, data->file) < 0)\n        goto cleanup;\n\n    /* Labelling normally operates on src, but we need\n     * to actually label the dst here, so hack the config */\n    switch (data->def->type) {\n    case VIR_DOMAIN_DEVICE_DISK: {\n        virDomainDiskDefPtr def = data->def->data.disk;\n        char *tmpsrc = def->src->path;\n        def->src->path = data->file;\n        if (virSecurityManagerSetImageLabel(data->driver->securityManager,\n                                            data->vm->def, def->src,\n                                            VIR_SECURITY_DOMAIN_IMAGE_LABEL_BACKING_CHAIN) < 0) {\n            def->src->path = tmpsrc;\n            goto cleanup;\n        }\n        def->src->path = tmpsrc;\n    }   break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV: {\n        virDomainHostdevDefPtr def = data->def->data.hostdev;\n        if (virSecurityManagerSetHostdevLabel(data->driver->securityManager,\n                                              data->vm->def, def, NULL) < 0)\n            goto cleanup;\n    }   break;\n\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected device type %d\"),\n                       data->def->type);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        unlink(data->file);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "data->file"
          ],
          "line": 3265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unexpected device type %d\")",
            "data->def->type"
          ],
          "line": 3255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unexpected device type %d\""
          ],
          "line": 3256
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetHostdevLabel",
          "args": [
            "data->driver->securityManager",
            "data->vm->def",
            "def",
            "NULL"
          ],
          "line": 3249
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetHostdevLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "581-597",
          "snippet": "int\nvirSecurityManagerSetHostdevLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virDomainHostdevDefPtr dev,\n                                  const char *vroot)\n{\n    if (mgr->drv->domainSetSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetHostdevLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  virDomainHostdevDefPtr dev,\n                                  const char *vroot)\n{\n    if (mgr->drv->domainSetSecurityHostdevLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityHostdevLabel(mgr, vm, dev, vroot);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerSetImageLabel",
          "args": [
            "data->driver->securityManager",
            "data->vm->def",
            "def->src",
            "VIR_SECURITY_DOMAIN_IMAGE_LABEL_BACKING_CHAIN"
          ],
          "line": 3238
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerSetImageLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "543-559",
          "snippet": "int\nvirSecurityManagerSetImageLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virStorageSourcePtr src,\n                                virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainSetSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerSetImageLabel(virSecurityManagerPtr mgr,\n                                virDomainDefPtr vm,\n                                virStorageSourcePtr src,\n                                virSecurityDomainImageLabelFlags flags)\n{\n    if (mgr->drv->domainSetSecurityImageLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSetSecurityImageLabel(mgr, vm, src, flags);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcContainerChown",
          "args": [
            "data->vm->def",
            "data->file"
          ],
          "line": 3228
        },
        "resolved": true,
        "details": {
          "function_name": "lxcContainerChown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2461-2480",
          "snippet": "int lxcContainerChown(virDomainDefPtr def, const char *path)\n{\n    uid_t uid;\n    gid_t gid;\n\n    if (!def->idmap.uidmap)\n        return 0;\n\n    uid = def->idmap.uidmap[0].target;\n    gid = def->idmap.gidmap[0].target;\n\n    if (chown(path, uid, gid) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to change owner of %s to %u:%u\"),\n                             path, uid, gid);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nint lxcContainerChown(virDomainDefPtr def, const char *path)\n{\n    uid_t uid;\n    gid_t gid;\n\n    if (!def->idmap.uidmap)\n        return 0;\n\n    uid = def->idmap.uidmap[0].target;\n    gid = def->idmap.gidmap[0].target;\n\n    if (chown(path, uid, gid) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to change owner of %s to %u:%u\"),\n                             path, uid, gid);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create device %s\")",
            "data->file"
          ],
          "line": 3222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mknod",
          "args": [
            "data->file",
            "data->mode",
            "data->dev"
          ],
          "line": 3221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Creating dev %s (%d,%d)\"",
            "data->file",
            "major(data->dev)",
            "minor(data->dev)"
          ],
          "line": 3219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "data->dev"
          ],
          "line": 3220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "data->dev"
          ],
          "line": 3220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create %s\")",
            "data->file"
          ],
          "line": 3207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakeParentPath",
          "args": [
            "data->file"
          ],
          "line": 3206
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakeParentPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3094-3111",
          "snippet": "int\nvirFileMakeParentPath(const char *path)\n{\n    char *p;\n    g_autofree char *tmp = NULL;\n\n    VIR_DEBUG(\"path=%s\", path);\n\n    tmp = g_strdup(path);\n\n    if ((p = strrchr(tmp, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n    *p = '\\0';\n\n    return virFileMakePathHelper(tmp, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakeParentPath(const char *path)\n{\n    char *p;\n    g_autofree char *tmp = NULL;\n\n    VIR_DEBUG(\"path=%s\", path);\n\n    tmp = g_strdup(path);\n\n    if ((p = strrchr(tmp, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n    *p = '\\0';\n\n    return virFileMakePathHelper(tmp, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerPostFork",
          "args": [
            "data->driver->securityManager"
          ],
          "line": 3204
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerPostFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "238-242",
          "snippet": "void\nvirSecurityManagerPostFork(virSecurityManagerPtr mgr)\n{\n    virObjectUnlock(mgr);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirSecurityManagerPostFork(virSecurityManagerPtr mgr)\n{\n    virObjectUnlock(mgr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);\n\nstatic int\nlxcDomainAttachDeviceMknodHelper(pid_t pid G_GNUC_UNUSED,\n                                 void *opaque)\n{\n    struct lxcDomainAttachDeviceMknodData *data = opaque;\n    int ret = -1;\n\n    virSecurityManagerPostFork(data->driver->securityManager);\n\n    if (virFileMakeParentPath(data->file) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create %s\"), data->file);\n        goto cleanup;\n    }\n\n    /* Yes, the device name we're creating may not\n     * actually correspond to the major:minor number\n     * we're using, but we've no other option at this\n     * time. Just have to hope that containerized apps\n     * don't get upset that the major:minor is different\n     * to that normally implied by the device name\n     */\n    VIR_DEBUG(\"Creating dev %s (%d,%d)\",\n              data->file, major(data->dev), minor(data->dev));\n    if (mknod(data->file, data->mode, data->dev) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create device %s\"),\n                             data->file);\n        goto cleanup;\n    }\n\n    if (lxcContainerChown(data->vm->def, data->file) < 0)\n        goto cleanup;\n\n    /* Labelling normally operates on src, but we need\n     * to actually label the dst here, so hack the config */\n    switch (data->def->type) {\n    case VIR_DOMAIN_DEVICE_DISK: {\n        virDomainDiskDefPtr def = data->def->data.disk;\n        char *tmpsrc = def->src->path;\n        def->src->path = data->file;\n        if (virSecurityManagerSetImageLabel(data->driver->securityManager,\n                                            data->vm->def, def->src,\n                                            VIR_SECURITY_DOMAIN_IMAGE_LABEL_BACKING_CHAIN) < 0) {\n            def->src->path = tmpsrc;\n            goto cleanup;\n        }\n        def->src->path = tmpsrc;\n    }   break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV: {\n        virDomainHostdevDefPtr def = data->def->data.hostdev;\n        if (virSecurityManagerSetHostdevLabel(data->driver->securityManager,\n                                              data->vm->def, def, NULL) < 0)\n            goto cleanup;\n    }   break;\n\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected device type %d\"),\n                       data->def->type);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        unlink(data->file);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDetachDeviceConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3133-3185",
    "snippet": "static int\nlxcDomainDetachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk, det_disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev, det_hostdev;\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (!(det_disk = virDomainDiskRemoveByName(vmdef, disk->dst))) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no target device %s\"), disk->dst);\n            return -1;\n        }\n        virDomainDiskDefFree(det_disk);\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        /* this is guaranteed to succeed */\n        virDomainNetDefFree(virDomainNetRemove(vmdef, idx));\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV: {\n        hostdev = dev->data.hostdev;\n        if ((idx = virDomainHostdevFind(vmdef, hostdev, &det_hostdev)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device not present in domain configuration\"));\n            return -1;\n        }\n        virDomainHostdevRemove(vmdef, idx);\n        virDomainHostdevDefFree(det_hostdev);\n        ret = 0;\n        break;\n    }\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent detach of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"persistent detach of device is not supported\")"
          ],
          "line": 3179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"persistent detach of device is not supported\""
          ],
          "line": 3180
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevDefFree",
          "args": [
            "det_hostdev"
          ],
          "line": 3173
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3002-3015",
          "snippet": "void virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def)\n{\n    if (!def)\n        return;\n\n    /* free all subordinate objects */\n    virDomainHostdevDefClear(def);\n\n    /* If there is a parentnet device object, it will handle freeing\n     * the memory.\n     */\n    if (!def->parentnet)\n        VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevRemove",
          "args": [
            "vmdef",
            "idx"
          ],
          "line": 3172
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17015-17022",
          "snippet": "virDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainHostdevDefPtr\nvirDomainHostdevRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainHostdevDefPtr hostdev = def->hostdevs[i];\n\n    VIR_DELETE_ELEMENT(def->hostdevs, i, def->nhostdevs);\n    return hostdev;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"device not present in domain configuration\")"
          ],
          "line": 3168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vmdef",
            "hostdev",
            "&det_hostdev"
          ],
          "line": 3167
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetDefFree",
          "args": [
            "virDomainNetRemove(vmdef, idx)"
          ],
          "line": 3161
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2481-2489",
          "snippet": "void\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetRemove",
          "args": [
            "vmdef",
            "idx"
          ],
          "line": 3161
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17557-17565",
          "snippet": "virDomainNetDefPtr\nvirDomainNetRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainNetDefPtr net = def->nets[i];\n\n    virDomainNetRemoveHostdev(def, net);\n    VIR_DELETE_ELEMENT(def->nets, i, def->nnets);\n    return net;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetDefPtr\nvirDomainNetRemove(virDomainDefPtr def, size_t i)\n{\n    virDomainNetDefPtr net = def->nets[i];\n\n    virDomainNetRemoveHostdev(def, net);\n    VIR_DELETE_ELEMENT(def->nets, i, def->nnets);\n    return net;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetFindIdx",
          "args": [
            "vmdef",
            "net"
          ],
          "line": 3157
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetFindIdx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17444-17513",
          "snippet": "int\nvirDomainNetFindIdx(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    size_t i;\n    int matchidx = -1;\n    char mac[VIR_MAC_STRING_BUFLEN];\n    bool MACAddrSpecified = !net->mac_generated;\n    bool PCIAddrSpecified = virDomainDeviceAddressIsValid(&net->info,\n                                                          VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI);\n\n    for (i = 0; i < def->nnets; i++) {\n        if (MACAddrSpecified &&\n            virMacAddrCmp(&def->nets[i]->mac, &net->mac) != 0)\n            continue;\n\n        if (PCIAddrSpecified &&\n            !virPCIDeviceAddressEqual(&def->nets[i]->info.addr.pci,\n                                      &net->info.addr.pci))\n            continue;\n\n        if (matchidx >= 0) {\n            /* there were multiple matches on mac address, and no\n             * qualifying guest-side PCI address was given, so we must\n             * fail (NB: a USB address isn't adequate, since it may\n             * specify only vendor and product ID, and there may be\n             * multiples of those.\n             */\n            if (MACAddrSpecified) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               _(\"multiple devices matching MAC address %s found\"),\n                               virMacAddrFormat(&net->mac, mac));\n            } else {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"multiple matching devices found\"));\n            }\n\n            return -1;\n        }\n\n        matchidx = i;\n    }\n\n    if (matchidx < 0) {\n        if (MACAddrSpecified && PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found on \"\n                             VIR_PCI_DEVICE_ADDRESS_FMT),\n                           virMacAddrFormat(&net->mac, mac),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device found on \" VIR_PCI_DEVICE_ADDRESS_FMT),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (MACAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found\"),\n                           virMacAddrFormat(&net->mac, mac));\n        } else {\n            virReportError(VIR_ERR_DEVICE_MISSING, \"%s\",\n                           _(\"no matching device found\"));\n        }\n    }\n    return matchidx;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetFindIdx(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    size_t i;\n    int matchidx = -1;\n    char mac[VIR_MAC_STRING_BUFLEN];\n    bool MACAddrSpecified = !net->mac_generated;\n    bool PCIAddrSpecified = virDomainDeviceAddressIsValid(&net->info,\n                                                          VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI);\n\n    for (i = 0; i < def->nnets; i++) {\n        if (MACAddrSpecified &&\n            virMacAddrCmp(&def->nets[i]->mac, &net->mac) != 0)\n            continue;\n\n        if (PCIAddrSpecified &&\n            !virPCIDeviceAddressEqual(&def->nets[i]->info.addr.pci,\n                                      &net->info.addr.pci))\n            continue;\n\n        if (matchidx >= 0) {\n            /* there were multiple matches on mac address, and no\n             * qualifying guest-side PCI address was given, so we must\n             * fail (NB: a USB address isn't adequate, since it may\n             * specify only vendor and product ID, and there may be\n             * multiples of those.\n             */\n            if (MACAddrSpecified) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               _(\"multiple devices matching MAC address %s found\"),\n                               virMacAddrFormat(&net->mac, mac));\n            } else {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"multiple matching devices found\"));\n            }\n\n            return -1;\n        }\n\n        matchidx = i;\n    }\n\n    if (matchidx < 0) {\n        if (MACAddrSpecified && PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found on \"\n                             VIR_PCI_DEVICE_ADDRESS_FMT),\n                           virMacAddrFormat(&net->mac, mac),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device found on \" VIR_PCI_DEVICE_ADDRESS_FMT),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (MACAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found\"),\n                           virMacAddrFormat(&net->mac, mac));\n        } else {\n            virReportError(VIR_ERR_DEVICE_MISSING, \"%s\",\n                           _(\"no matching device found\"));\n        }\n    }\n    return matchidx;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskDefFree",
          "args": [
            "det_disk"
          ],
          "line": 3151
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2117-2138",
          "snippet": "void\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDiskDefFree(virDomainDiskDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->serial);\n    VIR_FREE(def->dst);\n    virObjectUnref(def->mirror);\n    VIR_FREE(def->wwn);\n    VIR_FREE(def->driverName);\n    VIR_FREE(def->vendor);\n    VIR_FREE(def->product);\n    VIR_FREE(def->domain_name);\n    VIR_FREE(def->blkdeviotune.group_name);\n    VIR_FREE(def->virtio);\n    virDomainDeviceInfoClear(&def->info);\n    virObjectUnref(def->privateData);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"no target device %s\")",
            "disk->dst"
          ],
          "line": 3147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskRemoveByName",
          "args": [
            "vmdef",
            "disk->dst"
          ],
          "line": 3146
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskRemoveByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17406-17413",
          "snippet": "virDomainDiskDefPtr\nvirDomainDiskRemoveByName(virDomainDefPtr def, const char *name)\n{\n    int idx = virDomainDiskIndexByName(def, name, false);\n    if (idx < 0)\n        return NULL;\n    return virDomainDiskRemove(def, idx);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDiskDefPtr\nvirDomainDiskRemoveByName(virDomainDefPtr def, const char *name)\n{\n    int idx = virDomainDiskIndexByName(def, name, false);\n    if (idx < 0)\n        return NULL;\n    return virDomainDiskRemove(def, idx);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDetachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk, det_disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev, det_hostdev;\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (!(det_disk = virDomainDiskRemoveByName(vmdef, disk->dst))) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"no target device %s\"), disk->dst);\n            return -1;\n        }\n        virDomainDiskDefFree(det_disk);\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        /* this is guaranteed to succeed */\n        virDomainNetDefFree(virDomainNetRemove(vmdef, idx));\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV: {\n        hostdev = dev->data.hostdev;\n        if ((idx = virDomainHostdevFind(vmdef, hostdev, &det_hostdev)) < 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device not present in domain configuration\"));\n            return -1;\n        }\n        virDomainHostdevRemove(vmdef, idx);\n        virDomainHostdevDefFree(det_hostdev);\n        ret = 0;\n        break;\n    }\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent detach of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainUpdateDeviceConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3093-3130",
    "snippet": "static int\nlxcDomainUpdateDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainNetDefPtr net;\n    virDomainDeviceDef oldDev = { .type = dev->type };\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        oldDev.data.net = vmdef->nets[idx];\n        if (virDomainDefCompatibleDevice(vmdef, dev, &oldDev,\n                                         VIR_DOMAIN_DEVICE_ACTION_UPDATE,\n                                         false) < 0)\n            return -1;\n\n        if (virDomainNetUpdate(vmdef, idx, net) < 0)\n            return -1;\n\n        virDomainNetDefFree(oldDev.data.net);\n        dev->data.net = NULL;\n        ret = 0;\n\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent update of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"persistent update of device is not supported\")"
          ],
          "line": 3124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"persistent update of device is not supported\""
          ],
          "line": 3125
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetDefFree",
          "args": [
            "oldDev.data.net"
          ],
          "line": 3117
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2481-2489",
          "snippet": "void\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetUpdate",
          "args": [
            "vmdef",
            "idx",
            "net"
          ],
          "line": 3114
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetUpdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17568-17605",
          "snippet": "int\nvirDomainNetUpdate(virDomainDefPtr def,\n                   size_t netidx,\n                   virDomainNetDefPtr newnet)\n{\n    size_t hostdevidx;\n    virDomainNetDefPtr oldnet = def->nets[netidx];\n    virDomainHostdevDefPtr oldhostdev = virDomainNetGetActualHostdev(oldnet);\n    virDomainHostdevDefPtr newhostdev = virDomainNetGetActualHostdev(newnet);\n\n    /*\n     * if newnet or oldnet has a valid hostdev*, we need to update the\n     * hostdevs list\n     */\n    if (oldhostdev) {\n        for (hostdevidx = 0; hostdevidx < def->nhostdevs; hostdevidx++) {\n            if (def->hostdevs[hostdevidx] == oldhostdev)\n                break;\n        }\n    }\n\n    if (oldhostdev && hostdevidx < def->nhostdevs) {\n        if (newhostdev) {\n            /* update existing entry in def->hostdevs */\n            def->hostdevs[hostdevidx] = newhostdev;\n        } else {\n            /* delete oldhostdev from def->hostdevs */\n            virDomainHostdevRemove(def, hostdevidx);\n        }\n    } else if (newhostdev) {\n        /* add newhostdev to end of def->hostdevs */\n        if (VIR_APPEND_ELEMENT(def->hostdevs, def->nhostdevs, newhostdev) < 0)\n            return -1;\n    }\n\n    def->nets[netidx] = newnet;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetUpdate(virDomainDefPtr def,\n                   size_t netidx,\n                   virDomainNetDefPtr newnet)\n{\n    size_t hostdevidx;\n    virDomainNetDefPtr oldnet = def->nets[netidx];\n    virDomainHostdevDefPtr oldhostdev = virDomainNetGetActualHostdev(oldnet);\n    virDomainHostdevDefPtr newhostdev = virDomainNetGetActualHostdev(newnet);\n\n    /*\n     * if newnet or oldnet has a valid hostdev*, we need to update the\n     * hostdevs list\n     */\n    if (oldhostdev) {\n        for (hostdevidx = 0; hostdevidx < def->nhostdevs; hostdevidx++) {\n            if (def->hostdevs[hostdevidx] == oldhostdev)\n                break;\n        }\n    }\n\n    if (oldhostdev && hostdevidx < def->nhostdevs) {\n        if (newhostdev) {\n            /* update existing entry in def->hostdevs */\n            def->hostdevs[hostdevidx] = newhostdev;\n        } else {\n            /* delete oldhostdev from def->hostdevs */\n            virDomainHostdevRemove(def, hostdevidx);\n        }\n    } else if (newhostdev) {\n        /* add newhostdev to end of def->hostdevs */\n        if (VIR_APPEND_ELEMENT(def->hostdevs, def->nhostdevs, newhostdev) < 0)\n            return -1;\n    }\n\n    def->nets[netidx] = newnet;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefCompatibleDevice",
          "args": [
            "vmdef",
            "dev",
            "&oldDev",
            "VIR_DOMAIN_DEVICE_ACTION_UPDATE",
            "false"
          ],
          "line": 3109
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefCompatibleDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29597-29664",
          "snippet": "int\nvirDomainDefCompatibleDevice(virDomainDefPtr def,\n                             virDomainDeviceDefPtr dev,\n                             virDomainDeviceDefPtr oldDev,\n                             virDomainDeviceAction action,\n                             bool live)\n{\n    virDomainCompatibleDeviceData data = {\n        .newInfo = virDomainDeviceGetInfo(dev),\n        .oldInfo = NULL,\n    };\n\n    if (oldDev)\n        data.oldInfo = virDomainDeviceGetInfo(oldDev);\n\n    if (action == VIR_DOMAIN_DEVICE_ACTION_UPDATE &&\n        live &&\n        (data.newInfo && data.oldInfo &&\n         data.newInfo->alias && data.oldInfo->alias &&\n         STRNEQ(data.newInfo->alias, data.oldInfo->alias))) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"changing device alias is not allowed\"));\n        return -1;\n    }\n\n    if (!virDomainDefHasUSB(def) &&\n        def->os.type != VIR_DOMAIN_OSTYPE_EXE &&\n        virDomainDeviceIsUSB(dev)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Device configuration is not compatible: \"\n                         \"Domain has no USB bus support\"));\n        return -1;\n    }\n\n    if (data.newInfo && data.newInfo->bootIndex > 0) {\n        if (def->os.nBootDevs > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"per-device boot elements cannot be used\"\n                             \" together with os/boot elements\"));\n            return -1;\n        }\n        if (virDomainDeviceInfoIterate(def,\n                                       virDomainDeviceInfoCheckBootIndex,\n                                       &data) < 0)\n            return -1;\n    }\n\n    if (dev->type == VIR_DOMAIN_DEVICE_MEMORY) {\n        unsigned long long sz = dev->data.memory->size;\n\n        if (!virDomainDefHasMemoryHotplug(def)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use/hotplug a memory device when domain \"\n                             \"'maxMemory' is not defined\"));\n            return -1;\n        }\n\n        if ((virDomainDefGetMemoryTotal(def) + sz) > def->mem.max_memory) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Attaching memory device with size '%llu' would \"\n                             \"exceed domain's maxMemory config size '%llu'\"),\n                           sz, def->mem.max_memory);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefCompatibleDevice(virDomainDefPtr def,\n                             virDomainDeviceDefPtr dev,\n                             virDomainDeviceDefPtr oldDev,\n                             virDomainDeviceAction action,\n                             bool live)\n{\n    virDomainCompatibleDeviceData data = {\n        .newInfo = virDomainDeviceGetInfo(dev),\n        .oldInfo = NULL,\n    };\n\n    if (oldDev)\n        data.oldInfo = virDomainDeviceGetInfo(oldDev);\n\n    if (action == VIR_DOMAIN_DEVICE_ACTION_UPDATE &&\n        live &&\n        (data.newInfo && data.oldInfo &&\n         data.newInfo->alias && data.oldInfo->alias &&\n         STRNEQ(data.newInfo->alias, data.oldInfo->alias))) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"changing device alias is not allowed\"));\n        return -1;\n    }\n\n    if (!virDomainDefHasUSB(def) &&\n        def->os.type != VIR_DOMAIN_OSTYPE_EXE &&\n        virDomainDeviceIsUSB(dev)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"Device configuration is not compatible: \"\n                         \"Domain has no USB bus support\"));\n        return -1;\n    }\n\n    if (data.newInfo && data.newInfo->bootIndex > 0) {\n        if (def->os.nBootDevs > 0) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"per-device boot elements cannot be used\"\n                             \" together with os/boot elements\"));\n            return -1;\n        }\n        if (virDomainDeviceInfoIterate(def,\n                                       virDomainDeviceInfoCheckBootIndex,\n                                       &data) < 0)\n            return -1;\n    }\n\n    if (dev->type == VIR_DOMAIN_DEVICE_MEMORY) {\n        unsigned long long sz = dev->data.memory->size;\n\n        if (!virDomainDefHasMemoryHotplug(def)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use/hotplug a memory device when domain \"\n                             \"'maxMemory' is not defined\"));\n            return -1;\n        }\n\n        if ((virDomainDefGetMemoryTotal(def) + sz) > def->mem.max_memory) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Attaching memory device with size '%llu' would \"\n                             \"exceed domain's maxMemory config size '%llu'\"),\n                           sz, def->mem.max_memory);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetFindIdx",
          "args": [
            "vmdef",
            "net"
          ],
          "line": 3105
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetFindIdx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17444-17513",
          "snippet": "int\nvirDomainNetFindIdx(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    size_t i;\n    int matchidx = -1;\n    char mac[VIR_MAC_STRING_BUFLEN];\n    bool MACAddrSpecified = !net->mac_generated;\n    bool PCIAddrSpecified = virDomainDeviceAddressIsValid(&net->info,\n                                                          VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI);\n\n    for (i = 0; i < def->nnets; i++) {\n        if (MACAddrSpecified &&\n            virMacAddrCmp(&def->nets[i]->mac, &net->mac) != 0)\n            continue;\n\n        if (PCIAddrSpecified &&\n            !virPCIDeviceAddressEqual(&def->nets[i]->info.addr.pci,\n                                      &net->info.addr.pci))\n            continue;\n\n        if (matchidx >= 0) {\n            /* there were multiple matches on mac address, and no\n             * qualifying guest-side PCI address was given, so we must\n             * fail (NB: a USB address isn't adequate, since it may\n             * specify only vendor and product ID, and there may be\n             * multiples of those.\n             */\n            if (MACAddrSpecified) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               _(\"multiple devices matching MAC address %s found\"),\n                               virMacAddrFormat(&net->mac, mac));\n            } else {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"multiple matching devices found\"));\n            }\n\n            return -1;\n        }\n\n        matchidx = i;\n    }\n\n    if (matchidx < 0) {\n        if (MACAddrSpecified && PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found on \"\n                             VIR_PCI_DEVICE_ADDRESS_FMT),\n                           virMacAddrFormat(&net->mac, mac),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device found on \" VIR_PCI_DEVICE_ADDRESS_FMT),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (MACAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found\"),\n                           virMacAddrFormat(&net->mac, mac));\n        } else {\n            virReportError(VIR_ERR_DEVICE_MISSING, \"%s\",\n                           _(\"no matching device found\"));\n        }\n    }\n    return matchidx;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetFindIdx(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    size_t i;\n    int matchidx = -1;\n    char mac[VIR_MAC_STRING_BUFLEN];\n    bool MACAddrSpecified = !net->mac_generated;\n    bool PCIAddrSpecified = virDomainDeviceAddressIsValid(&net->info,\n                                                          VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI);\n\n    for (i = 0; i < def->nnets; i++) {\n        if (MACAddrSpecified &&\n            virMacAddrCmp(&def->nets[i]->mac, &net->mac) != 0)\n            continue;\n\n        if (PCIAddrSpecified &&\n            !virPCIDeviceAddressEqual(&def->nets[i]->info.addr.pci,\n                                      &net->info.addr.pci))\n            continue;\n\n        if (matchidx >= 0) {\n            /* there were multiple matches on mac address, and no\n             * qualifying guest-side PCI address was given, so we must\n             * fail (NB: a USB address isn't adequate, since it may\n             * specify only vendor and product ID, and there may be\n             * multiples of those.\n             */\n            if (MACAddrSpecified) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               _(\"multiple devices matching MAC address %s found\"),\n                               virMacAddrFormat(&net->mac, mac));\n            } else {\n                virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                               _(\"multiple matching devices found\"));\n            }\n\n            return -1;\n        }\n\n        matchidx = i;\n    }\n\n    if (matchidx < 0) {\n        if (MACAddrSpecified && PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found on \"\n                             VIR_PCI_DEVICE_ADDRESS_FMT),\n                           virMacAddrFormat(&net->mac, mac),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (PCIAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device found on \" VIR_PCI_DEVICE_ADDRESS_FMT),\n                           net->info.addr.pci.domain,\n                           net->info.addr.pci.bus,\n                           net->info.addr.pci.slot,\n                           net->info.addr.pci.function);\n        } else if (MACAddrSpecified) {\n            virReportError(VIR_ERR_DEVICE_MISSING,\n                           _(\"no device matching MAC address %s found\"),\n                           virMacAddrFormat(&net->mac, mac));\n        } else {\n            virReportError(VIR_ERR_DEVICE_MISSING, \"%s\",\n                           _(\"no matching device found\"));\n        }\n    }\n    return matchidx;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainUpdateDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainNetDefPtr net;\n    virDomainDeviceDef oldDev = { .type = dev->type };\n    int idx;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if ((idx = virDomainNetFindIdx(vmdef, net)) < 0)\n            return -1;\n\n        oldDev.data.net = vmdef->nets[idx];\n        if (virDomainDefCompatibleDevice(vmdef, dev, &oldDev,\n                                         VIR_DOMAIN_DEVICE_ACTION_UPDATE,\n                                         false) < 0)\n            return -1;\n\n        if (virDomainNetUpdate(vmdef, idx, net) < 0)\n            return -1;\n\n        virDomainNetDefFree(oldDev.data.net);\n        dev->data.net = NULL;\n        ret = 0;\n\n        break;\n\n    default:\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"persistent update of device is not supported\"));\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainAttachDeviceConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "3038-3090",
    "snippet": "static int\nlxcDomainAttachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (virDomainDiskIndexByName(vmdef, disk->dst, true) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s already exists.\"), disk->dst);\n            return -1;\n        }\n        if (virDomainDiskInsert(vmdef, disk) < 0)\n            return -1;\n        /* vmdef has the pointer. Generic codes for vmdef will do all jobs */\n        dev->data.disk = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if (virDomainNetInsert(vmdef, net) < 0)\n            return -1;\n        dev->data.net = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        hostdev = dev->data.hostdev;\n        if (virDomainHostdevFind(vmdef, hostdev, NULL) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device is already in the domain configuration\"));\n            return -1;\n        }\n        if (virDomainHostdevInsert(vmdef, hostdev) < 0)\n            return -1;\n        dev->data.hostdev = NULL;\n        ret = 0;\n        break;\n\n    default:\n         virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                        _(\"persistent attach of device is not supported\"));\n         break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"persistent attach of device is not supported\")"
          ],
          "line": 3084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"persistent attach of device is not supported\""
          ],
          "line": 3085
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainHostdevInsert",
          "args": [
            "vmdef",
            "hostdev"
          ],
          "line": 3077
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevInsert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17009-17013",
          "snippet": "int\nvirDomainHostdevInsert(virDomainDefPtr def, virDomainHostdevDefPtr hostdev)\n{\n    return VIR_APPEND_ELEMENT(def->hostdevs, def->nhostdevs, hostdev);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevInsert(virDomainDefPtr def, virDomainHostdevDefPtr hostdev)\n{\n    return VIR_APPEND_ELEMENT(def->hostdevs, def->nhostdevs, hostdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"device is already in the domain configuration\")"
          ],
          "line": 3073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainHostdevFind",
          "args": [
            "vmdef",
            "hostdev",
            "NULL"
          ],
          "line": 3072
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainHostdevFind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17212-17231",
          "snippet": "int\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainHostdevFind(virDomainDefPtr def,\n                     virDomainHostdevDefPtr match,\n                     virDomainHostdevDefPtr *found)\n{\n    virDomainHostdevDefPtr local_found;\n    size_t i;\n\n    if (!found)\n        found = &local_found;\n    *found = NULL;\n\n    for (i = 0; i < def->nhostdevs; i++) {\n        if (virDomainHostdevMatch(match, def->hostdevs[i])) {\n            *found = def->hostdevs[i];\n            break;\n        }\n    }\n    return *found ? i : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetInsert",
          "args": [
            "vmdef",
            "net"
          ],
          "line": 3064
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetInsert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17415-17430",
          "snippet": "int virDomainNetInsert(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    /* hostdev net devices must also exist in the hostdevs array */\n    if (net->type == VIR_DOMAIN_NET_TYPE_HOSTDEV &&\n        virDomainHostdevInsert(def, &net->data.hostdev.def) < 0)\n        return -1;\n\n    if (VIR_APPEND_ELEMENT(def->nets, def->nnets, net) < 0) {\n        /* virDomainHostdevInsert just appends new hostdevs, so we are sure\n         * that the hostdev we've added a few lines above is at the end of\n         * array. Although, devices are indexed from zero ... */\n        virDomainHostdevRemove(def, def->nhostdevs - 1);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virDomainNetInsert(virDomainDefPtr def, virDomainNetDefPtr net)\n{\n    /* hostdev net devices must also exist in the hostdevs array */\n    if (net->type == VIR_DOMAIN_NET_TYPE_HOSTDEV &&\n        virDomainHostdevInsert(def, &net->data.hostdev.def) < 0)\n        return -1;\n\n    if (VIR_APPEND_ELEMENT(def->nets, def->nnets, net) < 0) {\n        /* virDomainHostdevInsert just appends new hostdevs, so we are sure\n         * that the hostdev we've added a few lines above is at the end of\n         * array. Although, devices are indexed from zero ... */\n        virDomainHostdevRemove(def, def->nhostdevs - 1);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskInsert",
          "args": [
            "vmdef",
            "disk"
          ],
          "line": 3055
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskInsertPreAlloced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17363-17394",
          "snippet": "void virDomainDiskInsertPreAlloced(virDomainDefPtr def,\n                                   virDomainDiskDefPtr disk)\n{\n    int idx;\n    /* Tentatively plan to insert disk at the end. */\n    int insertAt = -1;\n\n    /* Then work backwards looking for disks on\n     * the same bus. If we find a disk with a drive\n     * index greater than the new one, insert at\n     * that position\n     */\n    for (idx = (def->ndisks - 1); idx >= 0; idx--) {\n        /* If bus matches and current disk is after\n         * new disk, then new disk should go here */\n        if (def->disks[idx]->bus == disk->bus &&\n            (virDiskNameToIndex(def->disks[idx]->dst) >\n             virDiskNameToIndex(disk->dst))) {\n            insertAt = idx;\n        } else if (def->disks[idx]->bus == disk->bus &&\n                   insertAt == -1) {\n            /* Last disk with match bus is before the\n             * new disk, then put new disk just after\n             */\n            insertAt = idx + 1;\n        }\n    }\n\n    /* VIR_INSERT_ELEMENT_INPLACE will never return an error here. */\n    ignore_value(VIR_INSERT_ELEMENT_INPLACE(def->disks, insertAt,\n                                            def->ndisks, disk));\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDiskInsertPreAlloced(virDomainDefPtr def,\n                                   virDomainDiskDefPtr disk)\n{\n    int idx;\n    /* Tentatively plan to insert disk at the end. */\n    int insertAt = -1;\n\n    /* Then work backwards looking for disks on\n     * the same bus. If we find a disk with a drive\n     * index greater than the new one, insert at\n     * that position\n     */\n    for (idx = (def->ndisks - 1); idx >= 0; idx--) {\n        /* If bus matches and current disk is after\n         * new disk, then new disk should go here */\n        if (def->disks[idx]->bus == disk->bus &&\n            (virDiskNameToIndex(def->disks[idx]->dst) >\n             virDiskNameToIndex(disk->dst))) {\n            insertAt = idx;\n        } else if (def->disks[idx]->bus == disk->bus &&\n                   insertAt == -1) {\n            /* Last disk with match bus is before the\n             * new disk, then put new disk just after\n             */\n            insertAt = idx + 1;\n        }\n    }\n\n    /* VIR_INSERT_ELEMENT_INPLACE will never return an error here. */\n    ignore_value(VIR_INSERT_ELEMENT_INPLACE(def->disks, insertAt,\n                                            def->ndisks, disk));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"target %s already exists.\")",
            "disk->dst"
          ],
          "line": 3051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskIndexByName",
          "args": [
            "vmdef",
            "disk->dst",
            "true"
          ],
          "line": 3050
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskIndexByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17299-17325",
          "snippet": "int\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskIndexByName(virDomainDefPtr def, const char *name,\n                         bool allow_ambiguous)\n{\n    virDomainDiskDefPtr vdisk;\n    size_t i;\n    int candidate = -1;\n\n    /* We prefer the <target dev='name'/> name (it's shorter, required\n     * for all disks, and should be unambiguous), but also support\n     * <source file='name'/> (if unambiguous).  Assume dst if there is\n     * no leading slash, source name otherwise.  */\n    for (i = 0; i < def->ndisks; i++) {\n        vdisk = def->disks[i];\n        if (*name != '/') {\n            if (STREQ(vdisk->dst, name))\n                return i;\n        } else if (STREQ_NULLABLE(virDomainDiskGetSource(vdisk), name)) {\n            if (allow_ambiguous)\n                return i;\n            if (candidate >= 0)\n                return -1;\n            candidate = i;\n        }\n    }\n    return candidate;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainAttachDeviceConfig(virDomainDefPtr vmdef,\n                            virDomainDeviceDefPtr dev)\n{\n    int ret = -1;\n    virDomainDiskDefPtr disk;\n    virDomainNetDefPtr net;\n    virDomainHostdevDefPtr hostdev;\n\n    switch (dev->type) {\n    case VIR_DOMAIN_DEVICE_DISK:\n        disk = dev->data.disk;\n        if (virDomainDiskIndexByName(vmdef, disk->dst, true) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"target %s already exists.\"), disk->dst);\n            return -1;\n        }\n        if (virDomainDiskInsert(vmdef, disk) < 0)\n            return -1;\n        /* vmdef has the pointer. Generic codes for vmdef will do all jobs */\n        dev->data.disk = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_NET:\n        net = dev->data.net;\n        if (virDomainNetInsert(vmdef, net) < 0)\n            return -1;\n        dev->data.net = NULL;\n        ret = 0;\n        break;\n\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n        hostdev = dev->data.hostdev;\n        if (virDomainHostdevFind(vmdef, hostdev, NULL) >= 0) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"device is already in the domain configuration\"));\n            return -1;\n        }\n        if (virDomainHostdevInsert(vmdef, hostdev) < 0)\n            return -1;\n        dev->data.hostdev = NULL;\n        ret = 0;\n        break;\n\n    default:\n         virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                        _(\"persistent attach of device is not supported\"));\n         break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainReboot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2968-3035",
    "snippet": "static int\nlxcDomainReboot(virDomainPtr dom,\n                unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDomainObjPrivatePtr priv;\n    virDomainObjPtr vm;\n    int ret = -1;\n    int rc = -1;\n\n    virCheckFlags(VIR_DOMAIN_REBOOT_INITCTL |\n                  VIR_DOMAIN_REBOOT_SIGNAL, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainRebootEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (priv->initpid == 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Init process ID is not yet known\"));\n        goto endjob;\n    }\n\n    if (flags == 0 ||\n        (flags & VIR_DOMAIN_REBOOT_INITCTL)) {\n        int command = VIR_INITCTL_RUNLEVEL_REBOOT;\n\n        if ((rc = virLXCDomainSetRunlevel(vm, command)) < 0) {\n            if (flags != 0 &&\n                (flags & VIR_DOMAIN_REBOOT_INITCTL)) {\n                virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                               _(\"Container does not provide an initctl pipe\"));\n                goto endjob;\n            }\n        }\n    }\n\n    if (rc < 0 &&\n        (flags == 0 ||\n         (flags & VIR_DOMAIN_REBOOT_SIGNAL))) {\n        if (kill(priv->initpid, SIGHUP) < 0 &&\n            errno != ESRCH) {\n            virReportSystemError(errno,\n                                 _(\"Unable to send SIGTERM to init pid %llu\"),\n                                 (long long)priv->initpid);\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 3033
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 3030
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to send SIGTERM to init pid %llu\")",
            "(long long)priv->initpid"
          ],
          "line": 3020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to send SIGTERM to init pid %llu\""
          ],
          "line": 3021
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "priv->initpid",
            "SIGHUP"
          ],
          "line": 3018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"Container does not provide an initctl pipe\")"
          ],
          "line": 3008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDomainSetRunlevel",
          "args": [
            "vm",
            "command"
          ],
          "line": 3005
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainSetRunlevel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "459-501",
          "snippet": "int\nvirLXCDomainSetRunlevel(virDomainObjPtr vm,\n                        int runlevel)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    lxcDomainInitctlCallbackData data;\n    size_t nfifos = 0;\n    size_t i;\n    int ret = -1;\n\n    memset(&data, 0, sizeof(data));\n\n    data.runlevel = runlevel;\n\n    for (nfifos = 0; virInitctlFifos[nfifos]; nfifos++)\n        ;\n\n    if (VIR_ALLOC_N(data.st, nfifos) < 0 ||\n        VIR_ALLOC_N(data.st_valid, nfifos) < 0)\n        goto cleanup;\n\n    for (i = 0; virInitctlFifos[i]; i++) {\n        const char *fifo = virInitctlFifos[i];\n\n        if (stat(fifo, &(data.st[i])) < 0) {\n            if (errno == ENOENT)\n                continue;\n\n            virReportSystemError(errno, _(\"Unable to stat %s\"), fifo);\n            goto cleanup;\n        }\n\n        data.st_valid[i] = true;\n    }\n\n    ret = virProcessRunInMountNamespace(priv->initpid,\n                                        lxcDomainInitctlCallback,\n                                        &data);\n cleanup:\n    VIR_FREE(data.st);\n    VIR_FREE(data.st_valid);\n    return ret;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nint\nvirLXCDomainSetRunlevel(virDomainObjPtr vm,\n                        int runlevel)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    lxcDomainInitctlCallbackData data;\n    size_t nfifos = 0;\n    size_t i;\n    int ret = -1;\n\n    memset(&data, 0, sizeof(data));\n\n    data.runlevel = runlevel;\n\n    for (nfifos = 0; virInitctlFifos[nfifos]; nfifos++)\n        ;\n\n    if (VIR_ALLOC_N(data.st, nfifos) < 0 ||\n        VIR_ALLOC_N(data.st_valid, nfifos) < 0)\n        goto cleanup;\n\n    for (i = 0; virInitctlFifos[i]; i++) {\n        const char *fifo = virInitctlFifos[i];\n\n        if (stat(fifo, &(data.st[i])) < 0) {\n            if (errno == ENOENT)\n                continue;\n\n            virReportSystemError(errno, _(\"Unable to stat %s\"), fifo);\n            goto cleanup;\n        }\n\n        data.st_valid[i] = true;\n    }\n\n    ret = virProcessRunInMountNamespace(priv->initpid,\n                                        lxcDomainInitctlCallback,\n                                        &data);\n cleanup:\n    VIR_FREE(data.st);\n    VIR_FREE(data.st_valid);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Init process ID is not yet known\")"
          ],
          "line": 2996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2992
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2989
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainRebootEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 2986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2981
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_REBOOT_INITCTL |\n                  VIR_DOMAIN_REBOOT_SIGNAL",
            "-1"
          ],
          "line": 2978
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainReboot(virDomainPtr dom,\n                unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDomainObjPrivatePtr priv;\n    virDomainObjPtr vm;\n    int ret = -1;\n    int rc = -1;\n\n    virCheckFlags(VIR_DOMAIN_REBOOT_INITCTL |\n                  VIR_DOMAIN_REBOOT_SIGNAL, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainRebootEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (priv->initpid == 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Init process ID is not yet known\"));\n        goto endjob;\n    }\n\n    if (flags == 0 ||\n        (flags & VIR_DOMAIN_REBOOT_INITCTL)) {\n        int command = VIR_INITCTL_RUNLEVEL_REBOOT;\n\n        if ((rc = virLXCDomainSetRunlevel(vm, command)) < 0) {\n            if (flags != 0 &&\n                (flags & VIR_DOMAIN_REBOOT_INITCTL)) {\n                virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                               _(\"Container does not provide an initctl pipe\"));\n                goto endjob;\n            }\n        }\n    }\n\n    if (rc < 0 &&\n        (flags == 0 ||\n         (flags & VIR_DOMAIN_REBOOT_SIGNAL))) {\n        if (kill(priv->initpid, SIGHUP) < 0 &&\n            errno != ESRCH) {\n            virReportSystemError(errno,\n                                 _(\"Unable to send SIGTERM to init pid %llu\"),\n                                 (long long)priv->initpid);\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2961-2965",
    "snippet": "static int\nlxcDomainShutdown(virDomainPtr dom)\n{\n    return lxcDomainShutdownFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainShutdownFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 2964
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainShutdownFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "2892-2959",
          "snippet": "static int\nlxcDomainShutdownFlags(virDomainPtr dom,\n                       unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDomainObjPrivatePtr priv;\n    virDomainObjPtr vm;\n    int ret = -1;\n    int rc = -1;\n\n    virCheckFlags(VIR_DOMAIN_SHUTDOWN_INITCTL |\n                  VIR_DOMAIN_SHUTDOWN_SIGNAL, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (priv->initpid == 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Init process ID is not yet known\"));\n        goto endjob;\n    }\n\n    if (flags == 0 ||\n        (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n        int command = VIR_INITCTL_RUNLEVEL_POWEROFF;\n\n        if ((rc = virLXCDomainSetRunlevel(vm, command)) < 0) {\n            if (flags != 0 &&\n                (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n                virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                               _(\"Container does not provide an initctl pipe\"));\n                goto endjob;\n            }\n        }\n    }\n\n    if (rc < 0 &&\n        (flags == 0 ||\n         (flags & VIR_DOMAIN_SHUTDOWN_SIGNAL))) {\n        if (kill(priv->initpid, SIGTERM) < 0 &&\n            errno != ESRCH) {\n            virReportSystemError(errno,\n                                 _(\"Unable to send SIGTERM to init pid %llu\"),\n                                 (long long)priv->initpid);\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainShutdownFlags(virDomainPtr dom,\n                       unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDomainObjPrivatePtr priv;\n    virDomainObjPtr vm;\n    int ret = -1;\n    int rc = -1;\n\n    virCheckFlags(VIR_DOMAIN_SHUTDOWN_INITCTL |\n                  VIR_DOMAIN_SHUTDOWN_SIGNAL, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (priv->initpid == 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Init process ID is not yet known\"));\n        goto endjob;\n    }\n\n    if (flags == 0 ||\n        (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n        int command = VIR_INITCTL_RUNLEVEL_POWEROFF;\n\n        if ((rc = virLXCDomainSetRunlevel(vm, command)) < 0) {\n            if (flags != 0 &&\n                (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n                virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                               _(\"Container does not provide an initctl pipe\"));\n                goto endjob;\n            }\n        }\n    }\n\n    if (rc < 0 &&\n        (flags == 0 ||\n         (flags & VIR_DOMAIN_SHUTDOWN_SIGNAL))) {\n        if (kill(priv->initpid, SIGTERM) < 0 &&\n            errno != ESRCH) {\n            virReportSystemError(errno,\n                                 _(\"Unable to send SIGTERM to init pid %llu\"),\n                                 (long long)priv->initpid);\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainShutdown(virDomainPtr dom)\n{\n    return lxcDomainShutdownFlags(dom, 0);\n}"
  },
  {
    "function_name": "lxcDomainShutdownFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2892-2959",
    "snippet": "static int\nlxcDomainShutdownFlags(virDomainPtr dom,\n                       unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDomainObjPrivatePtr priv;\n    virDomainObjPtr vm;\n    int ret = -1;\n    int rc = -1;\n\n    virCheckFlags(VIR_DOMAIN_SHUTDOWN_INITCTL |\n                  VIR_DOMAIN_SHUTDOWN_SIGNAL, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (priv->initpid == 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Init process ID is not yet known\"));\n        goto endjob;\n    }\n\n    if (flags == 0 ||\n        (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n        int command = VIR_INITCTL_RUNLEVEL_POWEROFF;\n\n        if ((rc = virLXCDomainSetRunlevel(vm, command)) < 0) {\n            if (flags != 0 &&\n                (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n                virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                               _(\"Container does not provide an initctl pipe\"));\n                goto endjob;\n            }\n        }\n    }\n\n    if (rc < 0 &&\n        (flags == 0 ||\n         (flags & VIR_DOMAIN_SHUTDOWN_SIGNAL))) {\n        if (kill(priv->initpid, SIGTERM) < 0 &&\n            errno != ESRCH) {\n            virReportSystemError(errno,\n                                 _(\"Unable to send SIGTERM to init pid %llu\"),\n                                 (long long)priv->initpid);\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2957
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2954
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to send SIGTERM to init pid %llu\")",
            "(long long)priv->initpid"
          ],
          "line": 2944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to send SIGTERM to init pid %llu\""
          ],
          "line": 2945
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "priv->initpid",
            "SIGTERM"
          ],
          "line": 2942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_UNSUPPORTED",
            "\"%s\"",
            "_(\"Container does not provide an initctl pipe\")"
          ],
          "line": 2932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDomainSetRunlevel",
          "args": [
            "vm",
            "command"
          ],
          "line": 2929
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainSetRunlevel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "459-501",
          "snippet": "int\nvirLXCDomainSetRunlevel(virDomainObjPtr vm,\n                        int runlevel)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    lxcDomainInitctlCallbackData data;\n    size_t nfifos = 0;\n    size_t i;\n    int ret = -1;\n\n    memset(&data, 0, sizeof(data));\n\n    data.runlevel = runlevel;\n\n    for (nfifos = 0; virInitctlFifos[nfifos]; nfifos++)\n        ;\n\n    if (VIR_ALLOC_N(data.st, nfifos) < 0 ||\n        VIR_ALLOC_N(data.st_valid, nfifos) < 0)\n        goto cleanup;\n\n    for (i = 0; virInitctlFifos[i]; i++) {\n        const char *fifo = virInitctlFifos[i];\n\n        if (stat(fifo, &(data.st[i])) < 0) {\n            if (errno == ENOENT)\n                continue;\n\n            virReportSystemError(errno, _(\"Unable to stat %s\"), fifo);\n            goto cleanup;\n        }\n\n        data.st_valid[i] = true;\n    }\n\n    ret = virProcessRunInMountNamespace(priv->initpid,\n                                        lxcDomainInitctlCallback,\n                                        &data);\n cleanup:\n    VIR_FREE(data.st);\n    VIR_FREE(data.st_valid);\n    return ret;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nint\nvirLXCDomainSetRunlevel(virDomainObjPtr vm,\n                        int runlevel)\n{\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    lxcDomainInitctlCallbackData data;\n    size_t nfifos = 0;\n    size_t i;\n    int ret = -1;\n\n    memset(&data, 0, sizeof(data));\n\n    data.runlevel = runlevel;\n\n    for (nfifos = 0; virInitctlFifos[nfifos]; nfifos++)\n        ;\n\n    if (VIR_ALLOC_N(data.st, nfifos) < 0 ||\n        VIR_ALLOC_N(data.st_valid, nfifos) < 0)\n        goto cleanup;\n\n    for (i = 0; virInitctlFifos[i]; i++) {\n        const char *fifo = virInitctlFifos[i];\n\n        if (stat(fifo, &(data.st[i])) < 0) {\n            if (errno == ENOENT)\n                continue;\n\n            virReportSystemError(errno, _(\"Unable to stat %s\"), fifo);\n            goto cleanup;\n        }\n\n        data.st_valid[i] = true;\n    }\n\n    ret = virProcessRunInMountNamespace(priv->initpid,\n                                        lxcDomainInitctlCallback,\n                                        &data);\n cleanup:\n    VIR_FREE(data.st);\n    VIR_FREE(data.st_valid);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Init process ID is not yet known\")"
          ],
          "line": 2920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2916
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2913
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainShutdownFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 2910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2905
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_SHUTDOWN_INITCTL |\n                  VIR_DOMAIN_SHUTDOWN_SIGNAL",
            "-1"
          ],
          "line": 2902
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainShutdownFlags(virDomainPtr dom,\n                       unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDomainObjPrivatePtr priv;\n    virDomainObjPtr vm;\n    int ret = -1;\n    int rc = -1;\n\n    virCheckFlags(VIR_DOMAIN_SHUTDOWN_INITCTL |\n                  VIR_DOMAIN_SHUTDOWN_SIGNAL, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainShutdownFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (priv->initpid == 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Init process ID is not yet known\"));\n        goto endjob;\n    }\n\n    if (flags == 0 ||\n        (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n        int command = VIR_INITCTL_RUNLEVEL_POWEROFF;\n\n        if ((rc = virLXCDomainSetRunlevel(vm, command)) < 0) {\n            if (flags != 0 &&\n                (flags & VIR_DOMAIN_SHUTDOWN_INITCTL)) {\n                virReportError(VIR_ERR_OPERATION_UNSUPPORTED, \"%s\",\n                               _(\"Container does not provide an initctl pipe\"));\n                goto endjob;\n            }\n        }\n    }\n\n    if (rc < 0 &&\n        (flags == 0 ||\n         (flags & VIR_DOMAIN_SHUTDOWN_SIGNAL))) {\n        if (kill(priv->initpid, SIGTERM) < 0 &&\n            errno != ESRCH) {\n            virReportSystemError(errno,\n                                 _(\"Unable to send SIGTERM to init pid %llu\"),\n                                 (long long)priv->initpid);\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcConnectListAllDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2875-2889",
    "snippet": "static int\nlxcConnectListAllDomains(virConnectPtr conn,\n                         virDomainPtr **domains,\n                  unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    if (virConnectListAllDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListExport(driver->domains, conn, domains,\n                                  virConnectListAllDomainsCheckACL, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListExport",
          "args": [
            "driver->domains",
            "conn",
            "domains",
            "virConnectListAllDomainsCheckACL",
            "flags"
          ],
          "line": 2887
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "1060-1101",
          "snippet": "int\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListExport(virDomainObjListPtr domlist,\n                       virConnectPtr conn,\n                       virDomainPtr **domains,\n                       virDomainObjListACLFilter filter,\n                       unsigned int flags)\n{\n    virDomainObjPtr *vms = NULL;\n    virDomainPtr *doms = NULL;\n    size_t nvms = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virDomainObjListCollect(domlist, conn, &vms, &nvms, filter, flags) < 0)\n        return -1;\n\n    if (domains) {\n        if (VIR_ALLOC_N(doms, nvms + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nvms; i++) {\n            virDomainObjPtr vm = vms[i];\n\n            virObjectLock(vm);\n            doms[i] = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n            virObjectUnlock(vm);\n\n            if (!doms[i])\n                goto cleanup;\n        }\n\n        *domains = doms;\n        doms = NULL;\n    }\n\n    ret = nvms;\n\n cleanup:\n    virObjectListFree(doms);\n    virObjectListFreeCount(vms, nvms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListAllDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 2884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL",
            "-1"
          ],
          "line": 2882
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcConnectListAllDomains(virConnectPtr conn,\n                         virDomainPtr **domains,\n                  unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    virCheckFlags(VIR_CONNECT_LIST_DOMAINS_FILTERS_ALL, -1);\n\n    if (virConnectListAllDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListExport(driver->domains, conn, domains,\n                                  virConnectListAllDomainsCheckACL, flags);\n}"
  },
  {
    "function_name": "lxcDomainSendProcessSignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2799-2872",
    "snippet": "static int\nlxcDomainSendProcessSignal(virDomainPtr dom,\n                           long long pid_value,\n                           unsigned int signum,\n                           unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virLXCDomainObjPrivatePtr priv;\n    pid_t victim;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (signum >= VIR_DOMAIN_PROCESS_SIGNAL_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"signum value %d is out of range\"),\n                       signum);\n        return -1;\n    }\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainSendProcessSignalEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    /*\n     * XXX if the kernel has /proc/$PID/ns/pid we can\n     * switch into container namespace & that way be\n     * able to kill any PID. Alternatively if there\n     * is a way to find a mapping of guest<->host PIDs\n     * we can kill that way.\n     */\n    if (pid_value != 1) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Only the init process may be killed\"));\n        goto endjob;\n    }\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Init pid is not yet available\"));\n        goto endjob;\n    }\n    victim = priv->initpid;\n\n    /* We're relying on fact libvirt header signal numbers\n     * are taken from Linux, to avoid mapping\n     */\n    if (kill(victim, signum) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to send %d signal to process %d\"),\n                             signum, victim);\n        goto endjob;\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2870
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2867
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to send %d signal to process %d\")",
            "signum",
            "victim"
          ],
          "line": 2858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to send %d signal to process %d\""
          ],
          "line": 2859
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "victim",
            "signum"
          ],
          "line": 2857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Init pid is not yet available\")"
          ],
          "line": 2848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Only the init process may be killed\")"
          ],
          "line": 2842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2831
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2828
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSendProcessSignalEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2820
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"signum value %d is out of range\")",
            "signum"
          ],
          "line": 2814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSendProcessSignal(virDomainPtr dom,\n                           long long pid_value,\n                           unsigned int signum,\n                           unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virLXCDomainObjPrivatePtr priv;\n    pid_t victim;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (signum >= VIR_DOMAIN_PROCESS_SIGNAL_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"signum value %d is out of range\"),\n                       signum);\n        return -1;\n    }\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainSendProcessSignalEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    /*\n     * XXX if the kernel has /proc/$PID/ns/pid we can\n     * switch into container namespace & that way be\n     * able to kill any PID. Alternatively if there\n     * is a way to find a mapping of guest<->host PIDs\n     * we can kill that way.\n     */\n    if (pid_value != 1) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Only the init process may be killed\"));\n        goto endjob;\n    }\n\n    if (!priv->initpid) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Init pid is not yet available\"));\n        goto endjob;\n    }\n    victim = priv->initpid;\n\n    /* We're relying on fact libvirt header signal numbers\n     * are taken from Linux, to avoid mapping\n     */\n    if (kill(victim, signum) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to send %d signal to process %d\"),\n                             signum, victim);\n        goto endjob;\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainOpenConsole",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2737-2796",
    "snippet": "static int\nlxcDomainOpenConsole(virDomainPtr dom,\n                      const char *dev_name,\n                      virStreamPtr st,\n                      unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n    virDomainChrDefPtr chr = NULL;\n    size_t i;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainOpenConsoleEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (dev_name) {\n        for (i = 0; i < vm->def->nconsoles; i++) {\n            if (vm->def->consoles[i]->info.alias &&\n                STREQ(vm->def->consoles[i]->info.alias, dev_name)) {\n                chr = vm->def->consoles[i];\n                break;\n            }\n        }\n    } else {\n        if (vm->def->nconsoles)\n            chr = vm->def->consoles[0];\n        else if (vm->def->nserials)\n            chr = vm->def->serials[0];\n    }\n\n    if (!chr) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot find console device '%s'\"),\n                       dev_name ? dev_name : _(\"default\"));\n        goto cleanup;\n    }\n\n    if (chr->source->type != VIR_DOMAIN_CHR_TYPE_PTY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"character device %s is not using a PTY\"),\n                       dev_name ? dev_name : NULLSTR(chr->info.alias));\n        goto cleanup;\n    }\n\n    if (virFDStreamOpenFile(st, chr->source->data.file.path,\n                            0, 0, O_RDWR) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2794
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFDStreamOpenFile",
          "args": [
            "st",
            "chr->source->data.file.path",
            "0",
            "0",
            "O_RDWR"
          ],
          "line": 2788
        },
        "resolved": true,
        "details": {
          "function_name": "virFDStreamOpenFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfdstream.c",
          "lines": "1446-1456",
          "snippet": "int\nvirFDStreamOpenFile(virStreamPtr st G_GNUC_UNUSED,\n                    const char *path G_GNUC_UNUSED,\n                    unsigned long long offset G_GNUC_UNUSED,\n                    unsigned long long length G_GNUC_UNUSED,\n                    int oflags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"File streams are not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virprocess.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"virfdstream.h\"",
            "# include <termios.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virprocess.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"virfdstream.h\"\n# include <termios.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirFDStreamOpenFile(virStreamPtr st G_GNUC_UNUSED,\n                    const char *path G_GNUC_UNUSED,\n                    unsigned long long offset G_GNUC_UNUSED,\n                    unsigned long long length G_GNUC_UNUSED,\n                    int oflags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"File streams are not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"character device %s is not using a PTY\")",
            "dev_name ? dev_name : NULLSTR(chr->info.alias)"
          ],
          "line": 2782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "chr->info.alias"
          ],
          "line": 2784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"character device %s is not using a PTY\""
          ],
          "line": 2783
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot find console device '%s'\")",
            "dev_name ? dev_name : _(\"default\")"
          ],
          "line": 2775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "vm->def->consoles[i]->info.alias",
            "dev_name"
          ],
          "line": 2762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2756
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainOpenConsoleEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2750
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 2748
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainOpenConsole(virDomainPtr dom,\n                      const char *dev_name,\n                      virStreamPtr st,\n                      unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n    virDomainChrDefPtr chr = NULL;\n    size_t i;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainOpenConsoleEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    if (dev_name) {\n        for (i = 0; i < vm->def->nconsoles; i++) {\n            if (vm->def->consoles[i]->info.alias &&\n                STREQ(vm->def->consoles[i]->info.alias, dev_name)) {\n                chr = vm->def->consoles[i];\n                break;\n            }\n        }\n    } else {\n        if (vm->def->nconsoles)\n            chr = vm->def->consoles[0];\n        else if (vm->def->nserials)\n            chr = vm->def->serials[0];\n    }\n\n    if (!chr) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot find console device '%s'\"),\n                       dev_name ? dev_name : _(\"default\"));\n        goto cleanup;\n    }\n\n    if (chr->source->type != VIR_DOMAIN_CHR_TYPE_PTY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"character device %s is not using a PTY\"),\n                       dev_name ? dev_name : NULLSTR(chr->info.alias));\n        goto cleanup;\n    }\n\n    if (virFDStreamOpenFile(st, chr->source->data.file.path,\n                            0, 0, O_RDWR) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainResume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2680-2735",
    "snippet": "static int lxcDomainResume(virDomainPtr dom)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    int state;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainResumeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    state = virDomainObjGetState(vm, NULL);\n    if (state == VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is already running\"));\n        goto endjob;\n    } else if (state == VIR_DOMAIN_PAUSED) {\n        if (virCgroupSetFreezerState(priv->cgroup, \"THAWED\") < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           \"%s\", _(\"Resume operation failed\"));\n            goto endjob;\n        }\n        virDomainObjSetState(vm, VIR_DOMAIN_RUNNING,\n                             VIR_DOMAIN_RUNNING_UNPAUSED);\n\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_RESUMED,\n                                         VIR_DOMAIN_EVENT_RESUMED_UNPAUSED);\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 2733
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2732
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 2731
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2728
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 2723
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_RESUMED",
            "VIR_DOMAIN_EVENT_RESUMED_UNPAUSED"
          ],
          "line": 2718
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_UNPAUSED"
          ],
          "line": 2715
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Resume operation failed\")"
          ],
          "line": 2711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Resume operation failed\""
          ],
          "line": 2712
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetFreezerState",
          "args": [
            "priv->cgroup",
            "\"THAWED\""
          ],
          "line": 2710
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetFreezerState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3458-3465",
          "snippet": "int\nvirCgroupSetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"domain is already running\")"
          ],
          "line": 2706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "NULL"
          ],
          "line": 2704
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2701
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2698
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainResumeEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2690
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 2688
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainResume(virDomainPtr dom)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    int state;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainResumeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    state = virDomainObjGetState(vm, NULL);\n    if (state == VIR_DOMAIN_RUNNING) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is already running\"));\n        goto endjob;\n    } else if (state == VIR_DOMAIN_PAUSED) {\n        if (virCgroupSetFreezerState(priv->cgroup, \"THAWED\") < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           \"%s\", _(\"Resume operation failed\"));\n            goto endjob;\n        }\n        virDomainObjSetState(vm, VIR_DOMAIN_RUNNING,\n                             VIR_DOMAIN_RUNNING_UNPAUSED);\n\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_RESUMED,\n                                         VIR_DOMAIN_EVENT_RESUMED_UNPAUSED);\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSuspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2633-2678",
    "snippet": "static int lxcDomainSuspend(virDomainPtr dom)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainSuspendEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (virDomainObjGetState(vm, NULL) != VIR_DOMAIN_PAUSED) {\n        if (lxcFreezeContainer(vm) < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           \"%s\", _(\"Suspend operation failed\"));\n            goto endjob;\n        }\n        virDomainObjSetState(vm, VIR_DOMAIN_PAUSED, VIR_DOMAIN_PAUSED_USER);\n\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_SUSPENDED,\n                                         VIR_DOMAIN_EVENT_SUSPENDED_PAUSED);\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 2676
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2675
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 2674
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2671
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 2666
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_SUSPENDED",
            "VIR_DOMAIN_EVENT_SUSPENDED_PAUSED"
          ],
          "line": 2661
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "vm",
            "VIR_DOMAIN_PAUSED",
            "VIR_DOMAIN_PAUSED_USER"
          ],
          "line": 2659
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Suspend operation failed\")"
          ],
          "line": 2655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Suspend operation failed\""
          ],
          "line": 2656
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcFreezeContainer",
          "args": [
            "vm"
          ],
          "line": 2654
        },
        "resolved": true,
        "details": {
          "function_name": "lxcFreezeContainer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "2547-2631",
          "snippet": "static int lxcFreezeContainer(virDomainObjPtr vm)\n{\n    int timeout = 1000; /* In milliseconds */\n    int check_interval = 1; /* In milliseconds */\n    int exp = 10;\n    int waited_time = 0;\n    int ret = -1;\n    char *state = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    while (waited_time < timeout) {\n        int r;\n        /*\n         * Writing \"FROZEN\" to the \"freezer.state\" freezes the group,\n         * i.e., the container, temporarily transiting \"FREEZING\" state.\n         * Once the freezing is completed, the state of the group transits\n         * to \"FROZEN\".\n         * (see linux-2.6/Documentation/cgroups/freezer-subsystem.txt)\n         */\n        r = virCgroupSetFreezerState(priv->cgroup, \"FROZEN\");\n\n        /*\n         * Returning EBUSY explicitly indicates that the group is\n         * being frozen but incomplete, and other errors are true\n         * errors.\n         */\n        if (r < 0 && r != -EBUSY) {\n            VIR_DEBUG(\"Writing freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        if (r == -EBUSY)\n            VIR_DEBUG(\"Writing freezer.state gets EBUSY\");\n\n        /*\n         * Unfortunately, returning 0 (success) is likely to happen\n         * even when the freezing has not been completed. Sometimes\n         * the state of the group remains \"FREEZING\" like when\n         * returning -EBUSY and even worse may never transit to\n         * \"FROZEN\" even if writing \"FROZEN\" again.\n         *\n         * So we don't trust the return value anyway and always\n         * decide that the freezing has been complete only with\n         * the state actually transit to \"FROZEN\".\n         */\n        g_usleep(check_interval * 1000);\n\n        r = virCgroupGetFreezerState(priv->cgroup, &state);\n\n        if (r < 0) {\n            VIR_DEBUG(\"Reading freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        VIR_DEBUG(\"Read freezer.state: %s\", state);\n\n        if (STREQ(state, \"FROZEN\")) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        waited_time += check_interval;\n        /*\n         * Increasing check_interval exponentially starting with\n         * small initial value treats nicely two cases; One is\n         * a container is under no load and waiting for long period\n         * makes no sense. The other is under heavy load. The container\n         * may stay longer time in FREEZING or never transit to FROZEN.\n         * In that case, eager polling will just waste CPU time.\n         */\n        check_interval *= exp;\n        VIR_FREE(state);\n    }\n    VIR_DEBUG(\"lxcFreezeContainer timeout\");\n error:\n    /*\n     * If timeout or an error on reading the state occurs,\n     * activate the group again and return an error.\n     * This is likely to fall the group back again gracefully.\n     */\n    virCgroupSetFreezerState(priv->cgroup, \"THAWED\");\n    ret = -1;\n\n cleanup:\n    VIR_FREE(state);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcFreezeContainer(virDomainObjPtr vm)\n{\n    int timeout = 1000; /* In milliseconds */\n    int check_interval = 1; /* In milliseconds */\n    int exp = 10;\n    int waited_time = 0;\n    int ret = -1;\n    char *state = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    while (waited_time < timeout) {\n        int r;\n        /*\n         * Writing \"FROZEN\" to the \"freezer.state\" freezes the group,\n         * i.e., the container, temporarily transiting \"FREEZING\" state.\n         * Once the freezing is completed, the state of the group transits\n         * to \"FROZEN\".\n         * (see linux-2.6/Documentation/cgroups/freezer-subsystem.txt)\n         */\n        r = virCgroupSetFreezerState(priv->cgroup, \"FROZEN\");\n\n        /*\n         * Returning EBUSY explicitly indicates that the group is\n         * being frozen but incomplete, and other errors are true\n         * errors.\n         */\n        if (r < 0 && r != -EBUSY) {\n            VIR_DEBUG(\"Writing freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        if (r == -EBUSY)\n            VIR_DEBUG(\"Writing freezer.state gets EBUSY\");\n\n        /*\n         * Unfortunately, returning 0 (success) is likely to happen\n         * even when the freezing has not been completed. Sometimes\n         * the state of the group remains \"FREEZING\" like when\n         * returning -EBUSY and even worse may never transit to\n         * \"FROZEN\" even if writing \"FROZEN\" again.\n         *\n         * So we don't trust the return value anyway and always\n         * decide that the freezing has been complete only with\n         * the state actually transit to \"FROZEN\".\n         */\n        g_usleep(check_interval * 1000);\n\n        r = virCgroupGetFreezerState(priv->cgroup, &state);\n\n        if (r < 0) {\n            VIR_DEBUG(\"Reading freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        VIR_DEBUG(\"Read freezer.state: %s\", state);\n\n        if (STREQ(state, \"FROZEN\")) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        waited_time += check_interval;\n        /*\n         * Increasing check_interval exponentially starting with\n         * small initial value treats nicely two cases; One is\n         * a container is under no load and waiting for long period\n         * makes no sense. The other is under heavy load. The container\n         * may stay longer time in FREEZING or never transit to FROZEN.\n         * In that case, eager polling will just waste CPU time.\n         */\n        check_interval *= exp;\n        VIR_FREE(state);\n    }\n    VIR_DEBUG(\"lxcFreezeContainer timeout\");\n error:\n    /*\n     * If timeout or an error on reading the state occurs,\n     * activate the group again and return an error.\n     * This is likely to fall the group back again gracefully.\n     */\n    virCgroupSetFreezerState(priv->cgroup, \"THAWED\");\n    ret = -1;\n\n cleanup:\n    VIR_FREE(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "NULL"
          ],
          "line": 2653
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2650
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2647
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSuspendEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2641
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 2639
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSuspend(virDomainPtr dom)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainSuspendEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (virDomainObjGetState(vm, NULL) != VIR_DOMAIN_PAUSED) {\n        if (lxcFreezeContainer(vm) < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           \"%s\", _(\"Suspend operation failed\"));\n            goto endjob;\n        }\n        virDomainObjSetState(vm, VIR_DOMAIN_PAUSED, VIR_DOMAIN_PAUSED_USER);\n\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_SUSPENDED,\n                                         VIR_DOMAIN_EVENT_SUSPENDED_PAUSED);\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcFreezeContainer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2547-2631",
    "snippet": "static int lxcFreezeContainer(virDomainObjPtr vm)\n{\n    int timeout = 1000; /* In milliseconds */\n    int check_interval = 1; /* In milliseconds */\n    int exp = 10;\n    int waited_time = 0;\n    int ret = -1;\n    char *state = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    while (waited_time < timeout) {\n        int r;\n        /*\n         * Writing \"FROZEN\" to the \"freezer.state\" freezes the group,\n         * i.e., the container, temporarily transiting \"FREEZING\" state.\n         * Once the freezing is completed, the state of the group transits\n         * to \"FROZEN\".\n         * (see linux-2.6/Documentation/cgroups/freezer-subsystem.txt)\n         */\n        r = virCgroupSetFreezerState(priv->cgroup, \"FROZEN\");\n\n        /*\n         * Returning EBUSY explicitly indicates that the group is\n         * being frozen but incomplete, and other errors are true\n         * errors.\n         */\n        if (r < 0 && r != -EBUSY) {\n            VIR_DEBUG(\"Writing freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        if (r == -EBUSY)\n            VIR_DEBUG(\"Writing freezer.state gets EBUSY\");\n\n        /*\n         * Unfortunately, returning 0 (success) is likely to happen\n         * even when the freezing has not been completed. Sometimes\n         * the state of the group remains \"FREEZING\" like when\n         * returning -EBUSY and even worse may never transit to\n         * \"FROZEN\" even if writing \"FROZEN\" again.\n         *\n         * So we don't trust the return value anyway and always\n         * decide that the freezing has been complete only with\n         * the state actually transit to \"FROZEN\".\n         */\n        g_usleep(check_interval * 1000);\n\n        r = virCgroupGetFreezerState(priv->cgroup, &state);\n\n        if (r < 0) {\n            VIR_DEBUG(\"Reading freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        VIR_DEBUG(\"Read freezer.state: %s\", state);\n\n        if (STREQ(state, \"FROZEN\")) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        waited_time += check_interval;\n        /*\n         * Increasing check_interval exponentially starting with\n         * small initial value treats nicely two cases; One is\n         * a container is under no load and waiting for long period\n         * makes no sense. The other is under heavy load. The container\n         * may stay longer time in FREEZING or never transit to FROZEN.\n         * In that case, eager polling will just waste CPU time.\n         */\n        check_interval *= exp;\n        VIR_FREE(state);\n    }\n    VIR_DEBUG(\"lxcFreezeContainer timeout\");\n error:\n    /*\n     * If timeout or an error on reading the state occurs,\n     * activate the group again and return an error.\n     * This is likely to fall the group back again gracefully.\n     */\n    virCgroupSetFreezerState(priv->cgroup, \"THAWED\");\n    ret = -1;\n\n cleanup:\n    VIR_FREE(state);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "state"
          ],
          "line": 2629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetFreezerState",
          "args": [
            "priv->cgroup",
            "\"THAWED\""
          ],
          "line": 2625
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetFreezerState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3458-3465",
          "snippet": "int\nvirCgroupSetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"lxcFreezeContainer timeout\""
          ],
          "line": 2618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "state"
          ],
          "line": 2616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "state",
            "\"FROZEN\""
          ],
          "line": 2601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Read freezer.state: %s\"",
            "state"
          ],
          "line": 2599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Reading freezer.state failed with errno: %d\"",
            "r"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetFreezerState",
          "args": [
            "priv->cgroup",
            "&state"
          ],
          "line": 2593
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetFreezerState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3468-3475",
          "snippet": "int\nvirCgroupGetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         char **state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         char **state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "check_interval * 1000"
          ],
          "line": 2591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Writing freezer.state gets EBUSY\""
          ],
          "line": 2578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Writing freezer.state failed with errno: %d\"",
            "r"
          ],
          "line": 2574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcFreezeContainer(virDomainObjPtr vm)\n{\n    int timeout = 1000; /* In milliseconds */\n    int check_interval = 1; /* In milliseconds */\n    int exp = 10;\n    int waited_time = 0;\n    int ret = -1;\n    char *state = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n    while (waited_time < timeout) {\n        int r;\n        /*\n         * Writing \"FROZEN\" to the \"freezer.state\" freezes the group,\n         * i.e., the container, temporarily transiting \"FREEZING\" state.\n         * Once the freezing is completed, the state of the group transits\n         * to \"FROZEN\".\n         * (see linux-2.6/Documentation/cgroups/freezer-subsystem.txt)\n         */\n        r = virCgroupSetFreezerState(priv->cgroup, \"FROZEN\");\n\n        /*\n         * Returning EBUSY explicitly indicates that the group is\n         * being frozen but incomplete, and other errors are true\n         * errors.\n         */\n        if (r < 0 && r != -EBUSY) {\n            VIR_DEBUG(\"Writing freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        if (r == -EBUSY)\n            VIR_DEBUG(\"Writing freezer.state gets EBUSY\");\n\n        /*\n         * Unfortunately, returning 0 (success) is likely to happen\n         * even when the freezing has not been completed. Sometimes\n         * the state of the group remains \"FREEZING\" like when\n         * returning -EBUSY and even worse may never transit to\n         * \"FROZEN\" even if writing \"FROZEN\" again.\n         *\n         * So we don't trust the return value anyway and always\n         * decide that the freezing has been complete only with\n         * the state actually transit to \"FROZEN\".\n         */\n        g_usleep(check_interval * 1000);\n\n        r = virCgroupGetFreezerState(priv->cgroup, &state);\n\n        if (r < 0) {\n            VIR_DEBUG(\"Reading freezer.state failed with errno: %d\", r);\n            goto error;\n        }\n        VIR_DEBUG(\"Read freezer.state: %s\", state);\n\n        if (STREQ(state, \"FROZEN\")) {\n            ret = 0;\n            goto cleanup;\n        }\n\n        waited_time += check_interval;\n        /*\n         * Increasing check_interval exponentially starting with\n         * small initial value treats nicely two cases; One is\n         * a container is under no load and waiting for long period\n         * makes no sense. The other is under heavy load. The container\n         * may stay longer time in FREEZING or never transit to FROZEN.\n         * In that case, eager polling will just waste CPU time.\n         */\n        check_interval *= exp;\n        VIR_FREE(state);\n    }\n    VIR_DEBUG(\"lxcFreezeContainer timeout\");\n error:\n    /*\n     * If timeout or an error on reading the state occurs,\n     * activate the group again and return an error.\n     * This is likely to fall the group back again gracefully.\n     */\n    virCgroupSetFreezerState(priv->cgroup, \"THAWED\");\n    ret = -1;\n\n cleanup:\n    VIR_FREE(state);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2470-2545",
    "snippet": "static int lxcDomainSetAutostart(virDomainPtr dom,\n                                   int autostart)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *configFile = NULL, *autostartLink = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainSetAutostartEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot set autostart for transient domain\"));\n        goto endjob;\n    }\n\n    autostart = (autostart != 0);\n\n    if (vm->autostart == autostart) {\n        ret = 0;\n        goto endjob;\n    }\n\n    configFile = virDomainConfigFile(cfg->configDir,\n                                     vm->def->name);\n    if (configFile == NULL)\n        goto endjob;\n    autostartLink = virDomainConfigFile(cfg->autostartDir,\n                                        vm->def->name);\n    if (autostartLink == NULL)\n        goto endjob;\n\n    if (autostart) {\n        if (virFileMakePath(cfg->autostartDir) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Cannot create autostart directory %s\"),\n                                 cfg->autostartDir);\n            goto endjob;\n        }\n\n        if (symlink(configFile, autostartLink) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Failed to create symlink '%s to '%s'\"),\n                                 autostartLink, configFile);\n            goto endjob;\n        }\n    } else {\n        if (unlink(autostartLink) < 0 && errno != ENOENT && errno != ENOTDIR) {\n            virReportSystemError(errno,\n                                 _(\"Failed to delete symlink '%s'\"),\n                                 autostartLink);\n            goto endjob;\n        }\n    }\n\n    vm->autostart = autostart;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 2543
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2542
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "autostartLink"
          ],
          "line": 2541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configFile"
          ],
          "line": 2540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2537
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to delete symlink '%s'\")",
            "autostartLink"
          ],
          "line": 2526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to delete symlink '%s'\""
          ],
          "line": 2527
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "autostartLink"
          ],
          "line": 2525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to create symlink '%s to '%s'\")",
            "autostartLink",
            "configFile"
          ],
          "line": 2519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "symlink",
          "args": [
            "configFile",
            "autostartLink"
          ],
          "line": 2518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot create autostart directory %s\")",
            "cfg->autostartDir"
          ],
          "line": 2512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "cfg->autostartDir"
          ],
          "line": 2511
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainConfigFile",
          "args": [
            "cfg->autostartDir",
            "vm->def->name"
          ],
          "line": 2505
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29755-29763",
          "snippet": "char\n*virDomainConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nchar\n*virDomainConfigFile(const char *dir,\n                     const char *name)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/%s.xml\", dir, name);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot set autostart for transient domain\")"
          ],
          "line": 2489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2485
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetAutostartEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2479
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 2477
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSetAutostart(virDomainPtr dom,\n                                   int autostart)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *configFile = NULL, *autostartLink = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainSetAutostartEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot set autostart for transient domain\"));\n        goto endjob;\n    }\n\n    autostart = (autostart != 0);\n\n    if (vm->autostart == autostart) {\n        ret = 0;\n        goto endjob;\n    }\n\n    configFile = virDomainConfigFile(cfg->configDir,\n                                     vm->def->name);\n    if (configFile == NULL)\n        goto endjob;\n    autostartLink = virDomainConfigFile(cfg->autostartDir,\n                                        vm->def->name);\n    if (autostartLink == NULL)\n        goto endjob;\n\n    if (autostart) {\n        if (virFileMakePath(cfg->autostartDir) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Cannot create autostart directory %s\"),\n                                 cfg->autostartDir);\n            goto endjob;\n        }\n\n        if (symlink(configFile, autostartLink) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Failed to create symlink '%s to '%s'\"),\n                                 autostartLink, configFile);\n            goto endjob;\n        }\n    } else {\n        if (unlink(autostartLink) < 0 && errno != ENOENT && errno != ENOTDIR) {\n            virReportSystemError(errno,\n                                 _(\"Failed to delete symlink '%s'\"),\n                                 autostartLink);\n            goto endjob;\n        }\n    }\n\n    vm->autostart = autostart;\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(autostartLink);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2450-2468",
    "snippet": "static int lxcDomainGetAutostart(virDomainPtr dom,\n                                   int *autostart)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetAutostartEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    *autostart = vm->autostart;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2466
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetAutostartEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2456
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainGetAutostart(virDomainPtr dom,\n                                   int *autostart)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetAutostartEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    *autostart = vm->autostart;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainInterfaceStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2410-2447",
    "snippet": "static int\nlxcDomainInterfaceStats(virDomainPtr dom,\n                        const char *device,\n                        virDomainInterfaceStatsPtr stats)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainNetDefPtr net = NULL;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainInterfaceStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!(net = virDomainNetFind(vm->def, device)))\n        goto endjob;\n\n    if (virNetDevTapInterfaceStats(net->ifname, stats,\n                                   !virDomainNetTypeSharesHostView(net)) < 0)\n        goto endjob;\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2445
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2442
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevTapInterfaceStats",
          "args": [
            "net->ifname",
            "stats",
            "!virDomainNetTypeSharesHostView(net)"
          ],
          "line": 2435
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevTapInterfaceStats",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevtap.c",
          "lines": "906-914",
          "snippet": "int\nvirNetDevTapInterfaceStats(const char *ifname G_GNUC_UNUSED,\n                           virDomainInterfaceStatsPtr stats G_GNUC_UNUSED,\n                           bool swapped G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                   _(\"interface stats not implemented on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <ifaddrs.h>",
            "# include <sys/sysctl.h>",
            "# include <net/if_mib.h>",
            "# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <ifaddrs.h>\n# include <sys/sysctl.h>\n# include <net/if_mib.h>\n# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevtap.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirNetDevTapInterfaceStats(const char *ifname G_GNUC_UNUSED,\n                           virDomainInterfaceStatsPtr stats G_GNUC_UNUSED,\n                           bool swapped G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                   _(\"interface stats not implemented on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetTypeSharesHostView",
          "args": [
            "net"
          ],
          "line": 2436
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetTypeSharesHostView",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "31122-31144",
          "snippet": "bool\nvirDomainNetTypeSharesHostView(const virDomainNetDef *net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetTypeSharesHostView(const virDomainNetDef *net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        return true;\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        break;\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetFind",
          "args": [
            "vm->def",
            "device"
          ],
          "line": 2432
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30458-30470",
          "snippet": "virDomainNetDefPtr\nvirDomainNetFindByName(virDomainDefPtr def,\n                       const char *ifname)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (STREQ_NULLABLE(ifname, def->nets[i]->ifname))\n            return def->nets[i];\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetDefPtr\nvirDomainNetFindByName(virDomainDefPtr def,\n                       const char *ifname)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (STREQ_NULLABLE(ifname, def->nets[i]->ifname))\n            return def->nets[i];\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2429
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_QUERY"
          ],
          "line": 2426
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainInterfaceStatsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2420
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainInterfaceStats(virDomainPtr dom,\n                        const char *device,\n                        virDomainInterfaceStatsPtr stats)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainNetDefPtr net = NULL;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainInterfaceStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!(net = virDomainNetFind(vm->def, device)))\n        goto endjob;\n\n    if (virNetDevTapInterfaceStats(net->ifname, stats,\n                                   !virDomainNetTypeSharesHostView(net)) < 0)\n        goto endjob;\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetBlkioParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2325-2407",
    "snippet": "static int\nlxcDomainGetBlkioParameters(virDomainPtr dom,\n                            virTypedParameterPtr params,\n                            int *nparams,\n                            unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int maxparams = LXC_NB_BLKIO_PARAM;\n    unsigned int val;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We blindly return a string, and let libvirt.c and\n     * remote_driver.c do the filtering on behalf of older clients\n     * that can't parse it.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return -1;\n\n    priv = vm->privateData;\n\n    if (virDomainGetBlkioParametersEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((*nparams) == 0) {\n        /* Current number of blkio parameters supported by cgroups */\n        *nparams = LXC_NB_BLKIO_PARAM;\n        ret = 0;\n        goto cleanup;\n    } else if (*nparams < maxparams) {\n        maxparams = *nparams;\n    }\n\n    *nparams = 0;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"blkio cgroup isn't mounted\"));\n            goto cleanup;\n        }\n\n        /* fill blkio weight here */\n        if (virCgroupGetBlkioWeight(priv->cgroup, &val) < 0)\n            goto cleanup;\n        if (virTypedParameterAssign(&(params[(*nparams)++]),\n                                    VIR_DOMAIN_BLKIO_WEIGHT,\n                                    VIR_TYPED_PARAM_UINT, val) < 0)\n            goto cleanup;\n\n        if (virDomainGetBlkioParametersAssignFromDef(def, params, nparams,\n                                                     maxparams) < 0)\n            goto cleanup;\n\n    } else if (persistentDef) {\n        /* fill blkio weight here */\n        if (virTypedParameterAssign(&(params[(*nparams)++]),\n                                    VIR_DOMAIN_BLKIO_WEIGHT,\n                                    VIR_TYPED_PARAM_UINT,\n                                    persistentDef->blkio.weight) < 0)\n            goto cleanup;\n\n        if (virDomainGetBlkioParametersAssignFromDef(persistentDef, params,\n                                                     nparams, maxparams) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define LXC_NB_BLKIO_PARAM  6"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2405
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetBlkioParametersAssignFromDef",
          "args": [
            "persistentDef",
            "params",
            "nparams",
            "maxparams"
          ],
          "line": 2397
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainGetBlkioParametersAssignFromDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30956-31001",
          "snippet": "int\nvirDomainGetBlkioParametersAssignFromDef(virDomainDefPtr def,\n                                         virTypedParameterPtr params,\n                                         int *nparams,\n                                         int maxparams)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n    char *data = NULL;\n    size_t i;\n\n#define VIR_BLKIO_ASSIGN(param, format, name) \\\n    if (*nparams < maxparams) { \\\n        for (i = 0; i < def->blkio.ndevices; i++) { \\\n            if (!def->blkio.devices[i].param) \\\n                continue; \\\n            virBufferAsprintf(&buf, \"%s,\" format \",\", \\\n                              def->blkio.devices[i].path, \\\n                              def->blkio.devices[i].param); \\\n        } \\\n        virBufferTrim(&buf, \",\"); \\\n        data = virBufferContentAndReset(&buf); \\\n        if (virTypedParameterAssign(&(params[(*nparams)++]), name, \\\n                                    VIR_TYPED_PARAM_STRING, data) < 0) \\\n            goto error; \\\n        data = NULL; \\\n    }\n\n    /* blkiotune.device_weight */\n    VIR_BLKIO_ASSIGN(weight, \"%u\", VIR_DOMAIN_BLKIO_DEVICE_WEIGHT);\n    /* blkiotune.device_read_iops */\n    VIR_BLKIO_ASSIGN(riops, \"%u\", VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS);\n    /* blkiotune.device_write_iops */\n    VIR_BLKIO_ASSIGN(wiops, \"%u\", VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS);\n    /* blkiotune.device_read_bps */\n    VIR_BLKIO_ASSIGN(rbps, \"%llu\", VIR_DOMAIN_BLKIO_DEVICE_READ_BPS);\n    /* blkiotune.device_write_bps */\n    VIR_BLKIO_ASSIGN(wbps, \"%llu\", VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS);\n\n#undef VIR_BLKIO_ASSIGN\n\n    return 0;\n\n error:\n    VIR_FREE(data);\n    return -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainGetBlkioParametersAssignFromDef(virDomainDefPtr def,\n                                         virTypedParameterPtr params,\n                                         int *nparams,\n                                         int maxparams)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n    char *data = NULL;\n    size_t i;\n\n#define VIR_BLKIO_ASSIGN(param, format, name) \\\n    if (*nparams < maxparams) { \\\n        for (i = 0; i < def->blkio.ndevices; i++) { \\\n            if (!def->blkio.devices[i].param) \\\n                continue; \\\n            virBufferAsprintf(&buf, \"%s,\" format \",\", \\\n                              def->blkio.devices[i].path, \\\n                              def->blkio.devices[i].param); \\\n        } \\\n        virBufferTrim(&buf, \",\"); \\\n        data = virBufferContentAndReset(&buf); \\\n        if (virTypedParameterAssign(&(params[(*nparams)++]), name, \\\n                                    VIR_TYPED_PARAM_STRING, data) < 0) \\\n            goto error; \\\n        data = NULL; \\\n    }\n\n    /* blkiotune.device_weight */\n    VIR_BLKIO_ASSIGN(weight, \"%u\", VIR_DOMAIN_BLKIO_DEVICE_WEIGHT);\n    /* blkiotune.device_read_iops */\n    VIR_BLKIO_ASSIGN(riops, \"%u\", VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS);\n    /* blkiotune.device_write_iops */\n    VIR_BLKIO_ASSIGN(wiops, \"%u\", VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS);\n    /* blkiotune.device_read_bps */\n    VIR_BLKIO_ASSIGN(rbps, \"%llu\", VIR_DOMAIN_BLKIO_DEVICE_READ_BPS);\n    /* blkiotune.device_write_bps */\n    VIR_BLKIO_ASSIGN(wbps, \"%llu\", VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS);\n\n#undef VIR_BLKIO_ASSIGN\n\n    return 0;\n\n error:\n    VIR_FREE(data);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "&(params[(*nparams)++])",
            "VIR_DOMAIN_BLKIO_WEIGHT",
            "VIR_TYPED_PARAM_UINT",
            "persistentDef->blkio.weight"
          ],
          "line": 2391
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlkioWeight",
          "args": [
            "priv->cgroup",
            "&val"
          ],
          "line": 2378
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2986-2993",
          "snippet": "int\nvirCgroupGetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio cgroup isn't mounted\")"
          ],
          "line": 2372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"blkio cgroup isn't mounted\""
          ],
          "line": 2373
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_BLKIO"
          ],
          "line": 2371
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 2367
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetBlkioParametersEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2348
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY",
            "-1"
          ],
          "line": 2339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define LXC_NB_BLKIO_PARAM  6\n\nstatic int\nlxcDomainGetBlkioParameters(virDomainPtr dom,\n                            virTypedParameterPtr params,\n                            int *nparams,\n                            unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int maxparams = LXC_NB_BLKIO_PARAM;\n    unsigned int val;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We blindly return a string, and let libvirt.c and\n     * remote_driver.c do the filtering on behalf of older clients\n     * that can't parse it.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return -1;\n\n    priv = vm->privateData;\n\n    if (virDomainGetBlkioParametersEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((*nparams) == 0) {\n        /* Current number of blkio parameters supported by cgroups */\n        *nparams = LXC_NB_BLKIO_PARAM;\n        ret = 0;\n        goto cleanup;\n    } else if (*nparams < maxparams) {\n        maxparams = *nparams;\n    }\n\n    *nparams = 0;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"blkio cgroup isn't mounted\"));\n            goto cleanup;\n        }\n\n        /* fill blkio weight here */\n        if (virCgroupGetBlkioWeight(priv->cgroup, &val) < 0)\n            goto cleanup;\n        if (virTypedParameterAssign(&(params[(*nparams)++]),\n                                    VIR_DOMAIN_BLKIO_WEIGHT,\n                                    VIR_TYPED_PARAM_UINT, val) < 0)\n            goto cleanup;\n\n        if (virDomainGetBlkioParametersAssignFromDef(def, params, nparams,\n                                                     maxparams) < 0)\n            goto cleanup;\n\n    } else if (persistentDef) {\n        /* fill blkio weight here */\n        if (virTypedParameterAssign(&(params[(*nparams)++]),\n                                    VIR_DOMAIN_BLKIO_WEIGHT,\n                                    VIR_TYPED_PARAM_UINT,\n                                    persistentDef->blkio.weight) < 0)\n            goto cleanup;\n\n        if (virDomainGetBlkioParametersAssignFromDef(persistentDef, params,\n                                                     nparams, maxparams) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSetBlkioParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2242-2320",
    "snippet": "static int\nlxcDomainSetBlkioParameters(virDomainPtr dom,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = NULL;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_BLKIO_WEIGHT,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_DOMAIN_BLKIO_DEVICE_WEIGHT,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_READ_BPS,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS,\n                               VIR_TYPED_PARAM_STRING,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return -1;\n\n    priv = vm->privateData;\n    cfg = virLXCDriverGetConfig(driver);\n\n    if (virDomainSetBlkioParametersEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"blkio cgroup isn't mounted\"));\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n    if (def) {\n        ret = virDomainCgroupSetupDomainBlkioParameters(priv->cgroup, def,\n                                                        params, nparams);\n    }\n    if (ret < 0)\n        goto endjob;\n    if (persistentDef) {\n        ret = virDomainDriverSetupPersistentDefBlkioParams(persistentDef,\n                                                           params,\n                                                           nparams);\n\n        if (virDomainDefSave(persistentDef, driver->xmlopt, cfg->configDir) < 0)\n            ret = -1;\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 2318
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2317
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2314
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "persistentDef",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 2309
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDriverSetupPersistentDefBlkioParams",
          "args": [
            "persistentDef",
            "params",
            "nparams"
          ],
          "line": 2305
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDriverSetupPersistentDefBlkioParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
          "lines": "211-252",
          "snippet": "int\nvirDomainDriverSetupPersistentDefBlkioParams(virDomainDefPtr persistentDef,\n                                             virTypedParameterPtr params,\n                                             int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            persistentDef->blkio.weight = param->value.ui;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            virBlkioDevicePtr devices = NULL;\n            size_t ndevices;\n\n            if (virDomainDriverParseBlkioDeviceStr(param->value.s,\n                                             param->field,\n                                             &devices,\n                                             &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (virDomainDriverMergeBlkioDevice(&persistentDef->blkio.devices,\n                                                &persistentDef->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverSetupPersistentDefBlkioParams(virDomainDefPtr persistentDef,\n                                             virTypedParameterPtr params,\n                                             int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            persistentDef->blkio.weight = param->value.ui;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            virBlkioDevicePtr devices = NULL;\n            size_t ndevices;\n\n            if (virDomainDriverParseBlkioDeviceStr(param->value.s,\n                                             param->field,\n                                             &devices,\n                                             &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (virDomainDriverMergeBlkioDevice(&persistentDef->blkio.devices,\n                                                &persistentDef->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCgroupSetupDomainBlkioParameters",
          "args": [
            "priv->cgroup",
            "def",
            "params",
            "nparams"
          ],
          "line": 2299
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCgroupSetupDomainBlkioParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
          "lines": "94-189",
          "snippet": "int\nvirDomainCgroupSetupDomainBlkioParameters(virCgroupPtr cgroup,\n                                          virDomainDefPtr def,\n                                          virTypedParameterPtr params,\n                                          int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            if (virCgroupSetBlkioWeight(cgroup, params[i].value.ui) < 0)\n                ret = -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            size_t ndevices;\n            virBlkioDevicePtr devices = NULL;\n            size_t j;\n\n            if (virDomainDriverParseBlkioDeviceStr(params[i].value.s,\n                                                   param->field,\n                                                   &devices,\n                                                   &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWeight(cgroup, devices[j].path,\n                                                        &devices[j].weight) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadIops(cgroup, devices[j].path,\n                                                          &devices[j].riops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteIops(cgroup, devices[j].path,\n                                                           &devices[j].wiops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadBps(cgroup, devices[j].path,\n                                                         &devices[j].rbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteBps(cgroup, devices[j].path,\n                                                          &devices[j].wbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else {\n                virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown blkio parameter %s\"),\n                               param->field);\n                ret = -1;\n                virBlkioDeviceArrayClear(devices, ndevices);\n                g_free(devices);\n\n                continue;\n            }\n\n            if (j != ndevices ||\n                virDomainDriverMergeBlkioDevice(&def->blkio.devices,\n                                                &def->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupDomainBlkioParameters(virCgroupPtr cgroup,\n                                          virDomainDefPtr def,\n                                          virTypedParameterPtr params,\n                                          int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            if (virCgroupSetBlkioWeight(cgroup, params[i].value.ui) < 0)\n                ret = -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            size_t ndevices;\n            virBlkioDevicePtr devices = NULL;\n            size_t j;\n\n            if (virDomainDriverParseBlkioDeviceStr(params[i].value.s,\n                                                   param->field,\n                                                   &devices,\n                                                   &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWeight(cgroup, devices[j].path,\n                                                        &devices[j].weight) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadIops(cgroup, devices[j].path,\n                                                          &devices[j].riops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteIops(cgroup, devices[j].path,\n                                                           &devices[j].wiops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadBps(cgroup, devices[j].path,\n                                                         &devices[j].rbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteBps(cgroup, devices[j].path,\n                                                          &devices[j].wbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else {\n                virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown blkio parameter %s\"),\n                               param->field);\n                ret = -1;\n                virBlkioDeviceArrayClear(devices, ndevices);\n                g_free(devices);\n\n                continue;\n            }\n\n            if (j != ndevices ||\n                virDomainDriverMergeBlkioDevice(&def->blkio.devices,\n                                                &def->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio cgroup isn't mounted\")"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"blkio cgroup isn't mounted\""
          ],
          "line": 2292
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_BLKIO"
          ],
          "line": 2290
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 2286
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 2283
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetBlkioParametersEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 2278
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2274
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_DOMAIN_BLKIO_WEIGHT",
            "VIR_TYPED_PARAM_UINT",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT",
            "VIR_TYPED_PARAM_STRING",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS",
            "VIR_TYPED_PARAM_STRING",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS",
            "VIR_TYPED_PARAM_STRING",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS",
            "VIR_TYPED_PARAM_STRING",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS",
            "VIR_TYPED_PARAM_STRING",
            "NULL"
          ],
          "line": 2258
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 2256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSetBlkioParameters(virDomainPtr dom,\n                            virTypedParameterPtr params,\n                            int nparams,\n                            unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = NULL;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_BLKIO_WEIGHT,\n                               VIR_TYPED_PARAM_UINT,\n                               VIR_DOMAIN_BLKIO_DEVICE_WEIGHT,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_READ_BPS,\n                               VIR_TYPED_PARAM_STRING,\n                               VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS,\n                               VIR_TYPED_PARAM_STRING,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return -1;\n\n    priv = vm->privateData;\n    cfg = virLXCDriverGetConfig(driver);\n\n    if (virDomainSetBlkioParametersEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"blkio cgroup isn't mounted\"));\n            goto endjob;\n        }\n    }\n\n    ret = 0;\n    if (def) {\n        ret = virDomainCgroupSetupDomainBlkioParameters(priv->cgroup, def,\n                                                        params, nparams);\n    }\n    if (ret < 0)\n        goto endjob;\n    if (persistentDef) {\n        ret = virDomainDriverSetupPersistentDefBlkioParams(persistentDef,\n                                                           params,\n                                                           nparams);\n\n        if (virDomainDefSave(persistentDef, driver->xmlopt, cfg->configDir) < 0)\n            ret = -1;\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainBlockStatsFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2114-2239",
    "snippet": "static int\nlxcDomainBlockStatsFlags(virDomainPtr dom,\n                         const char * path,\n                         virTypedParameterPtr params,\n                         int * nparams,\n                         unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    int tmp, ret = -1;\n    virDomainObjPtr vm;\n    virDomainDiskDefPtr disk = NULL;\n    virLXCDomainObjPrivatePtr priv;\n    long long rd_req, rd_bytes, wr_req, wr_bytes;\n    virTypedParameterPtr param;\n\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!*nparams) {\n        *nparams = LXC_NB_DOMAIN_BLOCK_STAT_PARAM;\n        return 0;\n    }\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    priv = vm->privateData;\n\n    if (virDomainBlockStatsFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio cgroup isn't mounted\"));\n        goto endjob;\n    }\n\n    if (!*path) {\n        /* empty path - return entire domain blkstats instead */\n        if (virCgroupGetBlkioIoServiced(priv->cgroup,\n                                        &rd_bytes,\n                                        &wr_bytes,\n                                        &rd_req,\n                                        &wr_req) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"domain stats query failed\"));\n            goto endjob;\n        }\n    } else {\n        if (!(disk = virDomainDiskByName(vm->def, path, false))) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"invalid path: %s\"), path);\n            goto endjob;\n        }\n\n        if (!disk->info.alias) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"missing disk device alias name for %s\"), disk->dst);\n            goto endjob;\n        }\n\n        if (virCgroupGetBlkioIoDeviceServiced(priv->cgroup,\n                                              disk->info.alias,\n                                              &rd_bytes,\n                                              &wr_bytes,\n                                              &rd_req,\n                                              &wr_req) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"domain stats query failed\"));\n            goto endjob;\n        }\n    }\n\n    tmp = 0;\n    ret = -1;\n\n    if (tmp < *nparams && wr_bytes != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_WRITE_BYTES,\n                                    VIR_TYPED_PARAM_LLONG, wr_bytes) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    if (tmp < *nparams && wr_req != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_WRITE_REQ,\n                                    VIR_TYPED_PARAM_LLONG, wr_req) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    if (tmp < *nparams && rd_bytes != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_READ_BYTES,\n                                    VIR_TYPED_PARAM_LLONG, rd_bytes) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    if (tmp < *nparams && rd_req != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_READ_REQ,\n                                    VIR_TYPED_PARAM_LLONG, rd_req) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    ret = 0;\n    *nparams = tmp;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define LXC_NB_DOMAIN_BLOCK_STAT_PARAM 4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2237
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2234
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "param",
            "VIR_DOMAIN_BLOCK_STATS_READ_REQ",
            "VIR_TYPED_PARAM_LLONG",
            "rd_req"
          ],
          "line": 2224
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domain stats query failed\")"
          ],
          "line": 2189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain stats query failed\""
          ],
          "line": 2190
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlkioIoDeviceServiced",
          "args": [
            "priv->cgroup",
            "disk->info.alias",
            "&rd_bytes",
            "&wr_bytes",
            "&rd_req",
            "&wr_req"
          ],
          "line": 2183
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioIoDeviceServiced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2962-2973",
          "snippet": "int\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group G_GNUC_UNUSED,\n                                  const char *path G_GNUC_UNUSED,\n                                  long long *bytes_read G_GNUC_UNUSED,\n                                  long long *bytes_write G_GNUC_UNUSED,\n                                  long long *requests_read G_GNUC_UNUSED,\n                                  long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group G_GNUC_UNUSED,\n                                  const char *path G_GNUC_UNUSED,\n                                  long long *bytes_read G_GNUC_UNUSED,\n                                  long long *bytes_write G_GNUC_UNUSED,\n                                  long long *requests_read G_GNUC_UNUSED,\n                                  long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"missing disk device alias name for %s\")",
            "disk->dst"
          ],
          "line": 2178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid path: %s\")",
            "path"
          ],
          "line": 2172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskByName",
          "args": [
            "vm->def",
            "path",
            "false"
          ],
          "line": 2171
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17327-17334",
          "snippet": "virDomainDiskDefPtr\nvirDomainDiskByName(virDomainDefPtr def,\n                    const char *name,\n                    bool allow_ambiguous)\n{\n    int idx = virDomainDiskIndexByName(def, name, allow_ambiguous);\n    return idx < 0 ? NULL : def->disks[idx];\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDiskDefPtr\nvirDomainDiskByName(virDomainDefPtr def,\n                    const char *name,\n                    bool allow_ambiguous)\n{\n    int idx = virDomainDiskIndexByName(def, name, allow_ambiguous);\n    return idx < 0 ? NULL : def->disks[idx];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domain stats query failed\")"
          ],
          "line": 2166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlkioIoServiced",
          "args": [
            "priv->cgroup",
            "&rd_bytes",
            "&wr_bytes",
            "&rd_req",
            "&wr_req"
          ],
          "line": 2161
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioIoServiced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2949-2959",
          "snippet": "int\nvirCgroupGetBlkioIoServiced(virCgroupPtr group G_GNUC_UNUSED,\n                            long long *bytes_read G_GNUC_UNUSED,\n                            long long *bytes_write G_GNUC_UNUSED,\n                            long long *requests_read G_GNUC_UNUSED,\n                            long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoServiced(virCgroupPtr group G_GNUC_UNUSED,\n                            long long *bytes_read G_GNUC_UNUSED,\n                            long long *bytes_write G_GNUC_UNUSED,\n                            long long *requests_read G_GNUC_UNUSED,\n                            long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio cgroup isn't mounted\")"
          ],
          "line": 2154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_BLKIO"
          ],
          "line": 2153
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2150
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_QUERY"
          ],
          "line": 2147
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainBlockStatsFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2139
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_TYPED_PARAM_STRING_OKAY",
            "-1"
          ],
          "line": 2129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define LXC_NB_DOMAIN_BLOCK_STAT_PARAM 4\n\nstatic int\nlxcDomainBlockStatsFlags(virDomainPtr dom,\n                         const char * path,\n                         virTypedParameterPtr params,\n                         int * nparams,\n                         unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    int tmp, ret = -1;\n    virDomainObjPtr vm;\n    virDomainDiskDefPtr disk = NULL;\n    virLXCDomainObjPrivatePtr priv;\n    long long rd_req, rd_bytes, wr_req, wr_bytes;\n    virTypedParameterPtr param;\n\n    virCheckFlags(VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!*nparams) {\n        *nparams = LXC_NB_DOMAIN_BLOCK_STAT_PARAM;\n        return 0;\n    }\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    priv = vm->privateData;\n\n    if (virDomainBlockStatsFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio cgroup isn't mounted\"));\n        goto endjob;\n    }\n\n    if (!*path) {\n        /* empty path - return entire domain blkstats instead */\n        if (virCgroupGetBlkioIoServiced(priv->cgroup,\n                                        &rd_bytes,\n                                        &wr_bytes,\n                                        &rd_req,\n                                        &wr_req) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"domain stats query failed\"));\n            goto endjob;\n        }\n    } else {\n        if (!(disk = virDomainDiskByName(vm->def, path, false))) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"invalid path: %s\"), path);\n            goto endjob;\n        }\n\n        if (!disk->info.alias) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"missing disk device alias name for %s\"), disk->dst);\n            goto endjob;\n        }\n\n        if (virCgroupGetBlkioIoDeviceServiced(priv->cgroup,\n                                              disk->info.alias,\n                                              &rd_bytes,\n                                              &wr_bytes,\n                                              &rd_req,\n                                              &wr_req) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           \"%s\", _(\"domain stats query failed\"));\n            goto endjob;\n        }\n    }\n\n    tmp = 0;\n    ret = -1;\n\n    if (tmp < *nparams && wr_bytes != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_WRITE_BYTES,\n                                    VIR_TYPED_PARAM_LLONG, wr_bytes) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    if (tmp < *nparams && wr_req != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_WRITE_REQ,\n                                    VIR_TYPED_PARAM_LLONG, wr_req) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    if (tmp < *nparams && rd_bytes != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_READ_BYTES,\n                                    VIR_TYPED_PARAM_LLONG, rd_bytes) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    if (tmp < *nparams && rd_req != -1) {\n        param = &params[tmp];\n        if (virTypedParameterAssign(param, VIR_DOMAIN_BLOCK_STATS_READ_REQ,\n                                    VIR_TYPED_PARAM_LLONG, rd_req) < 0)\n            goto endjob;\n        tmp++;\n    }\n\n    ret = 0;\n    *nparams = tmp;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainBlockStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2045-2111",
    "snippet": "static int\nlxcDomainBlockStats(virDomainPtr dom,\n                    const char *path,\n                    virDomainBlockStatsPtr stats)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    int ret = -1;\n    virDomainObjPtr vm;\n    virDomainDiskDefPtr disk = NULL;\n    virLXCDomainObjPrivatePtr priv;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    priv = vm->privateData;\n\n    if (virDomainBlockStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n   if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio cgroup isn't mounted\"));\n        goto endjob;\n    }\n\n    if (!*path) {\n        /* empty path - return entire domain blkstats instead */\n        ret = virCgroupGetBlkioIoServiced(priv->cgroup,\n                                          &stats->rd_bytes,\n                                          &stats->wr_bytes,\n                                          &stats->rd_req,\n                                          &stats->wr_req);\n        goto endjob;\n    }\n\n    if (!(disk = virDomainDiskByName(vm->def, path, false))) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid path: %s\"), path);\n        goto endjob;\n    }\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"missing disk device alias name for %s\"), disk->dst);\n        goto endjob;\n    }\n\n    ret = virCgroupGetBlkioIoDeviceServiced(priv->cgroup,\n                                            disk->info.alias,\n                                            &stats->rd_bytes,\n                                            &stats->wr_bytes,\n                                            &stats->rd_req,\n                                            &stats->wr_req);\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2109
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlkioIoDeviceServiced",
          "args": [
            "priv->cgroup",
            "disk->info.alias",
            "&stats->rd_bytes",
            "&stats->wr_bytes",
            "&stats->rd_req",
            "&stats->wr_req"
          ],
          "line": 2098
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioIoDeviceServiced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2962-2973",
          "snippet": "int\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group G_GNUC_UNUSED,\n                                  const char *path G_GNUC_UNUSED,\n                                  long long *bytes_read G_GNUC_UNUSED,\n                                  long long *bytes_write G_GNUC_UNUSED,\n                                  long long *requests_read G_GNUC_UNUSED,\n                                  long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group G_GNUC_UNUSED,\n                                  const char *path G_GNUC_UNUSED,\n                                  long long *bytes_read G_GNUC_UNUSED,\n                                  long long *bytes_write G_GNUC_UNUSED,\n                                  long long *requests_read G_GNUC_UNUSED,\n                                  long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"missing disk device alias name for %s\")",
            "disk->dst"
          ],
          "line": 2093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"missing disk device alias name for %s\""
          ],
          "line": 2094
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid path: %s\")",
            "path"
          ],
          "line": 2087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskByName",
          "args": [
            "vm->def",
            "path",
            "false"
          ],
          "line": 2086
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17327-17334",
          "snippet": "virDomainDiskDefPtr\nvirDomainDiskByName(virDomainDefPtr def,\n                    const char *name,\n                    bool allow_ambiguous)\n{\n    int idx = virDomainDiskIndexByName(def, name, allow_ambiguous);\n    return idx < 0 ? NULL : def->disks[idx];\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDiskDefPtr\nvirDomainDiskByName(virDomainDefPtr def,\n                    const char *name,\n                    bool allow_ambiguous)\n{\n    int idx = virDomainDiskIndexByName(def, name, allow_ambiguous);\n    return idx < 0 ? NULL : def->disks[idx];\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlkioIoServiced",
          "args": [
            "priv->cgroup",
            "&stats->rd_bytes",
            "&stats->wr_bytes",
            "&stats->rd_req",
            "&stats->wr_req"
          ],
          "line": 2078
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioIoServiced",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2949-2959",
          "snippet": "int\nvirCgroupGetBlkioIoServiced(virCgroupPtr group G_GNUC_UNUSED,\n                            long long *bytes_read G_GNUC_UNUSED,\n                            long long *bytes_write G_GNUC_UNUSED,\n                            long long *requests_read G_GNUC_UNUSED,\n                            long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoServiced(virCgroupPtr group G_GNUC_UNUSED,\n                            long long *bytes_read G_GNUC_UNUSED,\n                            long long *bytes_write G_GNUC_UNUSED,\n                            long long *requests_read G_GNUC_UNUSED,\n                            long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio cgroup isn't mounted\")"
          ],
          "line": 2071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_BLKIO"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_QUERY"
          ],
          "line": 2064
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainBlockStatsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 2061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainBlockStats(virDomainPtr dom,\n                    const char *path,\n                    virDomainBlockStatsPtr stats)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    int ret = -1;\n    virDomainObjPtr vm;\n    virDomainDiskDefPtr disk = NULL;\n    virLXCDomainObjPrivatePtr priv;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        return ret;\n\n    priv = vm->privateData;\n\n    if (virDomainBlockStatsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n   if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_QUERY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_BLKIO)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio cgroup isn't mounted\"));\n        goto endjob;\n    }\n\n    if (!*path) {\n        /* empty path - return entire domain blkstats instead */\n        ret = virCgroupGetBlkioIoServiced(priv->cgroup,\n                                          &stats->rd_bytes,\n                                          &stats->wr_bytes,\n                                          &stats->rd_req,\n                                          &stats->wr_req);\n        goto endjob;\n    }\n\n    if (!(disk = virDomainDiskByName(vm->def, path, false))) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid path: %s\"), path);\n        goto endjob;\n    }\n\n    if (!disk->info.alias) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"missing disk device alias name for %s\"), disk->dst);\n        goto endjob;\n    }\n\n    ret = virCgroupGetBlkioIoDeviceServiced(priv->cgroup,\n                                            disk->info.alias,\n                                            &stats->rd_bytes,\n                                            &stats->wr_bytes,\n                                            &stats->rd_req,\n                                            &stats->wr_req);\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetSchedulerParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "2036-2042",
    "snippet": "static int\nlxcDomainGetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int *nparams)\n{\n    return lxcDomainGetSchedulerParametersFlags(domain, params, nparams, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainGetSchedulerParametersFlags",
          "args": [
            "domain",
            "params",
            "nparams",
            "0"
          ],
          "line": 2041
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainGetSchedulerParametersFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1940-2034",
          "snippet": "static int\nlxcDomainGetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int *nparams,\n                                     unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n    unsigned long long shares = 0;\n    unsigned long long period = 0;\n    long long quota = 0;\n    int ret = -1;\n    int rc;\n    bool cpu_bw_status = false;\n    int saved_nparams = 0;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (*nparams > 1)\n        cpu_bw_status = virCgroupSupportsCpuBW(priv->cgroup);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (persistentDef) {\n        shares = persistentDef->cputune.shares;\n        if (*nparams > 1) {\n            period = persistentDef->cputune.period;\n            quota = persistentDef->cputune.quota;\n            cpu_bw_status = true; /* Allow copy of data to params[] */\n        }\n        goto out;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPU controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (virCgroupGetCpuShares(priv->cgroup, &shares) < 0)\n        goto cleanup;\n\n    if (*nparams > 1 && cpu_bw_status) {\n        rc = lxcGetVcpuBWLive(priv->cgroup, &period, &quota);\n        if (rc != 0)\n            goto cleanup;\n    }\n out:\n    if (virTypedParameterAssign(&params[0], VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                                VIR_TYPED_PARAM_ULLONG, shares) < 0)\n        goto cleanup;\n    saved_nparams++;\n\n    if (cpu_bw_status) {\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[1],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                                        VIR_TYPED_PARAM_ULLONG, period) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[2],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                                        VIR_TYPED_PARAM_LLONG, quota) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n    }\n\n    *nparams = saved_nparams;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainGetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int *nparams,\n                                     unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n    unsigned long long shares = 0;\n    unsigned long long period = 0;\n    long long quota = 0;\n    int ret = -1;\n    int rc;\n    bool cpu_bw_status = false;\n    int saved_nparams = 0;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (*nparams > 1)\n        cpu_bw_status = virCgroupSupportsCpuBW(priv->cgroup);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (persistentDef) {\n        shares = persistentDef->cputune.shares;\n        if (*nparams > 1) {\n            period = persistentDef->cputune.period;\n            quota = persistentDef->cputune.quota;\n            cpu_bw_status = true; /* Allow copy of data to params[] */\n        }\n        goto out;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPU controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (virCgroupGetCpuShares(priv->cgroup, &shares) < 0)\n        goto cleanup;\n\n    if (*nparams > 1 && cpu_bw_status) {\n        rc = lxcGetVcpuBWLive(priv->cgroup, &period, &quota);\n        if (rc != 0)\n            goto cleanup;\n    }\n out:\n    if (virTypedParameterAssign(&params[0], VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                                VIR_TYPED_PARAM_ULLONG, shares) < 0)\n        goto cleanup;\n    saved_nparams++;\n\n    if (cpu_bw_status) {\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[1],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                                        VIR_TYPED_PARAM_ULLONG, period) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[2],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                                        VIR_TYPED_PARAM_LLONG, quota) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n    }\n\n    *nparams = saved_nparams;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainGetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int *nparams)\n{\n    return lxcDomainGetSchedulerParametersFlags(domain, params, nparams, 0);\n}"
  },
  {
    "function_name": "lxcDomainGetSchedulerParametersFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1940-2034",
    "snippet": "static int\nlxcDomainGetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int *nparams,\n                                     unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n    unsigned long long shares = 0;\n    unsigned long long period = 0;\n    long long quota = 0;\n    int ret = -1;\n    int rc;\n    bool cpu_bw_status = false;\n    int saved_nparams = 0;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (*nparams > 1)\n        cpu_bw_status = virCgroupSupportsCpuBW(priv->cgroup);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (persistentDef) {\n        shares = persistentDef->cputune.shares;\n        if (*nparams > 1) {\n            period = persistentDef->cputune.period;\n            quota = persistentDef->cputune.quota;\n            cpu_bw_status = true; /* Allow copy of data to params[] */\n        }\n        goto out;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPU controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (virCgroupGetCpuShares(priv->cgroup, &shares) < 0)\n        goto cleanup;\n\n    if (*nparams > 1 && cpu_bw_status) {\n        rc = lxcGetVcpuBWLive(priv->cgroup, &period, &quota);\n        if (rc != 0)\n            goto cleanup;\n    }\n out:\n    if (virTypedParameterAssign(&params[0], VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                                VIR_TYPED_PARAM_ULLONG, shares) < 0)\n        goto cleanup;\n    saved_nparams++;\n\n    if (cpu_bw_status) {\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[1],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                                        VIR_TYPED_PARAM_ULLONG, period) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[2],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                                        VIR_TYPED_PARAM_LLONG, quota) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n    }\n\n    *nparams = saved_nparams;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 2032
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "&params[2]",
            "VIR_DOMAIN_SCHEDULER_VCPU_QUOTA",
            "VIR_TYPED_PARAM_LLONG",
            "quota"
          ],
          "line": 2019
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcGetVcpuBWLive",
          "args": [
            "priv->cgroup",
            "&period",
            "&quota"
          ],
          "line": 1999
        },
        "resolved": true,
        "details": {
          "function_name": "lxcGetVcpuBWLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1783-1788",
          "snippet": "static int\nlxcGetVcpuBWLive(virCgroupPtr cgroup, unsigned long long *period,\n                 long long *quota)\n{\n    return virCgroupGetCpuPeriodQuota(cgroup, period, quota);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcGetVcpuBWLive(virCgroupPtr cgroup, unsigned long long *period,\n                 long long *quota)\n{\n    return virCgroupGetCpuPeriodQuota(cgroup, period, quota);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuShares",
          "args": [
            "priv->cgroup",
            "&shares"
          ],
          "line": 1995
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuShares",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3338-3345",
          "snippet": "int\nvirCgroupGetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long *shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long *shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cgroup CPU controller is not mounted\")"
          ],
          "line": 1990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup CPU controller is not mounted\""
          ],
          "line": 1991
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPU"
          ],
          "line": 1989
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 1976
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSupportsCpuBW",
          "args": [
            "priv->cgroup"
          ],
          "line": 1974
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSupportsCpuBW",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3489-3494",
          "snippet": "bool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Control groups not supported on this platform\");\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Control groups not supported on this platform\");\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetSchedulerParametersFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY",
            "-1"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainGetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int *nparams,\n                                     unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def;\n    virDomainDefPtr persistentDef;\n    unsigned long long shares = 0;\n    unsigned long long period = 0;\n    long long quota = 0;\n    int ret = -1;\n    int rc;\n    bool cpu_bw_status = false;\n    int saved_nparams = 0;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (*nparams > 1)\n        cpu_bw_status = virCgroupSupportsCpuBW(priv->cgroup);\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (persistentDef) {\n        shares = persistentDef->cputune.shares;\n        if (*nparams > 1) {\n            period = persistentDef->cputune.period;\n            quota = persistentDef->cputune.quota;\n            cpu_bw_status = true; /* Allow copy of data to params[] */\n        }\n        goto out;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPU controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (virCgroupGetCpuShares(priv->cgroup, &shares) < 0)\n        goto cleanup;\n\n    if (*nparams > 1 && cpu_bw_status) {\n        rc = lxcGetVcpuBWLive(priv->cgroup, &period, &quota);\n        if (rc != 0)\n            goto cleanup;\n    }\n out:\n    if (virTypedParameterAssign(&params[0], VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                                VIR_TYPED_PARAM_ULLONG, shares) < 0)\n        goto cleanup;\n    saved_nparams++;\n\n    if (cpu_bw_status) {\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[1],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                                        VIR_TYPED_PARAM_ULLONG, period) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n\n        if (*nparams > saved_nparams) {\n            if (virTypedParameterAssign(&params[2],\n                                        VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                                        VIR_TYPED_PARAM_LLONG, quota) < 0)\n                goto cleanup;\n            saved_nparams++;\n        }\n    }\n\n    *nparams = saved_nparams;\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSetSchedulerParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1932-1938",
    "snippet": "static int\nlxcDomainSetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int nparams)\n{\n    return lxcDomainSetSchedulerParametersFlags(domain, params, nparams, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainSetSchedulerParametersFlags",
          "args": [
            "domain",
            "params",
            "nparams",
            "0"
          ],
          "line": 1937
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainSetSchedulerParametersFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1798-1930",
          "snippet": "static int\nlxcDomainSetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    size_t i;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDefCopy = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    int rc;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                               VIR_TYPED_PARAM_LLONG,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainSetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (persistentDef) {\n        /* Make a copy for updated domain. */\n        persistentDefCopy = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!persistentDefCopy)\n            goto endjob;\n    }\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n            virReportError(VIR_ERR_OPERATION_INVALID,\n                           \"%s\", _(\"cgroup CPU controller is not mounted\"));\n            goto endjob;\n        }\n    }\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_CPU_SHARES)) {\n            if (def) {\n                unsigned long long val;\n                if (virCgroupSetupCpuShares(priv->cgroup, params[i].value.ul,\n                                            &val) < 0)\n                    goto endjob;\n\n                def->cputune.shares = val;\n                def->cputune.sharesSpecified = true;\n            }\n\n            if (persistentDef) {\n                persistentDefCopy->cputune.shares = params[i].value.ul;\n                persistentDefCopy->cputune.sharesSpecified = true;\n            }\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_PERIOD)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, params[i].value.ul, 0);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.ul)\n                    def->cputune.period = params[i].value.ul;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.period = params[i].value.ul;\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_QUOTA)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, 0, params[i].value.l);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.l)\n                    def->cputune.quota = params[i].value.l;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.quota = params[i].value.l;\n        }\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n\n\n    if (persistentDef) {\n        rc = virDomainDefSave(persistentDefCopy, driver->xmlopt,\n                              cfg->configDir);\n        if (rc < 0)\n            goto endjob;\n\n        virDomainObjAssignDef(vm, persistentDefCopy, false, NULL);\n        persistentDefCopy = NULL;\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(persistentDefCopy);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    size_t i;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDefCopy = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    int rc;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                               VIR_TYPED_PARAM_LLONG,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainSetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (persistentDef) {\n        /* Make a copy for updated domain. */\n        persistentDefCopy = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!persistentDefCopy)\n            goto endjob;\n    }\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n            virReportError(VIR_ERR_OPERATION_INVALID,\n                           \"%s\", _(\"cgroup CPU controller is not mounted\"));\n            goto endjob;\n        }\n    }\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_CPU_SHARES)) {\n            if (def) {\n                unsigned long long val;\n                if (virCgroupSetupCpuShares(priv->cgroup, params[i].value.ul,\n                                            &val) < 0)\n                    goto endjob;\n\n                def->cputune.shares = val;\n                def->cputune.sharesSpecified = true;\n            }\n\n            if (persistentDef) {\n                persistentDefCopy->cputune.shares = params[i].value.ul;\n                persistentDefCopy->cputune.sharesSpecified = true;\n            }\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_PERIOD)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, params[i].value.ul, 0);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.ul)\n                    def->cputune.period = params[i].value.ul;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.period = params[i].value.ul;\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_QUOTA)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, 0, params[i].value.l);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.l)\n                    def->cputune.quota = params[i].value.l;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.quota = params[i].value.l;\n        }\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n\n\n    if (persistentDef) {\n        rc = virDomainDefSave(persistentDefCopy, driver->xmlopt,\n                              cfg->configDir);\n        if (rc < 0)\n            goto endjob;\n\n        virDomainObjAssignDef(vm, persistentDefCopy, false, NULL);\n        persistentDefCopy = NULL;\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(persistentDefCopy);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params,\n                                int nparams)\n{\n    return lxcDomainSetSchedulerParametersFlags(domain, params, nparams, 0);\n}"
  },
  {
    "function_name": "lxcDomainSetSchedulerParametersFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1798-1930",
    "snippet": "static int\nlxcDomainSetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    size_t i;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDefCopy = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    int rc;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                               VIR_TYPED_PARAM_LLONG,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainSetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (persistentDef) {\n        /* Make a copy for updated domain. */\n        persistentDefCopy = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!persistentDefCopy)\n            goto endjob;\n    }\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n            virReportError(VIR_ERR_OPERATION_INVALID,\n                           \"%s\", _(\"cgroup CPU controller is not mounted\"));\n            goto endjob;\n        }\n    }\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_CPU_SHARES)) {\n            if (def) {\n                unsigned long long val;\n                if (virCgroupSetupCpuShares(priv->cgroup, params[i].value.ul,\n                                            &val) < 0)\n                    goto endjob;\n\n                def->cputune.shares = val;\n                def->cputune.sharesSpecified = true;\n            }\n\n            if (persistentDef) {\n                persistentDefCopy->cputune.shares = params[i].value.ul;\n                persistentDefCopy->cputune.sharesSpecified = true;\n            }\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_PERIOD)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, params[i].value.ul, 0);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.ul)\n                    def->cputune.period = params[i].value.ul;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.period = params[i].value.ul;\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_QUOTA)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, 0, params[i].value.l);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.l)\n                    def->cputune.quota = params[i].value.l;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.quota = params[i].value.l;\n        }\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n\n\n    if (persistentDef) {\n        rc = virDomainDefSave(persistentDefCopy, driver->xmlopt,\n                              cfg->configDir);\n        if (rc < 0)\n            goto endjob;\n\n        virDomainObjAssignDef(vm, persistentDefCopy, false, NULL);\n        persistentDefCopy = NULL;\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(persistentDefCopy);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 1928
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1926
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "persistentDefCopy"
          ],
          "line": 1925
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1922
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjAssignDef",
          "args": [
            "vm",
            "persistentDefCopy",
            "false",
            "NULL"
          ],
          "line": 1915
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3597-3626",
          "snippet": "void virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainObjAssignDef(virDomainObjPtr domain,\n                           virDomainDefPtr def,\n                           bool live,\n                           virDomainDefPtr *oldDef)\n{\n    if (oldDef)\n        *oldDef = NULL;\n    if (virDomainObjIsActive(domain)) {\n        if (oldDef)\n            *oldDef = domain->newDef;\n        else\n            virDomainDefFree(domain->newDef);\n        domain->newDef = def;\n    } else {\n        if (live) {\n            /* save current configuration to be restored on domain shutdown */\n            if (!domain->newDef)\n                domain->newDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        } else {\n            if (oldDef)\n                *oldDef = domain->def;\n            else\n                virDomainDefFree(domain->def);\n            domain->def = def;\n        }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "persistentDefCopy",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 1910
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 1905
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSetVcpuBWLive",
          "args": [
            "priv->cgroup",
            "0",
            "params[i].value.l"
          ],
          "line": 1892
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSetVcpuBWLive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1791-1795",
          "snippet": "static int lxcSetVcpuBWLive(virCgroupPtr cgroup, unsigned long long period,\n                            long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcSetVcpuBWLive(virCgroupPtr cgroup, unsigned long long period,\n                            long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_SCHEDULER_VCPU_QUOTA"
          ],
          "line": 1890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_SCHEDULER_VCPU_PERIOD"
          ],
          "line": 1878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetupCpuShares",
          "args": [
            "priv->cgroup",
            "params[i].value.ul",
            "&val"
          ],
          "line": 1866
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpuShares",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3692-3703",
          "snippet": "int\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_SCHEDULER_CPU_SHARES"
          ],
          "line": 1863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cgroup CPU controller is not mounted\")"
          ],
          "line": 1854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup CPU controller is not mounted\""
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPU"
          ],
          "line": 1853
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCopyPersistentDef",
          "args": [
            "vm",
            "driver->xmlopt",
            "NULL"
          ],
          "line": 1847
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCopyPersistentDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30026-30035",
          "snippet": "virDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainObjCopyPersistentDef(virDomainObjPtr dom,\n                              virDomainXMLOptionPtr xmlopt,\n                              void *parseOpaque)\n{\n    virDomainDefPtr cur;\n\n    cur = virDomainObjGetPersistentDef(xmlopt, dom, parseOpaque);\n    return virDomainDefCopy(cur, xmlopt, parseOpaque, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 1842
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 1839
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "false"
          ],
          "line": 1836
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetSchedulerParametersFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 1833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1828
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_DOMAIN_SCHEDULER_CPU_SHARES",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_DOMAIN_SCHEDULER_VCPU_PERIOD",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_DOMAIN_SCHEDULER_VCPU_QUOTA",
            "VIR_TYPED_PARAM_LLONG",
            "NULL"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 1814
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSetSchedulerParametersFlags(virDomainPtr dom,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virCapsPtr caps = NULL;\n    size_t i;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDefCopy = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    int rc;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_SCHEDULER_CPU_SHARES,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_PERIOD,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_SCHEDULER_VCPU_QUOTA,\n                               VIR_TYPED_PARAM_LLONG,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainSetSchedulerParametersFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (persistentDef) {\n        /* Make a copy for updated domain. */\n        persistentDefCopy = virDomainObjCopyPersistentDef(vm, driver->xmlopt, NULL);\n        if (!persistentDefCopy)\n            goto endjob;\n    }\n\n    if (def) {\n        if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n            virReportError(VIR_ERR_OPERATION_INVALID,\n                           \"%s\", _(\"cgroup CPU controller is not mounted\"));\n            goto endjob;\n        }\n    }\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_CPU_SHARES)) {\n            if (def) {\n                unsigned long long val;\n                if (virCgroupSetupCpuShares(priv->cgroup, params[i].value.ul,\n                                            &val) < 0)\n                    goto endjob;\n\n                def->cputune.shares = val;\n                def->cputune.sharesSpecified = true;\n            }\n\n            if (persistentDef) {\n                persistentDefCopy->cputune.shares = params[i].value.ul;\n                persistentDefCopy->cputune.sharesSpecified = true;\n            }\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_PERIOD)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, params[i].value.ul, 0);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.ul)\n                    def->cputune.period = params[i].value.ul;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.period = params[i].value.ul;\n        } else if (STREQ(param->field, VIR_DOMAIN_SCHEDULER_VCPU_QUOTA)) {\n            if (def) {\n                rc = lxcSetVcpuBWLive(priv->cgroup, 0, params[i].value.l);\n                if (rc != 0)\n                    goto endjob;\n\n                if (params[i].value.l)\n                    def->cputune.quota = params[i].value.l;\n            }\n\n            if (persistentDef)\n                persistentDefCopy->cputune.quota = params[i].value.l;\n        }\n    }\n\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n\n\n    if (persistentDef) {\n        rc = virDomainDefSave(persistentDefCopy, driver->xmlopt,\n                              cfg->configDir);\n        if (rc < 0)\n            goto endjob;\n\n        virDomainObjAssignDef(vm, persistentDefCopy, false, NULL);\n        persistentDefCopy = NULL;\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(persistentDefCopy);\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcSetVcpuBWLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1791-1795",
    "snippet": "static int lxcSetVcpuBWLive(virCgroupPtr cgroup, unsigned long long period,\n                            long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetupCpuPeriodQuota",
          "args": [
            "cgroup",
            "period",
            "quota"
          ],
          "line": 1794
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupCpuPeriodQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3706-3741",
          "snippet": "int\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcSetVcpuBWLive(virCgroupPtr cgroup, unsigned long long period,\n                            long long quota)\n{\n    return virCgroupSetupCpuPeriodQuota(cgroup, period, quota);\n}"
  },
  {
    "function_name": "lxcGetVcpuBWLive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1783-1788",
    "snippet": "static int\nlxcGetVcpuBWLive(virCgroupPtr cgroup, unsigned long long *period,\n                 long long *quota)\n{\n    return virCgroupGetCpuPeriodQuota(cgroup, period, quota);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetCpuPeriodQuota",
          "args": [
            "cgroup",
            "period",
            "quota"
          ],
          "line": 1787
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuPeriodQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3744-3755",
          "snippet": "int\nvirCgroupGetCpuPeriodQuota(virCgroupPtr cgroup, unsigned long long *period,\n                           long long *quota)\n{\n    if (virCgroupGetCpuCfsPeriod(cgroup, period) < 0)\n        return -1;\n\n    if (virCgroupGetCpuCfsQuota(cgroup, quota) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuPeriodQuota(virCgroupPtr cgroup, unsigned long long *period,\n                           long long *quota)\n{\n    if (virCgroupGetCpuCfsPeriod(cgroup, period) < 0)\n        return -1;\n\n    if (virCgroupGetCpuCfsQuota(cgroup, quota) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcGetVcpuBWLive(virCgroupPtr cgroup, unsigned long long *period,\n                 long long *quota)\n{\n    return virCgroupGetCpuPeriodQuota(cgroup, period, quota);\n}"
  },
  {
    "function_name": "lxcDomainGetSchedulerType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1739-1780",
    "snippet": "static char *lxcDomainGetSchedulerType(virDomainPtr dom,\n                                       int *nparams)\n{\n    char *ret = NULL;\n    virDomainObjPtr vm;\n    virLXCDomainObjPrivatePtr priv;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetSchedulerTypeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    /* Domain not running, thus no cgroups - return defaults */\n    if (!virDomainObjIsActive(vm)) {\n        if (nparams)\n            *nparams = 3;\n        ret = g_strdup(\"posix\");\n        goto cleanup;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPU controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (nparams) {\n        if (virCgroupSupportsCpuBW(priv->cgroup))\n            *nparams = 3;\n        else\n            *nparams = 1;\n    }\n\n    ret = g_strdup(\"posix\");\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"posix\""
          ],
          "line": 1775
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSupportsCpuBW",
          "args": [
            "priv->cgroup"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSupportsCpuBW",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3489-3494",
          "snippet": "bool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Control groups not supported on this platform\");\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Control groups not supported on this platform\");\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cgroup CPU controller is not mounted\")"
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup CPU controller is not mounted\""
          ],
          "line": 1764
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_CPU"
          ],
          "line": 1762
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 1755
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetSchedulerTypeEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1751
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1746
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *lxcDomainGetSchedulerType(virDomainPtr dom,\n                                       int *nparams)\n{\n    char *ret = NULL;\n    virDomainObjPtr vm;\n    virLXCDomainObjPrivatePtr priv;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetSchedulerTypeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    /* Domain not running, thus no cgroups - return defaults */\n    if (!virDomainObjIsActive(vm)) {\n        if (nparams)\n            *nparams = 3;\n        ret = g_strdup(\"posix\");\n        goto cleanup;\n    }\n\n    if (!virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_CPU)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup CPU controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if (nparams) {\n        if (virCgroupSupportsCpuBW(priv->cgroup))\n            *nparams = 3;\n        else\n            *nparams = 1;\n    }\n\n    ret = g_strdup(\"posix\");\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcConnectGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1730-1736",
    "snippet": "static char *lxcConnectGetHostname(virConnectPtr conn)\n{\n    if (virConnectGetHostnameEnsureACL(conn) < 0)\n        return NULL;\n\n    return virGetHostname();\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetHostname",
          "args": [],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostnameQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "560-564",
          "snippet": "char *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirGetHostnameQuiet(void)\n{\n    return virGetHostnameImpl(true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetHostnameEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1732
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *lxcConnectGetHostname(virConnectPtr conn)\n{\n    if (virConnectGetHostnameEnsureACL(conn) < 0)\n        return NULL;\n\n    return virGetHostname();\n}"
  },
  {
    "function_name": "lxcDomainInterfaceAddresses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1687-1726",
    "snippet": "static int\nlxcDomainInterfaceAddresses(virDomainPtr dom,\n                            virDomainInterfacePtr **ifaces,\n                            unsigned int source,\n                            unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainInterfaceAddressesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    switch (source) {\n    case VIR_DOMAIN_INTERFACE_ADDRESSES_SRC_LEASE:\n        ret = virDomainNetDHCPInterfaces(vm->def, ifaces);\n        break;\n\n    case VIR_DOMAIN_INTERFACE_ADDRESSES_SRC_ARP:\n        ret = virDomainNetARPInterfaces(vm->def, ifaces);\n        break;\n\n    default:\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"Unknown IP address data source %d\"),\n                       source);\n        break;\n    }\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1724
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "_(\"Unknown IP address data source %d\")",
            "source"
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown IP address data source %d\""
          ],
          "line": 1718
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetARPInterfaces",
          "args": [
            "vm->def",
            "ifaces"
          ],
          "line": 1713
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetARPInterfaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17683-17738",
          "snippet": "int\nvirDomainNetARPInterfaces(virDomainDefPtr def,\n                          virDomainInterfacePtr **ifaces)\n{\n    size_t i, j;\n    size_t ifaces_count = 0;\n    int ret = -1;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    virDomainInterfacePtr *ifaces_ret = NULL;\n    virDomainInterfacePtr iface = NULL;\n    virArpTablePtr table;\n\n    table = virArpTableGet();\n    if (!table)\n        goto cleanup;\n\n    for (i = 0; i < def->nnets; i++) {\n        virMacAddrFormat(&(def->nets[i]->mac), macaddr);\n        for (j = 0; j < table->n; j++) {\n            virArpTableEntry entry = table->t[j];\n\n            if (STREQ(entry.mac, macaddr)) {\n                if (VIR_ALLOC(iface) < 0)\n                    goto cleanup;\n\n                iface->name = g_strdup(def->nets[i]->ifname);\n\n                iface->hwaddr = g_strdup(macaddr);\n\n                if (VIR_ALLOC(iface->addrs) < 0)\n                    goto cleanup;\n                iface->naddrs = 1;\n\n                iface->addrs->addr = g_strdup(entry.ipaddr);\n\n                if (VIR_APPEND_ELEMENT(ifaces_ret, ifaces_count, iface) < 0)\n                    goto cleanup;\n            }\n        }\n    }\n\n    *ifaces = g_steal_pointer(&ifaces_ret);\n    ret = ifaces_count;\n\n cleanup:\n    virArpTableFree(table);\n    virDomainInterfaceFree(iface);\n\n    if (ifaces_ret) {\n        for (i = 0; i < ifaces_count; i++)\n            virDomainInterfaceFree(ifaces_ret[i]);\n    }\n    VIR_FREE(ifaces_ret);\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetARPInterfaces(virDomainDefPtr def,\n                          virDomainInterfacePtr **ifaces)\n{\n    size_t i, j;\n    size_t ifaces_count = 0;\n    int ret = -1;\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n    virDomainInterfacePtr *ifaces_ret = NULL;\n    virDomainInterfacePtr iface = NULL;\n    virArpTablePtr table;\n\n    table = virArpTableGet();\n    if (!table)\n        goto cleanup;\n\n    for (i = 0; i < def->nnets; i++) {\n        virMacAddrFormat(&(def->nets[i]->mac), macaddr);\n        for (j = 0; j < table->n; j++) {\n            virArpTableEntry entry = table->t[j];\n\n            if (STREQ(entry.mac, macaddr)) {\n                if (VIR_ALLOC(iface) < 0)\n                    goto cleanup;\n\n                iface->name = g_strdup(def->nets[i]->ifname);\n\n                iface->hwaddr = g_strdup(macaddr);\n\n                if (VIR_ALLOC(iface->addrs) < 0)\n                    goto cleanup;\n                iface->naddrs = 1;\n\n                iface->addrs->addr = g_strdup(entry.ipaddr);\n\n                if (VIR_APPEND_ELEMENT(ifaces_ret, ifaces_count, iface) < 0)\n                    goto cleanup;\n            }\n        }\n    }\n\n    *ifaces = g_steal_pointer(&ifaces_ret);\n    ret = ifaces_count;\n\n cleanup:\n    virArpTableFree(table);\n    virDomainInterfaceFree(iface);\n\n    if (ifaces_ret) {\n        for (i = 0; i < ifaces_count; i++)\n            virDomainInterfaceFree(ifaces_ret[i]);\n    }\n    VIR_FREE(ifaces_ret);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetDHCPInterfaces",
          "args": [
            "vm->def",
            "ifaces"
          ],
          "line": 1709
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDHCPInterfaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "17608-17680",
          "snippet": "int\nvirDomainNetDHCPInterfaces(virDomainDefPtr def,\n                           virDomainInterfacePtr **ifaces)\n{\n    g_autoptr(virConnect) conn = NULL;\n    virDomainInterfacePtr *ifaces_ret = NULL;\n    size_t ifaces_count = 0;\n    size_t i;\n\n    if (!(conn = virGetConnectNetwork()))\n        return -1;\n\n    for (i = 0; i < def->nnets; i++) {\n        g_autoptr(virNetwork) network = NULL;\n        char macaddr[VIR_MAC_STRING_BUFLEN];\n        virNetworkDHCPLeasePtr *leases = NULL;\n        int n_leases = 0;\n        virDomainInterfacePtr iface = NULL;\n        size_t j;\n\n        if (def->nets[i]->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n            continue;\n\n        virMacAddrFormat(&(def->nets[i]->mac), macaddr);\n\n        network = virNetworkLookupByName(conn,\n                                         def->nets[i]->data.network.name);\n        if (!network)\n            goto error;\n\n        if ((n_leases = virNetworkGetDHCPLeases(network, macaddr,\n                                                &leases, 0)) < 0)\n            goto error;\n\n        if (n_leases) {\n            ifaces_ret = g_renew(typeof(*ifaces_ret), ifaces_ret, ifaces_count + 1);\n            ifaces_ret[ifaces_count] = g_new0(typeof(**ifaces_ret), 1);\n            iface = ifaces_ret[ifaces_count];\n            ifaces_count++;\n\n            /* Assuming each lease corresponds to a separate IP */\n            iface->naddrs = n_leases;\n            iface->addrs = g_new0(typeof(*iface->addrs), iface->naddrs);\n            iface->name = g_strdup(def->nets[i]->ifname);\n            iface->hwaddr = g_strdup(macaddr);\n        }\n\n        for (j = 0; j < n_leases; j++) {\n            virNetworkDHCPLeasePtr lease = leases[j];\n            virDomainIPAddressPtr ip_addr = &iface->addrs[j];\n\n            ip_addr->addr = g_strdup(lease->ipaddr);\n            ip_addr->type = lease->type;\n            ip_addr->prefix = lease->prefix;\n\n            virNetworkDHCPLeaseFree(lease);\n        }\n\n        VIR_FREE(leases);\n    }\n\n    *ifaces = g_steal_pointer(&ifaces_ret);\n    return ifaces_count;\n\n error:\n    if (ifaces_ret) {\n        for (i = 0; i < ifaces_count; i++)\n            virDomainInterfaceFree(ifaces_ret[i]);\n    }\n    VIR_FREE(ifaces_ret);\n\n    return -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetDHCPInterfaces(virDomainDefPtr def,\n                           virDomainInterfacePtr **ifaces)\n{\n    g_autoptr(virConnect) conn = NULL;\n    virDomainInterfacePtr *ifaces_ret = NULL;\n    size_t ifaces_count = 0;\n    size_t i;\n\n    if (!(conn = virGetConnectNetwork()))\n        return -1;\n\n    for (i = 0; i < def->nnets; i++) {\n        g_autoptr(virNetwork) network = NULL;\n        char macaddr[VIR_MAC_STRING_BUFLEN];\n        virNetworkDHCPLeasePtr *leases = NULL;\n        int n_leases = 0;\n        virDomainInterfacePtr iface = NULL;\n        size_t j;\n\n        if (def->nets[i]->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n            continue;\n\n        virMacAddrFormat(&(def->nets[i]->mac), macaddr);\n\n        network = virNetworkLookupByName(conn,\n                                         def->nets[i]->data.network.name);\n        if (!network)\n            goto error;\n\n        if ((n_leases = virNetworkGetDHCPLeases(network, macaddr,\n                                                &leases, 0)) < 0)\n            goto error;\n\n        if (n_leases) {\n            ifaces_ret = g_renew(typeof(*ifaces_ret), ifaces_ret, ifaces_count + 1);\n            ifaces_ret[ifaces_count] = g_new0(typeof(**ifaces_ret), 1);\n            iface = ifaces_ret[ifaces_count];\n            ifaces_count++;\n\n            /* Assuming each lease corresponds to a separate IP */\n            iface->naddrs = n_leases;\n            iface->addrs = g_new0(typeof(*iface->addrs), iface->naddrs);\n            iface->name = g_strdup(def->nets[i]->ifname);\n            iface->hwaddr = g_strdup(macaddr);\n        }\n\n        for (j = 0; j < n_leases; j++) {\n            virNetworkDHCPLeasePtr lease = leases[j];\n            virDomainIPAddressPtr ip_addr = &iface->addrs[j];\n\n            ip_addr->addr = g_strdup(lease->ipaddr);\n            ip_addr->type = lease->type;\n            ip_addr->prefix = lease->prefix;\n\n            virNetworkDHCPLeaseFree(lease);\n        }\n\n        VIR_FREE(leases);\n    }\n\n    *ifaces = g_steal_pointer(&ifaces_ret);\n    return ifaces_count;\n\n error:\n    if (ifaces_ret) {\n        for (i = 0; i < ifaces_count; i++)\n            virDomainInterfaceFree(ifaces_ret[i]);\n    }\n    VIR_FREE(ifaces_ret);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 1704
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainInterfaceAddressesEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1696
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainInterfaceAddresses(virDomainPtr dom,\n                            virDomainInterfacePtr **ifaces,\n                            unsigned int source,\n                            unsigned int flags)\n{\n    virDomainObjPtr vm = NULL;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainInterfaceAddressesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto cleanup;\n\n    switch (source) {\n    case VIR_DOMAIN_INTERFACE_ADDRESSES_SRC_LEASE:\n        ret = virDomainNetDHCPInterfaces(vm->def, ifaces);\n        break;\n\n    case VIR_DOMAIN_INTERFACE_ADDRESSES_SRC_ARP:\n        ret = virDomainNetARPInterfaces(vm->def, ifaces);\n        break;\n\n    default:\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"Unknown IP address data source %d\"),\n                       source);\n        break;\n    }\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcConnectGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1669-1684",
    "snippet": "static int lxcConnectGetVersion(virConnectPtr conn, unsigned long *version)\n{\n    struct utsname ver;\n\n    uname(&ver);\n\n    if (virConnectGetVersionEnsureACL(conn) < 0)\n        return -1;\n\n    if (virParseVersionString(ver.release, version, true) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Unknown release: %s\"), ver.release);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unknown release: %s\")",
            "ver.release"
          ],
          "line": 1679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown release: %s\""
          ],
          "line": 1679
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "ver.release",
            "version",
            "true"
          ],
          "line": 1678
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetVersionEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uname",
          "args": [
            "&ver"
          ],
          "line": 1673
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectGetVersion(virConnectPtr conn, unsigned long *version)\n{\n    struct utsname ver;\n\n    uname(&ver);\n\n    if (virConnectGetVersionEnsureACL(conn) < 0)\n        return -1;\n\n    if (virParseVersionString(ver.release, version, true) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Unknown release: %s\"), ver.release);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcConnectSupportsFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1640-1666",
    "snippet": "static int\nlxcConnectSupportsFeature(virConnectPtr conn, int feature)\n{\n    if (virConnectSupportsFeatureEnsureACL(conn) < 0)\n        return -1;\n\n    switch ((virDrvFeature) feature) {\n    case VIR_DRV_FEATURE_TYPED_PARAM_STRING:\n        return 1;\n    case VIR_DRV_FEATURE_FD_PASSING:\n    case VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION:\n    case VIR_DRV_FEATURE_MIGRATION_DIRECT:\n    case VIR_DRV_FEATURE_MIGRATION_OFFLINE:\n    case VIR_DRV_FEATURE_MIGRATION_P2P:\n    case VIR_DRV_FEATURE_MIGRATION_PARAMS:\n    case VIR_DRV_FEATURE_MIGRATION_V1:\n    case VIR_DRV_FEATURE_MIGRATION_V2:\n    case VIR_DRV_FEATURE_MIGRATION_V3:\n    case VIR_DRV_FEATURE_PROGRAM_KEEPALIVE:\n    case VIR_DRV_FEATURE_REMOTE:\n    case VIR_DRV_FEATURE_REMOTE_CLOSE_CALLBACK:\n    case VIR_DRV_FEATURE_REMOTE_EVENT_CALLBACK:\n    case VIR_DRV_FEATURE_XML_MIGRATABLE:\n    default:\n        return 0;\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectSupportsFeatureEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcConnectSupportsFeature(virConnectPtr conn, int feature)\n{\n    if (virConnectSupportsFeatureEnsureACL(conn) < 0)\n        return -1;\n\n    switch ((virDrvFeature) feature) {\n    case VIR_DRV_FEATURE_TYPED_PARAM_STRING:\n        return 1;\n    case VIR_DRV_FEATURE_FD_PASSING:\n    case VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION:\n    case VIR_DRV_FEATURE_MIGRATION_DIRECT:\n    case VIR_DRV_FEATURE_MIGRATION_OFFLINE:\n    case VIR_DRV_FEATURE_MIGRATION_P2P:\n    case VIR_DRV_FEATURE_MIGRATION_PARAMS:\n    case VIR_DRV_FEATURE_MIGRATION_V1:\n    case VIR_DRV_FEATURE_MIGRATION_V2:\n    case VIR_DRV_FEATURE_MIGRATION_V3:\n    case VIR_DRV_FEATURE_PROGRAM_KEEPALIVE:\n    case VIR_DRV_FEATURE_REMOTE:\n    case VIR_DRV_FEATURE_REMOTE_CLOSE_CALLBACK:\n    case VIR_DRV_FEATURE_REMOTE_EVENT_CALLBACK:\n    case VIR_DRV_FEATURE_XML_MIGRATABLE:\n    default:\n        return 0;\n    }\n}"
  },
  {
    "function_name": "lxcStateCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1613-1638",
    "snippet": "static int lxcStateCleanup(void)\n{\n    if (lxc_driver == NULL)\n        return -1;\n\n    virObjectUnref(lxc_driver->domains);\n    virObjectUnref(lxc_driver->domainEventState);\n\n    virObjectUnref(lxc_driver->closeCallbacks);\n\n    virSysinfoDefFree(lxc_driver->hostsysinfo);\n\n    virObjectUnref(lxc_driver->hostdevMgr);\n    virObjectUnref(lxc_driver->caps);\n    virObjectUnref(lxc_driver->securityManager);\n    virObjectUnref(lxc_driver->xmlopt);\n\n    if (lxc_driver->lockFD != -1)\n        virPidFileRelease(lxc_driver->config->stateDir, \"driver\", lxc_driver->lockFD);\n\n    virObjectUnref(lxc_driver->config);\n    virMutexDestroy(&lxc_driver->lock);\n    VIR_FREE(lxc_driver);\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateCleanup(void);",
      "virLXCDriverPtr lxc_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lxc_driver"
          ],
          "line": 1635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&lxc_driver->lock"
          ],
          "line": 1634
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "lxc_driver->config"
          ],
          "line": 1633
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileRelease",
          "args": [
            "lxc_driver->config->stateDir",
            "\"driver\"",
            "lxc_driver->lockFD"
          ],
          "line": 1631
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileRelease",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "453-466",
          "snippet": "int virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoDefFree",
          "args": [
            "lxc_driver->hostsysinfo"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "144-191",
          "snippet": "void virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid virSysinfoDefFree(virSysinfoDefPtr def)\n{\n    size_t i;\n\n    if (def == NULL)\n        return;\n\n    virSysinfoBIOSDefFree(def->bios);\n    virSysinfoSystemDefFree(def->system);\n\n    for (i = 0; i < def->nbaseBoard; i++)\n        virSysinfoBaseBoardDefClear(def->baseBoard + i);\n    VIR_FREE(def->baseBoard);\n\n    virSysinfoChassisDefFree(def->chassis);\n\n    for (i = 0; i < def->nprocessor; i++) {\n        VIR_FREE(def->processor[i].processor_socket_destination);\n        VIR_FREE(def->processor[i].processor_type);\n        VIR_FREE(def->processor[i].processor_family);\n        VIR_FREE(def->processor[i].processor_manufacturer);\n        VIR_FREE(def->processor[i].processor_signature);\n        VIR_FREE(def->processor[i].processor_version);\n        VIR_FREE(def->processor[i].processor_external_clock);\n        VIR_FREE(def->processor[i].processor_max_speed);\n        VIR_FREE(def->processor[i].processor_status);\n        VIR_FREE(def->processor[i].processor_serial_number);\n        VIR_FREE(def->processor[i].processor_part_number);\n    }\n    VIR_FREE(def->processor);\n    for (i = 0; i < def->nmemory; i++) {\n        VIR_FREE(def->memory[i].memory_size);\n        VIR_FREE(def->memory[i].memory_form_factor);\n        VIR_FREE(def->memory[i].memory_locator);\n        VIR_FREE(def->memory[i].memory_bank_locator);\n        VIR_FREE(def->memory[i].memory_type);\n        VIR_FREE(def->memory[i].memory_type_detail);\n        VIR_FREE(def->memory[i].memory_speed);\n        VIR_FREE(def->memory[i].memory_manufacturer);\n        VIR_FREE(def->memory[i].memory_serial_number);\n        VIR_FREE(def->memory[i].memory_part_number);\n    }\n    VIR_FREE(def->memory);\n\n    virSysinfoOEMStringsDefFree(def->oemStrings);\n\n    VIR_FREE(def);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateCleanup(void);\nvirLXCDriverPtr lxc_driver = NULL;\n\nstatic int lxcStateCleanup(void)\n{\n    if (lxc_driver == NULL)\n        return -1;\n\n    virObjectUnref(lxc_driver->domains);\n    virObjectUnref(lxc_driver->domainEventState);\n\n    virObjectUnref(lxc_driver->closeCallbacks);\n\n    virSysinfoDefFree(lxc_driver->hostsysinfo);\n\n    virObjectUnref(lxc_driver->hostdevMgr);\n    virObjectUnref(lxc_driver->caps);\n    virObjectUnref(lxc_driver->securityManager);\n    virObjectUnref(lxc_driver->xmlopt);\n\n    if (lxc_driver->lockFD != -1)\n        virPidFileRelease(lxc_driver->config->stateDir, \"driver\", lxc_driver->lockFD);\n\n    virObjectUnref(lxc_driver->config);\n    virMutexDestroy(&lxc_driver->lock);\n    VIR_FREE(lxc_driver);\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcStateReload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1594-1611",
    "snippet": "static int\nlxcStateReload(void)\n{\n    virLXCDriverConfigPtr cfg = NULL;\n\n    if (!lxc_driver)\n        return 0;\n\n    cfg = virLXCDriverGetConfig(lxc_driver);\n\n    virDomainObjListLoadAllConfigs(lxc_driver->domains,\n                                   cfg->configDir,\n                                   cfg->autostartDir, false,\n                                   lxc_driver->xmlopt,\n                                   lxcNotifyLoadDomain, lxc_driver);\n    virObjectUnref(cfg);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virLXCDriverPtr lxc_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 1609
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListLoadAllConfigs",
          "args": [
            "lxc_driver->domains",
            "cfg->configDir",
            "cfg->autostartDir",
            "false",
            "lxc_driver->xmlopt",
            "lxcNotifyLoadDomain",
            "lxc_driver"
          ],
          "line": 1604
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "582-639",
          "snippet": "int\nvirDomainObjListLoadAllConfigs(virDomainObjListPtr doms,\n                               const char *configDir,\n                               const char *autostartDir,\n                               bool liveStatus,\n                               virDomainXMLOptionPtr xmlopt,\n                               virDomainLoadConfigNotify notify,\n                               void *opaque)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(doms);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virDomainObjPtr dom;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        if (liveStatus)\n            dom = virDomainObjListLoadStatus(doms,\n                                             configDir,\n                                             entry->d_name,\n                                             xmlopt,\n                                             notify,\n                                             opaque);\n        else\n            dom = virDomainObjListLoadConfig(doms,\n                                             xmlopt,\n                                             configDir,\n                                             autostartDir,\n                                             entry->d_name,\n                                             notify,\n                                             opaque);\n        if (dom) {\n            if (!liveStatus)\n                dom->persistent = 1;\n            virDomainObjEndAPI(&dom);\n        } else {\n            VIR_ERROR(_(\"Failed to load config for domain '%s'\"), entry->d_name);\n        }\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListLoadAllConfigs(virDomainObjListPtr doms,\n                               const char *configDir,\n                               const char *autostartDir,\n                               bool liveStatus,\n                               virDomainXMLOptionPtr xmlopt,\n                               virDomainLoadConfigNotify notify,\n                               void *opaque)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(doms);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virDomainObjPtr dom;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        if (liveStatus)\n            dom = virDomainObjListLoadStatus(doms,\n                                             configDir,\n                                             entry->d_name,\n                                             xmlopt,\n                                             notify,\n                                             opaque);\n        else\n            dom = virDomainObjListLoadConfig(doms,\n                                             xmlopt,\n                                             configDir,\n                                             autostartDir,\n                                             entry->d_name,\n                                             notify,\n                                             opaque);\n        if (dom) {\n            if (!liveStatus)\n                dom->persistent = 1;\n            virDomainObjEndAPI(&dom);\n        } else {\n            VIR_ERROR(_(\"Failed to load config for domain '%s'\"), entry->d_name);\n        }\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "lxc_driver"
          ],
          "line": 1602
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirLXCDriverPtr lxc_driver = NULL;\n\nstatic int\nlxcStateReload(void)\n{\n    virLXCDriverConfigPtr cfg = NULL;\n\n    if (!lxc_driver)\n        return 0;\n\n    cfg = virLXCDriverGetConfig(lxc_driver);\n\n    virDomainObjListLoadAllConfigs(lxc_driver->domains,\n                                   cfg->configDir,\n                                   cfg->autostartDir, false,\n                                   lxc_driver->xmlopt,\n                                   lxcNotifyLoadDomain, lxc_driver);\n    virObjectUnref(cfg);\n    return 0;\n}"
  },
  {
    "function_name": "lxcNotifyLoadDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1575-1586",
    "snippet": "static void lxcNotifyLoadDomain(virDomainObjPtr vm, int newVM, void *opaque)\n{\n    virLXCDriverPtr driver = opaque;\n\n    if (newVM) {\n        virObjectEventPtr event =\n            virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_DEFINED,\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED);\n        virObjectEventStateQueue(driver->domainEventState, event);\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 1584
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_DEFINED",
            "VIR_DOMAIN_EVENT_DEFINED_ADDED"
          ],
          "line": 1581
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);\n\nstatic void lxcNotifyLoadDomain(virDomainObjPtr vm, int newVM, void *opaque)\n{\n    virLXCDriverPtr driver = opaque;\n\n    if (newVM) {\n        virObjectEventPtr event =\n            virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_DEFINED,\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED);\n        virObjectEventStateQueue(driver->domainEventState, event);\n    }\n}"
  },
  {
    "function_name": "lxcStateInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1465-1573",
    "snippet": "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virLXCDriverConfigPtr cfg = NULL;\n    bool autostart = true;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    /* Check that the user is root, silently disable if not */\n    if (!privileged) {\n        VIR_INFO(\"Not running privileged, disabling driver\");\n        return VIR_DRV_STATE_INIT_SKIPPED;\n    }\n\n    /* Check that this is a container enabled kernel */\n    if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_MNT |\n                                     VIR_PROCESS_NAMESPACE_PID |\n                                     VIR_PROCESS_NAMESPACE_UTS |\n                                     VIR_PROCESS_NAMESPACE_IPC) < 0) {\n        VIR_INFO(\"LXC support not available in this kernel, disabling driver\");\n        return VIR_DRV_STATE_INIT_SKIPPED;\n    }\n\n    if (VIR_ALLOC(lxc_driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n    lxc_driver->lockFD = -1;\n    if (virMutexInit(&lxc_driver->lock) < 0) {\n        VIR_FREE(lxc_driver);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if (!(lxc_driver->domains = virDomainObjListNew()))\n        goto cleanup;\n\n    lxc_driver->domainEventState = virObjectEventStateNew();\n    if (!lxc_driver->domainEventState)\n        goto cleanup;\n\n    lxc_driver->hostsysinfo = virSysinfoRead();\n\n    if (!(lxc_driver->config = cfg = virLXCDriverConfigNew()))\n        goto cleanup;\n\n    cfg->log_libvirtd = 0; /* by default log to container logfile */\n    cfg->have_netns = lxcCheckNetNsSupport();\n\n    /* Call function to load lxc driver configuration information */\n    if (virLXCLoadDriverConfig(cfg, SYSCONFDIR \"/libvirt/lxc.conf\") < 0)\n        goto cleanup;\n\n    if (!(lxc_driver->securityManager = lxcSecurityInit(cfg)))\n        goto cleanup;\n\n    if (!(lxc_driver->hostdevMgr = virHostdevManagerGetDefault()))\n        goto cleanup;\n\n    if (!(lxc_driver->xmlopt = lxcDomainXMLConfInit(lxc_driver)))\n        goto cleanup;\n\n    if (!(lxc_driver->closeCallbacks = virCloseCallbacksNew()))\n        goto cleanup;\n\n    if (virFileMakePath(cfg->stateDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mkdir %s\"),\n                             cfg->stateDir);\n        goto cleanup;\n    }\n\n    if ((lxc_driver->lockFD =\n         virPidFileAcquire(cfg->stateDir, \"driver\", false, getpid())) < 0)\n        goto cleanup;\n\n    /* Get all the running persistent or transient configs first */\n    if (virDomainObjListLoadAllConfigs(lxc_driver->domains,\n                                       cfg->stateDir,\n                                       NULL, true,\n                                       lxc_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    virLXCProcessReconnectAll(lxc_driver, lxc_driver->domains);\n\n    /* Then inactive persistent configs */\n    if (virDomainObjListLoadAllConfigs(lxc_driver->domains,\n                                       cfg->configDir,\n                                       cfg->autostartDir, false,\n                                       lxc_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    if (virDriverShouldAutostart(cfg->stateDir, &autostart) < 0)\n        goto cleanup;\n\n    if (autostart)\n        virLXCProcessAutostartAll(lxc_driver);\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n cleanup:\n    lxcStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);",
      "static int lxcStateCleanup(void);",
      "virLXCDriverPtr lxc_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcStateCleanup",
          "args": [],
          "line": 1571
        },
        "resolved": true,
        "details": {
          "function_name": "lxcStateCleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1613-1638",
          "snippet": "static int lxcStateCleanup(void)\n{\n    if (lxc_driver == NULL)\n        return -1;\n\n    virObjectUnref(lxc_driver->domains);\n    virObjectUnref(lxc_driver->domainEventState);\n\n    virObjectUnref(lxc_driver->closeCallbacks);\n\n    virSysinfoDefFree(lxc_driver->hostsysinfo);\n\n    virObjectUnref(lxc_driver->hostdevMgr);\n    virObjectUnref(lxc_driver->caps);\n    virObjectUnref(lxc_driver->securityManager);\n    virObjectUnref(lxc_driver->xmlopt);\n\n    if (lxc_driver->lockFD != -1)\n        virPidFileRelease(lxc_driver->config->stateDir, \"driver\", lxc_driver->lockFD);\n\n    virObjectUnref(lxc_driver->config);\n    virMutexDestroy(&lxc_driver->lock);\n    VIR_FREE(lxc_driver);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int lxcStateCleanup(void);",
            "virLXCDriverPtr lxc_driver = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateCleanup(void);\nvirLXCDriverPtr lxc_driver = NULL;\n\nstatic int lxcStateCleanup(void)\n{\n    if (lxc_driver == NULL)\n        return -1;\n\n    virObjectUnref(lxc_driver->domains);\n    virObjectUnref(lxc_driver->domainEventState);\n\n    virObjectUnref(lxc_driver->closeCallbacks);\n\n    virSysinfoDefFree(lxc_driver->hostsysinfo);\n\n    virObjectUnref(lxc_driver->hostdevMgr);\n    virObjectUnref(lxc_driver->caps);\n    virObjectUnref(lxc_driver->securityManager);\n    virObjectUnref(lxc_driver->xmlopt);\n\n    if (lxc_driver->lockFD != -1)\n        virPidFileRelease(lxc_driver->config->stateDir, \"driver\", lxc_driver->lockFD);\n\n    virObjectUnref(lxc_driver->config);\n    virMutexDestroy(&lxc_driver->lock);\n    VIR_FREE(lxc_driver);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessAutostartAll",
          "args": [
            "lxc_driver"
          ],
          "line": 1566
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessAutostartAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "1611-1629",
          "snippet": "void\nvirLXCProcessAutostartAll(virLXCDriverPtr driver)\n{\n    /* XXX: Figure out a better way todo this. The domain\n     * startup code needs a connection handle in order\n     * to lookup the bridge associated with a virtual\n     * network\n     */\n    virConnectPtr conn = virConnectOpen(\"lxc:///system\");\n    /* Ignoring NULL conn which is mostly harmless here */\n\n    struct virLXCProcessAutostartData data = { driver, conn };\n\n    virDomainObjListForEach(driver->domains, false,\n                            virLXCProcessAutostartDomain,\n                            &data);\n\n    virObjectUnref(conn);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirLXCProcessAutostartAll(virLXCDriverPtr driver)\n{\n    /* XXX: Figure out a better way todo this. The domain\n     * startup code needs a connection handle in order\n     * to lookup the bridge associated with a virtual\n     * network\n     */\n    virConnectPtr conn = virConnectOpen(\"lxc:///system\");\n    /* Ignoring NULL conn which is mostly harmless here */\n\n    struct virLXCProcessAutostartData data = { driver, conn };\n\n    virDomainObjListForEach(driver->domains, false,\n                            virLXCProcessAutostartDomain,\n                            &data);\n\n    virObjectUnref(conn);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDriverShouldAutostart",
          "args": [
            "cfg->stateDir",
            "&autostart"
          ],
          "line": 1562
        },
        "resolved": true,
        "details": {
          "function_name": "virDriverShouldAutostart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/driver.c",
          "lines": "86-108",
          "snippet": "int\nvirDriverShouldAutostart(const char *dir,\n                         bool *autostart)\n{\n    g_autofree char *path = NULL;\n\n    *autostart = false;\n\n    path = g_strdup_printf(\"%s/autostarted\", dir);\n\n    if (virFileExists(path)) {\n        VIR_DEBUG(\"Autostart file %s exists, skipping autostart\", path);\n        return 0;\n    }\n\n    VIR_DEBUG(\"Autostart file %s does not exist, do autostart\", path);\n    *autostart = true;\n\n    if (virFileTouch(path, 0600) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "#include \"virmodule.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"driver.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n#include \"virmodule.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"driver.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirDriverShouldAutostart(const char *dir,\n                         bool *autostart)\n{\n    g_autofree char *path = NULL;\n\n    *autostart = false;\n\n    path = g_strdup_printf(\"%s/autostarted\", dir);\n\n    if (virFileExists(path)) {\n        VIR_DEBUG(\"Autostart file %s exists, skipping autostart\", path);\n        return 0;\n    }\n\n    VIR_DEBUG(\"Autostart file %s does not exist, do autostart\", path);\n    *autostart = true;\n\n    if (virFileTouch(path, 0600) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListLoadAllConfigs",
          "args": [
            "lxc_driver->domains",
            "cfg->configDir",
            "cfg->autostartDir",
            "false",
            "lxc_driver->xmlopt",
            "NULL",
            "NULL"
          ],
          "line": 1555
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "582-639",
          "snippet": "int\nvirDomainObjListLoadAllConfigs(virDomainObjListPtr doms,\n                               const char *configDir,\n                               const char *autostartDir,\n                               bool liveStatus,\n                               virDomainXMLOptionPtr xmlopt,\n                               virDomainLoadConfigNotify notify,\n                               void *opaque)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(doms);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virDomainObjPtr dom;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        if (liveStatus)\n            dom = virDomainObjListLoadStatus(doms,\n                                             configDir,\n                                             entry->d_name,\n                                             xmlopt,\n                                             notify,\n                                             opaque);\n        else\n            dom = virDomainObjListLoadConfig(doms,\n                                             xmlopt,\n                                             configDir,\n                                             autostartDir,\n                                             entry->d_name,\n                                             notify,\n                                             opaque);\n        if (dom) {\n            if (!liveStatus)\n                dom->persistent = 1;\n            virDomainObjEndAPI(&dom);\n        } else {\n            VIR_ERROR(_(\"Failed to load config for domain '%s'\"), entry->d_name);\n        }\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListLoadAllConfigs(virDomainObjListPtr doms,\n                               const char *configDir,\n                               const char *autostartDir,\n                               bool liveStatus,\n                               virDomainXMLOptionPtr xmlopt,\n                               virDomainLoadConfigNotify notify,\n                               void *opaque)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(doms);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virDomainObjPtr dom;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        if (liveStatus)\n            dom = virDomainObjListLoadStatus(doms,\n                                             configDir,\n                                             entry->d_name,\n                                             xmlopt,\n                                             notify,\n                                             opaque);\n        else\n            dom = virDomainObjListLoadConfig(doms,\n                                             xmlopt,\n                                             configDir,\n                                             autostartDir,\n                                             entry->d_name,\n                                             notify,\n                                             opaque);\n        if (dom) {\n            if (!liveStatus)\n                dom->persistent = 1;\n            virDomainObjEndAPI(&dom);\n        } else {\n            VIR_ERROR(_(\"Failed to load config for domain '%s'\"), entry->d_name);\n        }\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessReconnectAll",
          "args": [
            "lxc_driver",
            "lxc_driver->domains"
          ],
          "line": 1552
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessReconnectAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "1742-1747",
          "snippet": "int virLXCProcessReconnectAll(virLXCDriverPtr driver,\n                              virDomainObjListPtr doms)\n{\n    virDomainObjListForEach(doms, false, virLXCProcessReconnectDomain, driver);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virLXCProcessReconnectAll(virLXCDriverPtr driver,\n                              virDomainObjListPtr doms)\n{\n    virDomainObjListForEach(doms, false, virLXCProcessReconnectDomain, driver);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileAcquire",
          "args": [
            "cfg->stateDir",
            "\"driver\"",
            "false",
            "getpid()"
          ],
          "line": 1541
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileAcquire",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "413-427",
          "snippet": "int virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 1541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to mkdir %s\")",
            "cfg->stateDir"
          ],
          "line": 1534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to mkdir %s\""
          ],
          "line": 1535
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "cfg->stateDir"
          ],
          "line": 1533
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCloseCallbacksNew",
          "args": [],
          "line": 1530
        },
        "resolved": true,
        "details": {
          "function_name": "virCloseCallbacksNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/virclosecallbacks.c",
          "lines": "61-79",
          "snippet": "virCloseCallbacksPtr\nvirCloseCallbacksNew(void)\n{\n    virCloseCallbacksPtr closeCallbacks;\n\n    if (virCloseCallbacksInitialize() < 0)\n        return NULL;\n\n    if (!(closeCallbacks = virObjectLockableNew(virCloseCallbacksClass)))\n        return NULL;\n\n    closeCallbacks->list = virHashCreate(5, virHashValueFree);\n    if (!closeCallbacks->list) {\n        virObjectUnref(closeCallbacks);\n        return NULL;\n    }\n\n    return closeCallbacks;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virclosecallbacks.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virCloseCallbacksClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virclosecallbacks.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nstatic virClassPtr virCloseCallbacksClass;\n\nvirCloseCallbacksPtr\nvirCloseCallbacksNew(void)\n{\n    virCloseCallbacksPtr closeCallbacks;\n\n    if (virCloseCallbacksInitialize() < 0)\n        return NULL;\n\n    if (!(closeCallbacks = virObjectLockableNew(virCloseCallbacksClass)))\n        return NULL;\n\n    closeCallbacks->list = virHashCreate(5, virHashValueFree);\n    if (!closeCallbacks->list) {\n        virObjectUnref(closeCallbacks);\n        return NULL;\n    }\n\n    return closeCallbacks;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomainXMLConfInit",
          "args": [
            "lxc_driver"
          ],
          "line": 1527
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainXMLConfInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "216-224",
          "snippet": "virDomainXMLOptionPtr\nlxcDomainXMLConfInit(virLXCDriverPtr driver)\n{\n    virLXCDriverDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&virLXCDriverDomainDefParserConfig,\n                                 &virLXCDriverPrivateDataCallbacks,\n                                 &virLXCDriverDomainXMLNamespace,\n                                 NULL, NULL);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirDomainXMLOptionPtr\nlxcDomainXMLConfInit(virLXCDriverPtr driver)\n{\n    virLXCDriverDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&virLXCDriverDomainDefParserConfig,\n                                 &virLXCDriverPrivateDataCallbacks,\n                                 &virLXCDriverDomainXMLNamespace,\n                                 NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHostdevManagerGetDefault",
          "args": [],
          "line": 1524
        },
        "resolved": true,
        "details": {
          "function_name": "virHostdevManagerGetDefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/virhostdev.c",
          "lines": "203-210",
          "snippet": "virHostdevManagerPtr\nvirHostdevManagerGetDefault(void)\n{\n    if (virHostdevManagerInitialize() < 0)\n        return NULL;\n\n    return virObjectRef(manager);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhostdev.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHostdevManagerPtr manager;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virnetdev.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virhostdev.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virHostdevManagerPtr manager;\n\nvirHostdevManagerPtr\nvirHostdevManagerGetDefault(void)\n{\n    if (virHostdevManagerInitialize() < 0)\n        return NULL;\n\n    return virObjectRef(manager);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcSecurityInit",
          "args": [
            "cfg"
          ],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "lxcSecurityInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1439-1462",
          "snippet": "static virSecurityManagerPtr\nlxcSecurityInit(virLXCDriverConfigPtr cfg)\n{\n    unsigned int flags = VIR_SECURITY_MANAGER_PRIVILEGED;\n\n    VIR_INFO(\"lxcSecurityInit %s\", cfg->securityDriverName);\n\n    if (cfg->securityDefaultConfined)\n        flags |= VIR_SECURITY_MANAGER_DEFAULT_CONFINED;\n    if (cfg->securityRequireConfined)\n        flags |= VIR_SECURITY_MANAGER_REQUIRE_CONFINED;\n\n    virSecurityManagerPtr mgr = virSecurityManagerNew(cfg->securityDriverName,\n                                                      LXC_DRIVER_NAME, flags);\n    if (!mgr)\n        goto error;\n\n    return mgr;\n\n error:\n    VIR_ERROR(_(\"Failed to initialize security drivers\"));\n    virObjectUnref(mgr);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virSecurityManagerPtr\nlxcSecurityInit(virLXCDriverConfigPtr cfg)\n{\n    unsigned int flags = VIR_SECURITY_MANAGER_PRIVILEGED;\n\n    VIR_INFO(\"lxcSecurityInit %s\", cfg->securityDriverName);\n\n    if (cfg->securityDefaultConfined)\n        flags |= VIR_SECURITY_MANAGER_DEFAULT_CONFINED;\n    if (cfg->securityRequireConfined)\n        flags |= VIR_SECURITY_MANAGER_REQUIRE_CONFINED;\n\n    virSecurityManagerPtr mgr = virSecurityManagerNew(cfg->securityDriverName,\n                                                      LXC_DRIVER_NAME, flags);\n    if (!mgr)\n        goto error;\n\n    return mgr;\n\n error:\n    VIR_ERROR(_(\"Failed to initialize security drivers\"));\n    virObjectUnref(mgr);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCLoadDriverConfig",
          "args": [
            "cfg",
            "SYSCONFDIR \"/libvirt/lxc.conf\""
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCLoadDriverConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "250-277",
          "snippet": "int\nvirLXCLoadDriverConfig(virLXCDriverConfigPtr cfg,\n                       const char *filename)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    /* Avoid error from non-existent or unreadable file. */\n    if (access(filename, R_OK) == -1)\n        return 0;\n\n    conf = virConfReadFile(filename, 0);\n    if (!conf)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"log_with_libvirtd\", &cfg->log_libvirtd) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"security_driver\", &cfg->securityDriverName) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"security_default_confined\", &cfg->securityDefaultConfined) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"security_require_confined\", &cfg->securityRequireConfined) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirLXCLoadDriverConfig(virLXCDriverConfigPtr cfg,\n                       const char *filename)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    /* Avoid error from non-existent or unreadable file. */\n    if (access(filename, R_OK) == -1)\n        return 0;\n\n    conf = virConfReadFile(filename, 0);\n    if (!conf)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"log_with_libvirtd\", &cfg->log_libvirtd) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"security_driver\", &cfg->securityDriverName) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"security_default_confined\", &cfg->securityDefaultConfined) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"security_require_confined\", &cfg->securityRequireConfined) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcCheckNetNsSupport",
          "args": [],
          "line": 1515
        },
        "resolved": true,
        "details": {
          "function_name": "lxcCheckNetNsSupport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1424-1436",
          "snippet": "static int lxcCheckNetNsSupport(void)\n{\n    const char *argv[] = {\"ip\", \"link\", \"set\", \"lo\", \"netns\", \"-1\", NULL};\n    int ip_rc;\n\n    if (virRun(argv, &ip_rc) < 0 || ip_rc == 255)\n        return 0;\n\n    if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_NET) < 0)\n        return 0;\n\n    return 1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcCheckNetNsSupport(void)\n{\n    const char *argv[] = {\"ip\", \"link\", \"set\", \"lo\", \"netns\", \"-1\", NULL};\n    int ip_rc;\n\n    if (virRun(argv, &ip_rc) < 0 || ip_rc == 255)\n        return 0;\n\n    if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_NET) < 0)\n        return 0;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverConfigNew",
          "args": [],
          "line": 1511
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverConfigNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "227-248",
          "snippet": "virLXCDriverConfigPtr\nvirLXCDriverConfigNew(void)\n{\n    virLXCDriverConfigPtr cfg;\n\n    if (virLXCConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virLXCDriverConfigClass)))\n        return NULL;\n\n    cfg->securityDefaultConfined = false;\n    cfg->securityRequireConfined = false;\n\n    /* Set the container configuration directory */\n    cfg->configDir = g_strdup(LXC_CONFIG_DIR);\n    cfg->stateDir = g_strdup(LXC_STATE_DIR);\n    cfg->logDir = g_strdup(LXC_LOG_DIR);\n    cfg->autostartDir = g_strdup(LXC_AUTOSTART_DIR);\n\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virLXCDriverConfigClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virLXCDriverConfigClass;\n\nvirLXCDriverConfigPtr\nvirLXCDriverConfigNew(void)\n{\n    virLXCDriverConfigPtr cfg;\n\n    if (virLXCConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virLXCDriverConfigClass)))\n        return NULL;\n\n    cfg->securityDefaultConfined = false;\n    cfg->securityRequireConfined = false;\n\n    /* Set the container configuration directory */\n    cfg->configDir = g_strdup(LXC_CONFIG_DIR);\n    cfg->stateDir = g_strdup(LXC_STATE_DIR);\n    cfg->logDir = g_strdup(LXC_LOG_DIR);\n    cfg->autostartDir = g_strdup(LXC_AUTOSTART_DIR);\n\n    return cfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSysinfoRead",
          "args": [],
          "line": 1509
        },
        "resolved": true,
        "details": {
          "function_name": "virSysinfoRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsysinfo.c",
          "lines": "1188-1211",
          "snippet": "virSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}",
          "includes": [
            "#include \"virsysinfopriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virerror.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsysinfopriv.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"virsysinfo.h\"\n#include \"virerror.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirSysinfoDefPtr\nvirSysinfoRead(void)\n{\n#if defined(__powerpc__)\n    return virSysinfoReadPPC();\n#elif defined(__arm__) || defined(__aarch64__)\n    return virSysinfoReadARM();\n#elif defined(__s390__) || defined(__s390x__)\n    return virSysinfoReadS390();\n#elif !defined(WIN32) && \\\n    (defined(__x86_64__) || \\\n     defined(__i386__) || \\\n     defined(__amd64__))\n    return virSysinfoReadDMI();\n#else /* WIN32 || not supported arch */\n    /*\n     * this can probably be extracted from Windows using API or registry\n     * http://www.microsoft.com/whdc/system/platform/firmware/SMBIOS.mspx\n     */\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Host sysinfo extraction not supported on this platform\"));\n    return NULL;\n#endif /* WIN32 || not supported arch */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateNew",
          "args": [],
          "line": 1505
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "558-582",
          "snippet": "virObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventStateClass;",
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventStateClass;\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvirObjectEventStatePtr\nvirObjectEventStateNew(void)\n{\n    virObjectEventStatePtr state = NULL;\n\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n\n    if (!(state = virObjectLockableNew(virObjectEventStateClass)))\n        return NULL;\n\n    if (VIR_ALLOC(state->callbacks) < 0)\n        goto error;\n\n    if (!(state->queue = virObjectEventQueueNew()))\n        goto error;\n\n    state->timer = -1;\n\n    return state;\n\n error:\n    virObjectUnref(state);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListNew",
          "args": [],
          "line": 1502
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "68-85",
          "snippet": "virDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainObjListClass;\n\nvirDomainObjListPtr virDomainObjListNew(void)\n{\n    virDomainObjListPtr doms;\n\n    if (virDomainObjListInitialize() < 0)\n        return NULL;\n\n    if (!(doms = virObjectRWLockableNew(virDomainObjListClass)))\n        return NULL;\n\n    if (!(doms->objs = virHashCreate(50, virObjectFreeHashData)) ||\n        !(doms->objsName = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(doms);\n        return NULL;\n    }\n\n    return doms;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "lxc_driver"
          ],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexInit",
          "args": [
            "&lxc_driver->lock"
          ],
          "line": 1497
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "lxc_driver"
          ],
          "line": 1494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"LXC support not available in this kernel, disabling driver\""
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virProcessNamespaceAvailable",
          "args": [
            "VIR_PROCESS_NAMESPACE_MNT |\n                                     VIR_PROCESS_NAMESPACE_PID |\n                                     VIR_PROCESS_NAMESPACE_UTS |\n                                     VIR_PROCESS_NAMESPACE_IPC"
          ],
          "line": 1486
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessNamespaceAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1370-1376",
          "snippet": "int\nvirProcessNamespaceAvailable(unsigned int ns G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessNamespaceAvailable(unsigned int ns G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Not running privileged, disabling driver\""
          ],
          "line": 1481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Driver does not support embedded mode\")"
          ],
          "line": 1474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);\nstatic int lxcStateCleanup(void);\nvirLXCDriverPtr lxc_driver = NULL;\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback G_GNUC_UNUSED,\n                              void *opaque G_GNUC_UNUSED)\n{\n    virLXCDriverConfigPtr cfg = NULL;\n    bool autostart = true;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    /* Check that the user is root, silently disable if not */\n    if (!privileged) {\n        VIR_INFO(\"Not running privileged, disabling driver\");\n        return VIR_DRV_STATE_INIT_SKIPPED;\n    }\n\n    /* Check that this is a container enabled kernel */\n    if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_MNT |\n                                     VIR_PROCESS_NAMESPACE_PID |\n                                     VIR_PROCESS_NAMESPACE_UTS |\n                                     VIR_PROCESS_NAMESPACE_IPC) < 0) {\n        VIR_INFO(\"LXC support not available in this kernel, disabling driver\");\n        return VIR_DRV_STATE_INIT_SKIPPED;\n    }\n\n    if (VIR_ALLOC(lxc_driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n    lxc_driver->lockFD = -1;\n    if (virMutexInit(&lxc_driver->lock) < 0) {\n        VIR_FREE(lxc_driver);\n        return VIR_DRV_STATE_INIT_ERROR;\n    }\n\n    if (!(lxc_driver->domains = virDomainObjListNew()))\n        goto cleanup;\n\n    lxc_driver->domainEventState = virObjectEventStateNew();\n    if (!lxc_driver->domainEventState)\n        goto cleanup;\n\n    lxc_driver->hostsysinfo = virSysinfoRead();\n\n    if (!(lxc_driver->config = cfg = virLXCDriverConfigNew()))\n        goto cleanup;\n\n    cfg->log_libvirtd = 0; /* by default log to container logfile */\n    cfg->have_netns = lxcCheckNetNsSupport();\n\n    /* Call function to load lxc driver configuration information */\n    if (virLXCLoadDriverConfig(cfg, SYSCONFDIR \"/libvirt/lxc.conf\") < 0)\n        goto cleanup;\n\n    if (!(lxc_driver->securityManager = lxcSecurityInit(cfg)))\n        goto cleanup;\n\n    if (!(lxc_driver->hostdevMgr = virHostdevManagerGetDefault()))\n        goto cleanup;\n\n    if (!(lxc_driver->xmlopt = lxcDomainXMLConfInit(lxc_driver)))\n        goto cleanup;\n\n    if (!(lxc_driver->closeCallbacks = virCloseCallbacksNew()))\n        goto cleanup;\n\n    if (virFileMakePath(cfg->stateDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mkdir %s\"),\n                             cfg->stateDir);\n        goto cleanup;\n    }\n\n    if ((lxc_driver->lockFD =\n         virPidFileAcquire(cfg->stateDir, \"driver\", false, getpid())) < 0)\n        goto cleanup;\n\n    /* Get all the running persistent or transient configs first */\n    if (virDomainObjListLoadAllConfigs(lxc_driver->domains,\n                                       cfg->stateDir,\n                                       NULL, true,\n                                       lxc_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    virLXCProcessReconnectAll(lxc_driver, lxc_driver->domains);\n\n    /* Then inactive persistent configs */\n    if (virDomainObjListLoadAllConfigs(lxc_driver->domains,\n                                       cfg->configDir,\n                                       cfg->autostartDir, false,\n                                       lxc_driver->xmlopt,\n                                       NULL, NULL) < 0)\n        goto cleanup;\n\n    if (virDriverShouldAutostart(cfg->stateDir, &autostart) < 0)\n        goto cleanup;\n\n    if (autostart)\n        virLXCProcessAutostartAll(lxc_driver);\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n cleanup:\n    lxcStateCleanup();\n    return VIR_DRV_STATE_INIT_ERROR;\n}"
  },
  {
    "function_name": "lxcSecurityInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1439-1462",
    "snippet": "static virSecurityManagerPtr\nlxcSecurityInit(virLXCDriverConfigPtr cfg)\n{\n    unsigned int flags = VIR_SECURITY_MANAGER_PRIVILEGED;\n\n    VIR_INFO(\"lxcSecurityInit %s\", cfg->securityDriverName);\n\n    if (cfg->securityDefaultConfined)\n        flags |= VIR_SECURITY_MANAGER_DEFAULT_CONFINED;\n    if (cfg->securityRequireConfined)\n        flags |= VIR_SECURITY_MANAGER_REQUIRE_CONFINED;\n\n    virSecurityManagerPtr mgr = virSecurityManagerNew(cfg->securityDriverName,\n                                                      LXC_DRIVER_NAME, flags);\n    if (!mgr)\n        goto error;\n\n    return mgr;\n\n error:\n    VIR_ERROR(_(\"Failed to initialize security drivers\"));\n    virObjectUnref(mgr);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "mgr"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Failed to initialize security drivers\")"
          ],
          "line": 1459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to initialize security drivers\""
          ],
          "line": 1459
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerNew",
          "args": [
            "cfg->securityDriverName",
            "LXC_DRIVER_NAME",
            "flags"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "176-208",
          "snippet": "virSecurityManagerPtr\nvirSecurityManagerNew(const char *name,\n                      const char *virtDriver,\n                      unsigned int flags)\n{\n    virSecurityDriverPtr drv = virSecurityDriverLookup(name, virtDriver);\n    if (!drv)\n        return NULL;\n\n    /* driver \"none\" needs some special handling of *Confined bools */\n    if (STREQ(drv->name, \"none\")) {\n        if (flags & VIR_SECURITY_MANAGER_REQUIRE_CONFINED) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Security driver \\\"none\\\" cannot create confined guests\"));\n            return NULL;\n        }\n\n        if (flags & VIR_SECURITY_MANAGER_DEFAULT_CONFINED) {\n            if (name != NULL) {\n                VIR_WARN(\"Configured security driver \\\"none\\\" disables default\"\n                         \" policy to create confined guests\");\n            } else {\n                VIR_DEBUG(\"Auto-probed security driver is \\\"none\\\";\"\n                          \" confined guests will not be created\");\n            }\n            flags &= ~VIR_SECURITY_MANAGER_DEFAULT_CONFINED;\n        }\n    }\n\n    return virSecurityManagerNewDriver(drv,\n                                       virtDriver,\n                                       flags);\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirSecurityManagerPtr\nvirSecurityManagerNew(const char *name,\n                      const char *virtDriver,\n                      unsigned int flags)\n{\n    virSecurityDriverPtr drv = virSecurityDriverLookup(name, virtDriver);\n    if (!drv)\n        return NULL;\n\n    /* driver \"none\" needs some special handling of *Confined bools */\n    if (STREQ(drv->name, \"none\")) {\n        if (flags & VIR_SECURITY_MANAGER_REQUIRE_CONFINED) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Security driver \\\"none\\\" cannot create confined guests\"));\n            return NULL;\n        }\n\n        if (flags & VIR_SECURITY_MANAGER_DEFAULT_CONFINED) {\n            if (name != NULL) {\n                VIR_WARN(\"Configured security driver \\\"none\\\" disables default\"\n                         \" policy to create confined guests\");\n            } else {\n                VIR_DEBUG(\"Auto-probed security driver is \\\"none\\\";\"\n                          \" confined guests will not be created\");\n            }\n            flags &= ~VIR_SECURITY_MANAGER_DEFAULT_CONFINED;\n        }\n    }\n\n    return virSecurityManagerNewDriver(drv,\n                                       virtDriver,\n                                       flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"lxcSecurityInit %s\"",
            "cfg->securityDriverName"
          ],
          "line": 1444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virSecurityManagerPtr\nlxcSecurityInit(virLXCDriverConfigPtr cfg)\n{\n    unsigned int flags = VIR_SECURITY_MANAGER_PRIVILEGED;\n\n    VIR_INFO(\"lxcSecurityInit %s\", cfg->securityDriverName);\n\n    if (cfg->securityDefaultConfined)\n        flags |= VIR_SECURITY_MANAGER_DEFAULT_CONFINED;\n    if (cfg->securityRequireConfined)\n        flags |= VIR_SECURITY_MANAGER_REQUIRE_CONFINED;\n\n    virSecurityManagerPtr mgr = virSecurityManagerNew(cfg->securityDriverName,\n                                                      LXC_DRIVER_NAME, flags);\n    if (!mgr)\n        goto error;\n\n    return mgr;\n\n error:\n    VIR_ERROR(_(\"Failed to initialize security drivers\"));\n    virObjectUnref(mgr);\n    return NULL;\n}"
  },
  {
    "function_name": "lxcCheckNetNsSupport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1424-1436",
    "snippet": "static int lxcCheckNetNsSupport(void)\n{\n    const char *argv[] = {\"ip\", \"link\", \"set\", \"lo\", \"netns\", \"-1\", NULL};\n    int ip_rc;\n\n    if (virRun(argv, &ip_rc) < 0 || ip_rc == 255)\n        return 0;\n\n    if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_NET) < 0)\n        return 0;\n\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virProcessNamespaceAvailable",
          "args": [
            "VIR_PROCESS_NAMESPACE_NET"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessNamespaceAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "1370-1376",
          "snippet": "int\nvirProcessNamespaceAvailable(unsigned int ns G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessNamespaceAvailable(unsigned int ns G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Namespaces are not supported on this platform.\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "argv",
            "&ip_rc"
          ],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcCheckNetNsSupport(void)\n{\n    const char *argv[] = {\"ip\", \"link\", \"set\", \"lo\", \"netns\", \"-1\", NULL};\n    int ip_rc;\n\n    if (virRun(argv, &ip_rc) < 0 || ip_rc == 255)\n        return 0;\n\n    if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_NET) < 0)\n        return 0;\n\n    return 1;\n}"
  },
  {
    "function_name": "lxcDomainDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1418-1422",
    "snippet": "static int\nlxcDomainDestroy(virDomainPtr dom)\n{\n    return lxcDomainDestroyFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainDestroyFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 1421
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDestroyFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1367-1408",
          "snippet": "static int\nlxcDomainDestroyFlags(virDomainPtr dom,\n                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_DESTROY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    priv = vm->privateData;\n    ret = virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STOPPED,\n                                     VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n    priv->doneStopEvent = true;\n    virDomainAuditStop(vm, \"destroyed\");\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n    if (!vm->persistent)\n        virDomainObjListRemove(driver->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDestroyFlags(virDomainPtr dom,\n                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_DESTROY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    priv = vm->privateData;\n    ret = virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STOPPED,\n                                     VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n    priv->doneStopEvent = true;\n    virDomainAuditStop(vm, \"destroyed\");\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n    if (!vm->persistent)\n        virDomainObjListRemove(driver->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDestroy(virDomainPtr dom)\n{\n    return lxcDomainDestroyFlags(dom, 0);\n}"
  },
  {
    "function_name": "lxcDomainDestroyFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1367-1408",
    "snippet": "static int\nlxcDomainDestroyFlags(virDomainPtr dom,\n                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_DESTROY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    priv = vm->privateData;\n    ret = virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STOPPED,\n                                     VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n    priv->doneStopEvent = true;\n    virDomainAuditStop(vm, \"destroyed\");\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n    if (!vm->persistent)\n        virDomainObjListRemove(driver->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 1406
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 1402
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1400
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditStop",
          "args": [
            "vm",
            "\"destroyed\""
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditStop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "866-870",
          "snippet": "void\nvirDomainAuditStop(virDomainObjPtr vm, const char *reason)\n{\n    virDomainAuditLifecycle(vm, \"stop\", reason, true);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditStop(virDomainObjPtr vm, const char *reason)\n{\n    virDomainAuditLifecycle(vm, \"stop\", reason, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_STOPPED",
            "VIR_DOMAIN_EVENT_STOPPED_DESTROYED"
          ],
          "line": 1393
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessStop",
          "args": [
            "driver",
            "vm",
            "VIR_DOMAIN_SHUTOFF_DESTROYED"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessStop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "852-915",
          "snippet": "int virLXCProcessStop(virLXCDriverPtr driver,\n                      virDomainObjPtr vm,\n                      virDomainShutoffReason reason)\n{\n    int rc;\n    virLXCDomainObjPrivatePtr priv;\n\n    VIR_DEBUG(\"Stopping VM name=%s pid=%d reason=%d\",\n              vm->def->name, (int)vm->pid, (int)reason);\n    if (!virDomainObjIsActive(vm)) {\n        VIR_DEBUG(\"VM '%s' not active\", vm->def->name);\n        return 0;\n    }\n\n    priv = vm->privateData;\n\n    /* If the LXC domain is suspended we send all processes a SIGKILL\n     * and thaw them. Upon wakeup the process sees the pending signal\n     * and dies immediately. It is guaranteed that priv->cgroup != NULL\n     * here because the domain has aleady been suspended using the\n     * freezer cgroup.\n     */\n    if (reason == VIR_DOMAIN_SHUTOFF_DESTROYED &&\n        virDomainObjGetState(vm, NULL) == VIR_DOMAIN_PAUSED) {\n        if (virCgroupKillRecursive(priv->cgroup, SIGKILL) <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Unable to kill all processes\"));\n            return -1;\n        }\n\n        if (virCgroupSetFreezerState(priv->cgroup, \"THAWED\") < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"Unable to thaw all processes\"));\n\n            return -1;\n        }\n\n        goto cleanup;\n    }\n\n    if (priv->cgroup) {\n        rc = virCgroupKillPainfully(priv->cgroup);\n        if (rc < 0)\n            return -1;\n        if (rc > 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Some processes refused to die\"));\n            return -1;\n        }\n    } else if (vm->pid > 0) {\n        /* If cgroup doesn't exist, just try cleaning up the\n         * libvirt_lxc process */\n        if (virProcessKillPainfully(vm->pid, true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Processes %d refused to die\"), (int)vm->pid);\n            return -1;\n        }\n    }\n\n cleanup:\n    virLXCProcessCleanup(driver, vm, reason);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\nint virLXCProcessStop(virLXCDriverPtr driver,\n                      virDomainObjPtr vm,\n                      virDomainShutoffReason reason)\n{\n    int rc;\n    virLXCDomainObjPrivatePtr priv;\n\n    VIR_DEBUG(\"Stopping VM name=%s pid=%d reason=%d\",\n              vm->def->name, (int)vm->pid, (int)reason);\n    if (!virDomainObjIsActive(vm)) {\n        VIR_DEBUG(\"VM '%s' not active\", vm->def->name);\n        return 0;\n    }\n\n    priv = vm->privateData;\n\n    /* If the LXC domain is suspended we send all processes a SIGKILL\n     * and thaw them. Upon wakeup the process sees the pending signal\n     * and dies immediately. It is guaranteed that priv->cgroup != NULL\n     * here because the domain has aleady been suspended using the\n     * freezer cgroup.\n     */\n    if (reason == VIR_DOMAIN_SHUTOFF_DESTROYED &&\n        virDomainObjGetState(vm, NULL) == VIR_DOMAIN_PAUSED) {\n        if (virCgroupKillRecursive(priv->cgroup, SIGKILL) <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Unable to kill all processes\"));\n            return -1;\n        }\n\n        if (virCgroupSetFreezerState(priv->cgroup, \"THAWED\") < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED, \"%s\",\n                           _(\"Unable to thaw all processes\"));\n\n            return -1;\n        }\n\n        goto cleanup;\n    }\n\n    if (priv->cgroup) {\n        rc = virCgroupKillPainfully(priv->cgroup);\n        if (rc < 0)\n            return -1;\n        if (rc > 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Some processes refused to die\"));\n            return -1;\n        }\n    } else if (vm->pid > 0) {\n        /* If cgroup doesn't exist, just try cleaning up the\n         * libvirt_lxc process */\n        if (virProcessKillPainfully(vm->pid, true) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Processes %d refused to die\"), (int)vm->pid);\n            return -1;\n        }\n    }\n\n cleanup:\n    virLXCProcessCleanup(driver, vm, reason);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjCheckActive",
          "args": [
            "vm"
          ],
          "line": 1388
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjCheckActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "7294-7303",
          "snippet": "int\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjCheckActive(virDomainObjPtr dom)\n{\n    if (!virDomainObjIsActive(dom)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"domain is not running\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_DESTROY"
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDestroyFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1379
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainDestroyFlags(virDomainPtr dom,\n                      unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainDestroyFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_DESTROY) < 0)\n        goto cleanup;\n\n    if (virDomainObjCheckActive(vm) < 0)\n        goto endjob;\n\n    priv = vm->privateData;\n    ret = virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_DESTROYED);\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STOPPED,\n                                     VIR_DOMAIN_EVENT_STOPPED_DESTROYED);\n    priv->doneStopEvent = true;\n    virDomainAuditStop(vm, \"destroyed\");\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n    if (!vm->persistent)\n        virDomainObjListRemove(driver->domains, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    return ret;\n}"
  },
  {
    "function_name": "lxcConnectDomainEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1340-1355",
    "snippet": "static int\nlxcConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                   int callbackID)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectDomainEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        driver->domainEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectEventStateDeregisterID",
          "args": [
            "conn",
            "driver->domainEventState",
            "callbackID",
            "true"
          ],
          "line": 1349
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateDeregisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "936-957",
          "snippet": "int\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nint\nvirObjectEventStateDeregisterID(virConnectPtr conn,\n                                virObjectEventStatePtr state,\n                                int callbackID,\n                                bool doFreeCb)\n{\n    int ret;\n\n    virObjectLock(state);\n    if (state->isDispatching)\n        ret = virObjectEventCallbackListMarkDeleteID(conn,\n                                                     state->callbacks,\n                                                     callbackID);\n    else\n        ret = virObjectEventCallbackListRemoveID(conn, state->callbacks,\n                                                 callbackID, doFreeCb);\n\n    virObjectEventStateCleanupTimer(state, true);\n\n    virObjectUnlock(state);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventDeregisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                   int callbackID)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectDomainEventDeregisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virObjectEventStateDeregisterID(conn,\n                                        driver->domainEventState,\n                                        callbackID, true) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcConnectDomainEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1316-1337",
    "snippet": "static int\nlxcConnectDomainEventRegisterAny(virConnectPtr conn,\n                                 virDomainPtr dom,\n                                 int eventID,\n                                 virConnectDomainEventGenericCallback callback,\n                                 void *opaque,\n                                 virFreeCallback freecb)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    int ret;\n\n    if (virConnectDomainEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegisterID(conn,\n                                      driver->domainEventState,\n                                      dom, eventID,\n                                      callback, opaque, freecb, &ret) < 0)\n        ret = -1;\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainEventStateRegisterID",
          "args": [
            "conn",
            "driver->domainEventState",
            "dom",
            "eventID",
            "callback",
            "opaque",
            "freecb",
            "&ret"
          ],
          "line": 1330
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventStateRegisterID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "2036-2059",
          "snippet": "int\nvirDomainEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virDomainPtr dom,\n                              int eventID,\n                              virConnectDomainEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    if (dom)\n        virUUIDFormat(dom->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, dom ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virDomainEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainEventClass;\n\nint\nvirDomainEventStateRegisterID(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virDomainPtr dom,\n                              int eventID,\n                              virConnectDomainEventGenericCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb,\n                              int *callbackID)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    if (dom)\n        virUUIDFormat(dom->uuid, uuidstr);\n    return virObjectEventStateRegisterID(conn, state, dom ? uuidstr : NULL,\n                                         NULL, NULL,\n                                         virDomainEventClass, eventID,\n                                         VIR_OBJECT_EVENT_CALLBACK(cb),\n                                         opaque, freecb,\n                                         false, callbackID, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventRegisterAnyEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);\n\nstatic int\nlxcConnectDomainEventRegisterAny(virConnectPtr conn,\n                                 virDomainPtr dom,\n                                 int eventID,\n                                 virConnectDomainEventGenericCallback callback,\n                                 void *opaque,\n                                 virFreeCallback freecb)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    int ret;\n\n    if (virConnectDomainEventRegisterAnyEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegisterID(conn,\n                                      driver->domainEventState,\n                                      dom, eventID,\n                                      callback, opaque, freecb, &ret) < 0)\n        ret = -1;\n\n    return ret;\n}"
  },
  {
    "function_name": "lxcConnectDomainEventDeregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1298-1313",
    "snippet": "static int\nlxcConnectDomainEventDeregister(virConnectPtr conn,\n                                virConnectDomainEventCallback callback)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectDomainEventDeregisterEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateDeregister(conn,\n                                      driver->domainEventState,\n                                      callback) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainEventStateDeregister",
          "args": [
            "conn",
            "driver->domainEventState",
            "callback"
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventStateDeregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "2144-2159",
          "snippet": "int\nvirDomainEventStateDeregister(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virConnectDomainEventCallback cb)\n{\n    int callbackID;\n\n    callbackID = virObjectEventStateCallbackID(conn, state,\n                                               virDomainEventClass,\n                                               VIR_DOMAIN_EVENT_ID_LIFECYCLE,\n                                               VIR_OBJECT_EVENT_CALLBACK(cb),\n                                               NULL);\n    if (callbackID < 0)\n        return -1;\n    return virObjectEventStateDeregisterID(conn, state, callbackID, true);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainEventClass;\n\nint\nvirDomainEventStateDeregister(virConnectPtr conn,\n                              virObjectEventStatePtr state,\n                              virConnectDomainEventCallback cb)\n{\n    int callbackID;\n\n    callbackID = virObjectEventStateCallbackID(conn, state,\n                                               virDomainEventClass,\n                                               VIR_DOMAIN_EVENT_ID_LIFECYCLE,\n                                               VIR_OBJECT_EVENT_CALLBACK(cb),\n                                               NULL);\n    if (callbackID < 0)\n        return -1;\n    return virObjectEventStateDeregisterID(conn, state, callbackID, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventDeregisterEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcConnectDomainEventDeregister(virConnectPtr conn,\n                                virConnectDomainEventCallback callback)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectDomainEventDeregisterEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateDeregister(conn,\n                                      driver->domainEventState,\n                                      callback) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcConnectDomainEventRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1278-1295",
    "snippet": "static int\nlxcConnectDomainEventRegister(virConnectPtr conn,\n                              virConnectDomainEventCallback callback,\n                              void *opaque,\n                              virFreeCallback freecb)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectDomainEventRegisterEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegister(conn,\n                                    driver->domainEventState,\n                                    callback, opaque, freecb) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainEventStateRegister",
          "args": [
            "conn",
            "driver->domainEventState",
            "callback",
            "opaque",
            "freecb"
          ],
          "line": 1289
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventStateRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "1998-2016",
          "snippet": "int\nvirDomainEventStateRegister(virConnectPtr conn,\n                            virObjectEventStatePtr state,\n                            virConnectDomainEventCallback callback,\n                            void *opaque,\n                            virFreeCallback freecb)\n{\n    int callbackID;\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    return virObjectEventStateRegisterID(conn, state, NULL,\n                                         NULL, NULL, virDomainEventClass,\n                                         VIR_DOMAIN_EVENT_ID_LIFECYCLE,\n                                         VIR_OBJECT_EVENT_CALLBACK(callback),\n                                         opaque, freecb,\n                                         true, &callbackID, false);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainEventClass;\n\nint\nvirDomainEventStateRegister(virConnectPtr conn,\n                            virObjectEventStatePtr state,\n                            virConnectDomainEventCallback callback,\n                            void *opaque,\n                            virFreeCallback freecb)\n{\n    int callbackID;\n\n    if (virDomainEventsInitialize() < 0)\n        return -1;\n\n    return virObjectEventStateRegisterID(conn, state, NULL,\n                                         NULL, NULL, virDomainEventClass,\n                                         VIR_DOMAIN_EVENT_ID_LIFECYCLE,\n                                         VIR_OBJECT_EVENT_CALLBACK(callback),\n                                         opaque, freecb,\n                                         true, &callbackID, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectDomainEventRegisterEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcStateInitialize(bool privileged,\n                              const char *root,\n                              virStateInhibitCallback callback,\n                              void *opaque);\n\nstatic int\nlxcConnectDomainEventRegister(virConnectPtr conn,\n                              virConnectDomainEventCallback callback,\n                              void *opaque,\n                              virFreeCallback freecb)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectDomainEventRegisterEnsureACL(conn) < 0)\n        return -1;\n\n    if (virDomainEventStateRegister(conn,\n                                    driver->domainEventState,\n                                    callback, opaque, freecb) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "lxcNodeGetSecurityModel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1234-1275",
    "snippet": "static int lxcNodeGetSecurityModel(virConnectPtr conn,\n                                   virSecurityModelPtr secmodel)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virCapsPtr caps = NULL;\n    int ret = 0;\n\n    memset(secmodel, 0, sizeof(*secmodel));\n\n    if (virNodeGetSecurityModelEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    /* we treat no driver as success, but simply return no data in *secmodel */\n    if (caps->host.nsecModels == 0\n        || caps->host.secModels[0].model == NULL)\n        goto cleanup;\n\n    if (virStrcpy(secmodel->model, caps->host.secModels[0].model,\n                  VIR_SECURITY_MODEL_BUFLEN) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"security model string exceeds max %d bytes\"),\n                       VIR_SECURITY_MODEL_BUFLEN - 1);\n        ret = -1;\n        goto cleanup;\n    }\n\n    if (virStrcpy(secmodel->doi, caps->host.secModels[0].doi,\n                  VIR_SECURITY_DOI_BUFLEN) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"security DOI string exceeds max %d bytes\"),\n                       VIR_SECURITY_DOI_BUFLEN-1);\n        ret = -1;\n        goto cleanup;\n    }\n\n cleanup:\n    virObjectUnref(caps);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"security DOI string exceeds max %d bytes\")",
            "VIR_SECURITY_DOI_BUFLEN-1"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"security DOI string exceeds max %d bytes\""
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrcpy",
          "args": [
            "secmodel->doi",
            "caps->host.secModels[0].doi",
            "VIR_SECURITY_DOI_BUFLEN"
          ],
          "line": 1263
        },
        "resolved": true,
        "details": {
          "function_name": "virStrcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "780-784",
          "snippet": "int\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"security model string exceeds max %d bytes\")",
            "VIR_SECURITY_MODEL_BUFLEN - 1"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "false"
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNodeGetSecurityModelEnsureACL",
          "args": [
            "conn"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "secmodel",
            "0",
            "sizeof(*secmodel)"
          ],
          "line": 1241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcNodeGetSecurityModel(virConnectPtr conn,\n                                   virSecurityModelPtr secmodel)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virCapsPtr caps = NULL;\n    int ret = 0;\n\n    memset(secmodel, 0, sizeof(*secmodel));\n\n    if (virNodeGetSecurityModelEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    /* we treat no driver as success, but simply return no data in *secmodel */\n    if (caps->host.nsecModels == 0\n        || caps->host.secModels[0].model == NULL)\n        goto cleanup;\n\n    if (virStrcpy(secmodel->model, caps->host.secModels[0].model,\n                  VIR_SECURITY_MODEL_BUFLEN) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"security model string exceeds max %d bytes\"),\n                       VIR_SECURITY_MODEL_BUFLEN - 1);\n        ret = -1;\n        goto cleanup;\n    }\n\n    if (virStrcpy(secmodel->doi, caps->host.secModels[0].doi,\n                  VIR_SECURITY_DOI_BUFLEN) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"security DOI string exceeds max %d bytes\"),\n                       VIR_SECURITY_DOI_BUFLEN-1);\n        ret = -1;\n        goto cleanup;\n    }\n\n cleanup:\n    virObjectUnref(caps);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetSecurityLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1184-1232",
    "snippet": "static int lxcDomainGetSecurityLabel(virDomainPtr dom, virSecurityLabelPtr seclabel)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    memset(seclabel, 0, sizeof(*seclabel));\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetSecurityLabelEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    /*\n     * Theoretically, the pid can be replaced during this operation and\n     * return the label of a different process.  If atomicity is needed,\n     * further validation will be required.\n     *\n     * Comment from Dan Berrange:\n     *\n     *   Well the PID as stored in the virDomainObjPtr can't be changed\n     *   because you've got a locked object.  The OS level PID could have\n     *   exited, though and in extreme circumstances have cycled through all\n     *   PIDs back to ours. We could sanity check that our PID still exists\n     *   after reading the label, by checking that our FD connecting to the\n     *   LXC monitor hasn't seen SIGHUP/ERR on poll().\n     */\n    if (virDomainObjIsActive(vm)) {\n        virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n        if (!priv->initpid) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Init pid is not yet available\"));\n            goto cleanup;\n        }\n\n        if (virSecurityManagerGetProcessLabel(driver->securityManager,\n                                              vm->def, priv->initpid,\n                                              seclabel) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerGetProcessLabel",
          "args": [
            "driver->securityManager",
            "vm->def",
            "priv->initpid",
            "seclabel"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerGetProcessLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "899-915",
          "snippet": "int\nvirSecurityManagerGetProcessLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  pid_t pid,\n                                  virSecurityLabelPtr sec)\n{\n    if (mgr->drv->domainGetSecurityProcessLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainGetSecurityProcessLabel(mgr, vm, pid, sec);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerGetProcessLabel(virSecurityManagerPtr mgr,\n                                  virDomainDefPtr vm,\n                                  pid_t pid,\n                                  virSecurityLabelPtr sec)\n{\n    if (mgr->drv->domainGetSecurityProcessLabel) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainGetSecurityProcessLabel(mgr, vm, pid, sec);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Init pid is not yet available\")"
          ],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Init pid is not yet available\""
          ],
          "line": 1217
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetSecurityLabelEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "seclabel",
            "0",
            "sizeof(*seclabel)"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainGetSecurityLabel(virDomainPtr dom, virSecurityLabelPtr seclabel)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    memset(seclabel, 0, sizeof(*seclabel));\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetSecurityLabelEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    /*\n     * Theoretically, the pid can be replaced during this operation and\n     * return the label of a different process.  If atomicity is needed,\n     * further validation will be required.\n     *\n     * Comment from Dan Berrange:\n     *\n     *   Well the PID as stored in the virDomainObjPtr can't be changed\n     *   because you've got a locked object.  The OS level PID could have\n     *   exited, though and in extreme circumstances have cycled through all\n     *   PIDs back to ours. We could sanity check that our PID still exists\n     *   after reading the label, by checking that our FD connecting to the\n     *   LXC monitor hasn't seen SIGHUP/ERR on poll().\n     */\n    if (virDomainObjIsActive(vm)) {\n        virLXCDomainObjPrivatePtr priv = vm->privateData;\n\n        if (!priv->initpid) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Init pid is not yet available\"));\n            goto cleanup;\n        }\n\n        if (virSecurityManagerGetProcessLabel(driver->securityManager,\n                                              vm->def, priv->initpid,\n                                              seclabel) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1175-1181",
    "snippet": "static virDomainPtr\nlxcDomainCreateXML(virConnectPtr conn,\n                   const char *xml,\n                   unsigned int flags)\n{\n    return lxcDomainCreateXMLWithFiles(conn, xml, 0, NULL,  flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainCreateXMLWithFiles",
          "args": [
            "conn",
            "xml",
            "0",
            "NULL",
            "flags"
          ],
          "line": 1180
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainCreateXMLWithFiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "1076-1163",
          "snippet": "static virDomainPtr\nlxcDomainCreateXMLWithFiles(virConnectPtr conn,\n                            const char *xml,\n                            unsigned int nfiles,\n                            int *files,\n                            unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE, NULL);\n\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virDomainCreateXMLWithFilesEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0) {\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    if (virLXCProcessStart(conn, driver, vm,\n                           nfiles, files,\n                           (flags & VIR_DOMAIN_START_AUTODESTROY),\n                           VIR_DOMAIN_RUNNING_BOOTED) < 0) {\n        virDomainAuditStart(vm, \"booted\", false);\n        virLXCDomainObjEndJob(driver, vm);\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STARTED,\n                                     VIR_DOMAIN_EVENT_STARTED_BOOTED);\n    virDomainAuditStart(vm, \"booted\", true);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return dom;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nlxcDomainCreateXMLWithFiles(virConnectPtr conn,\n                            const char *xml,\n                            unsigned int nfiles,\n                            int *files,\n                            unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE, NULL);\n\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virDomainCreateXMLWithFilesEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0) {\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    if (virLXCProcessStart(conn, driver, vm,\n                           nfiles, files,\n                           (flags & VIR_DOMAIN_START_AUTODESTROY),\n                           VIR_DOMAIN_RUNNING_BOOTED) < 0) {\n        virDomainAuditStart(vm, \"booted\", false);\n        virLXCDomainObjEndJob(driver, vm);\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STARTED,\n                                     VIR_DOMAIN_EVENT_STARTED_BOOTED);\n    virDomainAuditStart(vm, \"booted\", true);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return dom;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nlxcDomainCreateXML(virConnectPtr conn,\n                   const char *xml,\n                   unsigned int flags)\n{\n    return lxcDomainCreateXMLWithFiles(conn, xml, 0, NULL,  flags);\n}"
  },
  {
    "function_name": "lxcDomainCreateXMLWithFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1076-1163",
    "snippet": "static virDomainPtr\nlxcDomainCreateXMLWithFiles(virConnectPtr conn,\n                            const char *xml,\n                            unsigned int nfiles,\n                            int *files,\n                            unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE, NULL);\n\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virDomainCreateXMLWithFilesEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0) {\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    if (virLXCProcessStart(conn, driver, vm,\n                           nfiles, files,\n                           (flags & VIR_DOMAIN_START_AUTODESTROY),\n                           VIR_DOMAIN_RUNNING_BOOTED) < 0) {\n        virDomainAuditStart(vm, \"booted\", false);\n        virLXCDomainObjEndJob(driver, vm);\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STARTED,\n                                     VIR_DOMAIN_EVENT_STARTED_BOOTED);\n    virDomainAuditStart(vm, \"booted\", true);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterUnlockFilterUpdates",
          "args": [],
          "line": 1161
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "174-178",
          "snippet": "void\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 1158
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditStart",
          "args": [
            "vm",
            "\"booted\"",
            "true"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "771-840",
          "snippet": "void\nvirDomainAuditStart(virDomainObjPtr vm, const char *reason, bool success)\n{\n    size_t i;\n\n    for (i = 0; i < vm->def->ndisks; i++)\n        virDomainAuditDisk(vm, NULL, vm->def->disks[i]->src, \"start\", true);\n\n    for (i = 0; i < vm->def->nfss; i++) {\n        virDomainFSDefPtr fs = vm->def->fss[i];\n        virDomainAuditFS(vm, NULL, fs, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n        virDomainAuditNet(vm, NULL, net, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = vm->def->hostdevs[i];\n        virDomainAuditHostdev(vm, hostdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nredirdevs; i++) {\n        virDomainRedirdevDefPtr redirdev = vm->def->redirdevs[i];\n        virDomainAuditRedirdev(vm, redirdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nserials; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->serials[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nparallels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->parallels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nchannels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->channels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (i == 0 &&\n            (vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_SERIAL ||\n             vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE) &&\n             vm->def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n            continue;\n\n        virDomainAuditChardev(vm, NULL, vm->def->consoles[i], \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nsmartcards; i++)\n        virDomainAuditSmartcard(vm, vm->def->smartcards[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nrngs; i++)\n        virDomainAuditRNG(vm, NULL, vm->def->rngs[i], \"start\", true);\n\n    if (vm->def->tpm)\n        virDomainAuditTPM(vm, vm->def->tpm, \"start\", true);\n\n    for (i = 0; i < vm->def->nshmems; i++)\n        virDomainAuditShmem(vm, vm->def->shmems[i], \"start\", true);\n\n    for (i = 0; i < vm->def->ninputs; i++)\n        virDomainAuditInput(vm, vm->def->inputs[i], \"start\", true);\n\n    virDomainAuditMemory(vm, 0, virDomainDefGetMemoryTotal(vm->def),\n                         \"start\", true);\n    virDomainAuditVcpu(vm, 0, virDomainDefGetVcpus(vm->def), \"start\", true);\n    if (vm->def->niothreadids)\n        virDomainAuditIOThread(vm, 0, vm->def->niothreadids, \"start\", true);\n\n    virDomainAuditLifecycle(vm, \"start\", reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditStart(virDomainObjPtr vm, const char *reason, bool success)\n{\n    size_t i;\n\n    for (i = 0; i < vm->def->ndisks; i++)\n        virDomainAuditDisk(vm, NULL, vm->def->disks[i]->src, \"start\", true);\n\n    for (i = 0; i < vm->def->nfss; i++) {\n        virDomainFSDefPtr fs = vm->def->fss[i];\n        virDomainAuditFS(vm, NULL, fs, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n        virDomainAuditNet(vm, NULL, net, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = vm->def->hostdevs[i];\n        virDomainAuditHostdev(vm, hostdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nredirdevs; i++) {\n        virDomainRedirdevDefPtr redirdev = vm->def->redirdevs[i];\n        virDomainAuditRedirdev(vm, redirdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nserials; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->serials[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nparallels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->parallels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nchannels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->channels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (i == 0 &&\n            (vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_SERIAL ||\n             vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE) &&\n             vm->def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n            continue;\n\n        virDomainAuditChardev(vm, NULL, vm->def->consoles[i], \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nsmartcards; i++)\n        virDomainAuditSmartcard(vm, vm->def->smartcards[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nrngs; i++)\n        virDomainAuditRNG(vm, NULL, vm->def->rngs[i], \"start\", true);\n\n    if (vm->def->tpm)\n        virDomainAuditTPM(vm, vm->def->tpm, \"start\", true);\n\n    for (i = 0; i < vm->def->nshmems; i++)\n        virDomainAuditShmem(vm, vm->def->shmems[i], \"start\", true);\n\n    for (i = 0; i < vm->def->ninputs; i++)\n        virDomainAuditInput(vm, vm->def->inputs[i], \"start\", true);\n\n    virDomainAuditMemory(vm, 0, virDomainDefGetMemoryTotal(vm->def),\n                         \"start\", true);\n    virDomainAuditVcpu(vm, 0, virDomainDefGetVcpus(vm->def), \"start\", true);\n    if (vm->def->niothreadids)\n        virDomainAuditIOThread(vm, 0, vm->def->niothreadids, \"start\", true);\n\n    virDomainAuditLifecycle(vm, \"start\", reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_STARTED",
            "VIR_DOMAIN_EVENT_STARTED_BOOTED"
          ],
          "line": 1146
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 1142
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessStart",
          "args": [
            "conn",
            "driver",
            "vm",
            "nfiles",
            "files",
            "(flags & VIR_DOMAIN_START_AUTODESTROY)",
            "VIR_DOMAIN_RUNNING_BOOTED"
          ],
          "line": 1135
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "1182-1573",
          "snippet": "int virLXCProcessStart(virConnectPtr conn,\n                       virLXCDriverPtr  driver,\n                       virDomainObjPtr vm,\n                       unsigned int nfiles, int *files,\n                       bool autoDestroy,\n                       virDomainRunningReason reason)\n{\n    int rc = -1, r;\n    size_t nttyFDs = 0;\n    int *ttyFDs = NULL;\n    size_t i;\n    char *logfile = NULL;\n    int logfd = -1;\n    VIR_AUTOSTRINGLIST veths = NULL;\n    int handshakefds[2] = { -1, -1 };\n    off_t pos = -1;\n    char ebuf[1024];\n    char *timestamp;\n    int nsInheritFDs[VIR_LXC_DOMAIN_NAMESPACE_LAST];\n    virCommandPtr cmd = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virCapsPtr caps = NULL;\n    virErrorPtr err = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCgroupPtr selfcgroup;\n    int status;\n    char *pidfile = NULL;\n\n    if (virCgroupNewSelf(&selfcgroup) < 0)\n        return -1;\n\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_CPUACCT)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'cpuacct' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'devices' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'memory' cgroups controller mount\"));\n        return -1;\n    }\n    virCgroupFree(&selfcgroup);\n\n    if (vm->def->nconsoles == 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"At least one PTY console is required\"));\n        return -1;\n    }\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (vm->def->consoles[i]->source->type != VIR_DOMAIN_CHR_TYPE_PTY) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only PTY console types are supported\"));\n            return -1;\n        }\n    }\n\n    if (virFileMakePath(cfg->logDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot create log directory '%s'\"),\n                             cfg->logDir);\n        return -1;\n    }\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    logfile = g_strdup_printf(\"%s/%s.log\", cfg->logDir, vm->def->name);\n\n    if (!(pidfile = virPidFileBuildPath(cfg->stateDir, vm->def->name)))\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    /* Do this up front, so any part of the startup process can add\n     * runtime state to vm->def that won't be persisted. This let's us\n     * report implicit runtime defaults in the XML, like vnc listen/socket\n     */\n    VIR_DEBUG(\"Setting current domain def as transient\");\n    if (virDomainObjSetDefTransient(driver->xmlopt, vm, NULL) < 0)\n        goto cleanup;\n\n    /* Run an early hook to set-up missing devices */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_PREPARE, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    if (virLXCProcessEnsureRootFS(vm) < 0)\n        goto cleanup;\n\n    /* Must be run before security labelling */\n    VIR_DEBUG(\"Preparing host devices\");\n    if (virLXCPrepareHostDevices(driver, vm->def) < 0)\n        goto cleanup;\n\n    /* Here we open all the PTYs we need on the host OS side.\n     * The LXC controller will open the guest OS side PTYs\n     * and forward I/O between them.\n     */\n    nttyFDs = vm->def->nconsoles;\n    if (VIR_ALLOC_N(ttyFDs, nttyFDs) < 0)\n        goto cleanup;\n    for (i = 0; i < vm->def->nconsoles; i++)\n        ttyFDs[i] = -1;\n\n    /* If you are using a SecurityDriver with dynamic labelling,\n       then generate a security label for isolation */\n    VIR_DEBUG(\"Generating domain security label (if required)\");\n\n    if (vm->def->nseclabels &&\n        vm->def->seclabels[0]->type == VIR_DOMAIN_SECLABEL_DEFAULT)\n        vm->def->seclabels[0]->type = VIR_DOMAIN_SECLABEL_NONE;\n\n    if (virSecurityManagerCheckAllLabel(driver->securityManager, vm->def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerGenLabel(driver->securityManager, vm->def) < 0) {\n        virDomainAuditSecurityLabel(vm, false);\n        goto cleanup;\n    }\n    virDomainAuditSecurityLabel(vm, true);\n\n    VIR_DEBUG(\"Setting domain security labels\");\n    if (virSecurityManagerSetAllLabel(driver->securityManager,\n                                      vm->def, NULL, false, false) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up consoles\");\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        char *ttyPath;\n\n        if (virFileOpenTty(&ttyFDs[i], &ttyPath, 1) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Failed to allocate tty\"));\n            goto cleanup;\n        }\n\n        VIR_FREE(vm->def->consoles[i]->source->data.file.path);\n        vm->def->consoles[i]->source->data.file.path = ttyPath;\n\n        VIR_FREE(vm->def->consoles[i]->info.alias);\n        vm->def->consoles[i]->info.alias = g_strdup_printf(\"console%zu\", i);\n    }\n\n    VIR_DEBUG(\"Setting up Interfaces\");\n    if (virLXCProcessSetupInterfaces(driver, vm->def, &veths) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up namespaces if any\");\n    if (virLXCProcessSetupNamespaces(driver, vm->def->namespaceData, nsInheritFDs) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Preparing to launch\");\n    if ((logfd = open(logfile, O_WRONLY | O_APPEND | O_CREAT,\n             S_IRUSR|S_IWUSR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to open '%s'\"),\n                             logfile);\n        goto cleanup;\n    }\n\n    if (virPipe(handshakefds) < 0)\n        goto cleanup;\n\n    if (!(cmd = virLXCProcessBuildControllerCmd(driver,\n                                                vm,\n                                                veths,\n                                                ttyFDs, nttyFDs,\n                                                nsInheritFDs,\n                                                files, nfiles,\n                                                handshakefds[1],\n                                                &logfd,\n                                                pidfile)))\n        goto cleanup;\n\n    /* now that we know it is about to start call the hook if present */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_START, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    /* Log timestamp */\n    if ((timestamp = virTimeStringNow()) == NULL)\n        goto cleanup;\n    if (safewrite(logfd, timestamp, strlen(timestamp)) < 0 ||\n        safewrite(logfd, START_POSTFIX, strlen(START_POSTFIX)) < 0) {\n        VIR_WARN(\"Unable to write timestamp to logfile: %s\",\n                 g_strerror(errno));\n    }\n    VIR_FREE(timestamp);\n\n    /* Log generated command line */\n    virCommandWriteArgLog(cmd, logfd);\n    if ((pos = lseek(logfd, 0, SEEK_END)) < 0)\n        VIR_WARN(\"Unable to seek to end of logfile: %s\",\n                 g_strerror(errno));\n\n    VIR_DEBUG(\"Launching container\");\n    virCommandRawStatus(cmd);\n    if (virCommandRun(cmd, &status) < 0)\n        goto cleanup;\n\n    if (status != 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf,\n                                       sizeof(ebuf)) <= 0) {\n            if (WIFEXITED(status))\n                g_snprintf(ebuf, sizeof(ebuf), _(\"unexpected exit status %d\"),\n                           WEXITSTATUS(status));\n            else\n                g_snprintf(ebuf, sizeof(ebuf), \"%s\", _(\"terminated abnormally\"));\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"guest failed to start: %s\"), ebuf);\n        goto cleanup;\n    }\n\n    /* It has started running, so get its pid */\n    if ((r = virPidFileReadPath(pidfile, &vm->pid)) < 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0)\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        else\n            virReportSystemError(-r,\n                                 _(\"Failed to read pid file %s\"),\n                                 pidfile);\n        goto cleanup;\n    }\n\n    priv->stopReason = VIR_DOMAIN_EVENT_STOPPED_FAILED;\n    priv->wantReboot = false;\n    vm->def->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, reason);\n    priv->doneStopEvent = false;\n\n    if (VIR_CLOSE(handshakefds[1]) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close handshake fd\"));\n        goto cleanup;\n    }\n\n    if (virCommandHandshakeWait(cmd) < 0)\n        goto cleanup;\n\n    /* Write domain status to disk for the controller to\n     * read when it starts */\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto cleanup;\n\n    /* Allow the child to exec the controller */\n    if (virCommandHandshakeNotify(cmd) < 0)\n        goto cleanup;\n\n    if (g_atomic_int_add(&driver->nactive, 1) == 0 && driver->inhibitCallback)\n        driver->inhibitCallback(true, driver->inhibitOpaque);\n\n    if (lxcContainerWaitForContinue(handshakefds[0]) < 0) {\n        char out[1024];\n\n        if (!(virLXCProcessReadLogOutput(vm, logfile, pos, out, 1024) < 0)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), out);\n        }\n\n        goto cleanup;\n    }\n\n    priv->machineName = virLXCDomainGetMachineName(vm->def, vm->pid);\n    if (!priv->machineName)\n        goto cleanup;\n\n    /* We know the cgroup must exist by this synchronization\n     * point so lets detect that first, since it gives us a\n     * more reliable way to kill everything off if something\n     * goes wrong from here onwards ... */\n    if (virCgroupNewDetectMachine(vm->def->name, \"lxc\",\n                                  vm->pid, -1, priv->machineName,\n                                  &priv->cgroup) < 0)\n        goto cleanup;\n\n    if (!priv->cgroup) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"No valid cgroup for machine %s\"),\n                       vm->def->name);\n        goto cleanup;\n    }\n\n    /* And we can get the first monitor connection now too */\n    if (!(priv->monitor = virLXCProcessConnectMonitor(driver, vm))) {\n        /* Intentionally overwrite the real monitor error message,\n         * since a better one is almost always found in the logs\n         */\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0) {\n            virResetLastError();\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        }\n        goto cleanup;\n    }\n\n    if (autoDestroy &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, lxcProcessAutoDestroy) < 0)\n        goto cleanup;\n\n    /* We don't need the temporary NIC names anymore, clear them */\n    virLXCProcessCleanInterfaces(vm->def);\n\n    /* finally we can call the 'started' hook script if any */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_STARTED, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    rc = 0;\n\n cleanup:\n    if (VIR_CLOSE(logfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close logfile\"));\n        rc = -1;\n    }\n    if (rc != 0) {\n        virErrorPreserveLast(&err);\n        virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_FAILED);\n    }\n    virCommandFree(cmd);\n    for (i = 0; i < nttyFDs; i++)\n        VIR_FORCE_CLOSE(ttyFDs[i]);\n    VIR_FREE(ttyFDs);\n    VIR_FORCE_CLOSE(handshakefds[0]);\n    VIR_FORCE_CLOSE(handshakefds[1]);\n    VIR_FREE(pidfile);\n    VIR_FREE(logfile);\n    virObjectUnref(cfg);\n    virObjectUnref(caps);\n\n    virErrorRestore(&err);\n\n    return rc;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define START_POSTFIX \": starting up\\n\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\n#define START_POSTFIX \": starting up\\n\"\n\nint virLXCProcessStart(virConnectPtr conn,\n                       virLXCDriverPtr  driver,\n                       virDomainObjPtr vm,\n                       unsigned int nfiles, int *files,\n                       bool autoDestroy,\n                       virDomainRunningReason reason)\n{\n    int rc = -1, r;\n    size_t nttyFDs = 0;\n    int *ttyFDs = NULL;\n    size_t i;\n    char *logfile = NULL;\n    int logfd = -1;\n    VIR_AUTOSTRINGLIST veths = NULL;\n    int handshakefds[2] = { -1, -1 };\n    off_t pos = -1;\n    char ebuf[1024];\n    char *timestamp;\n    int nsInheritFDs[VIR_LXC_DOMAIN_NAMESPACE_LAST];\n    virCommandPtr cmd = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virCapsPtr caps = NULL;\n    virErrorPtr err = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCgroupPtr selfcgroup;\n    int status;\n    char *pidfile = NULL;\n\n    if (virCgroupNewSelf(&selfcgroup) < 0)\n        return -1;\n\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_CPUACCT)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'cpuacct' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'devices' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'memory' cgroups controller mount\"));\n        return -1;\n    }\n    virCgroupFree(&selfcgroup);\n\n    if (vm->def->nconsoles == 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"At least one PTY console is required\"));\n        return -1;\n    }\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (vm->def->consoles[i]->source->type != VIR_DOMAIN_CHR_TYPE_PTY) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only PTY console types are supported\"));\n            return -1;\n        }\n    }\n\n    if (virFileMakePath(cfg->logDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot create log directory '%s'\"),\n                             cfg->logDir);\n        return -1;\n    }\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    logfile = g_strdup_printf(\"%s/%s.log\", cfg->logDir, vm->def->name);\n\n    if (!(pidfile = virPidFileBuildPath(cfg->stateDir, vm->def->name)))\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    /* Do this up front, so any part of the startup process can add\n     * runtime state to vm->def that won't be persisted. This let's us\n     * report implicit runtime defaults in the XML, like vnc listen/socket\n     */\n    VIR_DEBUG(\"Setting current domain def as transient\");\n    if (virDomainObjSetDefTransient(driver->xmlopt, vm, NULL) < 0)\n        goto cleanup;\n\n    /* Run an early hook to set-up missing devices */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_PREPARE, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    if (virLXCProcessEnsureRootFS(vm) < 0)\n        goto cleanup;\n\n    /* Must be run before security labelling */\n    VIR_DEBUG(\"Preparing host devices\");\n    if (virLXCPrepareHostDevices(driver, vm->def) < 0)\n        goto cleanup;\n\n    /* Here we open all the PTYs we need on the host OS side.\n     * The LXC controller will open the guest OS side PTYs\n     * and forward I/O between them.\n     */\n    nttyFDs = vm->def->nconsoles;\n    if (VIR_ALLOC_N(ttyFDs, nttyFDs) < 0)\n        goto cleanup;\n    for (i = 0; i < vm->def->nconsoles; i++)\n        ttyFDs[i] = -1;\n\n    /* If you are using a SecurityDriver with dynamic labelling,\n       then generate a security label for isolation */\n    VIR_DEBUG(\"Generating domain security label (if required)\");\n\n    if (vm->def->nseclabels &&\n        vm->def->seclabels[0]->type == VIR_DOMAIN_SECLABEL_DEFAULT)\n        vm->def->seclabels[0]->type = VIR_DOMAIN_SECLABEL_NONE;\n\n    if (virSecurityManagerCheckAllLabel(driver->securityManager, vm->def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerGenLabel(driver->securityManager, vm->def) < 0) {\n        virDomainAuditSecurityLabel(vm, false);\n        goto cleanup;\n    }\n    virDomainAuditSecurityLabel(vm, true);\n\n    VIR_DEBUG(\"Setting domain security labels\");\n    if (virSecurityManagerSetAllLabel(driver->securityManager,\n                                      vm->def, NULL, false, false) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up consoles\");\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        char *ttyPath;\n\n        if (virFileOpenTty(&ttyFDs[i], &ttyPath, 1) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Failed to allocate tty\"));\n            goto cleanup;\n        }\n\n        VIR_FREE(vm->def->consoles[i]->source->data.file.path);\n        vm->def->consoles[i]->source->data.file.path = ttyPath;\n\n        VIR_FREE(vm->def->consoles[i]->info.alias);\n        vm->def->consoles[i]->info.alias = g_strdup_printf(\"console%zu\", i);\n    }\n\n    VIR_DEBUG(\"Setting up Interfaces\");\n    if (virLXCProcessSetupInterfaces(driver, vm->def, &veths) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up namespaces if any\");\n    if (virLXCProcessSetupNamespaces(driver, vm->def->namespaceData, nsInheritFDs) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Preparing to launch\");\n    if ((logfd = open(logfile, O_WRONLY | O_APPEND | O_CREAT,\n             S_IRUSR|S_IWUSR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to open '%s'\"),\n                             logfile);\n        goto cleanup;\n    }\n\n    if (virPipe(handshakefds) < 0)\n        goto cleanup;\n\n    if (!(cmd = virLXCProcessBuildControllerCmd(driver,\n                                                vm,\n                                                veths,\n                                                ttyFDs, nttyFDs,\n                                                nsInheritFDs,\n                                                files, nfiles,\n                                                handshakefds[1],\n                                                &logfd,\n                                                pidfile)))\n        goto cleanup;\n\n    /* now that we know it is about to start call the hook if present */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_START, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    /* Log timestamp */\n    if ((timestamp = virTimeStringNow()) == NULL)\n        goto cleanup;\n    if (safewrite(logfd, timestamp, strlen(timestamp)) < 0 ||\n        safewrite(logfd, START_POSTFIX, strlen(START_POSTFIX)) < 0) {\n        VIR_WARN(\"Unable to write timestamp to logfile: %s\",\n                 g_strerror(errno));\n    }\n    VIR_FREE(timestamp);\n\n    /* Log generated command line */\n    virCommandWriteArgLog(cmd, logfd);\n    if ((pos = lseek(logfd, 0, SEEK_END)) < 0)\n        VIR_WARN(\"Unable to seek to end of logfile: %s\",\n                 g_strerror(errno));\n\n    VIR_DEBUG(\"Launching container\");\n    virCommandRawStatus(cmd);\n    if (virCommandRun(cmd, &status) < 0)\n        goto cleanup;\n\n    if (status != 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf,\n                                       sizeof(ebuf)) <= 0) {\n            if (WIFEXITED(status))\n                g_snprintf(ebuf, sizeof(ebuf), _(\"unexpected exit status %d\"),\n                           WEXITSTATUS(status));\n            else\n                g_snprintf(ebuf, sizeof(ebuf), \"%s\", _(\"terminated abnormally\"));\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"guest failed to start: %s\"), ebuf);\n        goto cleanup;\n    }\n\n    /* It has started running, so get its pid */\n    if ((r = virPidFileReadPath(pidfile, &vm->pid)) < 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0)\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        else\n            virReportSystemError(-r,\n                                 _(\"Failed to read pid file %s\"),\n                                 pidfile);\n        goto cleanup;\n    }\n\n    priv->stopReason = VIR_DOMAIN_EVENT_STOPPED_FAILED;\n    priv->wantReboot = false;\n    vm->def->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, reason);\n    priv->doneStopEvent = false;\n\n    if (VIR_CLOSE(handshakefds[1]) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close handshake fd\"));\n        goto cleanup;\n    }\n\n    if (virCommandHandshakeWait(cmd) < 0)\n        goto cleanup;\n\n    /* Write domain status to disk for the controller to\n     * read when it starts */\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto cleanup;\n\n    /* Allow the child to exec the controller */\n    if (virCommandHandshakeNotify(cmd) < 0)\n        goto cleanup;\n\n    if (g_atomic_int_add(&driver->nactive, 1) == 0 && driver->inhibitCallback)\n        driver->inhibitCallback(true, driver->inhibitOpaque);\n\n    if (lxcContainerWaitForContinue(handshakefds[0]) < 0) {\n        char out[1024];\n\n        if (!(virLXCProcessReadLogOutput(vm, logfile, pos, out, 1024) < 0)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), out);\n        }\n\n        goto cleanup;\n    }\n\n    priv->machineName = virLXCDomainGetMachineName(vm->def, vm->pid);\n    if (!priv->machineName)\n        goto cleanup;\n\n    /* We know the cgroup must exist by this synchronization\n     * point so lets detect that first, since it gives us a\n     * more reliable way to kill everything off if something\n     * goes wrong from here onwards ... */\n    if (virCgroupNewDetectMachine(vm->def->name, \"lxc\",\n                                  vm->pid, -1, priv->machineName,\n                                  &priv->cgroup) < 0)\n        goto cleanup;\n\n    if (!priv->cgroup) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"No valid cgroup for machine %s\"),\n                       vm->def->name);\n        goto cleanup;\n    }\n\n    /* And we can get the first monitor connection now too */\n    if (!(priv->monitor = virLXCProcessConnectMonitor(driver, vm))) {\n        /* Intentionally overwrite the real monitor error message,\n         * since a better one is almost always found in the logs\n         */\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0) {\n            virResetLastError();\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        }\n        goto cleanup;\n    }\n\n    if (autoDestroy &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, lxcProcessAutoDestroy) < 0)\n        goto cleanup;\n\n    /* We don't need the temporary NIC names anymore, clear them */\n    virLXCProcessCleanInterfaces(vm->def);\n\n    /* finally we can call the 'started' hook script if any */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_STARTED, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    rc = 0;\n\n cleanup:\n    if (VIR_CLOSE(logfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close logfile\"));\n        rc = -1;\n    }\n    if (rc != 0) {\n        virErrorPreserveLast(&err);\n        virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_FAILED);\n    }\n    virCommandFree(cmd);\n    for (i = 0; i < nttyFDs; i++)\n        VIR_FORCE_CLOSE(ttyFDs[i]);\n    VIR_FREE(ttyFDs);\n    VIR_FORCE_CLOSE(handshakefds[0]);\n    VIR_FORCE_CLOSE(handshakefds[1]);\n    VIR_FREE(pidfile);\n    VIR_FREE(logfile);\n    virObjectUnref(cfg);\n    virObjectUnref(caps);\n\n    virErrorRestore(&err);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "driver->domains",
            "def",
            "driver->xmlopt",
            "VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE",
            "NULL"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"System lacks NETNS support\")"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"System lacks NETNS support\""
          ],
          "line": 1116
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerVerify",
          "args": [
            "driver->securityManager",
            "def"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerVerify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "948-975",
          "snippet": "int\nvirSecurityManagerVerify(virSecurityManagerPtr mgr,\n                         virDomainDefPtr def)\n{\n    virSecurityLabelDefPtr secdef;\n\n    if (mgr == NULL || mgr->drv == NULL)\n        return 0;\n\n    /* NULL model == dynamic labelling, with whatever driver\n     * is active, so we can short circuit verify check to\n     * avoid drivers de-referencing NULLs by accident\n     */\n    secdef = virDomainDefGetSecurityLabelDef(def, mgr->drv->name);\n    if (secdef == NULL || secdef->model == NULL)\n        return 0;\n\n    if (mgr->drv->domainSecurityVerify) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSecurityVerify(mgr, def);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerVerify(virSecurityManagerPtr mgr,\n                         virDomainDefPtr def)\n{\n    virSecurityLabelDefPtr secdef;\n\n    if (mgr == NULL || mgr->drv == NULL)\n        return 0;\n\n    /* NULL model == dynamic labelling, with whatever driver\n     * is active, so we can short circuit verify check to\n     * avoid drivers de-referencing NULLs by accident\n     */\n    secdef = virDomainDefGetSecurityLabelDef(def, mgr->drv->name);\n    if (secdef == NULL || secdef->model == NULL)\n        return 0;\n\n    if (mgr->drv->domainSecurityVerify) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSecurityVerify(mgr, def);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCreateXMLWithFilesEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "driver->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "false"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterReadLockFilterUpdates",
          "args": [],
          "line": 1099
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterReadLockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "160-164",
          "snippet": "void\nvirNWFilterReadLockFilterUpdates(void)\n{\n    virRWLockRead(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterReadLockFilterUpdates(void)\n{\n    virRWLockRead(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE",
            "NULL"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nlxcDomainCreateXMLWithFiles(virConnectPtr conn,\n                            const char *xml,\n                            unsigned int nfiles,\n                            int *files,\n                            unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY |\n                  VIR_DOMAIN_START_VALIDATE, NULL);\n\n\n    if (flags & VIR_DOMAIN_START_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virDomainCreateXMLWithFilesEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   VIR_DOMAIN_OBJ_LIST_ADD_LIVE |\n                                   VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE,\n                                   NULL)))\n        goto cleanup;\n    def = NULL;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0) {\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    if (virLXCProcessStart(conn, driver, vm,\n                           nfiles, files,\n                           (flags & VIR_DOMAIN_START_AUTODESTROY),\n                           VIR_DOMAIN_RUNNING_BOOTED) < 0) {\n        virDomainAuditStart(vm, \"booted\", false);\n        virLXCDomainObjEndJob(driver, vm);\n        if (!vm->persistent)\n            virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_STARTED,\n                                     VIR_DOMAIN_EVENT_STARTED_BOOTED);\n    virDomainAuditStart(vm, \"booted\", true);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return dom;\n}"
  },
  {
    "function_name": "lxcDomainCreateWithFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1058-1062",
    "snippet": "static int lxcDomainCreateWithFlags(virDomainPtr dom,\n                                    unsigned int flags)\n{\n    return lxcDomainCreateWithFiles(dom, 0, NULL, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainCreateWithFiles",
          "args": [
            "dom",
            "0",
            "NULL",
            "flags"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainCreateWithFiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "976-1035",
          "snippet": "static int lxcDomainCreateWithFiles(virDomainPtr dom,\n                                    unsigned int nfiles,\n                                    int *files,\n                                    unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFilesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((vm->def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto endjob;\n    }\n\n    ret = virLXCProcessStart(dom->conn, driver, vm,\n                             nfiles, files,\n                             (flags & VIR_DOMAIN_START_AUTODESTROY),\n                             VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (ret == 0) {\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_STARTED,\n                                         VIR_DOMAIN_EVENT_STARTED_BOOTED);\n        virDomainAuditStart(vm, \"booted\", true);\n    } else {\n        virDomainAuditStart(vm, \"booted\", false);\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainCreateWithFiles(virDomainPtr dom,\n                                    unsigned int nfiles,\n                                    int *files,\n                                    unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFilesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((vm->def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto endjob;\n    }\n\n    ret = virLXCProcessStart(dom->conn, driver, vm,\n                             nfiles, files,\n                             (flags & VIR_DOMAIN_START_AUTODESTROY),\n                             VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (ret == 0) {\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_STARTED,\n                                         VIR_DOMAIN_EVENT_STARTED_BOOTED);\n        virDomainAuditStart(vm, \"booted\", true);\n    } else {\n        virDomainAuditStart(vm, \"booted\", false);\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainCreateWithFlags(virDomainPtr dom,\n                                    unsigned int flags)\n{\n    return lxcDomainCreateWithFiles(dom, 0, NULL, flags);\n}"
  },
  {
    "function_name": "lxcDomainCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "1045-1048",
    "snippet": "static int lxcDomainCreate(virDomainPtr dom)\n{\n    return lxcDomainCreateWithFiles(dom, 0, NULL, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainCreateWithFiles",
          "args": [
            "dom",
            "0",
            "NULL",
            "0"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainCreateWithFiles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "976-1035",
          "snippet": "static int lxcDomainCreateWithFiles(virDomainPtr dom,\n                                    unsigned int nfiles,\n                                    int *files,\n                                    unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFilesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((vm->def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto endjob;\n    }\n\n    ret = virLXCProcessStart(dom->conn, driver, vm,\n                             nfiles, files,\n                             (flags & VIR_DOMAIN_START_AUTODESTROY),\n                             VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (ret == 0) {\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_STARTED,\n                                         VIR_DOMAIN_EVENT_STARTED_BOOTED);\n        virDomainAuditStart(vm, \"booted\", true);\n    } else {\n        virDomainAuditStart(vm, \"booted\", false);\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainCreateWithFiles(virDomainPtr dom,\n                                    unsigned int nfiles,\n                                    int *files,\n                                    unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFilesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((vm->def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto endjob;\n    }\n\n    ret = virLXCProcessStart(dom->conn, driver, vm,\n                             nfiles, files,\n                             (flags & VIR_DOMAIN_START_AUTODESTROY),\n                             VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (ret == 0) {\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_STARTED,\n                                         VIR_DOMAIN_EVENT_STARTED_BOOTED);\n        virDomainAuditStart(vm, \"booted\", true);\n    } else {\n        virDomainAuditStart(vm, \"booted\", false);\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainCreate(virDomainPtr dom)\n{\n    return lxcDomainCreateWithFiles(dom, 0, NULL, 0);\n}"
  },
  {
    "function_name": "lxcDomainCreateWithFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "976-1035",
    "snippet": "static int lxcDomainCreateWithFiles(virDomainPtr dom,\n                                    unsigned int nfiles,\n                                    int *files,\n                                    unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFilesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((vm->def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto endjob;\n    }\n\n    ret = virLXCProcessStart(dom->conn, driver, vm,\n                             nfiles, files,\n                             (flags & VIR_DOMAIN_START_AUTODESTROY),\n                             VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (ret == 0) {\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_STARTED,\n                                         VIR_DOMAIN_EVENT_STARTED_BOOTED);\n        virDomainAuditStart(vm, \"booted\", true);\n    } else {\n        virDomainAuditStart(vm, \"booted\", false);\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterUnlockFilterUpdates",
          "args": [],
          "line": 1033
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "174-178",
          "snippet": "void\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 1032
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 1031
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditStart",
          "args": [
            "vm",
            "\"booted\"",
            "false"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "771-840",
          "snippet": "void\nvirDomainAuditStart(virDomainObjPtr vm, const char *reason, bool success)\n{\n    size_t i;\n\n    for (i = 0; i < vm->def->ndisks; i++)\n        virDomainAuditDisk(vm, NULL, vm->def->disks[i]->src, \"start\", true);\n\n    for (i = 0; i < vm->def->nfss; i++) {\n        virDomainFSDefPtr fs = vm->def->fss[i];\n        virDomainAuditFS(vm, NULL, fs, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n        virDomainAuditNet(vm, NULL, net, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = vm->def->hostdevs[i];\n        virDomainAuditHostdev(vm, hostdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nredirdevs; i++) {\n        virDomainRedirdevDefPtr redirdev = vm->def->redirdevs[i];\n        virDomainAuditRedirdev(vm, redirdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nserials; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->serials[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nparallels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->parallels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nchannels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->channels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (i == 0 &&\n            (vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_SERIAL ||\n             vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE) &&\n             vm->def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n            continue;\n\n        virDomainAuditChardev(vm, NULL, vm->def->consoles[i], \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nsmartcards; i++)\n        virDomainAuditSmartcard(vm, vm->def->smartcards[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nrngs; i++)\n        virDomainAuditRNG(vm, NULL, vm->def->rngs[i], \"start\", true);\n\n    if (vm->def->tpm)\n        virDomainAuditTPM(vm, vm->def->tpm, \"start\", true);\n\n    for (i = 0; i < vm->def->nshmems; i++)\n        virDomainAuditShmem(vm, vm->def->shmems[i], \"start\", true);\n\n    for (i = 0; i < vm->def->ninputs; i++)\n        virDomainAuditInput(vm, vm->def->inputs[i], \"start\", true);\n\n    virDomainAuditMemory(vm, 0, virDomainDefGetMemoryTotal(vm->def),\n                         \"start\", true);\n    virDomainAuditVcpu(vm, 0, virDomainDefGetVcpus(vm->def), \"start\", true);\n    if (vm->def->niothreadids)\n        virDomainAuditIOThread(vm, 0, vm->def->niothreadids, \"start\", true);\n\n    virDomainAuditLifecycle(vm, \"start\", reason, success);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditStart(virDomainObjPtr vm, const char *reason, bool success)\n{\n    size_t i;\n\n    for (i = 0; i < vm->def->ndisks; i++)\n        virDomainAuditDisk(vm, NULL, vm->def->disks[i]->src, \"start\", true);\n\n    for (i = 0; i < vm->def->nfss; i++) {\n        virDomainFSDefPtr fs = vm->def->fss[i];\n        virDomainAuditFS(vm, NULL, fs, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nnets; i++) {\n        virDomainNetDefPtr net = vm->def->nets[i];\n        virDomainAuditNet(vm, NULL, net, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nhostdevs; i++) {\n        virDomainHostdevDefPtr hostdev = vm->def->hostdevs[i];\n        virDomainAuditHostdev(vm, hostdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nredirdevs; i++) {\n        virDomainRedirdevDefPtr redirdev = vm->def->redirdevs[i];\n        virDomainAuditRedirdev(vm, redirdev, \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nserials; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->serials[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nparallels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->parallels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nchannels; i++)\n        virDomainAuditChardev(vm, NULL, vm->def->channels[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (i == 0 &&\n            (vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_SERIAL ||\n             vm->def->consoles[i]->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE) &&\n             vm->def->os.type == VIR_DOMAIN_OSTYPE_HVM)\n            continue;\n\n        virDomainAuditChardev(vm, NULL, vm->def->consoles[i], \"start\", true);\n    }\n\n    for (i = 0; i < vm->def->nsmartcards; i++)\n        virDomainAuditSmartcard(vm, vm->def->smartcards[i], \"start\", true);\n\n    for (i = 0; i < vm->def->nrngs; i++)\n        virDomainAuditRNG(vm, NULL, vm->def->rngs[i], \"start\", true);\n\n    if (vm->def->tpm)\n        virDomainAuditTPM(vm, vm->def->tpm, \"start\", true);\n\n    for (i = 0; i < vm->def->nshmems; i++)\n        virDomainAuditShmem(vm, vm->def->shmems[i], \"start\", true);\n\n    for (i = 0; i < vm->def->ninputs; i++)\n        virDomainAuditInput(vm, vm->def->inputs[i], \"start\", true);\n\n    virDomainAuditMemory(vm, 0, virDomainDefGetMemoryTotal(vm->def),\n                         \"start\", true);\n    virDomainAuditVcpu(vm, 0, virDomainDefGetVcpus(vm->def), \"start\", true);\n    if (vm->def->niothreadids)\n        virDomainAuditIOThread(vm, 0, vm->def->niothreadids, \"start\", true);\n\n    virDomainAuditLifecycle(vm, \"start\", reason, success);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_STARTED",
            "VIR_DOMAIN_EVENT_STARTED_BOOTED"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCProcessStart",
          "args": [
            "dom->conn",
            "driver",
            "vm",
            "nfiles",
            "files",
            "(flags & VIR_DOMAIN_START_AUTODESTROY)",
            "VIR_DOMAIN_RUNNING_BOOTED"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCProcessStart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_process.c",
          "lines": "1182-1573",
          "snippet": "int virLXCProcessStart(virConnectPtr conn,\n                       virLXCDriverPtr  driver,\n                       virDomainObjPtr vm,\n                       unsigned int nfiles, int *files,\n                       bool autoDestroy,\n                       virDomainRunningReason reason)\n{\n    int rc = -1, r;\n    size_t nttyFDs = 0;\n    int *ttyFDs = NULL;\n    size_t i;\n    char *logfile = NULL;\n    int logfd = -1;\n    VIR_AUTOSTRINGLIST veths = NULL;\n    int handshakefds[2] = { -1, -1 };\n    off_t pos = -1;\n    char ebuf[1024];\n    char *timestamp;\n    int nsInheritFDs[VIR_LXC_DOMAIN_NAMESPACE_LAST];\n    virCommandPtr cmd = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virCapsPtr caps = NULL;\n    virErrorPtr err = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCgroupPtr selfcgroup;\n    int status;\n    char *pidfile = NULL;\n\n    if (virCgroupNewSelf(&selfcgroup) < 0)\n        return -1;\n\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_CPUACCT)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'cpuacct' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'devices' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'memory' cgroups controller mount\"));\n        return -1;\n    }\n    virCgroupFree(&selfcgroup);\n\n    if (vm->def->nconsoles == 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"At least one PTY console is required\"));\n        return -1;\n    }\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (vm->def->consoles[i]->source->type != VIR_DOMAIN_CHR_TYPE_PTY) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only PTY console types are supported\"));\n            return -1;\n        }\n    }\n\n    if (virFileMakePath(cfg->logDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot create log directory '%s'\"),\n                             cfg->logDir);\n        return -1;\n    }\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    logfile = g_strdup_printf(\"%s/%s.log\", cfg->logDir, vm->def->name);\n\n    if (!(pidfile = virPidFileBuildPath(cfg->stateDir, vm->def->name)))\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    /* Do this up front, so any part of the startup process can add\n     * runtime state to vm->def that won't be persisted. This let's us\n     * report implicit runtime defaults in the XML, like vnc listen/socket\n     */\n    VIR_DEBUG(\"Setting current domain def as transient\");\n    if (virDomainObjSetDefTransient(driver->xmlopt, vm, NULL) < 0)\n        goto cleanup;\n\n    /* Run an early hook to set-up missing devices */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_PREPARE, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    if (virLXCProcessEnsureRootFS(vm) < 0)\n        goto cleanup;\n\n    /* Must be run before security labelling */\n    VIR_DEBUG(\"Preparing host devices\");\n    if (virLXCPrepareHostDevices(driver, vm->def) < 0)\n        goto cleanup;\n\n    /* Here we open all the PTYs we need on the host OS side.\n     * The LXC controller will open the guest OS side PTYs\n     * and forward I/O between them.\n     */\n    nttyFDs = vm->def->nconsoles;\n    if (VIR_ALLOC_N(ttyFDs, nttyFDs) < 0)\n        goto cleanup;\n    for (i = 0; i < vm->def->nconsoles; i++)\n        ttyFDs[i] = -1;\n\n    /* If you are using a SecurityDriver with dynamic labelling,\n       then generate a security label for isolation */\n    VIR_DEBUG(\"Generating domain security label (if required)\");\n\n    if (vm->def->nseclabels &&\n        vm->def->seclabels[0]->type == VIR_DOMAIN_SECLABEL_DEFAULT)\n        vm->def->seclabels[0]->type = VIR_DOMAIN_SECLABEL_NONE;\n\n    if (virSecurityManagerCheckAllLabel(driver->securityManager, vm->def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerGenLabel(driver->securityManager, vm->def) < 0) {\n        virDomainAuditSecurityLabel(vm, false);\n        goto cleanup;\n    }\n    virDomainAuditSecurityLabel(vm, true);\n\n    VIR_DEBUG(\"Setting domain security labels\");\n    if (virSecurityManagerSetAllLabel(driver->securityManager,\n                                      vm->def, NULL, false, false) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up consoles\");\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        char *ttyPath;\n\n        if (virFileOpenTty(&ttyFDs[i], &ttyPath, 1) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Failed to allocate tty\"));\n            goto cleanup;\n        }\n\n        VIR_FREE(vm->def->consoles[i]->source->data.file.path);\n        vm->def->consoles[i]->source->data.file.path = ttyPath;\n\n        VIR_FREE(vm->def->consoles[i]->info.alias);\n        vm->def->consoles[i]->info.alias = g_strdup_printf(\"console%zu\", i);\n    }\n\n    VIR_DEBUG(\"Setting up Interfaces\");\n    if (virLXCProcessSetupInterfaces(driver, vm->def, &veths) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up namespaces if any\");\n    if (virLXCProcessSetupNamespaces(driver, vm->def->namespaceData, nsInheritFDs) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Preparing to launch\");\n    if ((logfd = open(logfile, O_WRONLY | O_APPEND | O_CREAT,\n             S_IRUSR|S_IWUSR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to open '%s'\"),\n                             logfile);\n        goto cleanup;\n    }\n\n    if (virPipe(handshakefds) < 0)\n        goto cleanup;\n\n    if (!(cmd = virLXCProcessBuildControllerCmd(driver,\n                                                vm,\n                                                veths,\n                                                ttyFDs, nttyFDs,\n                                                nsInheritFDs,\n                                                files, nfiles,\n                                                handshakefds[1],\n                                                &logfd,\n                                                pidfile)))\n        goto cleanup;\n\n    /* now that we know it is about to start call the hook if present */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_START, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    /* Log timestamp */\n    if ((timestamp = virTimeStringNow()) == NULL)\n        goto cleanup;\n    if (safewrite(logfd, timestamp, strlen(timestamp)) < 0 ||\n        safewrite(logfd, START_POSTFIX, strlen(START_POSTFIX)) < 0) {\n        VIR_WARN(\"Unable to write timestamp to logfile: %s\",\n                 g_strerror(errno));\n    }\n    VIR_FREE(timestamp);\n\n    /* Log generated command line */\n    virCommandWriteArgLog(cmd, logfd);\n    if ((pos = lseek(logfd, 0, SEEK_END)) < 0)\n        VIR_WARN(\"Unable to seek to end of logfile: %s\",\n                 g_strerror(errno));\n\n    VIR_DEBUG(\"Launching container\");\n    virCommandRawStatus(cmd);\n    if (virCommandRun(cmd, &status) < 0)\n        goto cleanup;\n\n    if (status != 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf,\n                                       sizeof(ebuf)) <= 0) {\n            if (WIFEXITED(status))\n                g_snprintf(ebuf, sizeof(ebuf), _(\"unexpected exit status %d\"),\n                           WEXITSTATUS(status));\n            else\n                g_snprintf(ebuf, sizeof(ebuf), \"%s\", _(\"terminated abnormally\"));\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"guest failed to start: %s\"), ebuf);\n        goto cleanup;\n    }\n\n    /* It has started running, so get its pid */\n    if ((r = virPidFileReadPath(pidfile, &vm->pid)) < 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0)\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        else\n            virReportSystemError(-r,\n                                 _(\"Failed to read pid file %s\"),\n                                 pidfile);\n        goto cleanup;\n    }\n\n    priv->stopReason = VIR_DOMAIN_EVENT_STOPPED_FAILED;\n    priv->wantReboot = false;\n    vm->def->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, reason);\n    priv->doneStopEvent = false;\n\n    if (VIR_CLOSE(handshakefds[1]) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close handshake fd\"));\n        goto cleanup;\n    }\n\n    if (virCommandHandshakeWait(cmd) < 0)\n        goto cleanup;\n\n    /* Write domain status to disk for the controller to\n     * read when it starts */\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto cleanup;\n\n    /* Allow the child to exec the controller */\n    if (virCommandHandshakeNotify(cmd) < 0)\n        goto cleanup;\n\n    if (g_atomic_int_add(&driver->nactive, 1) == 0 && driver->inhibitCallback)\n        driver->inhibitCallback(true, driver->inhibitOpaque);\n\n    if (lxcContainerWaitForContinue(handshakefds[0]) < 0) {\n        char out[1024];\n\n        if (!(virLXCProcessReadLogOutput(vm, logfile, pos, out, 1024) < 0)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), out);\n        }\n\n        goto cleanup;\n    }\n\n    priv->machineName = virLXCDomainGetMachineName(vm->def, vm->pid);\n    if (!priv->machineName)\n        goto cleanup;\n\n    /* We know the cgroup must exist by this synchronization\n     * point so lets detect that first, since it gives us a\n     * more reliable way to kill everything off if something\n     * goes wrong from here onwards ... */\n    if (virCgroupNewDetectMachine(vm->def->name, \"lxc\",\n                                  vm->pid, -1, priv->machineName,\n                                  &priv->cgroup) < 0)\n        goto cleanup;\n\n    if (!priv->cgroup) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"No valid cgroup for machine %s\"),\n                       vm->def->name);\n        goto cleanup;\n    }\n\n    /* And we can get the first monitor connection now too */\n    if (!(priv->monitor = virLXCProcessConnectMonitor(driver, vm))) {\n        /* Intentionally overwrite the real monitor error message,\n         * since a better one is almost always found in the logs\n         */\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0) {\n            virResetLastError();\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        }\n        goto cleanup;\n    }\n\n    if (autoDestroy &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, lxcProcessAutoDestroy) < 0)\n        goto cleanup;\n\n    /* We don't need the temporary NIC names anymore, clear them */\n    virLXCProcessCleanInterfaces(vm->def);\n\n    /* finally we can call the 'started' hook script if any */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_STARTED, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    rc = 0;\n\n cleanup:\n    if (VIR_CLOSE(logfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close logfile\"));\n        rc = -1;\n    }\n    if (rc != 0) {\n        virErrorPreserveLast(&err);\n        virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_FAILED);\n    }\n    virCommandFree(cmd);\n    for (i = 0; i < nttyFDs; i++)\n        VIR_FORCE_CLOSE(ttyFDs[i]);\n    VIR_FREE(ttyFDs);\n    VIR_FORCE_CLOSE(handshakefds[0]);\n    VIR_FORCE_CLOSE(handshakefds[1]);\n    VIR_FREE(pidfile);\n    VIR_FREE(logfile);\n    virObjectUnref(cfg);\n    virObjectUnref(caps);\n\n    virErrorRestore(&err);\n\n    return rc;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virhook.h\"",
            "#include \"lxc_hostdev.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_audit.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virtime.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"datatypes.h\"",
            "#include \"lxc_fuse.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_process.h\"",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define START_POSTFIX \": starting up\\n\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virsystemd.h\"\n#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virhook.h\"\n#include \"lxc_hostdev.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"domain_audit.h\"\n#include \"viralloc.h\"\n#include \"domain_nwfilter.h\"\n#include \"virtime.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdev.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"datatypes.h\"\n#include \"lxc_fuse.h\"\n#include \"lxc_cgroup.h\"\n#include \"lxc_container.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_process.h\"\n#include <signal.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <config.h>\n\n#define START_POSTFIX \": starting up\\n\"\n\nint virLXCProcessStart(virConnectPtr conn,\n                       virLXCDriverPtr  driver,\n                       virDomainObjPtr vm,\n                       unsigned int nfiles, int *files,\n                       bool autoDestroy,\n                       virDomainRunningReason reason)\n{\n    int rc = -1, r;\n    size_t nttyFDs = 0;\n    int *ttyFDs = NULL;\n    size_t i;\n    char *logfile = NULL;\n    int logfd = -1;\n    VIR_AUTOSTRINGLIST veths = NULL;\n    int handshakefds[2] = { -1, -1 };\n    off_t pos = -1;\n    char ebuf[1024];\n    char *timestamp;\n    int nsInheritFDs[VIR_LXC_DOMAIN_NAMESPACE_LAST];\n    virCommandPtr cmd = NULL;\n    virLXCDomainObjPrivatePtr priv = vm->privateData;\n    virCapsPtr caps = NULL;\n    virErrorPtr err = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCgroupPtr selfcgroup;\n    int status;\n    char *pidfile = NULL;\n\n    if (virCgroupNewSelf(&selfcgroup) < 0)\n        return -1;\n\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_CPUACCT)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'cpuacct' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_DEVICES)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'devices' cgroups controller mount\"));\n        return -1;\n    }\n    if (!virCgroupHasController(selfcgroup,\n                                VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virCgroupFree(&selfcgroup);\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to find 'memory' cgroups controller mount\"));\n        return -1;\n    }\n    virCgroupFree(&selfcgroup);\n\n    if (vm->def->nconsoles == 0) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"At least one PTY console is required\"));\n        return -1;\n    }\n\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        if (vm->def->consoles[i]->source->type != VIR_DOMAIN_CHR_TYPE_PTY) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"Only PTY console types are supported\"));\n            return -1;\n        }\n    }\n\n    if (virFileMakePath(cfg->logDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot create log directory '%s'\"),\n                             cfg->logDir);\n        return -1;\n    }\n\n    if (!vm->def->resource) {\n        virDomainResourceDefPtr res;\n\n        if (VIR_ALLOC(res) < 0)\n            goto cleanup;\n\n        res->partition = g_strdup(\"/machine\");\n\n        vm->def->resource = res;\n    }\n\n    logfile = g_strdup_printf(\"%s/%s.log\", cfg->logDir, vm->def->name);\n\n    if (!(pidfile = virPidFileBuildPath(cfg->stateDir, vm->def->name)))\n        goto cleanup;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    /* Do this up front, so any part of the startup process can add\n     * runtime state to vm->def that won't be persisted. This let's us\n     * report implicit runtime defaults in the XML, like vnc listen/socket\n     */\n    VIR_DEBUG(\"Setting current domain def as transient\");\n    if (virDomainObjSetDefTransient(driver->xmlopt, vm, NULL) < 0)\n        goto cleanup;\n\n    /* Run an early hook to set-up missing devices */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_PREPARE, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    if (virLXCProcessEnsureRootFS(vm) < 0)\n        goto cleanup;\n\n    /* Must be run before security labelling */\n    VIR_DEBUG(\"Preparing host devices\");\n    if (virLXCPrepareHostDevices(driver, vm->def) < 0)\n        goto cleanup;\n\n    /* Here we open all the PTYs we need on the host OS side.\n     * The LXC controller will open the guest OS side PTYs\n     * and forward I/O between them.\n     */\n    nttyFDs = vm->def->nconsoles;\n    if (VIR_ALLOC_N(ttyFDs, nttyFDs) < 0)\n        goto cleanup;\n    for (i = 0; i < vm->def->nconsoles; i++)\n        ttyFDs[i] = -1;\n\n    /* If you are using a SecurityDriver with dynamic labelling,\n       then generate a security label for isolation */\n    VIR_DEBUG(\"Generating domain security label (if required)\");\n\n    if (vm->def->nseclabels &&\n        vm->def->seclabels[0]->type == VIR_DOMAIN_SECLABEL_DEFAULT)\n        vm->def->seclabels[0]->type = VIR_DOMAIN_SECLABEL_NONE;\n\n    if (virSecurityManagerCheckAllLabel(driver->securityManager, vm->def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerGenLabel(driver->securityManager, vm->def) < 0) {\n        virDomainAuditSecurityLabel(vm, false);\n        goto cleanup;\n    }\n    virDomainAuditSecurityLabel(vm, true);\n\n    VIR_DEBUG(\"Setting domain security labels\");\n    if (virSecurityManagerSetAllLabel(driver->securityManager,\n                                      vm->def, NULL, false, false) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up consoles\");\n    for (i = 0; i < vm->def->nconsoles; i++) {\n        char *ttyPath;\n\n        if (virFileOpenTty(&ttyFDs[i], &ttyPath, 1) < 0) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Failed to allocate tty\"));\n            goto cleanup;\n        }\n\n        VIR_FREE(vm->def->consoles[i]->source->data.file.path);\n        vm->def->consoles[i]->source->data.file.path = ttyPath;\n\n        VIR_FREE(vm->def->consoles[i]->info.alias);\n        vm->def->consoles[i]->info.alias = g_strdup_printf(\"console%zu\", i);\n    }\n\n    VIR_DEBUG(\"Setting up Interfaces\");\n    if (virLXCProcessSetupInterfaces(driver, vm->def, &veths) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Setting up namespaces if any\");\n    if (virLXCProcessSetupNamespaces(driver, vm->def->namespaceData, nsInheritFDs) < 0)\n        goto cleanup;\n\n    VIR_DEBUG(\"Preparing to launch\");\n    if ((logfd = open(logfile, O_WRONLY | O_APPEND | O_CREAT,\n             S_IRUSR|S_IWUSR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to open '%s'\"),\n                             logfile);\n        goto cleanup;\n    }\n\n    if (virPipe(handshakefds) < 0)\n        goto cleanup;\n\n    if (!(cmd = virLXCProcessBuildControllerCmd(driver,\n                                                vm,\n                                                veths,\n                                                ttyFDs, nttyFDs,\n                                                nsInheritFDs,\n                                                files, nfiles,\n                                                handshakefds[1],\n                                                &logfd,\n                                                pidfile)))\n        goto cleanup;\n\n    /* now that we know it is about to start call the hook if present */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_START, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    /* Log timestamp */\n    if ((timestamp = virTimeStringNow()) == NULL)\n        goto cleanup;\n    if (safewrite(logfd, timestamp, strlen(timestamp)) < 0 ||\n        safewrite(logfd, START_POSTFIX, strlen(START_POSTFIX)) < 0) {\n        VIR_WARN(\"Unable to write timestamp to logfile: %s\",\n                 g_strerror(errno));\n    }\n    VIR_FREE(timestamp);\n\n    /* Log generated command line */\n    virCommandWriteArgLog(cmd, logfd);\n    if ((pos = lseek(logfd, 0, SEEK_END)) < 0)\n        VIR_WARN(\"Unable to seek to end of logfile: %s\",\n                 g_strerror(errno));\n\n    VIR_DEBUG(\"Launching container\");\n    virCommandRawStatus(cmd);\n    if (virCommandRun(cmd, &status) < 0)\n        goto cleanup;\n\n    if (status != 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf,\n                                       sizeof(ebuf)) <= 0) {\n            if (WIFEXITED(status))\n                g_snprintf(ebuf, sizeof(ebuf), _(\"unexpected exit status %d\"),\n                           WEXITSTATUS(status));\n            else\n                g_snprintf(ebuf, sizeof(ebuf), \"%s\", _(\"terminated abnormally\"));\n        }\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"guest failed to start: %s\"), ebuf);\n        goto cleanup;\n    }\n\n    /* It has started running, so get its pid */\n    if ((r = virPidFileReadPath(pidfile, &vm->pid)) < 0) {\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0)\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        else\n            virReportSystemError(-r,\n                                 _(\"Failed to read pid file %s\"),\n                                 pidfile);\n        goto cleanup;\n    }\n\n    priv->stopReason = VIR_DOMAIN_EVENT_STOPPED_FAILED;\n    priv->wantReboot = false;\n    vm->def->id = vm->pid;\n    virDomainObjSetState(vm, VIR_DOMAIN_RUNNING, reason);\n    priv->doneStopEvent = false;\n\n    if (VIR_CLOSE(handshakefds[1]) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close handshake fd\"));\n        goto cleanup;\n    }\n\n    if (virCommandHandshakeWait(cmd) < 0)\n        goto cleanup;\n\n    /* Write domain status to disk for the controller to\n     * read when it starts */\n    if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto cleanup;\n\n    /* Allow the child to exec the controller */\n    if (virCommandHandshakeNotify(cmd) < 0)\n        goto cleanup;\n\n    if (g_atomic_int_add(&driver->nactive, 1) == 0 && driver->inhibitCallback)\n        driver->inhibitCallback(true, driver->inhibitOpaque);\n\n    if (lxcContainerWaitForContinue(handshakefds[0]) < 0) {\n        char out[1024];\n\n        if (!(virLXCProcessReadLogOutput(vm, logfile, pos, out, 1024) < 0)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), out);\n        }\n\n        goto cleanup;\n    }\n\n    priv->machineName = virLXCDomainGetMachineName(vm->def, vm->pid);\n    if (!priv->machineName)\n        goto cleanup;\n\n    /* We know the cgroup must exist by this synchronization\n     * point so lets detect that first, since it gives us a\n     * more reliable way to kill everything off if something\n     * goes wrong from here onwards ... */\n    if (virCgroupNewDetectMachine(vm->def->name, \"lxc\",\n                                  vm->pid, -1, priv->machineName,\n                                  &priv->cgroup) < 0)\n        goto cleanup;\n\n    if (!priv->cgroup) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"No valid cgroup for machine %s\"),\n                       vm->def->name);\n        goto cleanup;\n    }\n\n    /* And we can get the first monitor connection now too */\n    if (!(priv->monitor = virLXCProcessConnectMonitor(driver, vm))) {\n        /* Intentionally overwrite the real monitor error message,\n         * since a better one is almost always found in the logs\n         */\n        if (virLXCProcessReadLogOutput(vm, logfile, pos, ebuf, sizeof(ebuf)) > 0) {\n            virResetLastError();\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"guest failed to start: %s\"), ebuf);\n        }\n        goto cleanup;\n    }\n\n    if (autoDestroy &&\n        virCloseCallbacksSet(driver->closeCallbacks, vm,\n                             conn, lxcProcessAutoDestroy) < 0)\n        goto cleanup;\n\n    /* We don't need the temporary NIC names anymore, clear them */\n    virLXCProcessCleanInterfaces(vm->def);\n\n    /* finally we can call the 'started' hook script if any */\n    if (virHookPresent(VIR_HOOK_DRIVER_LXC)) {\n        char *xml = virDomainDefFormat(vm->def, driver->xmlopt, 0);\n        int hookret;\n\n        hookret = virHookCall(VIR_HOOK_DRIVER_LXC, vm->def->name,\n                              VIR_HOOK_LXC_OP_STARTED, VIR_HOOK_SUBOP_BEGIN,\n                              NULL, xml, NULL);\n        VIR_FREE(xml);\n\n        /*\n         * If the script raised an error abort the launch\n         */\n        if (hookret < 0)\n            goto cleanup;\n    }\n\n    rc = 0;\n\n cleanup:\n    if (VIR_CLOSE(logfd) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"could not close logfile\"));\n        rc = -1;\n    }\n    if (rc != 0) {\n        virErrorPreserveLast(&err);\n        virLXCProcessStop(driver, vm, VIR_DOMAIN_SHUTOFF_FAILED);\n    }\n    virCommandFree(cmd);\n    for (i = 0; i < nttyFDs; i++)\n        VIR_FORCE_CLOSE(ttyFDs[i]);\n    VIR_FREE(ttyFDs);\n    VIR_FORCE_CLOSE(handshakefds[0]);\n    VIR_FORCE_CLOSE(handshakefds[1]);\n    VIR_FREE(pidfile);\n    VIR_FREE(logfile);\n    virObjectUnref(cfg);\n    virObjectUnref(caps);\n\n    virErrorRestore(&err);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Domain is already running\")"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Domain is already running\""
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"System lacks NETNS support\")"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCreateWithFilesEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterReadLockFilterUpdates",
          "args": [],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterReadLockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "160-164",
          "snippet": "void\nvirNWFilterReadLockFilterUpdates(void)\n{\n    virRWLockRead(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterReadLockFilterUpdates(void)\n{\n    virRWLockRead(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_START_AUTODESTROY",
            "-1"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainCreateWithFiles(virDomainPtr dom,\n                                    unsigned int nfiles,\n                                    int *files,\n                                    unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(VIR_DOMAIN_START_AUTODESTROY, -1);\n\n    virNWFilterReadLockFilterUpdates();\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainCreateWithFilesEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if ((vm->def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjIsActive(vm)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Domain is already running\"));\n        goto endjob;\n    }\n\n    ret = virLXCProcessStart(dom->conn, driver, vm,\n                             nfiles, files,\n                             (flags & VIR_DOMAIN_START_AUTODESTROY),\n                             VIR_DOMAIN_RUNNING_BOOTED);\n\n    if (ret == 0) {\n        event = virDomainEventLifecycleNewFromObj(vm,\n                                         VIR_DOMAIN_EVENT_STARTED,\n                                         VIR_DOMAIN_EVENT_STARTED_BOOTED);\n        virDomainAuditStart(vm, \"booted\", true);\n    } else {\n        virDomainAuditStart(vm, \"booted\", false);\n    }\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    virNWFilterUnlockFilterUpdates();\n    return ret;\n}"
  },
  {
    "function_name": "lxcConnectDomainXMLFromNative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "935-965",
    "snippet": "static char *lxcConnectDomainXMLFromNative(virConnectPtr conn,\n                                           const char *nativeFormat,\n                                           const char *nativeConfig,\n                                           unsigned int flags)\n{\n    char *xml = NULL;\n    virDomainDefPtr def = NULL;\n    virLXCDriverPtr driver = conn->privateData;\n    virCapsPtr caps = virLXCDriverGetCapabilities(driver, false);\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectDomainXMLFromNativeEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (STRNEQ(nativeFormat, LXC_CONFIG_FORMAT)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        goto cleanup;\n    }\n\n    if (!(def = lxcParseConfigString(nativeConfig, caps, driver->xmlopt)))\n        goto cleanup;\n\n    xml = virDomainDefFormat(def, driver->xmlopt, 0);\n\n cleanup:\n    virObjectUnref(caps);\n    virDomainDefFree(def);\n    return xml;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "def",
            "driver->xmlopt",
            "0"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcParseConfigString",
          "args": [
            "nativeConfig",
            "caps",
            "driver->xmlopt"
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "lxcParseConfigString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_native.c",
          "lines": "1128-1250",
          "snippet": "virDomainDefPtr\nlxcParseConfigString(const char *config,\n                     virCapsPtr caps G_GNUC_UNUSED,\n                     virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr vmdef = NULL;\n    g_autoptr(virConf) properties = NULL;\n    g_autofree char *value = NULL;\n\n    if (!(properties = virConfReadString(config, VIR_CONF_FLAG_LXC_FORMAT)))\n        return NULL;\n\n    if (!(vmdef = virDomainDefNew()))\n        goto error;\n\n    if (virUUIDGenerate(vmdef->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate uuid\"));\n        goto error;\n    }\n\n    vmdef->id = -1;\n    virDomainDefSetMemoryTotal(vmdef, 64 * 1024);\n\n    vmdef->onReboot = VIR_DOMAIN_LIFECYCLE_ACTION_RESTART;\n    vmdef->onCrash = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->onPoweroff = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->virtType = VIR_DOMAIN_VIRT_LXC;\n\n    /* Value not handled by the LXC driver, setting to\n     * minimum required to make XML parsing pass */\n    if (virDomainDefSetVcpusMax(vmdef, 1, xmlopt) < 0)\n        goto error;\n\n    if (virDomainDefSetVcpus(vmdef, 1) < 0)\n        goto error;\n\n    vmdef->nfss = 0;\n    vmdef->os.type = VIR_DOMAIN_OSTYPE_EXE;\n\n    if (virConfGetValueString(properties, \"lxc.arch\", &value) > 0) {\n        virArch arch = virArchFromString(value);\n        if (arch == VIR_ARCH_NONE && STREQ(value, \"x86\"))\n            arch = VIR_ARCH_I686;\n        else if (arch == VIR_ARCH_NONE && STREQ(value, \"amd64\"))\n            arch = VIR_ARCH_X86_64;\n        vmdef->os.arch = arch;\n        VIR_FREE(value);\n    }\n\n    vmdef->os.init = g_strdup(\"/sbin/init\");\n\n    if (virConfGetValueString(properties, \"lxc.uts.name\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.utsname\", &value) <= 0)\n            goto error;\n    }\n\n    vmdef->name = g_strdup(value);\n\n    if (!vmdef->name)\n        vmdef->name = g_strdup(\"unnamed\");\n\n    if (lxcSetRootfs(vmdef, properties) < 0)\n        goto error;\n\n    /* LXC 3.0 uses \"lxc.mount.fstab\", while legacy used just \"lxc.mount\".\n     * In either case, generate the error to use \"lxc.mount.entry\" instead */\n    if (virConfGetValue(properties, \"lxc.mount.fstab\") ||\n        virConfGetValue(properties, \"lxc.mount\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"lxc.mount.fstab or lxc.mount found, use \"\n                         \"lxc.mount.entry lines instead\"));\n        goto error;\n    }\n\n    /* Loop over lxc.mount.entry to add filesystem devices for them */\n    if (virConfWalk(properties, lxcFstabWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* Network configuration */\n    if (lxcConvertNetworkSettings(vmdef, properties) < 0)\n        goto error;\n\n    /* Consoles */\n    if (lxcCreateConsoles(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.idmap or legacy lxc.id_map */\n    if (virConfWalk(properties, lxcIdmapWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* lxc.cgroup.memory.* */\n    if (lxcSetMemTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpu.* */\n    if (lxcSetCpuTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpuset.* */\n    if (lxcSetCpusetTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.blkio.* */\n    if (lxcSetBlkioTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cap.drop */\n    lxcSetCapDrop(vmdef, properties);\n\n    if (virDomainDefPostParse(vmdef, VIR_DOMAIN_DEF_PARSE_ABI_UPDATE,\n                              xmlopt, NULL) < 0)\n        goto error;\n\n    return vmdef;\n\n error:\n    virDomainDefFree(vmdef);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"util/virconf.h\"",
            "#include \"util/virstring.h\"",
            "#include \"util/virlog.h\"",
            "#include \"util/virfile.h\"",
            "#include \"util/viralloc.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_container.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"conf/domain_conf.h\"\n#include \"util/virconf.h\"\n#include \"util/virstring.h\"\n#include \"util/virlog.h\"\n#include \"util/virfile.h\"\n#include \"util/viralloc.h\"\n#include \"lxc_native.h\"\n#include \"lxc_container.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainDefPtr\nlxcParseConfigString(const char *config,\n                     virCapsPtr caps G_GNUC_UNUSED,\n                     virDomainXMLOptionPtr xmlopt)\n{\n    virDomainDefPtr vmdef = NULL;\n    g_autoptr(virConf) properties = NULL;\n    g_autofree char *value = NULL;\n\n    if (!(properties = virConfReadString(config, VIR_CONF_FLAG_LXC_FORMAT)))\n        return NULL;\n\n    if (!(vmdef = virDomainDefNew()))\n        goto error;\n\n    if (virUUIDGenerate(vmdef->uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"failed to generate uuid\"));\n        goto error;\n    }\n\n    vmdef->id = -1;\n    virDomainDefSetMemoryTotal(vmdef, 64 * 1024);\n\n    vmdef->onReboot = VIR_DOMAIN_LIFECYCLE_ACTION_RESTART;\n    vmdef->onCrash = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->onPoweroff = VIR_DOMAIN_LIFECYCLE_ACTION_DESTROY;\n    vmdef->virtType = VIR_DOMAIN_VIRT_LXC;\n\n    /* Value not handled by the LXC driver, setting to\n     * minimum required to make XML parsing pass */\n    if (virDomainDefSetVcpusMax(vmdef, 1, xmlopt) < 0)\n        goto error;\n\n    if (virDomainDefSetVcpus(vmdef, 1) < 0)\n        goto error;\n\n    vmdef->nfss = 0;\n    vmdef->os.type = VIR_DOMAIN_OSTYPE_EXE;\n\n    if (virConfGetValueString(properties, \"lxc.arch\", &value) > 0) {\n        virArch arch = virArchFromString(value);\n        if (arch == VIR_ARCH_NONE && STREQ(value, \"x86\"))\n            arch = VIR_ARCH_I686;\n        else if (arch == VIR_ARCH_NONE && STREQ(value, \"amd64\"))\n            arch = VIR_ARCH_X86_64;\n        vmdef->os.arch = arch;\n        VIR_FREE(value);\n    }\n\n    vmdef->os.init = g_strdup(\"/sbin/init\");\n\n    if (virConfGetValueString(properties, \"lxc.uts.name\", &value) <= 0) {\n        virResetLastError();\n\n        /* Check for pre LXC 3.0 legacy key */\n        if (virConfGetValueString(properties, \"lxc.utsname\", &value) <= 0)\n            goto error;\n    }\n\n    vmdef->name = g_strdup(value);\n\n    if (!vmdef->name)\n        vmdef->name = g_strdup(\"unnamed\");\n\n    if (lxcSetRootfs(vmdef, properties) < 0)\n        goto error;\n\n    /* LXC 3.0 uses \"lxc.mount.fstab\", while legacy used just \"lxc.mount\".\n     * In either case, generate the error to use \"lxc.mount.entry\" instead */\n    if (virConfGetValue(properties, \"lxc.mount.fstab\") ||\n        virConfGetValue(properties, \"lxc.mount\")) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"lxc.mount.fstab or lxc.mount found, use \"\n                         \"lxc.mount.entry lines instead\"));\n        goto error;\n    }\n\n    /* Loop over lxc.mount.entry to add filesystem devices for them */\n    if (virConfWalk(properties, lxcFstabWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* Network configuration */\n    if (lxcConvertNetworkSettings(vmdef, properties) < 0)\n        goto error;\n\n    /* Consoles */\n    if (lxcCreateConsoles(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.idmap or legacy lxc.id_map */\n    if (virConfWalk(properties, lxcIdmapWalkCallback, vmdef) < 0)\n        goto error;\n\n    /* lxc.cgroup.memory.* */\n    if (lxcSetMemTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpu.* */\n    if (lxcSetCpuTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.cpuset.* */\n    if (lxcSetCpusetTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cgroup.blkio.* */\n    if (lxcSetBlkioTune(vmdef, properties) < 0)\n        goto error;\n\n    /* lxc.cap.drop */\n    lxcSetCapDrop(vmdef, properties);\n\n    if (virDomainDefPostParse(vmdef, VIR_DOMAIN_DEF_PARSE_ABI_UPDATE,\n                              xmlopt, NULL) < 0)\n        goto error;\n\n    return vmdef;\n\n error:\n    virDomainDefFree(vmdef);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unsupported config type %s\")",
            "nativeFormat"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unsupported config type %s\""
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "nativeFormat",
            "LXC_CONFIG_FORMAT"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectDomainXMLFromNativeEnsureACL",
          "args": [
            "conn"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "false"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *lxcConnectDomainXMLFromNative(virConnectPtr conn,\n                                           const char *nativeFormat,\n                                           const char *nativeConfig,\n                                           unsigned int flags)\n{\n    char *xml = NULL;\n    virDomainDefPtr def = NULL;\n    virLXCDriverPtr driver = conn->privateData;\n    virCapsPtr caps = virLXCDriverGetCapabilities(driver, false);\n\n    virCheckFlags(0, NULL);\n\n    if (virConnectDomainXMLFromNativeEnsureACL(conn) < 0)\n        goto cleanup;\n\n    if (STRNEQ(nativeFormat, LXC_CONFIG_FORMAT)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"unsupported config type %s\"), nativeFormat);\n        goto cleanup;\n    }\n\n    if (!(def = lxcParseConfigString(nativeConfig, caps, driver->xmlopt)))\n        goto cleanup;\n\n    xml = virDomainDefFormat(def, driver->xmlopt, 0);\n\n cleanup:\n    virObjectUnref(caps);\n    virDomainDefFree(def);\n    return xml;\n}"
  },
  {
    "function_name": "lxcDomainGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "910-933",
    "snippet": "static char *lxcDomainGetXMLDesc(virDomainPtr dom,\n                                 unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetXMLDescEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    ret = virDomainDefFormat((flags & VIR_DOMAIN_XML_INACTIVE) &&\n                             vm->newDef ? vm->newDef : vm->def,\n                             driver->xmlopt,\n                             virDomainDefFormatConvertXMLFlags(flags));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormat",
          "args": [
            "(flags & VIR_DOMAIN_XML_INACTIVE) &&\n                             vm->newDef ? vm->newDef : vm->def",
            "driver->xmlopt",
            "virDomainDefFormatConvertXMLFlags(flags)"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29496-29508",
          "snippet": "char *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS \\\n    (VIR_DOMAIN_DEF_FORMAT_SECURE | \\\n     VIR_DOMAIN_DEF_FORMAT_INACTIVE | \\\n     VIR_DOMAIN_DEF_FORMAT_MIGRATABLE)\n\nchar *\nvirDomainDefFormat(virDomainDefPtr def,\n                   virDomainXMLOptionPtr xmlopt,\n                   unsigned int flags)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virCheckFlags(VIR_DOMAIN_DEF_FORMAT_COMMON_FLAGS, NULL);\n    if (virDomainDefFormatInternal(def, xmlopt, &buf, flags) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFormatConvertXMLFlags",
          "args": [
            "flags"
          ],
          "line": 928
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFormatConvertXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29481-29493",
          "snippet": "unsigned int virDomainDefFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_XML_INACTIVE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n    if (flags & VIR_DOMAIN_XML_MIGRATABLE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_MIGRATABLE;\n\n    return formatFlags;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int virDomainDefFormatConvertXMLFlags(unsigned int flags)\n{\n    unsigned int formatFlags = 0;\n\n    if (flags & VIR_DOMAIN_XML_SECURE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_SECURE;\n    if (flags & VIR_DOMAIN_XML_INACTIVE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_INACTIVE;\n    if (flags & VIR_DOMAIN_XML_MIGRATABLE)\n        formatFlags |= VIR_DOMAIN_DEF_FORMAT_MIGRATABLE;\n\n    return formatFlags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetXMLDescEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_XML_COMMON_FLAGS",
            "NULL"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *lxcDomainGetXMLDesc(virDomainPtr dom,\n                                 unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    virCheckFlags(VIR_DOMAIN_XML_COMMON_FLAGS, NULL);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetXMLDescEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    ret = virDomainDefFormat((flags & VIR_DOMAIN_XML_INACTIVE) &&\n                             vm->newDef ? vm->newDef : vm->def,\n                             driver->xmlopt,\n                             virDomainDefFormatConvertXMLFlags(flags));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "816-908",
    "snippet": "static int\nlxcDomainGetMemoryParameters(virDomainPtr dom,\n                             virTypedParameterPtr params,\n                             int *nparams,\n                             unsigned int flags)\n{\n    virDomainDefPtr persistentDef = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virLXCDomainObjPrivatePtr priv = NULL;\n    unsigned long long val;\n    int ret = -1;\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetMemoryParametersEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (def &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup memory controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if ((*nparams) == 0) {\n        /* Current number of memory parameters supported by cgroups */\n        *nparams = LXC_NB_MEM_PARAM;\n        ret = 0;\n        goto cleanup;\n    }\n\n    for (i = 0; i < LXC_NB_MEM_PARAM && i < *nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n        val = 0;\n\n        switch (i) {\n        case 0: /* fill memory hard limit here */\n            if (persistentDef) {\n                val = persistentDef->mem.hard_limit;\n            } else if (virCgroupGetMemoryHardLimit(priv->cgroup, &val) < 0) {\n                goto cleanup;\n            }\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                goto cleanup;\n            break;\n        case 1: /* fill memory soft limit here */\n            if (persistentDef) {\n                val = persistentDef->mem.soft_limit;\n            } else if (virCgroupGetMemorySoftLimit(priv->cgroup, &val) < 0) {\n                goto cleanup;\n            }\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                goto cleanup;\n            break;\n        case 2: /* fill swap hard limit here */\n            if (persistentDef) {\n                val = persistentDef->mem.swap_hard_limit;\n            } else if (virCgroupGetMemSwapHardLimit(priv->cgroup, &val) < 0) {\n                goto cleanup;\n            }\n            if (virTypedParameterAssign(param,\n                                        VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                goto cleanup;\n            break;\n        }\n    }\n\n    if (*nparams > LXC_NB_MEM_PARAM)\n        *nparams = LXC_NB_MEM_PARAM;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define LXC_NB_MEM_PARAM  3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "param",
            "VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT",
            "VIR_TYPED_PARAM_ULLONG",
            "val"
          ],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetMemSwapHardLimit",
          "args": [
            "priv->cgroup",
            "&val"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemSwapHardLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3181-3188",
          "snippet": "int\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetMemorySoftLimit",
          "args": [
            "priv->cgroup",
            "&val"
          ],
          "line": 880
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemorySoftLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3161-3168",
          "snippet": "int\nvirCgroupGetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetMemoryHardLimit",
          "args": [
            "priv->cgroup",
            "&val"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemoryHardLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3141-3148",
          "snippet": "int\nvirCgroupGetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cgroup memory controller is not mounted\")"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup memory controller is not mounted\""
          ],
          "line": 851
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_MEMORY"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetMemoryParametersEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY",
            "-1"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define LXC_NB_MEM_PARAM  3\n\nstatic int\nlxcDomainGetMemoryParameters(virDomainPtr dom,\n                             virTypedParameterPtr params,\n                             int *nparams,\n                             unsigned int flags)\n{\n    virDomainDefPtr persistentDef = NULL;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virLXCDomainObjPrivatePtr priv = NULL;\n    unsigned long long val;\n    int ret = -1;\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_TYPED_PARAM_STRING_OKAY, -1);\n\n    /* We don't return strings, and thus trivially support this flag.  */\n    flags &= ~VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetMemoryParametersEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto cleanup;\n\n    if (def &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"cgroup memory controller is not mounted\"));\n        goto cleanup;\n    }\n\n    if ((*nparams) == 0) {\n        /* Current number of memory parameters supported by cgroups */\n        *nparams = LXC_NB_MEM_PARAM;\n        ret = 0;\n        goto cleanup;\n    }\n\n    for (i = 0; i < LXC_NB_MEM_PARAM && i < *nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n        val = 0;\n\n        switch (i) {\n        case 0: /* fill memory hard limit here */\n            if (persistentDef) {\n                val = persistentDef->mem.hard_limit;\n            } else if (virCgroupGetMemoryHardLimit(priv->cgroup, &val) < 0) {\n                goto cleanup;\n            }\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                goto cleanup;\n            break;\n        case 1: /* fill memory soft limit here */\n            if (persistentDef) {\n                val = persistentDef->mem.soft_limit;\n            } else if (virCgroupGetMemorySoftLimit(priv->cgroup, &val) < 0) {\n                goto cleanup;\n            }\n            if (virTypedParameterAssign(param, VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                goto cleanup;\n            break;\n        case 2: /* fill swap hard limit here */\n            if (persistentDef) {\n                val = persistentDef->mem.swap_hard_limit;\n            } else if (virCgroupGetMemSwapHardLimit(priv->cgroup, &val) < 0) {\n                goto cleanup;\n            }\n            if (virTypedParameterAssign(param,\n                                        VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT,\n                                        VIR_TYPED_PARAM_ULLONG, val) < 0)\n                goto cleanup;\n            break;\n        }\n    }\n\n    if (*nparams > LXC_NB_MEM_PARAM)\n        *nparams = LXC_NB_MEM_PARAM;\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "741-814",
    "snippet": "static int\nlxcDomainSetMemoryParameters(virDomainPtr dom,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             unsigned int flags)\n{\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    virDomainObjPtr vm = NULL;\n    virLXCDomainObjPrivatePtr priv = NULL;\n    virLXCDriverConfigPtr cfg = NULL;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n    cfg = virLXCDriverGetConfig(driver);\n\n    if (virDomainSetMemoryParametersEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    /* QEMU and LXC implementation are identical */\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (def &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"cgroup memory controller is not mounted\"));\n        goto endjob;\n    }\n\n    if (virDomainCgroupSetMemoryLimitParameters(priv->cgroup, vm, def,\n                                                persistentDef,\n                                                params, nparams) < 0)\n        goto endjob;\n\n    if (def &&\n        virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n\n    if (persistentDef &&\n        virDomainDefSave(persistentDef, driver->xmlopt, cfg->configDir) < 0)\n        goto endjob;\n    /* QEMU and LXC implementations are identical */\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "persistentDef",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCgroupSetMemoryLimitParameters",
          "args": [
            "priv->cgroup",
            "vm",
            "def",
            "persistentDef",
            "params",
            "nparams"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCgroupSetMemoryLimitParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
          "lines": "192-270",
          "snippet": "int\nvirDomainCgroupSetMemoryLimitParameters(virCgroupPtr cgroup,\n                                        virDomainObjPtr vm,\n                                        virDomainDefPtr liveDef,\n                                        virDomainDefPtr persistentDef,\n                                        virTypedParameterPtr params,\n                                        int nparams)\n{\n    unsigned long long swap_hard_limit;\n    unsigned long long hard_limit = 0;\n    unsigned long long soft_limit = 0;\n    bool set_swap_hard_limit = false;\n    bool set_hard_limit = false;\n    bool set_soft_limit = false;\n    int rc;\n\n#define VIR_GET_LIMIT_PARAMETER(PARAM, VALUE) \\\n    if ((rc = virTypedParamsGetULLong(params, nparams, PARAM, &VALUE)) < 0) \\\n        return -1; \\\n \\\n    if (rc == 1) \\\n        set_ ## VALUE = true;\n\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT, swap_hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_HARD_LIMIT, hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SOFT_LIMIT, soft_limit)\n\n#undef VIR_GET_LIMIT_PARAMETER\n\n    /* Swap hard limit must be greater than hard limit. */\n    if (set_swap_hard_limit || set_hard_limit) {\n        unsigned long long mem_limit = vm->def->mem.hard_limit;\n        unsigned long long swap_limit = vm->def->mem.swap_hard_limit;\n\n        if (set_swap_hard_limit)\n            swap_limit = swap_hard_limit;\n\n        if (set_hard_limit)\n            mem_limit = hard_limit;\n\n        if (mem_limit > swap_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"memory hard_limit tunable value must be lower \"\n                             \"than or equal to swap_hard_limit\"));\n            return -1;\n        }\n    }\n\n#define VIR_SET_MEM_PARAMETER(FUNC, VALUE) \\\n    if (set_ ## VALUE) { \\\n        if (liveDef) { \\\n            if ((rc = FUNC(cgroup, VALUE)) < 0) \\\n                return -1; \\\n            liveDef->mem.VALUE = VALUE; \\\n        } \\\n \\\n        if (persistentDef) \\\n            persistentDef->mem.VALUE = VALUE; \\\n    }\n\n    /* Soft limit doesn't clash with the others */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemorySoftLimit, soft_limit);\n\n    /* set hard limit before swap hard limit if decreasing it */\n    if (liveDef && liveDef->mem.hard_limit > hard_limit) {\n        VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n        /* inhibit changing the limit a second time */\n        set_hard_limit = false;\n    }\n\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemSwapHardLimit, swap_hard_limit);\n\n    /* otherwise increase it after swap hard limit */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n\n#undef VIR_SET_MEM_PARAMETER\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetMemoryLimitParameters(virCgroupPtr cgroup,\n                                        virDomainObjPtr vm,\n                                        virDomainDefPtr liveDef,\n                                        virDomainDefPtr persistentDef,\n                                        virTypedParameterPtr params,\n                                        int nparams)\n{\n    unsigned long long swap_hard_limit;\n    unsigned long long hard_limit = 0;\n    unsigned long long soft_limit = 0;\n    bool set_swap_hard_limit = false;\n    bool set_hard_limit = false;\n    bool set_soft_limit = false;\n    int rc;\n\n#define VIR_GET_LIMIT_PARAMETER(PARAM, VALUE) \\\n    if ((rc = virTypedParamsGetULLong(params, nparams, PARAM, &VALUE)) < 0) \\\n        return -1; \\\n \\\n    if (rc == 1) \\\n        set_ ## VALUE = true;\n\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT, swap_hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_HARD_LIMIT, hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SOFT_LIMIT, soft_limit)\n\n#undef VIR_GET_LIMIT_PARAMETER\n\n    /* Swap hard limit must be greater than hard limit. */\n    if (set_swap_hard_limit || set_hard_limit) {\n        unsigned long long mem_limit = vm->def->mem.hard_limit;\n        unsigned long long swap_limit = vm->def->mem.swap_hard_limit;\n\n        if (set_swap_hard_limit)\n            swap_limit = swap_hard_limit;\n\n        if (set_hard_limit)\n            mem_limit = hard_limit;\n\n        if (mem_limit > swap_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"memory hard_limit tunable value must be lower \"\n                             \"than or equal to swap_hard_limit\"));\n            return -1;\n        }\n    }\n\n#define VIR_SET_MEM_PARAMETER(FUNC, VALUE) \\\n    if (set_ ## VALUE) { \\\n        if (liveDef) { \\\n            if ((rc = FUNC(cgroup, VALUE)) < 0) \\\n                return -1; \\\n            liveDef->mem.VALUE = VALUE; \\\n        } \\\n \\\n        if (persistentDef) \\\n            persistentDef->mem.VALUE = VALUE; \\\n    }\n\n    /* Soft limit doesn't clash with the others */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemorySoftLimit, soft_limit);\n\n    /* set hard limit before swap hard limit if decreasing it */\n    if (liveDef && liveDef->mem.hard_limit > hard_limit) {\n        VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n        /* inhibit changing the limit a second time */\n        set_hard_limit = false;\n    }\n\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemSwapHardLimit, swap_hard_limit);\n\n    /* otherwise increase it after swap hard limit */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n\n#undef VIR_SET_MEM_PARAMETER\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cgroup memory controller is not mounted\")"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cgroup memory controller is not mounted\""
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "priv->cgroup",
            "VIR_CGROUP_CONTROLLER_MEMORY"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetMemoryParametersEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsValidate",
          "args": [
            "params",
            "nparams",
            "VIR_DOMAIN_MEMORY_HARD_LIMIT",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_DOMAIN_MEMORY_SOFT_LIMIT",
            "VIR_TYPED_PARAM_ULLONG",
            "VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT",
            "VIR_TYPED_PARAM_ULLONG",
            "NULL"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "58-142",
          "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG",
            "-1"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainSetMemoryParameters(virDomainPtr dom,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             unsigned int flags)\n{\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    virDomainObjPtr vm = NULL;\n    virLXCDomainObjPrivatePtr priv = NULL;\n    virLXCDriverConfigPtr cfg = NULL;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    int ret = -1;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG, -1);\n\n    if (virTypedParamsValidate(params, nparams,\n                               VIR_DOMAIN_MEMORY_HARD_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_SOFT_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT,\n                               VIR_TYPED_PARAM_ULLONG,\n                               NULL) < 0)\n        return -1;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n    cfg = virLXCDriverGetConfig(driver);\n\n    if (virDomainSetMemoryParametersEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    /* QEMU and LXC implementation are identical */\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (def &&\n        !virCgroupHasController(priv->cgroup, VIR_CGROUP_CONTROLLER_MEMORY)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"cgroup memory controller is not mounted\"));\n        goto endjob;\n    }\n\n    if (virDomainCgroupSetMemoryLimitParameters(priv->cgroup, vm, def,\n                                                persistentDef,\n                                                params, nparams) < 0)\n        goto endjob;\n\n    if (def &&\n        virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n        goto endjob;\n\n    if (persistentDef &&\n        virDomainDefSave(persistentDef, driver->xmlopt, cfg->configDir) < 0)\n        goto endjob;\n    /* QEMU and LXC implementations are identical */\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainSetMaxMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "736-739",
    "snippet": "static int lxcDomainSetMaxMemory(virDomainPtr dom, unsigned long newmax)\n{\n    return lxcDomainSetMemoryFlags(dom, newmax, VIR_DOMAIN_MEM_MAXIMUM);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainSetMemoryFlags",
          "args": [
            "dom",
            "newmax",
            "VIR_DOMAIN_MEM_MAXIMUM"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainSetMemoryFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "637-729",
          "snippet": "static int lxcDomainSetMemoryFlags(virDomainPtr dom, unsigned long newmem,\n                                   unsigned int flags)\n{\n    virDomainObjPtr vm;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDriverConfigPtr cfg = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    priv = vm->privateData;\n\n    if (virDomainSetMemoryFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_MEM_MAXIMUM) {\n        if (def) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Cannot resize the max memory \"\n                             \"on an active domain\"));\n            goto endjob;\n        }\n\n        if (persistentDef) {\n            virDomainDefSetMemoryTotal(persistentDef, newmem);\n            if (persistentDef->mem.cur_balloon > newmem)\n                persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    } else {\n        unsigned long oldmax = 0;\n\n        if (def)\n            oldmax = virDomainDefGetMemoryTotal(def);\n        if (persistentDef) {\n            if (!oldmax || oldmax > virDomainDefGetMemoryTotal(persistentDef))\n                oldmax = virDomainDefGetMemoryTotal(persistentDef);\n        }\n\n        if (newmem > oldmax) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           \"%s\", _(\"Cannot set memory higher than max memory\"));\n            goto endjob;\n        }\n\n        if (def) {\n            if (virCgroupSetMemory(priv->cgroup, newmem) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               \"%s\", _(\"Failed to set memory for domain\"));\n                goto endjob;\n            }\n\n            def->mem.cur_balloon = newmem;\n            if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n                goto endjob;\n        }\n\n        if (persistentDef) {\n            persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSetMemoryFlags(virDomainPtr dom, unsigned long newmem,\n                                   unsigned int flags)\n{\n    virDomainObjPtr vm;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDriverConfigPtr cfg = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    priv = vm->privateData;\n\n    if (virDomainSetMemoryFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_MEM_MAXIMUM) {\n        if (def) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Cannot resize the max memory \"\n                             \"on an active domain\"));\n            goto endjob;\n        }\n\n        if (persistentDef) {\n            virDomainDefSetMemoryTotal(persistentDef, newmem);\n            if (persistentDef->mem.cur_balloon > newmem)\n                persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    } else {\n        unsigned long oldmax = 0;\n\n        if (def)\n            oldmax = virDomainDefGetMemoryTotal(def);\n        if (persistentDef) {\n            if (!oldmax || oldmax > virDomainDefGetMemoryTotal(persistentDef))\n                oldmax = virDomainDefGetMemoryTotal(persistentDef);\n        }\n\n        if (newmem > oldmax) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           \"%s\", _(\"Cannot set memory higher than max memory\"));\n            goto endjob;\n        }\n\n        if (def) {\n            if (virCgroupSetMemory(priv->cgroup, newmem) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               \"%s\", _(\"Failed to set memory for domain\"));\n                goto endjob;\n            }\n\n            def->mem.cur_balloon = newmem;\n            if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n                goto endjob;\n        }\n\n        if (persistentDef) {\n            persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSetMaxMemory(virDomainPtr dom, unsigned long newmax)\n{\n    return lxcDomainSetMemoryFlags(dom, newmax, VIR_DOMAIN_MEM_MAXIMUM);\n}"
  },
  {
    "function_name": "lxcDomainSetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "731-734",
    "snippet": "static int lxcDomainSetMemory(virDomainPtr dom, unsigned long newmem)\n{\n    return lxcDomainSetMemoryFlags(dom, newmem, VIR_DOMAIN_AFFECT_LIVE);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainSetMemoryFlags",
          "args": [
            "dom",
            "newmem",
            "VIR_DOMAIN_AFFECT_LIVE"
          ],
          "line": 733
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainSetMemoryFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "637-729",
          "snippet": "static int lxcDomainSetMemoryFlags(virDomainPtr dom, unsigned long newmem,\n                                   unsigned int flags)\n{\n    virDomainObjPtr vm;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDriverConfigPtr cfg = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    priv = vm->privateData;\n\n    if (virDomainSetMemoryFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_MEM_MAXIMUM) {\n        if (def) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Cannot resize the max memory \"\n                             \"on an active domain\"));\n            goto endjob;\n        }\n\n        if (persistentDef) {\n            virDomainDefSetMemoryTotal(persistentDef, newmem);\n            if (persistentDef->mem.cur_balloon > newmem)\n                persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    } else {\n        unsigned long oldmax = 0;\n\n        if (def)\n            oldmax = virDomainDefGetMemoryTotal(def);\n        if (persistentDef) {\n            if (!oldmax || oldmax > virDomainDefGetMemoryTotal(persistentDef))\n                oldmax = virDomainDefGetMemoryTotal(persistentDef);\n        }\n\n        if (newmem > oldmax) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           \"%s\", _(\"Cannot set memory higher than max memory\"));\n            goto endjob;\n        }\n\n        if (def) {\n            if (virCgroupSetMemory(priv->cgroup, newmem) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               \"%s\", _(\"Failed to set memory for domain\"));\n                goto endjob;\n            }\n\n            def->mem.cur_balloon = newmem;\n            if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n                goto endjob;\n        }\n\n        if (persistentDef) {\n            persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSetMemoryFlags(virDomainPtr dom, unsigned long newmem,\n                                   unsigned int flags)\n{\n    virDomainObjPtr vm;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDriverConfigPtr cfg = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    priv = vm->privateData;\n\n    if (virDomainSetMemoryFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_MEM_MAXIMUM) {\n        if (def) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Cannot resize the max memory \"\n                             \"on an active domain\"));\n            goto endjob;\n        }\n\n        if (persistentDef) {\n            virDomainDefSetMemoryTotal(persistentDef, newmem);\n            if (persistentDef->mem.cur_balloon > newmem)\n                persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    } else {\n        unsigned long oldmax = 0;\n\n        if (def)\n            oldmax = virDomainDefGetMemoryTotal(def);\n        if (persistentDef) {\n            if (!oldmax || oldmax > virDomainDefGetMemoryTotal(persistentDef))\n                oldmax = virDomainDefGetMemoryTotal(persistentDef);\n        }\n\n        if (newmem > oldmax) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           \"%s\", _(\"Cannot set memory higher than max memory\"));\n            goto endjob;\n        }\n\n        if (def) {\n            if (virCgroupSetMemory(priv->cgroup, newmem) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               \"%s\", _(\"Failed to set memory for domain\"));\n                goto endjob;\n            }\n\n            def->mem.cur_balloon = newmem;\n            if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n                goto endjob;\n        }\n\n        if (persistentDef) {\n            persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSetMemory(virDomainPtr dom, unsigned long newmem)\n{\n    return lxcDomainSetMemoryFlags(dom, newmem, VIR_DOMAIN_AFFECT_LIVE);\n}"
  },
  {
    "function_name": "lxcDomainSetMemoryFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "637-729",
    "snippet": "static int lxcDomainSetMemoryFlags(virDomainPtr dom, unsigned long newmem,\n                                   unsigned int flags)\n{\n    virDomainObjPtr vm;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDriverConfigPtr cfg = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    priv = vm->privateData;\n\n    if (virDomainSetMemoryFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_MEM_MAXIMUM) {\n        if (def) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Cannot resize the max memory \"\n                             \"on an active domain\"));\n            goto endjob;\n        }\n\n        if (persistentDef) {\n            virDomainDefSetMemoryTotal(persistentDef, newmem);\n            if (persistentDef->mem.cur_balloon > newmem)\n                persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    } else {\n        unsigned long oldmax = 0;\n\n        if (def)\n            oldmax = virDomainDefGetMemoryTotal(def);\n        if (persistentDef) {\n            if (!oldmax || oldmax > virDomainDefGetMemoryTotal(persistentDef))\n                oldmax = virDomainDefGetMemoryTotal(persistentDef);\n        }\n\n        if (newmem > oldmax) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           \"%s\", _(\"Cannot set memory higher than max memory\"));\n            goto endjob;\n        }\n\n        if (def) {\n            if (virCgroupSetMemory(priv->cgroup, newmem) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               \"%s\", _(\"Failed to set memory for domain\"));\n                goto endjob;\n            }\n\n            def->mem.cur_balloon = newmem;\n            if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n                goto endjob;\n        }\n\n        if (persistentDef) {\n            persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjEndJob",
          "args": [
            "driver",
            "vm"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjEndJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "137-149",
          "snippet": "void\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\nvoid\nvirLXCDomainObjEndJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                     virDomainObjPtr obj)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    enum virLXCDomainJob job = priv->job.active;\n\n    VIR_DEBUG(\"Stopping job: %s\",\n              virLXCDomainJobTypeToString(job));\n\n    virLXCDomainObjResetJob(priv);\n    virCondSignal(&priv->job.cond);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "persistentDef",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSave",
          "args": [
            "vm",
            "driver->xmlopt",
            "cfg->stateDir"
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29706-29723",
          "snippet": "int\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjDispose(void *obj);",
            "static void virDomainXMLOptionDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic void virDomainObjDispose(void *obj);\nstatic void virDomainXMLOptionDispose(void *obj);\n\nint\nvirDomainObjSave(virDomainObjPtr obj,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *statusDir)\n{\n    unsigned int flags = (VIR_DOMAIN_DEF_FORMAT_SECURE |\n                          VIR_DOMAIN_DEF_FORMAT_STATUS |\n                          VIR_DOMAIN_DEF_FORMAT_ACTUAL_NET |\n                          VIR_DOMAIN_DEF_FORMAT_PCI_ORIG_STATES |\n                          VIR_DOMAIN_DEF_FORMAT_CLOCK_ADJUST);\n\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainObjFormat(obj, xmlopt, flags)))\n        return -1;\n\n    return virDomainDefSaveXML(obj->def, statusDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Failed to set memory for domain\")"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to set memory for domain\""
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetMemory",
          "args": [
            "priv->cgroup",
            "newmem"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetMemorySoftLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3151-3158",
          "snippet": "int\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Cannot set memory higher than max memory\")"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "persistentDef"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetMemoryTotal",
          "args": [
            "persistentDef",
            "newmem"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10931-10936",
          "snippet": "void\nvirDomainDefSetMemoryTotal(virDomainDefPtr def,\n                           unsigned long long size)\n{\n    def->mem.total_memory = size;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainDefSetMemoryTotal(virDomainDefPtr def,\n                           unsigned long long size)\n{\n    def->mem.total_memory = size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot resize the max memory \"\n                             \"on an active domain\")"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjGetDefs",
          "args": [
            "vm",
            "flags",
            "&def",
            "&persistentDef"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetDefs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3835-3862",
          "snippet": "int\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainObjGetDefs(virDomainObjPtr vm,\n                    unsigned int flags,\n                    virDomainDefPtr *liveDef,\n                    virDomainDefPtr *persDef)\n{\n    if (liveDef)\n        *liveDef = NULL;\n\n    if (persDef)\n        *persDef = NULL;\n\n    if (virDomainObjUpdateModificationImpact(vm, &flags) < 0)\n        return -1;\n\n    if (virDomainObjIsActive(vm)) {\n        if (liveDef && (flags & VIR_DOMAIN_AFFECT_LIVE))\n            *liveDef = vm->def;\n\n        if (persDef && (flags & VIR_DOMAIN_AFFECT_CONFIG))\n            *persDef = vm->newDef;\n    } else {\n        if (persDef)\n            *persDef = vm->def;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDomainObjBeginJob",
          "args": [
            "driver",
            "vm",
            "LXC_JOB_MODIFY"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDomainObjBeginJob",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_domain.c",
          "lines": "85-128",
          "snippet": "int\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}",
          "includes": [
            "#include \"virinitctl.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virtime.h\"",
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define LXC_JOB_WAIT_TIME (1000ull * 30)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virinitctl.h\"\n#include \"virsystemd.h\"\n#include \"virtime.h\"\n#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"lxc_domain.h\"\n#include <config.h>\n\n#define LXC_JOB_WAIT_TIME (1000ull * 30)\n\nint\nvirLXCDomainObjBeginJob(virLXCDriverPtr driver G_GNUC_UNUSED,\n                       virDomainObjPtr obj,\n                       enum virLXCDomainJob job)\n{\n    virLXCDomainObjPrivatePtr priv = obj->privateData;\n    unsigned long long now;\n    unsigned long long then;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n    then = now + LXC_JOB_WAIT_TIME;\n\n    while (priv->job.active) {\n        VIR_DEBUG(\"Wait normal job condition for starting job: %s\",\n                  virLXCDomainJobTypeToString(job));\n        if (virCondWaitUntil(&priv->job.cond, &obj->parent.lock, then) < 0)\n            goto error;\n    }\n\n    virLXCDomainObjResetJob(priv);\n\n    VIR_DEBUG(\"Starting job: %s\", virLXCDomainJobTypeToString(job));\n    priv->job.active = job;\n    priv->job.owner = virThreadSelfID();\n\n    return 0;\n\n error:\n    VIR_WARN(\"Cannot start job (%s) for domain %s;\"\n             \" current job is (%s) owned by (%d)\",\n             virLXCDomainJobTypeToString(job),\n             obj->def->name,\n             virLXCDomainJobTypeToString(priv->job.active),\n             priv->job.owner);\n\n    if (errno == ETIMEDOUT)\n        virReportError(VIR_ERR_OPERATION_TIMEOUT,\n                       \"%s\", _(\"cannot acquire state change lock\"));\n    else\n        virReportSystemError(errno,\n                             \"%s\", _(\"cannot acquire job mutex\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainSetMemoryFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def",
            "flags"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM",
            "-1"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainSetMemoryFlags(virDomainPtr dom, unsigned long newmem,\n                                   unsigned int flags)\n{\n    virDomainObjPtr vm;\n    virDomainDefPtr def = NULL;\n    virDomainDefPtr persistentDef = NULL;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virLXCDriverConfigPtr cfg = NULL;\n\n    virCheckFlags(VIR_DOMAIN_AFFECT_LIVE |\n                  VIR_DOMAIN_AFFECT_CONFIG |\n                  VIR_DOMAIN_MEM_MAXIMUM, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    cfg = virLXCDriverGetConfig(driver);\n\n    priv = vm->privateData;\n\n    if (virDomainSetMemoryFlagsEnsureACL(dom->conn, vm->def, flags) < 0)\n        goto cleanup;\n\n    if (virLXCDomainObjBeginJob(driver, vm, LXC_JOB_MODIFY) < 0)\n        goto cleanup;\n\n    if (virDomainObjGetDefs(vm, flags, &def, &persistentDef) < 0)\n        goto endjob;\n\n    if (flags & VIR_DOMAIN_MEM_MAXIMUM) {\n        if (def) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"Cannot resize the max memory \"\n                             \"on an active domain\"));\n            goto endjob;\n        }\n\n        if (persistentDef) {\n            virDomainDefSetMemoryTotal(persistentDef, newmem);\n            if (persistentDef->mem.cur_balloon > newmem)\n                persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    } else {\n        unsigned long oldmax = 0;\n\n        if (def)\n            oldmax = virDomainDefGetMemoryTotal(def);\n        if (persistentDef) {\n            if (!oldmax || oldmax > virDomainDefGetMemoryTotal(persistentDef))\n                oldmax = virDomainDefGetMemoryTotal(persistentDef);\n        }\n\n        if (newmem > oldmax) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           \"%s\", _(\"Cannot set memory higher than max memory\"));\n            goto endjob;\n        }\n\n        if (def) {\n            if (virCgroupSetMemory(priv->cgroup, newmem) < 0) {\n                virReportError(VIR_ERR_OPERATION_FAILED,\n                               \"%s\", _(\"Failed to set memory for domain\"));\n                goto endjob;\n            }\n\n            def->mem.cur_balloon = newmem;\n            if (virDomainObjSave(vm, driver->xmlopt, cfg->stateDir) < 0)\n                goto endjob;\n        }\n\n        if (persistentDef) {\n            persistentDef->mem.cur_balloon = newmem;\n            if (virDomainDefSave(persistentDef,\n                                 driver->xmlopt, cfg->configDir) < 0)\n                goto endjob;\n        }\n    }\n\n    ret = 0;\n\n endjob:\n    virLXCDomainObjEndJob(driver, vm);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetMaxMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "618-635",
    "snippet": "static unsigned long long\nlxcDomainGetMaxMemory(virDomainPtr dom)\n{\n    virDomainObjPtr vm;\n    unsigned long long ret = 0;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetMaxMemoryEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = virDomainDefGetMemoryTotal(vm->def);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "vm->def"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetMaxMemoryEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic unsigned long long\nlxcDomainGetMaxMemory(virDomainPtr dom)\n{\n    virDomainObjPtr vm;\n    unsigned long long ret = 0;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetMaxMemoryEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = virDomainDefGetMemoryTotal(vm->def);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetOSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "599-615",
    "snippet": "static char *lxcDomainGetOSType(virDomainPtr dom)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetOSTypeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = g_strdup(virDomainOSTypeToString(vm->def->os.type));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "virDomainOSTypeToString(vm->def->os.type)"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainOSTypeToString",
          "args": [
            "vm->def->os.type"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainGetOSTypeEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *lxcDomainGetOSType(virDomainPtr dom)\n{\n    virDomainObjPtr vm;\n    char *ret = NULL;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetOSTypeEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    ret = g_strdup(virDomainOSTypeToString(vm->def->os.type));\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "574-597",
    "snippet": "static int\nlxcDomainGetState(virDomainPtr dom,\n                  int *state,\n                  int *reason,\n                  unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetStateEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    *state = virDomainObjGetState(vm, reason);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "reason"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetStateEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int\nlxcDomainGetState(virDomainPtr dom,\n                  int *state,\n                  int *reason,\n                  unsigned int flags)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainGetStateEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    *state = virDomainObjGetState(vm, reason);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "527-572",
    "snippet": "static int lxcDomainGetInfo(virDomainPtr dom,\n                            virDomainInfoPtr info)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetInfoEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    info->state = virDomainObjGetState(vm, NULL);\n\n    if (!virDomainObjIsActive(vm)) {\n        info->cpuTime = 0;\n        info->memory = vm->def->mem.cur_balloon;\n    } else {\n        if (virCgroupGetCpuacctUsage(priv->cgroup, &(info->cpuTime)) < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           \"%s\", _(\"Cannot read cputime for domain\"));\n            goto cleanup;\n        }\n        if (virCgroupGetMemoryUsage(priv->cgroup, &(info->memory)) < 0) {\n            /* Don't fail if we can't read memory usage due to a lack of\n             * kernel support */\n            if (virLastErrorIsSystemErrno(ENOENT)) {\n                virResetLastError();\n                info->memory = 0;\n            } else {\n                goto cleanup;\n            }\n        }\n    }\n\n    info->maxMem = virDomainDefGetMemoryTotal(vm->def);\n    info->nrVirtCpu = virDomainDefGetVcpus(vm->def);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetVcpus",
          "args": [
            "vm->def"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1912-1924",
          "snippet": "unsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned int\nvirDomainDefGetVcpus(const virDomainDef *def)\n{\n    size_t i;\n    unsigned int ret = 0;\n\n    for (i = 0; i < def->maxvcpus; i++) {\n        if (def->vcpus[i]->online)\n            ret++;\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetMemoryTotal",
          "args": [
            "vm->def"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetMemoryTotal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "10946-10950",
          "snippet": "unsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nunsigned long long\nvirDomainDefGetMemoryTotal(const virDomainDef *def)\n{\n    return def->mem.total_memory;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "ENOENT"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetMemoryUsage",
          "args": [
            "priv->cgroup",
            "&(info->memory)"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetMemoryUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3121-3128",
          "snippet": "int\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "_(\"Cannot read cputime for domain\")"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot read cputime for domain\""
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuacctUsage",
          "args": [
            "priv->cgroup",
            "&(info->cpuTime)"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuacctUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3416-3423",
          "snippet": "int\nvirCgroupGetCpuacctUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjGetState",
          "args": [
            "vm",
            "NULL"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30038-30045",
          "snippet": "virDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainState\nvirDomainObjGetState(virDomainObjPtr dom, int *reason)\n{\n    if (reason)\n        *reason = dom->state.reason;\n\n    return dom->state.state;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetInfoEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainGetInfo(virDomainPtr dom,\n                            virDomainInfoPtr info)\n{\n    virDomainObjPtr vm;\n    int ret = -1;\n    virLXCDomainObjPrivatePtr priv;\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    priv = vm->privateData;\n\n    if (virDomainGetInfoEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    info->state = virDomainObjGetState(vm, NULL);\n\n    if (!virDomainObjIsActive(vm)) {\n        info->cpuTime = 0;\n        info->memory = vm->def->mem.cur_balloon;\n    } else {\n        if (virCgroupGetCpuacctUsage(priv->cgroup, &(info->cpuTime)) < 0) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           \"%s\", _(\"Cannot read cputime for domain\"));\n            goto cleanup;\n        }\n        if (virCgroupGetMemoryUsage(priv->cgroup, &(info->memory)) < 0) {\n            /* Don't fail if we can't read memory usage due to a lack of\n             * kernel support */\n            if (virLastErrorIsSystemErrno(ENOENT)) {\n                virResetLastError();\n                info->memory = 0;\n            } else {\n                goto cleanup;\n            }\n        }\n    }\n\n    info->maxMem = virDomainDefGetMemoryTotal(vm->def);\n    info->nrVirtCpu = virDomainDefGetVcpus(vm->def);\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "522-525",
    "snippet": "static int lxcDomainUndefine(virDomainPtr dom)\n{\n    return lxcDomainUndefineFlags(dom, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainUndefineFlags",
          "args": [
            "dom",
            "0"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainUndefineFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "476-520",
          "snippet": "static int lxcDomainUndefineFlags(virDomainPtr dom,\n                                  unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(cfg->configDir,\n                              cfg->autostartDir,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_UNDEFINED,\n                                     VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainUndefineFlags(virDomainPtr dom,\n                                  unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(cfg->configDir,\n                              cfg->autostartDir,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_UNDEFINED,\n                                     VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainUndefine(virDomainPtr dom)\n{\n    return lxcDomainUndefineFlags(dom, 0);\n}"
  },
  {
    "function_name": "lxcDomainUndefineFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "476-520",
    "snippet": "static int lxcDomainUndefineFlags(virDomainPtr dom,\n                                  unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(cfg->configDir,\n                              cfg->autostartDir,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_UNDEFINED,\n                                     VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "vm"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_UNDEFINED",
            "VIR_DOMAIN_EVENT_UNDEFINED_REMOVED"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDeleteConfig",
          "args": [
            "cfg->configDir",
            "cfg->autostartDir",
            "vm"
          ],
          "line": 499
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDeleteConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29726-29753",
          "snippet": "int\nvirDomainDeleteConfig(const char *configDir,\n                      const char *autostartDir,\n                      virDomainObjPtr dom)\n{\n    g_autofree char *configFile = NULL;\n    g_autofree char *autostartLink = NULL;\n\n    if ((configFile = virDomainConfigFile(configDir, dom->def->name)) == NULL)\n        return -1;\n    if ((autostartLink = virDomainConfigFile(autostartDir,\n                                             dom->def->name)) == NULL)\n        return -1;\n\n    /* Not fatal if this doesn't work */\n    unlink(autostartLink);\n    dom->autostart = 0;\n\n    if (unlink(configFile) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"cannot remove config %s\"),\n                             configFile);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDeleteConfig(const char *configDir,\n                      const char *autostartDir,\n                      virDomainObjPtr dom)\n{\n    g_autofree char *configFile = NULL;\n    g_autofree char *autostartLink = NULL;\n\n    if ((configFile = virDomainConfigFile(configDir, dom->def->name)) == NULL)\n        return -1;\n    if ((autostartLink = virDomainConfigFile(autostartDir,\n                                             dom->def->name)) == NULL)\n        return -1;\n\n    /* Not fatal if this doesn't work */\n    unlink(autostartLink);\n    dom->autostart = 0;\n\n    if (unlink(configFile) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"cannot remove config %s\"),\n                             configFile);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Cannot undefine transient domain\")"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot undefine transient domain\""
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainUndefineFlagsEnsureACL",
          "args": [
            "dom->conn",
            "vm->def"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainUndefineFlags(virDomainPtr dom,\n                                  unsigned int flags)\n{\n    virLXCDriverPtr driver = dom->conn->privateData;\n    virDomainObjPtr vm;\n    virObjectEventPtr event = NULL;\n    int ret = -1;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n\n    virCheckFlags(0, -1);\n\n    if (!(vm = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainUndefineFlagsEnsureACL(dom->conn, vm->def) < 0)\n        goto cleanup;\n\n    if (!vm->persistent) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"Cannot undefine transient domain\"));\n        goto cleanup;\n    }\n\n    if (virDomainDeleteConfig(cfg->configDir,\n                              cfg->autostartDir,\n                              vm) < 0)\n        goto cleanup;\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_UNDEFINED,\n                                     VIR_DOMAIN_EVENT_UNDEFINED_REMOVED);\n\n    if (virDomainObjIsActive(vm))\n        vm->persistent = 0;\n    else\n        virDomainObjListRemove(driver->domains, vm);\n\n    ret = 0;\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "470-474",
    "snippet": "static virDomainPtr\nlxcDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return lxcDomainDefineXMLFlags(conn, xml, 0);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lxcDomainDefineXMLFlags",
          "args": [
            "conn",
            "xml",
            "0"
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomainDefineXMLFlags",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "398-468",
          "snippet": "static virDomainPtr\nlxcDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         driver->xmlopt, cfg->configDir) < 0) {\n        virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_DEFINED,\n                                     !oldDef ?\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                     VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return dom;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nlxcDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         driver->xmlopt, cfg->configDir) < 0) {\n        virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_DEFINED,\n                                     !oldDef ?\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                     VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return dom;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nlxcDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    return lxcDomainDefineXMLFlags(conn, xml, 0);\n}"
  },
  {
    "function_name": "lxcDomainDefineXMLFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "398-468",
    "snippet": "static virDomainPtr\nlxcDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         driver->xmlopt, cfg->configDir) < 0) {\n        virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_DEFINED,\n                                     !oldDef ?\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                     VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectEventStateQueue",
          "args": [
            "driver->domainEventState",
            "event"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectEventStateQueue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "772-777",
          "snippet": "void\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectEventStateFlush(virObjectEventStatePtr state);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virObjectEventStateFlush(virObjectEventStatePtr state);\n\nvoid\nvirObjectEventStateQueue(virObjectEventStatePtr state,\n                         virObjectEventPtr event)\n{\n    virObjectEventStateQueueRemote(state, event, -1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "oldDef"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainEventLifecycleNewFromObj",
          "args": [
            "vm",
            "VIR_DOMAIN_EVENT_DEFINED",
            "!oldDef ?\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                     VIR_DOMAIN_EVENT_DEFINED_UPDATED"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainEventLifecycleNewFromObj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_event.c",
          "lines": "610-616",
          "snippet": "virObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainEventDispose(void *obj);",
            "static void virDomainEventLifecycleDispose(void *obj);",
            "static void virDomainEventRTCChangeDispose(void *obj);",
            "static void virDomainEventWatchdogDispose(void *obj);",
            "static void virDomainEventIOErrorDispose(void *obj);",
            "static void virDomainEventGraphicsDispose(void *obj);",
            "static void virDomainEventBlockJobDispose(void *obj);",
            "static void virDomainEventDiskChangeDispose(void *obj);",
            "static void virDomainEventTrayChangeDispose(void *obj);",
            "static void virDomainEventBalloonChangeDispose(void *obj);",
            "static void virDomainEventDeviceRemovedDispose(void *obj);",
            "static void virDomainEventPMDispose(void *obj);",
            "static void virDomainQemuMonitorEventDispose(void *obj);",
            "static void virDomainEventTunableDispose(void *obj);",
            "static void virDomainEventAgentLifecycleDispose(void *obj);",
            "static void virDomainEventDeviceAddedDispose(void *obj);",
            "static void virDomainEventMigrationIterationDispose(void *obj);",
            "static void virDomainEventJobCompletedDispose(void *obj);",
            "static void virDomainEventDeviceRemovalFailedDispose(void *obj);",
            "static void virDomainEventMetadataChangeDispose(void *obj);",
            "static void virDomainEventBlockThresholdDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic void virDomainEventDispose(void *obj);\nstatic void virDomainEventLifecycleDispose(void *obj);\nstatic void virDomainEventRTCChangeDispose(void *obj);\nstatic void virDomainEventWatchdogDispose(void *obj);\nstatic void virDomainEventIOErrorDispose(void *obj);\nstatic void virDomainEventGraphicsDispose(void *obj);\nstatic void virDomainEventBlockJobDispose(void *obj);\nstatic void virDomainEventDiskChangeDispose(void *obj);\nstatic void virDomainEventTrayChangeDispose(void *obj);\nstatic void virDomainEventBalloonChangeDispose(void *obj);\nstatic void virDomainEventDeviceRemovedDispose(void *obj);\nstatic void virDomainEventPMDispose(void *obj);\nstatic void virDomainQemuMonitorEventDispose(void *obj);\nstatic void virDomainEventTunableDispose(void *obj);\nstatic void virDomainEventAgentLifecycleDispose(void *obj);\nstatic void virDomainEventDeviceAddedDispose(void *obj);\nstatic void virDomainEventMigrationIterationDispose(void *obj);\nstatic void virDomainEventJobCompletedDispose(void *obj);\nstatic void virDomainEventDeviceRemovalFailedDispose(void *obj);\nstatic void virDomainEventMetadataChangeDispose(void *obj);\nstatic void virDomainEventBlockThresholdDispose(void *obj);\n\nvirObjectEventPtr\nvirDomainEventLifecycleNewFromObj(virDomainObjPtr obj,\n                                  int type,\n                                  int detail)\n{\n    return virDomainEventLifecycleNewFromDef(obj->def, type, detail);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListRemove",
          "args": [
            "driver->domains",
            "vm"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "401-413",
          "snippet": "void\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainObjListRemove(virDomainObjListPtr doms,\n                       virDomainObjPtr dom)\n{\n    dom->removing = true;\n    virObjectRef(dom);\n    virObjectUnlock(dom);\n    virObjectRWLockWrite(doms);\n    virObjectLock(dom);\n    virDomainObjListRemoveLocked(doms, dom);\n    virObjectUnref(dom);\n    virObjectRWUnlock(doms);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSave",
          "args": [
            "vm->newDef ? vm->newDef : vm->def",
            "driver->xmlopt",
            "cfg->configDir"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "29693-29704",
          "snippet": "int\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSave(virDomainDefPtr def,\n                 virDomainXMLOptionPtr xmlopt,\n                 const char *configDir)\n{\n    g_autofree char *xml = NULL;\n\n    if (!(xml = virDomainDefFormat(def, xmlopt, VIR_DOMAIN_DEF_FORMAT_SECURE)))\n        return -1;\n\n    return virDomainDefSaveXML(def, configDir, xml);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "driver->domains",
            "def",
            "driver->xmlopt",
            "0",
            "&oldDef"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"System lacks NETNS support\")"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"System lacks NETNS support\""
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSecurityManagerVerify",
          "args": [
            "driver->securityManager",
            "def"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virSecurityManagerVerify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_manager.c",
          "lines": "948-975",
          "snippet": "int\nvirSecurityManagerVerify(virSecurityManagerPtr mgr,\n                         virDomainDefPtr def)\n{\n    virSecurityLabelDefPtr secdef;\n\n    if (mgr == NULL || mgr->drv == NULL)\n        return 0;\n\n    /* NULL model == dynamic labelling, with whatever driver\n     * is active, so we can short circuit verify check to\n     * avoid drivers de-referencing NULLs by accident\n     */\n    secdef = virDomainDefGetSecurityLabelDef(def, mgr->drv->name);\n    if (secdef == NULL || secdef->model == NULL)\n        return 0;\n\n    if (mgr->drv->domainSecurityVerify) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSecurityVerify(mgr, def);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virobject.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"security_dac.h\"",
            "#include \"security_stack.h\"",
            "#include \"security_driver.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virobject.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"security_dac.h\"\n#include \"security_stack.h\"\n#include \"security_driver.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirSecurityManagerVerify(virSecurityManagerPtr mgr,\n                         virDomainDefPtr def)\n{\n    virSecurityLabelDefPtr secdef;\n\n    if (mgr == NULL || mgr->drv == NULL)\n        return 0;\n\n    /* NULL model == dynamic labelling, with whatever driver\n     * is active, so we can short circuit verify check to\n     * avoid drivers de-referencing NULLs by accident\n     */\n    secdef = virDomainDefGetSecurityLabelDef(def, mgr->drv->name);\n    if (secdef == NULL || secdef->model == NULL)\n        return 0;\n\n    if (mgr->drv->domainSecurityVerify) {\n        int ret;\n        virObjectLock(mgr);\n        ret = mgr->drv->domainSecurityVerify(mgr, def);\n        virObjectUnlock(mgr);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefineXMLFlagsEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virXMLCheckIllegalChars",
          "args": [
            "\"name\"",
            "def->name",
            "\"\\n\""
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLCheckIllegalChars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "490-502",
          "snippet": "int\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirXMLCheckIllegalChars(const char *nodeName,\n                        const char *str,\n                        const char *illegal)\n{\n    char *c;\n    if ((c = strpbrk(str, illegal))) {\n        virReportError(VIR_ERR_XML_DETAIL,\n                       _(\"invalid char in %s: %c\"), nodeName, *c);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefParseString",
          "args": [
            "xml",
            "driver->xmlopt",
            "NULL",
            "parse_flags"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "22134-22141",
          "snippet": "virDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefParseString(const char *xmlStr,\n                        virDomainXMLOptionPtr xmlopt,\n                        void *parseOpaque,\n                        unsigned int flags)\n{\n    return virDomainDefParse(xmlStr, NULL, xmlopt, parseOpaque, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "false"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_DEFINE_VALIDATE",
            "NULL"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "279-286",
          "snippet": "virLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirLXCDriverConfigPtr virLXCDriverGetConfig(virLXCDriverPtr driver)\n{\n    virLXCDriverConfigPtr cfg;\n    lxcDriverLock(driver);\n    cfg = virObjectRef(driver->config);\n    lxcDriverUnlock(driver);\n    return cfg;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr\nlxcDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainDefPtr def = NULL;\n    virDomainObjPtr vm = NULL;\n    virDomainPtr dom = NULL;\n    virObjectEventPtr event = NULL;\n    virDomainDefPtr oldDef = NULL;\n    virLXCDriverConfigPtr cfg = virLXCDriverGetConfig(driver);\n    virCapsPtr caps = NULL;\n    unsigned int parse_flags = VIR_DOMAIN_DEF_PARSE_INACTIVE;\n\n    virCheckFlags(VIR_DOMAIN_DEFINE_VALIDATE, NULL);\n\n    if (flags & VIR_DOMAIN_DEFINE_VALIDATE)\n        parse_flags |= VIR_DOMAIN_DEF_PARSE_VALIDATE_SCHEMA;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, false)))\n        goto cleanup;\n\n    if (!(def = virDomainDefParseString(xml, driver->xmlopt,\n                                        NULL, parse_flags)))\n        goto cleanup;\n\n    if (virXMLCheckIllegalChars(\"name\", def->name, \"\\n\") < 0)\n        goto cleanup;\n\n    if (virDomainDefineXMLFlagsEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (virSecurityManagerVerify(driver->securityManager, def) < 0)\n        goto cleanup;\n\n    if ((def->nets != NULL) && !(cfg->have_netns)) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\", _(\"System lacks NETNS support\"));\n        goto cleanup;\n    }\n\n    if (!(vm = virDomainObjListAdd(driver->domains, def,\n                                   driver->xmlopt,\n                                   0, &oldDef)))\n        goto cleanup;\n\n    def = NULL;\n    vm->persistent = 1;\n\n    if (virDomainDefSave(vm->newDef ? vm->newDef : vm->def,\n                         driver->xmlopt, cfg->configDir) < 0) {\n        virDomainObjListRemove(driver->domains, vm);\n        goto cleanup;\n    }\n\n    event = virDomainEventLifecycleNewFromObj(vm,\n                                     VIR_DOMAIN_EVENT_DEFINED,\n                                     !oldDef ?\n                                     VIR_DOMAIN_EVENT_DEFINED_ADDED :\n                                     VIR_DOMAIN_EVENT_DEFINED_UPDATED);\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainDefFree(def);\n    virDomainDefFree(oldDef);\n    virDomainObjEndAPI(&vm);\n    virObjectEventStateQueue(driver->domainEventState, event);\n    virObjectUnref(caps);\n    virObjectUnref(cfg);\n    return dom;\n}"
  },
  {
    "function_name": "lxcConnectNumOfDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "384-394",
    "snippet": "static int lxcConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectNumOfDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(driver->domains, false,\n                                        virConnectNumOfDefinedDomainsCheckACL,\n                                        conn);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "driver->domains",
            "false",
            "virConnectNumOfDefinedDomainsCheckACL",
            "conn"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDefinedDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectNumOfDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(driver->domains, false,\n                                        virConnectNumOfDefinedDomainsCheckACL,\n                                        conn);\n}"
  },
  {
    "function_name": "lxcConnectListDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "370-381",
    "snippet": "static int lxcConnectListDefinedDomains(virConnectPtr conn,\n                                        char **const names, int nnames)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectListDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetInactiveNames(driver->domains, names, nnames,\n                                            virConnectListDefinedDomainsCheckACL,\n                                            conn);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListGetInactiveNames",
          "args": [
            "driver->domains",
            "names",
            "nnames",
            "virConnectListDefinedDomainsCheckACL",
            "conn"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListGetInactiveNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "768-788",
          "snippet": "int\nvirDomainObjListGetInactiveNames(virDomainObjListPtr doms,\n                                 char **const names,\n                                 int maxnames,\n                                 virDomainObjListACLFilter filter,\n                                 virConnectPtr conn)\n{\n    struct virDomainNameData data = { filter, conn,\n                                      0, 0, maxnames, names };\n    size_t i;\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyInactiveNames, &data);\n    virObjectRWUnlock(doms);\n    if (data.oom) {\n        for (i = 0; i < data.numnames; i++)\n            VIR_FREE(data.names[i]);\n        return -1;\n    }\n\n    return data.numnames;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListGetInactiveNames(virDomainObjListPtr doms,\n                                 char **const names,\n                                 int maxnames,\n                                 virDomainObjListACLFilter filter,\n                                 virConnectPtr conn)\n{\n    struct virDomainNameData data = { filter, conn,\n                                      0, 0, maxnames, names };\n    size_t i;\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyInactiveNames, &data);\n    virObjectRWUnlock(doms);\n    if (data.oom) {\n        for (i = 0; i < data.numnames; i++)\n            VIR_FREE(data.names[i]);\n        return -1;\n    }\n\n    return data.numnames;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListDefinedDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectListDefinedDomains(virConnectPtr conn,\n                                        char **const names, int nnames)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectListDefinedDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetInactiveNames(driver->domains, names, nnames,\n                                            virConnectListDefinedDomainsCheckACL,\n                                            conn);\n}"
  },
  {
    "function_name": "lxcConnectNumOfDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "359-368",
    "snippet": "static int lxcConnectNumOfDomains(virConnectPtr conn)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectNumOfDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(driver->domains, true,\n                                        virConnectNumOfDomainsCheckACL, conn);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListNumOfDomains",
          "args": [
            "driver->domains",
            "true",
            "virConnectNumOfDomainsCheckACL",
            "conn"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListNumOfDomains",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "674-685",
          "snippet": "int\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListNumOfDomains(virDomainObjListPtr doms,\n                             bool active,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainObjListData data = { filter, conn, active, 0 };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCount, &data);\n    virObjectRWUnlock(doms);\n    return data.count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectNumOfDomains(virConnectPtr conn)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectNumOfDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListNumOfDomains(driver->domains, true,\n                                        virConnectNumOfDomainsCheckACL, conn);\n}"
  },
  {
    "function_name": "lxcConnectListDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "348-357",
    "snippet": "static int lxcConnectListDomains(virConnectPtr conn, int *ids, int nids)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectListDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetActiveIDs(driver->domains, ids, nids,\n                                        virConnectListDomainsCheckACL, conn);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjListGetActiveIDs",
          "args": [
            "driver->domains",
            "ids",
            "nids",
            "virConnectListDomainsCheckACL",
            "conn"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListGetActiveIDs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "716-729",
          "snippet": "int\nvirDomainObjListGetActiveIDs(virDomainObjListPtr doms,\n                             int *ids,\n                             int maxids,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainIDData data = { filter, conn,\n                                    0, maxids, ids };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyActiveIDs, &data);\n    virObjectRWUnlock(doms);\n    return data.numids;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainObjListGetActiveIDs(virDomainObjListPtr doms,\n                             int *ids,\n                             int maxids,\n                             virDomainObjListACLFilter filter,\n                             virConnectPtr conn)\n{\n    struct virDomainIDData data = { filter, conn,\n                                    0, maxids, ids };\n    virObjectRWLockRead(doms);\n    virHashForEach(doms->objs, virDomainObjListCopyActiveIDs, &data);\n    virObjectRWUnlock(doms);\n    return data.numids;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListDomainsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectListDomains(virConnectPtr conn, int *ids, int nids)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    if (virConnectListDomainsEnsureACL(conn) < 0)\n        return -1;\n\n    return virDomainObjListGetActiveIDs(driver->domains, ids, nids,\n                                        virConnectListDomainsCheckACL, conn);\n}"
  },
  {
    "function_name": "lxcDomainIsUpdated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "330-346",
    "snippet": "static int lxcDomainIsUpdated(virDomainPtr dom)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainIsUpdatedEnsureACL(dom->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = obj->updated;\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsUpdatedEnsureACL",
          "args": [
            "dom->conn",
            "obj->def"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainIsUpdated(virDomainPtr dom)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainIsUpdatedEnsureACL(dom->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = obj->updated;\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "312-328",
    "snippet": "static int lxcDomainIsPersistent(virDomainPtr dom)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainIsPersistentEnsureACL(dom->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = obj->persistent;\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsPersistentEnsureACL",
          "args": [
            "dom->conn",
            "obj->def"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainIsPersistent(virDomainPtr dom)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainIsPersistentEnsureACL(dom->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = obj->persistent;\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "293-309",
    "snippet": "static int lxcDomainIsActive(virDomainPtr dom)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainIsActiveEnsureACL(dom->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjIsActive(obj);\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjIsActive",
          "args": [
            "obj"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjIsActive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.h",
          "lines": "2845-2849",
          "snippet": "static inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"virresctrl.h\"",
            "#include \"virsavecookie.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virperf.h\"",
            "#include \"virgic.h\"",
            "#include \"virprocess.h\"",
            "#include \"virseclabel.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virbitmap.h\"",
            "#include \"device_conf.h\"",
            "#include \"virobject.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"virnetdevvlan.h\"",
            "#include \"virnetdevbandwidth.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"numa_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"networkcommon_conf.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virthread.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"capabilities.h\"",
            "#include \"virconftypes.h\"",
            "#include \"internal.h\"",
            "#include <libxml/xpath.h>",
            "#include <libxml/tree.h>",
            "#include <libxml/parser.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void virDomainMemoryDefFree(virDomainMemoryDefPtr def);",
            "void virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);",
            "unsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);",
            "unsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);",
            "bool virDomainDefHasMemoryHotplug(const virDomainDef *def);",
            "int virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);",
            "bool virDomainDefHasUSB(const virDomainDef *def);",
            "int virDomainObjCheckActive(virDomainObjPtr dom);",
            "bool virDomainDefHasVcpusOffline(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpusMax(const virDomainDef *def);",
            "unsigned int virDomainDefGetVcpus(const virDomainDef *def);",
            "virBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);",
            "void virDomainDefVcpuOrderClear(virDomainDefPtr def);",
            "void virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);",
            "void virDomainInputDefFree(virDomainInputDefPtr def);",
            "void virDomainDiskDefFree(virDomainDiskDefPtr def);",
            "void virDomainLeaseDefFree(virDomainLeaseDefPtr def);",
            "int virDomainDiskGetType(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetSource(virDomainDiskDef const *def);",
            "void virDomainDiskEmptySource(virDomainDiskDefPtr def);",
            "const char *virDomainDiskGetDriver(const virDomainDiskDef *def);",
            "int virDomainDiskGetFormat(virDomainDiskDefPtr def);",
            "void virDomainControllerDefFree(virDomainControllerDefPtr def);",
            "void virDomainFSDefFree(virDomainFSDefPtr def);",
            "void virDomainActualNetDefFree(virDomainActualNetDefPtr def);",
            "void virDomainNetDefClear(virDomainNetDefPtr def);",
            "void virDomainNetDefFree(virDomainNetDefPtr def);",
            "void virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);",
            "void virDomainChrDefFree(virDomainChrDefPtr def);",
            "void virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);",
            "void virDomainSoundDefFree(virDomainSoundDefPtr def);",
            "void virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);",
            "void virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);",
            "void virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);",
            "void virDomainVideoDefFree(virDomainVideoDefPtr def);",
            "void virDomainVideoDefClear(virDomainVideoDefPtr def);",
            "void virDomainHostdevDefClear(virDomainHostdevDefPtr def);",
            "void virDomainHostdevDefFree(virDomainHostdevDefPtr def);",
            "void virDomainHubDefFree(virDomainHubDefPtr def);",
            "void virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);",
            "void virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);",
            "void virDomainShmemDefFree(virDomainShmemDefPtr def);",
            "void virDomainDeviceDefFree(virDomainDeviceDefPtr def);",
            "void virDomainTPMDefFree(virDomainTPMDefPtr def);",
            "void virDomainRNGDefFree(virDomainRNGDefPtr def);",
            "int virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);",
            "int virDomainVideoDefaultType(const virDomainDef *def);",
            "void virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);",
            "int virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);",
            "bool\nvirDomainDefHasManagedPR(const virDomainDef *def);",
            "bool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);",
            "bool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);",
            "bool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);",
            "bool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"virresctrl.h\"\n#include \"virsavecookie.h\"\n#include \"virtypedparam.h\"\n#include \"virperf.h\"\n#include \"virgic.h\"\n#include \"virprocess.h\"\n#include \"virseclabel.h\"\n#include \"virstoragefile.h\"\n#include \"virbitmap.h\"\n#include \"device_conf.h\"\n#include \"virobject.h\"\n#include \"virnetworkportdef.h\"\n#include \"virnetdevvlan.h\"\n#include \"virnetdevbandwidth.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevip.h\"\n#include \"virnetdev.h\"\n#include \"virsysinfo.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"numa_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"networkcommon_conf.h\"\n#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virthread.h\"\n#include \"cpu_conf.h\"\n#include \"virstorageencryption.h\"\n#include \"capabilities.h\"\n#include \"virconftypes.h\"\n#include \"internal.h\"\n#include <libxml/xpath.h>\n#include <libxml/tree.h>\n#include <libxml/parser.h>\n\nvoid virDomainMemoryDefFree(virDomainMemoryDefPtr def);\nvoid virDomainIOThreadIDDefFree(virDomainIOThreadIDDefPtr def);\nunsigned long long virDomainDefGetMemoryInitial(const virDomainDef *def);\nunsigned long long virDomainDefGetMemoryTotal(const virDomainDef *def);\nbool virDomainDefHasMemoryHotplug(const virDomainDef *def);\nint virDomainXMLOptionRunMomentPostParse(virDomainXMLOptionPtr xmlopt,\n                                         virDomainMomentDefPtr def);\nbool virDomainDefHasUSB(const virDomainDef *def);\nint virDomainObjCheckActive(virDomainObjPtr dom);\nbool virDomainDefHasVcpusOffline(const virDomainDef *def);\nunsigned int virDomainDefGetVcpusMax(const virDomainDef *def);\nunsigned int virDomainDefGetVcpus(const virDomainDef *def);\nvirBitmapPtr virDomainDefGetOnlineVcpumap(const virDomainDef *def);\nvoid virDomainDefVcpuOrderClear(virDomainDefPtr def);\nvoid virDomainGraphicsDefFree(virDomainGraphicsDefPtr def);\nvoid virDomainInputDefFree(virDomainInputDefPtr def);\nvoid virDomainDiskDefFree(virDomainDiskDefPtr def);\nvoid virDomainLeaseDefFree(virDomainLeaseDefPtr def);\nint virDomainDiskGetType(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetSource(virDomainDiskDef const *def);\nvoid virDomainDiskEmptySource(virDomainDiskDefPtr def);\nconst char *virDomainDiskGetDriver(const virDomainDiskDef *def);\nint virDomainDiskGetFormat(virDomainDiskDefPtr def);\nvoid virDomainControllerDefFree(virDomainControllerDefPtr def);\nvoid virDomainFSDefFree(virDomainFSDefPtr def);\nvoid virDomainActualNetDefFree(virDomainActualNetDefPtr def);\nvoid virDomainNetDefClear(virDomainNetDefPtr def);\nvoid virDomainNetDefFree(virDomainNetDefPtr def);\nvoid virDomainSmartcardDefFree(virDomainSmartcardDefPtr def);\nvoid virDomainChrDefFree(virDomainChrDefPtr def);\nvoid virDomainSoundCodecDefFree(virDomainSoundCodecDefPtr def);\nvoid virDomainSoundDefFree(virDomainSoundDefPtr def);\nvoid virDomainMemballoonDefFree(virDomainMemballoonDefPtr def);\nvoid virDomainNVRAMDefFree(virDomainNVRAMDefPtr def);\nvoid virDomainWatchdogDefFree(virDomainWatchdogDefPtr def);\nvoid virDomainVideoDefFree(virDomainVideoDefPtr def);\nvoid virDomainVideoDefClear(virDomainVideoDefPtr def);\nvoid virDomainHostdevDefClear(virDomainHostdevDefPtr def);\nvoid virDomainHostdevDefFree(virDomainHostdevDefPtr def);\nvoid virDomainHubDefFree(virDomainHubDefPtr def);\nvoid virDomainRedirdevDefFree(virDomainRedirdevDefPtr def);\nvoid virDomainRedirFilterDefFree(virDomainRedirFilterDefPtr def);\nvoid virDomainShmemDefFree(virDomainShmemDefPtr def);\nvoid virDomainDeviceDefFree(virDomainDeviceDefPtr def);\nvoid virDomainTPMDefFree(virDomainTPMDefPtr def);\nvoid virDomainRNGDefFree(virDomainRNGDefPtr def);\nint virDomainDeleteConfig(const char *configDir,\n                          const char *autostartDir,\n                          virDomainObjPtr dom);\nint virDomainVideoDefaultType(const virDomainDef *def);\nvoid virDomainChrSourceDefClear(virDomainChrSourceDefPtr def);\nint virDomainDiskTranslateSourcePool(virDomainDiskDefPtr def);\nbool\nvirDomainDefHasManagedPR(const virDomainDef *def);\nbool\nvirDomainDefHasNVMeDisk(const virDomainDef *def);\nbool\nvirDomainDefHasVFIOHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasMdevHostdev(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleUEFI(const virDomainDef *def);\nbool\nvirDomainDefHasOldStyleROUEFI(const virDomainDef *def);\nbool\nvirDomainGraphicsDefHasOpenGL(const virDomainDef *def);\n\nstatic inline bool\nvirDomainObjIsActive(virDomainObjPtr dom)\n{\n    return dom->def->id != -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainIsActiveEnsureACL",
          "args": [
            "dom->conn",
            "obj->def"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lxcDomObjFromDomain",
          "args": [
            "dom"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "lxcDomObjFromDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
          "lines": "104-121",
          "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapichecklxc.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"viruri.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virinitctl.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virhook.h\"",
            "#include \"viruuid.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_process.h\"",
            "#include \"lxc_native.h\"",
            "#include \"lxc_driver.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_container.h\"",
            "#include \"lxc_conf.h\"",
            "#include \"lxc_cgroup.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <sys/stat.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/utsname.h>",
            "#include <sched.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcDomainIsActive(virDomainPtr dom)\n{\n    virDomainObjPtr obj;\n    int ret = -1;\n\n    if (!(obj = lxcDomObjFromDomain(dom)))\n        goto cleanup;\n\n    if (virDomainIsActiveEnsureACL(dom->conn, obj->def) < 0)\n        goto cleanup;\n\n    ret = virDomainObjIsActive(obj);\n\n cleanup:\n    virDomainObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "lxcDomainLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "268-290",
    "snippet": "static virDomainPtr lxcDomainLookupByName(virConnectPtr conn,\n                                          const char *name)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByName(driver->domains, name);\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching name '%s'\"), name);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByNameEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByNameEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"No domain with matching name '%s'\")",
            "name"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No domain with matching name '%s'\""
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByName",
          "args": [
            "driver->domains",
            "name"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "205-222",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByName(virDomainObjListPtr doms,\n                           const char *name)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByNameLocked(doms, name);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr lxcDomainLookupByName(virConnectPtr conn,\n                                          const char *name)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByName(driver->domains, name);\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching name '%s'\"), name);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByNameEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "lxcDomainLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "241-266",
    "snippet": "static virDomainPtr lxcDomainLookupByUUID(virConnectPtr conn,\n                                          const unsigned char *uuid)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByUUID(driver->domains, uuid);\n\n    if (!vm) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching uuid '%s'\"), uuidstr);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByUUIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByUUIDEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"No domain with matching uuid '%s'\")",
            "uuidstr"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No domain with matching uuid '%s'\""
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "driver->domains",
            "uuid"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr lxcDomainLookupByUUID(virConnectPtr conn,\n                                          const unsigned char *uuid)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByUUID(driver->domains, uuid);\n\n    if (!vm) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching uuid '%s'\"), uuidstr);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByUUIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "lxcDomainLookupByID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "216-239",
    "snippet": "static virDomainPtr lxcDomainLookupByID(virConnectPtr conn,\n                                        int id)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByID(driver->domains, id);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching id %d\"), id);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&vm"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDomain",
          "args": [
            "conn",
            "vm->def->name",
            "vm->def->uuid",
            "vm->def->id"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "275-304",
          "snippet": "virDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virDomainClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virDomainClass;\n\nvirDomainPtr\nvirGetDomain(virConnectPtr conn,\n             const char *name,\n             const unsigned char *uuid,\n             int id)\n{\n    virDomainPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(name, error);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (!(ret = virObjectNew(virDomainClass)))\n        goto error;\n\n    ret->name = g_strdup(name);\n\n    ret->conn = virObjectRef(conn);\n    ret->id = id;\n    memcpy(&(ret->uuid[0]), uuid, VIR_UUID_BUFLEN);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByIDEnsureACL",
          "args": [
            "conn",
            "vm->def"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"No domain with matching id %d\")",
            "id"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No domain with matching id %d\""
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByID",
          "args": [
            "driver->domains",
            "id"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "114-134",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByID(virDomainObjListPtr doms,\n                         int id)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virHashSearch(doms->objs, virDomainObjListSearchID, &id, NULL);\n    virObjectRef(obj);\n    virObjectRWUnlock(doms);\n    if (obj) {\n        virObjectLock(obj);\n        if (obj->removing) {\n            virObjectUnlock(obj);\n            virObjectUnref(obj);\n            obj = NULL;\n        }\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainPtr lxcDomainLookupByID(virConnectPtr conn,\n                                        int id)\n{\n    virLXCDriverPtr driver = conn->privateData;\n    virDomainObjPtr vm;\n    virDomainPtr dom = NULL;\n\n    vm = virDomainObjListFindByID(driver->domains, id);\n\n    if (!vm) {\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"No domain with matching id %d\"), id);\n        goto cleanup;\n    }\n\n    if (virDomainLookupByIDEnsureACL(conn, vm->def) < 0)\n        goto cleanup;\n\n    dom = virGetDomain(conn, vm->def->name, vm->def->uuid, vm->def->id);\n\n cleanup:\n    virDomainObjEndAPI(&vm);\n    return dom;\n}"
  },
  {
    "function_name": "lxcConnectGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "198-213",
    "snippet": "static char *lxcConnectGetCapabilities(virConnectPtr conn) {\n    virLXCDriverPtr driver = conn->privateData;\n    virCapsPtr caps;\n    char *xml;\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, true)))\n        return NULL;\n\n    xml = virCapabilitiesFormatXML(caps);\n\n    virObjectUnref(caps);\n    return xml;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesFormatXML",
          "args": [
            "caps"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesFormatXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1335-1358",
          "snippet": "char *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nchar *\nvirCapabilitiesFormatXML(virCapsPtr caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"<capabilities>\\n\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    if (virCapabilitiesFormatHostXML(&caps->host, &buf) < 0)\n        goto error;\n\n    virCapabilitiesFormatGuestXML(caps->guests, caps->nguests, &buf);\n\n    virCapabilitiesFormatStoragePoolXML(caps->pools, caps->npools, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</capabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLXCDriverGetCapabilities",
          "args": [
            "driver",
            "true"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "virLXCDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_conf.c",
          "lines": "187-213",
          "snippet": "virCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"virstring.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"lxc_container.h\"",
            "#include \"configmake.h\"",
            "#include \"viruuid.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virerror.h\"",
            "#include \"lxc_domain.h\"",
            "#include \"lxc_conf.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"virstring.h\"\n#include \"virnodesuspend.h\"\n#include \"lxc_container.h\"\n#include \"configmake.h\"\n#include \"viruuid.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virerror.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_conf.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr virLXCDriverGetCapabilities(virLXCDriverPtr driver,\n                                       bool refresh)\n{\n    virCapsPtr ret;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virLXCDriverCapsInit(driver)) == NULL)\n            return NULL;\n\n        lxcDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        lxcDriverLock(driver);\n\n        if (driver->caps == NULL) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            lxcDriverUnlock(driver);\n            return virLXCDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    lxcDriverUnlock(driver);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectGetCapabilitiesEnsureACL",
          "args": [
            "conn"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic char *lxcConnectGetCapabilities(virConnectPtr conn) {\n    virLXCDriverPtr driver = conn->privateData;\n    virCapsPtr caps;\n    char *xml;\n\n    if (virConnectGetCapabilitiesEnsureACL(conn) < 0)\n        return NULL;\n\n    if (!(caps = virLXCDriverGetCapabilities(driver, true)))\n        return NULL;\n\n    xml = virCapabilitiesFormatXML(caps);\n\n    virObjectUnref(caps);\n    return xml;\n}"
  },
  {
    "function_name": "lxcConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "192-195",
    "snippet": "static int lxcConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}"
  },
  {
    "function_name": "lxcConnectIsEncrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "185-189",
    "snippet": "static int lxcConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}"
  },
  {
    "function_name": "lxcConnectIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "178-182",
    "snippet": "static int lxcConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}"
  },
  {
    "function_name": "lxcConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "168-175",
    "snippet": "static int lxcConnectClose(virConnectPtr conn)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    virCloseCallbacksRun(driver->closeCallbacks, conn, driver->domains, driver);\n    conn->privateData = NULL;\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCloseCallbacksRun",
          "args": [
            "driver->closeCallbacks",
            "conn",
            "driver->domains",
            "driver"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "virCloseCallbacksRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/virclosecallbacks.c",
          "lines": "307-360",
          "snippet": "void\nvirCloseCallbacksRun(virCloseCallbacksPtr closeCallbacks,\n                     virConnectPtr conn,\n                     virDomainObjListPtr domains,\n                     void *opaque)\n{\n    virCloseCallbacksListPtr list;\n    size_t i;\n\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    /* We must not hold the lock while running the callbacks,\n     * so first we obtain the list of callbacks, then remove\n     * them all from the hash. At that point we can release\n     * the lock and run the callbacks safely. */\n\n    virObjectLock(closeCallbacks);\n    list = virCloseCallbacksGetForConn(closeCallbacks, conn);\n    if (!list) {\n        virObjectUnlock(closeCallbacks);\n        return;\n    }\n\n    for (i = 0; i < list->nentries; i++) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(list->entries[i].uuid, uuidstr);\n        virHashRemoveEntry(closeCallbacks->list, uuidstr);\n    }\n    virObjectUnlock(closeCallbacks);\n\n    for (i = 0; i < list->nentries; i++) {\n        virDomainObjPtr vm;\n\n        /* Grab a ref and lock to the vm */\n        if (!(vm = virDomainObjListFindByUUID(domains,\n                                              list->entries[i].uuid))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(list->entries[i].uuid, uuidstr);\n            VIR_DEBUG(\"No domain object with UUID %s\", uuidstr);\n            continue;\n        }\n\n        /* Remove the ref taken out during virCloseCallbacksSet since\n         * we're about to call the callback function and we have another\n         * ref anyway (so it cannot be deleted).\n         *\n         * Call the callback function and end the API usage. */\n        virObjectUnref(vm);\n        list->entries[i].callback(vm, conn, opaque);\n        virDomainObjEndAPI(&vm);\n    }\n    VIR_FREE(list->entries);\n    VIR_FREE(list);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virclosecallbacks.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virclosecallbacks.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirCloseCallbacksRun(virCloseCallbacksPtr closeCallbacks,\n                     virConnectPtr conn,\n                     virDomainObjListPtr domains,\n                     void *opaque)\n{\n    virCloseCallbacksListPtr list;\n    size_t i;\n\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    /* We must not hold the lock while running the callbacks,\n     * so first we obtain the list of callbacks, then remove\n     * them all from the hash. At that point we can release\n     * the lock and run the callbacks safely. */\n\n    virObjectLock(closeCallbacks);\n    list = virCloseCallbacksGetForConn(closeCallbacks, conn);\n    if (!list) {\n        virObjectUnlock(closeCallbacks);\n        return;\n    }\n\n    for (i = 0; i < list->nentries; i++) {\n        char uuidstr[VIR_UUID_STRING_BUFLEN];\n        virUUIDFormat(list->entries[i].uuid, uuidstr);\n        virHashRemoveEntry(closeCallbacks->list, uuidstr);\n    }\n    virObjectUnlock(closeCallbacks);\n\n    for (i = 0; i < list->nentries; i++) {\n        virDomainObjPtr vm;\n\n        /* Grab a ref and lock to the vm */\n        if (!(vm = virDomainObjListFindByUUID(domains,\n                                              list->entries[i].uuid))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n            virUUIDFormat(list->entries[i].uuid, uuidstr);\n            VIR_DEBUG(\"No domain object with UUID %s\", uuidstr);\n            continue;\n        }\n\n        /* Remove the ref taken out during virCloseCallbacksSet since\n         * we're about to call the callback function and we have another\n         * ref anyway (so it cannot be deleted).\n         *\n         * Call the callback function and end the API usage. */\n        virObjectUnref(vm);\n        list->entries[i].callback(vm, conn, opaque);\n        virDomainObjEndAPI(&vm);\n    }\n    VIR_FREE(list->entries);\n    VIR_FREE(list);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int lxcConnectClose(virConnectPtr conn)\n{\n    virLXCDriverPtr driver = conn->privateData;\n\n    virCloseCallbacksRun(driver->closeCallbacks, conn, driver->domains, driver);\n    conn->privateData = NULL;\n    return 0;\n}"
  },
  {
    "function_name": "lxcConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "136-166",
    "snippet": "static virDrvOpenStatus lxcConnectOpen(virConnectPtr conn,\n                                       virConnectAuthPtr auth G_GNUC_UNUSED,\n                                       virConfPtr conf G_GNUC_UNUSED,\n                                       unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    /* If path isn't '/' then they typoed, tell them correct path */\n    if (STRNEQ(conn->uri->path, \"\") &&\n        STRNEQ(conn->uri->path, \"/\") &&\n        STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected LXC URI path '%s', try lxc:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    /* URI was good, but driver isn't active */\n    if (lxc_driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"lxc state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    conn->privateData = lxc_driver;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virLXCDriverPtr lxc_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectOpenEnsureACL",
          "args": [
            "conn"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"lxc state driver is not active\")"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"lxc state driver is not active\""
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unexpected LXC URI path '%s', try lxc:///system\")",
            "conn->uri->path"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"/system\""
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"/\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_RO",
            "VIR_DRV_OPEN_ERROR"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirLXCDriverPtr lxc_driver = NULL;\n\nstatic virDrvOpenStatus lxcConnectOpen(virConnectPtr conn,\n                                       virConnectAuthPtr auth G_GNUC_UNUSED,\n                                       virConfPtr conf G_GNUC_UNUSED,\n                                       unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    /* If path isn't '/' then they typoed, tell them correct path */\n    if (STRNEQ(conn->uri->path, \"\") &&\n        STRNEQ(conn->uri->path, \"/\") &&\n        STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unexpected LXC URI path '%s', try lxc:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    /* URI was good, but driver isn't active */\n    if (lxc_driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"lxc state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    conn->privateData = lxc_driver;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}"
  },
  {
    "function_name": "lxcConnectURIProbe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "125-133",
    "snippet": "static int\nlxcConnectURIProbe(char **uri)\n{\n    if (lxc_driver == NULL)\n        return 0;\n\n    *uri = g_strdup(\"lxc:///system\");\n    return 1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virLXCDriverPtr lxc_driver = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"lxc:///system\""
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirLXCDriverPtr lxc_driver = NULL;\n\nstatic int\nlxcConnectURIProbe(char **uri)\n{\n    if (lxc_driver == NULL)\n        return 0;\n\n    *uri = g_strdup(\"lxc:///system\");\n    return 1;\n}"
  },
  {
    "function_name": "lxcDomObjFromDomain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_driver.c",
    "lines": "104-121",
    "snippet": "static virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virsocket.h\"",
      "#include \"netdev_bandwidth_conf.h\"",
      "#include \"virhostdev.h\"",
      "#include \"viraccessapichecklxc.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"viruri.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virtime.h\"",
      "#include \"virprocess.h\"",
      "#include \"virnodesuspend.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virinitctl.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include \"domain_audit.h\"",
      "#include \"virfdstream.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"virhook.h\"",
      "#include \"viruuid.h\"",
      "#include \"virhostmem.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virnetdevopenvswitch.h\"",
      "#include \"virnetdevveth.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"viralloc.h\"",
      "#include \"lxc_process.h\"",
      "#include \"lxc_native.h\"",
      "#include \"lxc_driver.h\"",
      "#include \"lxc_domain.h\"",
      "#include \"lxc_container.h\"",
      "#include \"lxc_conf.h\"",
      "#include \"lxc_cgroup.h\"",
      "#include \"datatypes.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <wait.h>",
      "#include <unistd.h>",
      "#include <sys/poll.h>",
      "#include <sys/stat.h>",
      "# include <sys/sysmacros.h>",
      "#include <sys/utsname.h>",
      "#include <sched.h>",
      "#include <fcntl.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_DOMAIN",
            "_(\"no domain with matching uuid '%s' (%s)\")",
            "uuidstr",
            "domain->name"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no domain with matching uuid '%s' (%s)\""
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "userns_required",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/lxc/lxc_container.c",
          "lines": "2329-2332",
          "snippet": "static int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virnetdevip.h\"",
            "#include \"vircommand.h\"",
            "#include \"virusb.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnetdevveth.h\"",
            "#include \"viralloc.h\"",
            "#include \"lxc_container.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <selinux/selinux.h>",
            "# include <blkid.h>",
            "# include <cap-ng.h>",
            "#include <linux/fs.h>",
            "#include <linux/unistd.h>",
            "#include <linux/reboot.h>",
            "#include <sys/reboot.h>",
            "#include <mntent.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/mount.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virnetdevip.h\"\n#include \"vircommand.h\"\n#include \"virusb.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnetdevveth.h\"\n#include \"viralloc.h\"\n#include \"lxc_container.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <selinux/selinux.h>\n# include <blkid.h>\n# include <cap-ng.h>\n#include <linux/fs.h>\n#include <linux/unistd.h>\n#include <linux/reboot.h>\n#include <sys/reboot.h>\n#include <mntent.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/mount.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic int userns_required(virDomainDefPtr def)\n{\n    return def->idmap.uidmap && def->idmap.gidmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "domain->uuid",
            "uuidstr"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjListFindByUUID",
          "args": [
            "driver->domains",
            "domain->uuid"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "162-179",
          "snippet": "virDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virDomainObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virDomainObjListDispose(void *obj);\n\nvirDomainObjPtr\nvirDomainObjListFindByUUID(virDomainObjListPtr doms,\n                           const unsigned char *uuid)\n{\n    virDomainObjPtr obj;\n\n    virObjectRWLockRead(doms);\n    obj = virDomainObjListFindByUUIDLocked(doms, uuid);\n    virObjectRWUnlock(doms);\n\n    if (obj && obj->removing) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapichecklxc.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"viruri.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virprocess.h\"\n#include \"virnodesuspend.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virinitctl.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"virfdstream.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virhook.h\"\n#include \"viruuid.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevveth.h\"\n#include \"virnetdevbridge.h\"\n#include \"viralloc.h\"\n#include \"lxc_process.h\"\n#include \"lxc_native.h\"\n#include \"lxc_driver.h\"\n#include \"lxc_domain.h\"\n#include \"lxc_container.h\"\n#include \"lxc_conf.h\"\n#include \"lxc_cgroup.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <sys/stat.h>\n# include <sys/sysmacros.h>\n#include <sys/utsname.h>\n#include <sched.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virDomainObjPtr\nlxcDomObjFromDomain(virDomainPtr domain)\n{\n    virDomainObjPtr vm;\n    virLXCDriverPtr driver = domain->conn->privateData;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    vm = virDomainObjListFindByUUID(driver->domains, domain->uuid);\n    if (!vm) {\n        virUUIDFormat(domain->uuid, uuidstr);\n        virReportError(VIR_ERR_NO_DOMAIN,\n                       _(\"no domain with matching uuid '%s' (%s)\"),\n                       uuidstr, domain->name);\n        return NULL;\n    }\n\n    return vm;\n}"
  }
]