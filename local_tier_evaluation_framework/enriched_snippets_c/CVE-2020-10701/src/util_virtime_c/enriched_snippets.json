[
  {
    "function_name": "virTimeBackOffWait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "379-410",
    "snippet": "bool\nvirTimeBackOffWait(virTimeBackOffVar *var)\n{\n    unsigned long long next, t = 0;\n\n    ignore_value(virTimeMillisNowRaw(&t));\n\n    VIR_DEBUG(\"t=%llu, limit=%llu\", t, var->limit_t);\n\n    if (t > var->limit_t)\n        return 0;               /* ends the while loop */\n\n    /* Compute next wait time. Cap at VIR_TIME_BACKOFF_CAP\n     * to avoid long useless sleeps. */\n    next = var->next;\n    if (var->next < VIR_TIME_BACKOFF_CAP)\n        var->next *= 2;\n    else if (var->next > VIR_TIME_BACKOFF_CAP)\n        var->next = VIR_TIME_BACKOFF_CAP;\n\n    /* If sleeping would take us beyond the limit, then shorten the\n     * sleep.  This is so we always run the body just before the final\n     * timeout.\n     */\n    if (t + next > var->limit_t)\n        next = var->limit_t - t;\n\n    VIR_DEBUG(\"sleeping for %llu ms\", next);\n\n    g_usleep(next * 1000);\n    return 1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_TIME_BACKOFF_CAP 1000"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "next * 1000"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"sleeping for %llu ms\"",
            "next"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"t=%llu, limit=%llu\"",
            "t",
            "var->limit_t"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virTimeMillisNowRaw(&t)"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTimeMillisNowRaw",
          "args": [
            "&t"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNowRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "55-59",
          "snippet": "int virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\n#define VIR_TIME_BACKOFF_CAP 1000\n\nbool\nvirTimeBackOffWait(virTimeBackOffVar *var)\n{\n    unsigned long long next, t = 0;\n\n    ignore_value(virTimeMillisNowRaw(&t));\n\n    VIR_DEBUG(\"t=%llu, limit=%llu\", t, var->limit_t);\n\n    if (t > var->limit_t)\n        return 0;               /* ends the while loop */\n\n    /* Compute next wait time. Cap at VIR_TIME_BACKOFF_CAP\n     * to avoid long useless sleeps. */\n    next = var->next;\n    if (var->next < VIR_TIME_BACKOFF_CAP)\n        var->next *= 2;\n    else if (var->next > VIR_TIME_BACKOFF_CAP)\n        var->next = VIR_TIME_BACKOFF_CAP;\n\n    /* If sleeping would take us beyond the limit, then shorten the\n     * sleep.  This is so we always run the body just before the final\n     * timeout.\n     */\n    if (t + next > var->limit_t)\n        next = var->limit_t - t;\n\n    VIR_DEBUG(\"sleeping for %llu ms\", next);\n\n    g_usleep(next * 1000);\n    return 1;\n}"
  },
  {
    "function_name": "virTimeBackOffStart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "335-345",
    "snippet": "int\nvirTimeBackOffStart(virTimeBackOffVar *var,\n                    unsigned long long first, unsigned long long timeout)\n{\n    if (virTimeMillisNow(&var->start_t) < 0)\n        return -1;\n\n    var->next = first;\n    var->limit_t = var->start_t + timeout;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTimeMillisNow",
          "args": [
            "&var->start_t"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "214-222",
          "snippet": "int virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirTimeBackOffStart(virTimeBackOffVar *var,\n                    unsigned long long first, unsigned long long timeout)\n{\n    if (virTimeMillisNow(&var->start_t) < 0)\n        return -1;\n\n    var->next = first;\n    var->limit_t = var->start_t + timeout;\n    return 0;\n}"
  },
  {
    "function_name": "virTimeLocalOffsetFromUTC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "314-323",
    "snippet": "int\nvirTimeLocalOffsetFromUTC(long *offset)\n{\n    g_autoptr(GDateTime) now = g_date_time_new_now_local();\n    GTimeSpan diff = g_date_time_get_utc_offset(now);\n\n    /* GTimeSpan measures microseconds, we want seconds */\n    *offset = diff / 1000000;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_date_time_get_utc_offset",
          "args": [
            "now"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_date_time_new_now_local",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirTimeLocalOffsetFromUTC(long *offset)\n{\n    g_autoptr(GDateTime) now = g_date_time_new_now_local();\n    GTimeSpan diff = g_date_time_get_utc_offset(now);\n\n    /* GTimeSpan measures microseconds, we want seconds */\n    *offset = diff / 1000000;\n    return 0;\n}"
  },
  {
    "function_name": "virTimeStringThen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "285-300",
    "snippet": "char *virTimeStringThen(unsigned long long when)\n{\n    char *ret;\n\n    if (VIR_ALLOC_N(ret, VIR_TIME_STRING_BUFLEN) < 0)\n        return NULL;\n\n    if (virTimeStringThenRaw(when, ret) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to format time\"));\n        VIR_FREE(ret);\n        return NULL;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ret"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to format time\")"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to format time\""
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeStringThenRaw",
          "args": [
            "when",
            "ret"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeStringThenRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "183-202",
          "snippet": "int virTimeStringThenRaw(unsigned long long when, char *buf)\n{\n    struct tm fields;\n\n    virTimeFieldsThen(when, &fields);\n\n    fields.tm_year += 1900;\n    fields.tm_mon += 1;\n\n    if (g_snprintf(buf, VIR_TIME_STRING_BUFLEN,\n                   \"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\",\n                   fields.tm_year, fields.tm_mon, fields.tm_mday,\n                   fields.tm_hour, fields.tm_min, fields.tm_sec,\n                   (int) (when % 1000)) >= VIR_TIME_STRING_BUFLEN) {\n        errno = ERANGE;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeStringThenRaw(unsigned long long when, char *buf)\n{\n    struct tm fields;\n\n    virTimeFieldsThen(when, &fields);\n\n    fields.tm_year += 1900;\n    fields.tm_mon += 1;\n\n    if (g_snprintf(buf, VIR_TIME_STRING_BUFLEN,\n                   \"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\",\n                   fields.tm_year, fields.tm_mon, fields.tm_mday,\n                   fields.tm_hour, fields.tm_min, fields.tm_sec,\n                   (int) (when % 1000)) >= VIR_TIME_STRING_BUFLEN) {\n        errno = ERANGE;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "ret",
            "VIR_TIME_STRING_BUFLEN"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virTimeStringThen(unsigned long long when)\n{\n    char *ret;\n\n    if (VIR_ALLOC_N(ret, VIR_TIME_STRING_BUFLEN) < 0)\n        return NULL;\n\n    if (virTimeStringThenRaw(when, ret) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to format time\"));\n        VIR_FREE(ret);\n        return NULL;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virTimeStringNow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "256-271",
    "snippet": "char *virTimeStringNow(void)\n{\n    char *ret;\n\n    if (VIR_ALLOC_N(ret, VIR_TIME_STRING_BUFLEN) < 0)\n        return NULL;\n\n    if (virTimeStringNowRaw(ret) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to format time\"));\n        VIR_FREE(ret);\n        return NULL;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ret"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to format time\")"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to format time\""
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeStringNowRaw",
          "args": [
            "ret"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeStringNowRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "162-170",
          "snippet": "int virTimeStringNowRaw(char *buf)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    return virTimeStringThenRaw(now, buf);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeStringNowRaw(char *buf)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    return virTimeStringThenRaw(now, buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "ret",
            "VIR_TIME_STRING_BUFLEN"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virTimeStringNow(void)\n{\n    char *ret;\n\n    if (VIR_ALLOC_N(ret, VIR_TIME_STRING_BUFLEN) < 0)\n        return NULL;\n\n    if (virTimeStringNowRaw(ret) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to format time\"));\n        VIR_FREE(ret);\n        return NULL;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virTimeFieldsNow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "234-243",
    "snippet": "int virTimeFieldsNow(struct tm *fields)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    virTimeFieldsThen(now, fields);\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTimeFieldsThen",
          "args": [
            "now",
            "fields"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeFieldsThen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "108-150",
          "snippet": "void virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SECS_PER_DAY    (SECS_PER_HOUR * 24)",
            "#define SECS_PER_HOUR   (60 * 60)"
          ],
          "globals_used": [
            "static const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SECS_PER_DAY    (SECS_PER_HOUR * 24)\n#define SECS_PER_HOUR   (60 * 60)\n\nstatic const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};\n\nvoid virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeMillisNow",
          "args": [
            "&now"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "214-222",
          "snippet": "int virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeFieldsNow(struct tm *fields)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNow(&now) < 0)\n        return -1;\n\n    virTimeFieldsThen(now, fields);\n    return 0;\n}"
  },
  {
    "function_name": "virTimeMillisNow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "214-222",
    "snippet": "int virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to get current time\")"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get current time\""
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeMillisNowRaw",
          "args": [
            "now"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNowRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "55-59",
          "snippet": "int virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNow(unsigned long long *now)\n{\n    if (virTimeMillisNowRaw(now) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current time\"));\n        return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virTimeStringThenRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "183-202",
    "snippet": "int virTimeStringThenRaw(unsigned long long when, char *buf)\n{\n    struct tm fields;\n\n    virTimeFieldsThen(when, &fields);\n\n    fields.tm_year += 1900;\n    fields.tm_mon += 1;\n\n    if (g_snprintf(buf, VIR_TIME_STRING_BUFLEN,\n                   \"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\",\n                   fields.tm_year, fields.tm_mon, fields.tm_mday,\n                   fields.tm_hour, fields.tm_min, fields.tm_sec,\n                   (int) (when % 1000)) >= VIR_TIME_STRING_BUFLEN) {\n        errno = ERANGE;\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "buf",
            "VIR_TIME_STRING_BUFLEN",
            "\"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\"",
            "fields.tm_year",
            "fields.tm_mon",
            "fields.tm_mday",
            "fields.tm_hour",
            "fields.tm_min",
            "fields.tm_sec",
            "(int) (when % 1000)"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTimeFieldsThen",
          "args": [
            "when",
            "&fields"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeFieldsThen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "108-150",
          "snippet": "void virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SECS_PER_DAY    (SECS_PER_HOUR * 24)",
            "#define SECS_PER_HOUR   (60 * 60)"
          ],
          "globals_used": [
            "static const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SECS_PER_DAY    (SECS_PER_HOUR * 24)\n#define SECS_PER_HOUR   (60 * 60)\n\nstatic const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};\n\nvoid virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeStringThenRaw(unsigned long long when, char *buf)\n{\n    struct tm fields;\n\n    virTimeFieldsThen(when, &fields);\n\n    fields.tm_year += 1900;\n    fields.tm_mon += 1;\n\n    if (g_snprintf(buf, VIR_TIME_STRING_BUFLEN,\n                   \"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\",\n                   fields.tm_year, fields.tm_mon, fields.tm_mday,\n                   fields.tm_hour, fields.tm_min, fields.tm_sec,\n                   (int) (when % 1000)) >= VIR_TIME_STRING_BUFLEN) {\n        errno = ERANGE;\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virTimeStringNowRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "162-170",
    "snippet": "int virTimeStringNowRaw(char *buf)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    return virTimeStringThenRaw(now, buf);\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTimeStringThenRaw",
          "args": [
            "now",
            "buf"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeStringThenRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "183-202",
          "snippet": "int virTimeStringThenRaw(unsigned long long when, char *buf)\n{\n    struct tm fields;\n\n    virTimeFieldsThen(when, &fields);\n\n    fields.tm_year += 1900;\n    fields.tm_mon += 1;\n\n    if (g_snprintf(buf, VIR_TIME_STRING_BUFLEN,\n                   \"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\",\n                   fields.tm_year, fields.tm_mon, fields.tm_mday,\n                   fields.tm_hour, fields.tm_min, fields.tm_sec,\n                   (int) (when % 1000)) >= VIR_TIME_STRING_BUFLEN) {\n        errno = ERANGE;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeStringThenRaw(unsigned long long when, char *buf)\n{\n    struct tm fields;\n\n    virTimeFieldsThen(when, &fields);\n\n    fields.tm_year += 1900;\n    fields.tm_mon += 1;\n\n    if (g_snprintf(buf, VIR_TIME_STRING_BUFLEN,\n                   \"%4d-%02d-%02d %02d:%02d:%02d.%03d+0000\",\n                   fields.tm_year, fields.tm_mon, fields.tm_mday,\n                   fields.tm_hour, fields.tm_min, fields.tm_sec,\n                   (int) (when % 1000)) >= VIR_TIME_STRING_BUFLEN) {\n        errno = ERANGE;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeMillisNowRaw",
          "args": [
            "&now"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNowRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "55-59",
          "snippet": "int virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeStringNowRaw(char *buf)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    return virTimeStringThenRaw(now, buf);\n}"
  },
  {
    "function_name": "virTimeFieldsThen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "108-150",
    "snippet": "void virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define SECS_PER_DAY    (SECS_PER_HOUR * 24)",
      "#define SECS_PER_HOUR   (60 * 60)"
    ],
    "globals_used": [
      "static const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_leap_year",
          "args": [
            "y"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LEAPS_THRU_END_OF",
          "args": [
            "y - 1"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LEAPS_THRU_END_OF",
          "args": [
            "yg - 1"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_leap_year",
          "args": [
            "y"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SECS_PER_DAY    (SECS_PER_HOUR * 24)\n#define SECS_PER_HOUR   (60 * 60)\n\nstatic const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};\n\nvoid virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}"
  },
  {
    "function_name": "virTimeFieldsNowRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "71-81",
    "snippet": "int virTimeFieldsNowRaw(struct tm *fields)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    virTimeFieldsThen(now, fields);\n\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTimeFieldsThen",
          "args": [
            "now",
            "fields"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeFieldsThen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "108-150",
          "snippet": "void virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SECS_PER_DAY    (SECS_PER_HOUR * 24)",
            "#define SECS_PER_HOUR   (60 * 60)"
          ],
          "globals_used": [
            "static const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SECS_PER_DAY    (SECS_PER_HOUR * 24)\n#define SECS_PER_HOUR   (60 * 60)\n\nstatic const unsigned short int mon_yday[2][13] = {\n    /* Normal years.  */\n    { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365 },\n    /* Leap years.  */\n    { 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366 }\n};\n\nvoid virTimeFieldsThen(unsigned long long when, struct tm *fields)\n{\n    /* This code is taken from GLibC under terms of LGPLv2+ */\n    /* Remove the 'offset' or GMT manipulation since we don't care. See\n     * commit id '3ec12898' comments regarding localtime.\n     */\n    long int days, rem, y;\n    const unsigned short int *ip;\n    unsigned long long whenSecs = when / 1000ull;\n\n    days = whenSecs / SECS_PER_DAY;\n    rem = whenSecs % SECS_PER_DAY;\n\n    fields->tm_hour = rem / SECS_PER_HOUR;\n    rem %= SECS_PER_HOUR;\n    fields->tm_min = rem / 60;\n    fields->tm_sec = rem % 60;\n    /* January 1, 1970 was a Thursday.  */\n    fields->tm_wday = (4 + days) % 7;\n    if (fields->tm_wday < 0)\n        fields->tm_wday += 7;\n    y = 1970;\n\n    while (days < 0 || days >= (is_leap_year(y) ? 366 : 365)) {\n        /* Guess a corrected year, assuming 365 days per year.  */\n        long int yg = y + days / 365 - (days % 365 < 0);\n\n      /* Adjust DAYS and Y to match the guessed year.  */\n      days -= ((yg - y) * 365\n               + LEAPS_THRU_END_OF(yg - 1)\n               - LEAPS_THRU_END_OF(y - 1));\n      y = yg;\n    }\n    fields->tm_year = y - 1900;\n\n    fields->tm_yday = days;\n    ip = mon_yday[is_leap_year(y)];\n    for (y = 11; days < (long int) ip[y]; --y)\n        continue;\n    days -= ip[y];\n    fields->tm_mon = y;\n    fields->tm_mday = days + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTimeMillisNowRaw",
          "args": [
            "&now"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "virTimeMillisNowRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
          "lines": "55-59",
          "snippet": "int virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtime.h\"",
            "#include <sys/time.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeFieldsNowRaw(struct tm *fields)\n{\n    unsigned long long now;\n\n    if (virTimeMillisNowRaw(&now) < 0)\n        return -1;\n\n    virTimeFieldsThen(now, fields);\n\n    return 0;\n}"
  },
  {
    "function_name": "virTimeMillisNowRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtime.c",
    "lines": "55-59",
    "snippet": "int virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}",
    "includes": [
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include \"virtime.h\"",
      "#include <sys/time.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_get_real_time",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtime.h\"\n#include <sys/time.h>\n#include <unistd.h>\n#include <config.h>\n\nint virTimeMillisNowRaw(unsigned long long *now)\n{\n    *now = g_get_real_time() / 1000;\n    return 0;\n}"
  }
]