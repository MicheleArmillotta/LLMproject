[
  {
    "function_name": "qemuInterfaceOpenVhostNet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "675-749",
    "snippet": "int\nqemuInterfaceOpenVhostNet(virDomainDefPtr def,\n                          virDomainNetDefPtr net,\n                          int *vhostfd,\n                          size_t *vhostfdSize)\n{\n    size_t i;\n    const char *vhostnet_path = net->backend.vhost;\n\n    if (!vhostnet_path)\n        vhostnet_path = \"/dev/vhost-net\";\n\n    /* If running a plain QEMU guest, or\n     * if the config says explicitly to not use vhost, return now */\n    if (def->virtType != VIR_DOMAIN_VIRT_KVM ||\n        net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_QEMU) {\n        *vhostfdSize = 0;\n        return 0;\n    }\n\n    /* If qemu doesn't support vhost-net mode (including the -netdev and\n     * -device command options), don't try to open the device.\n     */\n    if (!qemuDomainSupportsNicdev(def, net)) {\n        if (net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_VHOST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"vhost-net is not supported with \"\n                                   \"this QEMU binary\"));\n            return -1;\n        }\n        *vhostfdSize = 0;\n        return 0;\n    }\n\n    /* If the nic model isn't virtio, don't try to open. */\n    if (!virDomainNetIsVirtioModel(net)) {\n        if (net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_VHOST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"vhost-net is only supported for \"\n                                   \"virtio network interfaces\"));\n            return -1;\n        }\n        *vhostfdSize = 0;\n        return 0;\n    }\n\n    for (i = 0; i < *vhostfdSize; i++) {\n        vhostfd[i] = open(vhostnet_path, O_RDWR);\n\n        /* If the config says explicitly to use vhost and we couldn't open it,\n         * report an error.\n         */\n        if (vhostfd[i] < 0) {\n            virDomainAuditNetDevice(def, net, vhostnet_path, false);\n            if (net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_VHOST) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               \"%s\", _(\"vhost-net was requested for an interface, \"\n                                       \"but is unavailable\"));\n                goto error;\n            }\n            VIR_WARN(\"Unable to open vhost-net. Opened so far %zu, requested %zu\",\n                     i, *vhostfdSize);\n            *vhostfdSize = i;\n            break;\n        }\n    }\n    virDomainAuditNetDevice(def, net, vhostnet_path, *vhostfdSize);\n    return 0;\n\n error:\n    while (i--)\n        VIR_FORCE_CLOSE(vhostfd[i]);\n\n    return -1;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "vhostfd[i]"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainAuditNetDevice",
          "args": [
            "def",
            "net",
            "vhostnet_path",
            "*vhostfdSize"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNetDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "298-327",
          "snippet": "void\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to open vhost-net. Opened so far %zu, requested %zu\"",
            "i",
            "*vhostfdSize"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vhost-net was requested for an interface, \"\n                                       \"but is unavailable\")"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"vhost-net was requested for an interface, \"\n                                       \"but is unavailable\""
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "vhostnet_path",
            "O_RDWR"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "qemuMonitorBlockdevReopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_monitor.c",
          "lines": "4357-4367",
          "snippet": "int\nqemuMonitorBlockdevReopen(qemuMonitorPtr mon,\n                          virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevReopen(mon, props);\n}",
          "includes": [
            "#include \"qemu_monitor_priv.h\"",
            "# include \"libvirt_qemu_probes.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virobject.h\"",
            "#include \"virprocess.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_monitor_json.h\"",
            "#include \"qemu_monitor_text.h\"",
            "#include \"qemu_monitor.h\"",
            "#include <gio/gio.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qemu_monitor_priv.h\"\n# include \"libvirt_qemu_probes.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virobject.h\"\n#include \"virprocess.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_monitor_json.h\"\n#include \"qemu_monitor_text.h\"\n#include \"qemu_monitor.h\"\n#include <gio/gio.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <poll.h>\n#include <config.h>\n\nint\nqemuMonitorBlockdevReopen(qemuMonitorPtr mon,\n                          virJSONValuePtr *props)\n{\n    VIR_DEBUG(\"props=%p (node-name=%s)\", *props,\n              NULLSTR(virJSONValueObjectGetString(*props, \"node-name\")));\n\n    QEMU_CHECK_MONITOR(mon);\n\n    return qemuMonitorJSONBlockdevReopen(mon, props);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vhost-net is only supported for \"\n                                   \"virtio network interfaces\")"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainNetIsVirtioModel",
          "args": [
            "net"
          ],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetIsVirtioModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30344-30350",
          "snippet": "bool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vhost-net is not supported with \"\n                                   \"this QEMU binary\")"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainSupportsNicdev",
          "args": [
            "def",
            "net"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainSupportsNicdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "13826-13839",
          "snippet": "bool\nqemuDomainSupportsNicdev(virDomainDefPtr def,\n                         virDomainNetDefPtr net)\n{\n    /* non-virtio ARM nics require legacy -net nic */\n    if (((def->os.arch == VIR_ARCH_ARMV6L) ||\n        (def->os.arch == VIR_ARCH_ARMV7L) ||\n        (def->os.arch == VIR_ARCH_AARCH64)) &&\n        net->info.type != VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_MMIO &&\n        net->info.type != VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI)\n        return false;\n\n    return true;\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainSupportsNicdev(virDomainDefPtr def,\n                         virDomainNetDefPtr net)\n{\n    /* non-virtio ARM nics require legacy -net nic */\n    if (((def->os.arch == VIR_ARCH_ARMV6L) ||\n        (def->os.arch == VIR_ARCH_ARMV7L) ||\n        (def->os.arch == VIR_ARCH_AARCH64)) &&\n        net->info.type != VIR_DOMAIN_DEVICE_ADDRESS_TYPE_VIRTIO_MMIO &&\n        net->info.type != VIR_DOMAIN_DEVICE_ADDRESS_TYPE_PCI)\n        return false;\n\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceOpenVhostNet(virDomainDefPtr def,\n                          virDomainNetDefPtr net,\n                          int *vhostfd,\n                          size_t *vhostfdSize)\n{\n    size_t i;\n    const char *vhostnet_path = net->backend.vhost;\n\n    if (!vhostnet_path)\n        vhostnet_path = \"/dev/vhost-net\";\n\n    /* If running a plain QEMU guest, or\n     * if the config says explicitly to not use vhost, return now */\n    if (def->virtType != VIR_DOMAIN_VIRT_KVM ||\n        net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_QEMU) {\n        *vhostfdSize = 0;\n        return 0;\n    }\n\n    /* If qemu doesn't support vhost-net mode (including the -netdev and\n     * -device command options), don't try to open the device.\n     */\n    if (!qemuDomainSupportsNicdev(def, net)) {\n        if (net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_VHOST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"vhost-net is not supported with \"\n                                   \"this QEMU binary\"));\n            return -1;\n        }\n        *vhostfdSize = 0;\n        return 0;\n    }\n\n    /* If the nic model isn't virtio, don't try to open. */\n    if (!virDomainNetIsVirtioModel(net)) {\n        if (net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_VHOST) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           \"%s\", _(\"vhost-net is only supported for \"\n                                   \"virtio network interfaces\"));\n            return -1;\n        }\n        *vhostfdSize = 0;\n        return 0;\n    }\n\n    for (i = 0; i < *vhostfdSize; i++) {\n        vhostfd[i] = open(vhostnet_path, O_RDWR);\n\n        /* If the config says explicitly to use vhost and we couldn't open it,\n         * report an error.\n         */\n        if (vhostfd[i] < 0) {\n            virDomainAuditNetDevice(def, net, vhostnet_path, false);\n            if (net->driver.virtio.name == VIR_DOMAIN_NET_BACKEND_TYPE_VHOST) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               \"%s\", _(\"vhost-net was requested for an interface, \"\n                                       \"but is unavailable\"));\n                goto error;\n            }\n            VIR_WARN(\"Unable to open vhost-net. Opened so far %zu, requested %zu\",\n                     i, *vhostfdSize);\n            *vhostfdSize = i;\n            break;\n        }\n    }\n    virDomainAuditNetDevice(def, net, vhostnet_path, *vhostfdSize);\n    return 0;\n\n error:\n    while (i--)\n        VIR_FORCE_CLOSE(vhostfd[i]);\n\n    return -1;\n}"
  },
  {
    "function_name": "qemuInterfacePrepareSlirp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "633-657",
    "snippet": "qemuSlirpPtr\nqemuInterfacePrepareSlirp(virQEMUDriverPtr driver,\n                          virDomainNetDefPtr net)\n{\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    g_autoptr(qemuSlirp) slirp = NULL;\n    size_t i;\n\n    if (!(slirp = qemuSlirpNewForHelper(cfg->slirpHelperName)))\n        return NULL;\n\n    for (i = 0; i < net->guestIP.nips; i++) {\n        const virNetDevIPAddr *ip = net->guestIP.ips[i];\n\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&ip->address, AF_INET) &&\n            !qemuSlirpHasFeature(slirp, QEMU_SLIRP_FEATURE_IPV4))\n            return NULL;\n\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&ip->address, AF_INET6) &&\n            !qemuSlirpHasFeature(slirp, QEMU_SLIRP_FEATURE_IPV6))\n            return NULL;\n    }\n\n    return g_steal_pointer(&slirp);\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&slirp"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSlirpHasFeature",
          "args": [
            "slirp",
            "QEMU_SLIRP_FEATURE_IPV6"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSlirpHasFeature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_slirp.c",
          "lines": "73-78",
          "snippet": "bool\nqemuSlirpHasFeature(const qemuSlirp *slirp,\n                    qemuSlirpFeature feature)\n{\n    return virBitmapIsBitSet(slirp->features, feature);\n}",
          "includes": [
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_dbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_dbus.h\"\n#include <config.h>\n\nbool\nqemuSlirpHasFeature(const qemuSlirp *slirp,\n                    qemuSlirpFeature feature)\n{\n    return virBitmapIsBitSet(slirp->features, feature);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&ip->address",
            "AF_INET6"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SOCKET_ADDR_IS_FAMILY",
          "args": [
            "&ip->address",
            "AF_INET"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSlirpNewForHelper",
          "args": [
            "cfg->slirpHelperName"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSlirpNewForHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_slirp.c",
          "lines": "97-145",
          "snippet": "qemuSlirpPtr\nqemuSlirpNewForHelper(const char *helper)\n{\n    g_autoptr(qemuSlirp) slirp = NULL;\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *output = NULL;\n    g_autoptr(virJSONValue) doc = NULL;\n    virJSONValuePtr featuresJSON;\n    size_t i, nfeatures;\n\n    if (!helper)\n        return NULL;\n\n    slirp = qemuSlirpNew();\n    if (!slirp) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to allocate slirp for '%s'\"), helper);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(helper, \"--print-capabilities\", NULL);\n    virCommandSetOutputBuffer(cmd, &output);\n    if (virCommandRun(cmd, NULL) < 0)\n        return NULL;\n\n    if (!(doc = virJSONValueFromString(output)) ||\n        !(featuresJSON = virJSONValueObjectGetArray(doc, \"features\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to parse json capabilities '%s'\"),\n                       helper);\n        return NULL;\n    }\n\n    nfeatures = virJSONValueArraySize(featuresJSON);\n    for (i = 0; i < nfeatures; i++) {\n        virJSONValuePtr item = virJSONValueArrayGet(featuresJSON, i);\n        const char *tmpStr = virJSONValueGetString(item);\n        int tmp;\n\n        if ((tmp = qemuSlirpFeatureTypeFromString(tmpStr)) <= 0) {\n            VIR_WARN(\"unknown slirp feature %s\", tmpStr);\n            continue;\n        }\n\n        qemuSlirpSetFeature(slirp, tmp);\n    }\n\n    return g_steal_pointer(&slirp);\n}",
          "includes": [
            "#include \"virtime.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"virerror.h\"",
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_dbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtime.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"virerror.h\"\n#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_dbus.h\"\n#include <config.h>\n\nqemuSlirpPtr\nqemuSlirpNewForHelper(const char *helper)\n{\n    g_autoptr(qemuSlirp) slirp = NULL;\n    g_autoptr(virCommand) cmd = NULL;\n    g_autofree char *output = NULL;\n    g_autoptr(virJSONValue) doc = NULL;\n    virJSONValuePtr featuresJSON;\n    size_t i, nfeatures;\n\n    if (!helper)\n        return NULL;\n\n    slirp = qemuSlirpNew();\n    if (!slirp) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to allocate slirp for '%s'\"), helper);\n        return NULL;\n    }\n\n    cmd = virCommandNewArgList(helper, \"--print-capabilities\", NULL);\n    virCommandSetOutputBuffer(cmd, &output);\n    if (virCommandRun(cmd, NULL) < 0)\n        return NULL;\n\n    if (!(doc = virJSONValueFromString(output)) ||\n        !(featuresJSON = virJSONValueObjectGetArray(doc, \"features\"))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unable to parse json capabilities '%s'\"),\n                       helper);\n        return NULL;\n    }\n\n    nfeatures = virJSONValueArraySize(featuresJSON);\n    for (i = 0; i < nfeatures; i++) {\n        virJSONValuePtr item = virJSONValueArrayGet(featuresJSON, i);\n        const char *tmpStr = virJSONValueGetString(item);\n        int tmp;\n\n        if ((tmp = qemuSlirpFeatureTypeFromString(tmpStr)) <= 0) {\n            VIR_WARN(\"unknown slirp feature %s\", tmpStr);\n            continue;\n        }\n\n        qemuSlirpSetFeature(slirp, tmp);\n    }\n\n    return g_steal_pointer(&slirp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nqemuSlirpPtr\nqemuInterfacePrepareSlirp(virQEMUDriverPtr driver,\n                          virDomainNetDefPtr net)\n{\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    g_autoptr(qemuSlirp) slirp = NULL;\n    size_t i;\n\n    if (!(slirp = qemuSlirpNewForHelper(cfg->slirpHelperName)))\n        return NULL;\n\n    for (i = 0; i < net->guestIP.nips; i++) {\n        const virNetDevIPAddr *ip = net->guestIP.ips[i];\n\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&ip->address, AF_INET) &&\n            !qemuSlirpHasFeature(slirp, QEMU_SLIRP_FEATURE_IPV4))\n            return NULL;\n\n        if (VIR_SOCKET_ADDR_IS_FAMILY(&ip->address, AF_INET6) &&\n            !qemuSlirpHasFeature(slirp, QEMU_SLIRP_FEATURE_IPV6))\n            return NULL;\n    }\n\n    return g_steal_pointer(&slirp);\n}"
  },
  {
    "function_name": "qemuInterfaceBridgeConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "525-630",
    "snippet": "int\nqemuInterfaceBridgeConnect(virDomainDefPtr def,\n                           virQEMUDriverPtr driver,\n                           virDomainNetDefPtr net,\n                           int *tapfd,\n                           size_t *tapfdSize)\n{\n    const char *brname;\n    int ret = -1;\n    unsigned int tap_create_flags = VIR_NETDEV_TAP_CREATE_IFUP;\n    bool template_ifname = false;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    const char *tunpath = \"/dev/net/tun\";\n\n    if (net->backend.tap) {\n        tunpath = net->backend.tap;\n        if (!(virQEMUDriverIsPrivileged(driver))) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use custom tap device in session mode\"));\n            goto cleanup;\n        }\n    }\n\n    if (!(brname = virDomainNetGetActualBridgeName(net))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Missing bridge name\"));\n        goto cleanup;\n    }\n\n    if (!net->ifname ||\n        STRPREFIX(net->ifname, VIR_NET_GENERATED_TAP_PREFIX) ||\n        strchr(net->ifname, '%')) {\n        VIR_FREE(net->ifname);\n        net->ifname = g_strdup(VIR_NET_GENERATED_TAP_PREFIX \"%d\");\n        /* avoid exposing vnet%d in getXMLDesc or error outputs */\n        template_ifname = true;\n    }\n\n    if (virDomainNetIsVirtioModel(net))\n        tap_create_flags |= VIR_NETDEV_TAP_CREATE_VNET_HDR;\n\n    if (virQEMUDriverIsPrivileged(driver)) {\n        if (virNetDevTapCreateInBridgePort(brname, &net->ifname, &net->mac,\n                                           def->uuid, tunpath, tapfd, *tapfdSize,\n                                           virDomainNetGetActualVirtPortProfile(net),\n                                           virDomainNetGetActualVlan(net),\n                                           virDomainNetGetActualPortOptionsIsolated(net),\n                                           net->coalesce, 0, NULL,\n                                           tap_create_flags) < 0) {\n            virDomainAuditNetDevice(def, net, tunpath, false);\n            goto cleanup;\n        }\n        if (virDomainNetGetActualBridgeMACTableManager(net)\n            == VIR_NETWORK_BRIDGE_MAC_TABLE_MANAGER_LIBVIRT) {\n            /* libvirt is managing the FDB of the bridge this device\n             * is attaching to, so we need to turn off learning and\n             * unicast_flood on the device to prevent the kernel from\n             * adding any FDB entries for it. We will add an fdb\n             * entry ourselves (during qemuInterfaceStartDevices(),\n             * using the MAC address from the interface config.\n             */\n            if (virNetDevBridgePortSetLearning(brname, net->ifname, false) < 0)\n                goto cleanup;\n            if (virNetDevBridgePortSetUnicastFlood(brname, net->ifname, false) < 0)\n                goto cleanup;\n        }\n    } else {\n        if (qemuCreateInBridgePortWithHelper(cfg, brname,\n                                             &net->ifname,\n                                             tapfd, tap_create_flags) < 0) {\n            virDomainAuditNetDevice(def, net, tunpath, false);\n            goto cleanup;\n        }\n        /* qemuCreateInBridgePortWithHelper can only create a single FD */\n        if (*tapfdSize > 1) {\n            VIR_WARN(\"Ignoring multiqueue network request\");\n            *tapfdSize = 1;\n        }\n    }\n\n    virDomainAuditNetDevice(def, net, tunpath, true);\n\n    if (cfg->macFilter &&\n        ebtablesAddForwardAllowIn(driver->ebtables,\n                                  net->ifname,\n                                  &net->mac) < 0)\n        goto cleanup;\n\n    if (net->filter &&\n        virDomainConfNWFilterInstantiate(def->name, def->uuid, net, false) < 0) {\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        size_t i;\n        for (i = 0; i < *tapfdSize && tapfd[i] >= 0; i++)\n            VIR_FORCE_CLOSE(tapfd[i]);\n        if (template_ifname)\n            VIR_FREE(net->ifname);\n    }\n    virObjectUnref(cfg);\n\n    return ret;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "net->ifname"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "tapfd[i]"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainConfNWFilterInstantiate",
          "args": [
            "def->name",
            "def->uuid",
            "net",
            "false"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfNWFilterInstantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
          "lines": "78-121",
          "snippet": "int\nvirDomainConfNWFilterInstantiate(const char *vmname,\n                                 const unsigned char *vmuuid,\n                                 virDomainNetDefPtr net,\n                                 bool ignoreExists)\n{\n    virConnectPtr conn = virGetConnectNWFilter();\n    virNWFilterBindingDefPtr def = NULL;\n    virNWFilterBindingPtr binding = NULL;\n    char *xml = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"vmname=%s portdev=%s filter=%s ignoreExists=%d\",\n              vmname, NULLSTR(net->ifname), NULLSTR(net->filter), ignoreExists);\n\n    if (!conn)\n        goto cleanup;\n\n    if (ignoreExists) {\n        binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n        if (binding) {\n            ret = 0;\n            goto cleanup;\n        }\n    }\n\n    if (!(def = virNWFilterBindingDefForNet(vmname, vmuuid, net)))\n        goto cleanup;\n\n    if (!(xml = virNWFilterBindingDefFormat(def)))\n        goto cleanup;\n\n    if (!(binding = virNWFilterBindingCreateXML(conn, xml, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(xml);\n    virNWFilterBindingDefFree(def);\n    virObjectUnref(binding);\n    virObjectUnref(conn);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainConfNWFilterInstantiate(const char *vmname,\n                                 const unsigned char *vmuuid,\n                                 virDomainNetDefPtr net,\n                                 bool ignoreExists)\n{\n    virConnectPtr conn = virGetConnectNWFilter();\n    virNWFilterBindingDefPtr def = NULL;\n    virNWFilterBindingPtr binding = NULL;\n    char *xml = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"vmname=%s portdev=%s filter=%s ignoreExists=%d\",\n              vmname, NULLSTR(net->ifname), NULLSTR(net->filter), ignoreExists);\n\n    if (!conn)\n        goto cleanup;\n\n    if (ignoreExists) {\n        binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n        if (binding) {\n            ret = 0;\n            goto cleanup;\n        }\n    }\n\n    if (!(def = virNWFilterBindingDefForNet(vmname, vmuuid, net)))\n        goto cleanup;\n\n    if (!(xml = virNWFilterBindingDefFormat(def)))\n        goto cleanup;\n\n    if (!(binding = virNWFilterBindingCreateXML(conn, xml, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(xml);\n    virNWFilterBindingDefFree(def);\n    virObjectUnref(binding);\n    virObjectUnref(conn);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebtablesAddForwardAllowIn",
          "args": [
            "driver->ebtables",
            "net->ifname",
            "&net->mac"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "ebtablesAddForwardAllowIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
          "lines": "155-164",
          "snippet": "int\nebtablesAddForwardAllowIn(ebtablesContext *ctx,\n                          const char *iface,\n                          const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, ADD);\n}",
          "includes": [
            "#include \"virfirewall.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virebtables.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nebtablesAddForwardAllowIn(ebtablesContext *ctx,\n                          const char *iface,\n                          const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, ADD);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainAuditNetDevice",
          "args": [
            "def",
            "net",
            "tunpath",
            "true"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNetDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "298-327",
          "snippet": "void\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Ignoring multiqueue network request\""
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuCreateInBridgePortWithHelper",
          "args": [
            "cfg",
            "brname",
            "&net->ifname",
            "tapfd",
            "tap_create_flags"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "qemuCreateInBridgePortWithHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
          "lines": "306-383",
          "snippet": "static int\nqemuCreateInBridgePortWithHelper(virQEMUDriverConfigPtr cfg,\n                                 const char *brname,\n                                 char **ifname,\n                                 int *tapfd,\n                                 unsigned int flags)\n{\n    virCommandPtr cmd;\n    char *errbuf = NULL, *cmdstr = NULL;\n    int pair[2] = { -1, -1 };\n\n    if ((flags & ~VIR_NETDEV_TAP_CREATE_VNET_HDR) != VIR_NETDEV_TAP_CREATE_IFUP)\n        return -1;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to create socket\"));\n        return -1;\n    }\n\n    if (!virFileIsExecutable(cfg->bridgeHelperName)) {\n        virReportSystemError(errno, _(\"'%s' is not a suitable bridge helper\"),\n                             cfg->bridgeHelperName);\n        return -1;\n    }\n\n    cmd = virCommandNew(cfg->bridgeHelperName);\n    if (flags & VIR_NETDEV_TAP_CREATE_VNET_HDR)\n        virCommandAddArgFormat(cmd, \"--use-vnet\");\n    virCommandAddArgFormat(cmd, \"--br=%s\", brname);\n    virCommandAddArgFormat(cmd, \"--fd=%d\", pair[1]);\n    virCommandSetErrorBuffer(cmd, &errbuf);\n    virCommandDoAsyncIO(cmd);\n    virCommandPassFD(cmd, pair[1],\n                     VIR_COMMAND_PASS_FD_CLOSE_PARENT);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    if (virCommandRunAsync(cmd, NULL) < 0) {\n        *tapfd = -1;\n        goto cleanup;\n    }\n\n    do {\n        *tapfd = virSocketRecvFD(pair[0], 0);\n    } while (*tapfd < 0 && errno == EINTR);\n\n    if (*tapfd < 0) {\n        char *errstr = NULL;\n\n        if (!(cmdstr = virCommandToString(cmd, false)))\n            goto cleanup;\n        virCommandAbort(cmd);\n\n        if (errbuf && *errbuf)\n            errstr = g_strdup_printf(\"\\nstderr=%s\", errbuf);\n\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n            _(\"%s: failed to communicate with bridge helper: %s%s\"),\n            cmdstr, g_strerror(errno),\n            NULLSTR_EMPTY(errstr));\n        VIR_FREE(errstr);\n        goto cleanup;\n    }\n\n    if (virNetDevTapGetName(*tapfd, ifname) < 0 ||\n        virCommandWait(cmd, NULL) < 0) {\n        VIR_FORCE_CLOSE(*tapfd);\n        *tapfd = -1;\n    }\n\n cleanup:\n    VIR_FREE(cmdstr);\n    VIR_FREE(errbuf);\n    virCommandFree(cmd);\n    VIR_FORCE_CLOSE(pair[0]);\n    return *tapfd < 0 ? -1 : 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include \"virsocket.h\"",
            "#include \"virnetdevvportprofile.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_interface.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_audit.h\"",
            "#include \"network_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nstatic int\nqemuCreateInBridgePortWithHelper(virQEMUDriverConfigPtr cfg,\n                                 const char *brname,\n                                 char **ifname,\n                                 int *tapfd,\n                                 unsigned int flags)\n{\n    virCommandPtr cmd;\n    char *errbuf = NULL, *cmdstr = NULL;\n    int pair[2] = { -1, -1 };\n\n    if ((flags & ~VIR_NETDEV_TAP_CREATE_VNET_HDR) != VIR_NETDEV_TAP_CREATE_IFUP)\n        return -1;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to create socket\"));\n        return -1;\n    }\n\n    if (!virFileIsExecutable(cfg->bridgeHelperName)) {\n        virReportSystemError(errno, _(\"'%s' is not a suitable bridge helper\"),\n                             cfg->bridgeHelperName);\n        return -1;\n    }\n\n    cmd = virCommandNew(cfg->bridgeHelperName);\n    if (flags & VIR_NETDEV_TAP_CREATE_VNET_HDR)\n        virCommandAddArgFormat(cmd, \"--use-vnet\");\n    virCommandAddArgFormat(cmd, \"--br=%s\", brname);\n    virCommandAddArgFormat(cmd, \"--fd=%d\", pair[1]);\n    virCommandSetErrorBuffer(cmd, &errbuf);\n    virCommandDoAsyncIO(cmd);\n    virCommandPassFD(cmd, pair[1],\n                     VIR_COMMAND_PASS_FD_CLOSE_PARENT);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    if (virCommandRunAsync(cmd, NULL) < 0) {\n        *tapfd = -1;\n        goto cleanup;\n    }\n\n    do {\n        *tapfd = virSocketRecvFD(pair[0], 0);\n    } while (*tapfd < 0 && errno == EINTR);\n\n    if (*tapfd < 0) {\n        char *errstr = NULL;\n\n        if (!(cmdstr = virCommandToString(cmd, false)))\n            goto cleanup;\n        virCommandAbort(cmd);\n\n        if (errbuf && *errbuf)\n            errstr = g_strdup_printf(\"\\nstderr=%s\", errbuf);\n\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n            _(\"%s: failed to communicate with bridge helper: %s%s\"),\n            cmdstr, g_strerror(errno),\n            NULLSTR_EMPTY(errstr));\n        VIR_FREE(errstr);\n        goto cleanup;\n    }\n\n    if (virNetDevTapGetName(*tapfd, ifname) < 0 ||\n        virCommandWait(cmd, NULL) < 0) {\n        VIR_FORCE_CLOSE(*tapfd);\n        *tapfd = -1;\n    }\n\n cleanup:\n    VIR_FREE(cmdstr);\n    VIR_FREE(errbuf);\n    virCommandFree(cmd);\n    VIR_FORCE_CLOSE(pair[0]);\n    return *tapfd < 0 ? -1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgePortSetUnicastFlood",
          "args": [
            "brname",
            "net->ifname",
            "false"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortSetUnicastFlood",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "371-379",
          "snippet": "int\nvirNetDevBridgePortSetUnicastFlood(const char *brname G_GNUC_UNUSED,\n                                   const char *ifname G_GNUC_UNUSED,\n                                   bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port unicast_flood on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetUnicastFlood(const char *brname G_GNUC_UNUSED,\n                                   const char *ifname G_GNUC_UNUSED,\n                                   bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port unicast_flood on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgePortSetLearning",
          "args": [
            "brname",
            "net->ifname",
            "false"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgePortSetLearning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "349-357",
          "snippet": "int\nvirNetDevBridgePortSetLearning(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port learning on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgePortSetLearning(const char *brname G_GNUC_UNUSED,\n                               const char *ifname G_GNUC_UNUSED,\n                               bool enable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set bridge port learning on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBridgeMACTableManager",
          "args": [
            "net"
          ],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBridgeMACTableManager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30177-30186",
          "snippet": "int\nvirDomainNetGetActualBridgeMACTableManager(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.macTableManager;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetGetActualBridgeMACTableManager(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.macTableManager;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevTapCreateInBridgePort",
          "args": [
            "brname",
            "&net->ifname",
            "&net->mac",
            "def->uuid",
            "tunpath",
            "tapfd",
            "*tapfdSize",
            "virDomainNetGetActualVirtPortProfile(net)",
            "virDomainNetGetActualVlan(net)",
            "virDomainNetGetActualPortOptionsIsolated(net)",
            "net->coalesce",
            "0",
            "NULL",
            "tap_create_flags"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevTapCreateInBridgePort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevtap.c",
          "lines": "667-732",
          "snippet": "int virNetDevTapCreateInBridgePort(const char *brname,\n                                   char **ifname,\n                                   const virMacAddr *macaddr,\n                                   const unsigned char *vmuuid,\n                                   const char *tunpath,\n                                   int *tapfd,\n                                   size_t tapfdSize,\n                                   const virNetDevVPortProfile *virtPortProfile,\n                                   const virNetDevVlan *virtVlan,\n                                   virTristateBool isolatedPort,\n                                   virNetDevCoalescePtr coalesce,\n                                   unsigned int mtu,\n                                   unsigned int *actualMTU,\n                                   unsigned int flags)\n{\n    virMacAddr tapmac;\n    size_t i;\n\n    if (virNetDevTapCreate(ifname, tunpath, tapfd, tapfdSize, flags) < 0)\n        return -1;\n\n    /* We need to set the interface MAC before adding it\n     * to the bridge, because the bridge assumes the lowest\n     * MAC of all enslaved interfaces & we don't want it\n     * seeing the kernel allocate random MAC for the TAP\n     * device before we set our static MAC.\n     */\n    virMacAddrSet(&tapmac, macaddr);\n    if (!(flags & VIR_NETDEV_TAP_CREATE_USE_MAC_FOR_BRIDGE)) {\n        /* The tap device's MAC address cannot match the MAC address\n         * used by the guest. This results in \"received packet on\n         * vnetX with own address as source address\" error logs from\n         * the kernel. Making the tap address as high as possible\n         * discourages the bridge from using this tap's MAC as its own\n         * (a Linux host bridge will take on the lowest numbered MAC\n         * of all devices attached to it).\n         */\n        if (tapmac.addr[0] == 0xFE)\n            tapmac.addr[0] = 0xFA;\n        else\n            tapmac.addr[0] = 0xFE;\n    }\n\n    if (virNetDevSetMAC(*ifname, &tapmac) < 0)\n        goto error;\n\n    if (virNetDevTapAttachBridge(*ifname, brname, macaddr, vmuuid,\n                                 virtPortProfile, virtVlan,\n                                 isolatedPort, mtu, actualMTU) < 0) {\n        goto error;\n    }\n\n    if (virNetDevSetOnline(*ifname, !!(flags & VIR_NETDEV_TAP_CREATE_IFUP)) < 0)\n        goto error;\n\n    if (virNetDevSetCoalesce(*ifname, coalesce, false) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    for (i = 0; i < tapfdSize && tapfd[i] >= 0; i++)\n        VIR_FORCE_CLOSE(tapfd[i]);\n\n    return -1;\n}",
          "includes": [
            "# include <ifaddrs.h>",
            "# include <sys/sysctl.h>",
            "# include <net/if_mib.h>",
            "# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <ifaddrs.h>\n# include <sys/sysctl.h>\n# include <net/if_mib.h>\n# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevtap.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint virNetDevTapCreateInBridgePort(const char *brname,\n                                   char **ifname,\n                                   const virMacAddr *macaddr,\n                                   const unsigned char *vmuuid,\n                                   const char *tunpath,\n                                   int *tapfd,\n                                   size_t tapfdSize,\n                                   const virNetDevVPortProfile *virtPortProfile,\n                                   const virNetDevVlan *virtVlan,\n                                   virTristateBool isolatedPort,\n                                   virNetDevCoalescePtr coalesce,\n                                   unsigned int mtu,\n                                   unsigned int *actualMTU,\n                                   unsigned int flags)\n{\n    virMacAddr tapmac;\n    size_t i;\n\n    if (virNetDevTapCreate(ifname, tunpath, tapfd, tapfdSize, flags) < 0)\n        return -1;\n\n    /* We need to set the interface MAC before adding it\n     * to the bridge, because the bridge assumes the lowest\n     * MAC of all enslaved interfaces & we don't want it\n     * seeing the kernel allocate random MAC for the TAP\n     * device before we set our static MAC.\n     */\n    virMacAddrSet(&tapmac, macaddr);\n    if (!(flags & VIR_NETDEV_TAP_CREATE_USE_MAC_FOR_BRIDGE)) {\n        /* The tap device's MAC address cannot match the MAC address\n         * used by the guest. This results in \"received packet on\n         * vnetX with own address as source address\" error logs from\n         * the kernel. Making the tap address as high as possible\n         * discourages the bridge from using this tap's MAC as its own\n         * (a Linux host bridge will take on the lowest numbered MAC\n         * of all devices attached to it).\n         */\n        if (tapmac.addr[0] == 0xFE)\n            tapmac.addr[0] = 0xFA;\n        else\n            tapmac.addr[0] = 0xFE;\n    }\n\n    if (virNetDevSetMAC(*ifname, &tapmac) < 0)\n        goto error;\n\n    if (virNetDevTapAttachBridge(*ifname, brname, macaddr, vmuuid,\n                                 virtPortProfile, virtVlan,\n                                 isolatedPort, mtu, actualMTU) < 0) {\n        goto error;\n    }\n\n    if (virNetDevSetOnline(*ifname, !!(flags & VIR_NETDEV_TAP_CREATE_IFUP)) < 0)\n        goto error;\n\n    if (virNetDevSetCoalesce(*ifname, coalesce, false) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    for (i = 0; i < tapfdSize && tapfd[i] >= 0; i++)\n        VIR_FORCE_CLOSE(tapfd[i]);\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualPortOptionsIsolated",
          "args": [
            "net"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualPortOptionsIsolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30287-30295",
          "snippet": "virTristateBool\nvirDomainNetGetActualPortOptionsIsolated(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual) {\n        return iface->data.network.actual->isolatedPort;\n    }\n    return iface->isolatedPort;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirTristateBool\nvirDomainNetGetActualPortOptionsIsolated(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual) {\n        return iface->data.network.actual->isolatedPort;\n    }\n    return iface->isolatedPort;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualVlan",
          "args": [
            "net"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualVlan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30269-30284",
          "snippet": "const virNetDevVlan *\nvirDomainNetGetActualVlan(const virDomainNetDef *iface)\n{\n    const virNetDevVlan *vlan = &iface->vlan;\n\n    /* if there is an ActualNetDef, *always* return\n     * its vlan rather than the NetDef's vlan.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        vlan = &iface->data.network.actual->vlan;\n\n    if (vlan->nTags > 0)\n        return vlan;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevVlan *\nvirDomainNetGetActualVlan(const virDomainNetDef *iface)\n{\n    const virNetDevVlan *vlan = &iface->vlan;\n\n    /* if there is an ActualNetDef, *always* return\n     * its vlan rather than the NetDef's vlan.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        vlan = &iface->data.network.actual->vlan;\n\n    if (vlan->nTags > 0)\n        return vlan;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualVirtPortProfile",
          "args": [
            "net"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualVirtPortProfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30224-30255",
          "snippet": "const virNetDevVPortProfile *\nvirDomainNetGetActualVirtPortProfile(const virDomainNetDef *iface)\n{\n    switch (iface->type) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        return iface->virtPortProfile;\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (!iface->data.network.actual)\n            return NULL;\n        switch (iface->data.network.actual->type) {\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n            return iface->data.network.actual->virtPortProfile;\n        default:\n            return NULL;\n        }\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevVPortProfile *\nvirDomainNetGetActualVirtPortProfile(const virDomainNetDef *iface)\n{\n    switch (iface->type) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        return iface->virtPortProfile;\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (!iface->data.network.actual)\n            return NULL;\n        switch (iface->data.network.actual->type) {\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n            return iface->data.network.actual->virtPortProfile;\n        default:\n            return NULL;\n        }\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverIsPrivileged",
          "args": [
            "driver"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverIsPrivileged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1220-1224",
          "snippet": "bool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetIsVirtioModel",
          "args": [
            "net"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetIsVirtioModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30344-30350",
          "snippet": "bool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "VIR_NET_GENERATED_TAP_PREFIX \"%d\""
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "net->ifname"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "net->ifname",
            "'%'"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "net->ifname",
            "VIR_NET_GENERATED_TAP_PREFIX"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Missing bridge name\")"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Missing bridge name\""
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBridgeName",
          "args": [
            "net"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBridgeName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30164-30175",
          "snippet": "const char *\nvirDomainNetGetActualBridgeName(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_BRIDGE)\n        return iface->data.bridge.brname;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.brname;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainNetGetActualBridgeName(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_BRIDGE)\n        return iface->data.bridge.brname;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.brname;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"cannot use custom tap device in session mode\")"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceBridgeConnect(virDomainDefPtr def,\n                           virQEMUDriverPtr driver,\n                           virDomainNetDefPtr net,\n                           int *tapfd,\n                           size_t *tapfdSize)\n{\n    const char *brname;\n    int ret = -1;\n    unsigned int tap_create_flags = VIR_NETDEV_TAP_CREATE_IFUP;\n    bool template_ifname = false;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    const char *tunpath = \"/dev/net/tun\";\n\n    if (net->backend.tap) {\n        tunpath = net->backend.tap;\n        if (!(virQEMUDriverIsPrivileged(driver))) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use custom tap device in session mode\"));\n            goto cleanup;\n        }\n    }\n\n    if (!(brname = virDomainNetGetActualBridgeName(net))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Missing bridge name\"));\n        goto cleanup;\n    }\n\n    if (!net->ifname ||\n        STRPREFIX(net->ifname, VIR_NET_GENERATED_TAP_PREFIX) ||\n        strchr(net->ifname, '%')) {\n        VIR_FREE(net->ifname);\n        net->ifname = g_strdup(VIR_NET_GENERATED_TAP_PREFIX \"%d\");\n        /* avoid exposing vnet%d in getXMLDesc or error outputs */\n        template_ifname = true;\n    }\n\n    if (virDomainNetIsVirtioModel(net))\n        tap_create_flags |= VIR_NETDEV_TAP_CREATE_VNET_HDR;\n\n    if (virQEMUDriverIsPrivileged(driver)) {\n        if (virNetDevTapCreateInBridgePort(brname, &net->ifname, &net->mac,\n                                           def->uuid, tunpath, tapfd, *tapfdSize,\n                                           virDomainNetGetActualVirtPortProfile(net),\n                                           virDomainNetGetActualVlan(net),\n                                           virDomainNetGetActualPortOptionsIsolated(net),\n                                           net->coalesce, 0, NULL,\n                                           tap_create_flags) < 0) {\n            virDomainAuditNetDevice(def, net, tunpath, false);\n            goto cleanup;\n        }\n        if (virDomainNetGetActualBridgeMACTableManager(net)\n            == VIR_NETWORK_BRIDGE_MAC_TABLE_MANAGER_LIBVIRT) {\n            /* libvirt is managing the FDB of the bridge this device\n             * is attaching to, so we need to turn off learning and\n             * unicast_flood on the device to prevent the kernel from\n             * adding any FDB entries for it. We will add an fdb\n             * entry ourselves (during qemuInterfaceStartDevices(),\n             * using the MAC address from the interface config.\n             */\n            if (virNetDevBridgePortSetLearning(brname, net->ifname, false) < 0)\n                goto cleanup;\n            if (virNetDevBridgePortSetUnicastFlood(brname, net->ifname, false) < 0)\n                goto cleanup;\n        }\n    } else {\n        if (qemuCreateInBridgePortWithHelper(cfg, brname,\n                                             &net->ifname,\n                                             tapfd, tap_create_flags) < 0) {\n            virDomainAuditNetDevice(def, net, tunpath, false);\n            goto cleanup;\n        }\n        /* qemuCreateInBridgePortWithHelper can only create a single FD */\n        if (*tapfdSize > 1) {\n            VIR_WARN(\"Ignoring multiqueue network request\");\n            *tapfdSize = 1;\n        }\n    }\n\n    virDomainAuditNetDevice(def, net, tunpath, true);\n\n    if (cfg->macFilter &&\n        ebtablesAddForwardAllowIn(driver->ebtables,\n                                  net->ifname,\n                                  &net->mac) < 0)\n        goto cleanup;\n\n    if (net->filter &&\n        virDomainConfNWFilterInstantiate(def->name, def->uuid, net, false) < 0) {\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        size_t i;\n        for (i = 0; i < *tapfdSize && tapfd[i] >= 0; i++)\n            VIR_FORCE_CLOSE(tapfd[i]);\n        if (template_ifname)\n            VIR_FREE(net->ifname);\n    }\n    virObjectUnref(cfg);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuInterfaceEthernetConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "396-511",
    "snippet": "int\nqemuInterfaceEthernetConnect(virDomainDefPtr def,\n                           virQEMUDriverPtr driver,\n                           virDomainNetDefPtr net,\n                           int *tapfd,\n                           size_t tapfdSize)\n{\n    virMacAddr tapmac;\n    int ret = -1;\n    unsigned int tap_create_flags = VIR_NETDEV_TAP_CREATE_IFUP;\n    bool template_ifname = false;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    const char *tunpath = \"/dev/net/tun\";\n    const char *auditdev = tunpath;\n\n    if (net->backend.tap) {\n        tunpath = net->backend.tap;\n        if (!virQEMUDriverIsPrivileged(driver)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use custom tap device in session mode\"));\n            goto cleanup;\n        }\n    }\n\n    if (virDomainNetIsVirtioModel(net))\n        tap_create_flags |= VIR_NETDEV_TAP_CREATE_VNET_HDR;\n\n    if (net->managed_tap == VIR_TRISTATE_BOOL_NO) {\n        if (!net->ifname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"target dev must be supplied when managed='no'\"));\n            goto cleanup;\n        }\n        if (virNetDevExists(net->ifname) != 1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"target managed='no' but specified dev doesn't exist\"));\n            goto cleanup;\n        }\n        if (virNetDevMacVLanIsMacvtap(net->ifname)) {\n            auditdev = net->ifname;\n            if (virNetDevMacVLanTapOpen(net->ifname, tapfd, tapfdSize) < 0)\n                goto cleanup;\n            if (virNetDevMacVLanTapSetup(tapfd, tapfdSize,\n                                         virDomainNetIsVirtioModel(net)) < 0) {\n                goto cleanup;\n            }\n        } else {\n            if (virNetDevTapCreate(&net->ifname, tunpath, tapfd, tapfdSize,\n                                   tap_create_flags) < 0)\n                goto cleanup;\n        }\n    } else {\n        if (!net->ifname ||\n            STRPREFIX(net->ifname, VIR_NET_GENERATED_TAP_PREFIX) ||\n            strchr(net->ifname, '%')) {\n            VIR_FREE(net->ifname);\n            net->ifname = g_strdup(VIR_NET_GENERATED_TAP_PREFIX \"%d\");\n            /* avoid exposing vnet%d in getXMLDesc or error outputs */\n            template_ifname = true;\n        }\n        if (virNetDevTapCreate(&net->ifname, tunpath, tapfd, tapfdSize,\n                               tap_create_flags) < 0) {\n            goto cleanup;\n        }\n\n        /* The tap device's MAC address cannot match the MAC address\n         * used by the guest. This results in \"received packet on\n         * vnetX with own address as source address\" error logs from\n         * the kernel.\n         */\n        virMacAddrSet(&tapmac, &net->mac);\n        if (tapmac.addr[0] == 0xFE)\n            tapmac.addr[0] = 0xFA;\n        else\n            tapmac.addr[0] = 0xFE;\n\n        if (virNetDevSetMAC(net->ifname, &tapmac) < 0)\n            goto cleanup;\n\n        if (virNetDevSetOnline(net->ifname, true) < 0)\n            goto cleanup;\n    }\n\n    if (net->script &&\n        virNetDevRunEthernetScript(net->ifname, net->script) < 0)\n        goto cleanup;\n\n    if (cfg->macFilter &&\n        ebtablesAddForwardAllowIn(driver->ebtables,\n                                  net->ifname,\n                                  &net->mac) < 0)\n        goto cleanup;\n\n    if (net->filter &&\n        virDomainConfNWFilterInstantiate(def->name, def->uuid, net, false) < 0) {\n        goto cleanup;\n    }\n\n    virDomainAuditNetDevice(def, net, auditdev, true);\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        size_t i;\n\n        virDomainAuditNetDevice(def, net, auditdev, false);\n        for (i = 0; i < tapfdSize && tapfd[i] >= 0; i++)\n            VIR_FORCE_CLOSE(tapfd[i]);\n        if (template_ifname)\n            VIR_FREE(net->ifname);\n    }\n    virObjectUnref(cfg);\n\n    return ret;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "net->ifname"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "tapfd[i]"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainAuditNetDevice",
          "args": [
            "def",
            "net",
            "auditdev",
            "false"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNetDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "298-327",
          "snippet": "void\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainConfNWFilterInstantiate",
          "args": [
            "def->name",
            "def->uuid",
            "net",
            "false"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainConfNWFilterInstantiate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_nwfilter.c",
          "lines": "78-121",
          "snippet": "int\nvirDomainConfNWFilterInstantiate(const char *vmname,\n                                 const unsigned char *vmuuid,\n                                 virDomainNetDefPtr net,\n                                 bool ignoreExists)\n{\n    virConnectPtr conn = virGetConnectNWFilter();\n    virNWFilterBindingDefPtr def = NULL;\n    virNWFilterBindingPtr binding = NULL;\n    char *xml = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"vmname=%s portdev=%s filter=%s ignoreExists=%d\",\n              vmname, NULLSTR(net->ifname), NULLSTR(net->filter), ignoreExists);\n\n    if (!conn)\n        goto cleanup;\n\n    if (ignoreExists) {\n        binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n        if (binding) {\n            ret = 0;\n            goto cleanup;\n        }\n    }\n\n    if (!(def = virNWFilterBindingDefForNet(vmname, vmuuid, net)))\n        goto cleanup;\n\n    if (!(xml = virNWFilterBindingDefFormat(def)))\n        goto cleanup;\n\n    if (!(binding = virNWFilterBindingCreateXML(conn, xml, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(xml);\n    virNWFilterBindingDefFree(def);\n    virObjectUnref(binding);\n    virObjectUnref(conn);\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainConfNWFilterInstantiate(const char *vmname,\n                                 const unsigned char *vmuuid,\n                                 virDomainNetDefPtr net,\n                                 bool ignoreExists)\n{\n    virConnectPtr conn = virGetConnectNWFilter();\n    virNWFilterBindingDefPtr def = NULL;\n    virNWFilterBindingPtr binding = NULL;\n    char *xml = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"vmname=%s portdev=%s filter=%s ignoreExists=%d\",\n              vmname, NULLSTR(net->ifname), NULLSTR(net->filter), ignoreExists);\n\n    if (!conn)\n        goto cleanup;\n\n    if (ignoreExists) {\n        binding = virNWFilterBindingLookupByPortDev(conn, net->ifname);\n        if (binding) {\n            ret = 0;\n            goto cleanup;\n        }\n    }\n\n    if (!(def = virNWFilterBindingDefForNet(vmname, vmuuid, net)))\n        goto cleanup;\n\n    if (!(xml = virNWFilterBindingDefFormat(def)))\n        goto cleanup;\n\n    if (!(binding = virNWFilterBindingCreateXML(conn, xml, 0)))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(xml);\n    virNWFilterBindingDefFree(def);\n    virObjectUnref(binding);\n    virObjectUnref(conn);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ebtablesAddForwardAllowIn",
          "args": [
            "driver->ebtables",
            "net->ifname",
            "&net->mac"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "ebtablesAddForwardAllowIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virebtables.c",
          "lines": "155-164",
          "snippet": "int\nebtablesAddForwardAllowIn(ebtablesContext *ctx,\n                          const char *iface,\n                          const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, ADD);\n}",
          "includes": [
            "#include \"virfirewall.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virebtables.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virfirewall.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virebtables.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nebtablesAddForwardAllowIn(ebtablesContext *ctx,\n                          const char *iface,\n                          const virMacAddr *mac)\n{\n    char macaddr[VIR_MAC_STRING_BUFLEN];\n\n    virMacAddrFormat(mac, macaddr);\n    return ebtablesForwardAllowIn(ctx, iface, macaddr, ADD);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevRunEthernetScript",
          "args": [
            "net->ifname",
            "net->script"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevRunEthernetScript",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "3448-3470",
          "snippet": "int\nvirNetDevRunEthernetScript(const char *ifname, const char *script)\n{\n    virCommandPtr cmd;\n    int ret;\n\n    /* Not a bug! Previously we did accept script=\"\" as a NO-OP. */\n    if (STREQ(script, \"\"))\n        return 0;\n\n    cmd = virCommandNew(script);\n    virCommandAddArgFormat(cmd, \"%s\", ifname);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    virCommandAddEnvPassCommon(cmd);\n\n    ret = virCommandRun(cmd, NULL);\n\n    virCommandFree(cmd);\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct ethtool_value cmd = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nint\nvirNetDevRunEthernetScript(const char *ifname, const char *script)\n{\n    virCommandPtr cmd;\n    int ret;\n\n    /* Not a bug! Previously we did accept script=\"\" as a NO-OP. */\n    if (STREQ(script, \"\"))\n        return 0;\n\n    cmd = virCommandNew(script);\n    virCommandAddArgFormat(cmd, \"%s\", ifname);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    virCommandAddEnvPassCommon(cmd);\n\n    ret = virCommandRun(cmd, NULL);\n\n    virCommandFree(cmd);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetOnline",
          "args": [
            "net->ifname",
            "true"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "660-665",
          "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetMAC",
          "args": [
            "net->ifname",
            "&tapmac"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "346-351",
          "snippet": "int\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrSet",
          "args": [
            "&tapmac",
            "&net->mac"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "113-117",
          "snippet": "void\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevTapCreate",
          "args": [
            "&net->ifname",
            "tunpath",
            "tapfd",
            "tapfdSize",
            "tap_create_flags"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevTapCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevtap.c",
          "lines": "466-475",
          "snippet": "int virNetDevTapCreate(char **ifname G_GNUC_UNUSED,\n                       const char *tunpath G_GNUC_UNUSED,\n                       int *tapfd G_GNUC_UNUSED,\n                       size_t tapfdSize G_GNUC_UNUSED,\n                       unsigned int flags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to create TAP devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <ifaddrs.h>",
            "# include <sys/sysctl.h>",
            "# include <net/if_mib.h>",
            "# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <ifaddrs.h>\n# include <sys/sysctl.h>\n# include <net/if_mib.h>\n# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevtap.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint virNetDevTapCreate(char **ifname G_GNUC_UNUSED,\n                       const char *tunpath G_GNUC_UNUSED,\n                       int *tapfd G_GNUC_UNUSED,\n                       size_t tapfdSize G_GNUC_UNUSED,\n                       unsigned int flags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to create TAP devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "VIR_NET_GENERATED_TAP_PREFIX \"%d\""
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "net->ifname"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "net->ifname",
            "'%'"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "net->ifname",
            "VIR_NET_GENERATED_TAP_PREFIX"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanTapSetup",
          "args": [
            "tapfd",
            "tapfdSize",
            "virDomainNetIsVirtioModel(net)"
          ],
          "line": 438
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanTapSetup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1209-1217",
          "snippet": "int\nvirNetDevMacVLanTapSetup(int *tapfd G_GNUC_UNUSED,\n                         size_t tapfdSize G_GNUC_UNUSED,\n                         bool vnet_hdr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapSetup(int *tapfd G_GNUC_UNUSED,\n                         size_t tapfdSize G_GNUC_UNUSED,\n                         bool vnet_hdr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetIsVirtioModel",
          "args": [
            "net"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetIsVirtioModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30344-30350",
          "snippet": "bool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanTapOpen",
          "args": [
            "net->ifname",
            "tapfd",
            "tapfdSize"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanTapOpen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1199-1207",
          "snippet": "int\nvirNetDevMacVLanTapOpen(const char *ifname G_GNUC_UNUSED,\n                        int *tapfd G_GNUC_UNUSED,\n                        size_t tapfdSize G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint\nvirNetDevMacVLanTapOpen(const char *ifname G_GNUC_UNUSED,\n                        int *tapfd G_GNUC_UNUSED,\n                        size_t tapfdSize G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanIsMacvtap",
          "args": [
            "net->ifname"
          ],
          "line": 434
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanIsMacvtap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1173-1178",
          "snippet": "bool virNetDevMacVLanIsMacvtap(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return false;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nbool virNetDevMacVLanIsMacvtap(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"target managed='no' but specified dev doesn't exist\")"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"target managed='no' but specified dev doesn't exist\""
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevExists",
          "args": [
            "net->ifname"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "218-223",
          "snippet": "int virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"target dev must be supplied when managed='no'\")"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"cannot use custom tap device in session mode\")"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUDriverIsPrivileged",
          "args": [
            "driver"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverIsPrivileged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1220-1224",
          "snippet": "bool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceEthernetConnect(virDomainDefPtr def,\n                           virQEMUDriverPtr driver,\n                           virDomainNetDefPtr net,\n                           int *tapfd,\n                           size_t tapfdSize)\n{\n    virMacAddr tapmac;\n    int ret = -1;\n    unsigned int tap_create_flags = VIR_NETDEV_TAP_CREATE_IFUP;\n    bool template_ifname = false;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    const char *tunpath = \"/dev/net/tun\";\n    const char *auditdev = tunpath;\n\n    if (net->backend.tap) {\n        tunpath = net->backend.tap;\n        if (!virQEMUDriverIsPrivileged(driver)) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                           _(\"cannot use custom tap device in session mode\"));\n            goto cleanup;\n        }\n    }\n\n    if (virDomainNetIsVirtioModel(net))\n        tap_create_flags |= VIR_NETDEV_TAP_CREATE_VNET_HDR;\n\n    if (net->managed_tap == VIR_TRISTATE_BOOL_NO) {\n        if (!net->ifname) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"target dev must be supplied when managed='no'\"));\n            goto cleanup;\n        }\n        if (virNetDevExists(net->ifname) != 1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"target managed='no' but specified dev doesn't exist\"));\n            goto cleanup;\n        }\n        if (virNetDevMacVLanIsMacvtap(net->ifname)) {\n            auditdev = net->ifname;\n            if (virNetDevMacVLanTapOpen(net->ifname, tapfd, tapfdSize) < 0)\n                goto cleanup;\n            if (virNetDevMacVLanTapSetup(tapfd, tapfdSize,\n                                         virDomainNetIsVirtioModel(net)) < 0) {\n                goto cleanup;\n            }\n        } else {\n            if (virNetDevTapCreate(&net->ifname, tunpath, tapfd, tapfdSize,\n                                   tap_create_flags) < 0)\n                goto cleanup;\n        }\n    } else {\n        if (!net->ifname ||\n            STRPREFIX(net->ifname, VIR_NET_GENERATED_TAP_PREFIX) ||\n            strchr(net->ifname, '%')) {\n            VIR_FREE(net->ifname);\n            net->ifname = g_strdup(VIR_NET_GENERATED_TAP_PREFIX \"%d\");\n            /* avoid exposing vnet%d in getXMLDesc or error outputs */\n            template_ifname = true;\n        }\n        if (virNetDevTapCreate(&net->ifname, tunpath, tapfd, tapfdSize,\n                               tap_create_flags) < 0) {\n            goto cleanup;\n        }\n\n        /* The tap device's MAC address cannot match the MAC address\n         * used by the guest. This results in \"received packet on\n         * vnetX with own address as source address\" error logs from\n         * the kernel.\n         */\n        virMacAddrSet(&tapmac, &net->mac);\n        if (tapmac.addr[0] == 0xFE)\n            tapmac.addr[0] = 0xFA;\n        else\n            tapmac.addr[0] = 0xFE;\n\n        if (virNetDevSetMAC(net->ifname, &tapmac) < 0)\n            goto cleanup;\n\n        if (virNetDevSetOnline(net->ifname, true) < 0)\n            goto cleanup;\n    }\n\n    if (net->script &&\n        virNetDevRunEthernetScript(net->ifname, net->script) < 0)\n        goto cleanup;\n\n    if (cfg->macFilter &&\n        ebtablesAddForwardAllowIn(driver->ebtables,\n                                  net->ifname,\n                                  &net->mac) < 0)\n        goto cleanup;\n\n    if (net->filter &&\n        virDomainConfNWFilterInstantiate(def->name, def->uuid, net, false) < 0) {\n        goto cleanup;\n    }\n\n    virDomainAuditNetDevice(def, net, auditdev, true);\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        size_t i;\n\n        virDomainAuditNetDevice(def, net, auditdev, false);\n        for (i = 0; i < tapfdSize && tapfd[i] >= 0; i++)\n            VIR_FORCE_CLOSE(tapfd[i]);\n        if (template_ifname)\n            VIR_FREE(net->ifname);\n    }\n    virObjectUnref(cfg);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuCreateInBridgePortWithHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "306-383",
    "snippet": "static int\nqemuCreateInBridgePortWithHelper(virQEMUDriverConfigPtr cfg,\n                                 const char *brname,\n                                 char **ifname,\n                                 int *tapfd,\n                                 unsigned int flags)\n{\n    virCommandPtr cmd;\n    char *errbuf = NULL, *cmdstr = NULL;\n    int pair[2] = { -1, -1 };\n\n    if ((flags & ~VIR_NETDEV_TAP_CREATE_VNET_HDR) != VIR_NETDEV_TAP_CREATE_IFUP)\n        return -1;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to create socket\"));\n        return -1;\n    }\n\n    if (!virFileIsExecutable(cfg->bridgeHelperName)) {\n        virReportSystemError(errno, _(\"'%s' is not a suitable bridge helper\"),\n                             cfg->bridgeHelperName);\n        return -1;\n    }\n\n    cmd = virCommandNew(cfg->bridgeHelperName);\n    if (flags & VIR_NETDEV_TAP_CREATE_VNET_HDR)\n        virCommandAddArgFormat(cmd, \"--use-vnet\");\n    virCommandAddArgFormat(cmd, \"--br=%s\", brname);\n    virCommandAddArgFormat(cmd, \"--fd=%d\", pair[1]);\n    virCommandSetErrorBuffer(cmd, &errbuf);\n    virCommandDoAsyncIO(cmd);\n    virCommandPassFD(cmd, pair[1],\n                     VIR_COMMAND_PASS_FD_CLOSE_PARENT);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    if (virCommandRunAsync(cmd, NULL) < 0) {\n        *tapfd = -1;\n        goto cleanup;\n    }\n\n    do {\n        *tapfd = virSocketRecvFD(pair[0], 0);\n    } while (*tapfd < 0 && errno == EINTR);\n\n    if (*tapfd < 0) {\n        char *errstr = NULL;\n\n        if (!(cmdstr = virCommandToString(cmd, false)))\n            goto cleanup;\n        virCommandAbort(cmd);\n\n        if (errbuf && *errbuf)\n            errstr = g_strdup_printf(\"\\nstderr=%s\", errbuf);\n\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n            _(\"%s: failed to communicate with bridge helper: %s%s\"),\n            cmdstr, g_strerror(errno),\n            NULLSTR_EMPTY(errstr));\n        VIR_FREE(errstr);\n        goto cleanup;\n    }\n\n    if (virNetDevTapGetName(*tapfd, ifname) < 0 ||\n        virCommandWait(cmd, NULL) < 0) {\n        VIR_FORCE_CLOSE(*tapfd);\n        *tapfd = -1;\n    }\n\n cleanup:\n    VIR_FREE(cmdstr);\n    VIR_FREE(errbuf);\n    virCommandFree(cmd);\n    VIR_FORCE_CLOSE(pair[0]);\n    return *tapfd < 0 ? -1 : 0;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pair[0]"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "errbuf"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cmdstr"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "*tapfd"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandWait",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2940-2946",
          "snippet": "int\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevTapGetName",
          "args": [
            "*tapfd",
            "ifname"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevTapGetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevtap.c",
          "lines": "67-84",
          "snippet": "int\nvirNetDevTapGetName(int tapfd G_GNUC_UNUSED, char **ifname G_GNUC_UNUSED)\n{\n#ifdef TUNGETIFF\n    struct ifreq ifr;\n\n    if (ioctl(tapfd, TUNGETIFF, &ifr) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to query tap interface name\"));\n        return -1;\n    }\n\n    *ifname = g_strdup(ifr.ifr_name);\n    return 0;\n#else\n    return -1;\n#endif\n}",
          "includes": [
            "# include <ifaddrs.h>",
            "# include <sys/sysctl.h>",
            "# include <net/if_mib.h>",
            "# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevmidonet.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <ifaddrs.h>\n# include <sys/sysctl.h>\n# include <net/if_mib.h>\n# include <linux/if_tun.h>    /* IFF_TUN, IFF_NO_PI */\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevmidonet.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevtap.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirNetDevTapGetName(int tapfd G_GNUC_UNUSED, char **ifname G_GNUC_UNUSED)\n{\n#ifdef TUNGETIFF\n    struct ifreq ifr;\n\n    if (ioctl(tapfd, TUNGETIFF, &ifr) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to query tap interface name\"));\n        return -1;\n    }\n\n    *ifname = g_strdup(ifr.ifr_name);\n    return 0;\n#else\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "errstr"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: failed to communicate with bridge helper: %s%s\")",
            "cmdstr",
            "g_strerror(errno)",
            "NULLSTR_EMPTY(errstr)"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "errstr"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "errno"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: failed to communicate with bridge helper: %s%s\""
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"\\nstderr=%s\"",
            "errbuf"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAbort",
          "args": [
            "cmd"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAbort",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2949-2955",
          "snippet": "void\nvirCommandAbort(virCommandPtr cmd G_GNUC_UNUSED)\n{\n    /* Mingw lacks WNOHANG and kill().  But since we haven't ported\n     * virExec to mingw yet, there's no process to be killed,\n     * making this implementation trivially correct for now :)  */\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAbort(virCommandPtr cmd G_GNUC_UNUSED)\n{\n    /* Mingw lacks WNOHANG and kill().  But since we haven't ported\n     * virExec to mingw yet, there's no process to be killed,\n     * making this implementation trivially correct for now :)  */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandToString",
          "args": [
            "cmd",
            "false"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2082-2135",
          "snippet": "char *\nvirCommandToString(virCommandPtr cmd, bool linebreaks)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool prevopt = false;\n\n    /* Cannot assume virCommandRun will be called; so report the error\n     * now.  If virCommandRun is called, it will report the same error. */\n    if (!cmd ||cmd->has_error == ENOMEM) {\n        virReportOOMError();\n        return NULL;\n    }\n    if (cmd->has_error) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid use of command API\"));\n        return NULL;\n    }\n\n    for (i = 0; i < cmd->nenv; i++) {\n        /* In shell, a='b c' has a different meaning than 'a=b c', so\n         * we must determine where the '=' lives.  */\n        char *eq = strchr(cmd->env[i], '=');\n\n        if (!eq) {\n            virBufferFreeAndReset(&buf);\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"invalid use of command API\"));\n            return NULL;\n        }\n        eq++;\n        virBufferAdd(&buf, cmd->env[i], eq - cmd->env[i]);\n        virBufferEscapeShell(&buf, eq);\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks)\n            virBufferAddLit(&buf, \"\\\\\\n\");\n    }\n    virBufferEscapeShell(&buf, cmd->args[0]);\n    for (i = 1; i < cmd->nargs; i++) {\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks) {\n            /* Line break if this is a --arg or if\n             * the previous arg was a positional option\n             */\n            if (cmd->args[i][0] == '-' ||\n                !prevopt)\n                virBufferAddLit(&buf, \"\\\\\\n\");\n        }\n        virBufferEscapeShell(&buf, cmd->args[i]);\n        prevopt = (cmd->args[i][0] == '-');\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nchar *\nvirCommandToString(virCommandPtr cmd, bool linebreaks)\n{\n    size_t i;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool prevopt = false;\n\n    /* Cannot assume virCommandRun will be called; so report the error\n     * now.  If virCommandRun is called, it will report the same error. */\n    if (!cmd ||cmd->has_error == ENOMEM) {\n        virReportOOMError();\n        return NULL;\n    }\n    if (cmd->has_error) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid use of command API\"));\n        return NULL;\n    }\n\n    for (i = 0; i < cmd->nenv; i++) {\n        /* In shell, a='b c' has a different meaning than 'a=b c', so\n         * we must determine where the '=' lives.  */\n        char *eq = strchr(cmd->env[i], '=');\n\n        if (!eq) {\n            virBufferFreeAndReset(&buf);\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"invalid use of command API\"));\n            return NULL;\n        }\n        eq++;\n        virBufferAdd(&buf, cmd->env[i], eq - cmd->env[i]);\n        virBufferEscapeShell(&buf, eq);\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks)\n            virBufferAddLit(&buf, \"\\\\\\n\");\n    }\n    virBufferEscapeShell(&buf, cmd->args[0]);\n    for (i = 1; i < cmd->nargs; i++) {\n        virBufferAddChar(&buf, ' ');\n        if (linebreaks) {\n            /* Line break if this is a --arg or if\n             * the previous arg was a positional option\n             */\n            if (cmd->args[i][0] == '-' ||\n                !prevopt)\n                virBufferAddLit(&buf, \"\\\\\\n\");\n        }\n        virBufferEscapeShell(&buf, cmd->args[i]);\n        prevopt = (cmd->args[i][0] == '-');\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketRecvFD",
          "args": [
            "pair[0]",
            "0"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketRecvFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "496-501",
          "snippet": "int\nvirSocketRecvFD(int sock G_GNUC_UNUSED, int fdflags G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvirSocketRecvFD(int sock G_GNUC_UNUSED, int fdflags G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRunAsync",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAllowCap",
          "args": [
            "cmd",
            "CAP_NET_ADMIN"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAllowCap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1195-1203",
          "snippet": "void\nvirCommandAllowCap(virCommandPtr cmd,\n                   int capability)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->capabilities |= (1ULL << capability);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAllowCap(virCommandPtr cmd,\n                   int capability)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->capabilities |= (1ULL << capability);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandClearCaps",
          "args": [
            "cmd"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandClearCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1179-1186",
          "snippet": "void\nvirCommandClearCaps(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_CLEAR_CAPS;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandClearCaps(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_CLEAR_CAPS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandPassFD",
          "args": [
            "cmd",
            "pair[1]",
            "VIR_COMMAND_PASS_FD_CLOSE_PARENT"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandPassFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1024-1049",
          "snippet": "void\nvirCommandPassFD(virCommandPtr cmd, int fd, unsigned int flags)\n{\n    int ret = 0;\n\n    if (!cmd) {\n        VIR_COMMAND_MAYBE_CLOSE_FD(fd, flags);\n        return;\n    }\n\n    if (fd <= STDERR_FILENO) {\n        VIR_DEBUG(\"invalid fd %d\", fd);\n        VIR_COMMAND_MAYBE_CLOSE_FD(fd, flags);\n        if (!cmd->has_error)\n            cmd->has_error = -1;\n        return;\n    }\n\n    if ((ret = virCommandFDSet(cmd, fd, flags)) != 0) {\n        if (!cmd->has_error)\n            cmd->has_error = ret;\n        VIR_DEBUG(\"cannot preserve %d\", fd);\n        VIR_COMMAND_MAYBE_CLOSE_FD(fd, flags);\n        return;\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandPassFD(virCommandPtr cmd, int fd, unsigned int flags)\n{\n    int ret = 0;\n\n    if (!cmd) {\n        VIR_COMMAND_MAYBE_CLOSE_FD(fd, flags);\n        return;\n    }\n\n    if (fd <= STDERR_FILENO) {\n        VIR_DEBUG(\"invalid fd %d\", fd);\n        VIR_COMMAND_MAYBE_CLOSE_FD(fd, flags);\n        if (!cmd->has_error)\n            cmd->has_error = -1;\n        return;\n    }\n\n    if ((ret = virCommandFDSet(cmd, fd, flags)) != 0) {\n        if (!cmd->has_error)\n            cmd->has_error = ret;\n        VIR_DEBUG(\"cannot preserve %d\", fd);\n        VIR_COMMAND_MAYBE_CLOSE_FD(fd, flags);\n        return;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandDoAsyncIO",
          "args": [
            "cmd"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandDoAsyncIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "3084-3091",
          "snippet": "void\nvirCommandDoAsyncIO(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_ASYNC_IO | VIR_EXEC_NONBLOCK;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandDoAsyncIO(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_ASYNC_IO | VIR_EXEC_NONBLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetErrorBuffer",
          "args": [
            "cmd",
            "&errbuf"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetErrorBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1903-1918",
          "snippet": "void\nvirCommandSetErrorBuffer(virCommandPtr cmd, char **errbuf)\n{\n    *errbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->errfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify stderr twice\");\n        return;\n    }\n\n    cmd->errbuf = errbuf;\n    cmd->errfdptr = &cmd->errfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetErrorBuffer(virCommandPtr cmd, char **errbuf)\n{\n    *errbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->errfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify stderr twice\");\n        return;\n    }\n\n    cmd->errbuf = errbuf;\n    cmd->errfdptr = &cmd->errfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgFormat",
          "args": [
            "cmd",
            "\"--fd=%d\"",
            "pair[1]"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1569-1590",
          "snippet": "void\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNew",
          "args": [
            "cfg->bridgeHelperName"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"'%s' is not a suitable bridge helper\")",
            "cfg->bridgeHelperName"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileIsExecutable",
          "args": [
            "cfg->bridgeHelperName"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsExecutable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1886-1899",
          "snippet": "bool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"failed to create socket\")"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socketpair",
          "args": [
            "AF_UNIX",
            "SOCK_STREAM",
            "0",
            "pair"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nstatic int\nqemuCreateInBridgePortWithHelper(virQEMUDriverConfigPtr cfg,\n                                 const char *brname,\n                                 char **ifname,\n                                 int *tapfd,\n                                 unsigned int flags)\n{\n    virCommandPtr cmd;\n    char *errbuf = NULL, *cmdstr = NULL;\n    int pair[2] = { -1, -1 };\n\n    if ((flags & ~VIR_NETDEV_TAP_CREATE_VNET_HDR) != VIR_NETDEV_TAP_CREATE_IFUP)\n        return -1;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        virReportSystemError(errno, \"%s\", _(\"failed to create socket\"));\n        return -1;\n    }\n\n    if (!virFileIsExecutable(cfg->bridgeHelperName)) {\n        virReportSystemError(errno, _(\"'%s' is not a suitable bridge helper\"),\n                             cfg->bridgeHelperName);\n        return -1;\n    }\n\n    cmd = virCommandNew(cfg->bridgeHelperName);\n    if (flags & VIR_NETDEV_TAP_CREATE_VNET_HDR)\n        virCommandAddArgFormat(cmd, \"--use-vnet\");\n    virCommandAddArgFormat(cmd, \"--br=%s\", brname);\n    virCommandAddArgFormat(cmd, \"--fd=%d\", pair[1]);\n    virCommandSetErrorBuffer(cmd, &errbuf);\n    virCommandDoAsyncIO(cmd);\n    virCommandPassFD(cmd, pair[1],\n                     VIR_COMMAND_PASS_FD_CLOSE_PARENT);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    if (virCommandRunAsync(cmd, NULL) < 0) {\n        *tapfd = -1;\n        goto cleanup;\n    }\n\n    do {\n        *tapfd = virSocketRecvFD(pair[0], 0);\n    } while (*tapfd < 0 && errno == EINTR);\n\n    if (*tapfd < 0) {\n        char *errstr = NULL;\n\n        if (!(cmdstr = virCommandToString(cmd, false)))\n            goto cleanup;\n        virCommandAbort(cmd);\n\n        if (errbuf && *errbuf)\n            errstr = g_strdup_printf(\"\\nstderr=%s\", errbuf);\n\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n            _(\"%s: failed to communicate with bridge helper: %s%s\"),\n            cmdstr, g_strerror(errno),\n            NULLSTR_EMPTY(errstr));\n        VIR_FREE(errstr);\n        goto cleanup;\n    }\n\n    if (virNetDevTapGetName(*tapfd, ifname) < 0 ||\n        virCommandWait(cmd, NULL) < 0) {\n        VIR_FORCE_CLOSE(*tapfd);\n        *tapfd = -1;\n    }\n\n cleanup:\n    VIR_FREE(cmdstr);\n    VIR_FREE(errbuf);\n    virCommandFree(cmd);\n    VIR_FORCE_CLOSE(pair[0]);\n    return *tapfd < 0 ? -1 : 0;\n}"
  },
  {
    "function_name": "qemuInterfaceDirectConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "245-286",
    "snippet": "int\nqemuInterfaceDirectConnect(virDomainDefPtr def,\n                           virQEMUDriverPtr driver,\n                           virDomainNetDefPtr net,\n                           int *tapfd,\n                           size_t tapfdSize,\n                           virNetDevVPortProfileOp vmop)\n{\n    int ret = -1;\n    char *res_ifname = NULL;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    unsigned int macvlan_create_flags = VIR_NETDEV_MACVLAN_CREATE_WITH_TAP;\n\n    if (virDomainNetIsVirtioModel(net))\n        macvlan_create_flags |= VIR_NETDEV_MACVLAN_VNET_HDR;\n\n    if (virNetDevMacVLanCreateWithVPortProfile(net->ifname,\n                                               &net->mac,\n                                               virDomainNetGetActualDirectDev(net),\n                                               virDomainNetGetActualDirectMode(net),\n                                               virDomainNetGetActualVlan(net),\n                                               def->uuid,\n                                               virDomainNetGetActualVirtPortProfile(net),\n                                               &res_ifname,\n                                               vmop, cfg->stateDir,\n                                               tapfd, tapfdSize,\n                                               macvlan_create_flags) < 0)\n        goto cleanup;\n\n    virDomainAuditNetDevice(def, net, res_ifname, true);\n    VIR_FREE(net->ifname);\n    net->ifname = res_ifname;\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        while (tapfdSize--)\n            VIR_FORCE_CLOSE(tapfd[tapfdSize]);\n    }\n    virObjectUnref(cfg);\n    return ret;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cfg"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "tapfd[tapfdSize]"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "net->ifname"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainAuditNetDevice",
          "args": [
            "def",
            "net",
            "res_ifname",
            "true"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainAuditNetDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_audit.c",
          "lines": "298-327",
          "snippet": "void\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"viruuid.h\"",
            "#include \"viraudit.h\"",
            "#include \"domain_audit.h\"",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"viruuid.h\"\n#include \"viraudit.h\"\n#include \"domain_audit.h\"\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainAuditNetDevice(virDomainDefPtr vmDef, virDomainNetDefPtr netDef,\n                        const char *device, bool success)\n{\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    char *vmname;\n    char *dev_name = NULL;\n    char *rdev;\n    const char *virt = virDomainAuditGetVirtType(vmDef);\n\n    virUUIDFormat(vmDef->uuid, uuidstr);\n    virMacAddrFormat(&netDef->mac, macstr);\n    rdev = virDomainAuditGetRdev(device);\n\n    if (!(vmname = virAuditEncode(\"vm\", vmDef->name)) ||\n        !(dev_name = virAuditEncode(\"path\", device))) {\n        VIR_WARN(\"OOM while encoding audit message\");\n        goto cleanup;\n    }\n\n    VIR_AUDIT(VIR_AUDIT_RECORD_RESOURCE, success,\n              \"virt=%s resrc=net reason=open %s uuid=%s net=%s %s rdev=%s\",\n              virt, vmname, uuidstr, macstr, dev_name, VIR_AUDIT_STR(rdev));\n\n cleanup:\n    VIR_FREE(vmname);\n    VIR_FREE(dev_name);\n    VIR_FREE(rdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevMacVLanCreateWithVPortProfile",
          "args": [
            "net->ifname",
            "&net->mac",
            "virDomainNetGetActualDirectDev(net)",
            "virDomainNetGetActualDirectMode(net)",
            "virDomainNetGetActualVlan(net)",
            "def->uuid",
            "virDomainNetGetActualVirtPortProfile(net)",
            "&res_ifname",
            "vmop",
            "cfg->stateDir",
            "tapfd",
            "tapfdSize",
            "macvlan_create_flags"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMacVLanCreateWithVPortProfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevmacvlan.c",
          "lines": "1219-1236",
          "snippet": "int virNetDevMacVLanCreateWithVPortProfile(const char *ifname G_GNUC_UNUSED,\n                                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                                           const char *linkdev G_GNUC_UNUSED,\n                                           virNetDevMacVLanMode mode G_GNUC_UNUSED,\n                                           const virNetDevVlan *vlan G_GNUC_UNUSED,\n                                           const unsigned char *vmuuid G_GNUC_UNUSED,\n                                           const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                           char **res_ifname G_GNUC_UNUSED,\n                                           virNetDevVPortProfileOp vmop G_GNUC_UNUSED,\n                                           char *stateDir G_GNUC_UNUSED,\n                                           int *tapfd G_GNUC_UNUSED,\n                                           size_t tapfdSize G_GNUC_UNUSED,\n                                           unsigned int unused_flags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include \"virsocket.h\"",
            "# include \"virbitmap.h\"",
            "# include \"virpidfile.h\"",
            "# include \"virnetdev.h\"",
            "# include \"virnetlink.h\"",
            "# include \"virfile.h\"",
            "# include \"viruuid.h\"",
            "# include \"virlog.h\"",
            "# include \"viralloc.h\"",
            "# include <linux/if_tun.h>",
            "# include <net/if.h>",
            "# include <fcntl.h>",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include \"virsocket.h\"\n# include \"virbitmap.h\"\n# include \"virpidfile.h\"\n# include \"virnetdev.h\"\n# include \"virnetlink.h\"\n# include \"virfile.h\"\n# include \"viruuid.h\"\n# include \"virlog.h\"\n# include \"viralloc.h\"\n# include <linux/if_tun.h>\n# include <net/if.h>\n# include <fcntl.h>\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virnetdevmacvlan.h\"\n#include <config.h>\n\nint virNetDevMacVLanCreateWithVPortProfile(const char *ifname G_GNUC_UNUSED,\n                                           const virMacAddr *macaddress G_GNUC_UNUSED,\n                                           const char *linkdev G_GNUC_UNUSED,\n                                           virNetDevMacVLanMode mode G_GNUC_UNUSED,\n                                           const virNetDevVlan *vlan G_GNUC_UNUSED,\n                                           const unsigned char *vmuuid G_GNUC_UNUSED,\n                                           const virNetDevVPortProfile *virtPortProfile G_GNUC_UNUSED,\n                                           char **res_ifname G_GNUC_UNUSED,\n                                           virNetDevVPortProfileOp vmop G_GNUC_UNUSED,\n                                           char *stateDir G_GNUC_UNUSED,\n                                           int *tapfd G_GNUC_UNUSED,\n                                           size_t tapfdSize G_GNUC_UNUSED,\n                                           unsigned int unused_flags G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Cannot create macvlan devices on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualVirtPortProfile",
          "args": [
            "net"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualVirtPortProfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30224-30255",
          "snippet": "const virNetDevVPortProfile *\nvirDomainNetGetActualVirtPortProfile(const virDomainNetDef *iface)\n{\n    switch (iface->type) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        return iface->virtPortProfile;\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (!iface->data.network.actual)\n            return NULL;\n        switch (iface->data.network.actual->type) {\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n            return iface->data.network.actual->virtPortProfile;\n        default:\n            return NULL;\n        }\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevVPortProfile *\nvirDomainNetGetActualVirtPortProfile(const virDomainNetDef *iface)\n{\n    switch (iface->type) {\n    case VIR_DOMAIN_NET_TYPE_DIRECT:\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n        return iface->virtPortProfile;\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (!iface->data.network.actual)\n            return NULL;\n        switch (iface->data.network.actual->type) {\n        case VIR_DOMAIN_NET_TYPE_DIRECT:\n        case VIR_DOMAIN_NET_TYPE_BRIDGE:\n        case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n            return iface->data.network.actual->virtPortProfile;\n        default:\n            return NULL;\n        }\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n    default:\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualVlan",
          "args": [
            "net"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualVlan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30269-30284",
          "snippet": "const virNetDevVlan *\nvirDomainNetGetActualVlan(const virDomainNetDef *iface)\n{\n    const virNetDevVlan *vlan = &iface->vlan;\n\n    /* if there is an ActualNetDef, *always* return\n     * its vlan rather than the NetDef's vlan.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        vlan = &iface->data.network.actual->vlan;\n\n    if (vlan->nTags > 0)\n        return vlan;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst virNetDevVlan *\nvirDomainNetGetActualVlan(const virDomainNetDef *iface)\n{\n    const virNetDevVlan *vlan = &iface->vlan;\n\n    /* if there is an ActualNetDef, *always* return\n     * its vlan rather than the NetDef's vlan.\n     */\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual)\n        vlan = &iface->data.network.actual->vlan;\n\n    if (vlan->nTags > 0)\n        return vlan;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualDirectMode",
          "args": [
            "net"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualDirectMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30200-30210",
          "snippet": "int\nvirDomainNetGetActualDirectMode(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.mode;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.mode;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetGetActualDirectMode(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.mode;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.mode;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualDirectDev",
          "args": [
            "net"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualDirectDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30188-30198",
          "snippet": "const char *\nvirDomainNetGetActualDirectDev(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.linkdev;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.linkdev;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainNetGetActualDirectDev(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.linkdev;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.linkdev;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetIsVirtioModel",
          "args": [
            "net"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetIsVirtioModel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30344-30350",
          "snippet": "bool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirDomainNetIsVirtioModel(const virDomainNetDef *net)\n{\n    return (net->model == VIR_DOMAIN_NET_MODEL_VIRTIO ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_TRANSITIONAL ||\n            net->model == VIR_DOMAIN_NET_MODEL_VIRTIO_NON_TRANSITIONAL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceDirectConnect(virDomainDefPtr def,\n                           virQEMUDriverPtr driver,\n                           virDomainNetDefPtr net,\n                           int *tapfd,\n                           size_t tapfdSize,\n                           virNetDevVPortProfileOp vmop)\n{\n    int ret = -1;\n    char *res_ifname = NULL;\n    virQEMUDriverConfigPtr cfg = virQEMUDriverGetConfig(driver);\n    unsigned int macvlan_create_flags = VIR_NETDEV_MACVLAN_CREATE_WITH_TAP;\n\n    if (virDomainNetIsVirtioModel(net))\n        macvlan_create_flags |= VIR_NETDEV_MACVLAN_VNET_HDR;\n\n    if (virNetDevMacVLanCreateWithVPortProfile(net->ifname,\n                                               &net->mac,\n                                               virDomainNetGetActualDirectDev(net),\n                                               virDomainNetGetActualDirectMode(net),\n                                               virDomainNetGetActualVlan(net),\n                                               def->uuid,\n                                               virDomainNetGetActualVirtPortProfile(net),\n                                               &res_ifname,\n                                               vmop, cfg->stateDir,\n                                               tapfd, tapfdSize,\n                                               macvlan_create_flags) < 0)\n        goto cleanup;\n\n    virDomainAuditNetDevice(def, net, res_ifname, true);\n    VIR_FREE(net->ifname);\n    net->ifname = res_ifname;\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        while (tapfdSize--)\n            VIR_FORCE_CLOSE(tapfd[tapfdSize]);\n    }\n    virObjectUnref(cfg);\n    return ret;\n}"
  },
  {
    "function_name": "qemuInterfaceStopDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "221-231",
    "snippet": "int\nqemuInterfaceStopDevices(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuInterfaceStopDevice(def->nets[i]) < 0)\n            return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuInterfaceStopDevice",
          "args": [
            "def->nets[i]"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "qemuInterfaceStopDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
          "lines": "221-231",
          "snippet": "int\nqemuInterfaceStopDevices(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuInterfaceStopDevice(def->nets[i]) < 0)\n            return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceStopDevices(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuInterfaceStopDevice(def->nets[i]) < 0)\n            return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "qemuInterfaceStopDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "156-212",
    "snippet": "int\nqemuInterfaceStopDevice(virDomainNetDefPtr net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (virDomainNetGetActualBridgeMACTableManager(net)\n            == VIR_NETWORK_BRIDGE_MAC_TABLE_MANAGER_LIBVIRT) {\n            /* remove the FDB entries that were added during\n             * qemuInterfaceStartDevices()\n             */\n            if (virNetDevBridgeFDBDel(&net->mac, net->ifname,\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_MASTER |\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_TEMP) < 0)\n                return -1;\n        }\n        break;\n\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        const char *physdev = virDomainNetGetActualDirectDev(net);\n\n        /* macvtap interfaces need to be marked !IFF_UP (ie \"down\") to\n         * prevent any host-generated traffic sent from this interface\n         * from putting bad info into the arp caches of other machines\n         * on this network.\n         */\n        if (virNetDevSetOnline(net->ifname, false) < 0)\n            return -1;\n\n        /* also mark the physdev down for passthrough macvtap, as the\n         * physdev has the same MAC address as the macvtap device.\n         */\n        if (virDomainNetGetActualDirectMode(net) ==\n            VIR_NETDEV_MACVLAN_MODE_PASSTHRU &&\n            physdev && virNetDevSetOnline(physdev, false) < 0)\n            return -1;\n        break;\n    }\n\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        /* these types all require no action */\n        break;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetOnline",
          "args": [
            "physdev",
            "false"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "660-665",
          "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualDirectMode",
          "args": [
            "net"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualDirectMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30200-30210",
          "snippet": "int\nvirDomainNetGetActualDirectMode(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.mode;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.mode;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetGetActualDirectMode(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.mode;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.mode;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualDirectDev",
          "args": [
            "net"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualDirectDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30188-30198",
          "snippet": "const char *\nvirDomainNetGetActualDirectDev(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.linkdev;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.linkdev;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainNetGetActualDirectDev(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.linkdev;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.linkdev;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeFDBDel",
          "args": [
            "&net->mac",
            "net->ifname",
            "VIR_NETDEVBRIDGE_FDB_FLAG_MASTER |\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_TEMP"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeFDBDel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "1117-1122",
          "snippet": "int\nvirNetDevBridgeFDBDel(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, false);\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeFDBDel(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBridgeMACTableManager",
          "args": [
            "net"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBridgeMACTableManager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30177-30186",
          "snippet": "int\nvirDomainNetGetActualBridgeMACTableManager(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.macTableManager;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetGetActualBridgeMACTableManager(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.macTableManager;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualType",
          "args": [
            "net"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30154-30162",
          "snippet": "virDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceStopDevice(virDomainNetDefPtr net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (virDomainNetGetActualBridgeMACTableManager(net)\n            == VIR_NETWORK_BRIDGE_MAC_TABLE_MANAGER_LIBVIRT) {\n            /* remove the FDB entries that were added during\n             * qemuInterfaceStartDevices()\n             */\n            if (virNetDevBridgeFDBDel(&net->mac, net->ifname,\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_MASTER |\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_TEMP) < 0)\n                return -1;\n        }\n        break;\n\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        const char *physdev = virDomainNetGetActualDirectDev(net);\n\n        /* macvtap interfaces need to be marked !IFF_UP (ie \"down\") to\n         * prevent any host-generated traffic sent from this interface\n         * from putting bad info into the arp caches of other machines\n         * on this network.\n         */\n        if (virNetDevSetOnline(net->ifname, false) < 0)\n            return -1;\n\n        /* also mark the physdev down for passthrough macvtap, as the\n         * physdev has the same MAC address as the macvtap device.\n         */\n        if (virDomainNetGetActualDirectMode(net) ==\n            VIR_NETDEV_MACVLAN_MODE_PASSTHRU &&\n            physdev && virNetDevSetOnline(physdev, false) < 0)\n            return -1;\n        break;\n    }\n\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        /* these types all require no action */\n        break;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuInterfaceStartDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "135-145",
    "snippet": "int\nqemuInterfaceStartDevices(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuInterfaceStartDevice(def->nets[i]) < 0)\n            return -1;\n    }\n    return 0;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuInterfaceStartDevice",
          "args": [
            "def->nets[i]"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "qemuInterfaceStartDevices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
          "lines": "135-145",
          "snippet": "int\nqemuInterfaceStartDevices(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuInterfaceStartDevice(def->nets[i]) < 0)\n            return -1;\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceStartDevices(virDomainDefPtr def)\n{\n    size_t i;\n\n    for (i = 0; i < def->nnets; i++) {\n        if (qemuInterfaceStartDevice(def->nets[i]) < 0)\n            return -1;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "qemuInterfaceStartDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_interface.c",
    "lines": "53-127",
    "snippet": "int\nqemuInterfaceStartDevice(virDomainNetDefPtr net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (virDomainNetGetActualBridgeMACTableManager(net)\n            == VIR_NETWORK_BRIDGE_MAC_TABLE_MANAGER_LIBVIRT) {\n            /* libvirt is managing the FDB of the bridge this device\n             * is attaching to, so we have turned off learning and\n             * unicast_flood on the device to prevent the kernel from\n             * adding any FDB entries for it. This means we need to\n             * add an fdb entry ourselves, using the MAC address from\n             * the interface config.\n             */\n            if (virNetDevBridgeFDBAdd(&net->mac, net->ifname,\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_MASTER |\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_TEMP) < 0)\n                return -1;\n        }\n        break;\n\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        const char *physdev = virDomainNetGetActualDirectDev(net);\n        bool isOnline = true;\n\n        /* set the physdev online if necessary. It may already be up,\n         * in which case we shouldn't re-up it just in case that causes\n         * some sort of \"blip\" in the physdev's status.\n         */\n        if (physdev && virNetDevGetOnline(physdev, &isOnline) < 0)\n            return -1;\n        if (!isOnline && virNetDevSetOnline(physdev, true) < 0)\n            return -1;\n\n        /* macvtap devices share their MAC address with the guest\n         * domain, and if they are set online prior to the domain CPUs\n         * being started, the host may send out traffic from this\n         * device that could confuse other entities on the network (in\n         * particular, if this new domain is the destination of a\n         * migration, and the source domain is still running, another\n         * host may mistakenly direct traffic for the guest to the\n         * destination domain rather than source domain). To prevent\n         * this, we create the macvtap device with IFF_UP false\n         * (i.e. \"offline\") then wait to bring it online until just as\n         * we are starting the domain CPUs.\n         */\n        if (virNetDevSetOnline(net->ifname, true) < 0)\n            return -1;\n        break;\n    }\n\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (virNetDevIPInfoAddToDev(net->ifname, &net->hostIP) < 0)\n            return -1;\n\n        break;\n\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        /* these types all require no action */\n        break;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include \"virsocket.h\"",
      "#include \"virnetdevvportprofile.h\"",
      "#include \"virnetdevbridge.h\"",
      "#include \"virnetdevmacvlan.h\"",
      "#include \"virnetdevtap.h\"",
      "#include \"virnetdev.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"qemu_interface.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_audit.h\"",
      "#include \"network_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevIPInfoAddToDev",
          "args": [
            "net->ifname",
            "&net->hostIP"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIPInfoAddToDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevip.c",
          "lines": "1071-1113",
          "snippet": "int\nvirNetDevIPInfoAddToDev(const char *ifname,\n                        virNetDevIPInfo const *ipInfo)\n{\n    size_t i;\n    int prefix;\n    g_autofree char *ipStr = NULL;\n\n    /* add all IP addresses */\n    for (i = 0; i < ipInfo->nips; i++) {\n        virNetDevIPAddrPtr ip = ipInfo->ips[i];\n\n        if ((prefix = virSocketAddrGetIPPrefix(&ip->address,\n                                               NULL, ip->prefix)) < 0) {\n            ipStr = virSocketAddrFormat(&ip->address);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to determine prefix for IP address '%s'\"),\n                           NULLSTR(ipStr));\n            return -1;\n        }\n        if (virNetDevIPAddrAdd(ifname, &ip->address, &ip->peer, prefix) < 0)\n            return -1;\n    }\n\n    /* add all routes */\n    for (i = 0; i < ipInfo->nroutes; i++) {\n        virNetDevIPRoutePtr route = ipInfo->routes[i];\n\n        if ((prefix = virNetDevIPRouteGetPrefix(route)) < 0) {\n            ipStr = virSocketAddrFormat(&route->address);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to determine prefix for route with destination '%s'\"),\n                           NULLSTR(ipStr));\n            return -1;\n        }\n        if (virNetDevIPRouteAdd(ifname, &route->address, prefix,\n                                &route->gateway,\n                                virNetDevIPRouteGetMetric(route)) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <net/if.h>",
            "# include <sys/ioctl.h>",
            "# include <ifaddrs.h>",
            "#include \"viralloc.h\"",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetlink.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevip.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <net/if.h>\n# include <sys/ioctl.h>\n# include <ifaddrs.h>\n#include \"viralloc.h\"\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virnetlink.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevip.h\"\n#include <config.h>\n\nint\nvirNetDevIPInfoAddToDev(const char *ifname,\n                        virNetDevIPInfo const *ipInfo)\n{\n    size_t i;\n    int prefix;\n    g_autofree char *ipStr = NULL;\n\n    /* add all IP addresses */\n    for (i = 0; i < ipInfo->nips; i++) {\n        virNetDevIPAddrPtr ip = ipInfo->ips[i];\n\n        if ((prefix = virSocketAddrGetIPPrefix(&ip->address,\n                                               NULL, ip->prefix)) < 0) {\n            ipStr = virSocketAddrFormat(&ip->address);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to determine prefix for IP address '%s'\"),\n                           NULLSTR(ipStr));\n            return -1;\n        }\n        if (virNetDevIPAddrAdd(ifname, &ip->address, &ip->peer, prefix) < 0)\n            return -1;\n    }\n\n    /* add all routes */\n    for (i = 0; i < ipInfo->nroutes; i++) {\n        virNetDevIPRoutePtr route = ipInfo->routes[i];\n\n        if ((prefix = virNetDevIPRouteGetPrefix(route)) < 0) {\n            ipStr = virSocketAddrFormat(&route->address);\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Failed to determine prefix for route with destination '%s'\"),\n                           NULLSTR(ipStr));\n            return -1;\n        }\n        if (virNetDevIPRouteAdd(ifname, &route->address, prefix,\n                                &route->gateway,\n                                virNetDevIPRouteGetMetric(route)) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetOnline",
          "args": [
            "net->ifname",
            "true"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "660-665",
          "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetOnline",
          "args": [
            "physdev",
            "&isOnline"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "765-770",
          "snippet": "int\nvirNetDevGetOnline(const char *ifname,\n                   bool *online)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetOnline(const char *ifname,\n                   bool *online)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualDirectDev",
          "args": [
            "net"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualDirectDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30188-30198",
          "snippet": "const char *\nvirDomainNetGetActualDirectDev(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.linkdev;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.linkdev;\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainNetGetActualDirectDev(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.direct.linkdev;\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_DIRECT)\n        return iface->data.network.actual->data.direct.linkdev;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevBridgeFDBAdd",
          "args": [
            "&net->mac",
            "net->ifname",
            "VIR_NETDEVBRIDGE_FDB_FLAG_MASTER |\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_TEMP"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevBridgeFDBAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdevbridge.c",
          "lines": "1109-1114",
          "snippet": "int\nvirNetDevBridgeFDBAdd(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, true);\n}",
          "includes": [
            "# include <net/if_bridgevar.h>",
            "# include <net/ethernet.h>",
            "# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */",
            "# include <linux/in6.h>",
            "# include <linux/param.h>     /* HZ                 */",
            "# include <linux/sockios.h>",
            "#  include \"virnetlink.h\"",
            "# include <net/if.h>",
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetdevbridge.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <net/if_bridgevar.h>\n# include <net/ethernet.h>\n# include <linux/if_bridge.h> /* SYSFS_BRIDGE_ATTR  */\n# include <linux/in6.h>\n# include <linux/param.h>     /* HZ                 */\n# include <linux/sockios.h>\n#  include \"virnetlink.h\"\n# include <net/if.h>\n#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"virnetdevbridge.h\"\n#include <config.h>\n\nint\nvirNetDevBridgeFDBAdd(const virMacAddr *mac, const char *ifname,\n                      unsigned int flags)\n{\n    return virNetDevBridgeFDBAddDel(mac, ifname, flags, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualBridgeMACTableManager",
          "args": [
            "net"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualBridgeMACTableManager",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30177-30186",
          "snippet": "int\nvirDomainNetGetActualBridgeMACTableManager(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.macTableManager;\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetGetActualBridgeMACTableManager(const virDomainNetDef *iface)\n{\n    if (iface->type == VIR_DOMAIN_NET_TYPE_NETWORK &&\n        iface->data.network.actual &&\n        (iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_BRIDGE ||\n         iface->data.network.actual->type == VIR_DOMAIN_NET_TYPE_NETWORK))\n        return iface->data.network.actual->data.bridge.macTableManager;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainNetGetActualType",
          "args": [
            "net"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetGetActualType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30154-30162",
          "snippet": "virDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainNetType\nvirDomainNetGetActualType(const virDomainNetDef *iface)\n{\n    if (iface->type != VIR_DOMAIN_NET_TYPE_NETWORK)\n        return iface->type;\n    if (!iface->data.network.actual)\n        return iface->type;\n    return iface->data.network.actual->type;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <sys/stat.h>\n#include \"virsocket.h\"\n#include \"virnetdevvportprofile.h\"\n#include \"virnetdevbridge.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_interface.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_audit.h\"\n#include \"network_conf.h\"\n#include <config.h>\n\nint\nqemuInterfaceStartDevice(virDomainNetDefPtr net)\n{\n    virDomainNetType actualType = virDomainNetGetActualType(net);\n\n    switch (actualType) {\n    case VIR_DOMAIN_NET_TYPE_BRIDGE:\n    case VIR_DOMAIN_NET_TYPE_NETWORK:\n        if (virDomainNetGetActualBridgeMACTableManager(net)\n            == VIR_NETWORK_BRIDGE_MAC_TABLE_MANAGER_LIBVIRT) {\n            /* libvirt is managing the FDB of the bridge this device\n             * is attaching to, so we have turned off learning and\n             * unicast_flood on the device to prevent the kernel from\n             * adding any FDB entries for it. This means we need to\n             * add an fdb entry ourselves, using the MAC address from\n             * the interface config.\n             */\n            if (virNetDevBridgeFDBAdd(&net->mac, net->ifname,\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_MASTER |\n                                      VIR_NETDEVBRIDGE_FDB_FLAG_TEMP) < 0)\n                return -1;\n        }\n        break;\n\n    case VIR_DOMAIN_NET_TYPE_DIRECT: {\n        const char *physdev = virDomainNetGetActualDirectDev(net);\n        bool isOnline = true;\n\n        /* set the physdev online if necessary. It may already be up,\n         * in which case we shouldn't re-up it just in case that causes\n         * some sort of \"blip\" in the physdev's status.\n         */\n        if (physdev && virNetDevGetOnline(physdev, &isOnline) < 0)\n            return -1;\n        if (!isOnline && virNetDevSetOnline(physdev, true) < 0)\n            return -1;\n\n        /* macvtap devices share their MAC address with the guest\n         * domain, and if they are set online prior to the domain CPUs\n         * being started, the host may send out traffic from this\n         * device that could confuse other entities on the network (in\n         * particular, if this new domain is the destination of a\n         * migration, and the source domain is still running, another\n         * host may mistakenly direct traffic for the guest to the\n         * destination domain rather than source domain). To prevent\n         * this, we create the macvtap device with IFF_UP false\n         * (i.e. \"offline\") then wait to bring it online until just as\n         * we are starting the domain CPUs.\n         */\n        if (virNetDevSetOnline(net->ifname, true) < 0)\n            return -1;\n        break;\n    }\n\n    case VIR_DOMAIN_NET_TYPE_ETHERNET:\n        if (virNetDevIPInfoAddToDev(net->ifname, &net->hostIP) < 0)\n            return -1;\n\n        break;\n\n    case VIR_DOMAIN_NET_TYPE_USER:\n    case VIR_DOMAIN_NET_TYPE_VHOSTUSER:\n    case VIR_DOMAIN_NET_TYPE_SERVER:\n    case VIR_DOMAIN_NET_TYPE_CLIENT:\n    case VIR_DOMAIN_NET_TYPE_MCAST:\n    case VIR_DOMAIN_NET_TYPE_UDP:\n    case VIR_DOMAIN_NET_TYPE_INTERNAL:\n    case VIR_DOMAIN_NET_TYPE_HOSTDEV:\n    case VIR_DOMAIN_NET_TYPE_LAST:\n        /* these types all require no action */\n        break;\n    }\n\n    return 0;\n}"
  }
]