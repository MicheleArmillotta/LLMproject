[
  {
    "function_name": "vboxArrayRelease",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "767-779",
    "snippet": "void\nvboxArrayRelease(vboxArray *array)\n{\n    if (array->handle == NULL)\n        return;\n\n    SafeArrayUnaccessData(array->handle);\n    SafeArrayDestroy(array->handle);\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SafeArrayDestroy",
          "args": [
            "array->handle"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SafeArrayUnaccessData",
          "args": [
            "array->handle"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvboxArrayRelease(vboxArray *array)\n{\n    if (array->handle == NULL)\n        return;\n\n    SafeArrayUnaccessData(array->handle);\n    SafeArrayDestroy(array->handle);\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n}"
  },
  {
    "function_name": "vboxArrayGetWithUintArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "749-758",
    "snippet": "nsresult\nvboxArrayGetWithUintArg(vboxArray *array, void *self, void *getter, PRUint32 arg)\n{\n    HRESULT hrc;\n    SAFEARRAY *safeArray = NULL;\n\n    hrc = ((SafeArrayGetterWithUintArg)getter)(self, arg, &safeArray);\n\n    return vboxArrayGetHelper(array, hrc, safeArray);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vboxArrayGetHelper",
          "args": [
            "array",
            "hrc",
            "safeArray"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "vboxArrayGetHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "689-713",
          "snippet": "static nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "self",
            "arg",
            "&safeArray"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nnsresult\nvboxArrayGetWithUintArg(vboxArray *array, void *self, void *getter, PRUint32 arg)\n{\n    HRESULT hrc;\n    SAFEARRAY *safeArray = NULL;\n\n    hrc = ((SafeArrayGetterWithUintArg)getter)(self, arg, &safeArray);\n\n    return vboxArrayGetHelper(array, hrc, safeArray);\n}"
  },
  {
    "function_name": "vboxArrayGetWithPtrArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "734-743",
    "snippet": "nsresult\nvboxArrayGetWithPtrArg(vboxArray *array, void *self, void *getter, void *arg)\n{\n    HRESULT hrc;\n    SAFEARRAY *safeArray = NULL;\n\n    hrc = ((SafeArrayGetterWithPtrArg)getter)(self, arg, &safeArray);\n\n    return vboxArrayGetHelper(array, hrc, safeArray);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vboxArrayGetHelper",
          "args": [
            "array",
            "hrc",
            "safeArray"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "vboxArrayGetHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "689-713",
          "snippet": "static nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "self",
            "arg",
            "&safeArray"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nnsresult\nvboxArrayGetWithPtrArg(vboxArray *array, void *self, void *getter, void *arg)\n{\n    HRESULT hrc;\n    SAFEARRAY *safeArray = NULL;\n\n    hrc = ((SafeArrayGetterWithPtrArg)getter)(self, arg, &safeArray);\n\n    return vboxArrayGetHelper(array, hrc, safeArray);\n}"
  },
  {
    "function_name": "vboxArrayGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "719-728",
    "snippet": "nsresult\nvboxArrayGet(vboxArray *array, void *self, void *getter)\n{\n    HRESULT hrc;\n    SAFEARRAY *safeArray = NULL;\n\n    hrc = ((SafeArrayGetter)getter)(self, &safeArray);\n\n    return vboxArrayGetHelper(array, hrc, safeArray);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vboxArrayGetHelper",
          "args": [
            "array",
            "hrc",
            "safeArray"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "vboxArrayGetHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "689-713",
          "snippet": "static nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "self",
            "&safeArray"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nnsresult\nvboxArrayGet(vboxArray *array, void *self, void *getter)\n{\n    HRESULT hrc;\n    SAFEARRAY *safeArray = NULL;\n\n    hrc = ((SafeArrayGetter)getter)(self, &safeArray);\n\n    return vboxArrayGetHelper(array, hrc, safeArray);\n}"
  },
  {
    "function_name": "vboxArrayGetHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "689-713",
    "snippet": "static nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SafeArrayDestroy",
          "args": [
            "safeArray"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FAILED",
          "args": [
            "hrc"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SafeArrayAccessData",
          "args": [
            "safeArray",
            "(void **)&items"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FAILED",
          "args": [
            "hrc"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult\nvboxArrayGetHelper(vboxArray *array, HRESULT hrc, SAFEARRAY *safeArray)\n{\n    void **items = NULL;\n\n    array->items = NULL;\n    array->count = 0;\n    array->handle = NULL;\n\n    if (FAILED(hrc))\n        return hrc;\n\n    hrc = SafeArrayAccessData(safeArray, (void **)&items);\n\n    if (FAILED(hrc)) {\n        SafeArrayDestroy(safeArray);\n        return hrc;\n    }\n\n    array->items = items;\n    array->count = safeArray->rgsabound[0].cElements;\n    array->handle = safeArray;\n\n    return hrc;\n}"
  },
  {
    "function_name": "VBoxCGlueTerm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "668-671",
    "snippet": "void\nVBoxCGlueTerm(void)\n{\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nVBoxCGlueTerm(void)\n{\n}"
  },
  {
    "function_name": "VBoxCGlueInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "656-666",
    "snippet": "int\nVBoxCGlueInit(unsigned int *version)\n{\n    if (vboxLookupVersionInRegistry() < 0)\n        return -1;\n\n    *version = vboxGetVersion();\n    g_pfnGetFunctions = vboxGetFunctions;\n\n    return 0;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "PFNVBOXGETXPCOMCFUNCTIONS g_pfnGetFunctions = NULL;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vboxGetVersion",
          "args": [],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "vboxGetVersion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "443-447",
          "snippet": "static unsigned int\nvboxGetVersion(void)\n{\n    return vboxVersion;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long vboxVersion;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned long vboxVersion;\n\nstatic unsigned int\nvboxGetVersion(void)\n{\n    return vboxVersion;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vboxLookupVersionInRegistry",
          "args": [],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "vboxLookupVersionInRegistry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "390-441",
          "snippet": "static int\nvboxLookupVersionInRegistry(void)\n{\n    int result = -1;\n    const char *keyName = VBOX_REGKEY_ORACLE;\n    LONG status;\n    HKEY key;\n    char *value = NULL;\n\n    status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n    if (status != ERROR_SUCCESS) {\n        keyName = VBOX_REGKEY_SUN;\n        status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n        if (status != ERROR_SUCCESS) {\n            /* Both keys aren't there, or we cannot open them. In general this\n             * indicates that VirtualBox is not installed, so we just silently\n             * fail here making vboxRegister() register the dummy driver. */\n            return -1;\n        }\n    }\n\n    /* The registry key layout changed around version 4.0.8. Before the version\n     * number was in the Version key, now the Version key can contain %VER% and\n     * the actual version number is in the VersionExt key then. */\n    value = vboxLookupRegistryValue(key, keyName, \"Version\");\n\n    if (value == NULL)\n        goto cleanup;\n\n    if (STREQ(value, \"%VER%\")) {\n        VIR_FREE(value);\n        value = vboxLookupRegistryValue(key, keyName, \"VersionExt\");\n\n        if (value == NULL)\n            goto cleanup;\n    }\n\n    if (virParseVersionString(value, &vboxVersion, false) < 0) {\n        VIR_ERROR(_(\"Could not parse version number from '%s'\"), value);\n        goto cleanup;\n    }\n\n    result = 0;\n\n cleanup:\n    VIR_FREE(value);\n    RegCloseKey(key);\n\n    return result;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VBOX_REGKEY_SUN \"Software\\\\Sun\\\\xVM VirtualBox\"",
            "#define VBOX_REGKEY_ORACLE \"Software\\\\Oracle\\\\VirtualBox\""
          ],
          "globals_used": [
            "static unsigned long vboxVersion;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define VBOX_REGKEY_SUN \"Software\\\\Sun\\\\xVM VirtualBox\"\n#define VBOX_REGKEY_ORACLE \"Software\\\\Oracle\\\\VirtualBox\"\n\nstatic unsigned long vboxVersion;\n\nstatic int\nvboxLookupVersionInRegistry(void)\n{\n    int result = -1;\n    const char *keyName = VBOX_REGKEY_ORACLE;\n    LONG status;\n    HKEY key;\n    char *value = NULL;\n\n    status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n    if (status != ERROR_SUCCESS) {\n        keyName = VBOX_REGKEY_SUN;\n        status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n        if (status != ERROR_SUCCESS) {\n            /* Both keys aren't there, or we cannot open them. In general this\n             * indicates that VirtualBox is not installed, so we just silently\n             * fail here making vboxRegister() register the dummy driver. */\n            return -1;\n        }\n    }\n\n    /* The registry key layout changed around version 4.0.8. Before the version\n     * number was in the Version key, now the Version key can contain %VER% and\n     * the actual version number is in the VersionExt key then. */\n    value = vboxLookupRegistryValue(key, keyName, \"Version\");\n\n    if (value == NULL)\n        goto cleanup;\n\n    if (STREQ(value, \"%VER%\")) {\n        VIR_FREE(value);\n        value = vboxLookupRegistryValue(key, keyName, \"VersionExt\");\n\n        if (value == NULL)\n            goto cleanup;\n    }\n\n    if (virParseVersionString(value, &vboxVersion, false) < 0) {\n        VIR_ERROR(_(\"Could not parse version number from '%s'\"), value);\n        goto cleanup;\n    }\n\n    result = 0;\n\n cleanup:\n    VIR_FREE(value);\n    RegCloseKey(key);\n\n    return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nPFNVBOXGETXPCOMCFUNCTIONS g_pfnGetFunctions = NULL;\n\nint\nVBoxCGlueInit(unsigned int *version)\n{\n    if (vboxLookupVersionInRegistry() < 0)\n        return -1;\n\n    *version = vboxGetVersion();\n    g_pfnGetFunctions = vboxGetFunctions;\n\n    return 0;\n}"
  },
  {
    "function_name": "vboxGetFunctions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "642-652",
    "snippet": "static PCVBOXXPCOM\nvboxGetFunctions(unsigned int version)\n{\n    if (version == 0x00010000U) {\n        return (PCVBOXXPCOM)&vboxXPCOMC_v1;\n    } else if (version == 0x00020000U) {\n        return (PCVBOXXPCOM)&vboxXPCOMC_v2;\n    } else {\n        return NULL;\n    }\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static VBOXXPCOMC_v1 vboxXPCOMC_v1 = {\n    sizeof(VBOXXPCOMC_v1),      /* cb */\n    0x00010000U,                /* uVersion */\n    vboxGetVersion,             /* pfnGetVersion */\n    vboxComInitialize_v1,       /* pfnComInitialize */\n    vboxComUninitialize,        /* pfnComUninitialize */\n    vboxComUnallocMem,          /* pfnComUnallocMem */\n    vboxUtf16Free,              /* pfnUtf16Free */\n    vboxUtf8Free,               /* pfnUtf8Free */\n    vboxUtf16ToUtf8,            /* pfnUtf16ToUtf8 */\n    vboxUtf8ToUtf16,            /* pfnUtf8ToUtf16 */\n    0x00010000U                 /* uEndVersion */\n};",
      "static VBOXXPCOMC_v2 vboxXPCOMC_v2 = {\n    sizeof(VBOXXPCOMC_v2),      /* cb */\n    0x00020000U,                /* uVersion */\n    vboxGetVersion,             /* pfnGetVersion */\n    vboxComInitialize_v2,       /* pfnComInitialize */\n    vboxComUninitialize,        /* pfnComUninitialize */\n    vboxComUnallocMem,          /* pfnComUnallocMem */\n    vboxUtf16Free,              /* pfnUtf16Free */\n    vboxUtf8Free,               /* pfnUtf8Free */\n    vboxUtf16ToUtf8,            /* pfnUtf16ToUtf8 */\n    vboxUtf8ToUtf16,            /* pfnUtf8ToUtf16 */\n    vboxGetEventQueue,          /* pfnGetEventQueue */\n    0x00020000U                 /* uEndVersion */\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic VBOXXPCOMC_v1 vboxXPCOMC_v1 = {\n    sizeof(VBOXXPCOMC_v1),      /* cb */\n    0x00010000U,                /* uVersion */\n    vboxGetVersion,             /* pfnGetVersion */\n    vboxComInitialize_v1,       /* pfnComInitialize */\n    vboxComUninitialize,        /* pfnComUninitialize */\n    vboxComUnallocMem,          /* pfnComUnallocMem */\n    vboxUtf16Free,              /* pfnUtf16Free */\n    vboxUtf8Free,               /* pfnUtf8Free */\n    vboxUtf16ToUtf8,            /* pfnUtf16ToUtf8 */\n    vboxUtf8ToUtf16,            /* pfnUtf8ToUtf16 */\n    0x00010000U                 /* uEndVersion */\n};\nstatic VBOXXPCOMC_v2 vboxXPCOMC_v2 = {\n    sizeof(VBOXXPCOMC_v2),      /* cb */\n    0x00020000U,                /* uVersion */\n    vboxGetVersion,             /* pfnGetVersion */\n    vboxComInitialize_v2,       /* pfnComInitialize */\n    vboxComUninitialize,        /* pfnComUninitialize */\n    vboxComUnallocMem,          /* pfnComUnallocMem */\n    vboxUtf16Free,              /* pfnUtf16Free */\n    vboxUtf8Free,               /* pfnUtf8Free */\n    vboxUtf16ToUtf8,            /* pfnUtf16ToUtf8 */\n    vboxUtf8ToUtf16,            /* pfnUtf8ToUtf16 */\n    vboxGetEventQueue,          /* pfnGetEventQueue */\n    0x00020000U                 /* uEndVersion */\n};\n\nstatic PCVBOXXPCOM\nvboxGetFunctions(unsigned int version)\n{\n    if (version == 0x00010000U) {\n        return (PCVBOXXPCOM)&vboxXPCOMC_v1;\n    } else if (version == 0x00020000U) {\n        return (PCVBOXXPCOM)&vboxXPCOMC_v2;\n    } else {\n        return NULL;\n    }\n}"
  },
  {
    "function_name": "vboxComUninitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "595-609",
    "snippet": "static void\nvboxComUninitialize(void)\n{\n    if (vboxVirtualBox != NULL) {\n        vboxVirtualBox->vtbl->nsisupports.Release((nsISupports *)vboxVirtualBox);\n        vboxVirtualBox = NULL;\n    }\n\n    if (vboxSession != NULL) {\n        vboxSession->vtbl->nsisupports.Release((nsISupports *)vboxSession);\n        vboxSession = NULL;\n    }\n\n    CoUninitialize();\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static IVirtualBox *vboxVirtualBox;",
      "static ISession *vboxSession;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CoUninitialize",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vboxSession->vtbl->nsisupports.Release",
          "args": [
            "(nsISupports *)vboxSession"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vboxVirtualBox->vtbl->nsisupports.Release",
          "args": [
            "(nsISupports *)vboxVirtualBox"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic IVirtualBox *vboxVirtualBox;\nstatic ISession *vboxSession;\n\nstatic void\nvboxComUninitialize(void)\n{\n    if (vboxVirtualBox != NULL) {\n        vboxVirtualBox->vtbl->nsisupports.Release((nsISupports *)vboxVirtualBox);\n        vboxVirtualBox = NULL;\n    }\n\n    if (vboxSession != NULL) {\n        vboxSession->vtbl->nsisupports.Release((nsISupports *)vboxSession);\n        vboxSession = NULL;\n    }\n\n    CoUninitialize();\n}"
  },
  {
    "function_name": "vboxComInitialize_v1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "588-593",
    "snippet": "static void\nvboxComInitialize_v1(IVirtualBox **ppVirtualBox, ISession **ppSession)\n{\n    vboxComInitialize_v2(IVIRTUALBOX_IID_STR_v2_2, ppVirtualBox,\n                         ISESSION_IID_STR_v2_2, ppSession);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define ISESSION_IID_STR_v2_2 \"12F4DCDB-12B2-4ec1-B7CD-DDD9F6C5BF4D\"",
      "#define IVIRTUALBOX_IID_STR_v2_2 \"779264f4-65ed-48ed-be39-518ca549e296\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vboxComInitialize_v2",
          "args": [
            "IVIRTUALBOX_IID_STR_v2_2",
            "ppVirtualBox",
            "ISESSION_IID_STR_v2_2",
            "ppSession"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "vboxComInitialize_v2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "505-586",
          "snippet": "static void\nvboxComInitialize_v2(const char *pszVirtualBoxIID, IVirtualBox **ppVirtualBox,\n                     const char *pszSessionIID, ISession **ppSession)\n{\n    int result = -1;\n    HRESULT hrc;\n    IID virtualBoxIID;\n    IID sessionIID;\n    char *mbsVirtualBoxIID = NULL;\n    char *mbsSessionIID = NULL;\n    PRUnichar *wcsVirtualBoxIID = NULL;\n    PRUnichar *wcsSessionIID = NULL;\n\n    *ppVirtualBox = NULL;\n    *ppSession = NULL;\n\n    CoInitialize(NULL);\n\n    mbsVirtualBoxIID = g_strdup_printf(\"{%s}\", pszVirtualBoxIID);\n    mbsSessionIID = g_strdup_printf(\"{%s}\", pszSessionIID)\n        goto cleanup;\n\n    if (vboxUtf8ToUtf16(mbsVirtualBoxIID, &wcsVirtualBoxIID) < 0 ||\n        vboxUtf8ToUtf16(mbsSessionIID, &wcsSessionIID) < 0) {\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsVirtualBoxIID, &virtualBoxIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsSessionIID, &sessionIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_VirtualBox, NULL, CLSCTX_LOCAL_SERVER,\n                           &virtualBoxIID, (void**)&vboxVirtualBox);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create VirtualBox instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_Session, NULL, CLSCTX_INPROC_SERVER,\n                           &sessionIID, (void**)&vboxSession);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create Session instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    *ppVirtualBox = vboxVirtualBox;\n    *ppSession = vboxSession;\n\n    result = 0;\n\n cleanup:\n    if (result < 0) {\n        if (vboxVirtualBox != NULL) {\n            vboxVirtualBox->vtbl->nsisupports.Release((nsISupports *)vboxVirtualBox);\n            vboxVirtualBox = NULL;\n        }\n\n        if (vboxSession != NULL) {\n            vboxSession->vtbl->nsisupports.Release((nsISupports *)vboxSession);\n            vboxSession = NULL;\n        }\n    }\n\n    vboxUtf16Free(wcsVirtualBoxIID);\n    vboxUtf16Free(wcsSessionIID);\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static IVirtualBox *vboxVirtualBox;",
            "static ISession *vboxSession;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic IVirtualBox *vboxVirtualBox;\nstatic ISession *vboxSession;\n\nstatic void\nvboxComInitialize_v2(const char *pszVirtualBoxIID, IVirtualBox **ppVirtualBox,\n                     const char *pszSessionIID, ISession **ppSession)\n{\n    int result = -1;\n    HRESULT hrc;\n    IID virtualBoxIID;\n    IID sessionIID;\n    char *mbsVirtualBoxIID = NULL;\n    char *mbsSessionIID = NULL;\n    PRUnichar *wcsVirtualBoxIID = NULL;\n    PRUnichar *wcsSessionIID = NULL;\n\n    *ppVirtualBox = NULL;\n    *ppSession = NULL;\n\n    CoInitialize(NULL);\n\n    mbsVirtualBoxIID = g_strdup_printf(\"{%s}\", pszVirtualBoxIID);\n    mbsSessionIID = g_strdup_printf(\"{%s}\", pszSessionIID)\n        goto cleanup;\n\n    if (vboxUtf8ToUtf16(mbsVirtualBoxIID, &wcsVirtualBoxIID) < 0 ||\n        vboxUtf8ToUtf16(mbsSessionIID, &wcsSessionIID) < 0) {\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsVirtualBoxIID, &virtualBoxIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsSessionIID, &sessionIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_VirtualBox, NULL, CLSCTX_LOCAL_SERVER,\n                           &virtualBoxIID, (void**)&vboxVirtualBox);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create VirtualBox instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_Session, NULL, CLSCTX_INPROC_SERVER,\n                           &sessionIID, (void**)&vboxSession);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create Session instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    *ppVirtualBox = vboxVirtualBox;\n    *ppSession = vboxSession;\n\n    result = 0;\n\n cleanup:\n    if (result < 0) {\n        if (vboxVirtualBox != NULL) {\n            vboxVirtualBox->vtbl->nsisupports.Release((nsISupports *)vboxVirtualBox);\n            vboxVirtualBox = NULL;\n        }\n\n        if (vboxSession != NULL) {\n            vboxSession->vtbl->nsisupports.Release((nsISupports *)vboxSession);\n            vboxSession = NULL;\n        }\n    }\n\n    vboxUtf16Free(wcsVirtualBoxIID);\n    vboxUtf16Free(wcsSessionIID);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define ISESSION_IID_STR_v2_2 \"12F4DCDB-12B2-4ec1-B7CD-DDD9F6C5BF4D\"\n#define IVIRTUALBOX_IID_STR_v2_2 \"779264f4-65ed-48ed-be39-518ca549e296\"\n\nstatic void\nvboxComInitialize_v1(IVirtualBox **ppVirtualBox, ISession **ppSession)\n{\n    vboxComInitialize_v2(IVIRTUALBOX_IID_STR_v2_2, ppVirtualBox,\n                         ISESSION_IID_STR_v2_2, ppSession);\n}"
  },
  {
    "function_name": "vboxComInitialize_v2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "505-586",
    "snippet": "static void\nvboxComInitialize_v2(const char *pszVirtualBoxIID, IVirtualBox **ppVirtualBox,\n                     const char *pszSessionIID, ISession **ppSession)\n{\n    int result = -1;\n    HRESULT hrc;\n    IID virtualBoxIID;\n    IID sessionIID;\n    char *mbsVirtualBoxIID = NULL;\n    char *mbsSessionIID = NULL;\n    PRUnichar *wcsVirtualBoxIID = NULL;\n    PRUnichar *wcsSessionIID = NULL;\n\n    *ppVirtualBox = NULL;\n    *ppSession = NULL;\n\n    CoInitialize(NULL);\n\n    mbsVirtualBoxIID = g_strdup_printf(\"{%s}\", pszVirtualBoxIID);\n    mbsSessionIID = g_strdup_printf(\"{%s}\", pszSessionIID)\n        goto cleanup;\n\n    if (vboxUtf8ToUtf16(mbsVirtualBoxIID, &wcsVirtualBoxIID) < 0 ||\n        vboxUtf8ToUtf16(mbsSessionIID, &wcsSessionIID) < 0) {\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsVirtualBoxIID, &virtualBoxIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsSessionIID, &sessionIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_VirtualBox, NULL, CLSCTX_LOCAL_SERVER,\n                           &virtualBoxIID, (void**)&vboxVirtualBox);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create VirtualBox instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_Session, NULL, CLSCTX_INPROC_SERVER,\n                           &sessionIID, (void**)&vboxSession);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create Session instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    *ppVirtualBox = vboxVirtualBox;\n    *ppSession = vboxSession;\n\n    result = 0;\n\n cleanup:\n    if (result < 0) {\n        if (vboxVirtualBox != NULL) {\n            vboxVirtualBox->vtbl->nsisupports.Release((nsISupports *)vboxVirtualBox);\n            vboxVirtualBox = NULL;\n        }\n\n        if (vboxSession != NULL) {\n            vboxSession->vtbl->nsisupports.Release((nsISupports *)vboxSession);\n            vboxSession = NULL;\n        }\n    }\n\n    vboxUtf16Free(wcsVirtualBoxIID);\n    vboxUtf16Free(wcsSessionIID);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static IVirtualBox *vboxVirtualBox;",
      "static ISession *vboxSession;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "vboxUtf16Free",
          "args": [
            "wcsSessionIID"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "vboxUtf16Free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "455-459",
          "snippet": "static void\nvboxUtf16Free(PRUnichar *pwszString)\n{\n    SysFreeString(pwszString);\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvboxUtf16Free(PRUnichar *pwszString)\n{\n    SysFreeString(pwszString);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vboxSession->vtbl->nsisupports.Release",
          "args": [
            "(nsISupports *)vboxSession"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vboxVirtualBox->vtbl->nsisupports.Release",
          "args": [
            "(nsISupports *)vboxVirtualBox"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not create Session instance, rc = 0x%08x\")",
            "(unsigned int)hrc"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not create Session instance, rc = 0x%08x\""
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "vboxEventQueue_StopAcceptingEvents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "293-297",
          "snippet": "static nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "FAILED",
          "args": [
            "hrc"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoCreateInstance",
          "args": [
            "&CLSID_Session",
            "NULL",
            "CLSCTX_INPROC_SERVER",
            "&sessionIID",
            "(void**)&vboxSession"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not create VirtualBox instance, rc = 0x%08x\")",
            "(unsigned int)hrc"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FAILED",
          "args": [
            "hrc"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CoCreateInstance",
          "args": [
            "&CLSID_VirtualBox",
            "NULL",
            "CLSCTX_LOCAL_SERVER",
            "&virtualBoxIID",
            "(void**)&vboxVirtualBox"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not parse IID from '%s', rc = 0x%08x\")",
            "pszVirtualBoxIID",
            "(unsigned int)hrc"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FAILED",
          "args": [
            "hrc"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IIDFromString",
          "args": [
            "wcsSessionIID",
            "&sessionIID"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not parse IID from '%s', rc = 0x%08x\")",
            "pszVirtualBoxIID",
            "(unsigned int)hrc"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FAILED",
          "args": [
            "hrc"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IIDFromString",
          "args": [
            "wcsVirtualBoxIID",
            "&virtualBoxIID"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vboxUtf8ToUtf16",
          "args": [
            "mbsSessionIID",
            "&wcsSessionIID"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "vboxUtf8ToUtf16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "483-497",
          "snippet": "static int\nvboxUtf8ToUtf16(const char *pszString, PRUnichar **ppwszString)\n{\n    int length = MultiByteToWideChar(CP_UTF8, 0, pszString, -1, NULL, 0);\n\n    if (length < 1)\n        return -1;\n\n    *ppwszString = SysAllocStringLen(NULL, length);\n\n    if (*ppwszString == NULL)\n        return -1;\n\n    return MultiByteToWideChar(CP_UTF8, 0, pszString, -1, *ppwszString, length);\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvboxUtf8ToUtf16(const char *pszString, PRUnichar **ppwszString)\n{\n    int length = MultiByteToWideChar(CP_UTF8, 0, pszString, -1, NULL, 0);\n\n    if (length < 1)\n        return -1;\n\n    *ppwszString = SysAllocStringLen(NULL, length);\n\n    if (*ppwszString == NULL)\n        return -1;\n\n    return MultiByteToWideChar(CP_UTF8, 0, pszString, -1, *ppwszString, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"{%s}\"",
            "pszSessionIID"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoInitialize",
          "args": [
            "NULL"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic IVirtualBox *vboxVirtualBox;\nstatic ISession *vboxSession;\n\nstatic void\nvboxComInitialize_v2(const char *pszVirtualBoxIID, IVirtualBox **ppVirtualBox,\n                     const char *pszSessionIID, ISession **ppSession)\n{\n    int result = -1;\n    HRESULT hrc;\n    IID virtualBoxIID;\n    IID sessionIID;\n    char *mbsVirtualBoxIID = NULL;\n    char *mbsSessionIID = NULL;\n    PRUnichar *wcsVirtualBoxIID = NULL;\n    PRUnichar *wcsSessionIID = NULL;\n\n    *ppVirtualBox = NULL;\n    *ppSession = NULL;\n\n    CoInitialize(NULL);\n\n    mbsVirtualBoxIID = g_strdup_printf(\"{%s}\", pszVirtualBoxIID);\n    mbsSessionIID = g_strdup_printf(\"{%s}\", pszSessionIID)\n        goto cleanup;\n\n    if (vboxUtf8ToUtf16(mbsVirtualBoxIID, &wcsVirtualBoxIID) < 0 ||\n        vboxUtf8ToUtf16(mbsSessionIID, &wcsSessionIID) < 0) {\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsVirtualBoxIID, &virtualBoxIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = IIDFromString(wcsSessionIID, &sessionIID);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not parse IID from '%s', rc = 0x%08x\"),\n                  pszVirtualBoxIID, (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_VirtualBox, NULL, CLSCTX_LOCAL_SERVER,\n                           &virtualBoxIID, (void**)&vboxVirtualBox);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create VirtualBox instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    hrc = CoCreateInstance(&CLSID_Session, NULL, CLSCTX_INPROC_SERVER,\n                           &sessionIID, (void**)&vboxSession);\n\n    if (FAILED(hrc)) {\n        VIR_ERROR(_(\"Could not create Session instance, rc = 0x%08x\"),\n                  (unsigned int)hrc);\n        goto cleanup;\n    }\n\n    *ppVirtualBox = vboxVirtualBox;\n    *ppSession = vboxSession;\n\n    result = 0;\n\n cleanup:\n    if (result < 0) {\n        if (vboxVirtualBox != NULL) {\n            vboxVirtualBox->vtbl->nsisupports.Release((nsISupports *)vboxVirtualBox);\n            vboxVirtualBox = NULL;\n        }\n\n        if (vboxSession != NULL) {\n            vboxSession->vtbl->nsisupports.Release((nsISupports *)vboxSession);\n            vboxSession = NULL;\n        }\n    }\n\n    vboxUtf16Free(wcsVirtualBoxIID);\n    vboxUtf16Free(wcsSessionIID);\n}"
  },
  {
    "function_name": "vboxGetEventQueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "499-503",
    "snippet": "static void\nvboxGetEventQueue(nsIEventQueue **eventQueue)\n{\n    *eventQueue = &vboxEventQueue;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static nsIEventQueue vboxEventQueue = {\n    &vboxEventQueueVtbl\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsIEventQueue vboxEventQueue = {\n    &vboxEventQueueVtbl\n};\n\nstatic void\nvboxGetEventQueue(nsIEventQueue **eventQueue)\n{\n    *eventQueue = &vboxEventQueue;\n}"
  },
  {
    "function_name": "vboxUtf8ToUtf16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "483-497",
    "snippet": "static int\nvboxUtf8ToUtf16(const char *pszString, PRUnichar **ppwszString)\n{\n    int length = MultiByteToWideChar(CP_UTF8, 0, pszString, -1, NULL, 0);\n\n    if (length < 1)\n        return -1;\n\n    *ppwszString = SysAllocStringLen(NULL, length);\n\n    if (*ppwszString == NULL)\n        return -1;\n\n    return MultiByteToWideChar(CP_UTF8, 0, pszString, -1, *ppwszString, length);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MultiByteToWideChar",
          "args": [
            "CP_UTF8",
            "0",
            "pszString",
            "-1",
            "*ppwszString",
            "length"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SysAllocStringLen",
          "args": [
            "NULL",
            "length"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MultiByteToWideChar",
          "args": [
            "CP_UTF8",
            "0",
            "pszString",
            "-1",
            "NULL",
            "0"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvboxUtf8ToUtf16(const char *pszString, PRUnichar **ppwszString)\n{\n    int length = MultiByteToWideChar(CP_UTF8, 0, pszString, -1, NULL, 0);\n\n    if (length < 1)\n        return -1;\n\n    *ppwszString = SysAllocStringLen(NULL, length);\n\n    if (*ppwszString == NULL)\n        return -1;\n\n    return MultiByteToWideChar(CP_UTF8, 0, pszString, -1, *ppwszString, length);\n}"
  },
  {
    "function_name": "vboxUtf16ToUtf8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "467-481",
    "snippet": "static int\nvboxUtf16ToUtf8(const PRUnichar *pwszString, char **ppszString)\n{\n    int length = WideCharToMultiByte(CP_UTF8, 0, pwszString, -1, NULL, 0,\n                                     NULL, NULL);\n\n    if (length < 1)\n        return -1;\n\n    if (VIR_ALLOC_N(*ppszString, length) < 0)\n        return -1;\n\n    return WideCharToMultiByte(CP_UTF8, 0, pwszString, -1, *ppszString,\n                               length, NULL, NULL);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WideCharToMultiByte",
          "args": [
            "CP_UTF8",
            "0",
            "pwszString",
            "-1",
            "*ppszString",
            "length",
            "NULL",
            "NULL"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*ppszString",
            "length"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WideCharToMultiByte",
          "args": [
            "CP_UTF8",
            "0",
            "pwszString",
            "-1",
            "NULL",
            "0",
            "NULL",
            "NULL"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvboxUtf16ToUtf8(const PRUnichar *pwszString, char **ppszString)\n{\n    int length = WideCharToMultiByte(CP_UTF8, 0, pwszString, -1, NULL, 0,\n                                     NULL, NULL);\n\n    if (length < 1)\n        return -1;\n\n    if (VIR_ALLOC_N(*ppszString, length) < 0)\n        return -1;\n\n    return WideCharToMultiByte(CP_UTF8, 0, pwszString, -1, *ppszString,\n                               length, NULL, NULL);\n}"
  },
  {
    "function_name": "vboxUtf8Free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "461-465",
    "snippet": "static void\nvboxUtf8Free(char *pszString)\n{\n    VIR_FREE(pszString);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pszString"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvboxUtf8Free(char *pszString)\n{\n    VIR_FREE(pszString);\n}"
  },
  {
    "function_name": "vboxUtf16Free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "455-459",
    "snippet": "static void\nvboxUtf16Free(PRUnichar *pwszString)\n{\n    SysFreeString(pwszString);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SysFreeString",
          "args": [
            "pwszString"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvboxUtf16Free(PRUnichar *pwszString)\n{\n    SysFreeString(pwszString);\n}"
  },
  {
    "function_name": "vboxComUnallocMem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "449-453",
    "snippet": "static void\nvboxComUnallocMem(void *pv)\n{\n    SysFreeString(pv);\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SysFreeString",
          "args": [
            "pv"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvboxComUnallocMem(void *pv)\n{\n    SysFreeString(pv);\n}"
  },
  {
    "function_name": "vboxGetVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "443-447",
    "snippet": "static unsigned int\nvboxGetVersion(void)\n{\n    return vboxVersion;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long vboxVersion;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic unsigned long vboxVersion;\n\nstatic unsigned int\nvboxGetVersion(void)\n{\n    return vboxVersion;\n}"
  },
  {
    "function_name": "vboxLookupVersionInRegistry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "390-441",
    "snippet": "static int\nvboxLookupVersionInRegistry(void)\n{\n    int result = -1;\n    const char *keyName = VBOX_REGKEY_ORACLE;\n    LONG status;\n    HKEY key;\n    char *value = NULL;\n\n    status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n    if (status != ERROR_SUCCESS) {\n        keyName = VBOX_REGKEY_SUN;\n        status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n        if (status != ERROR_SUCCESS) {\n            /* Both keys aren't there, or we cannot open them. In general this\n             * indicates that VirtualBox is not installed, so we just silently\n             * fail here making vboxRegister() register the dummy driver. */\n            return -1;\n        }\n    }\n\n    /* The registry key layout changed around version 4.0.8. Before the version\n     * number was in the Version key, now the Version key can contain %VER% and\n     * the actual version number is in the VersionExt key then. */\n    value = vboxLookupRegistryValue(key, keyName, \"Version\");\n\n    if (value == NULL)\n        goto cleanup;\n\n    if (STREQ(value, \"%VER%\")) {\n        VIR_FREE(value);\n        value = vboxLookupRegistryValue(key, keyName, \"VersionExt\");\n\n        if (value == NULL)\n            goto cleanup;\n    }\n\n    if (virParseVersionString(value, &vboxVersion, false) < 0) {\n        VIR_ERROR(_(\"Could not parse version number from '%s'\"), value);\n        goto cleanup;\n    }\n\n    result = 0;\n\n cleanup:\n    VIR_FREE(value);\n    RegCloseKey(key);\n\n    return result;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VBOX_REGKEY_SUN \"Software\\\\Sun\\\\xVM VirtualBox\"",
      "#define VBOX_REGKEY_ORACLE \"Software\\\\Oracle\\\\VirtualBox\""
    ],
    "globals_used": [
      "static unsigned long vboxVersion;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RegCloseKey",
          "args": [
            "key"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not parse version number from '%s'\")",
            "value"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not parse version number from '%s'\""
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "vboxEventQueue_StopAcceptingEvents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "293-297",
          "snippet": "static nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "value",
            "&vboxVersion",
            "false"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vboxLookupRegistryValue",
          "args": [
            "key",
            "keyName",
            "\"VersionExt\""
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "vboxLookupRegistryValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "343-388",
          "snippet": "static char *\nvboxLookupRegistryValue(HKEY key, const char *keyName, const char *valueName)\n{\n    LONG status;\n    DWORD type;\n    DWORD length;\n    char *value = NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, &type, NULL, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (type != REG_SZ) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' has unexpected type\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (length < 2) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' is too short\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    /* +1 for the null-terminator if it's missing */\n    if (VIR_ALLOC_N(value, length + 1) < 0)\n        return NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, NULL, (LPBYTE)value, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_FREE(value);\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (value[length - 1] != '\\0')\n        value[length] = '\\0';\n\n    return value;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvboxLookupRegistryValue(HKEY key, const char *keyName, const char *valueName)\n{\n    LONG status;\n    DWORD type;\n    DWORD length;\n    char *value = NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, &type, NULL, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (type != REG_SZ) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' has unexpected type\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (length < 2) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' is too short\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    /* +1 for the null-terminator if it's missing */\n    if (VIR_ALLOC_N(value, length + 1) < 0)\n        return NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, NULL, (LPBYTE)value, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_FREE(value);\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (value[length - 1] != '\\0')\n        value[length] = '\\0';\n\n    return value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "value",
            "\"%VER%\""
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegOpenKeyEx",
          "args": [
            "HKEY_LOCAL_MACHINE",
            "keyName",
            "0",
            "KEY_READ",
            "&key"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegOpenKeyEx",
          "args": [
            "HKEY_LOCAL_MACHINE",
            "keyName",
            "0",
            "KEY_READ",
            "&key"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\n#define VBOX_REGKEY_SUN \"Software\\\\Sun\\\\xVM VirtualBox\"\n#define VBOX_REGKEY_ORACLE \"Software\\\\Oracle\\\\VirtualBox\"\n\nstatic unsigned long vboxVersion;\n\nstatic int\nvboxLookupVersionInRegistry(void)\n{\n    int result = -1;\n    const char *keyName = VBOX_REGKEY_ORACLE;\n    LONG status;\n    HKEY key;\n    char *value = NULL;\n\n    status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n    if (status != ERROR_SUCCESS) {\n        keyName = VBOX_REGKEY_SUN;\n        status = RegOpenKeyEx(HKEY_LOCAL_MACHINE, keyName, 0, KEY_READ, &key);\n\n        if (status != ERROR_SUCCESS) {\n            /* Both keys aren't there, or we cannot open them. In general this\n             * indicates that VirtualBox is not installed, so we just silently\n             * fail here making vboxRegister() register the dummy driver. */\n            return -1;\n        }\n    }\n\n    /* The registry key layout changed around version 4.0.8. Before the version\n     * number was in the Version key, now the Version key can contain %VER% and\n     * the actual version number is in the VersionExt key then. */\n    value = vboxLookupRegistryValue(key, keyName, \"Version\");\n\n    if (value == NULL)\n        goto cleanup;\n\n    if (STREQ(value, \"%VER%\")) {\n        VIR_FREE(value);\n        value = vboxLookupRegistryValue(key, keyName, \"VersionExt\");\n\n        if (value == NULL)\n            goto cleanup;\n    }\n\n    if (virParseVersionString(value, &vboxVersion, false) < 0) {\n        VIR_ERROR(_(\"Could not parse version number from '%s'\"), value);\n        goto cleanup;\n    }\n\n    result = 0;\n\n cleanup:\n    VIR_FREE(value);\n    RegCloseKey(key);\n\n    return result;\n}"
  },
  {
    "function_name": "vboxLookupRegistryValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "343-388",
    "snippet": "static char *\nvboxLookupRegistryValue(HKEY key, const char *keyName, const char *valueName)\n{\n    LONG status;\n    DWORD type;\n    DWORD length;\n    char *value = NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, &type, NULL, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (type != REG_SZ) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' has unexpected type\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (length < 2) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' is too short\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    /* +1 for the null-terminator if it's missing */\n    if (VIR_ALLOC_N(value, length + 1) < 0)\n        return NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, NULL, (LPBYTE)value, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_FREE(value);\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (value[length - 1] != '\\0')\n        value[length] = '\\0';\n\n    return value;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not query registry value '%s\\\\%s'\")",
            "keyName",
            "valueName"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not query registry value '%s\\\\%s'\""
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "vboxEventQueue_StopAcceptingEvents",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
          "lines": "293-297",
          "snippet": "static nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
          "includes": [
            "#include \"vbox_MSCOMGlue.h\"",
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "value"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegQueryValueEx",
          "args": [
            "key",
            "valueName",
            "NULL",
            "NULL",
            "(LPBYTE)value",
            "&length"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "value",
            "length + 1"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Registry value '%s\\\\%s' is too short\")",
            "keyName",
            "valueName"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Registry value '%s\\\\%s' has unexpected type\")",
            "keyName",
            "valueName"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Could not query registry value '%s\\\\%s'\")",
            "keyName",
            "valueName"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegQueryValueEx",
          "args": [
            "key",
            "valueName",
            "NULL",
            "&type",
            "NULL",
            "&length"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvboxLookupRegistryValue(HKEY key, const char *keyName, const char *valueName)\n{\n    LONG status;\n    DWORD type;\n    DWORD length;\n    char *value = NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, &type, NULL, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (type != REG_SZ) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' has unexpected type\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (length < 2) {\n        VIR_ERROR(_(\"Registry value '%s\\\\%s' is too short\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    /* +1 for the null-terminator if it's missing */\n    if (VIR_ALLOC_N(value, length + 1) < 0)\n        return NULL;\n\n    status = RegQueryValueEx(key, valueName, NULL, NULL, (LPBYTE)value, &length);\n\n    if (status != ERROR_SUCCESS) {\n        VIR_FREE(value);\n        VIR_ERROR(_(\"Could not query registry value '%s\\\\%s'\"),\n                  keyName, valueName);\n        return NULL;\n    }\n\n    if (value[length - 1] != '\\0')\n        value[length] = '\\0';\n\n    return value;\n}"
  },
  {
    "function_name": "vboxEventQueue_StopAcceptingEvents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "293-297",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_StopAcceptingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_IsQueueNative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "286-291",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_IsQueueNative(nsIEventQueue *pThis G_GNUC_UNUSED,\n                             PRBool *_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_IsQueueNative(nsIEventQueue *pThis G_GNUC_UNUSED,\n                             PRBool *_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_GetPLEventQueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "279-284",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_GetPLEventQueue(nsIEventQueue *pThis G_GNUC_UNUSED,\n                               PLEventQueue **_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_GetPLEventQueue(nsIEventQueue *pThis G_GNUC_UNUSED,\n                               PLEventQueue **_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_RevokeEvents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "272-277",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_RevokeEvents(nsIEventQueue *pThis G_GNUC_UNUSED,\n                            void *owner G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_RevokeEvents(nsIEventQueue *pThis G_GNUC_UNUSED,\n                            void *owner G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_ExitMonitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "266-270",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_ExitMonitor(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_ExitMonitor(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_EnterMonitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "260-264",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_EnterMonitor(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_EnterMonitor(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_InitFromPLQueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "253-258",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_InitFromPLQueue(nsIEventQueue *pThis G_GNUC_UNUSED,\n                               PLEventQueue *aQueue G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_InitFromPLQueue(nsIEventQueue *pThis G_GNUC_UNUSED,\n                               PLEventQueue *aQueue G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_InitFromPRThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "245-251",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_InitFromPRThread(nsIEventQueue *pThis G_GNUC_UNUSED,\n                                PRThread *thread G_GNUC_UNUSED,\n                                PRBool aNative G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_InitFromPRThread(nsIEventQueue *pThis G_GNUC_UNUSED,\n                                PRThread *thread G_GNUC_UNUSED,\n                                PRBool aNative G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_Init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "238-243",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_Init(nsIEventQueue *pThis G_GNUC_UNUSED,\n                    PRBool aNative G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_Init(nsIEventQueue *pThis G_GNUC_UNUSED,\n                    PRBool aNative G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_GetEventQueueSelectFD",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "232-236",
    "snippet": "static PRInt32 __stdcall\nvboxEventQueue_GetEventQueueSelectFD(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return -1;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic PRInt32 __stdcall\nvboxEventQueue_GetEventQueueSelectFD(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return -1;\n}"
  },
  {
    "function_name": "vboxEventQueue_WaitForEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "225-230",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_WaitForEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                            PLEvent **_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_WaitForEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                            PLEvent **_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_HandleEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "218-223",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_HandleEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                           PLEvent *aEvent G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_HandleEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                           PLEvent *aEvent G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_GetEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "211-216",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_GetEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                        PLEvent **_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_GetEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                        PLEvent **_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_EventAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "204-209",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_EventAvailable(nsIEventQueue *pThis G_GNUC_UNUSED,\n                              PRBool *aResult G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_EventAvailable(nsIEventQueue *pThis G_GNUC_UNUSED,\n                              PRBool *aResult G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_EventLoop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "198-202",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_EventLoop(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_EventLoop(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_ProcessPendingEvents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "192-196",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_ProcessPendingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_ProcessPendingEvents(nsIEventQueue *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_PendingEvents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "185-190",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_PendingEvents(nsIEventQueue *pThis G_GNUC_UNUSED,\n                             PRBool *_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_PendingEvents(nsIEventQueue *pThis G_GNUC_UNUSED,\n                             PRBool *_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_PostSynchronousEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "177-183",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_PostSynchronousEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                                    PLEvent *aEvent G_GNUC_UNUSED,\n                                    void **aResult G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_PostSynchronousEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                                    PLEvent *aEvent G_GNUC_UNUSED,\n                                    void **aResult G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventQueue_InitEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "167-175",
    "snippet": "static nsresult __stdcall\nvboxEventQueue_InitEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                         PLEvent *aEvent G_GNUC_UNUSED,\n                         void *owner G_GNUC_UNUSED,\n                         PLHandleEventProc handler G_GNUC_UNUSED,\n                         PLDestroyEventProc destructor G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventQueue_InitEvent(nsIEventQueue *pThis G_GNUC_UNUSED,\n                         PLEvent *aEvent G_GNUC_UNUSED,\n                         void *owner G_GNUC_UNUSED,\n                         PLHandleEventProc handler G_GNUC_UNUSED,\n                         PLDestroyEventProc destructor G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventTarget_IsOnCurrentThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "154-159",
    "snippet": "static nsresult __stdcall\nvboxEventTarget_IsOnCurrentThread(nsIEventTarget *pThis G_GNUC_UNUSED,\n                                  PRBool *_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventTarget_IsOnCurrentThread(nsIEventTarget *pThis G_GNUC_UNUSED,\n                                  PRBool *_retval G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxEventTarget_PostEvent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "147-152",
    "snippet": "static nsresult __stdcall\nvboxEventTarget_PostEvent(nsIEventTarget *pThis G_GNUC_UNUSED,\n                          PLEvent *aEvent G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxEventTarget_PostEvent(nsIEventTarget *pThis G_GNUC_UNUSED,\n                          PLEvent *aEvent G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_Invoke",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "135-139",
    "snippet": "static nsresult __stdcall\nvboxSupports_Invoke(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_Invoke(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_GetIDsOfNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "129-133",
    "snippet": "static nsresult __stdcall\nvboxSupports_GetIDsOfNames(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_GetIDsOfNames(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_GetTypeInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "123-127",
    "snippet": "static nsresult __stdcall\nvboxSupports_GetTypeInfo(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_GetTypeInfo(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_GetTypeInfoCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "117-121",
    "snippet": "static nsresult __stdcall\nvboxSupports_GetTypeInfoCount(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_GetTypeInfoCount(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_Release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "111-115",
    "snippet": "static nsresult __stdcall\nvboxSupports_Release(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_Release(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_AddRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "105-109",
    "snippet": "static nsresult __stdcall\nvboxSupports_AddRef(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_AddRef(nsISupports *pThis G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  },
  {
    "function_name": "vboxSupports_QueryInterface",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/vbox/vbox_MSCOMGlue.c",
    "lines": "97-103",
    "snippet": "static nsresult __stdcall\nvboxSupports_QueryInterface(nsISupports *pThis G_GNUC_UNUSED,\n                            const nsID *iid G_GNUC_UNUSED,\n                            void **resultp G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}",
    "includes": [
      "#include \"vbox_MSCOMGlue.h\"",
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"viralloc.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"vbox_MSCOMGlue.h\"\n#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic nsresult __stdcall\nvboxSupports_QueryInterface(nsISupports *pThis G_GNUC_UNUSED,\n                            const nsID *iid G_GNUC_UNUSED,\n                            void **resultp G_GNUC_UNUSED)\n{\n    return NS_ERROR_NOT_IMPLEMENTED;\n}"
  }
]