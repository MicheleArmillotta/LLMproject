[
  {
    "function_name": "openvzXMLOption",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "1130-1135",
    "snippet": "virDomainXMLOptionPtr openvzXMLOption(struct openvz_driver *driver)\n{\n    openvzDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&openvzDomainDefParserConfig,\n                                 NULL, NULL, NULL, NULL);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "virDomainDefParserConfig openvzDomainDefParserConfig = {\n    .domainPostParseCallback = openvzDomainDefPostParse,\n    .devicesPostParseCallback = openvzDomainDeviceDefPostParse,\n    .features = VIR_DOMAIN_DEF_FEATURE_NAME_SLASH,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainXMLOptionNew",
          "args": [
            "&openvzDomainDefParserConfig",
            "NULL",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 1133
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainXMLOptionNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1415-1458",
          "snippet": "virDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainXMLOptionClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virClassPtr virDomainXMLOptionClass;\n\nvirDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirDomainDefParserConfig openvzDomainDefParserConfig = {\n    .domainPostParseCallback = openvzDomainDefPostParse,\n    .devicesPostParseCallback = openvzDomainDeviceDefPostParse,\n    .features = VIR_DOMAIN_DEF_FEATURE_NAME_SLASH,\n};\n\nvirDomainXMLOptionPtr openvzXMLOption(struct openvz_driver *driver)\n{\n    openvzDomainDefParserConfig.priv = driver;\n    return virDomainXMLOptionNew(&openvzDomainDefParserConfig,\n                                 NULL, NULL, NULL, NULL);\n}"
  },
  {
    "function_name": "openvzDomainDeviceDefPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "1098-1121",
    "snippet": "static int\nopenvzDomainDeviceDefPostParse(virDomainDeviceDefPtr dev,\n                               const virDomainDef *def G_GNUC_UNUSED,\n                               unsigned int parseFlags G_GNUC_UNUSED,\n                               void *opaque G_GNUC_UNUSED,\n                               void *parseOpaque G_GNUC_UNUSED)\n{\n    if (dev->type == VIR_DOMAIN_DEVICE_CHR &&\n        dev->data.chr->deviceType == VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE &&\n        dev->data.chr->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE)\n        dev->data.chr->targetType = VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_OPENVZ;\n\n    /* forbid capabilities mode hostdev in this kind of hypervisor */\n    if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV &&\n        dev->data.hostdev->mode == VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"hostdev mode 'capabilities' is not \"\n                         \"supported in %s\"),\n                       virDomainVirtTypeToString(def->virtType));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"hostdev mode 'capabilities' is not \"\n                         \"supported in %s\")",
            "virDomainVirtTypeToString(def->virtType)"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainVirtTypeToString",
          "args": [
            "def->virtType"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"hostdev mode 'capabilities' is not \"\n                         \"supported in %s\""
          ],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzDomainDeviceDefPostParse(virDomainDeviceDefPtr dev,\n                               const virDomainDef *def G_GNUC_UNUSED,\n                               unsigned int parseFlags G_GNUC_UNUSED,\n                               void *opaque G_GNUC_UNUSED,\n                               void *parseOpaque G_GNUC_UNUSED)\n{\n    if (dev->type == VIR_DOMAIN_DEVICE_CHR &&\n        dev->data.chr->deviceType == VIR_DOMAIN_CHR_DEVICE_TYPE_CONSOLE &&\n        dev->data.chr->targetType == VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_NONE)\n        dev->data.chr->targetType = VIR_DOMAIN_CHR_CONSOLE_TARGET_TYPE_OPENVZ;\n\n    /* forbid capabilities mode hostdev in this kind of hypervisor */\n    if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV &&\n        dev->data.hostdev->mode == VIR_DOMAIN_HOSTDEV_MODE_CAPABILITIES) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                       _(\"hostdev mode 'capabilities' is not \"\n                         \"supported in %s\"),\n                       virDomainVirtTypeToString(def->virtType));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzDomainDefPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "1078-1095",
    "snippet": "static int\nopenvzDomainDefPostParse(virDomainDefPtr def,\n                         unsigned int parseFlags G_GNUC_UNUSED,\n                         void *opaque,\n                         void *parseOpaque G_GNUC_UNUSED)\n{\n    struct openvz_driver *driver = opaque;\n    if (!virCapabilitiesDomainSupported(driver->caps, def->os.type,\n                                        def->os.arch,\n                                        def->virtType))\n        return -1;\n\n    /* fill the init path */\n    if (def->os.type == VIR_DOMAIN_OSTYPE_EXE && !def->os.init)\n        def->os.init = g_strdup(\"/sbin/init\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"/sbin/init\""
          ],
          "line": 1092
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesDomainSupported",
          "args": [
            "driver->caps",
            "def->os.type",
            "def->os.arch",
            "def->virtType"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesDomainSupported",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "787-801",
          "snippet": "bool\nvirCapabilitiesDomainSupported(virCapsPtr caps,\n                               int ostype,\n                               virArch arch,\n                               int virttype)\n{\n    g_autofree virCapsDomainDataPtr capsdata = NULL;\n\n    capsdata = virCapabilitiesDomainDataLookup(caps, ostype,\n                                               arch,\n                                               virttype,\n                                               NULL, NULL);\n\n    return capsdata != NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirCapabilitiesDomainSupported(virCapsPtr caps,\n                               int ostype,\n                               virArch arch,\n                               int virttype)\n{\n    g_autofree virCapsDomainDataPtr capsdata = NULL;\n\n    capsdata = virCapabilitiesDomainDataLookup(caps, ostype,\n                                               arch,\n                                               virttype,\n                                               NULL, NULL);\n\n    return capsdata != NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzDomainDefPostParse(virDomainDefPtr def,\n                         unsigned int parseFlags G_GNUC_UNUSED,\n                         void *opaque,\n                         void *parseOpaque G_GNUC_UNUSED)\n{\n    struct openvz_driver *driver = opaque;\n    if (!virCapabilitiesDomainSupported(driver->caps, def->os.type,\n                                        def->os.arch,\n                                        def->virtType))\n        return -1;\n\n    /* fill the init path */\n    if (def->os.type == VIR_DOMAIN_OSTYPE_EXE && !def->os.init)\n        def->os.init = g_strdup(\"/sbin/init\");\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzGetVEID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "1049-1075",
    "snippet": "int openvzGetVEID(const char *name)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *temp;\n    int veid;\n    bool ok;\n\n    cmd = virCommandNewArgList(VZLIST, name, \"-ovpsid\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0) {\n        virCommandFree(cmd);\n        VIR_FREE(outbuf);\n        return -1;\n    }\n\n    virCommandFree(cmd);\n    ok = virStrToLong_i(outbuf, &temp, 10, &veid) == 0 && *temp == '\\n';\n    VIR_FREE(outbuf);\n\n    if (ok && veid >= 0)\n        return veid;\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Failed to parse vzlist output\"));\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to parse vzlist output\")"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse vzlist output\""
          ],
          "line": 1073
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "outbuf",
            "&temp",
            "10",
            "&veid"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 1059
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&outbuf"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZLIST",
            "name",
            "\"-ovpsid\"",
            "\"-H\"",
            "NULL"
          ],
          "line": 1057
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint openvzGetVEID(const char *name)\n{\n    virCommandPtr cmd;\n    char *outbuf;\n    char *temp;\n    int veid;\n    bool ok;\n\n    cmd = virCommandNewArgList(VZLIST, name, \"-ovpsid\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0) {\n        virCommandFree(cmd);\n        VIR_FREE(outbuf);\n        return -1;\n    }\n\n    virCommandFree(cmd);\n    ok = virStrToLong_i(outbuf, &temp, 10, &veid) == 0 && *temp == '\\n';\n    VIR_FREE(outbuf);\n\n    if (ok && veid >= 0)\n        return veid;\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Failed to parse vzlist output\"));\n    return -1;\n}"
  },
  {
    "function_name": "openvzAssignUUIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "1011-1041",
    "snippet": "static int openvzAssignUUIDs(void)\n{\n    DIR *dp;\n    struct dirent *dent;\n    char *conf_dir;\n    int vpsid;\n    char *ext;\n    int ret = 0;\n\n    conf_dir = openvzLocateConfDir();\n    if (conf_dir == NULL)\n        return -1;\n\n    if (virDirOpenQuiet(&dp, conf_dir) < 0) {\n        VIR_FREE(conf_dir);\n        return 0;\n    }\n\n    while ((ret = virDirRead(dp, &dent, conf_dir)) > 0) {\n        if (virStrToLong_i(dent->d_name, &ext, 10, &vpsid) < 0 ||\n            *ext++ != '.' ||\n            STRNEQ(ext, \"conf\"))\n            continue;\n        if (vpsid > 0) /* '0.conf' belongs to the host, ignore it */\n            openvzSetUUID(vpsid);\n    }\n\n    VIR_DIR_CLOSE(dp);\n    VIR_FREE(conf_dir);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *openvzLocateConfDir(void);",
      "static int openvzAssignUUIDs(void);",
      "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_dir"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dp"
          ],
          "line": 1038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzSetUUID",
          "args": [
            "vpsid"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "990-1002",
          "snippet": "static int\nopenvzSetUUID(int vpsid)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n\n    if (virUUIDGenerate(uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to generate UUID\"));\n        return -1;\n    }\n\n    return openvzSetDefinedUUID(vpsid, uuid);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzSetUUID(int vpsid)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n\n    if (virUUIDGenerate(uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to generate UUID\"));\n        return -1;\n    }\n\n    return openvzSetDefinedUUID(vpsid, uuid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "ext",
            "\"conf\""
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "dent->d_name",
            "&ext",
            "10",
            "&vpsid"
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dp",
            "&dent",
            "conf_dir"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_dir"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirOpenQuiet",
          "args": [
            "&dp",
            "conf_dir"
          ],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfDir",
          "args": [],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "858-872",
          "snippet": "static char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\n\nstatic char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzAssignUUIDs(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int openvzAssignUUIDs(void)\n{\n    DIR *dp;\n    struct dirent *dent;\n    char *conf_dir;\n    int vpsid;\n    char *ext;\n    int ret = 0;\n\n    conf_dir = openvzLocateConfDir();\n    if (conf_dir == NULL)\n        return -1;\n\n    if (virDirOpenQuiet(&dp, conf_dir) < 0) {\n        VIR_FREE(conf_dir);\n        return 0;\n    }\n\n    while ((ret = virDirRead(dp, &dent, conf_dir)) > 0) {\n        if (virStrToLong_i(dent->d_name, &ext, 10, &vpsid) < 0 ||\n            *ext++ != '.' ||\n            STRNEQ(ext, \"conf\"))\n            continue;\n        if (vpsid > 0) /* '0.conf' belongs to the host, ignore it */\n            openvzSetUUID(vpsid);\n    }\n\n    VIR_DIR_CLOSE(dp);\n    VIR_FREE(conf_dir);\n    return ret;\n}"
  },
  {
    "function_name": "openvzSetUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "990-1002",
    "snippet": "static int\nopenvzSetUUID(int vpsid)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n\n    if (virUUIDGenerate(uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to generate UUID\"));\n        return -1;\n    }\n\n    return openvzSetDefinedUUID(vpsid, uuid);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "openvzSetDefinedUUID",
          "args": [
            "vpsid",
            "uuid"
          ],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "openvzSetDefinedUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "952-988",
          "snippet": "int\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to generate UUID\")"
          ],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to generate UUID\""
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDGenerate",
          "args": [
            "uuid"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDGenerate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "50-79",
          "snippet": "int\nvirUUIDGenerate(unsigned char *uuid)\n{\n    if (uuid == NULL)\n        return -1;\n\n    if (virRandomBytes(uuid, VIR_UUID_BUFLEN) < 0)\n        return -1;\n\n    /*\n     * Make UUID RFC 4122 compliant. Following form will be used:\n     *\n     * xxxxxxxx-xxxx-Axxx-Bxxx-xxxxxxxxxxxx\n     *\n     * where\n     * A is version defined in 4.1.3 of RFC\n     *  Msb0  Msb1  Msb2  Msb3   Version  Description\n     *   0     1     0     0        4     The randomly or pseudo-\n     *                                    randomly generated version\n     *                                    specified in this document.\n     *\n     * B is variant defined in 4.1.1 of RFC\n     *  Msb0  Msb1  Msb2  Description\n     *   1     0     x    The variant specified in this document.\n     */\n    uuid[6] = (uuid[6] & 0x0F) | (4 << 4);\n    uuid[8] = (uuid[8] & 0x3F) | (2 << 6);\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDGenerate(unsigned char *uuid)\n{\n    if (uuid == NULL)\n        return -1;\n\n    if (virRandomBytes(uuid, VIR_UUID_BUFLEN) < 0)\n        return -1;\n\n    /*\n     * Make UUID RFC 4122 compliant. Following form will be used:\n     *\n     * xxxxxxxx-xxxx-Axxx-Bxxx-xxxxxxxxxxxx\n     *\n     * where\n     * A is version defined in 4.1.3 of RFC\n     *  Msb0  Msb1  Msb2  Msb3   Version  Description\n     *   0     1     0     0        4     The randomly or pseudo-\n     *                                    randomly generated version\n     *                                    specified in this document.\n     *\n     * B is variant defined in 4.1.1 of RFC\n     *  Msb0  Msb1  Msb2  Description\n     *   1     0     x    The variant specified in this document.\n     */\n    uuid[6] = (uuid[6] & 0x0F) | (4 << 4);\n    uuid[8] = (uuid[8] & 0x3F) | (2 << 6);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzSetUUID(int vpsid)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n\n    if (virUUIDGenerate(uuid) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to generate UUID\"));\n        return -1;\n    }\n\n    return openvzSetDefinedUUID(vpsid, uuid);\n}"
  },
  {
    "function_name": "openvzSetDefinedUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "952-988",
    "snippet": "int\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_file"
          ],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fp",
            "\"\\n#UUID: %s\\n\"",
            "uuidstr"
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "conf_file",
            "\"a\""
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzGetVPSUUID",
          "args": [
            "vpsid",
            "uuidstr",
            "sizeof(uuidstr)"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVPSUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "899-947",
          "snippet": "static int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);",
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nstatic int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfFile",
          "args": [
            "vpsid",
            "&conf_file",
            "\"conf\""
          ],
          "line": 963
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfFileDefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "842-856",
          "snippet": "static int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzSetDefinedUUID(int vpsid, unsigned char *uuid)\n{\n    char *conf_file;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    FILE *fp = NULL;\n    int ret = -1;\n\n    if (uuid == NULL)\n        return -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    if (openvzGetVPSUUID(vpsid, uuidstr, sizeof(uuidstr)))\n        goto cleanup;\n\n    if (uuidstr[0] == 0) {\n        fp = fopen(conf_file, \"a\"); /* append */\n        if (fp == NULL)\n            goto cleanup;\n\n        virUUIDFormat(uuid, uuidstr);\n\n        /* Record failure if fprintf or VIR_FCLOSE fails,\n           and be careful always to close the stream.  */\n        if ((fprintf(fp, \"\\n#UUID: %s\\n\", uuidstr) < 0) ||\n            (VIR_FCLOSE(fp) == EOF))\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n    return ret;\n}"
  },
  {
    "function_name": "openvzGetVPSUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "899-947",
    "snippet": "static int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);",
      "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_file"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid uuid %s\")",
            "uuidbuf"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid uuid %s\""
          ],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrcpy",
          "args": [
            "uuidstr",
            "uuidbuf",
            "len"
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "virStrcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "780-784",
          "snippet": "int\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "iden",
            "\"#UUID:\""
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "\"\\n\"",
            "&saveptr"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "line",
            "\" \"",
            "&saveptr"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feof",
          "args": [
            "fp"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&line_size",
            "fp"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "conf_file",
            "\"r\""
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzLocateConfFile",
          "args": [
            "vpsid",
            "&conf_file",
            "\"conf\""
          ],
          "line": 911
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfFileDefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "842-856",
          "snippet": "static int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nstatic int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}"
  },
  {
    "function_name": "openvz_readline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "875-897",
    "snippet": "int\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "&c",
            "1"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "openvz_readline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "875-897",
          "snippet": "int\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nopenvz_readline(int fd, char *ptr, int maxlen)\n{\n    int n, rc;\n    char c;\n\n    for (n = 1; n < maxlen; n++) {\n        if ((rc = read(fd, &c, 1)) == 1) {\n            *ptr++ = c;\n            if (c == '\\n')\n                break;\n        } else if (rc == 0) {\n            if (n == 1)\n                return 0; /* EOF condition */\n            else\n                break;\n        }\n        else\n            return -1; /* error */\n    }\n    *ptr = 0;\n    return n;\n}"
  },
  {
    "function_name": "openvzLocateConfDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "858-872",
    "snippet": "static char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *openvzLocateConfDir(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "conf_dir_list[i]"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "conf_dir_list[i]"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\n\nstatic char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "openvzLocateConfFileDefault",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "842-856",
    "snippet": "static int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *openvzLocateConfDir(void);",
      "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "confdir"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%d.%s\"",
            "confdir",
            "vpsid",
            "ext ? ext : \"conf\""
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfDir",
          "args": [],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "858-872",
          "snippet": "static char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\n\nstatic char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}"
  },
  {
    "function_name": "openvzCopyDefaultConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "805-837",
    "snippet": "int\nopenvzCopyDefaultConfig(int vpsid)\n{\n    char *confdir = NULL;\n    char *default_conf_file = NULL;\n    char *configfile_value = NULL;\n    char *conf_file = NULL;\n    int ret = -1;\n\n    if (openvzReadConfigParam(VZ_CONF_FILE, \"CONFIGFILE\", &configfile_value) < 0)\n        goto cleanup;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        goto cleanup;\n\n    default_conf_file = g_strdup_printf(\"%s/ve-%s.conf-sample\", confdir,\n                                        configfile_value);\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        goto cleanup;\n\n    if (openvz_copyfile(default_conf_file, conf_file)<0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(confdir);\n    VIR_FREE(default_conf_file);\n    VIR_FREE(configfile_value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char *openvzLocateConfDir(void);",
      "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_file"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "configfile_value"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "default_conf_file"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "confdir"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvz_copyfile",
          "args": [
            "default_conf_file",
            "conf_file"
          ],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "openvz_copyfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "757-798",
          "snippet": "static int\nopenvz_copyfile(char* from_path, char* to_path)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int copy_fd;\n    int bytes_read;\n\n    fp = fopen(from_path, \"r\");\n    if (fp == NULL)\n        return -1;\n    copy_fd = open(to_path, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (copy_fd == -1) {\n        VIR_FORCE_FCLOSE(fp);\n        return -1;\n    }\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        bytes_read = strlen(line);\n        if (safewrite(copy_fd, line, bytes_read) != bytes_read)\n            goto error;\n    }\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(copy_fd) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(copy_fd);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvz_copyfile(char* from_path, char* to_path)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int copy_fd;\n    int bytes_read;\n\n    fp = fopen(from_path, \"r\");\n    if (fp == NULL)\n        return -1;\n    copy_fd = open(to_path, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (copy_fd == -1) {\n        VIR_FORCE_FCLOSE(fp);\n        return -1;\n    }\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        bytes_read = strlen(line);\n        if (safewrite(copy_fd, line, bytes_read) != bytes_read)\n            goto error;\n    }\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(copy_fd) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(copy_fd);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfFile",
          "args": [
            "vpsid",
            "&conf_file",
            "\"conf\""
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfFileDefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "842-856",
          "snippet": "static int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/ve-%s.conf-sample\"",
            "confdir",
            "configfile_value"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfDir",
          "args": [],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "858-872",
          "snippet": "static char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\n\nstatic char *\nopenvzLocateConfDir(void)\n{\n    const char *conf_dir_list[] = {\"/etc/vz/conf\", \"/usr/local/etc/conf\", NULL};\n    size_t i = 0;\n\n    while (conf_dir_list[i]) {\n        if (virFileExists(conf_dir_list[i]))\n            return g_strdup(conf_dir_list[i]);\n\n        i++;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadConfigParam",
          "args": [
            "VZ_CONF_FILE",
            "\"CONFIGFILE\"",
            "&configfile_value"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "693-730",
          "snippet": "int\nopenvzReadConfigParam(const char *conf_file, const char *param, char **value)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int err = 0;\n    char *sf, *token, *saveptr = NULL;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        return -1;\n\n    VIR_FREE(*value);\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (!(sf = STRSKIP(line, param)))\n            continue;\n\n        if (*sf++ != '=')\n            continue;\n\n        saveptr = NULL;\n        if ((token = strtok_r(sf, \"\\\"\\t\\n\", &saveptr)) != NULL) {\n            VIR_FREE(*value);\n            *value = g_strdup(token);\n            /* keep going - last entry wins */\n        }\n    }\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n\n    return err ? -1 : *value ? 1 : 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nopenvzReadConfigParam(const char *conf_file, const char *param, char **value)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int err = 0;\n    char *sf, *token, *saveptr = NULL;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        return -1;\n\n    VIR_FREE(*value);\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (!(sf = STRSKIP(line, param)))\n            continue;\n\n        if (*sf++ != '=')\n            continue;\n\n        saveptr = NULL;\n        if ((token = strtok_r(sf, \"\\\"\\t\\n\", &saveptr)) != NULL) {\n            VIR_FREE(*value);\n            *value = g_strdup(token);\n            /* keep going - last entry wins */\n        }\n    }\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n\n    return err ? -1 : *value ? 1 : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzCopyDefaultConfig(int vpsid)\n{\n    char *confdir = NULL;\n    char *default_conf_file = NULL;\n    char *configfile_value = NULL;\n    char *conf_file = NULL;\n    int ret = -1;\n\n    if (openvzReadConfigParam(VZ_CONF_FILE, \"CONFIGFILE\", &configfile_value) < 0)\n        goto cleanup;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        goto cleanup;\n\n    default_conf_file = g_strdup_printf(\"%s/ve-%s.conf-sample\", confdir,\n                                        configfile_value);\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        goto cleanup;\n\n    if (openvz_copyfile(default_conf_file, conf_file)<0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(confdir);\n    VIR_FREE(default_conf_file);\n    VIR_FREE(configfile_value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
  },
  {
    "function_name": "openvz_copyfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "757-798",
    "snippet": "static int\nopenvz_copyfile(char* from_path, char* to_path)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int copy_fd;\n    int bytes_read;\n\n    fp = fopen(from_path, \"r\");\n    if (fp == NULL)\n        return -1;\n    copy_fd = open(to_path, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (copy_fd == -1) {\n        VIR_FORCE_FCLOSE(fp);\n        return -1;\n    }\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        bytes_read = strlen(line);\n        if (safewrite(copy_fd, line, bytes_read) != bytes_read)\n            goto error;\n    }\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(copy_fd) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(copy_fd);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "copy_fd"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "copy_fd"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "copy_fd",
            "line",
            "bytes_read"
          ],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&line_size",
            "fp"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "to_path",
            "O_WRONLY | O_CREAT | O_TRUNC",
            "0644"
          ],
          "line": 769
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVPSUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "899-947",
          "snippet": "static int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);",
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nstatic int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "from_path",
            "\"r\""
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvz_copyfile(char* from_path, char* to_path)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int copy_fd;\n    int bytes_read;\n\n    fp = fopen(from_path, \"r\");\n    if (fp == NULL)\n        return -1;\n    copy_fd = open(to_path, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (copy_fd == -1) {\n        VIR_FORCE_FCLOSE(fp);\n        return -1;\n    }\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        bytes_read = strlen(line);\n        if (safewrite(copy_fd, line, bytes_read) != bytes_read)\n            goto error;\n    }\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(copy_fd) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(copy_fd);\n    return -1;\n}"
  },
  {
    "function_name": "openvzReadVPSConfigParam",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "743-755",
    "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_file"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzReadConfigParam",
          "args": [
            "conf_file",
            "param",
            "value"
          ],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "693-730",
          "snippet": "int\nopenvzReadConfigParam(const char *conf_file, const char *param, char **value)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int err = 0;\n    char *sf, *token, *saveptr = NULL;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        return -1;\n\n    VIR_FREE(*value);\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (!(sf = STRSKIP(line, param)))\n            continue;\n\n        if (*sf++ != '=')\n            continue;\n\n        saveptr = NULL;\n        if ((token = strtok_r(sf, \"\\\"\\t\\n\", &saveptr)) != NULL) {\n            VIR_FREE(*value);\n            *value = g_strdup(token);\n            /* keep going - last entry wins */\n        }\n    }\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n\n    return err ? -1 : *value ? 1 : 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nopenvzReadConfigParam(const char *conf_file, const char *param, char **value)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int err = 0;\n    char *sf, *token, *saveptr = NULL;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        return -1;\n\n    VIR_FREE(*value);\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (!(sf = STRSKIP(line, param)))\n            continue;\n\n        if (*sf++ != '=')\n            continue;\n\n        saveptr = NULL;\n        if ((token = strtok_r(sf, \"\\\"\\t\\n\", &saveptr)) != NULL) {\n            VIR_FREE(*value);\n            *value = g_strdup(token);\n            /* keep going - last entry wins */\n        }\n    }\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n\n    return err ? -1 : *value ? 1 : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfFile",
          "args": [
            "vpsid",
            "&conf_file",
            "\"conf\""
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfFileDefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "842-856",
          "snippet": "static int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
  },
  {
    "function_name": "openvzReadConfigParam",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "693-730",
    "snippet": "int\nopenvzReadConfigParam(const char *conf_file, const char *param, char **value)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int err = 0;\n    char *sf, *token, *saveptr = NULL;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        return -1;\n\n    VIR_FREE(*value);\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (!(sf = STRSKIP(line, param)))\n            continue;\n\n        if (*sf++ != '=')\n            continue;\n\n        saveptr = NULL;\n        if ((token = strtok_r(sf, \"\\\"\\t\\n\", &saveptr)) != NULL) {\n            VIR_FREE(*value);\n            *value = g_strdup(token);\n            /* keep going - last entry wins */\n        }\n    }\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n\n    return err ? -1 : *value ? 1 : 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "token"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*value"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "sf",
            "\"\\\"\\t\\n\"",
            "&saveptr"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "line",
            "param"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feof",
          "args": [
            "fp"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&line_size",
            "fp"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*value"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "conf_file",
            "\"r\""
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nopenvzReadConfigParam(const char *conf_file, const char *param, char **value)\n{\n    char *line = NULL;\n    size_t line_size = 0;\n    FILE *fp;\n    int err = 0;\n    char *sf, *token, *saveptr = NULL;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        return -1;\n\n    VIR_FREE(*value);\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            err = !feof(fp);\n            break;\n        }\n\n        if (!(sf = STRSKIP(line, param)))\n            continue;\n\n        if (*sf++ != '=')\n            continue;\n\n        saveptr = NULL;\n        if ((token = strtok_r(sf, \"\\\"\\t\\n\", &saveptr)) != NULL) {\n            VIR_FREE(*value);\n            *value = g_strdup(token);\n            /* keep going - last entry wins */\n        }\n    }\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n\n    return err ? -1 : *value ? 1 : 0;\n}"
  },
  {
    "function_name": "openvzWriteVPSConfigParam",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "673-685",
    "snippet": "int\nopenvzWriteVPSConfigParam(int vpsid, const char *param, const char *value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzWriteConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "conf_file"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzWriteConfigParam",
          "args": [
            "conf_file",
            "param",
            "value"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "openvzWriteConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "616-671",
          "snippet": "static int\nopenvzWriteConfigParam(const char * conf_file, const char *param, const char *value)\n{\n    char * temp_file = NULL;\n    int temp_fd = -1;\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n\n    temp_file = g_strdup_printf(\"%s.tmp\", conf_file);\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto error;\n    temp_fd = open(temp_file, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (temp_fd == -1)\n        goto error;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        if (!(STRPREFIX(line, param) && line[strlen(param)] == '=')) {\n            if (safewrite(temp_fd, line, strlen(line)) !=\n                strlen(line))\n                goto error;\n        }\n    }\n\n    if (safewrite(temp_fd, param, strlen(param)) < 0 ||\n        safewrite(temp_fd, \"=\\\"\", 2) < 0 ||\n        safewrite(temp_fd, value, strlen(value)) < 0 ||\n        safewrite(temp_fd, \"\\\"\\n\", 2) < 0)\n        goto error;\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(temp_fd) < 0)\n        goto error;\n\n    if (rename(temp_file, conf_file) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(temp_fd);\n    if (temp_file)\n        unlink(temp_file);\n    VIR_FREE(temp_file);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzWriteConfigParam(const char * conf_file, const char *param, const char *value)\n{\n    char * temp_file = NULL;\n    int temp_fd = -1;\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n\n    temp_file = g_strdup_printf(\"%s.tmp\", conf_file);\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto error;\n    temp_fd = open(temp_file, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (temp_fd == -1)\n        goto error;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        if (!(STRPREFIX(line, param) && line[strlen(param)] == '=')) {\n            if (safewrite(temp_fd, line, strlen(line)) !=\n                strlen(line))\n                goto error;\n        }\n    }\n\n    if (safewrite(temp_fd, param, strlen(param)) < 0 ||\n        safewrite(temp_fd, \"=\\\"\", 2) < 0 ||\n        safewrite(temp_fd, value, strlen(value)) < 0 ||\n        safewrite(temp_fd, \"\\\"\\n\", 2) < 0)\n        goto error;\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(temp_fd) < 0)\n        goto error;\n\n    if (rename(temp_file, conf_file) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(temp_fd);\n    if (temp_file)\n        unlink(temp_file);\n    VIR_FREE(temp_file);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzLocateConfFile",
          "args": [
            "vpsid",
            "&conf_file",
            "\"conf\""
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "openvzLocateConfFileDefault",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "842-856",
          "snippet": "static int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int\nopenvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext)\n{\n    char *confdir;\n    int ret = 0;\n\n    confdir = openvzLocateConfDir();\n    if (confdir == NULL)\n        return -1;\n\n    *conffile = g_strdup_printf(\"%s/%d.%s\", confdir, vpsid, ext ? ext : \"conf\");\n\n    VIR_FREE(confdir);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzWriteVPSConfigParam(int vpsid, const char *param, const char *value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzWriteConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
  },
  {
    "function_name": "openvzWriteConfigParam",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "616-671",
    "snippet": "static int\nopenvzWriteConfigParam(const char * conf_file, const char *param, const char *value)\n{\n    char * temp_file = NULL;\n    int temp_fd = -1;\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n\n    temp_file = g_strdup_printf(\"%s.tmp\", conf_file);\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto error;\n    temp_fd = open(temp_file, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (temp_fd == -1)\n        goto error;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        if (!(STRPREFIX(line, param) && line[strlen(param)] == '=')) {\n            if (safewrite(temp_fd, line, strlen(line)) !=\n                strlen(line))\n                goto error;\n        }\n    }\n\n    if (safewrite(temp_fd, param, strlen(param)) < 0 ||\n        safewrite(temp_fd, \"=\\\"\", 2) < 0 ||\n        safewrite(temp_fd, value, strlen(value)) < 0 ||\n        safewrite(temp_fd, \"\\\"\\n\", 2) < 0)\n        goto error;\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(temp_fd) < 0)\n        goto error;\n\n    if (rename(temp_file, conf_file) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(temp_fd);\n    if (temp_file)\n        unlink(temp_file);\n    VIR_FREE(temp_file);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp_file"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "temp_file"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "temp_fd"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "line"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "temp_file",
            "conf_file"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "temp_fd"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "temp_fd",
            "\"\\\"\\n\"",
            "2"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "param"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "param"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "line",
            "param"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&line_size",
            "fp"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "temp_file",
            "O_WRONLY | O_CREAT | O_TRUNC",
            "0644"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVPSUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "899-947",
          "snippet": "static int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);",
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nstatic int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "conf_file",
            "\"r\""
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.tmp\"",
            "conf_file"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzWriteConfigParam(const char * conf_file, const char *param, const char *value)\n{\n    char * temp_file = NULL;\n    int temp_fd = -1;\n    FILE *fp;\n    char *line = NULL;\n    size_t line_size = 0;\n\n    temp_file = g_strdup_printf(\"%s.tmp\", conf_file);\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto error;\n    temp_fd = open(temp_file, O_WRONLY | O_CREAT | O_TRUNC, 0644);\n    if (temp_fd == -1)\n        goto error;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) <= 0)\n            break;\n\n        if (!(STRPREFIX(line, param) && line[strlen(param)] == '=')) {\n            if (safewrite(temp_fd, line, strlen(line)) !=\n                strlen(line))\n                goto error;\n        }\n    }\n\n    if (safewrite(temp_fd, param, strlen(param)) < 0 ||\n        safewrite(temp_fd, \"=\\\"\", 2) < 0 ||\n        safewrite(temp_fd, value, strlen(value)) < 0 ||\n        safewrite(temp_fd, \"\\\"\\n\", 2) < 0)\n        goto error;\n\n    if (VIR_FCLOSE(fp) < 0)\n        goto error;\n    if (VIR_CLOSE(temp_fd) < 0)\n        goto error;\n\n    if (rename(temp_file, conf_file) < 0)\n        goto error;\n\n    VIR_FREE(line);\n\n    return 0;\n\n error:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FORCE_CLOSE(temp_fd);\n    if (temp_file)\n        unlink(temp_file);\n    VIR_FREE(temp_file);\n    return -1;\n}"
  },
  {
    "function_name": "openvzLoadDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "492-614",
    "snippet": "int openvzLoadDomains(struct openvz_driver *driver)\n{\n    int veid, ret;\n    char *status;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainObjPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    char *temp = NULL;\n    char *outbuf = NULL;\n    char *line;\n    virCommandPtr cmd = NULL;\n    unsigned int vcpus = 0;\n\n    if (openvzAssignUUIDs() < 0)\n        return -1;\n\n    cmd = virCommandNewArgList(VZLIST, \"-a\", \"-ovpsid,status\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    line = outbuf;\n    while (line[0] != '\\0') {\n        unsigned int flags = 0;\n        if (virStrToLong_i(line, &status, 10, &veid) < 0 ||\n            *status++ != ' ' ||\n            (line = strchr(status, '\\n')) == NULL) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to parse vzlist output\"));\n            goto cleanup;\n        }\n        *line++ = '\\0';\n\n        if (!(def = virDomainDefNew()))\n            goto cleanup;\n\n        def->virtType = VIR_DOMAIN_VIRT_OPENVZ;\n\n        if (STREQ(status, \"stopped\"))\n            def->id = -1;\n        else\n            def->id = veid;\n        def->name = g_strdup_printf(\"%i\", veid);\n\n        openvzGetVPSUUID(veid, uuidstr, sizeof(uuidstr));\n        ret = virUUIDParse(uuidstr, def->uuid);\n\n        if (ret == -1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"UUID in config file malformed\"));\n            goto cleanup;\n        }\n\n        def->os.type = VIR_DOMAIN_OSTYPE_EXE;\n        def->os.init = g_strdup(\"/sbin/init\");\n\n        ret = openvzReadVPSConfigParam(veid, \"CPUS\", &temp);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read config for container %d\"),\n                           veid);\n            goto cleanup;\n        } else if (ret > 0) {\n            vcpus = strtoI(temp);\n        }\n\n        if (ret == 0 || vcpus == 0)\n            vcpus = virHostCPUGetCount();\n\n        if (virDomainDefSetVcpusMax(def, vcpus, driver->xmlopt) < 0)\n            goto cleanup;\n\n        if (virDomainDefSetVcpus(def, vcpus) < 0)\n            goto cleanup;\n\n        /* XXX load rest of VM config data .... */\n\n        openvzReadNetworkConf(def, veid);\n        openvzReadFSConf(def, veid);\n        openvzReadMemConf(def, veid);\n\n        virUUIDFormat(def->uuid, uuidstr);\n        flags = VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE;\n        if (STRNEQ(status, \"stopped\"))\n            flags |= VIR_DOMAIN_OBJ_LIST_ADD_LIVE;\n\n        if (!(dom = virDomainObjListAdd(driver->domains,\n                                        def,\n                                        driver->xmlopt,\n                                        flags,\n                                        NULL)))\n            goto cleanup;\n\n        if (STREQ(status, \"stopped\")) {\n            virDomainObjSetState(dom, VIR_DOMAIN_SHUTOFF,\n                                 VIR_DOMAIN_SHUTOFF_UNKNOWN);\n            dom->pid = -1;\n        } else {\n            virDomainObjSetState(dom, VIR_DOMAIN_RUNNING,\n                                 VIR_DOMAIN_RUNNING_UNKNOWN);\n            dom->pid = veid;\n        }\n        /* XXX OpenVZ doesn't appear to have concept of a transient domain */\n        dom->persistent = 1;\n\n        virDomainObjEndAPI(&dom);\n        dom = NULL;\n        def = NULL;\n    }\n\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n\n    return 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n    virDomainDefFree(def);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzAssignUUIDs(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainDefFree",
          "args": [
            "def"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3325-3513",
          "snippet": "void virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainDefFree(virDomainDefPtr def)\n{\n    size_t i;\n\n    if (!def)\n        return;\n\n    virDomainResourceDefFree(def->resource);\n\n    for (i = 0; i < def->maxvcpus; i++)\n        virDomainVcpuDefFree(def->vcpus[i]);\n    VIR_FREE(def->vcpus);\n\n    /* hostdevs must be freed before nets (or any future \"intelligent\n     * hostdevs\") because the pointer to the hostdev is really\n     * pointing into the middle of the higher level device's object,\n     * so the original object must still be available during the call\n     * to virDomainHostdevDefFree().\n     */\n    for (i = 0; i < def->nhostdevs; i++)\n        virDomainHostdevDefFree(def->hostdevs[i]);\n    VIR_FREE(def->hostdevs);\n\n    for (i = 0; i < def->nleases; i++)\n        virDomainLeaseDefFree(def->leases[i]);\n    VIR_FREE(def->leases);\n\n    for (i = 0; i < def->ngraphics; i++)\n        virDomainGraphicsDefFree(def->graphics[i]);\n    VIR_FREE(def->graphics);\n\n    for (i = 0; i < def->ninputs; i++)\n        virDomainInputDefFree(def->inputs[i]);\n    VIR_FREE(def->inputs);\n\n    for (i = 0; i < def->ndisks; i++)\n        virDomainDiskDefFree(def->disks[i]);\n    VIR_FREE(def->disks);\n\n    for (i = 0; i < def->ncontrollers; i++)\n        virDomainControllerDefFree(def->controllers[i]);\n    VIR_FREE(def->controllers);\n\n    for (i = 0; i < def->nfss; i++)\n        virDomainFSDefFree(def->fss[i]);\n    VIR_FREE(def->fss);\n\n    for (i = 0; i < def->nnets; i++)\n        virDomainNetDefFree(def->nets[i]);\n    VIR_FREE(def->nets);\n\n    for (i = 0; i < def->nsmartcards; i++)\n        virDomainSmartcardDefFree(def->smartcards[i]);\n    VIR_FREE(def->smartcards);\n\n    for (i = 0; i < def->nserials; i++)\n        virDomainChrDefFree(def->serials[i]);\n    VIR_FREE(def->serials);\n\n    for (i = 0; i < def->nparallels; i++)\n        virDomainChrDefFree(def->parallels[i]);\n    VIR_FREE(def->parallels);\n\n    for (i = 0; i < def->nchannels; i++)\n        virDomainChrDefFree(def->channels[i]);\n    VIR_FREE(def->channels);\n\n    for (i = 0; i < def->nconsoles; i++)\n        virDomainChrDefFree(def->consoles[i]);\n    VIR_FREE(def->consoles);\n\n    for (i = 0; i < def->nsounds; i++)\n        virDomainSoundDefFree(def->sounds[i]);\n    VIR_FREE(def->sounds);\n\n    for (i = 0; i < def->nvideos; i++)\n        virDomainVideoDefFree(def->videos[i]);\n    VIR_FREE(def->videos);\n\n    for (i = 0; i < def->nhubs; i++)\n        virDomainHubDefFree(def->hubs[i]);\n    VIR_FREE(def->hubs);\n\n    for (i = 0; i < def->nredirdevs; i++)\n        virDomainRedirdevDefFree(def->redirdevs[i]);\n    VIR_FREE(def->redirdevs);\n\n    for (i = 0; i < def->nrngs; i++)\n        virDomainRNGDefFree(def->rngs[i]);\n    VIR_FREE(def->rngs);\n\n    for (i = 0; i < def->nmems; i++)\n        virDomainMemoryDefFree(def->mems[i]);\n    VIR_FREE(def->mems);\n\n    virDomainTPMDefFree(def->tpm);\n\n    for (i = 0; i < def->npanics; i++)\n        virDomainPanicDefFree(def->panics[i]);\n    VIR_FREE(def->panics);\n\n    VIR_FREE(def->iommu);\n\n    VIR_FREE(def->idmap.uidmap);\n    VIR_FREE(def->idmap.gidmap);\n\n    VIR_FREE(def->os.machine);\n    VIR_FREE(def->os.init);\n    for (i = 0; def->os.initargv && def->os.initargv[i]; i++)\n        VIR_FREE(def->os.initargv[i]);\n    VIR_FREE(def->os.initargv);\n    for (i = 0; def->os.initenv && def->os.initenv[i]; i++) {\n        VIR_FREE(def->os.initenv[i]->name);\n        VIR_FREE(def->os.initenv[i]->value);\n        VIR_FREE(def->os.initenv[i]);\n    }\n    VIR_FREE(def->os.initdir);\n    VIR_FREE(def->os.inituser);\n    VIR_FREE(def->os.initgroup);\n    VIR_FREE(def->os.initenv);\n    VIR_FREE(def->os.kernel);\n    VIR_FREE(def->os.initrd);\n    VIR_FREE(def->os.cmdline);\n    VIR_FREE(def->os.dtb);\n    VIR_FREE(def->os.root);\n    VIR_FREE(def->os.slic_table);\n    virDomainLoaderDefFree(def->os.loader);\n    VIR_FREE(def->os.bootloader);\n    VIR_FREE(def->os.bootloaderArgs);\n\n    virDomainClockDefClear(&def->clock);\n\n    VIR_FREE(def->name);\n    virBitmapFree(def->cpumask);\n    VIR_FREE(def->emulator);\n    VIR_FREE(def->description);\n    VIR_FREE(def->title);\n    VIR_FREE(def->hyperv_vendor_id);\n\n    virBlkioDeviceArrayClear(def->blkio.devices,\n                             def->blkio.ndevices);\n    VIR_FREE(def->blkio.devices);\n\n    virDomainWatchdogDefFree(def->watchdog);\n\n    virDomainMemballoonDefFree(def->memballoon);\n    virDomainNVRAMDefFree(def->nvram);\n    virDomainVsockDefFree(def->vsock);\n\n    for (i = 0; i < def->mem.nhugepages; i++)\n        virBitmapFree(def->mem.hugepages[i].nodemask);\n    VIR_FREE(def->mem.hugepages);\n\n    for (i = 0; i < def->nseclabels; i++)\n        virSecurityLabelDefFree(def->seclabels[i]);\n    VIR_FREE(def->seclabels);\n\n    virCPUDefFree(def->cpu);\n\n    virDomainIOThreadIDDefArrayFree(def->iothreadids, def->niothreadids);\n\n    virBitmapFree(def->cputune.emulatorpin);\n    VIR_FREE(def->cputune.emulatorsched);\n\n    virDomainNumaFree(def->numa);\n\n    virSysinfoDefFree(def->sysinfo);\n\n    virDomainRedirFilterDefFree(def->redirfilter);\n\n    for (i = 0; i < def->nshmems; i++)\n        virDomainShmemDefFree(def->shmems[i]);\n    VIR_FREE(def->shmems);\n\n    for (i = 0; i < def->nresctrls; i++)\n        virDomainResctrlDefFree(def->resctrls[i]);\n    VIR_FREE(def->resctrls);\n\n    VIR_FREE(def->keywrap);\n\n    if (def->namespaceData && def->ns.free)\n        (def->ns.free)(def->namespaceData);\n\n    virDomainSEVDefFree(def->sev);\n\n    xmlFreeNode(def->metadata);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "outbuf"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjEndAPI",
          "args": [
            "&dom"
          ],
          "line": 597
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3640-3649",
          "snippet": "void\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjEndAPI(virDomainObjPtr *vm)\n{\n    if (!*vm)\n        return;\n\n    virObjectUnlock(*vm);\n    virObjectUnref(*vm);\n    *vm = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainObjSetState",
          "args": [
            "dom",
            "VIR_DOMAIN_RUNNING",
            "VIR_DOMAIN_RUNNING_UNKNOWN"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjSetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30048-30089",
          "snippet": "void\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainObjSetState(virDomainObjPtr dom, virDomainState state, int reason)\n{\n    int last;\n\n    switch (state) {\n    case VIR_DOMAIN_NOSTATE:\n        last = VIR_DOMAIN_NOSTATE_LAST;\n        break;\n    case VIR_DOMAIN_RUNNING:\n        last = VIR_DOMAIN_RUNNING_LAST;\n        break;\n    case VIR_DOMAIN_BLOCKED:\n        last = VIR_DOMAIN_BLOCKED_LAST;\n        break;\n    case VIR_DOMAIN_PAUSED:\n        last = VIR_DOMAIN_PAUSED_LAST;\n        break;\n    case VIR_DOMAIN_SHUTDOWN:\n        last = VIR_DOMAIN_SHUTDOWN_LAST;\n        break;\n    case VIR_DOMAIN_SHUTOFF:\n        last = VIR_DOMAIN_SHUTOFF_LAST;\n        break;\n    case VIR_DOMAIN_CRASHED:\n        last = VIR_DOMAIN_CRASHED_LAST;\n        break;\n    case VIR_DOMAIN_PMSUSPENDED:\n        last = VIR_DOMAIN_PMSUSPENDED_LAST;\n        break;\n    case VIR_DOMAIN_LAST:\n    default:\n        VIR_ERROR(_(\"invalid domain state: %d\"), state);\n        return;\n    }\n\n    dom->state.state = state;\n    if (reason > 0 && reason < last)\n        dom->state.reason = reason;\n    else\n        dom->state.reason = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "status",
            "\"stopped\""
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainObjListAdd",
          "args": [
            "driver->domains",
            "def",
            "driver->xmlopt",
            "flags",
            "NULL"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainobjlist.c",
          "lines": "354-366",
          "snippet": "virDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virdomainobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"checkpoint_conf.h\"\n#include \"virdomainobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainObjPtr virDomainObjListAdd(virDomainObjListPtr doms,\n                                    virDomainDefPtr def,\n                                    virDomainXMLOptionPtr xmlopt,\n                                    unsigned int flags,\n                                    virDomainDefPtr *oldDef)\n{\n    virDomainObjPtr ret;\n\n    virObjectRWLockWrite(doms);\n    ret = virDomainObjListAddLocked(doms, def, xmlopt, flags, oldDef);\n    virObjectRWUnlock(doms);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "status",
            "\"stopped\""
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "def->uuid",
            "uuidstr"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadMemConf",
          "args": [
            "def",
            "veid"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadMemConf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "408-474",
          "snippet": "static int\nopenvzReadMemConf(virDomainDefPtr def, int veid)\n{\n    int ret = -1;\n    char *temp = NULL;\n    unsigned long long barrier, limit;\n    const char *param;\n    long kb_per_pages;\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        goto error;\n\n    /* Memory allocation guarantee */\n    param = \"VMGUARPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, NULL);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.min_guarantee = 0ull;\n        else\n            def->mem.min_guarantee = barrier * kb_per_pages;\n    }\n\n    /* Memory hard and soft limits */\n    param = \"PRIVVMPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, &limit);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier and limit of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.soft_limit = barrier * kb_per_pages;\n\n        if (limit == LONG_MAX)\n            def->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.hard_limit = limit * kb_per_pages;\n    }\n\n    ret = 0;\n error:\n    VIR_FREE(temp);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzReadMemConf(virDomainDefPtr def, int veid)\n{\n    int ret = -1;\n    char *temp = NULL;\n    unsigned long long barrier, limit;\n    const char *param;\n    long kb_per_pages;\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        goto error;\n\n    /* Memory allocation guarantee */\n    param = \"VMGUARPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, NULL);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.min_guarantee = 0ull;\n        else\n            def->mem.min_guarantee = barrier * kb_per_pages;\n    }\n\n    /* Memory hard and soft limits */\n    param = \"PRIVVMPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, &limit);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier and limit of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.soft_limit = barrier * kb_per_pages;\n\n        if (limit == LONG_MAX)\n            def->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.hard_limit = limit * kb_per_pages;\n    }\n\n    ret = 0;\n error:\n    VIR_FREE(temp);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadFSConf",
          "args": [
            "def",
            "veid"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadFSConf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "327-405",
          "snippet": "static int\nopenvzReadFSConf(virDomainDefPtr def,\n                 int veid)\n{\n    int ret;\n    virDomainFSDefPtr fs = NULL;\n    char *veid_str = NULL;\n    char *temp = NULL;\n    const char *param;\n    unsigned long long barrier, limit;\n\n    ret = openvzReadVPSConfigParam(veid, \"OSTEMPLATE\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'OSTEMPLATE' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        if (!(fs = virDomainFSDefNew(NULL)))\n            goto error;\n\n        fs->type = VIR_DOMAIN_FS_TYPE_TEMPLATE;\n        fs->src->path = g_strdup(temp);\n    } else {\n        /* OSTEMPLATE was not found, VE was booted from a private dir directly */\n        ret = openvzReadVPSConfigParam(veid, \"VE_PRIVATE\", &temp);\n        if (ret <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read 'VE_PRIVATE' from config for container %d\"),\n                           veid);\n            goto error;\n        }\n\n        if (VIR_ALLOC(fs) < 0)\n            goto error;\n\n        veid_str = g_strdup_printf(\"%d\", veid);\n\n        fs->type = VIR_DOMAIN_FS_TYPE_MOUNT;\n        if (!(fs->src->path = virStringReplace(temp, \"$VEID\", veid_str)))\n            goto error;\n\n        VIR_FREE(veid_str);\n    }\n\n    fs->dst = g_strdup(\"/\");\n\n    param = \"DISKSPACE\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret > 0) {\n        if (openvzParseBarrierLimit(temp, &barrier, &limit)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read '%s' from config for container %d\"),\n                           param, veid);\n            goto error;\n        } else {\n            /* Ensure that we can multiply by 1024 without overflowing. */\n            if (barrier > ULLONG_MAX / 1024 ||\n                limit > ULLONG_MAX / 1024) {\n                virReportError(VIR_ERR_OVERFLOW, \"%s\",\n                               _(\"Unable to parse quota\"));\n                goto error;\n            }\n            fs->space_soft_limit = barrier * 1024; /* unit is bytes */\n            fs->space_hard_limit = limit * 1024;   /* unit is bytes */\n        }\n    }\n\n    if (VIR_APPEND_ELEMENT(def->fss, def->nfss, fs) < 0)\n        goto error;\n\n    VIR_FREE(temp);\n\n    return 0;\n error:\n    VIR_FREE(temp);\n    virDomainFSDefFree(fs);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzReadFSConf(virDomainDefPtr def,\n                 int veid)\n{\n    int ret;\n    virDomainFSDefPtr fs = NULL;\n    char *veid_str = NULL;\n    char *temp = NULL;\n    const char *param;\n    unsigned long long barrier, limit;\n\n    ret = openvzReadVPSConfigParam(veid, \"OSTEMPLATE\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'OSTEMPLATE' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        if (!(fs = virDomainFSDefNew(NULL)))\n            goto error;\n\n        fs->type = VIR_DOMAIN_FS_TYPE_TEMPLATE;\n        fs->src->path = g_strdup(temp);\n    } else {\n        /* OSTEMPLATE was not found, VE was booted from a private dir directly */\n        ret = openvzReadVPSConfigParam(veid, \"VE_PRIVATE\", &temp);\n        if (ret <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read 'VE_PRIVATE' from config for container %d\"),\n                           veid);\n            goto error;\n        }\n\n        if (VIR_ALLOC(fs) < 0)\n            goto error;\n\n        veid_str = g_strdup_printf(\"%d\", veid);\n\n        fs->type = VIR_DOMAIN_FS_TYPE_MOUNT;\n        if (!(fs->src->path = virStringReplace(temp, \"$VEID\", veid_str)))\n            goto error;\n\n        VIR_FREE(veid_str);\n    }\n\n    fs->dst = g_strdup(\"/\");\n\n    param = \"DISKSPACE\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret > 0) {\n        if (openvzParseBarrierLimit(temp, &barrier, &limit)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read '%s' from config for container %d\"),\n                           param, veid);\n            goto error;\n        } else {\n            /* Ensure that we can multiply by 1024 without overflowing. */\n            if (barrier > ULLONG_MAX / 1024 ||\n                limit > ULLONG_MAX / 1024) {\n                virReportError(VIR_ERR_OVERFLOW, \"%s\",\n                               _(\"Unable to parse quota\"));\n                goto error;\n            }\n            fs->space_soft_limit = barrier * 1024; /* unit is bytes */\n            fs->space_hard_limit = limit * 1024;   /* unit is bytes */\n        }\n    }\n\n    if (VIR_APPEND_ELEMENT(def->fss, def->nfss, fs) < 0)\n        goto error;\n\n    VIR_FREE(temp);\n\n    return 0;\n error:\n    VIR_FREE(temp);\n    virDomainFSDefFree(fs);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadNetworkConf",
          "args": [
            "def",
            "veid"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadNetworkConf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "185-324",
          "snippet": "int\nopenvzReadNetworkConf(virDomainDefPtr def,\n                      int veid)\n{\n    int ret;\n    virDomainNetDefPtr net = NULL;\n    char *temp = NULL;\n    char *token, *saveptr = NULL;\n\n    /*parse routing network configuration*\n     * Sample from config:\n     *   IP_ADDRESS=\"1.1.1.1 1.1.1.2\"\n     * IPs split by space\n     */\n    ret = openvzReadVPSConfigParam(veid, \"IP_ADDRESS\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'IP_ADDRESS' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \" \", &saveptr);\n        while (token != NULL) {\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n            if (virDomainNetAppendIPAddress(net, token, AF_UNSPEC, 0) < 0)\n                goto error;\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \" \", &saveptr);\n        }\n    }\n\n    /*parse bridge devices*/\n    /*Sample from config:\n     * NETIF=\"ifname=eth10,mac=00:18:51:C1:05:EE,host_ifname=veth105.10,host_mac=00:18:51:8F:D9:F3\"\n     *devices split by ';'\n     */\n    ret = openvzReadVPSConfigParam(veid, \"NETIF\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'NETIF' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \";\", &saveptr);\n        while (token != NULL) {\n            /* add new device to list */\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n\n            char *p = token;\n            char cpy_temp[32];\n            int len;\n\n            /* parse string */\n            do {\n                char *next = strchr(p, ',');\n                if (!next)\n                    next = strchr(p, '\\0');\n                if (STRPREFIX(p, \"ifname=\")) {\n                    /* skip in libvirt */\n                } else if (STRPREFIX(p, \"host_ifname=\")) {\n                    p += 12;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long network device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->ifname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->ifname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Network ifname %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"bridge=\")) {\n                    p += 7;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long bridge device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->data.bridge.brname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->data.bridge.brname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Bridge name %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"mac=\")) {\n                    p += 4;\n                    len = next - p;\n                    if (len != 17) { /* should be 17 */\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong length MAC address\"));\n                        goto error;\n                    }\n                    if (virStrncpy(cpy_temp, p, len, sizeof(cpy_temp)) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"MAC address %s too long for destination\"), p);\n                        goto error;\n                    }\n                    if (virMacAddrParse(cpy_temp, &net->mac) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong MAC address\"));\n                        goto error;\n                    }\n                }\n                p = ++next;\n            } while (p < token + strlen(token));\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \";\", &saveptr);\n        }\n    }\n\n    VIR_FREE(temp);\n\n    return 0;\n\n error:\n    VIR_FREE(temp);\n    virDomainNetDefFree(net);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\n\nint\nopenvzReadNetworkConf(virDomainDefPtr def,\n                      int veid)\n{\n    int ret;\n    virDomainNetDefPtr net = NULL;\n    char *temp = NULL;\n    char *token, *saveptr = NULL;\n\n    /*parse routing network configuration*\n     * Sample from config:\n     *   IP_ADDRESS=\"1.1.1.1 1.1.1.2\"\n     * IPs split by space\n     */\n    ret = openvzReadVPSConfigParam(veid, \"IP_ADDRESS\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'IP_ADDRESS' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \" \", &saveptr);\n        while (token != NULL) {\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n            if (virDomainNetAppendIPAddress(net, token, AF_UNSPEC, 0) < 0)\n                goto error;\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \" \", &saveptr);\n        }\n    }\n\n    /*parse bridge devices*/\n    /*Sample from config:\n     * NETIF=\"ifname=eth10,mac=00:18:51:C1:05:EE,host_ifname=veth105.10,host_mac=00:18:51:8F:D9:F3\"\n     *devices split by ';'\n     */\n    ret = openvzReadVPSConfigParam(veid, \"NETIF\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'NETIF' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \";\", &saveptr);\n        while (token != NULL) {\n            /* add new device to list */\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n\n            char *p = token;\n            char cpy_temp[32];\n            int len;\n\n            /* parse string */\n            do {\n                char *next = strchr(p, ',');\n                if (!next)\n                    next = strchr(p, '\\0');\n                if (STRPREFIX(p, \"ifname=\")) {\n                    /* skip in libvirt */\n                } else if (STRPREFIX(p, \"host_ifname=\")) {\n                    p += 12;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long network device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->ifname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->ifname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Network ifname %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"bridge=\")) {\n                    p += 7;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long bridge device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->data.bridge.brname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->data.bridge.brname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Bridge name %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"mac=\")) {\n                    p += 4;\n                    len = next - p;\n                    if (len != 17) { /* should be 17 */\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong length MAC address\"));\n                        goto error;\n                    }\n                    if (virStrncpy(cpy_temp, p, len, sizeof(cpy_temp)) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"MAC address %s too long for destination\"), p);\n                        goto error;\n                    }\n                    if (virMacAddrParse(cpy_temp, &net->mac) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong MAC address\"));\n                        goto error;\n                    }\n                }\n                p = ++next;\n            } while (p < token + strlen(token));\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \";\", &saveptr);\n        }\n    }\n\n    VIR_FREE(temp);\n\n    return 0;\n\n error:\n    VIR_FREE(temp);\n    virDomainNetDefFree(net);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetVcpus",
          "args": [
            "def",
            "vcpus"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetVcpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1889-1909",
          "snippet": "int\nvirDomainDefSetVcpus(virDomainDefPtr def,\n                     unsigned int vcpus)\n{\n    size_t i;\n\n    if (vcpus > def->maxvcpus) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"maximum vCPU count must not be less than current \"\n                         \"vCPU count\"));\n        return -1;\n    }\n\n    for (i = 0; i < vcpus; i++)\n        def->vcpus[i]->online = true;\n\n    for (i = vcpus; i < def->maxvcpus; i++)\n        def->vcpus[i]->online = false;\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSetVcpus(virDomainDefPtr def,\n                     unsigned int vcpus)\n{\n    size_t i;\n\n    if (vcpus > def->maxvcpus) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"maximum vCPU count must not be less than current \"\n                         \"vCPU count\"));\n        return -1;\n    }\n\n    for (i = 0; i < vcpus; i++)\n        def->vcpus[i]->online = true;\n\n    for (i = vcpus; i < def->maxvcpus; i++)\n        def->vcpus[i]->online = false;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefSetVcpusMax",
          "args": [
            "def",
            "vcpus",
            "driver->xmlopt"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefSetVcpusMax",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1838-1865",
          "snippet": "int\nvirDomainDefSetVcpusMax(virDomainDefPtr def,\n                        unsigned int maxvcpus,\n                        virDomainXMLOptionPtr xmlopt)\n{\n    size_t oldmax = def->maxvcpus;\n    size_t i;\n\n    if (def->maxvcpus == maxvcpus)\n        return 0;\n\n    if (def->maxvcpus < maxvcpus) {\n        if (VIR_EXPAND_N(def->vcpus, def->maxvcpus, maxvcpus - def->maxvcpus) < 0)\n            return -1;\n\n        for (i = oldmax; i < def->maxvcpus; i++) {\n            if (!(def->vcpus[i] = virDomainVcpuDefNew(xmlopt)))\n                return -1;\n        }\n    } else {\n        for (i = maxvcpus; i < def->maxvcpus; i++)\n            virDomainVcpuDefFree(def->vcpus[i]);\n\n        VIR_SHRINK_N(def->vcpus, def->maxvcpus, def->maxvcpus - maxvcpus);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDefSetVcpusMax(virDomainDefPtr def,\n                        unsigned int maxvcpus,\n                        virDomainXMLOptionPtr xmlopt)\n{\n    size_t oldmax = def->maxvcpus;\n    size_t i;\n\n    if (def->maxvcpus == maxvcpus)\n        return 0;\n\n    if (def->maxvcpus < maxvcpus) {\n        if (VIR_EXPAND_N(def->vcpus, def->maxvcpus, maxvcpus - def->maxvcpus) < 0)\n            return -1;\n\n        for (i = oldmax; i < def->maxvcpus; i++) {\n            if (!(def->vcpus[i] = virDomainVcpuDefNew(xmlopt)))\n                return -1;\n        }\n    } else {\n        for (i = maxvcpus; i < def->maxvcpus; i++)\n            virDomainVcpuDefFree(def->vcpus[i]);\n\n        VIR_SHRINK_N(def->vcpus, def->maxvcpus, def->maxvcpus - maxvcpus);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHostCPUGetCount",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1030-1042",
          "snippet": "int\nvirHostCPUGetCount(void)\n{\n#if defined(__linux__)\n    return virHostCPUParseCountLinux();\n#elif defined(__FreeBSD__) || defined(__APPLE__)\n    return virHostCPUGetCountAppleFreeBSD();\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"host cpu counting not implemented on this platform\"));\n    return -1;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\nint\nvirHostCPUGetCount(void)\n{\n#if defined(__linux__)\n    return virHostCPUParseCountLinux();\n#elif defined(__FreeBSD__) || defined(__APPLE__)\n    return virHostCPUGetCountAppleFreeBSD();\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"host cpu counting not implemented on this platform\"));\n    return -1;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtoI",
          "args": [
            "temp"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "strtoI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "54-63",
          "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read config for container %d\")",
            "veid"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not read config for container %d\""
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadVPSConfigParam",
          "args": [
            "veid",
            "\"CPUS\"",
            "&temp"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "743-755",
          "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"UUID in config file malformed\")"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuidstr",
            "def->uuid"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzGetVPSUUID",
          "args": [
            "veid",
            "uuidstr",
            "sizeof(uuidstr)"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "openvzGetVPSUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "899-947",
          "snippet": "static int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);",
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nstatic int\nopenvzGetVPSUUID(int vpsid, char *uuidstr, size_t len)\n{\n    char *conf_file;\n    char *line = NULL;\n    size_t line_size = 0;\n    char *saveptr = NULL;\n    char *uuidbuf;\n    char *iden;\n    FILE *fp;\n    int retval = -1;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    fp = fopen(conf_file, \"r\");\n    if (fp == NULL)\n        goto cleanup;\n\n    while (1) {\n        if (getline(&line, &line_size, fp) < 0) {\n            if (feof(fp)) { /* EOF, UUID was not found */\n                uuidstr[0] = 0;\n                break;\n            } else {\n                goto cleanup;\n            }\n        }\n\n        iden = strtok_r(line, \" \", &saveptr);\n        uuidbuf = strtok_r(NULL, \"\\n\", &saveptr);\n\n        if (iden != NULL && uuidbuf != NULL && STREQ(iden, \"#UUID:\")) {\n            if (virStrcpy(uuidstr, uuidbuf, len) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"invalid uuid %s\"), uuidbuf);\n                goto cleanup;\n            }\n            break;\n        }\n    }\n    retval = 0;\n cleanup:\n    VIR_FREE(line);\n    VIR_FORCE_FCLOSE(fp);\n    VIR_FREE(conf_file);\n\n    return retval;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "status",
            "\"stopped\""
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDefNew",
          "args": [],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "3574-3594",
          "snippet": "virDomainDefPtr\nvirDomainDefNew(void)\n{\n    virDomainDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->numa = virDomainNumaNew()))\n        goto error;\n\n    ret->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.swap_hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return ret;\n\n error:\n    virDomainDefFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainDefPtr\nvirDomainDefNew(void)\n{\n    virDomainDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->numa = virDomainNumaNew()))\n        goto error;\n\n    ret->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n    ret->mem.swap_hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return ret;\n\n error:\n    virDomainDefFree(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to parse vzlist output\")"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "status",
            "'\\n'"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "line",
            "&status",
            "10",
            "&veid"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&outbuf"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "VZLIST",
            "\"-a\"",
            "\"-ovpsid,status\"",
            "\"-H\"",
            "NULL"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzAssignUUIDs",
          "args": [],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "openvzAssignUUIDs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "1011-1041",
          "snippet": "static int openvzAssignUUIDs(void)\n{\n    DIR *dp;\n    struct dirent *dent;\n    char *conf_dir;\n    int vpsid;\n    char *ext;\n    int ret = 0;\n\n    conf_dir = openvzLocateConfDir();\n    if (conf_dir == NULL)\n        return -1;\n\n    if (virDirOpenQuiet(&dp, conf_dir) < 0) {\n        VIR_FREE(conf_dir);\n        return 0;\n    }\n\n    while ((ret = virDirRead(dp, &dent, conf_dir)) > 0) {\n        if (virStrToLong_i(dent->d_name, &ext, 10, &vpsid) < 0 ||\n            *ext++ != '.' ||\n            STRNEQ(ext, \"conf\"))\n            continue;\n        if (vpsid > 0) /* '0.conf' belongs to the host, ignore it */\n            openvzSetUUID(vpsid);\n    }\n\n    VIR_DIR_CLOSE(dp);\n    VIR_FREE(conf_dir);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char *openvzLocateConfDir(void);",
            "static int openvzAssignUUIDs(void);",
            "static int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *openvzLocateConfDir(void);\nstatic int openvzAssignUUIDs(void);\nstatic int openvzLocateConfFileDefault(int vpsid, char **conffile, const char *ext);\n\nstatic int openvzAssignUUIDs(void)\n{\n    DIR *dp;\n    struct dirent *dent;\n    char *conf_dir;\n    int vpsid;\n    char *ext;\n    int ret = 0;\n\n    conf_dir = openvzLocateConfDir();\n    if (conf_dir == NULL)\n        return -1;\n\n    if (virDirOpenQuiet(&dp, conf_dir) < 0) {\n        VIR_FREE(conf_dir);\n        return 0;\n    }\n\n    while ((ret = virDirRead(dp, &dent, conf_dir)) > 0) {\n        if (virStrToLong_i(dent->d_name, &ext, 10, &vpsid) < 0 ||\n            *ext++ != '.' ||\n            STRNEQ(ext, \"conf\"))\n            continue;\n        if (vpsid > 0) /* '0.conf' belongs to the host, ignore it */\n            openvzSetUUID(vpsid);\n    }\n\n    VIR_DIR_CLOSE(dp);\n    VIR_FREE(conf_dir);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzAssignUUIDs(void);\n\nint openvzLoadDomains(struct openvz_driver *driver)\n{\n    int veid, ret;\n    char *status;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    virDomainObjPtr dom = NULL;\n    virDomainDefPtr def = NULL;\n    char *temp = NULL;\n    char *outbuf = NULL;\n    char *line;\n    virCommandPtr cmd = NULL;\n    unsigned int vcpus = 0;\n\n    if (openvzAssignUUIDs() < 0)\n        return -1;\n\n    cmd = virCommandNewArgList(VZLIST, \"-a\", \"-ovpsid,status\", \"-H\", NULL);\n    virCommandSetOutputBuffer(cmd, &outbuf);\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    line = outbuf;\n    while (line[0] != '\\0') {\n        unsigned int flags = 0;\n        if (virStrToLong_i(line, &status, 10, &veid) < 0 ||\n            *status++ != ' ' ||\n            (line = strchr(status, '\\n')) == NULL) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to parse vzlist output\"));\n            goto cleanup;\n        }\n        *line++ = '\\0';\n\n        if (!(def = virDomainDefNew()))\n            goto cleanup;\n\n        def->virtType = VIR_DOMAIN_VIRT_OPENVZ;\n\n        if (STREQ(status, \"stopped\"))\n            def->id = -1;\n        else\n            def->id = veid;\n        def->name = g_strdup_printf(\"%i\", veid);\n\n        openvzGetVPSUUID(veid, uuidstr, sizeof(uuidstr));\n        ret = virUUIDParse(uuidstr, def->uuid);\n\n        if (ret == -1) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"UUID in config file malformed\"));\n            goto cleanup;\n        }\n\n        def->os.type = VIR_DOMAIN_OSTYPE_EXE;\n        def->os.init = g_strdup(\"/sbin/init\");\n\n        ret = openvzReadVPSConfigParam(veid, \"CPUS\", &temp);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read config for container %d\"),\n                           veid);\n            goto cleanup;\n        } else if (ret > 0) {\n            vcpus = strtoI(temp);\n        }\n\n        if (ret == 0 || vcpus == 0)\n            vcpus = virHostCPUGetCount();\n\n        if (virDomainDefSetVcpusMax(def, vcpus, driver->xmlopt) < 0)\n            goto cleanup;\n\n        if (virDomainDefSetVcpus(def, vcpus) < 0)\n            goto cleanup;\n\n        /* XXX load rest of VM config data .... */\n\n        openvzReadNetworkConf(def, veid);\n        openvzReadFSConf(def, veid);\n        openvzReadMemConf(def, veid);\n\n        virUUIDFormat(def->uuid, uuidstr);\n        flags = VIR_DOMAIN_OBJ_LIST_ADD_CHECK_LIVE;\n        if (STRNEQ(status, \"stopped\"))\n            flags |= VIR_DOMAIN_OBJ_LIST_ADD_LIVE;\n\n        if (!(dom = virDomainObjListAdd(driver->domains,\n                                        def,\n                                        driver->xmlopt,\n                                        flags,\n                                        NULL)))\n            goto cleanup;\n\n        if (STREQ(status, \"stopped\")) {\n            virDomainObjSetState(dom, VIR_DOMAIN_SHUTOFF,\n                                 VIR_DOMAIN_SHUTOFF_UNKNOWN);\n            dom->pid = -1;\n        } else {\n            virDomainObjSetState(dom, VIR_DOMAIN_RUNNING,\n                                 VIR_DOMAIN_RUNNING_UNKNOWN);\n            dom->pid = veid;\n        }\n        /* XXX OpenVZ doesn't appear to have concept of a transient domain */\n        dom->persistent = 1;\n\n        virDomainObjEndAPI(&dom);\n        dom = NULL;\n        def = NULL;\n    }\n\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n\n    return 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(temp);\n    VIR_FREE(outbuf);\n    virDomainDefFree(def);\n    return -1;\n}"
  },
  {
    "function_name": "openvzFreeDriver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "478-488",
    "snippet": "void\nopenvzFreeDriver(struct openvz_driver *driver)\n{\n    if (!driver)\n        return;\n\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    VIR_FREE(driver);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver->caps"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nopenvzFreeDriver(struct openvz_driver *driver)\n{\n    if (!driver)\n        return;\n\n    virObjectUnref(driver->xmlopt);\n    virObjectUnref(driver->domains);\n    virObjectUnref(driver->caps);\n    VIR_FREE(driver);\n}"
  },
  {
    "function_name": "openvzReadMemConf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "408-474",
    "snippet": "static int\nopenvzReadMemConf(virDomainDefPtr def, int veid)\n{\n    int ret = -1;\n    char *temp = NULL;\n    unsigned long long barrier, limit;\n    const char *param;\n    long kb_per_pages;\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        goto error;\n\n    /* Memory allocation guarantee */\n    param = \"VMGUARPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, NULL);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.min_guarantee = 0ull;\n        else\n            def->mem.min_guarantee = barrier * kb_per_pages;\n    }\n\n    /* Memory hard and soft limits */\n    param = \"PRIVVMPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, &limit);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier and limit of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.soft_limit = barrier * kb_per_pages;\n\n        if (limit == LONG_MAX)\n            def->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.hard_limit = limit * kb_per_pages;\n    }\n\n    ret = 0;\n error:\n    VIR_FREE(temp);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not parse barrier and limit of '%s' \"\n                             \"from config for container %d\")",
            "param",
            "veid"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not parse barrier and limit of '%s' \"\n                             \"from config for container %d\""
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzParseBarrierLimit",
          "args": [
            "temp",
            "&barrier",
            "&limit"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "openvzParseBarrierLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "121-146",
          "snippet": "static int\nopenvzParseBarrierLimit(const char* value,\n                        unsigned long long *barrier,\n                        unsigned long long *limit)\n{\n    char **tmp = NULL;\n    size_t ntmp = 0;\n    int ret = -1;\n\n    if (!(tmp = virStringSplitCount(value, \":\", 0, &ntmp)))\n        goto error;\n\n    if (ntmp != 2)\n        goto error;\n\n    if (barrier && virStrToLong_ull(tmp[0], NULL, 10, barrier) < 0)\n        goto error;\n\n    if (limit && virStrToLong_ull(tmp[1], NULL, 10, limit) < 0)\n        goto error;\n\n    ret = 0;\n error:\n    virStringListFreeCount(tmp, ntmp);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzParseBarrierLimit(const char* value,\n                        unsigned long long *barrier,\n                        unsigned long long *limit)\n{\n    char **tmp = NULL;\n    size_t ntmp = 0;\n    int ret = -1;\n\n    if (!(tmp = virStringSplitCount(value, \":\", 0, &ntmp)))\n        goto error;\n\n    if (ntmp != 2)\n        goto error;\n\n    if (barrier && virStrToLong_ull(tmp[0], NULL, 10, barrier) < 0)\n        goto error;\n\n    if (limit && virStrToLong_ull(tmp[1], NULL, 10, limit) < 0)\n        goto error;\n\n    ret = 0;\n error:\n    virStringListFreeCount(tmp, ntmp);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read '%s' from config for container %d\")",
            "param",
            "veid"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzReadVPSConfigParam",
          "args": [
            "veid",
            "param",
            "&temp"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "743-755",
          "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not parse barrier of '%s' \"\n                             \"from config for container %d\")",
            "param",
            "veid"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read '%s' from config for container %d\")",
            "param",
            "veid"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzKBPerPages",
          "args": [],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "openvzKBPerPages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_util.c",
          "lines": "41-55",
          "snippet": "long\nopenvzKBPerPages(void)\n{\n    static long kb_per_pages;\n\n    if (kb_per_pages == 0) {\n        if ((kb_per_pages = virGetSystemPageSizeKB()) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Can't determine page size\"));\n            kb_per_pages = 0;\n            return -1;\n        }\n    }\n    return kb_per_pages;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <config.h>\n\nlong\nopenvzKBPerPages(void)\n{\n    static long kb_per_pages;\n\n    if (kb_per_pages == 0) {\n        if ((kb_per_pages = virGetSystemPageSizeKB()) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Can't determine page size\"));\n            kb_per_pages = 0;\n            return -1;\n        }\n    }\n    return kb_per_pages;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzReadMemConf(virDomainDefPtr def, int veid)\n{\n    int ret = -1;\n    char *temp = NULL;\n    unsigned long long barrier, limit;\n    const char *param;\n    long kb_per_pages;\n\n    kb_per_pages = openvzKBPerPages();\n    if (kb_per_pages < 0)\n        goto error;\n\n    /* Memory allocation guarantee */\n    param = \"VMGUARPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, NULL);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.min_guarantee = 0ull;\n        else\n            def->mem.min_guarantee = barrier * kb_per_pages;\n    }\n\n    /* Memory hard and soft limits */\n    param = \"PRIVVMPAGES\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read '%s' from config for container %d\"),\n                       param, veid);\n        goto error;\n    } else if (ret > 0) {\n        ret = openvzParseBarrierLimit(temp, &barrier, &limit);\n        if (ret < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not parse barrier and limit of '%s' \"\n                             \"from config for container %d\"), param, veid);\n            goto error;\n        }\n        if (barrier == LONG_MAX)\n            def->mem.soft_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.soft_limit = barrier * kb_per_pages;\n\n        if (limit == LONG_MAX)\n            def->mem.hard_limit = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n        else\n            def->mem.hard_limit = limit * kb_per_pages;\n    }\n\n    ret = 0;\n error:\n    VIR_FREE(temp);\n    return ret;\n}"
  },
  {
    "function_name": "openvzReadFSConf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "327-405",
    "snippet": "static int\nopenvzReadFSConf(virDomainDefPtr def,\n                 int veid)\n{\n    int ret;\n    virDomainFSDefPtr fs = NULL;\n    char *veid_str = NULL;\n    char *temp = NULL;\n    const char *param;\n    unsigned long long barrier, limit;\n\n    ret = openvzReadVPSConfigParam(veid, \"OSTEMPLATE\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'OSTEMPLATE' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        if (!(fs = virDomainFSDefNew(NULL)))\n            goto error;\n\n        fs->type = VIR_DOMAIN_FS_TYPE_TEMPLATE;\n        fs->src->path = g_strdup(temp);\n    } else {\n        /* OSTEMPLATE was not found, VE was booted from a private dir directly */\n        ret = openvzReadVPSConfigParam(veid, \"VE_PRIVATE\", &temp);\n        if (ret <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read 'VE_PRIVATE' from config for container %d\"),\n                           veid);\n            goto error;\n        }\n\n        if (VIR_ALLOC(fs) < 0)\n            goto error;\n\n        veid_str = g_strdup_printf(\"%d\", veid);\n\n        fs->type = VIR_DOMAIN_FS_TYPE_MOUNT;\n        if (!(fs->src->path = virStringReplace(temp, \"$VEID\", veid_str)))\n            goto error;\n\n        VIR_FREE(veid_str);\n    }\n\n    fs->dst = g_strdup(\"/\");\n\n    param = \"DISKSPACE\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret > 0) {\n        if (openvzParseBarrierLimit(temp, &barrier, &limit)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read '%s' from config for container %d\"),\n                           param, veid);\n            goto error;\n        } else {\n            /* Ensure that we can multiply by 1024 without overflowing. */\n            if (barrier > ULLONG_MAX / 1024 ||\n                limit > ULLONG_MAX / 1024) {\n                virReportError(VIR_ERR_OVERFLOW, \"%s\",\n                               _(\"Unable to parse quota\"));\n                goto error;\n            }\n            fs->space_soft_limit = barrier * 1024; /* unit is bytes */\n            fs->space_hard_limit = limit * 1024;   /* unit is bytes */\n        }\n    }\n\n    if (VIR_APPEND_ELEMENT(def->fss, def->nfss, fs) < 0)\n        goto error;\n\n    VIR_FREE(temp);\n\n    return 0;\n error:\n    VIR_FREE(temp);\n    virDomainFSDefFree(fs);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainFSDefFree",
          "args": [
            "fs"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainFSDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2328-2341",
          "snippet": "void virDomainFSDefFree(virDomainFSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->dst);\n    virDomainDeviceInfoClear(&def->info);\n    VIR_FREE(def->virtio);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def->binary);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid virDomainFSDefFree(virDomainFSDefPtr def)\n{\n    if (!def)\n        return;\n\n    virObjectUnref(def->src);\n    VIR_FREE(def->dst);\n    virDomainDeviceInfoClear(&def->info);\n    VIR_FREE(def->virtio);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def->binary);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "def->fss",
            "def->nfss",
            "fs"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "\"%s\"",
            "_(\"Unable to parse quota\")"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse quota\""
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read '%s' from config for container %d\")",
            "param",
            "veid"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzParseBarrierLimit",
          "args": [
            "temp",
            "&barrier",
            "&limit"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "openvzParseBarrierLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "121-146",
          "snippet": "static int\nopenvzParseBarrierLimit(const char* value,\n                        unsigned long long *barrier,\n                        unsigned long long *limit)\n{\n    char **tmp = NULL;\n    size_t ntmp = 0;\n    int ret = -1;\n\n    if (!(tmp = virStringSplitCount(value, \":\", 0, &ntmp)))\n        goto error;\n\n    if (ntmp != 2)\n        goto error;\n\n    if (barrier && virStrToLong_ull(tmp[0], NULL, 10, barrier) < 0)\n        goto error;\n\n    if (limit && virStrToLong_ull(tmp[1], NULL, 10, limit) < 0)\n        goto error;\n\n    ret = 0;\n error:\n    virStringListFreeCount(tmp, ntmp);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzParseBarrierLimit(const char* value,\n                        unsigned long long *barrier,\n                        unsigned long long *limit)\n{\n    char **tmp = NULL;\n    size_t ntmp = 0;\n    int ret = -1;\n\n    if (!(tmp = virStringSplitCount(value, \":\", 0, &ntmp)))\n        goto error;\n\n    if (ntmp != 2)\n        goto error;\n\n    if (barrier && virStrToLong_ull(tmp[0], NULL, 10, barrier) < 0)\n        goto error;\n\n    if (limit && virStrToLong_ull(tmp[1], NULL, 10, limit) < 0)\n        goto error;\n\n    ret = 0;\n error:\n    virStringListFreeCount(tmp, ntmp);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzReadVPSConfigParam",
          "args": [
            "veid",
            "param",
            "&temp"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "743-755",
          "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "veid_str"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringReplace",
          "args": [
            "temp",
            "\"$VEID\"",
            "veid_str"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "virStringReplace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1067-1095",
          "snippet": "char *\nvirStringReplace(const char *haystack,\n                 const char *oldneedle,\n                 const char *newneedle)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *tmp1, *tmp2;\n    size_t oldneedlelen = strlen(oldneedle);\n    size_t newneedlelen = strlen(newneedle);\n\n    tmp1 = haystack;\n    tmp2 = NULL;\n\n    while (tmp1) {\n        tmp2 = strstr(tmp1, oldneedle);\n\n        if (tmp2) {\n            virBufferAdd(&buf, tmp1, (tmp2 - tmp1));\n            virBufferAdd(&buf, newneedle, newneedlelen);\n            tmp2 += oldneedlelen;\n        } else {\n            virBufferAdd(&buf, tmp1, -1);\n        }\n\n        tmp1 = tmp2;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar *\nvirStringReplace(const char *haystack,\n                 const char *oldneedle,\n                 const char *newneedle)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *tmp1, *tmp2;\n    size_t oldneedlelen = strlen(oldneedle);\n    size_t newneedlelen = strlen(newneedle);\n\n    tmp1 = haystack;\n    tmp2 = NULL;\n\n    while (tmp1) {\n        tmp2 = strstr(tmp1, oldneedle);\n\n        if (tmp2) {\n            virBufferAdd(&buf, tmp1, (tmp2 - tmp1));\n            virBufferAdd(&buf, newneedle, newneedlelen);\n            tmp2 += oldneedlelen;\n        } else {\n            virBufferAdd(&buf, tmp1, -1);\n        }\n\n        tmp1 = tmp2;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "fs"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read 'VE_PRIVATE' from config for container %d\")",
            "veid"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainFSDefNew",
          "args": [
            "NULL"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainFSDefNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2304-2326",
          "snippet": "virDomainFSDefPtr\nvirDomainFSDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainFSDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->src = virStorageSourceNew()))\n        goto cleanup;\n\n    if (xmlopt &&\n        xmlopt->privateData.fsNew &&\n        !(ret->privateData = xmlopt->privateData.fsNew()))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virDomainFSDefFree(ret);\n    return NULL;\n\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvirDomainFSDefPtr\nvirDomainFSDefNew(virDomainXMLOptionPtr xmlopt)\n{\n    virDomainFSDefPtr ret;\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    if (!(ret->src = virStorageSourceNew()))\n        goto cleanup;\n\n    if (xmlopt &&\n        xmlopt->privateData.fsNew &&\n        !(ret->privateData = xmlopt->privateData.fsNew()))\n        goto cleanup;\n\n    return ret;\n\n cleanup:\n    virDomainFSDefFree(ret);\n    return NULL;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read 'OSTEMPLATE' from config for container %d\")",
            "veid"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzReadFSConf(virDomainDefPtr def,\n                 int veid)\n{\n    int ret;\n    virDomainFSDefPtr fs = NULL;\n    char *veid_str = NULL;\n    char *temp = NULL;\n    const char *param;\n    unsigned long long barrier, limit;\n\n    ret = openvzReadVPSConfigParam(veid, \"OSTEMPLATE\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'OSTEMPLATE' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        if (!(fs = virDomainFSDefNew(NULL)))\n            goto error;\n\n        fs->type = VIR_DOMAIN_FS_TYPE_TEMPLATE;\n        fs->src->path = g_strdup(temp);\n    } else {\n        /* OSTEMPLATE was not found, VE was booted from a private dir directly */\n        ret = openvzReadVPSConfigParam(veid, \"VE_PRIVATE\", &temp);\n        if (ret <= 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read 'VE_PRIVATE' from config for container %d\"),\n                           veid);\n            goto error;\n        }\n\n        if (VIR_ALLOC(fs) < 0)\n            goto error;\n\n        veid_str = g_strdup_printf(\"%d\", veid);\n\n        fs->type = VIR_DOMAIN_FS_TYPE_MOUNT;\n        if (!(fs->src->path = virStringReplace(temp, \"$VEID\", veid_str)))\n            goto error;\n\n        VIR_FREE(veid_str);\n    }\n\n    fs->dst = g_strdup(\"/\");\n\n    param = \"DISKSPACE\";\n    ret = openvzReadVPSConfigParam(veid, param, &temp);\n    if (ret > 0) {\n        if (openvzParseBarrierLimit(temp, &barrier, &limit)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not read '%s' from config for container %d\"),\n                           param, veid);\n            goto error;\n        } else {\n            /* Ensure that we can multiply by 1024 without overflowing. */\n            if (barrier > ULLONG_MAX / 1024 ||\n                limit > ULLONG_MAX / 1024) {\n                virReportError(VIR_ERR_OVERFLOW, \"%s\",\n                               _(\"Unable to parse quota\"));\n                goto error;\n            }\n            fs->space_soft_limit = barrier * 1024; /* unit is bytes */\n            fs->space_hard_limit = limit * 1024;   /* unit is bytes */\n        }\n    }\n\n    if (VIR_APPEND_ELEMENT(def->fss, def->nfss, fs) < 0)\n        goto error;\n\n    VIR_FREE(temp);\n\n    return 0;\n error:\n    VIR_FREE(temp);\n    virDomainFSDefFree(fs);\n    return -1;\n}"
  },
  {
    "function_name": "openvzReadNetworkConf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "185-324",
    "snippet": "int\nopenvzReadNetworkConf(virDomainDefPtr def,\n                      int veid)\n{\n    int ret;\n    virDomainNetDefPtr net = NULL;\n    char *temp = NULL;\n    char *token, *saveptr = NULL;\n\n    /*parse routing network configuration*\n     * Sample from config:\n     *   IP_ADDRESS=\"1.1.1.1 1.1.1.2\"\n     * IPs split by space\n     */\n    ret = openvzReadVPSConfigParam(veid, \"IP_ADDRESS\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'IP_ADDRESS' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \" \", &saveptr);\n        while (token != NULL) {\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n            if (virDomainNetAppendIPAddress(net, token, AF_UNSPEC, 0) < 0)\n                goto error;\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \" \", &saveptr);\n        }\n    }\n\n    /*parse bridge devices*/\n    /*Sample from config:\n     * NETIF=\"ifname=eth10,mac=00:18:51:C1:05:EE,host_ifname=veth105.10,host_mac=00:18:51:8F:D9:F3\"\n     *devices split by ';'\n     */\n    ret = openvzReadVPSConfigParam(veid, \"NETIF\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'NETIF' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \";\", &saveptr);\n        while (token != NULL) {\n            /* add new device to list */\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n\n            char *p = token;\n            char cpy_temp[32];\n            int len;\n\n            /* parse string */\n            do {\n                char *next = strchr(p, ',');\n                if (!next)\n                    next = strchr(p, '\\0');\n                if (STRPREFIX(p, \"ifname=\")) {\n                    /* skip in libvirt */\n                } else if (STRPREFIX(p, \"host_ifname=\")) {\n                    p += 12;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long network device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->ifname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->ifname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Network ifname %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"bridge=\")) {\n                    p += 7;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long bridge device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->data.bridge.brname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->data.bridge.brname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Bridge name %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"mac=\")) {\n                    p += 4;\n                    len = next - p;\n                    if (len != 17) { /* should be 17 */\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong length MAC address\"));\n                        goto error;\n                    }\n                    if (virStrncpy(cpy_temp, p, len, sizeof(cpy_temp)) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"MAC address %s too long for destination\"), p);\n                        goto error;\n                    }\n                    if (virMacAddrParse(cpy_temp, &net->mac) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong MAC address\"));\n                        goto error;\n                    }\n                }\n                p = ++next;\n            } while (p < token + strlen(token));\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \";\", &saveptr);\n        }\n    }\n\n    VIR_FREE(temp);\n\n    return 0;\n\n error:\n    VIR_FREE(temp);\n    virDomainNetDefFree(net);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainNetDefFree",
          "args": [
            "net"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2481-2489",
          "snippet": "void\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirDomainNetDefFree(virDomainNetDefPtr def)\n{\n    if (!def)\n        return;\n    virDomainNetDefClear(def);\n    virObjectUnref(def->privateData);\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "temp"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "\";\"",
            "&saveptr"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT_COPY",
          "args": [
            "def->nets",
            "def->nnets",
            "net"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "token"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Wrong MAC address\")"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Wrong MAC address\""
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrParse",
          "args": [
            "cpy_temp",
            "&net->mac"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "205-218",
          "snippet": "int\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"MAC address %s too long for destination\")",
            "p"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrncpy",
          "args": [
            "cpy_temp",
            "p",
            "len",
            "sizeof(cpy_temp)"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "virStrncpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "746-765",
          "snippet": "int\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Wrong length MAC address\")"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "p",
            "\"mac=\""
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Bridge name %s too long for destination\")",
            "p"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "net->data.bridge.brname",
            "len+1"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Too long bridge device name\")"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "p",
            "\"bridge=\""
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Network ifname %s too long for destination\")",
            "p"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "net->ifname",
            "len+1"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Too long network device name\")"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "p",
            "\"host_ifname=\""
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "p",
            "\"ifname=\""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "p",
            "'\\0'"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "p",
            "','"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "net"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "temp",
            "\";\"",
            "&saveptr"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read 'NETIF' from config for container %d\")",
            "veid"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "openvzReadVPSConfigParam",
          "args": [
            "veid",
            "\"NETIF\"",
            "&temp"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "openvzReadVPSConfigParam",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "743-755",
          "snippet": "int\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "openvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nopenvzLocateConfFileFunc openvzLocateConfFile = openvzLocateConfFileDefault;\n\nint\nopenvzReadVPSConfigParam(int vpsid, const char *param, char **value)\n{\n    char *conf_file;\n    int ret;\n\n    if (openvzLocateConfFile(vpsid, &conf_file, \"conf\") < 0)\n        return -1;\n\n    ret = openvzReadConfigParam(conf_file, param, value);\n    VIR_FREE(conf_file);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "NULL",
            "\" \"",
            "&saveptr"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT_COPY",
          "args": [
            "def->nets",
            "def->nnets",
            "net"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainNetAppendIPAddress",
          "args": [
            "net",
            "token",
            "AF_UNSPEC",
            "0"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainNetAppendIPAddress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "11775-11797",
          "snippet": "int\nvirDomainNetAppendIPAddress(virDomainNetDefPtr def,\n                            const char *address,\n                            int family,\n                            unsigned int prefix)\n{\n    virNetDevIPAddrPtr ipDef = NULL;\n    if (VIR_ALLOC(ipDef) < 0)\n        return -1;\n\n    if (virSocketAddrParse(&ipDef->address, address, family) < 0)\n        goto error;\n    ipDef->prefix = prefix;\n\n    if (VIR_APPEND_ELEMENT(def->guestIP.ips, def->guestIP.nips, ipDef) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    VIR_FREE(ipDef);\n    return -1;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainNetAppendIPAddress(virDomainNetDefPtr def,\n                            const char *address,\n                            int family,\n                            unsigned int prefix)\n{\n    virNetDevIPAddrPtr ipDef = NULL;\n    if (VIR_ALLOC(ipDef) < 0)\n        return -1;\n\n    if (virSocketAddrParse(&ipDef->address, address, family) < 0)\n        goto error;\n    ipDef->prefix = prefix;\n\n    if (VIR_APPEND_ELEMENT(def->guestIP.ips, def->guestIP.nips, ipDef) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    VIR_FREE(ipDef);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "net"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "temp",
            "\" \"",
            "&saveptr"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not read 'IP_ADDRESS' from config for container %d\")",
            "veid"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int openvzGetVPSUUID(int vpsid, char *uuidstr, size_t len);\n\nint\nopenvzReadNetworkConf(virDomainDefPtr def,\n                      int veid)\n{\n    int ret;\n    virDomainNetDefPtr net = NULL;\n    char *temp = NULL;\n    char *token, *saveptr = NULL;\n\n    /*parse routing network configuration*\n     * Sample from config:\n     *   IP_ADDRESS=\"1.1.1.1 1.1.1.2\"\n     * IPs split by space\n     */\n    ret = openvzReadVPSConfigParam(veid, \"IP_ADDRESS\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'IP_ADDRESS' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \" \", &saveptr);\n        while (token != NULL) {\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_ETHERNET;\n            if (virDomainNetAppendIPAddress(net, token, AF_UNSPEC, 0) < 0)\n                goto error;\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \" \", &saveptr);\n        }\n    }\n\n    /*parse bridge devices*/\n    /*Sample from config:\n     * NETIF=\"ifname=eth10,mac=00:18:51:C1:05:EE,host_ifname=veth105.10,host_mac=00:18:51:8F:D9:F3\"\n     *devices split by ';'\n     */\n    ret = openvzReadVPSConfigParam(veid, \"NETIF\", &temp);\n    if (ret < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not read 'NETIF' from config for container %d\"),\n                       veid);\n        goto error;\n    } else if (ret > 0) {\n        token = strtok_r(temp, \";\", &saveptr);\n        while (token != NULL) {\n            /* add new device to list */\n            if (VIR_ALLOC(net) < 0)\n                goto error;\n\n            net->type = VIR_DOMAIN_NET_TYPE_BRIDGE;\n\n            char *p = token;\n            char cpy_temp[32];\n            int len;\n\n            /* parse string */\n            do {\n                char *next = strchr(p, ',');\n                if (!next)\n                    next = strchr(p, '\\0');\n                if (STRPREFIX(p, \"ifname=\")) {\n                    /* skip in libvirt */\n                } else if (STRPREFIX(p, \"host_ifname=\")) {\n                    p += 12;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long network device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->ifname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->ifname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Network ifname %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"bridge=\")) {\n                    p += 7;\n                    len = next - p;\n                    if (len > 16) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Too long bridge device name\"));\n                        goto error;\n                    }\n\n                    if (VIR_ALLOC_N(net->data.bridge.brname, len+1) < 0)\n                        goto error;\n\n                    if (virStrncpy(net->data.bridge.brname, p, len, len+1) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"Bridge name %s too long for destination\"), p);\n                        goto error;\n                    }\n                } else if (STRPREFIX(p, \"mac=\")) {\n                    p += 4;\n                    len = next - p;\n                    if (len != 17) { /* should be 17 */\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong length MAC address\"));\n                        goto error;\n                    }\n                    if (virStrncpy(cpy_temp, p, len, sizeof(cpy_temp)) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR,\n                                       _(\"MAC address %s too long for destination\"), p);\n                        goto error;\n                    }\n                    if (virMacAddrParse(cpy_temp, &net->mac) < 0) {\n                        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                                       _(\"Wrong MAC address\"));\n                        goto error;\n                    }\n                }\n                p = ++next;\n            } while (p < token + strlen(token));\n\n            if (VIR_APPEND_ELEMENT_COPY(def->nets, def->nnets, net) < 0)\n                goto error;\n\n            token = strtok_r(NULL, \";\", &saveptr);\n        }\n    }\n\n    VIR_FREE(temp);\n\n    return 0;\n\n error:\n    VIR_FREE(temp);\n    virDomainNetDefFree(net);\n    return -1;\n}"
  },
  {
    "function_name": "openvzCapsInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "149-182",
    "snippet": "virCapsPtr openvzCapsInit(void)\n{\n    g_autoptr(virCaps) caps = NULL;\n    virCapsGuestPtr guest;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        return NULL;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        return NULL;\n\n    if ((guest = virCapabilitiesAddGuest(caps,\n                                         VIR_DOMAIN_OSTYPE_EXE,\n                                         caps->host.arch,\n                                         NULL,\n                                         NULL,\n                                         0,\n                                         NULL)) == NULL)\n        return NULL;\n\n    if (virCapabilitiesAddGuestDomain(guest,\n                                      VIR_DOMAIN_VIRT_OPENVZ,\n                                      NULL,\n                                      NULL,\n                                      0,\n                                      NULL) == NULL)\n        return NULL;\n\n    return g_steal_pointer(&caps);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&caps"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCapabilitiesAddGuestDomain",
          "args": [
            "guest",
            "VIR_DOMAIN_VIRT_OPENVZ",
            "NULL",
            "NULL",
            "0",
            "NULL"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesAddGuestDomain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "485-518",
          "snippet": "virCapsGuestDomainPtr\nvirCapabilitiesAddGuestDomain(virCapsGuestPtr guest,\n                              int hvtype,\n                              const char *emulator,\n                              const char *loader,\n                              int nmachines,\n                              virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestDomainPtr dom;\n\n    if (VIR_ALLOC(dom) < 0)\n        goto error;\n\n    dom->type = hvtype;\n    dom->info.emulator = g_strdup(emulator);\n    dom->info.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(guest->arch.domains, guest->arch.ndomains_max,\n                     guest->arch.ndomains, 1) < 0)\n        goto error;\n    guest->arch.domains[guest->arch.ndomains] = dom;\n    guest->arch.ndomains++;\n\n    if (nmachines) {\n        dom->info.nmachines = nmachines;\n        dom->info.machines = machines;\n    }\n\n    return dom;\n\n error:\n    virCapabilitiesFreeGuestDomain(dom);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsGuestDomainPtr\nvirCapabilitiesAddGuestDomain(virCapsGuestPtr guest,\n                              int hvtype,\n                              const char *emulator,\n                              const char *loader,\n                              int nmachines,\n                              virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestDomainPtr dom;\n\n    if (VIR_ALLOC(dom) < 0)\n        goto error;\n\n    dom->type = hvtype;\n    dom->info.emulator = g_strdup(emulator);\n    dom->info.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(guest->arch.domains, guest->arch.ndomains_max,\n                     guest->arch.ndomains, 1) < 0)\n        goto error;\n    guest->arch.domains[guest->arch.ndomains] = dom;\n    guest->arch.ndomains++;\n\n    if (nmachines) {\n        dom->info.nmachines = nmachines;\n        dom->info.machines = machines;\n    }\n\n    return dom;\n\n error:\n    virCapabilitiesFreeGuestDomain(dom);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesAddGuest",
          "args": [
            "caps",
            "VIR_DOMAIN_OSTYPE_EXE",
            "caps->host.arch",
            "NULL",
            "NULL",
            "0",
            "NULL"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesAddGuest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "434-470",
          "snippet": "virCapsGuestPtr\nvirCapabilitiesAddGuest(virCapsPtr caps,\n                        int ostype,\n                        virArch arch,\n                        const char *emulator,\n                        const char *loader,\n                        int nmachines,\n                        virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestPtr guest;\n\n    if (VIR_ALLOC(guest) < 0)\n        goto error;\n\n    guest->ostype = ostype;\n    guest->arch.id = arch;\n    guest->arch.wordsize = virArchGetWordSize(arch);\n\n    guest->arch.defaultInfo.emulator = g_strdup(emulator);\n    guest->arch.defaultInfo.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(caps->guests, caps->nguests_max,\n                     caps->nguests, 1) < 0)\n        goto error;\n    caps->guests[caps->nguests++] = guest;\n\n    if (nmachines) {\n        guest->arch.defaultInfo.nmachines = nmachines;\n        guest->arch.defaultInfo.machines = machines;\n    }\n\n    return guest;\n\n error:\n    virCapabilitiesFreeGuest(guest);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsGuestPtr\nvirCapabilitiesAddGuest(virCapsPtr caps,\n                        int ostype,\n                        virArch arch,\n                        const char *emulator,\n                        const char *loader,\n                        int nmachines,\n                        virCapsGuestMachinePtr *machines)\n{\n    virCapsGuestPtr guest;\n\n    if (VIR_ALLOC(guest) < 0)\n        goto error;\n\n    guest->ostype = ostype;\n    guest->arch.id = arch;\n    guest->arch.wordsize = virArchGetWordSize(arch);\n\n    guest->arch.defaultInfo.emulator = g_strdup(emulator);\n    guest->arch.defaultInfo.loader = g_strdup(loader);\n\n    if (VIR_RESIZE_N(caps->guests, caps->nguests_max,\n                     caps->nguests, 1) < 0)\n        goto error;\n    caps->guests[caps->nguests++] = guest;\n\n    if (nmachines) {\n        guest->arch.defaultInfo.nmachines = nmachines;\n        guest->arch.defaultInfo.machines = machines;\n    }\n\n    return guest;\n\n error:\n    virCapabilitiesFreeGuest(guest);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesInitCaches",
          "args": [
            "caps"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesInitCaches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1857-2002",
          "snippet": "int\nvirCapabilitiesInitCaches(virCapsPtr caps)\n{\n    size_t i = 0;\n    virBitmapPtr cpus = NULL;\n    ssize_t pos = -1;\n    DIR *dirp = NULL;\n    int ret = -1;\n    char *path = NULL;\n    char *type = NULL;\n    struct dirent *ent = NULL;\n    virCapsHostCacheBankPtr bank = NULL;\n    const virResctrlMonitorType montype = VIR_RESCTRL_MONITOR_TYPE_CACHE;\n    const char *prefix = virResctrlMonitorPrefixTypeToString(montype);\n\n    /* Minimum level to expose in capabilities.  Can be lowered or removed (with\n     * the appropriate code below), but should not be increased, because we'd\n     * lose information. */\n    const int cache_min_level = 3;\n\n    if (virCapabilitiesInitResctrl(caps) < 0)\n        return -1;\n\n    /* offline CPUs don't provide cache info */\n    if (virFileReadValueBitmap(&cpus, \"%s/cpu/online\", SYSFS_SYSTEM_PATH) < 0)\n        return -1;\n\n    while ((pos = virBitmapNextSetBit(cpus, pos)) >= 0) {\n        int rv = -1;\n\n        VIR_FREE(path);\n        path = g_strdup_printf(\"%s/cpu/cpu%zd/cache/\", SYSFS_SYSTEM_PATH, pos);\n\n        VIR_DIR_CLOSE(dirp);\n\n        rv = virDirOpenIfExists(&dirp, path);\n        if (rv < 0)\n            goto cleanup;\n\n        if (!dirp)\n            continue;\n\n        while ((rv = virDirRead(dirp, &ent, path)) > 0) {\n            int kernel_type;\n            unsigned int level;\n\n            if (!STRPREFIX(ent->d_name, \"index\"))\n                continue;\n\n            if (virFileReadValueUint(&level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (level < cache_min_level)\n                continue;\n\n            if (VIR_ALLOC(bank) < 0)\n                goto cleanup;\n\n            bank->level = level;\n\n            if (virFileReadValueUint(&bank->id,\n                                     \"%s/cpu/cpu%zd/cache/%s/id\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueUint(&bank->level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueString(&type,\n                                       \"%s/cpu/cpu%zd/cache/%s/type\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueScaledInt(&bank->size,\n                                          \"%s/cpu/cpu%zd/cache/%s/size\",\n                                          SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueBitmap(&bank->cpus,\n                                       \"%s/cpu/cpu%zd/cache/%s/shared_cpu_list\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            kernel_type = virCacheKernelTypeFromString(type);\n            if (kernel_type < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown cache type '%s'\"), type);\n                goto cleanup;\n            }\n\n            bank->type = kernel_type;\n            VIR_FREE(type);\n\n            for (i = 0; i < caps->host.cache.nbanks; i++) {\n                if (virCapsHostCacheBankEquals(bank, caps->host.cache.banks[i]))\n                    break;\n            }\n            if (i == caps->host.cache.nbanks) {\n                /* If it is a new cache, then update its resctrl information. */\n                if (virResctrlInfoGetCache(caps->host.resctrl,\n                                           bank->level,\n                                           bank->size,\n                                           &bank->ncontrols,\n                                           &bank->controls) < 0)\n                    goto cleanup;\n\n                if (VIR_APPEND_ELEMENT(caps->host.cache.banks,\n                                       caps->host.cache.nbanks,\n                                       bank) < 0) {\n                    goto cleanup;\n                }\n            }\n\n            virCapsHostCacheBankFree(bank);\n            bank = NULL;\n        }\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    /* Sort the array in order for the tests to be predictable.  This way we can\n     * still traverse the directory instead of guessing names (in case there is\n     * 'index1' and 'index3' but no 'index2'). */\n    qsort(caps->host.cache.banks, caps->host.cache.nbanks,\n          sizeof(*caps->host.cache.banks), virCapsHostCacheBankSorter);\n\n    if (virCapabilitiesInitResctrlMemory(caps) < 0)\n        goto cleanup;\n\n    if (virResctrlInfoGetMonitorPrefix(caps->host.resctrl, prefix,\n                                       &caps->host.cache.monitor) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(type);\n    VIR_FREE(path);\n    VIR_DIR_CLOSE(dirp);\n    virCapsHostCacheBankFree(bank);\n    virBitmapFree(cpus);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_SYSTEM_PATH \"/sys/devices/system\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_SYSTEM_PATH \"/sys/devices/system\"\n\nint\nvirCapabilitiesInitCaches(virCapsPtr caps)\n{\n    size_t i = 0;\n    virBitmapPtr cpus = NULL;\n    ssize_t pos = -1;\n    DIR *dirp = NULL;\n    int ret = -1;\n    char *path = NULL;\n    char *type = NULL;\n    struct dirent *ent = NULL;\n    virCapsHostCacheBankPtr bank = NULL;\n    const virResctrlMonitorType montype = VIR_RESCTRL_MONITOR_TYPE_CACHE;\n    const char *prefix = virResctrlMonitorPrefixTypeToString(montype);\n\n    /* Minimum level to expose in capabilities.  Can be lowered or removed (with\n     * the appropriate code below), but should not be increased, because we'd\n     * lose information. */\n    const int cache_min_level = 3;\n\n    if (virCapabilitiesInitResctrl(caps) < 0)\n        return -1;\n\n    /* offline CPUs don't provide cache info */\n    if (virFileReadValueBitmap(&cpus, \"%s/cpu/online\", SYSFS_SYSTEM_PATH) < 0)\n        return -1;\n\n    while ((pos = virBitmapNextSetBit(cpus, pos)) >= 0) {\n        int rv = -1;\n\n        VIR_FREE(path);\n        path = g_strdup_printf(\"%s/cpu/cpu%zd/cache/\", SYSFS_SYSTEM_PATH, pos);\n\n        VIR_DIR_CLOSE(dirp);\n\n        rv = virDirOpenIfExists(&dirp, path);\n        if (rv < 0)\n            goto cleanup;\n\n        if (!dirp)\n            continue;\n\n        while ((rv = virDirRead(dirp, &ent, path)) > 0) {\n            int kernel_type;\n            unsigned int level;\n\n            if (!STRPREFIX(ent->d_name, \"index\"))\n                continue;\n\n            if (virFileReadValueUint(&level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (level < cache_min_level)\n                continue;\n\n            if (VIR_ALLOC(bank) < 0)\n                goto cleanup;\n\n            bank->level = level;\n\n            if (virFileReadValueUint(&bank->id,\n                                     \"%s/cpu/cpu%zd/cache/%s/id\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueUint(&bank->level,\n                                     \"%s/cpu/cpu%zd/cache/%s/level\",\n                                     SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueString(&type,\n                                       \"%s/cpu/cpu%zd/cache/%s/type\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueScaledInt(&bank->size,\n                                          \"%s/cpu/cpu%zd/cache/%s/size\",\n                                          SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            if (virFileReadValueBitmap(&bank->cpus,\n                                       \"%s/cpu/cpu%zd/cache/%s/shared_cpu_list\",\n                                       SYSFS_SYSTEM_PATH, pos, ent->d_name) < 0)\n                goto cleanup;\n\n            kernel_type = virCacheKernelTypeFromString(type);\n            if (kernel_type < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unknown cache type '%s'\"), type);\n                goto cleanup;\n            }\n\n            bank->type = kernel_type;\n            VIR_FREE(type);\n\n            for (i = 0; i < caps->host.cache.nbanks; i++) {\n                if (virCapsHostCacheBankEquals(bank, caps->host.cache.banks[i]))\n                    break;\n            }\n            if (i == caps->host.cache.nbanks) {\n                /* If it is a new cache, then update its resctrl information. */\n                if (virResctrlInfoGetCache(caps->host.resctrl,\n                                           bank->level,\n                                           bank->size,\n                                           &bank->ncontrols,\n                                           &bank->controls) < 0)\n                    goto cleanup;\n\n                if (VIR_APPEND_ELEMENT(caps->host.cache.banks,\n                                       caps->host.cache.nbanks,\n                                       bank) < 0) {\n                    goto cleanup;\n                }\n            }\n\n            virCapsHostCacheBankFree(bank);\n            bank = NULL;\n        }\n        if (rv < 0)\n            goto cleanup;\n    }\n\n    /* Sort the array in order for the tests to be predictable.  This way we can\n     * still traverse the directory instead of guessing names (in case there is\n     * 'index1' and 'index3' but no 'index2'). */\n    qsort(caps->host.cache.banks, caps->host.cache.nbanks,\n          sizeof(*caps->host.cache.banks), virCapsHostCacheBankSorter);\n\n    if (virCapabilitiesInitResctrlMemory(caps) < 0)\n        goto cleanup;\n\n    if (virResctrlInfoGetMonitorPrefix(caps->host.resctrl, prefix,\n                                       &caps->host.cache.monitor) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(type);\n    VIR_FREE(path);\n    VIR_DIR_CLOSE(dirp);\n    virCapsHostCacheBankFree(bank);\n    virBitmapFree(cpus);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesHostNUMANewHost",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesHostNUMANewHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1714-1734",
          "snippet": "virCapsHostNUMAPtr\nvirCapabilitiesHostNUMANewHost(void)\n{\n    virCapsHostNUMAPtr caps = virCapabilitiesHostNUMANew();\n\n    if (virNumaIsAvailable()) {\n        if (virCapabilitiesHostNUMAInitReal(caps) == 0)\n            return caps;\n\n        virCapabilitiesHostNUMAUnref(caps);\n        caps = virCapabilitiesHostNUMANew();\n        VIR_WARN(\"Failed to query host NUMA topology, faking single NUMA node\");\n    }\n\n    if (virCapabilitiesHostNUMAInitFake(caps) < 0) {\n        virCapabilitiesHostNUMAUnref(caps);\n        return NULL;\n    }\n\n    return caps;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsHostNUMAPtr\nvirCapabilitiesHostNUMANewHost(void)\n{\n    virCapsHostNUMAPtr caps = virCapabilitiesHostNUMANew();\n\n    if (virNumaIsAvailable()) {\n        if (virCapabilitiesHostNUMAInitReal(caps) == 0)\n            return caps;\n\n        virCapabilitiesHostNUMAUnref(caps);\n        caps = virCapabilitiesHostNUMANew();\n        VIR_WARN(\"Failed to query host NUMA topology, faking single NUMA node\");\n    }\n\n    if (virCapabilitiesHostNUMAInitFake(caps) < 0) {\n        virCapabilitiesHostNUMAUnref(caps);\n        return NULL;\n    }\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesNew",
          "args": [
            "virArchFromHost()",
            "false",
            "false"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "78-96",
          "snippet": "virCapsPtr\nvirCapabilitiesNew(virArch hostarch,\n                   bool offlineMigrate,\n                   bool liveMigrate)\n{\n    virCapsPtr caps;\n\n    if (virCapabilitiesInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectNew(virCapsClass)))\n        return NULL;\n\n    caps->host.arch = hostarch;\n    caps->host.offlineMigrate = offlineMigrate;\n    caps->host.liveMigrate = liveMigrate;\n\n    return caps;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virCapsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic virClassPtr virCapsClass;\n\nvirCapsPtr\nvirCapabilitiesNew(virArch hostarch,\n                   bool offlineMigrate,\n                   bool liveMigrate)\n{\n    virCapsPtr caps;\n\n    if (virCapabilitiesInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectNew(virCapsClass)))\n        return NULL;\n\n    caps->host.arch = hostarch;\n    caps->host.offlineMigrate = offlineMigrate;\n    caps->host.liveMigrate = liveMigrate;\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virArchFromHost",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "virArchFromHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "206-235",
          "snippet": "virArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nvirArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nvirCapsPtr openvzCapsInit(void)\n{\n    g_autoptr(virCaps) caps = NULL;\n    virCapsGuestPtr guest;\n\n    if ((caps = virCapabilitiesNew(virArchFromHost(),\n                                   false, false)) == NULL)\n        return NULL;\n\n    if (!(caps->host.numa = virCapabilitiesHostNUMANewHost()))\n        return NULL;\n\n    if (virCapabilitiesInitCaches(caps) < 0)\n        return NULL;\n\n    if ((guest = virCapabilitiesAddGuest(caps,\n                                         VIR_DOMAIN_OSTYPE_EXE,\n                                         caps->host.arch,\n                                         NULL,\n                                         NULL,\n                                         0,\n                                         NULL)) == NULL)\n        return NULL;\n\n    if (virCapabilitiesAddGuestDomain(guest,\n                                      VIR_DOMAIN_VIRT_OPENVZ,\n                                      NULL,\n                                      NULL,\n                                      0,\n                                      NULL) == NULL)\n        return NULL;\n\n    return g_steal_pointer(&caps);\n}"
  },
  {
    "function_name": "openvzParseBarrierLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "121-146",
    "snippet": "static int\nopenvzParseBarrierLimit(const char* value,\n                        unsigned long long *barrier,\n                        unsigned long long *limit)\n{\n    char **tmp = NULL;\n    size_t ntmp = 0;\n    int ret = -1;\n\n    if (!(tmp = virStringSplitCount(value, \":\", 0, &ntmp)))\n        goto error;\n\n    if (ntmp != 2)\n        goto error;\n\n    if (barrier && virStrToLong_ull(tmp[0], NULL, 10, barrier) < 0)\n        goto error;\n\n    if (limit && virStrToLong_ull(tmp[1], NULL, 10, limit) < 0)\n        goto error;\n\n    ret = 0;\n error:\n    virStringListFreeCount(tmp, ntmp);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFreeCount",
          "args": [
            "tmp",
            "ntmp"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFreeCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "334-347",
          "snippet": "void\nvirStringListFreeCount(char **strings,\n                       size_t count)\n{\n    size_t i;\n\n    if (!strings)\n        return;\n\n    for (i = 0; i < count; i++)\n        VIR_FREE(strings[i]);\n\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirStringListFreeCount(char **strings,\n                       size_t count)\n{\n    size_t i;\n\n    if (!strings)\n        return;\n\n    for (i = 0; i < count; i++)\n        VIR_FREE(strings[i]);\n\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "tmp[1]",
            "NULL",
            "10",
            "limit"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplitCount",
          "args": [
            "value",
            "\":\"",
            "0",
            "&ntmp"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplitCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "69-123",
          "snippet": "char **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplitCount(const char *string,\n                    const char *delim,\n                    size_t max_tokens,\n                    size_t *tokcount)\n{\n    char **tokens = NULL;\n    size_t ntokens = 0;\n    size_t maxtokens = 0;\n    const char *remainder = string;\n    char *tmp;\n    size_t i;\n\n    if (max_tokens == 0)\n        max_tokens = INT_MAX;\n\n    tmp = strstr(remainder, delim);\n    if (tmp) {\n        size_t delimlen = strlen(delim);\n\n        while (--max_tokens && tmp) {\n            size_t len = tmp - remainder;\n\n            if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n                goto error;\n\n            tokens[ntokens] = g_strndup(remainder, len);\n            ntokens++;\n            remainder = tmp + delimlen;\n            tmp = strstr(remainder, delim);\n        }\n    }\n    if (*string) {\n        if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n            goto error;\n\n        tokens[ntokens] = g_strdup(remainder);\n        ntokens++;\n    }\n\n    if (VIR_RESIZE_N(tokens, maxtokens, ntokens, 1) < 0)\n        goto error;\n    tokens[ntokens++] = NULL;\n\n    if (tokcount)\n        *tokcount = ntokens - 1;\n\n    return tokens;\n\n error:\n    for (i = 0; i < ntokens; i++)\n        VIR_FREE(tokens[i]);\n    VIR_FREE(tokens);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzParseBarrierLimit(const char* value,\n                        unsigned long long *barrier,\n                        unsigned long long *limit)\n{\n    char **tmp = NULL;\n    size_t ntmp = 0;\n    int ret = -1;\n\n    if (!(tmp = virStringSplitCount(value, \":\", 0, &ntmp)))\n        goto error;\n\n    if (ntmp != 2)\n        goto error;\n\n    if (barrier && virStrToLong_ull(tmp[0], NULL, 10, barrier) < 0)\n        goto error;\n\n    if (limit && virStrToLong_ull(tmp[1], NULL, 10, limit) < 0)\n        goto error;\n\n    ret = 0;\n error:\n    virStringListFreeCount(tmp, ntmp);\n    return ret;\n}"
  },
  {
    "function_name": "openvzExtractVersion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "105-117",
    "snippet": "int openvzExtractVersion(struct openvz_driver *driver)\n{\n    if (driver->version > 0)\n        return 0;\n\n    if (openvzExtractVersionInfo(VZCTL, &driver->version) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not extract vzctl version\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not extract vzctl version\")"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not extract vzctl version\""
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "openvzExtractVersionInfo",
          "args": [
            "VZCTL",
            "&driver->version"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "openvzExtractVersionInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
          "lines": "66-103",
          "snippet": "static int\nopenvzExtractVersionInfo(const char *cmdstr, int *retversion)\n{\n    int ret = -1;\n    unsigned long version;\n    char *help = NULL;\n    char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(cmdstr, \"--help\", NULL);\n\n    if (retversion)\n        *retversion = 0;\n\n    virCommandAddEnvString(cmd, \"LC_ALL=C\");\n    virCommandSetOutputBuffer(cmd, &help);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = help;\n\n    /* expected format: vzctl version <major>.<minor>.<micro> */\n    if ((tmp = STRSKIP(tmp, \"vzctl version \")) == NULL)\n        goto cleanup;\n\n    if (virParseVersionString(tmp, &version, true) < 0)\n        goto cleanup;\n\n    if (retversion)\n        *retversion = version;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"openvz_util.h\"",
            "#include \"openvz_conf.h\"",
            "#include \"virerror.h\"",
            "#include <sys/stat.h>",
            "#include <time.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzExtractVersionInfo(const char *cmdstr, int *retversion)\n{\n    int ret = -1;\n    unsigned long version;\n    char *help = NULL;\n    char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(cmdstr, \"--help\", NULL);\n\n    if (retversion)\n        *retversion = 0;\n\n    virCommandAddEnvString(cmd, \"LC_ALL=C\");\n    virCommandSetOutputBuffer(cmd, &help);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = help;\n\n    /* expected format: vzctl version <major>.<minor>.<micro> */\n    if ((tmp = STRSKIP(tmp, \"vzctl version \")) == NULL)\n        goto cleanup;\n\n    if (virParseVersionString(tmp, &version, true) < 0)\n        goto cleanup;\n\n    if (retversion)\n        *retversion = version;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint openvzExtractVersion(struct openvz_driver *driver)\n{\n    if (driver->version > 0)\n        return 0;\n\n    if (openvzExtractVersionInfo(VZCTL, &driver->version) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Could not extract vzctl version\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "openvzExtractVersionInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "66-103",
    "snippet": "static int\nopenvzExtractVersionInfo(const char *cmdstr, int *retversion)\n{\n    int ret = -1;\n    unsigned long version;\n    char *help = NULL;\n    char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(cmdstr, \"--help\", NULL);\n\n    if (retversion)\n        *retversion = 0;\n\n    virCommandAddEnvString(cmd, \"LC_ALL=C\");\n    virCommandSetOutputBuffer(cmd, &help);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = help;\n\n    /* expected format: vzctl version <major>.<minor>.<micro> */\n    if ((tmp = STRSKIP(tmp, \"vzctl version \")) == NULL)\n        goto cleanup;\n\n    if (virParseVersionString(tmp, &version, true) < 0)\n        goto cleanup;\n\n    if (retversion)\n        *retversion = version;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "help"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virParseVersionString",
          "args": [
            "tmp",
            "&version",
            "true"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "virParseVersionString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "254-282",
          "snippet": "int\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirParseVersionString(const char *str, unsigned long *version,\n                      bool allowMissing)\n{\n    unsigned int major, minor = 0, micro = 0;\n    char *tmp;\n\n    if (virStrToLong_ui(str, &tmp, 10, &major) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &minor) < 0)\n        return -1;\n\n    if (!allowMissing && *tmp != '.')\n        return -1;\n\n    if ((*tmp == '.') && virStrToLong_ui(tmp + 1, &tmp, 10, &micro) < 0)\n        return -1;\n\n    if (major > UINT_MAX / 1000000 || minor > 999 || micro > 999)\n        return -1;\n\n    *version = 1000000 * major + 1000 * minor + micro;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "tmp",
            "\"vzctl version \""
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputBuffer",
          "args": [
            "cmd",
            "&help"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1869-1884",
          "snippet": "void\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputBuffer(virCommandPtr cmd, char **outbuf)\n{\n    *outbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outbuf = outbuf;\n    cmd->outfdptr = &cmd->outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddEnvString",
          "args": [
            "cmd",
            "\"LC_ALL=C\""
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddEnvString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1386-1397",
          "snippet": "void\nvirCommandAddEnvString(virCommandPtr cmd, const char *str)\n{\n    char *env;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    env = g_strdup(str);\n\n    virCommandAddEnv(cmd, env);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddEnvString(virCommandPtr cmd, const char *str)\n{\n    char *env;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    env = g_strdup(str);\n\n    virCommandAddEnv(cmd, env);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "cmdstr",
            "\"--help\"",
            "NULL"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nopenvzExtractVersionInfo(const char *cmdstr, int *retversion)\n{\n    int ret = -1;\n    unsigned long version;\n    char *help = NULL;\n    char *tmp;\n    virCommandPtr cmd = virCommandNewArgList(cmdstr, \"--help\", NULL);\n\n    if (retversion)\n        *retversion = 0;\n\n    virCommandAddEnvString(cmd, \"LC_ALL=C\");\n    virCommandSetOutputBuffer(cmd, &help);\n\n    if (virCommandRun(cmd, NULL) < 0)\n        goto cleanup;\n\n    tmp = help;\n\n    /* expected format: vzctl version <major>.<minor>.<micro> */\n    if ((tmp = STRSKIP(tmp, \"vzctl version \")) == NULL)\n        goto cleanup;\n\n    if (virParseVersionString(tmp, &version, true) < 0)\n        goto cleanup;\n\n    if (retversion)\n        *retversion = version;\n\n    ret = 0;\n\n cleanup:\n    virCommandFree(cmd);\n    VIR_FREE(help);\n\n    return ret;\n}"
  },
  {
    "function_name": "strtoI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/openvz/openvz_conf.c",
    "lines": "54-63",
    "snippet": "int\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virstring.h\"",
      "#include \"vircommand.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"openvz_util.h\"",
      "#include \"openvz_conf.h\"",
      "#include \"virerror.h\"",
      "#include <sys/stat.h>",
      "#include <time.h>",
      "#include <dirent.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "str",
            "NULL",
            "10",
            "&val"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virhostcpu.h\"\n#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"openvz_util.h\"\n#include \"openvz_conf.h\"\n#include \"virerror.h\"\n#include <sys/stat.h>\n#include <time.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nstrtoI(const char *str)\n{\n    int val;\n\n    if (virStrToLong_i(str, NULL, 10, &val) < 0)\n        return 0;\n\n    return val;\n}"
  }
]